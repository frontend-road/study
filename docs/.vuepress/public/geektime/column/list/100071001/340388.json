{"id":340388,"title":"01 | 拆分与合并：如何快速地批量处理内容相似的Excel？","content":"<p>你好，我是尹会生。今天是咱们的第一节课，我先带你学习下，如何用Python操作Excel。</p><p>Excel是我们在工作中用到的最频繁的软件之一，它有着强大的计算能力和便捷的图表功能。如果我们要在同一个Excel文件中进行操作，手工进行也很方便，但问题是，如果我们需要同时操作多个Excel文件，就是一件非常耗时的事情了。</p><p>在工作场景中，需要同时操作多个Excel的情况主要有2种：批量合并和批量拆分。我来带你看2个场景。</p><ul>\n<li>批量合并。假设你需要对某些工作内容进行问卷调查，这时你用Excel做了调查问卷模版。我想你会这样做：先把Excel通过工作群分发给所有员工，再把群里收集到的反馈附件汇总成一个文件。</li>\n<li>批量拆分。假设你是公司的财务人员，你需要使用Excel对员工工资进行核算，之后再打印出来。但是公司要求员工薪水保密，所以每个员工的工资需要拆分成一个独立的文件，最后还需要打印出来。</li>\n</ul><p>无论是合并，还是拆分，我们都面临着一个困境：没有现成的软件可以实现多个Excel文件的合并和拆分操作，所以你只好对每一个Excel文件都进行“打开-复制粘贴-保存”的工作。</p><p>很多人在面对这样的工作需求时，都<strong>忍不住立马去做，却很少停下来分析问题</strong>。其实，这三步是很简单的工作，不过也是无意义的重复工作，既浪费了时间，又没有真正产生价值。</p><!-- [[[read_end]]] --><p>幸运的是，这些工作都可以通过Python来解决。今天，我就给你介绍一下用Python实现重复工作自动化，快速实现Excel的合并和拆分的方法。</p><h2>如何用Python手工操作一个Excel文件？</h2><p>刚刚我们说到批量处理，其实也就是逐一处理多个文件。如果我们想要提升这类工作的效率，就可以先借助Python把每一次处理都自动化。所以，在讲具体的合并和拆分方法前，我们要解决的第一个问题，就是用Python代替你的双手来操作一个Excel文件。</p><p>如果要用Python操作Excel文件，首先就要支持读写Excel的功能。<strong>在Python中，要想实现对某一个功能的支持，就需要安装扩展库。</strong></p><p>支持Excel读取的扩展库叫做xlrd库，支持Excel写入的扩展库叫做xlwt库。我们可以使用下面的命令行进行安装：</p><pre><code>pip3 install xlrd \npip3 install xlwt \n</code></pre><p>那么，如何使用Python读取Excel文件的内容呢？你可以使用这样的代码实现：</p><pre><code>import xlrd\n\nfile = '/Users/user1/Desktop/a.xls'\n\ndata = xlrd.open_workbook(file)\ntable = data.sheets()[0]\nvalue = table.cell_value(rowx=4, colx=4)\n</code></pre><p>虽然代码很简单，但是它对自动化操作Excel的意义非常大。</p><p>试想一下，如果能够使用Python替代全部的手工操作，大批量的文件就可以使用Python的循环功能自动化完成对每一个文件的自动处理工作了。</p><p>对于编程语言来说，文件合并的步骤可以分解为读取第一个文件，读取第二个文件，将第一个文件的内容追加到第二个文件下方。</p><p>所以在我们学会使用Python读取Excel文件之后，我们还需要掌握如何将读取的内容写入到Excel文件。写入文件的代码如下：</p><pre><code>import xlwt\n\ndst_file = '/Users/edz/Desktop/文章1/result/结果.xlsx'\n\nworkbook = xlwt.Workbook(encoding='utf-8')\nxlsheet = workbook.add_sheet(&quot;统计结果&quot;)\n\n# 写入内容,假设取出的内容是value\nxlsheet.write(0, 0, value)\n\n# 保存文件\nworkbook.save(dst_file)\n</code></pre><p>可以看到，写入文件的时候，我们使用了一个叫做write的函数。它的前两个参数代表的写入位置，分别是指定写入的行和列坐标。无需多言，这个写入位置非常重要。如果按照上面的代码方式写入，也就是前两个参数均指定为0，就会覆盖这个Excel文件中的现有内容了。</p><p>所以，你如果想完成合并操作的话，就要实现对现有Excel内容进行追加写入。通常我们会先获取现有的内容一共有多少行、多少列，然后向后移动一个位置，再进行写入。</p><p>这种追加写入的方式，在我们的工作场景中非常常见。接下来，我们就看看怎么用追加写入的方式，实现多个Excel文件的合并吧。</p><h2>怎样实现Excel的合并？</h2><p>我们还是用前面提到的做调查问卷模板的场景，来具体讲一讲怎么实现Excel的合并。这里，我们就要用到一个重要功能了：<strong>循环功能</strong>。</p><p>循环功能的核心代码是：</p><pre><code>from pathlib import Path, PurePath\n\n# 指定要合并excel的路径\nsrc_path = '/Users/edz/Desktop/文章1/调查问卷'\n\n# 取得该目录下所有的xlsx格式文件\np = Path(src_path)\nfiles = [x for x in p.iterdir() if PurePath(x).match('*.xlsx')]\n</code></pre><p>在这段代码中，我使用了for语句，实现了Python的循环功能。通过这样的功能，我可以依次获取src_path变量指向的路径下所有的文件。同时，为了避免这个目录里的文件类型过多，我使用一个if语句用于条件判断，只提取.xlsx结尾的文件。</p><p>现在，用Excel实现调查问卷自动化的主要功能已经都实现了。接下来，我们看看怎样实现整个工作过程。我把它们的工作流程定义为三个步骤：</p><ol>\n<li>找到整个工作过程当中重复操作的部分；</li>\n<li>将重复操作的部分需要哪些手工操作找出来，使用Python编写程序代替手工操作的部分；</li>\n<li>对重复的部分，使用循环语句进行批量处理。</li>\n</ol><p>如果你对把手工操作改成Python程序，还没有任何经验的话，我还可以为你提供更直观的办法，叫做<strong>画时序图</strong>。</p><p>我先带你看看时序图是什么呢？如下图表:</p><p><img src=\"https://static001.geekbang.org/resource/image/b2/90/b2da3c7bfd1c80888d0c4776317fb090.png?wh=3749*1980\" alt=\"\"></p><p>简单来讲，<strong>时序图就是以时间顺序来排列程序中的事件的图表</strong>。通过上图，你应该很容易看出重复操作的这四个事件：</p><ol>\n<li>打开文件；</li>\n<li>提取用户填写内容；</li>\n<li>粘贴到汇总文件；</li>\n<li>关闭文件。</li>\n</ol><p>下面，我们就用Python来替代这四个事件。由于它们是重复的，所以我会使用for循环对它们依次进行处理。</p><p>回到我们的Excel做调查问卷的场景。当我们回收了调查问卷之后，每份问卷的格式是完全相同的，刚好可以利用上面提到的循环功能处理每份问卷。而问卷的选项则是我们需要提取出来用于汇总的，所以我们要使用Python实现读取Excel调查问卷的功能，最后再写入到一个新的Excel中。</p><p>好了，我们来看下这一功能的Python代码是如何编写的：</p><pre><code>import xlrd\nimport xlwt\nfrom pathlib import Path, PurePath\n# 导入excel和文件操作库\n\n# 指定要合并excel的路径\nsrc_path = '/Users/edz/Desktop/文章1/调查问卷'\n# 指定合并完成的路径\ndst_file = '/Users/edz/Desktop/文章1/result/结果.xls'\n\n# 取得该目录下所有的xlsx格式文件\np = Path(src_path)\nfiles = [x for x in p.iterdir() if PurePath(x).match('*.xls')]\n\n# 准备一个列表存放读取结果\ncontent = []\n\n# 对每一个文件进行重复处理\nfor file in files:\n    # 用文件名作为每个用户的标识\n    username = file.stem\n    data = xlrd.open_workbook(file)\n    table = data.sheets()[0]\n    # 取得每一项的结果\n    answer1 = table.cell_value(rowx=4, colx=4)\n    answer2 = table.cell_value(rowx=10, colx=4)\n    temp = f'{username},{answer1},{answer2}'\n    # 合并为一行先存储起来\n    content.append(temp.split(','))\n    print(temp)\n    # 输出\n    # 韩梅梅,D,B\n    # 李雷,D,C\n\n# 准备写入文件的表头\ntable_header = ['员工姓名', '第一题', '第二题']\n\nworkbook = xlwt.Workbook(encoding='utf-8')\nxlsheet = workbook.add_sheet(&quot;统计结果&quot;)\n\n# 写入表头\nrow = 0\ncol = 0\nfor cell_header in table_header:\n    xlsheet.write(row, col, cell_header)\n    col += 1 \n\n# 向下移动一行\nrow += 1\n# 取出每一行内容\nfor line in content:\n    col = 0\n    # 取出每个单元格内容\n    for cell in line:\n        # 写入内容\n        xlsheet.write(row, col, cell)\n        # 向右移动一个单元格\n        col += 1\n    # 向下移动一行\n    row += 1\n# 保存最终结果\nworkbook.save(dst_file)\n</code></pre><p>在这段代码中，Excel的读取和写入操作、for循环操作都派上了用场，它的整个工作过程就像我画的时序图一样：<strong>先打开用来汇总的Excel文件，依次对多个调查问卷进行读取，最后逐行写入到新建立的汇总文件中</strong>。</p><p>合并后的效果如下图：</p><p><img src=\"https://static001.geekbang.org/resource/image/a1/f4/a1ef2630faec5458fbcef4c7b45aaaf4.png?wh=7647*3392\" alt=\"\"></p><p>有一点需要你注意的是，为了让你更好地理解Python循环的工作过程，我没有严格遵守编码规范，而是尽可能地让程序按照从上到下的顺序执行。如果你已经不是第一次使用Python，可以根据你的使用习惯，将程序进一步封装成Python里的函数，更加优雅地去实现它。</p><p>总的来说，在使用Python对Excel的合并操作时，需要你掌握的最核心的操作就是读写文件和行列坐标控制。熟练掌握这两个功能，你才能一次得到想要合并成的样子，不用再对Excel进行二次的手工操作。</p><h2>怎样实现Excel的拆分？</h2><p>对于批量操作Excel，还有一种情况是批量拆分。比如很多公司会用Excel记录和统计员工的薪水、记录货物信息、记录客户情况等数据。这些数据越来越多之后，文件会越来越大，打开文件和查找速度就会变得很慢，最后只好按照某些列进行Excel的拆分。</p><p>接下来，我就为你讲解一下如何进行Excel的批量拆分。让我们来看一个工资条的案例。</p><p>例如我在一个Excel中存放了工资信息，需要把第一行的表头和员工工资拆分成一个以员工名字命名的Excel文件。我来带你看下具体该怎么操作：</p><p><img src=\"https://static001.geekbang.org/resource/image/d6/0b/d66b559b7603f2698b4d4e8c81196c0b.png?wh=7681*3350\" alt=\"\"></p><p>如果把拆分工作也画成时序图，就会发现，逐行读取可以使用循环功能批量操作，对每一行的内容处理，如果能使用Python进行自动化的话，一个Excel拆分的工作就全部能使用Python自动化实现了。所以，我打算设计一个for循环语句用于遍历所有的行，在for循环语句当中实现对每一行具体内容的处理。</p><p>我把文件拆分的关键代码写了出来，你可以参考一下：</p><pre><code>for line in range(1,employee_number):\n    content = table.row_values(rowx=line, start_colx=0, end_colx=None)\n    # 将表头和员工数量重新组成一个新的文件 \n    new_content = []\n    # 增加表头到要写入的内容中\n    new_content.append(salary_header)\n    # 增加员工工资到要写入的内容中\n    new_content.append(content)\n    # 调用自定义函数write_to_file()写入新的文件\n    write_to_file(filename = content[1], cnt = new_content)\n</code></pre><p>在这段代码的第一行，我使用了一个range函数，它会生成从1到员工总数的数字范围。你可能会问，为什么没有直接写出Excel中总员工的数量，而是使用employee_number这样一个变量呢？</p><p>这是因为，如果直接写出员工数量，一旦遇到员工入职或员工离职等情况，你就需要根据Excel中的行数重新编写Python代码，而我现在使用的方式是每次打开Excel文件，会自动统计员工的数量（即行数），这种编写代码的方式能够让你的程序有更好的扩展性，一般这种方式用于处理文件内容经常变动的情况。</p><p>文件的批量拆分也是通过循环来实现逐行处理的功能的，但是你需要注意拆分以后的要保存的文件名称不要重复，不然很容易导致Excel中只有最后一次循环写入的内容。</p><h2>小结</h2><p>今天，我为你讲解了如何使用Python代替手工进行Excel的批量合并和拆分操作。一般来说，批量合并和拆分主要有几个步骤：</p><ol>\n<li>手动或借助时序图找到需要重复操作的部分。</li>\n<li>将重复的部分用Python实现自动化操作。</li>\n<li>对Python实现自动化的脚本，再用循环功能实现批量操作。</li>\n</ol><p>Python有着丰富的扩展库，<strong>当你掌握了熟练操作Excel的方法之后，对于WPS等其他办公软件，也可以通过相应的API进行类似的合并和拆分操作</strong>。</p><p>除了基本操作呢，我还给你介绍了分析问题的方法——时序图。通过时序图，你可以找到那些运行逻辑中重复的部分，利用循环完成自动化操作。</p><p>不管是利用Python代替手工操作节约时间，还是使用循环代替手工多次执行减少工作难度，这些都是提升工作效率的有效办法。希望你能在处理日常工作时多思考，有意识地把你的日常办公工作自动化。</p><h2>思考题</h2><p>欢迎你在课程后留言，告诉我使用Python解决了你工作中的哪些重复性问题。</p><p>如果你觉得这节课有用，能解决你的办公效率问题，欢迎你点击“请朋友读”，分享给你的朋友或同事。</p><p>编辑小提示：专栏的完整代码位置是https://github.com/wilsonyin123/python_productivity，可点击链接下载查看。或者通过网盘链接提取后下载，链接是: <a href=\"https://pan.baidu.com/s/1UvEKDCGnU6yb0a7gHLSE4Q?pwd=5wf1%EF%BC%8C%E6%8F%90%E5%8F%96%E7%A0%81:\">https://pan.baidu.com/s/1UvEKDCGnU6yb0a7gHLSE4Q?pwd=5wf1，提取码:</a> 5wf1。</p>","neighbors":{"left":{"article_title":"导读｜入门Python的必备知识","id":340385},"right":{"article_title":"02｜善用Python扩展库：如何批量合并多个文档？","id":341220}},"comments":[{"had_liked":false,"id":277306,"user_name":"达文西","can_delete":false,"product_type":"c1","uid":1398824,"ip_address":"","ucode":"01C1063F23D634","user_header":"https://static001.geekbang.org/account/avatar/00/15/58/28/c86340ca.jpg","comment_is_top":true,"comment_ctime":1612350624,"is_pvip":false,"replies":[{"id":"100722","content":"这是python最擅长的领域之一了。给这些非标的数据做格式化特别好用。","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612506293,"ip_address":"","comment_id":277306,"utype":1}],"discussion_count":1,"race_medal":0,"score":"9.2233720900067e+18","product_id":100071001,"comment_content":"上周刚碰到类似的需求,客户发过来的excle跟系统要求的模板跟数据格式都不对应,上万条数据,手动改肯定是搞不来了.就自己摸索着一天用python处理了一下做适配.不得不说python确实简单好学,很适合处理这些简单重复的业务场景.","like_count":12,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514996,"discussion_content":"这是python最擅长的领域之一了。给这些非标的数据做格式化特别好用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612506293,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340200,"user_name":"🐑","can_delete":false,"product_type":"c1","uid":2189689,"ip_address":"","ucode":"DE34B3B14287D1","user_header":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","comment_is_top":true,"comment_ctime":1648651878,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"9.2233720385033994e+18","product_id":100071001,"comment_content":"编辑小提示：专栏的完整代码位置是https:&#47;&#47;github.com&#47;wilsonyin123&#47;python_productivity，可点击链接下载查看。<br><br>或者通过网盘链接提取后下载，链接是: https:&#47;&#47;pan.baidu.com&#47;s&#47;1UvEKDCGnU6yb0a7gHLSE4Q?pwd=5wf1，提取码: 5wf1。","like_count":0},{"had_liked":false,"id":277938,"user_name":"李京斌","can_delete":false,"product_type":"c1","uid":2436296,"ip_address":"","ucode":"F533A3A039B568","user_header":"https://static001.geekbang.org/account/avatar/00/25/2c/c8/7f32200e.jpg","comment_is_top":false,"comment_ctime":1612676909,"is_pvip":false,"replies":[{"id":"101072","content":" https:&#47;&#47;github.com&#47;wilsonyin123&#47;python_productivity<br>代码和课程中的文件都在链接中","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612873248,"ip_address":"","comment_id":277938,"utype":1}],"discussion_count":3,"race_medal":0,"score":"44562349869","product_id":100071001,"comment_content":"能否共享讲课中提到的文件（EXCEL文件等）。","like_count":10,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515219,"discussion_content":" https://github.com/wilsonyin123/python_productivity\n代码和课程中的文件都在链接中","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612873248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2453012,"avatar":"","nickname":"幸径健","note":"","ucode":"3019791EB51A8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406518,"discussion_content":"这个链接打不开呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634784402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2304211,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/gfyBmUHNaKKZ5jogia2WR3XIkCkAbpmL09vkTtJYyIC6U1YkJlbAxqQ5vJ8icyubMGnMZmru4H7eYZ8DyUEMHSLA/132","nickname":"Geek_69dabe","note":"","ucode":"0B480B4AF4D17E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383724,"discussion_content":"老师，第13到15的课件怎么没有呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626224434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277358,"user_name":"旧草","can_delete":false,"product_type":"c1","uid":1213156,"ip_address":"","ucode":"A44D4179BBDC9C","user_header":"https://static001.geekbang.org/account/avatar/00/12/82/e4/c456fa79.jpg","comment_is_top":false,"comment_ctime":1612370637,"is_pvip":true,"replies":[{"id":"100724","content":"感谢指正，xlsx应该为xls格式","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612506931,"ip_address":"","comment_id":277358,"utype":1}],"discussion_count":2,"race_medal":0,"score":"44562043597","product_id":100071001,"comment_content":"例子保存的excel是xlsx，而官方文档写着：<br>xlwt is a library for writing data and formatting information to older Excel files (ie: .xls) by https:&#47;&#47;xlwt.readthedocs.io&#47;en&#47;latest&#47;","like_count":10,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515021,"discussion_content":"感谢指正，xlsx应该为xls格式","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612506931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2436754,"avatar":"https://static001.geekbang.org/account/avatar/00/25/2e/92/8356aa83.jpg","nickname":"Don","note":"","ucode":"DDC105E980FC9E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349453,"discussion_content":"正文内容里面的文件格式是错的，希望改正，避免每个人都需要看评论才知道哪里错了","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1613219720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281050,"user_name":"唐超伟","can_delete":false,"product_type":"c1","uid":1148687,"ip_address":"","ucode":"F0B7384674A0E3","user_header":"https://static001.geekbang.org/account/avatar/00/11/87/0f/9876789d.jpg","comment_is_top":false,"comment_ctime":1614563501,"is_pvip":true,"replies":[{"id":"102040","content":"感谢反馈, 可以使用openpyxl库代替xlrd xlwt 实现xlsx文件的读写","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1614573396,"ip_address":"","comment_id":281050,"utype":1}],"discussion_count":5,"race_medal":1,"score":"35974301869","product_id":100071001,"comment_content":"2.01版本的xlrd不支持xlsx文件，只支持xls文件<br>亲测装旧版本的可用<br> pip install xlrd==1.2.0","like_count":8,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516285,"discussion_content":"感谢反馈, 可以使用openpyxl库代替xlrd xlwt 实现xlsx文件的读写","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614573396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1031482,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/bd/3a/00692b69.jpg","nickname":"旅途中de陌生人","note":"","ucode":"8E14FE7D5BC65F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371070,"discussion_content":"确实有这个问题，作者既然知道了，为什么不在课程中改一下，让大家都跑去谷歌百度的一通搜？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1619622297,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1429336,"avatar":"https://static001.geekbang.org/account/avatar/00/15/cf/58/dabb0f73.jpg","nickname":"Super Ollie","note":"","ucode":"4F30DE41673C97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":534041,"discussion_content":"确实有这个问题，作者既然知道了，为什么不在课程中改一下，让大家都跑去谷歌百度的一通搜？而且看这个课程的基本都是python小白","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638075274,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1541985,"avatar":"https://static001.geekbang.org/account/avatar/00/17/87/61/e23889fd.jpg","nickname":"指针","note":"","ucode":"9A1B901F29078E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362186,"discussion_content":"确实有这个问题，作者既然知道了，为什么不在课程中改一下，让大家都跑去谷歌百度的一通搜？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616864050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1083763,"avatar":"https://static001.geekbang.org/account/avatar/00/10/89/73/2deb24ab.jpg","nickname":"武明","note":"","ucode":"73521E4633085B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361140,"discussion_content":"谢谢，我也遇到这个坑了，用xls格式文件才测试通过","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616598076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277533,"user_name":"Nick","can_delete":false,"product_type":"c1","uid":1921287,"ip_address":"","ucode":"64BBE005890845","user_header":"https://static001.geekbang.org/account/avatar/00/1d/51/07/b5a945b6.jpg","comment_is_top":false,"comment_ctime":1612445656,"is_pvip":false,"replies":[{"id":"100727","content":"千万条数据存入到 Excel已经不合适了。存入到数据库是比较好的解决方案。<br>我们以MySQL为例，为了避免你的内存不足，建议你读取一个文件向数据库写一次。python可以使用mysqlDB这个库写入数据库。<br>如果你需要跨文件做一些关联处理，必须一次性把这些文件都读入到内存的话，可以使用一个叫做pandas的库来进行相关处理。<br>如果数据的量级再大，建议你直接写入数据库，用SQL来处理数据之间的关系。","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612509831,"ip_address":"","comment_id":277533,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35972184024","product_id":100071001,"comment_content":"老师，我现在正好也碰到类似这样合并Excel文件的业务场景。大概有几十个拆分的Excel文件，要合并导入到数据库中，按照今天课程的思路，将所有的数据合并到一个Excel文件中来处理，但现在的问题是数据量比较大，超过了千万条记录。已经超出了Excel的最大范围，请问这种情况该怎么处理？我自己目前想到的是通过循环读所有的Excel文件，将数据一条条的插入到数据库中，请问老师还有什么高见？","like_count":8,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515082,"discussion_content":"千万条数据存入到 Excel已经不合适了。存入到数据库是比较好的解决方案。\n我们以MySQL为例，为了避免你的内存不足，建议你读取一个文件向数据库写一次。python可以使用mysqlDB这个库写入数据库。\n如果你需要跨文件做一些关联处理，必须一次性把这些文件都读入到内存的话，可以使用一个叫做pandas的库来进行相关处理。\n如果数据的量级再大，建议你直接写入数据库，用SQL来处理数据之间的关系。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612509831,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1226493,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b6/fd/a0f60753.jpg","nickname":"牛牛肥","note":"","ucode":"4F455A76F22BB0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348460,"discussion_content":"课程会谈及用数据库解决相关问题的内容吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612584769,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277326,"user_name":"Fan","can_delete":false,"product_type":"c1","uid":1115232,"ip_address":"","ucode":"3BF28670FD9407","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/60/64d166b6.jpg","comment_is_top":false,"comment_ctime":1612359435,"is_pvip":false,"replies":[{"id":"100720","content":"都很有用，过年女朋友让你在某东某宝抢个化妆品，爬虫的功能就派上用场了。","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612506048,"ip_address":"","comment_id":277326,"utype":1}],"discussion_count":3,"race_medal":0,"score":"31677130507","product_id":100071001,"comment_content":"哈哈哈，这个主题讲得好，比爬虫，Django 那些内容实用多了。","like_count":7,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515005,"discussion_content":"都很有用，过年女朋友让你在某东某宝抢个化妆品，爬虫的功能就派上用场了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612506048,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1849346,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJLAxia7JictXmeChGFGBgeh1uAiceHQ6mGVksCs1ZHx0MNQ9dye1CrpXIH7Hre5C20M1GSGicSzt7wvg/132","nickname":"taozhiyaoyao","note":"","ucode":"8D72D928B2281D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367712,"discussion_content":"我想抢火车票可以吗","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1618448125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2190287,"avatar":"https://static001.geekbang.org/account/avatar/00/21/6b/cf/1e7a2257.jpg","nickname":"Geek_ycw","note":"","ucode":"133A6BEA6CCB29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386369,"discussion_content":"老师出一期抢某宝某东的化妆品课程呗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627551921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282875,"user_name":"陈芳","can_delete":false,"product_type":"c1","uid":2448316,"ip_address":"","ucode":"E3BED55002D32D","user_header":"https://static001.geekbang.org/account/avatar/00/25/5b/bc/2cc1cc02.jpg","comment_is_top":false,"comment_ctime":1615450260,"is_pvip":false,"replies":[{"id":"102671","content":"你好，我觉得问题并不是对python不熟悉造成的，而是对编程的基础概念比如运行环境、计算机原理等不熟悉导致，这些知识对于初学者没有必要先全部掌握，会造成学习的挫败感，建议你可以先跟着专栏的程序来模仿，通过模仿再慢慢理解，之后再从理解到运用，之后再慢慢补齐计算机原理和windows系统知识，这样会让进阶之路更平缓一些","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1615474541,"ip_address":"","comment_id":282875,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18795319444","product_id":100071001,"comment_content":"像我这样情况的，是不是应该学习【零基础学Python】，而不是这个课程。感觉十分吃力，连怎么开门都不知道","like_count":4,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516865,"discussion_content":"你好，我觉得问题并不是对python不熟悉造成的，而是对编程的基础概念比如运行环境、计算机原理等不熟悉导致，这些知识对于初学者没有必要先全部掌握，会造成学习的挫败感，建议你可以先跟着专栏的程序来模仿，通过模仿再慢慢理解，之后再从理解到运用，之后再慢慢补齐计算机原理和windows系统知识，这样会让进阶之路更平缓一些","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615474541,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327244,"user_name":"比国王","can_delete":false,"product_type":"c1","uid":1165334,"ip_address":"","ucode":"F80FE72063E4E8","user_header":"https://static001.geekbang.org/account/avatar/00/11/c8/16/619765bf.jpg","comment_is_top":false,"comment_ctime":1640005017,"is_pvip":false,"replies":[{"id":"119186","content":"只论报表的拆分和合并 ，python 和 VBA 都是利用 COM组件和Excel完成底层交互的。但是考虑现在代码的丰富程度，以及学习成本，Python无疑要比VBA要好太多，我来说服你学Python吧 ：）","user_name":"作者回复","user_name_real":"编辑","uid":"1056235","ctime":1640150826,"ip_address":"","comment_id":327244,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14524906905","product_id":100071001,"comment_content":"老师，只论报表的拆分和合并，Python比VBA强在哪些方面？因为打开Excel就可以写VBA，非常方便，但如果知道Python比VBA更好的话，就可以说服自己学习Python而放弃使用VBA了。","like_count":3,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540754,"discussion_content":"只论报表的拆分和合并 ，python 和 VBA 都是利用 COM组件和Excel完成底层交互的。但是考虑现在代码的丰富程度，以及学习成本，Python无疑要比VBA要好太多，我来说服你学Python吧 ：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640150826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278154,"user_name":"巩春雨","can_delete":false,"product_type":"c1","uid":1878247,"ip_address":"","ucode":"361A2F51B22D89","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoQG9QxO3VicX7YnLGxd33v0dAOxBlQmankC6hdSmTLdIw0HNnAjqNl75mnMyTibQj63o4F10wnSH7A/132","comment_is_top":false,"comment_ctime":1612777718,"is_pvip":false,"replies":[{"id":"101063","content":"你好啊, 我想先带你解决从手动到自动的思路问题, 自动化的前提解决了,再细化特殊问题,.<br>比如你提到的,单元格公式问题,公式能够正常处理的前提是是否被正常读取了,你会发现openpyxl 、xlrd这两个模块在读取excel的时候,有一个data_only 参数,控制着读取公式的行为, data_only为True读取的公式单元格就是None(需要用excel再打开文件一次才能显示值),如果是False就是公式本身.<br>还有一个终极方案,用python将公式内容以python字符串方式写入,如:<br>xls[&quot;B10&quot;] = &quot;=SUM(B1:B9)&quot;<br>通过这两个参数控制","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612872552,"ip_address":"","comment_id":278154,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14497679606","product_id":100071001,"comment_content":"老师，您讲的都是对于一些简单格式的excel数据有效。实际工作中财务的一些表格都是包含大量的格式，如合并单元格，涂色，隐藏，筛选及单元格内存在大量的公式。如果我把10个文件合并到一个文件中的不同sheet，如何能把相应的格式及公式快速的复制过去","like_count":3,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515299,"discussion_content":"你好啊, 我想先带你解决从手动到自动的思路问题, 自动化的前提解决了,再细化特殊问题,.\n比如你提到的,单元格公式问题,公式能够正常处理的前提是是否被正常读取了,你会发现openpyxl 、xlrd这两个模块在读取excel的时候,有一个data_only 参数,控制着读取公式的行为, data_only为True读取的公式单元格就是None(需要用excel再打开文件一次才能显示值),如果是False就是公式本身.\n还有一个终极方案,用python将公式内容以python字符串方式写入,如:\nxls[&amp;quot;B10&amp;quot;] = &amp;quot;=SUM(B1:B9)&amp;quot;\n通过这两个参数控制","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612872552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1878247,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoQG9QxO3VicX7YnLGxd33v0dAOxBlQmankC6hdSmTLdIw0HNnAjqNl75mnMyTibQj63o4F10wnSH7A/132","nickname":"巩春雨","note":"","ucode":"361A2F51B22D89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349613,"discussion_content":"老师，公式这个大概明白了，如果是读成字符串，再写入时候会不会就显示的是公式字符串了，而不是公式计算的结果了呢？合并单元格涂色那些怎么能读出来呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613390576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277671,"user_name":"BBQ","can_delete":false,"product_type":"c1","uid":1656804,"ip_address":"","ucode":"683BBF7F7AE370","user_header":"https://static001.geekbang.org/account/avatar/00/19/47/e4/17cb3df1.jpg","comment_is_top":false,"comment_ctime":1612513892,"is_pvip":false,"replies":[{"id":"100843","content":"Python在网络和文件库的丰富程度上，是ps无法比拟的，但是在命令行方面ps也是非常强悍的，我在加餐当中也会使用到powershell，为你讲解它擅长的地方。","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612675245,"ip_address":"","comment_id":277671,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14497415780","product_id":100071001,"comment_content":"老婆总是让我批量处理文件，上次学用 PowerShell 写了一个小程序，非常难写。用Python 简单多了。 ","like_count":3,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515133,"discussion_content":"Python在网络和文件库的丰富程度上，是ps无法比拟的，但是在命令行方面ps也是非常强悍的，我在加餐当中也会使用到powershell，为你讲解它擅长的地方。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612675245,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337787,"user_name":"谢韬 Fragos","can_delete":false,"product_type":"c1","uid":2456075,"ip_address":"","ucode":"75F2178E340C5D","user_header":"https://static001.geekbang.org/account/avatar/00/25/7a/0b/b0d918da.jpg","comment_is_top":false,"comment_ctime":1647063375,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10236997967","product_id":100071001,"comment_content":"我用openpyxl3.0.9写的支持xlsx格式的代码供大家参考。谢谢尹老师的指导。 <br>from openpyxl import load_workbook<br>from pathlib import Path,PurePath<br>from openpyxl import Workbook<br>src_path=&#39;&#47;Users&#47;tx&#47;Desktop&#47;文章1代码&#47;调查问卷&#39;<br>dst_path = &#39;&#47;Users&#47;tx&#47;Desktop&#47;文章1代码&#47;result&#47;结果.xlsx&#39;<br>p= Path(src_path)<br>files= [x for x in p.iterdir() if PurePath(x).match(&#39;*.xlsx&#39;)]<br># print(files)<br>content = []<br>for file in files:<br>    username = file.stem<br>    # print(file)<br>    wb = load_workbook(file)<br>    # print(wb.sheetnames)<br>    ws=wb.active<br>    # print(ws)<br>    answer1 = ws[&#39;E5&#39;].value<br>    answer2 = ws.cell(row=11,column=5).value<br>    print(answer1)<br>    print(answer2)<br>    temp = f&#39;{username},{answer1},{answer2}&#39;<br>    content.append(temp.split(&#39;,&#39;))<br>    print (temp)<br>    print(content)<br><br>ws1_header =[&#39;员工姓名&#39;,&#39;第一题&#39;,&#39;第二题&#39;]<br>wb1= Workbook()<br>ws1 = wb1.active<br>ws1 = wb1.create_sheet(&quot;统计结果&quot;)<br>rw=1<br>col=1<br>for cell_header in ws1_header:<br>     ws1.cell(row=rw, column=col,value=cell_header)<br>     col +=1<br><br>rw +=1<br>for line in content:<br>    col=1<br>    for cell in line:<br>        ws1.cell(row=rw, column=col, value=cell)<br>        col+=1<br>    rw+=1<br><br>wb1.save(dst_path)","like_count":2},{"had_liked":false,"id":289557,"user_name":"老李书店","can_delete":false,"product_type":"c1","uid":1992210,"ip_address":"","ucode":"72D806BE66ACE5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLShOEsneaMR6ysiaDaxdsvUPB24iaVOSyEblwmsqia2N0u5XCnC8YeLAtrBkxX8wbocTxFe1gfILuqg/132","comment_is_top":false,"comment_ctime":1619081085,"is_pvip":false,"replies":[{"id":"105195","content":"您好，有的，在github下载， 每一课我都打包成了一个zip压缩包供你练习。<br>https:&#47;&#47;github.com&#47;wilsonyin123&#47;python_productivity","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1619424107,"ip_address":"","comment_id":289557,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10209015677","product_id":100071001,"comment_content":"请问下有案例文件吗","like_count":2,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518948,"discussion_content":"您好，有的，在github下载， 每一课我都打包成了一个zip压缩包供你练习。\nhttps://github.com/wilsonyin123/python_productivity","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619424107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2602519,"avatar":"https://static001.geekbang.org/account/avatar/00/27/b6/17/4212a3ca.jpg","nickname":"Nichkhun","note":"","ucode":"6ED7F62E9F1681","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371839,"discussion_content":"zip压缩包在哪里下载，谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620013566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277953,"user_name":"落曦","can_delete":false,"product_type":"c1","uid":1475039,"ip_address":"","ucode":"C70F7E2EDC3FD7","user_header":"https://static001.geekbang.org/account/avatar/00/16/81/df/066ffab3.jpg","comment_is_top":false,"comment_ctime":1612681931,"is_pvip":false,"replies":[{"id":"101079","content":"您好, 错误提示如下:<br>IndexError: list index out of range<br>是在<br> value = table.cell_value(rowx=4, colx=4)<br>出现了列表超过索引范围报的一个错误.<br><br>为什么报错的是一个列表呢?cell_value的底层实现是一个列表,所以报错提示是列表的索引超过了限制,<br><br>什么时候会报错index error ?比如列表只有三个元素,你引用第四个自然会报错,如果再往前面的代码追溯,就是文件打开失败,导致了列表没有数据,而你读取了_cell_values[4][4],所以超过了列表的长度限制,报了错<br><br>中间运行过程你可以了解一下, 你的解决办法是对的,从文件名下手.更正了文件路径错误的问题.后续我还会为你讲解异常处理,你可以在打开文件失败的时候就直接报文件打开失败错误,就不用通过内置错误间接分析文件名指定错误的问题了<br>","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612873890,"ip_address":"","comment_id":277953,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10202616523","product_id":100071001,"comment_content":"老师您好，我试了一下您的代码，第一个有问题，运行出错：<br>Traceback (most recent call last):<br>  File &quot;D:&#47;pycharmproject&#47;Exceldemo.py&quot;, line 10, in &lt;module&gt;<br>    value = table.cell_value(rowx=4, colx=4)<br>  File &quot;D:\\pycharmproject\\venv\\lib\\site-packages\\xlrd\\sheet.py&quot;, line 420, in cell_value<br>    return self._cell_values[rowx][colx]<br>IndexError: list index out of range<br><br>后来当我调试您github上的代码时，没有错误，然后根据留言区@旧草的提示，打开了您工资单.xlsx的文件，发现命名错误，于是我重命名为工资单.xls后来就能直接在excel上读取内容了。<br><br>所以我意识到xlrd 只适用于xls文件，老师您的电脑是mac，我用的windows可能是系统的不同吗？<br>python 3.7.0<br>xlrd 1.2.0<br>xlwt 1.3.0<br>pip  21.0.1<br>","like_count":2,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515224,"discussion_content":"您好, 错误提示如下:\nIndexError: list index out of range\n是在\n value = table.cell_value(rowx=4, colx=4)\n出现了列表超过索引范围报的一个错误.\n\n为什么报错的是一个列表呢?cell_value的底层实现是一个列表,所以报错提示是列表的索引超过了限制,\n\n什么时候会报错index error ?比如列表只有三个元素,你引用第四个自然会报错,如果再往前面的代码追溯,就是文件打开失败,导致了列表没有数据,而你读取了_cell_values[4][4],所以超过了列表的长度限制,报了错\n\n中间运行过程你可以了解一下, 你的解决办法是对的,从文件名下手.更正了文件路径错误的问题.后续我还会为你讲解异常处理,你可以在打开文件失败的时候就直接报文件打开失败错误,就不用通过内置错误间接分析文件名指定错误的问题了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612873890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1083763,"avatar":"https://static001.geekbang.org/account/avatar/00/10/89/73/2deb24ab.jpg","nickname":"武明","note":"","ucode":"73521E4633085B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361142,"discussion_content":"我也遇到这个问题了，看来以后上课之前看看下面的评论很有必要啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616598251,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337997,"user_name":"谢韬 Fragos","can_delete":false,"product_type":"c1","uid":2456075,"ip_address":"","ucode":"75F2178E340C5D","user_header":"https://static001.geekbang.org/account/avatar/00/25/7a/0b/b0d918da.jpg","comment_is_top":false,"comment_ctime":1647226481,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5942193777","product_id":100071001,"comment_content":"Excel 文件拆分的持xlsx格式的代码供大家参考。我把注释都加上了。 谢谢尹老师的指导。<br>from openpyxl import load_workbook<br>from pathlib import Path,PurePath<br>from openpyxl import Workbook<br>#工资单文件<br>salary_file = &#39;&#47;Users&#47;tx&#47;Desktop&#47;文章1代码&#47;工资单&#47;工资单.xlsx&#39;<br>#拆分文件保存路径<br>dst_path1 = &#39;&#47;Users&#47;tx&#47;Desktop&#47;文章1代码&#47;工资单&#39;<br>wb2= load_workbook(salary_file)<br>ws2=wb2.active<br># print(wb2.sheetnames)<br>#取得表头<br>for rw1 in ws2.iter_rows(min_row=1, max_col=None,max_row=1,values_only=True):<br>    salary_header=rw1<br>    #print(salary_header)<br>#定义写入文件的函数<br>def write_to_file (filename,cnt):<br>    wb3 = Workbook()<br>    ws3= wb3.create_sheet(&quot;本月工资&quot;)<br>    rw = 1<br>    for line in cnt:<br>        col=1<br>        for cell in line:<br>            ws3.cell(row=rw, column=col, value=cell)<br>            col+=1<br>        rw+=1<br>    wb3.save(PurePath(salary_file).with_name(filename).with_suffix(&#39;.xlsx&#39;))<br>#取得员工数量<br>employee_number= ws2.max_row<br>print(employee_number)<br>#取得每一行，并用第二个单元格作为新的文件名<br>for line in range (2,employee_number+1):<br>    for rwn in ws2.iter_rows(min_row=line, max_col=None, max_row=line, values_only=True):<br>        content = rwn<br>        print(content)<br>    #将表头和员工数量组成一个新文件<br>    new_content =[]<br>    #增加表头到要写入的内容中<br>    new_content.append(salary_header)<br>    new_content.append(content)<br>    write_to_file(content[1],cnt=new_content)<br>","like_count":1},{"had_liked":false,"id":330273,"user_name":"刘春富","can_delete":false,"product_type":"c1","uid":2681484,"ip_address":"","ucode":"3AC34CFA84C8A7","user_header":"","comment_is_top":false,"comment_ctime":1641889693,"is_pvip":false,"replies":[{"id":"121235","content":"https:&#47;&#47;github.com&#47;wilsonyin123&#47;python_productivity<br>这里有完整的源代码，为了保持文章阅读的连贯性，我没有贴完整代码上去，在这里可以下载到。","user_name":"作者回复","user_name_real":"编辑","uid":"1056235","ctime":1642856356,"ip_address":"","comment_id":330273,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5936856989","product_id":100071001,"comment_content":"# 调用自定义函数write_to_file()写入新的文件 <br>write_to_file(filename = content[1], cnt = new_content)<br><br>这个write_to_file()函数的代码是怎样的？谢谢","like_count":1,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547763,"discussion_content":"https://github.com/wilsonyin123/python_productivity\n这里有完整的源代码，为了保持文章阅读的连贯性，我没有贴完整代码上去，在这里可以下载到。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642856356,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325473,"user_name":"Geek_39bcb2","can_delete":false,"product_type":"c1","uid":2861326,"ip_address":"","ucode":"3547A456A66FAB","user_header":"","comment_is_top":false,"comment_ctime":1638970817,"is_pvip":false,"replies":[{"id":"119179","content":" pip3 install xlrd 是安装Python软件包的命令。换句话说pip实际上是执行了pip3.exe命令。<br>因此它需要和python.exe 一样，要放在命令行里运行。而你将它放入到了main.py中，也就出现了上面的错误。<br><br>我最开始学的时候是这样记住pip和python的关系的。pip是管理python能够使用哪些第三方库的，所以它们没有从属关系，都要在命令行运行。<br>","user_name":"作者回复","user_name_real":"编辑","uid":"1056235","ctime":1640148905,"ip_address":"","comment_id":325473,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5933938113","product_id":100071001,"comment_content":"初学者，老师帮忙解答一下找个是怎么回事<br>H:\\PycharmProjects\\pythonProject1\\venv\\Scripts\\python.exe H:&#47;PycharmProjects&#47;pythonProject1&#47;main.py<br>  File &quot;H:\\PycharmProjects\\pythonProject1\\main.py&quot;, line 2<br>    pip3 install xlrd<br>         ^<br>SyntaxError: invalid syntax<br><br>Process finished with exit code 1<br><br>","like_count":1,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540746,"discussion_content":" pip3 install xlrd 是安装Python软件包的命令。换句话说pip实际上是执行了pip3.exe命令。\n因此它需要和python.exe 一样，要放在命令行里运行。而你将它放入到了main.py中，也就出现了上面的错误。\n\n我最开始学的时候是这样记住pip和python的关系的。pip是管理python能够使用哪些第三方库的，所以它们没有从属关系，都要在命令行运行。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640148905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323879,"user_name":"巩会杰","can_delete":false,"product_type":"c1","uid":2849793,"ip_address":"","ucode":"A19798AA4E99F9","user_header":"https://static001.geekbang.org/account/avatar/00/2b/7c/01/f1b8ba78.jpg","comment_is_top":false,"comment_ctime":1638192085,"is_pvip":false,"replies":[{"id":"119174","content":"在第一课和课程开头会有我们的QQ群。<br>出现ModuleNotFoundError: No module named &#39;pip&#39;<br>的原因，是命令行找不到pip这条命令导致的。最有可能的原因是你在安装第一次软件包之后，它提示你需要更新pip，你按照它的提示执行了pip的升级。<br>这里有两种解决办法，一种是后续使用新版本Python推荐的方式：<br>python -m pip install xxx  这种方式来安装。<br>另一种是先在命令行执行<br>python -m ensurepip<br>执行完成后，再进行pip的更新<br>python -m pip install --upgrade pip  <br>即可解决你遇到的问题<br><br>它的根本原因是pip的命令搜索路径导致的，只在windows中出现","user_name":"作者回复","user_name_real":"编辑","uid":"1056235","ctime":1640148438,"ip_address":"","comment_id":323879,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5933159381","product_id":100071001,"comment_content":"卸载旧版本包出现错误：<br><br>C:\\Users\\Administrator&gt;pip uninstall xlrd<br>Traceback (most recent call last):<br>  File &quot;D:\\Program Files\\Python310\\lib\\runpy.py&quot;, line 196, in _run_module_as_main<br>    return _run_code(code, main_globals, None,<br>  File &quot;D:\\Program Files\\Python310\\lib\\runpy.py&quot;, line 86, in _run_code<br>    exec(code, run_globals)<br>  File &quot;D:\\Program Files\\Python310\\Scripts\\pip.exe\\__main__.py&quot;, line 4, in &lt;module&gt;<br>ModuleNotFoundError: No module named &#39;pip&#39;<br><br>开始就错误不知道怎么学习了，求老师解答下，这个有学习群吗？","like_count":1,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540741,"discussion_content":"在第一课和课程开头会有我们的QQ群。\n出现ModuleNotFoundError: No module named &#39;pip&#39;\n的原因，是命令行找不到pip这条命令导致的。最有可能的原因是你在安装第一次软件包之后，它提示你需要更新pip，你按照它的提示执行了pip的升级。\n这里有两种解决办法，一种是后续使用新版本Python推荐的方式：\npython -m pip install xxx  这种方式来安装。\n另一种是先在命令行执行\npython -m ensurepip\n执行完成后，再进行pip的更新\npython -m pip install --upgrade pip  \n即可解决你遇到的问题\n\n它的根本原因是pip的命令搜索路径导致的，只在windows中出现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640148438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322779,"user_name":"巩会杰","can_delete":false,"product_type":"c1","uid":2849793,"ip_address":"","ucode":"A19798AA4E99F9","user_header":"https://static001.geekbang.org/account/avatar/00/2b/7c/01/f1b8ba78.jpg","comment_is_top":false,"comment_ctime":1637583319,"is_pvip":false,"replies":[{"id":"117386","content":"首先纠正一下，cell_value()是一个方法。没有自动补全有很多情况，比如笔记本的性能不够，比如vscode等IDE的索引还没更新完。那么还有一种原因是，table的方法是一个动态方法（Python是一门动态语言，它在运行的时候才产生的方法，这种情况是没有办法提示的，比如一个典型的库flask、django都有这种情况） ，这里的cell_value()就属于这样一种。<br>不必深究","user_name":"作者回复","user_name_real":"编辑","uid":"1056235","ctime":1637940265,"ip_address":"","comment_id":322779,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5932550615","product_id":100071001,"comment_content":"报错--xlrd.biffh.XLRDError: Excel xlsx file; not supported<br>老师最后一行代码 table.cell_value。为什么输入table.后没有自动提示其他的属性？？<br><br>代码如下：<br>import xlrd<br><br>file = &#39;D:&#47;py-test&#47;AAA.xlsx&#39;<br>data = xlrd.open_workbook(file)<br>table = data.sheets()[0]<br>value = table.cell_value(rowx=4,colx=4)","like_count":1,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533725,"discussion_content":"首先纠正一下，cell_value()是一个方法。没有自动补全有很多情况，比如笔记本的性能不够，比如vscode等IDE的索引还没更新完。那么还有一种原因是，table的方法是一个动态方法（Python是一门动态语言，它在运行的时候才产生的方法，这种情况是没有办法提示的，比如一个典型的库flask、django都有这种情况） ，这里的cell_value()就属于这样一种。\n不必深究","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637940265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291084,"user_name":"Nichkhun","can_delete":false,"product_type":"c1","uid":2602519,"ip_address":"","ucode":"6ED7F62E9F1681","user_header":"https://static001.geekbang.org/account/avatar/00/27/b6/17/4212a3ca.jpg","comment_is_top":false,"comment_ctime":1620013261,"is_pvip":false,"replies":[{"id":"106143","content":"有的，和代码一起放在github中<br>地址：https:&#47;&#47;github.com&#47;wilsonyin123&#47;python_productivity","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1621326791,"ip_address":"","comment_id":291084,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5914980557","product_id":100071001,"comment_content":"老师，有课程里用到的文件吗？","like_count":1,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519364,"discussion_content":"有的，和代码一起放在github中\n地址：https://github.com/wilsonyin123/python_productivity","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621326791,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1191952,"avatar":"https://static001.geekbang.org/account/avatar/00/12/30/10/b683e05f.jpg","nickname":"cindy","note":"","ucode":"50BF91668735C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555077,"discussion_content":"链接都打不开了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646735308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278498,"user_name":"湘","can_delete":false,"product_type":"c1","uid":1588784,"ip_address":"","ucode":"198C9202D052E4","user_header":"https://static001.geekbang.org/account/avatar/00/18/3e/30/712491d6.jpg","comment_is_top":false,"comment_ctime":1612976850,"is_pvip":false,"replies":[{"id":"101241","content":"如果是windows系统可以考虑使用sublime vscode等软件打开代码，因为我是使用mac系统建立的文件，默认是utf-8的文件编码，而windows是gbk的，所以会有乱码出现","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1613144577,"ip_address":"","comment_id":278498,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5907944146","product_id":100071001,"comment_content":"老师，我从github上下载您的代码是乱码，请问我这边需要做什么操作才能看到代码呢？谢谢。","like_count":1,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515404,"discussion_content":"如果是windows系统可以考虑使用sublime vscode等软件打开代码，因为我是使用mac系统建立的文件，默认是utf-8的文件编码，而windows是gbk的，所以会有乱码出现","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613144577,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358383,"user_name":"Soyoger","can_delete":false,"product_type":"c1","uid":2967576,"ip_address":"北京","ucode":"D4D7BD0ABC4491","user_header":"https://static001.geekbang.org/account/avatar/00/2d/48/18/e524f344.jpg","comment_is_top":false,"comment_ctime":1664262451,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1664262451","product_id":100071001,"comment_content":"我建议把保存文件的时候，header和content放在一起写入新文件，而不是分开，这样就可以利用enumerate()函数，来生成对应的行或者列的下标控制。<br><br># 写入数据<br>for row, line in enumerate(content):<br>    for col, cell in enumerate(line):<br>        xlsheet.write(row, col, cell)","like_count":0},{"had_liked":false,"id":358379,"user_name":"Amaplan","can_delete":false,"product_type":"c1","uid":2765794,"ip_address":"上海","ucode":"FF7AD4404EC462","user_header":"","comment_is_top":false,"comment_ctime":1664259714,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1664259714","product_id":100071001,"comment_content":"用pandas合并的代码<br>from pathlib import Path,PurePath<br>from turtle import pd<br>import pandas as pd<br>from openpyxl import load_workbook<br>import xlwt<br>import xlrd<br>src_path=&#39;&#47;Users&#47;ee225&#47;mianshi&#47;Python自动化办公实战课&#47;Python自动化办公实战课&#47;文章1代码&#47;文章1代码&#47;调查问卷&#39;<br><br>p=Path(src_path)<br>files=[x for x in p.iterdir() if PurePath(x).match(&#39;*.xlsx&#39;)]<br><br>content=[]<br>for file in files :<br>    df1=pd.read_excel(file)<br>    username=file.stem<br>    data=pd.read_excel(file)<br>    answers1=data[&#39;Unnamed: 4&#39;][3]<br>    answers2=data[&#39;Unnamed: 4&#39;][9]<br><br>    temp=f&#39;{username},{answers1},{answers2}&#39;<br>    content.append(temp.split(&#39;,&#39;))<br>df6=pd.DataFrame(content,columns=[&#39;员工姓名&#39;,&#39;第一题&#39;,&#39;第二题&#39;])<br><br>df6.to_excel(&#39;excel1.xlsx&#39;, sheet_name=&#39;Sheet1&#39;, index=False) # index false为不写入索引<br>","like_count":0},{"had_liked":false,"id":358378,"user_name":"Amaplan","can_delete":false,"product_type":"c1","uid":2765794,"ip_address":"上海","ucode":"FF7AD4404EC462","user_header":"","comment_is_top":false,"comment_ctime":1664259687,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1664259687","product_id":100071001,"comment_content":"用pandas拆分的代码<br>import pandas as pd<br>from pathlib import Path,PurePath<br><br><br>src_path=&#39;&#47;Users&#47;ee225&#47;mianshi&#47;Python自动化办公实战课&#47;Python自动化办公实战课&#47;文章1代码&#47;文章1代码&#47;工资单&#47;工资单.xlsx&#39;<br><br>p=Path(src_path)<br><br>datas=pd.read_excel(p)<br>print(type(datas))<br>#print(datas.iloc[0])<br><br>print(&quot;输出列标题&quot;,datas.columns.values)<br><br>for  data in datas.iloc:<br>    #<br>    noname=data[&#39;员工编号&#39;]<br><br>    #data=pd.DataFrame(data1,columns=datas.columns.values)<br><br>    data.to_excel(f&#39;{noname}.xlsx&#39;, sheet_name=&#39;Sheet1&#39;,startrow=0, startcol=0) # index false为不写入索引, index=False<br>    data1=data.T<br>    print(type(data))","like_count":0},{"had_liked":false,"id":354066,"user_name":"　     °^°","can_delete":false,"product_type":"c1","uid":1751177,"ip_address":"广东","ucode":"6504F565CD9694","user_header":"https://static001.geekbang.org/account/avatar/00/1a/b8/89/0a7fff96.jpg","comment_is_top":false,"comment_ctime":1660055429,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660055429","product_id":100071001,"comment_content":"# 取得该目录下所有的xlsx格式文件p = Path(src_path)files = [x for x in p.iterdir() if PurePath(x).match(&#39;*.xls&#39;)]这里是不是写错了","like_count":0},{"had_liked":false,"id":354065,"user_name":"　     °^°","can_delete":false,"product_type":"c1","uid":1751177,"ip_address":"广东","ucode":"6504F565CD9694","user_header":"https://static001.geekbang.org/account/avatar/00/1a/b8/89/0a7fff96.jpg","comment_is_top":false,"comment_ctime":1660055425,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660055425","product_id":100071001,"comment_content":"# 取得该目录下所有的xlsx格式文件p = Path(src_path)files = [x for x in p.iterdir() if PurePath(x).match(&#39;*.xls&#39;)]","like_count":0},{"had_liked":false,"id":352411,"user_name":"薇薇的肉肉","can_delete":false,"product_type":"c1","uid":3068825,"ip_address":"","ucode":"5D08F991F11186","user_header":"https://static001.geekbang.org/account/avatar/00/2e/d3/99/e488fbac.jpg","comment_is_top":false,"comment_ctime":1658650636,"is_pvip":false,"replies":[{"id":"128212","content":"没有哈，老师用图文+代码已经可以把知识点讲清楚了，步骤也很清晰，可以试着跟着操作一下哦～","user_name":"编辑回复","user_name_real":"编辑","uid":"2189689","ctime":1658728431,"ip_address":"","comment_id":352411,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1658650636","product_id":100071001,"comment_content":"只有汉字，没有视频讲解吗<br>","like_count":0,"discussions":[{"author":{"id":2189689,"avatar":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","nickname":"🐑","note":"","ucode":"DE34B3B14287D1","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581329,"discussion_content":"没有哈，老师用图文+代码已经可以把知识点讲清楚了，步骤也很清晰，可以试着跟着操作一下哦～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658728432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347748,"user_name":"魏建鸿","can_delete":false,"product_type":"c1","uid":1921390,"ip_address":"","ucode":"B12A096890EE11","user_header":"https://static001.geekbang.org/account/avatar/00/1d/51/6e/5309b6e2.jpg","comment_is_top":false,"comment_ctime":1654395538,"is_pvip":false,"replies":[{"id":"126760","content":"不会啊，我看了下是正常的。你加我微信seekforli，我私聊发你","user_name":"编辑回复","user_name_real":"编辑","uid":"2189689","ctime":1654396880,"ip_address":"","comment_id":347748,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1654395538","product_id":100071001,"comment_content":"老师好，百度网盘下载的实战课资料名称是乱码，另外，每课的excel表格下载链接不能用，怎么办？","like_count":0,"discussions":[{"author":{"id":2189689,"avatar":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","nickname":"🐑","note":"","ucode":"DE34B3B14287D1","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574833,"discussion_content":"不会啊，我看了下是正常的。你加我微信seekforli，我私聊发你","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654396880,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345280,"user_name":"stark","can_delete":false,"product_type":"c1","uid":1143399,"ip_address":"","ucode":"ADC5C2AE5B97C8","user_header":"https://static001.geekbang.org/account/avatar/00/11/72/67/aa52812a.jpg","comment_is_top":false,"comment_ctime":1652169556,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652169556","product_id":100071001,"comment_content":"最新版本不支持.xlsx , pip安装可降低版本 pip install xlrd==1.2.0  ","like_count":0},{"had_liked":false,"id":343730,"user_name":"Geek_cbbc27","can_delete":false,"product_type":"c1","uid":2816679,"ip_address":"","ucode":"A2B7A0B308A805","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/snAiaboveyqlkEkA6iaibicoiavjIic2EkGfT1Gvqia7PD13lTPS3MSKZ7g7D9gD0e26GN6lVb71R5kdbp5PWicQBibeKicw/132","comment_is_top":false,"comment_ctime":1651026683,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651026683","product_id":100071001,"comment_content":"为什么 下载的课件excel都打不开呀","like_count":0},{"had_liked":false,"id":341991,"user_name":"薛定谔的猫","can_delete":false,"product_type":"c1","uid":2976509,"ip_address":"","ucode":"D36D2BA635D930","user_header":"https://static001.geekbang.org/account/avatar/00/2d/6a/fd/2e357d8e.jpg","comment_is_top":false,"comment_ctime":1649943253,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649943253","product_id":100071001,"comment_content":"今天收获满满，系统的掌握了excel的拆分与合并","like_count":0},{"had_liked":false,"id":341706,"user_name":"章冰誉","can_delete":false,"product_type":"c1","uid":2558144,"ip_address":"","ucode":"278321D1D26478","user_header":"","comment_is_top":false,"comment_ctime":1649777203,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1649777203","product_id":100071001,"comment_content":"老师，我用 xlwt 方法去写的xlsx文件，打开时报错，提示“Excel 无法打开文件“2023.xlsx”，因为文件格式或文件扩展名无效。请确定文件未损坏，并且文件扩展名与文件的格式匹配。”<br>请问这个问题应该怎么处理？","like_count":0,"discussions":[{"author":{"id":1474214,"avatar":"https://static001.geekbang.org/account/avatar/00/16/7e/a6/4e331ef4.jpg","nickname":"骑行的掌柜J","note":"","ucode":"3163102651C653","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":563891,"discussion_content":"楼上好像有人遇到类似的错误，你往上翻翻看解决办法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650105598,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335553,"user_name":"夏日","can_delete":false,"product_type":"c1","uid":2910772,"ip_address":"","ucode":"071288DA99DA33","user_header":"https://static001.geekbang.org/account/avatar/00/2c/6a/34/6071b39d.jpg","comment_is_top":false,"comment_ctime":1645584783,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645584783","product_id":100071001,"comment_content":"请问如何安装扩展库？","like_count":0},{"had_liked":false,"id":335272,"user_name":"周文玲","can_delete":false,"product_type":"c1","uid":2717044,"ip_address":"","ucode":"DA071849C9743E","user_header":"","comment_is_top":false,"comment_ctime":1645435020,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645435020","product_id":100071001,"comment_content":"import xlrd<br>file =&#39;&#47;Users&#47;Library&#47;Containers&#47;com.microsoft.Excel&#47;Data&#47;Desktop&#47;北京.xlsx&#39;<br>data = xlrd.open_workbook(file)<br>Traceback (most recent call last):<br>  File &quot;&lt;pyshell#52&gt;&quot;, line 1, in &lt;module&gt;<br>    data = xlrd.open_workbook(file)<br>  File &quot;&#47;Library&#47;Frameworks&#47;Python.framework&#47;Versions&#47;3.10&#47;lib&#47;python3.10&#47;site-packages&#47;xlrd&#47;__init__.py&quot;, line 170, in open_workbook<br>    raise XLRDError(FILE_FORMAT_DESCRIPTIONS[file_format]+&#39;; not supported&#39;)<br>xlrd.biffh.XLRDError: Excel xlsx file; not supported<br><br>打开文件一直报错，按照步骤操作后续的也不成功，这个怎么解决呢？","like_count":0},{"had_liked":false,"id":332943,"user_name":"inrtyx","can_delete":false,"product_type":"c1","uid":1246178,"ip_address":"","ucode":"81CD18FF34ABAB","user_header":"https://static001.geekbang.org/account/avatar/00/13/03/e2/5768d26e.jpg","comment_is_top":false,"comment_ctime":1643860073,"is_pvip":true,"replies":[{"id":"122137","content":"当然不用了，Windows也可以运行啊，在安装Python软件包的时候选择windows版本即可","user_name":"作者回复","user_name_real":"编辑","uid":"1056235","ctime":1644902584,"ip_address":"","comment_id":332943,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1643860073","product_id":100071001,"comment_content":"为了学习必须买个mac啊","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551118,"discussion_content":"当然不用了，Windows也可以运行啊，在安装Python软件包的时候选择windows版本即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644902584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332423,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1111985,"ip_address":"","ucode":"9DADD72C193296","user_header":"https://static001.geekbang.org/account/avatar/00/10/f7/b1/982ea185.jpg","comment_is_top":false,"comment_ctime":1643244361,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1643244361","product_id":100071001,"comment_content":"合并多个excel 文件，应该有单个库可以操作的吧？ xlwings,openpyxl ","like_count":0},{"had_liked":false,"id":328573,"user_name":"Alizee","can_delete":false,"product_type":"c1","uid":1006724,"ip_address":"","ucode":"DF742FCAFD7659","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5c/84/2a7ff72d.jpg","comment_is_top":false,"comment_ctime":1640776704,"is_pvip":false,"replies":[{"id":"119888","content":"你好！我是专栏编辑，你可以加我微信，我发给你18810331805","user_name":"编辑回复","user_name_real":"编辑","uid":"2189689","ctime":1641188418,"ip_address":"","comment_id":328573,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1640776704","product_id":100071001,"comment_content":"<br>您好老师，之前买的课程现在开始学习，但是GitHub里链接的文章代码无法下载，请老师指导原因，谢谢老师。Safari 不能连接到服务器<br>Safari 打不开页面<br>&quot;https:&#47;&#47;raw.githubusercontent.com&#47;wilsonyin123&#47;python_productivity&#47;main&#47;文章1代<br>码.zip”，因为无法连接到服务器<br>“raw.githubusercontent.com”","like_count":0,"discussions":[{"author":{"id":2189689,"avatar":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","nickname":"🐑","note":"","ucode":"DE34B3B14287D1","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543509,"discussion_content":"你好！我是专栏编辑，你可以加我微信，我发给你18810331805","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641188418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328453,"user_name":"Alizee","can_delete":false,"product_type":"c1","uid":1006724,"ip_address":"","ucode":"DF742FCAFD7659","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5c/84/2a7ff72d.jpg","comment_is_top":false,"comment_ctime":1640743337,"is_pvip":false,"replies":[{"id":"119887","content":"你好！我是专栏编辑，你可以加我微信，我发给你18810331805","user_name":"编辑回复","user_name_real":"编辑","uid":"2189689","ctime":1641188391,"ip_address":"","comment_id":328453,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1640743337","product_id":100071001,"comment_content":"老师，您好，之前买的课程现在开始学习，但是GitHud网站的文章代码无法下载，请老师知道原因，谢谢老师。以下是网站显示的内容：<br>无法访问此网站<br>网tN hetps:raw.githubusercontent.com&#47;vilsonyin123&#47;pythonproductivity&#47;main&#47;文章<br>1代码,z1p 的网 可能暂时无法连接，或者已已永久性地移动到了新网址","like_count":0,"discussions":[{"author":{"id":2189689,"avatar":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","nickname":"🐑","note":"","ucode":"DE34B3B14287D1","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":543508,"discussion_content":"你好！我是专栏编辑，你可以加我微信，我发给你18810331805","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641188391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322777,"user_name":"巩会杰","can_delete":false,"product_type":"c1","uid":2849793,"ip_address":"","ucode":"A19798AA4E99F9","user_header":"https://static001.geekbang.org/account/avatar/00/2b/7c/01/f1b8ba78.jpg","comment_is_top":false,"comment_ctime":1637582688,"is_pvip":false,"replies":[{"id":"117385","content":"解决办法：<br><br>卸载新版本 pip uninstall xlrd<br>安装老版本：pip install xlrd=1.2.0 (或者更早版本)<br><br>产生问题的根源是，xlrd这个软件包最新的版本不支持xlsx格式导致的，一般软件更新兼容性会更好，但是这个偏偏是个例，它的兼容性发生了倒退，所以我们使用更早期的版本来实现，excel文件的读取。<br><br>","user_name":"作者回复","user_name_real":"编辑","uid":"1056235","ctime":1637940055,"ip_address":"","comment_id":322777,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637582688","product_id":100071001,"comment_content":"读取表格时候报错提示：xlrd.biffh.XLRDError: Excel xlsx file; not supported<br><br>代码如下：<br><br>import xlrd<br>file=&#39;D:&#47;py-test&#47;AAA.xlsx&#39;<br>data=xlrd.open_workbook(file)<br>table=xlrd.sheet()[0]<br>value=table.cell_value(rowx=4,colx=4)","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533722,"discussion_content":"解决办法：\n\n卸载新版本 pip uninstall xlrd\n安装老版本：pip install xlrd=1.2.0 (或者更早版本)\n\n产生问题的根源是，xlrd这个软件包最新的版本不支持xlsx格式导致的，一般软件更新兼容性会更好，但是这个偏偏是个例，它的兼容性发生了倒退，所以我们使用更早期的版本来实现，excel文件的读取。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637940055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308789,"user_name":"晁军显","can_delete":false,"product_type":"c1","uid":2669806,"ip_address":"","ucode":"6D2E7927EA22EA","user_header":"","comment_is_top":false,"comment_ctime":1629798303,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629798303","product_id":100071001,"comment_content":"的确python处理更简便，之前曾用java处理过","like_count":0},{"had_liked":false,"id":308011,"user_name":"Tachikoma","can_delete":false,"product_type":"c1","uid":2728319,"ip_address":"","ucode":"F433B88A29D01E","user_header":"https://static001.geekbang.org/account/avatar/00/29/a1/7f/ccace689.jpg","comment_is_top":false,"comment_ctime":1629357570,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629357570","product_id":100071001,"comment_content":"直接用pandas也行","like_count":0},{"had_liked":false,"id":304797,"user_name":"，，，","can_delete":false,"product_type":"c1","uid":2563102,"ip_address":"","ucode":"8B3CE11669FB88","user_header":"https://static001.geekbang.org/account/avatar/00/27/1c/1e/b5d76759.jpg","comment_is_top":false,"comment_ctime":1627620359,"is_pvip":false,"replies":[{"id":"110522","content":"是的，有这个问题，由于最新的2.0版本只支持了xls，我最近会给咱们同学补充一个加餐如何使用pandas和openpyxl来操作xlsx","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1628051254,"ip_address":"","comment_id":304797,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627620359","product_id":100071001,"comment_content":"xlrd不支持打开.xlsx文件?","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524169,"discussion_content":"是的，有这个问题，由于最新的2.0版本只支持了xls，我最近会给咱们同学补充一个加餐如何使用pandas和openpyxl来操作xlsx","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628051254,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303711,"user_name":"小卢","can_delete":false,"product_type":"c1","uid":2010483,"ip_address":"","ucode":"EE3BB35EBF5931","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/kQx90MH3kCpNVFiaZWRHicQGBEE4ntt75evcwibTPH9z89ic1zqgBmMUj9HSh5C7PsqskU87cPOsgBmJ0ZucO3VNdA/132","comment_is_top":false,"comment_ctime":1626940076,"is_pvip":true,"replies":[{"id":"110531","content":"你好，多个文件夹操作，无论在爬虫还是自动化办公都会涉及，所以应该说包含在两个工作场景下。<br><br>但是他们操作的工具不同。自动化办公场景下的多个文件夹操作往往是建立多个路径，分别读取里面的内容。用本专栏当中的循环for in即可实现。但是在爬虫领域，多个子文件夹往往是和网页里的目录层级对应的，例如网站中有多个网页，而多个网页里面有多个内容需要存储。这时候才会应用到许多的文件夹和文件。而在创建这些文件的时候，需要保持和网页里的内容一一对应。所以你可能也会想到这里，除了循环之外，还需要增加判断以及建立网页和文件的映射关系。要比自动化办公当中的处理更加复杂。","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1628052124,"ip_address":"","comment_id":303711,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1626940076","product_id":100071001,"comment_content":"老师好，请教下如果一个大文件夹里面有许多子文件夹，子文件夹里分别还有许多文件，如果想提取里面的文件名，这个是属于爬虫范畴还是办公自动化呢","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523791,"discussion_content":"你好，多个文件夹操作，无论在爬虫还是自动化办公都会涉及，所以应该说包含在两个工作场景下。\n\n但是他们操作的工具不同。自动化办公场景下的多个文件夹操作往往是建立多个路径，分别读取里面的内容。用本专栏当中的循环for in即可实现。但是在爬虫领域，多个子文件夹往往是和网页里的目录层级对应的，例如网站中有多个网页，而多个网页里面有多个内容需要存储。这时候才会应用到许多的文件夹和文件。而在创建这些文件的时候，需要保持和网页里的内容一一对应。所以你可能也会想到这里，除了循环之外，还需要增加判断以及建立网页和文件的映射关系。要比自动化办公当中的处理更加复杂。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628052124,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2728319,"avatar":"https://static001.geekbang.org/account/avatar/00/29/a1/7f/ccace689.jpg","nickname":"Tachikoma","note":"","ucode":"F433B88A29D01E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389618,"discussion_content":"直接使用os模块中的path.walk方法，具体查一下，挺方便的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629357654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2690854,"avatar":"https://static001.geekbang.org/account/avatar/00/29/0f/26/61d69b5d.jpg","nickname":"兴","note":"","ucode":"DEB3F66725454F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385896,"discussion_content":"属于递归","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627340821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303436,"user_name":"皮特尔","can_delete":false,"product_type":"c1","uid":1017161,"ip_address":"","ucode":"313862C91DD325","user_header":"https://static001.geekbang.org/account/avatar/00/0f/85/49/585c69c4.jpg","comment_is_top":false,"comment_ctime":1626786282,"is_pvip":false,"replies":[{"id":"110529","content":"是的，会有问题。<br>但考虑到使用Python来操作Excel的话，多数是要执行很多格式相同并且是重复性的操作。<br>在这种需要批量操作的特定场景下，可以将有内容的Excel做成模板。通过Python和要写入的数据。组合之后再一次性写入Excel即可","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1628051941,"ip_address":"","comment_id":303436,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626786282","product_id":100071001,"comment_content":"从Excel里读出来的内容可以直接用元组保存。<br>代码里用的 temp.split(&#39;,&#39;) 这种方式，如果Excel内容里也有 &#39;,&#39; ，会有bug","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523677,"discussion_content":"是的，会有问题。\n但考虑到使用Python来操作Excel的话，多数是要执行很多格式相同并且是重复性的操作。\n在这种需要批量操作的特定场景下，可以将有内容的Excel做成模板。通过Python和要写入的数据。组合之后再一次性写入Excel即可","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628051941,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303430,"user_name":"许超","can_delete":false,"product_type":"c1","uid":2669974,"ip_address":"","ucode":"043216A3021CAD","user_header":"","comment_is_top":false,"comment_ctime":1626784388,"is_pvip":false,"replies":[{"id":"110527","content":"是的，是有这个问题，稍后我会通过加餐的方式给大家提供新的可用的工具。比如openpyxl 和pandas","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1628051702,"ip_address":"","comment_id":303430,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626784388","product_id":100071001,"comment_content":"Successfully uninstalled xlrd-2.0.1<br>最近xlrd更新到了2.0.1版本，只支持.xls文件<br>pip uninstall xlrd<br>pip install xlrd==1.2.0","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523675,"discussion_content":"是的，是有这个问题，稍后我会通过加餐的方式给大家提供新的可用的工具。比如openpyxl 和pandas","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628051702,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302948,"user_name":"LSY","can_delete":false,"product_type":"c1","uid":1145135,"ip_address":"","ucode":"3E390DDF77CF7B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqRllUL85m1a5TI5tVChCgYE6z1AIb2voAlZPmUibZ6yJpcsQCAeeJSehUmNn7AS6EM2bmhgwBI53w/132","comment_is_top":false,"comment_ctime":1626449190,"is_pvip":false,"replies":[{"id":"109626","content":"注意报错信息 PermissionError，写入文件的目录权限不够，改成其他目录尝试保存","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1626488758,"ip_address":"","comment_id":302948,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626449190","product_id":100071001,"comment_content":"在最后一步workbook.save(dst_file)的时候会报错：<br>PermissionError                           Traceback (most recent call last)<br>&lt;ipython-input-14-08ea826facd9&gt; in &lt;module&gt;<br>      6         col += 1<br>      7     row += 1<br>----&gt; 8 workbook.save(dst_file)<br><br>~\\Anaconda3\\lib\\site-packages\\xlwt\\Workbook.py in save(self, filename_or_stream)<br>    708 <br>    709         doc = CompoundDoc.XlsDoc()<br>--&gt; 710         doc.save(filename_or_stream, self.get_biff_data())<br>    711 <br>    712 <br><br>~\\Anaconda3\\lib\\site-packages\\xlwt\\CompoundDoc.py in save(self, file_name_or_filelike_obj, stream)<br>    260         we_own_it = not hasattr(f, &#39;write&#39;)<br>    261         if we_own_it:<br>--&gt; 262             f = open(file_name_or_filelike_obj, &#39;w+b&#39;)<br>    263         f.write(self.header)<br>    264         f.write(self.packed_MSAT_1st)<br><br>PermissionError: [Errno 13] Permission denied: &#39;D:&#47;极客时间-Python办公&#47;Practice&#47;第一章&#47;合并&#47;汇总&#39;<br>","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523489,"discussion_content":"注意报错信息 PermissionError，写入文件的目录权限不够，改成其他目录尝试保存","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626488758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302433,"user_name":"Geek_69dabe","can_delete":false,"product_type":"c1","uid":2304211,"ip_address":"","ucode":"0B480B4AF4D17E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/gfyBmUHNaKKZ5jogia2WR3XIkCkAbpmL09vkTtJYyIC6U1YkJlbAxqQ5vJ8icyubMGnMZmru4H7eYZ8DyUEMHSLA/132","comment_is_top":false,"comment_ctime":1626224473,"is_pvip":false,"replies":[{"id":"109627","content":"你好，13-15讲文章内是完整代码，且代码较短，我没有单独打包放在Github上","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1626488889,"ip_address":"","comment_id":302433,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626224473","product_id":100071001,"comment_content":"github上没有看到第13到15的课件","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523305,"discussion_content":"你好，13-15讲文章内是完整代码，且代码较短，我没有单独打包放在Github上","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626488889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301659,"user_name":"程序员的冬天","can_delete":false,"product_type":"c1","uid":1098029,"ip_address":"","ucode":"79CFC94CB1F92D","user_header":"https://static001.geekbang.org/account/avatar/00/10/c1/2d/9186e340.jpg","comment_is_top":false,"comment_ctime":1625802074,"is_pvip":false,"replies":[{"id":"109628","content":"感谢指正，稍后更新文字和Github。<br>另openpyxl和pandas作为加餐很快会更新上去<br>感谢反馈！","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1626488993,"ip_address":"","comment_id":301659,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625802074","product_id":100071001,"comment_content":"给的demo文件中文件名是xlsx格式，其实是xls格式的，对于openpyxl读取文件会报错的，建议作者把两个库的实现都写出来","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523057,"discussion_content":"感谢指正，稍后更新文字和Github。\n另openpyxl和pandas作为加餐很快会更新上去\n感谢反馈！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626488993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298616,"user_name":"Yanlan","can_delete":false,"product_type":"c1","uid":2648339,"ip_address":"","ucode":"7593342C50B86A","user_header":"https://static001.geekbang.org/account/avatar/00/28/69/13/2093c237.jpg","comment_is_top":false,"comment_ctime":1624239051,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624239051","product_id":100071001,"comment_content":"请问课件中的代码为啥不能复制？","like_count":0},{"had_liked":false,"id":297412,"user_name":"廖凯","can_delete":false,"product_type":"c1","uid":2448102,"ip_address":"","ucode":"DD1487CE82877A","user_header":"https://static001.geekbang.org/account/avatar/00/25/5a/e6/01be3d2d.jpg","comment_is_top":false,"comment_ctime":1623508159,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623508159","product_id":100071001,"comment_content":"奇怪，为啥github登录不上啊<br>","like_count":0},{"had_liked":false,"id":296838,"user_name":"HF","can_delete":false,"product_type":"c1","uid":1112811,"ip_address":"","ucode":"0839195346C3CC","user_header":"https://static001.geekbang.org/account/avatar/00/10/fa/eb/84d4de33.jpg","comment_is_top":false,"comment_ctime":1623197992,"is_pvip":true,"replies":[{"id":"108736","content":"开发工具推荐用pycharm vscode， 如果想从事数据分析方向也可以采用jupyter","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1624895384,"ip_address":"","comment_id":296838,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623197992","product_id":100071001,"comment_content":"好像没有讲用什么开发工具","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521605,"discussion_content":"开发工具推荐用pycharm vscode， 如果想从事数据分析方向也可以采用jupyter","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624895384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295933,"user_name":"小刘冲冲冲鸭","can_delete":false,"product_type":"c1","uid":2648480,"ip_address":"","ucode":"D78CA78F90F09A","user_header":"","comment_is_top":false,"comment_ctime":1622651451,"is_pvip":false,"replies":[{"id":"107658","content":"你好，问题可以再具体一点，我在代码中通过dst_file变量指定的写入文件的路径","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1623030425,"ip_address":"","comment_id":295933,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622651451","product_id":100071001,"comment_content":"这个制定路径怎么写入呀","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521269,"discussion_content":"你好，问题可以再具体一点，我在代码中通过dst_file变量指定的写入文件的路径","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623030425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294859,"user_name":"范莎莎","can_delete":false,"product_type":"c1","uid":2618947,"ip_address":"","ucode":"63F08ACB102EF7","user_header":"","comment_is_top":false,"comment_ctime":1622113820,"is_pvip":false,"replies":[{"id":"107655","content":"你好，看看是什么样的错误提示，git clone 下载失败一般是网络原因导致的， 解决办法是使用镜像站，例如： github下载地址是： www.github.com&#47;aaa&#47;bbb <br>可以改为： github.com.cnpmjs.org&#47;aaa&#47;bbb","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1623029997,"ip_address":"","comment_id":294859,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622113820","product_id":100071001,"comment_content":"老师，代码怎么拉下来呢，我git clone的时候一直有报错，拉不下来","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520845,"discussion_content":"你好，看看是什么样的错误提示，git clone 下载失败一般是网络原因导致的， 解决办法是使用镜像站，例如： github下载地址是： www.github.com/aaa/bbb \n可以改为： github.com.cnpmjs.org/aaa/bbb","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623029997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294614,"user_name":"忧伤的胡萝卜","can_delete":false,"product_type":"c1","uid":2352625,"ip_address":"","ucode":"6881B0A6AED809","user_header":"https://static001.geekbang.org/account/avatar/00/23/e5/f1/880994da.jpg","comment_is_top":false,"comment_ctime":1622018644,"is_pvip":false,"replies":[{"id":"106902","content":"课程里的所有代码都是在这里<br><br>https:&#47;&#47;codesandbox.io&#47;s&#47;react-hooks-course-20vzg","user_name":"编辑回复","user_name_real":"李辰洋","uid":"2189689","ctime":1622020434,"ip_address":"","comment_id":294614,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1622018644","product_id":100071001,"comment_content":"老师您好，访问不了github，有其他可以下载源码和示例文件的地方么？","like_count":0,"discussions":[{"author":{"id":2189689,"avatar":"https://static001.geekbang.org/account/avatar/00/21/69/79/b4132042.jpg","nickname":"🐑","note":"","ucode":"DE34B3B14287D1","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520736,"discussion_content":"课程里的所有代码都是在这里\n\nhttps://codesandbox.io/s/react-hooks-course-20vzg","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622020434,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290736,"user_name":"J--","can_delete":false,"product_type":"c1","uid":2600058,"ip_address":"","ucode":"40799E5C409F21","user_header":"https://static001.geekbang.org/account/avatar/00/27/ac/7a/9efd6443.jpg","comment_is_top":false,"comment_ctime":1619709877,"is_pvip":false,"replies":[{"id":"106150","content":"在windows下还是很好实现的，但是其他系统实现起来比较困难<br><br>这里用到的是win32com接口，调用office的VBA脚本，所以只能支持windows。通过官方文档 https:&#47;&#47;docs.microsoft.com&#47;zh-CN&#47;office&#47;vba&#47;api&#47;Excel.Workbooks.Open<br>参考可以得知，打开文件，有个参数是Password<br><br>因此可以采用下面方式打开<br>from win32com.client import Dispatch  <br>excel = Dispatch(&#39;Excel.Application&#39;)<br>excel.Workbooks.Open(filename, UpdateLinks=False, ReadOnly=False, Format=None, Password=password, WriteResPassword=password)<br><br>更多操作可以参考后续的文章操作，或搜索python+win32 python+pywin32+excel实现加密excel文件的读写 ","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1621327730,"ip_address":"","comment_id":290736,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1619709877","product_id":100071001,"comment_content":"我的工作中会经常操作合并几十个加了密码工作簿的excel表数据到一个表中，或者把一个工作表拆分成几十个工作表并且需加密才能下发的工作，目前都是手动操作，工作量极大，python可以实现批量拆分合并excel表数据<br>请问python可以解决批量打开加密excel文件、批量解密excel文件或者批量给exce文件加密的问题吗？","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519275,"discussion_content":"在windows下还是很好实现的，但是其他系统实现起来比较困难\n\n这里用到的是win32com接口，调用office的VBA脚本，所以只能支持windows。通过官方文档 https://docs.microsoft.com/zh-CN/office/vba/api/Excel.Workbooks.Open\n参考可以得知，打开文件，有个参数是Password\n\n因此可以采用下面方式打开\nfrom win32com.client import Dispatch  \nexcel = Dispatch(&amp;#39;Excel.Application&amp;#39;)\nexcel.Workbooks.Open(filename, UpdateLinks=False, ReadOnly=False, Format=None, Password=password, WriteResPassword=password)\n\n更多操作可以参考后续的文章操作，或搜索python+win32 python+pywin32+excel实现加密excel文件的读写 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621327730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2844129,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/65/e1/fcde8499.jpg","nickname":"扬羽流风","note":"","ucode":"1F87245DCFEDA3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":544051,"discussion_content":"是财务没错了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641387328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288805,"user_name":"Zero Li","can_delete":false,"product_type":"c1","uid":1217114,"ip_address":"","ucode":"7F2AAC42DBC6FE","user_header":"https://static001.geekbang.org/account/avatar/00/12/92/5a/760c6454.jpg","comment_is_top":false,"comment_ctime":1618706360,"is_pvip":false,"replies":[{"id":"104964","content":"试试将扩展名改为xls，极有可能Office版本不兼容。如果问题依旧，可以考虑将写入excel的库改为openpyxl再次尝试。","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1618987125,"ip_address":"","comment_id":288805,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1618706360","product_id":100071001,"comment_content":"老师程序写完后没有任何报错，一切运行正常，但是另存后的EXCEL文件无法打开是什么原因？提示‘EXCEL无法打开“XXXX.xlsx”文件，因为文件格式或扩展名无效。请确定文件未损坏，并且文件扩展名与文件格式匹配’.请问老师这又看是什么原因导致的？","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518744,"discussion_content":"试试将扩展名改为xls，极有可能Office版本不兼容。如果问题依旧，可以考虑将写入excel的库改为openpyxl再次尝试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618987125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285839,"user_name":"mark for luck","can_delete":false,"product_type":"c1","uid":1798114,"ip_address":"","ucode":"877AC961687A93","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/P7GtgVmSNibiaZY9ibCiaohicscwb03j1ROjJUqFkCOnkMQv5JQXZia56nmhOtxr2jOBUfMS94zsvXvnw7RbtpO0dJbQ/132","comment_is_top":false,"comment_ctime":1617028135,"is_pvip":false,"replies":[{"id":"103936","content":"这个并不是报错，是指你安装的这两个软件包已经被安装过。可以继续使用这两个库了。","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1617278418,"ip_address":"","comment_id":285839,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1617028135","product_id":100071001,"comment_content":"C:\\Users\\华为&gt;pip3 install xlrd<br>Requirement already satisfied: xlrd in c:\\users\\华为\\appdata\\local\\programs\\python\\python39\\lib\\site-packages (2.0.1)<br>WARNING: You are using pip version 20.2.3; however, version 21.0.1 is available.<br>You should consider upgrading via the &#39;c:\\users\\华为\\appdata\\local\\programs\\python\\python39\\python.exe -m pip install --upgrade pip&#39; command.<br><br>C:\\Users\\华为&gt;pip3 install xlwt<br>Requirement already satisfied: xlwt in c:\\users\\华为\\appdata\\local\\programs\\python\\python39\\lib\\site-packages (1.3.0)<br>WARNING: You are using pip version 20.2.3; however, version 21.0.1 is available.<br>You should consider upgrading via the &#39;c:\\users\\华为\\appdata\\local\\programs\\python\\python39\\python.exe -m pip install --upgrade pip&#39; command.<br>安装报错是怎么回事，尹老师","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517797,"discussion_content":"这个并不是报错，是指你安装的这两个软件包已经被安装过。可以继续使用这两个库了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617278418,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2373172,"avatar":"","nickname":"Geek_ebfbe3","note":"","ucode":"22F42F16F4D1A0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":370643,"discussion_content":"遇到这个提示，运行文中代码，提示modulenotdounderror：no moudule name xlrd，是哪里错了，求老师指点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619491641,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285495,"user_name":"FILWY","can_delete":false,"product_type":"c1","uid":1384858,"ip_address":"","ucode":"4DD9931C23745A","user_header":"https://static001.geekbang.org/account/avatar/00/15/21/9a/a40452c8.jpg","comment_is_top":false,"comment_ctime":1616843793,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616843793","product_id":100071001,"comment_content":"老师，excel的分类汇总功能有办法通过python实现吗，找了好久都没找到，网上找到的都是分类汇总到一张新的表，跟原生excel操作分类汇总产生的结果不一样","like_count":0},{"had_liked":false,"id":282874,"user_name":"陈芳","can_delete":false,"product_type":"c1","uid":2448316,"ip_address":"","ucode":"E3BED55002D32D","user_header":"https://static001.geekbang.org/account/avatar/00/25/5b/bc/2cc1cc02.jpg","comment_is_top":false,"comment_ctime":1615450079,"is_pvip":false,"replies":[{"id":"102664","content":"首先这种原因是因为python没有正确安装导致的，并非执行错误。可以通过<br>https:&#47;&#47;www.python.org&#47;downloads&#47;<br>先下载安装windows版本的python解释器之后，就能正确运行python了","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1615474348,"ip_address":"","comment_id":282874,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615450079","product_id":100071001,"comment_content":"老师，我完全是python零基础，通过win+r，输入cmd，打开后是黑色对话框。在对话框中输入【pip3 install xlrd     pip3 install xlwt 】显示“pip3”不是内部或外部命令，也不是可运行的程序或批处理文件。<br>请问该如何安装。","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516864,"discussion_content":"首先这种原因是因为python没有正确安装导致的，并非执行错误。可以通过\nhttps://www.python.org/downloads/\n先下载安装windows版本的python解释器之后，就能正确运行python了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615474348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281543,"user_name":"小小把戏","can_delete":false,"product_type":"c1","uid":2197331,"ip_address":"","ucode":"7C2D5DE8AF4E9E","user_header":"https://static001.geekbang.org/account/avatar/00/21/87/53/6b6d6815.jpg","comment_is_top":false,"comment_ctime":1614781231,"is_pvip":false,"replies":[{"id":"102301","content":"PurePath() 的功能是取得一个路径的完整路径,并统一成一个格式.为什么没有直接用“c:\\xxx\\yyy\\zzz.exe”这种字符串表示路径,是因为windows和linux的路径写法不同,如果直接使用字符串需要对不同操作系统处理两遍路径<br>PurePath()中的x就是windows或者linux的路径字符串,经过PurePath()的转换之后会变成标准的路径PosixPath对象, 对PosixPath对象就可以再使用match()匹配文件名了","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1614915189,"ip_address":"","comment_id":281543,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614781231","product_id":100071001,"comment_content":"PurePath(x).match(&#39;*.xlsx&#39;)。<br>我看文档里PurePath.match(pattern)\t判断当前路径是否匹配指定通配符。我不是很懂你在PurePath后面加X的情况，老师解释一下。","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516436,"discussion_content":"PurePath() 的功能是取得一个路径的完整路径,并统一成一个格式.为什么没有直接用“c:\\xxx\\yyy\\zzz.exe”这种字符串表示路径,是因为windows和linux的路径写法不同,如果直接使用字符串需要对不同操作系统处理两遍路径\nPurePath()中的x就是windows或者linux的路径字符串,经过PurePath()的转换之后会变成标准的路径PosixPath对象, 对PosixPath对象就可以再使用match()匹配文件名了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614915189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280682,"user_name":"炫丽生活","can_delete":false,"product_type":"c1","uid":2451645,"ip_address":"","ucode":"062B8C384B02C4","user_header":"https://static001.geekbang.org/account/avatar/00/25/68/bd/00ffcb80.jpg","comment_is_top":false,"comment_ctime":1614316878,"is_pvip":false,"replies":[{"id":"101974","content":"如果是windows在 cmd中运行, 使用快捷键win+R ,在运行界面输入cmd<br><br>如果是macos ,有个app叫做终端,在终端中可以运行,如果Mac系统比较熟练可以安装一个叫做iTerm的终端软件,界面功能更强大比默认终端更好用","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1614451163,"ip_address":"","comment_id":280682,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614316878","product_id":100071001,"comment_content":"pip3 install xlrd代码写在哪进行安装呢","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516178,"discussion_content":"如果是windows在 cmd中运行, 使用快捷键win+R ,在运行界面输入cmd\n\n如果是macos ,有个app叫做终端,在终端中可以运行,如果Mac系统比较熟练可以安装一个叫做iTerm的终端软件,界面功能更强大比默认终端更好用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614451163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280051,"user_name":"珊羽","can_delete":false,"product_type":"c1","uid":1217054,"ip_address":"","ucode":"64AF515A35D4ED","user_header":"https://static001.geekbang.org/account/avatar/00/12/92/1e/67b51b3d.jpg","comment_is_top":false,"comment_ctime":1614065606,"is_pvip":false,"replies":[{"id":"101765","content":"你好,我在前面使用了循环,因此产生了多个excel文件","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1614166059,"ip_address":"","comment_id":280051,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1614065606","product_id":100071001,"comment_content":"有一个地方不太明白，想请老师指教。write_to_file这个函数实际只创建了一次workbook，为什么代码运行之后会生成多个EXCEL 文件呢？","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515969,"discussion_content":"你好,我在前面使用了循环,因此产生了多个excel文件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614166059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1021175,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/94/f7/cc9b3af3.jpg","nickname":"Owen","note":"","ucode":"016DEA7851B6C6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350984,"discussion_content":"用了for 循环语句重复操作这个函数","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614089132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280048,"user_name":"珊羽","can_delete":false,"product_type":"c1","uid":1217054,"ip_address":"","ucode":"64AF515A35D4ED","user_header":"https://static001.geekbang.org/account/avatar/00/12/92/1e/67b51b3d.jpg","comment_is_top":false,"comment_ctime":1614065475,"is_pvip":false,"replies":[{"id":"101766","content":"我希望是批量处理完成之后,最后再保存内容到文件,而不是处理一次(指for循环执行一次)就保存一个文件,所以我将save()函数写在了循环之外","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1614166183,"ip_address":"","comment_id":280048,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614065475","product_id":100071001,"comment_content":"拆分表格的这个案例中，保存语句workbook.save(PurePath(salary_file).with_name(filename).with_suffix(&#39;.xlsx&#39;))为什么不是放在for循环体中呢","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515967,"discussion_content":"我希望是批量处理完成之后,最后再保存内容到文件,而不是处理一次(指for循环执行一次)就保存一个文件,所以我将save()函数写在了循环之外","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614166183,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280046,"user_name":"珊羽","can_delete":false,"product_type":"c1","uid":1217054,"ip_address":"","ucode":"64AF515A35D4ED","user_header":"https://static001.geekbang.org/account/avatar/00/12/92/1e/67b51b3d.jpg","comment_is_top":false,"comment_ctime":1614065312,"is_pvip":false,"replies":[{"id":"101773","content":"是将列表的内容赋值给cnt变量, 由于是第一讲,有很多同学没有python的基础,所以我没有对数据类型进行转换,程序看上去也是一个“半成品” , 我将列表直接写入到可文件中.<br><br>随着后面的内容深入,我会讲解如何对列表进行转换、如何提前列表的内容,以及统计个数等功能,我们学会这些功能后将列表转换为更恰当的内容存入文件才算是个“成熟”的开发者 ","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1614167289,"ip_address":"","comment_id":280046,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614065312","product_id":100071001,"comment_content":"拆分表格的案例里，最后一行代码write_to_file(filename = content[1],cnt=new_content)，不太理解cnt=new_content，new_content是一个列表，把列表赋值给cnt是指把列表中的个数的值赋值给cnt吗","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515966,"discussion_content":"是将列表的内容赋值给cnt变量, 由于是第一讲,有很多同学没有python的基础,所以我没有对数据类型进行转换,程序看上去也是一个“半成品” , 我将列表直接写入到可文件中.\n\n随着后面的内容深入,我会讲解如何对列表进行转换、如何提前列表的内容,以及统计个数等功能,我们学会这些功能后将列表转换为更恰当的内容存入文件才算是个“成熟”的开发者 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614167289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280039,"user_name":"鬼脸嘟嘟","can_delete":false,"product_type":"c1","uid":2438221,"ip_address":"","ucode":"6A9D4F58D6BA0F","user_header":"https://static001.geekbang.org/account/avatar/00/25/34/4d/d6eaa473.jpg","comment_is_top":false,"comment_ctime":1614063220,"is_pvip":false,"replies":[{"id":"101767","content":"你好, pandas是可以实现excel读写的,但是学习pandas有前置的知识,dataframe需要掌握,因此我使用xlrd xlwt库实现,减少初学者对使用python操作excel造成学习困扰","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1614166268,"ip_address":"","comment_id":280039,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614063220","product_id":100071001,"comment_content":"老师，合并Excel可以用pandas","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515963,"discussion_content":"你好, pandas是可以实现excel读写的,但是学习pandas有前置的知识,dataframe需要掌握,因此我使用xlrd xlwt库实现,减少初学者对使用python操作excel造成学习困扰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614166268,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280028,"user_name":"珊羽","can_delete":false,"product_type":"c1","uid":1217054,"ip_address":"","ucode":"64AF515A35D4ED","user_header":"https://static001.geekbang.org/account/avatar/00/12/92/1e/67b51b3d.jpg","comment_is_top":false,"comment_ctime":1614060496,"is_pvip":false,"replies":[{"id":"101768","content":"这个功能我在后面要使用较大篇幅讲解, 这里提前和你说一下它的功能, 在python中使用引号包含的字符称作字符串, python3.7版本之后引入了一个叫做f-string功能, 就是在字符串前面增加f关键字, 这样可以让字符串除了保存字符还可以保存更多的功能, 例如我就在f-string这种字符串中使用了{username}这样的格式, 在对temp赋值之前,发-string会将{username}的值替换成username变量的值,并将username变量自动转换为字符串格式<br>","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1614166440,"ip_address":"","comment_id":280028,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614060496","product_id":100071001,"comment_content":"请问temp = f&#39;{username},{answer1},{answer2}&#39;这种写法怎么理解呢","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515960,"discussion_content":"这个功能我在后面要使用较大篇幅讲解, 这里提前和你说一下它的功能, 在python中使用引号包含的字符称作字符串, python3.7版本之后引入了一个叫做f-string功能, 就是在字符串前面增加f关键字, 这样可以让字符串除了保存字符还可以保存更多的功能, 例如我就在f-string这种字符串中使用了{username}这样的格式, 在对temp赋值之前,发-string会将{username}的值替换成username变量的值,并将username变量自动转换为字符串格式\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614166440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279673,"user_name":"Stone","can_delete":false,"product_type":"c1","uid":1369289,"ip_address":"","ucode":"2A2E5BBA08A5BF","user_header":"https://static001.geekbang.org/account/avatar/00/14/e4/c9/04cd0ca4.jpg","comment_is_top":false,"comment_ctime":1613899988,"is_pvip":false,"replies":[{"id":"101617","content":"可以采用4g或找个梯子的方式，github在以后工作中还是绕不过去的，不能简单的回避它，xlrd新版本如果对xlsx支持不优化可以换成openpyxl，原理是想通的","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1613973112,"ip_address":"","comment_id":279673,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1613899988","product_id":100071001,"comment_content":"老师能否在码云上给个地址，打不开github网站，谢谢。<br>xlrd 最新的2.0.1不支持打开xlsx,回退到1.2版本正常。","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515822,"discussion_content":"可以采用4g或找个梯子的方式，github在以后工作中还是绕不过去的，不能简单的回避它，xlrd新版本如果对xlsx支持不优化可以换成openpyxl，原理是想通的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613973112,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279657,"user_name":"zhanyd","can_delete":false,"product_type":"c1","uid":1073845,"ip_address":"","ucode":"4C994EE512A3C4","user_header":"https://static001.geekbang.org/account/avatar/00/10/62/b5/4159fa05.jpg","comment_is_top":false,"comment_ctime":1613892738,"is_pvip":false,"replies":[{"id":"101618","content":"赞!","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1613973122,"ip_address":"","comment_id":279657,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1613892738","product_id":100071001,"comment_content":"我写了几个操作Excel的例子，有兴趣的同学可以看看：https:&#47;&#47;github.com&#47;zhanyd&#47;learning-python","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515816,"discussion_content":"赞!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613973122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278492,"user_name":"琥珀·","can_delete":false,"product_type":"c1","uid":1162136,"ip_address":"","ucode":"7DB119EB3D4F8F","user_header":"https://static001.geekbang.org/account/avatar/00/11/bb/98/db72a54a.jpg","comment_is_top":false,"comment_ctime":1612971646,"is_pvip":false,"replies":[{"id":"101242","content":"赞","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1613144594,"ip_address":"","comment_id":278492,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612971646","product_id":100071001,"comment_content":"import xlrd<br>import xlwt<br><br><br>def get_table(src_file):<br>    data = xlrd.open_workbook(src_file)<br>    table = data.sheets()[0]<br>    return table<br><br><br>def write_to_file(filename, cnt):<br>    workbook = xlwt.Workbook(encoding=&#39;utf-8&#39;)<br>    xlsheet = workbook.add_sheet(filename)<br>    row, col = 0, 0<br>    for cell_hear in cnt[0]:<br>        xlsheet.write(row, col, cell_hear)<br>        col += 1<br>    row += 1<br>    col = 0<br>    for cell_value in cnt[1]:<br>        xlsheet.write(row, col, cell_value)<br>        col += 1<br>    workbook.save(f&#39;{filename}.xls&#39;)<br><br><br>def split_excel(src_file):<br>    table = get_table(src_file)<br>    employee_number = table.nrows<br>    salary_header = table.row_values(rowx=0, start_colx=0, end_colx=None)<br>    for line in range(1, employee_number):<br>        content = table.row_values(rowx=line, start_colx=0, end_colx=None)<br>        new_content: list = [salary_header, content]<br>        write_to_file(filename=content[1], cnt=new_content)<br><br><br>if __name__ == &#39;__main__&#39;:<br>    split_excel(&quot;工资单&#47;工资单.xls&quot;)<br><br>","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515401,"discussion_content":"赞","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613144594,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278353,"user_name":"乐途","can_delete":false,"product_type":"c1","uid":1939929,"ip_address":"","ucode":"F37C433DDF139A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1zDyL0lEZctZ8mNExiaFemQQKlq9ETK5exGPzaOdXJMXiabuPFYpASNxR6VWL8A9CUcyjzUQSribS4gzKQFNGlTLg/132","comment_is_top":false,"comment_ctime":1612906990,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612906990","product_id":100071001,"comment_content":"import xlwt<br>import xlrd<br><br>&quot;&quot;&quot;<br>对工资表按照个人进行拆分，然后批量保存为按照员工姓名命名新的独立表格<br>&quot;&quot;&quot;<br><br>src_path = &#39;&#47;Users&#47;zhangzhuoyu 1&#47;zidonghua&#47;gongzitiao_chaifen&#47;工资总汇.xls&#39;<br><br>dst_file = &#39;&#47;Users&#47;zhangzhuoyu 1&#47;zidonghua&#47;gongzitiao_chaifen&#47;caifen&#39;<br><br>workbook = xlrd.open_workbook(src_path)<br>table = workbook.sheets()[0]<br><br># 获取表格表头<br>table_header = table.row_values(rowx=0)<br># print(table_header) #[&#39;员工编号&#39;, &#39;姓名&#39;, &#39;出勤&#39;, &#39;工资&#39;, &#39;奖金&#39;, &#39;职务工资&#39;, &#39;全勤奖&#39;, &#39;实发工资&#39;]<br><br># 有n行，就有n-1个员工 （离职就在表格删除该员工的格式）<br>employee_number = table.nrows  # 获取行数<br><br><br># print(employee_number) #4<br><br>def write_to_file(name,cnts):<br>    workbook = xlwt.Workbook(encoding=&#39;utf-8&#39;)<br>    xlsheet = workbook.add_sheet(&#39;个人工资&#39;)<br><br>    row = 0<br>    col = 0<br><br>    # 写入 表头<br>    for cell_header in table_header:<br>        xlsheet.write(row, col, cell_header)<br>        col += 1<br><br>    # 向下移一行<br>    row += 1<br><br>    col = 0<br>    for cnt in cnts:<br><br>        xlsheet.write(row,col,cnt)<br>        col +=1<br><br>    workbook.save(f&#39;&#47;Users&#47;zhangzhuoyu 1&#47;zidonghua&#47;gongzitiao_chaifen&#47;caifen&#47;{name}.xls&#39;)<br><br><br>for line in range(1, employee_number):<br>    # 定义每行要获取哪些列的内容<br>    content = table.row_values(rowx=line, start_colx=0, end_colx=None)<br><br>    # 每一个行的记录，保存在一个临时的列表中<br>    new_context = []<br><br>    # 写入表头<br>    new_context.append(table_header)<br>    # 写入员工工资信息<br>    new_context.append(content)<br>    # print(new_context) # [[&#39;员工编号&#39;, &#39;姓名&#39;, &#39;出勤&#39;, &#39;工资&#39;, &#39;奖金&#39;, &#39;职务工资&#39;, &#39;全勤奖&#39;, &#39;实发工资&#39;], [1003.0, &#39;张飞&#39;, 30.0, 2000.0, 500.0, 500.0, 100.0, 3310.0]]<br><br>    # 调用自定义函数 write_to_file()写入新文件<br>    write_to_file(name=content[1],cnts=new_context[1])<br>","like_count":0},{"had_liked":false,"id":278352,"user_name":"乐途","can_delete":false,"product_type":"c1","uid":1939929,"ip_address":"","ucode":"F37C433DDF139A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/1zDyL0lEZctZ8mNExiaFemQQKlq9ETK5exGPzaOdXJMXiabuPFYpASNxR6VWL8A9CUcyjzUQSribS4gzKQFNGlTLg/132","comment_is_top":false,"comment_ctime":1612906714,"is_pvip":false,"replies":[{"id":"101243","content":"因为面向初学者，包括我的演示代码写的也比较简单，我认为需要从几方面优化代码，第一个是要操作的文件和输出路径要通过命令行参数处理，第二个是变量的名称要有一定的含义，最后是可以考虑继续抽象和封装代码里的其他功能，除了write-to-file外，其他逻辑看有没有能复用的，整体上完成的还是比较棒的","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1613144965,"ip_address":"","comment_id":278352,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1612906714","product_id":100071001,"comment_content":"拆分部分比较简略，我贴下我自己敲的，望老师指正：<br><br>import xlwt<br>import xlrd<br><br>&quot;&quot;&quot;<br>对工资表按照个人进行拆分，然后批量保存为按照员工姓名命名新的独立表格<br>&quot;&quot;&quot;<br><br>src_path = &#39;&#47;Users&#47;zhangzhuoyu 1&#47;zidonghua&#47;gongzitiao_chaifen&#47;工资总汇.xls&#39;<br><br>dst_file = &#39;&#47;Users&#47;zhangzhuoyu 1&#47;zidonghua&#47;gongzitiao_chaifen&#47;caifen&#39;<br><br>workbook = xlrd.open_workbook(src_path)<br>table = workbook.sheets()[0]<br><br># 获取表格表头<br>table_header = table.row_values(rowx=0)<br># print(table_header) #[&#39;员工编号&#39;, &#39;姓名&#39;, &#39;出勤&#39;, &#39;工资&#39;, &#39;奖金&#39;, &#39;职务工资&#39;, &#39;全勤奖&#39;, &#39;实发工资&#39;]<br><br># 有n行，就有n-1个员工 （离职就在表格删除该员工的格式）<br>employee_number = table.nrows  # 获取行数<br><br><br># print(employee_number) #4<br><br>def write_to_file(name,cnts):<br>    workbook = xlwt.Workbook(encoding=&#39;utf-8&#39;)<br>    xlsheet = workbook.add_sheet(&#39;个人工资&#39;)<br><br>    row = 0<br>    col = 0<br><br>    # 写入 表头<br>    for cell_header in table_header:<br>        xlsheet.write(row, col, cell_header)<br>        col += 1<br><br>    # 向下移一行<br>    row += 1<br><br>    col = 0<br>    for cnt in cnts:<br><br>        xlsheet.write(row,col,cnt)<br>        col +=1<br><br>    workbook.save(f&#39;&#47;Users&#47;zhangzhuoyu 1&#47;zidonghua&#47;gongzitiao_chaifen&#47;caifen&#47;{name}.xls&#39;)<br><br><br>for line in range(1, employee_number):<br>    # 定义每行要获取哪些列的内容<br>    content = table.row_values(rowx=line, start_colx=0, end_colx=None)<br><br>    # 每一个行的记录，保存在一个临时的列表中<br>    new_context = []<br><br>    # 写入表头<br>    new_context.append(table_header)<br>    # 写入员工工资信息<br>    new_context.append(content)<br>    # print(new_context) # [[&#39;员工编号&#39;, &#39;姓名&#39;, &#39;出勤&#39;, &#39;工资&#39;, &#39;奖金&#39;, &#39;职务工资&#39;, &#39;全勤奖&#39;, &#39;实发工资&#39;], [1003.0, &#39;张飞&#39;, 30.0, 2000.0, 500.0, 500.0, 100.0, 3310.0]]<br><br>    # 调用自定义函数 write_to_file()写入新文件<br>    write_to_file(name=content[1],cnts=new_context[1])<br>","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515357,"discussion_content":"因为面向初学者，包括我的演示代码写的也比较简单，我认为需要从几方面优化代码，第一个是要操作的文件和输出路径要通过命令行参数处理，第二个是变量的名称要有一定的含义，最后是可以考虑继续抽象和封装代码里的其他功能，除了write-to-file外，其他逻辑看有没有能复用的，整体上完成的还是比较棒的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613144965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1939929,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/1zDyL0lEZctZ8mNExiaFemQQKlq9ETK5exGPzaOdXJMXiabuPFYpASNxR6VWL8A9CUcyjzUQSribS4gzKQFNGlTLg/132","nickname":"乐途","note":"","ucode":"F37C433DDF139A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349391,"discussion_content":"谢谢老师，后面多多尝试封装成函数复用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613145987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278142,"user_name":"哒啷","can_delete":false,"product_type":"c1","uid":1639516,"ip_address":"","ucode":"91666E889A6C27","user_header":"https://static001.geekbang.org/account/avatar/00/19/04/5c/35e4fccf.jpg","comment_is_top":false,"comment_ctime":1612774533,"is_pvip":false,"replies":[{"id":"101066","content":"赞, 我再提供一个库openpyxl, 它的社区呼声更高一些,了解完xlrd可以对比学习一下","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612872732,"ip_address":"","comment_id":278142,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612774533","product_id":100071001,"comment_content":"无法读取xls或xlsx出现错误可能是由于xlrd版本过高，输入pip3 install xlrd==1.2.0即可","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515294,"discussion_content":"赞, 我再提供一个库openpyxl, 它的社区呼声更高一些,了解完xlrd可以对比学习一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612872732,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277962,"user_name":"McKee Chen","can_delete":false,"product_type":"c1","uid":2037505,"ip_address":"","ucode":"F74B76542FAB65","user_header":"https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg","comment_is_top":false,"comment_ctime":1612683436,"is_pvip":false,"replies":[{"id":"101071","content":"https:&#47;&#47;github.com&#47;wilsonyin123&#47;python_productivity<br><br>我调整一下链接,让你在后续内容更容易找到代码和样例文件","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612873226,"ip_address":"","comment_id":277962,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612683436","product_id":100071001,"comment_content":"老师可以把代码链接放在文章里吗~谢谢老师","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515227,"discussion_content":"https://github.com/wilsonyin123/python_productivity\n\n我调整一下链接,让你在后续内容更容易找到代码和样例文件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612873226,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277833,"user_name":"杏林之虎","can_delete":false,"product_type":"c1","uid":1926338,"ip_address":"","ucode":"C0EA8B698390E7","user_header":"https://static001.geekbang.org/account/avatar/00/1d/64/c2/12308f04.jpg","comment_is_top":false,"comment_ctime":1612611588,"is_pvip":false,"replies":[{"id":"100848","content":"18字段,上万行内存消耗会占到5GB以上,内存的巨大开销让你的运行速度过慢,主要解决办法是需要减少内存开销<br><br>python支持<br>excel写入的库很多,对大内存支持比较好的一个是xlsxwriter,使用方法:<br>  xlsxwriter.Workbook(file, {&#39;constant_memory&#39;: True}),它的参考文档是https:&#47;&#47;xlsxwriter.readthedocs.io&#47;<br>试试改为这个库能否加快文件存储速度","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612681587,"ip_address":"","comment_id":277833,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612611588","product_id":100071001,"comment_content":"待拆分Excel文件含有18位的数字信息，读取的时候正常，但写目标文件的时候因记录方式丢失后面几位。通过api.NumberFormat=“@”，可以解决，但处理文件运行速慢，上万条数据的话，就会死掉。请问有什么办法可以解决嘛？","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515185,"discussion_content":"18字段,上万行内存消耗会占到5GB以上,内存的巨大开销让你的运行速度过慢,主要解决办法是需要减少内存开销\n\npython支持\nexcel写入的库很多,对大内存支持比较好的一个是xlsxwriter,使用方法:\n  xlsxwriter.Workbook(file, {&amp;#39;constant_memory&amp;#39;: True}),它的参考文档是https://xlsxwriter.readthedocs.io/\n试试改为这个库能否加快文件存储速度","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612681587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277670,"user_name":"lynn","can_delete":false,"product_type":"c1","uid":2435900,"ip_address":"","ucode":"3CEA4D61E3FBE4","user_header":"https://static001.geekbang.org/account/avatar/00/25/2b/3c/b1b1b7da.jpg","comment_is_top":false,"comment_ctime":1612513868,"is_pvip":false,"replies":[{"id":"100844","content":"再详细描述一下你的问题？","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612675292,"ip_address":"","comment_id":277670,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1612513868","product_id":100071001,"comment_content":"可执行文件怎么获取啊","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515132,"discussion_content":"再详细描述一下你的问题？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612675292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2435900,"avatar":"https://static001.geekbang.org/account/avatar/00/25/2b/3c/b1b1b7da.jpg","nickname":"lynn","note":"","ucode":"3CEA4D61E3FBE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349185,"discussion_content":"请教一下老师，每节课后的可执行文件怎么获取，谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612952914,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277600,"user_name":"栾~龟虽寿！","can_delete":false,"product_type":"c1","uid":1504671,"ip_address":"","ucode":"219B38C08979FE","user_header":"https://static001.geekbang.org/account/avatar/00/16/f5/9f/1509d389.jpg","comment_is_top":false,"comment_ctime":1612488699,"is_pvip":false,"replies":[{"id":"100709","content":"好，我去看一下","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612505460,"ip_address":"","comment_id":277600,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612488699","product_id":100071001,"comment_content":"老师，有读一行的函数了，","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515112,"discussion_content":"好，我去看一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612505460,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277498,"user_name":"廖向冰","can_delete":false,"product_type":"c1","uid":1623561,"ip_address":"","ucode":"F614C8BF34DE1C","user_header":"https://static001.geekbang.org/account/avatar/00/18/c6/09/9c0a53e5.jpg","comment_is_top":false,"comment_ctime":1612432146,"is_pvip":false,"replies":[{"id":"100714","content":"文字专栏","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612505622,"ip_address":"","comment_id":277498,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612432146","product_id":100071001,"comment_content":"不是视频课？","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515072,"discussion_content":"文字专栏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612505622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277464,"user_name":"LM","can_delete":false,"product_type":"c1","uid":1606931,"ip_address":"","ucode":"E661C1ADF97371","user_header":"https://static001.geekbang.org/account/avatar/00/18/85/13/36ae41ff.jpg","comment_is_top":false,"comment_ctime":1612423552,"is_pvip":false,"replies":[{"id":"100726","content":"通过下面的方法可以实现<br>SheetObject.row_values(rowx[, start_colx=0, end_colx=None])<br><br>取sheet中第rowx+1行，从start_colx列到end_colx列的数据<br><br>返回值为列表，但是写入的时候，因为操作的基本单位是单元格。你需要通过两个for循环进行行列控制进行写入。<br><br>还有一种写作方法就是使用pandas库。把读出来的。多行多列的嵌套列表，写到新的Excel当中。<br><br>除非你有非常多的格式相同的，Excel需要这样处理，否则Python在这种场景下起不到优化效率的效果。反而让你在维护Python脚本的工作当中，浪费更多精力。","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612508613,"ip_address":"","comment_id":277464,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612423552","product_id":100071001,"comment_content":"拆分的讲解有点缩略了，比如我想把一个excel里的特定行、列内容拆分出来，再写入到一个新excel的特定行列，这个怎么做","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515063,"discussion_content":"通过下面的方法可以实现\nSheetObject.row_values(rowx[, start_colx=0, end_colx=None])\n\n取sheet中第rowx+1行，从start_colx列到end_colx列的数据\n\n返回值为列表，但是写入的时候，因为操作的基本单位是单元格。你需要通过两个for循环进行行列控制进行写入。\n\n还有一种写作方法就是使用pandas库。把读出来的。多行多列的嵌套列表，写到新的Excel当中。\n\n除非你有非常多的格式相同的，Excel需要这样处理，否则Python在这种场景下起不到优化效率的效果。反而让你在维护Python脚本的工作当中，浪费更多精力。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612508613,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277402,"user_name":"在野","can_delete":false,"product_type":"c1","uid":1048366,"ip_address":"","ucode":"A700B41D34F58C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ff/2e/ca3960b0.jpg","comment_is_top":false,"comment_ctime":1612406078,"is_pvip":false,"replies":[{"id":"100717","content":"https:&#47;&#47;github.com&#47;wilsonyin123&#47;python_productivity","user_name":"作者回复","user_name_real":"尹会生","uid":"1056235","ctime":1612505808,"ip_address":"","comment_id":277402,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1612406078","product_id":100071001,"comment_content":"有完整的代码吗","like_count":0,"discussions":[{"author":{"id":1056235,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1d/eb/b2123759.jpg","nickname":"尹会生","note":"","ucode":"D1093DBD093617","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515036,"discussion_content":"https://github.com/wilsonyin123/python_productivity","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612505808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2442565,"avatar":"","nickname":"SWC603","note":"","ucode":"3BD12A75A15A9A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349646,"discussion_content":"尹老師, 想請教一下是否可以用python將批量excel檔中的圖片(公司舊LOGO)一次過更改另一新圖片(公司新LOGO)?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613404235,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}