{"id":310638,"title":"18｜Wide&Deep：怎样让你的模型既有想象力又有记忆力？","content":"<p>你好，我是王喆。</p><p>今天，我们来学习一个在业界有着巨大影响力的推荐模型，Google的Wide&amp;Deep。可以说，只要掌握了Wide&amp;Deep，我们就抓住了深度推荐模型这几年发展的一个主要方向。那Wide&amp;Deep模型是什么意思呢？我们把它翻译成中文就是“宽并且深的模型”。</p><p>这个名字看起来好像很通俗易懂，但你真的理解其中“宽”和“深”的含义吗？上一节课我们讲过Embedding+MLP的经典结构，因为MLP可以有多层神经网络的结构，所以它是一个比较“深”的模型，但Wide&amp;Deep这个模型说的“深”和MLP是同样的意思吗？“宽”的部分又是什么样的呢？宽和深分别有什么不同的作用呢？以及我们为什么要把它们结合在一起形成一个模型呢？</p><p>这节课，就让我们就带着这诸多疑问，从模型的结构开始学起，再深入到Wide&amp;Deep在Google的应用细节中去，最后亲自动手实现这个模型。</p><h2>Wide&amp;Deep模型的结构</h2><p>首先，我们来看看Wide&amp;Deep模型的结构，理解了结构再深入去学习细节，我们才能掌握得更好。</p><p><img src=\"https://static001.geekbang.org/resource/image/fb/e0/fb17112c951ebb2a515f12dace262de0.jpg?wh=1316*600\" alt=\"\" title=\"图1 Wide&amp;Deep模型结构 [br]（出自Wide &amp; Deep Learning for Recommender Systems ）\"></p><p>上图就是Wide&amp;Deep模型的结构图了，它是由左侧的Wide部分和右侧的Deep部分组成的。Wide部分的结构太简单了，就是把输入层直接连接到输出层，中间没有做任何处理。Deep层的结构稍复杂，但我相信你也不会陌生，因为它就是我们上节课学习的Embedding+MLP的模型结构。</p><!-- [[[read_end]]] --><p>知道了Wide&amp;Deep模型的结构之后，我们先来解决第一个问题，那就是Google为什么要创造这样一个混合式的模型结构呢？这我们还得从Wide部分和Deep部分的不同作用说起。</p><p>简单来说，Wide部分的主要作用是让模型具有较强的“记忆能力”（Memorization），而Deep部分的主要作用是让模型具有“泛化能力”（Generalization），因为只有这样的结构特点，才能让模型兼具逻辑回归和深度神经网络的优点，也就是既能快速处理和记忆大量历史行为特征，又具有强大的表达能力，这就是Google提出这个模型的动机。</p><p>那么问题又来了，所谓的“记忆能力”和“泛化能力”到底指什么呢？这我们就得好好聊一聊了，因为理解这两种能力是彻底理解Wide&amp;Deep模型的关键。</p><h3>模型的记忆能力</h3><p><strong>所谓的 “记忆能力”，可以被宽泛地理解为模型直接学习历史数据中物品或者特征的“共现频率”，并且把它们直接作为推荐依据的能力 。</strong> 就像我们在电影推荐中可以发现一系列的规则，比如，看了A电影的用户经常喜欢看电影B，这种“因为A所以B”式的规则，非常直接也非常有价值。</p><p>但这类规则有两个特点：一是数量非常多，一个“记性不好”的推荐模型很难把它们都记住；二是没办法推而广之，因为这类规则非常具体，没办法或者说也没必要跟其他特征做进一步的组合。就像看了电影A的用户80%都喜欢看电影B，这个特征已经非常强了，我们就没必要把它跟其他特征再组合在一起。</p><p>现在，我们就可以回答开头的问题了，为什么模型要有Wide部分？就是因为Wide部分可以增强模型的记忆能力，让模型记住大量的直接且重要的规则，这正是单层的线性模型所擅长的。</p><h3>模型的泛化能力</h3><p>接下来，我们来谈谈模型的“泛化能力”。<strong>“泛化能力”指的是模型对于新鲜样本、以及从未出现过的特征组合的预测能力。</strong> 这怎么理解呢？我们还是来看一个例子。假设，我们知道25岁的男性用户喜欢看电影A，35岁的女性用户也喜欢看电影A。如果我们想让一个只有记忆能力的模型回答，“35岁的男性喜不喜欢看电影A”这样的问题，这个模型就会“说”，我从来没学过这样的知识啊，没法回答你。</p><p>这就体现出泛化能力的重要性了。模型有了很强的泛化能力之后，才能够对一些非常稀疏的，甚至从未出现过的情况作出尽量“靠谱”的预测。</p><p>回到刚才的例子，有泛化能力的模型回答“35岁的男性喜不喜欢看电影A”这个问题，它思考的逻辑可能是这样的：从第一条知识，“25岁的男性用户喜欢看电影A“中，我们可以学到男性用户是喜欢看电影A的。从第二条知识，“35岁的女性用户也喜欢看电影A”中，我们可以学到35岁的用户是喜欢看电影A的。那在没有其他知识的前提下，35岁的男性同时包含了合适的年龄和性别这两个特征，所以他大概率也是喜欢电影A的。这就是模型的泛化能力。</p><p>事实上，我们学过的矩阵分解算法，就是为了解决协同过滤“泛化能力”不强而诞生的。因为协同过滤只会“死板”地使用用户的原始行为特征，而矩阵分解因为生成了用户和物品的隐向量，所以就可以计算任意两个用户和物品之间的相似度了。这就是泛化能力强的另一个例子。</p><p>从上节课中我们学过深度学习模型有很强的数据拟合能力，在多层神经网络之中，特征可以得到充分的交叉，让模型学习到新的知识。因此，Wide&amp;Deep模型的Deep部分，就沿用了上节课介绍的Embedding+MLP的模型结构，来增强模型的泛化能力。</p><p>好，清楚了记忆能力和泛化能力是什么之后，让我们再回到Wide&amp;Deep模型提出时的业务场景上，去理解Wide&amp;Deep模型是怎么综合性地学习到记忆能力和泛化能力的。</p><h2>Wide&amp;Deep模型的应用场景</h2><p>Wide&amp;Deep模型是由Google的应用商店团队Google Play提出的，在Google Play为用户推荐APP这样的应用场景下，Wide&amp;Deep模型的推荐目标就显而易见了，就是应该尽量推荐那些用户可能喜欢，愿意安装的应用。那具体到Wide&amp;Deep模型中，Google Play团队是如何为Wide部分和Deep部分挑选特征的呢？下面，我们就一起来看看。</p><p><img src=\"https://static001.geekbang.org/resource/image/4b/be/4b2f89d82768ba851e3f7392b17df2be.jpg?wh=1426*860\" alt=\"\" title=\"图2 Google Play Wide&amp;Deep模型的细节 [br]（出自Wide &amp; Deep Learning for Recommender Systems ）\"></p><p>我们先来看看图2，它补充了Google Play Wide&amp;Deep模型的细节，让我们可以清楚地看到各部分用到的特征是什么。我们先从右边Wide部分的特征看起。这部分很简单，只利用了两个特征的交叉，这两个特征是“已安装应用”和“当前曝光应用”。这样一来，Wide部分想学到的知识就非常直观啦，就是希望记忆好“如果A所以B”这样的简单规则。在Google Play的场景下，就是希望记住“如果用户已经安装了应用A，是否会安装B”这样的规则。</p><p>接着，我们再来看看左边的Deep部分，它就是一个非常典型的Embedding+MLP结构了。我们看到其中的输入特征很多，有用户年龄、属性特征、设备类型，还有已安装应用的Embedding等等。我们把这些特征一股脑地放进多层神经网络里面去学习之后，它们互相之间会发生多重的交叉组合，这最终会让模型具备很强的泛化能力。</p><p>比如说，我们把用户年龄、人口属性和已安装应用组合起来。假设，样本中有25岁男性安装抖音的记录，也有35岁女性安装抖音的记录，那我们该怎么预测25岁女性安装抖音的概率呢？这就需要用到已有特征的交叉来实现了。虽然我们没有25岁女性安装抖音的样本，但模型也能通过对已有知识的泛化，经过多层神经网络的学习，来推测出这个概率。</p><p>总的来说，Wide&amp;Deep通过组合Wide部分的线性模型和Deep部分的深度网络，取各自所长，就能得到一个综合能力更强的组合模型。</p><h2>Wide&amp;Deep模型的TensorFlow实现</h2><p>在理解了Wide&amp;Deep模型的原理和技术细节之后，就又到了“show me the code”的环节了。接下来，我们就动手在Sparrow Recsys上实现Wide&amp;Deep模型吧！</p><p>通过上节课的实战，我相信你已经熟悉了TensorFlow的大部分操作，也清楚了载入训练数据，创建TensorFlow所需的Feature column的方法。因此，Wide&amp;Deep模型的实践过程中，我们会重点关注定义模型的部分。</p><p>这里，我们也会像上节课一样，继续使用TensorFlow的Keras接口来构建Wide&amp;Deep模型。具体的代码如下：</p><pre><code># wide and deep model architecture\n# deep part for all input features\ndeep = tf.keras.layers.DenseFeatures(numerical_columns + categorical_columns)(inputs)\ndeep = tf.keras.layers.Dense(128, activation='relu')(deep)\ndeep = tf.keras.layers.Dense(128, activation='relu')(deep)\n# wide part for cross feature\nwide = tf.keras.layers.DenseFeatures(crossed_feature)(inputs)\nboth = tf.keras.layers.concatenate([deep, wide])\noutput_layer = tf.keras.layers.Dense(1, activation='sigmoid')(both)\nmodel = tf.keras.Model(inputs, output_layer)\n</code></pre><p>从代码中我们可以看到，在创建模型的时候，我们依次配置了模型的Deep部分和Wide部分。我们先来看Deep部分，它是输入层加两层128维隐层的结构，它的输入是类别型Embedding向量和数值型特征，实际上这跟上节课Embedding+MLP模型所用的特征是一样的。</p><p>Wide部分其实不需要有什么特殊操作，我们直接把输入特征连接到了输出层就可以了。但是，这里我们要重点关注一下Wide部分所用的特征crossed_feature。</p><pre><code>movie_feature = tf.feature_column.categorical_column_with_identity(key='movieId', num_buckets=1001)\nrated_movie_feature = tf.feature_column.categorical_column_with_identity(key='userRatedMovie1', num_buckets=1001)\ncrossed_feature = tf.feature_column.crossed_column([movie_feature, rated_movie_feature], 10000)\n\n</code></pre><p>在生成crossed_feature的过程中，我其实仿照了Google Play的应用方式，生成了一个由“用户已好评电影”和“当前评价电影”组成的一个交叉特征，就是代码中的crossed_feature，设置这个特征的目的在于让模型记住好评电影之间的相关规则，更具体点来说就是，就是让模型记住“一个喜欢电影A的用户，也会喜欢电影B”这样的规则。</p><p>当然，这样的规则不是唯一的，需要你根据自己的业务特点来设计， 比如在电商网站中，这样的规则可以是，购买了键盘的用户也会购买鼠标。在新闻网站中，可以是打开过足球新闻的用户，也会点击NBA新闻等等。</p><p>在Deep部分和Wide部分都构建完后，我们要使用 <code>concatenate layer</code> 把两部分连接起来，形成一个完整的特征向量，输入到最终的sigmoid神经元中，产生推荐分数。</p><p>总的来说，在我们上一节的Embedding MLP模型基础上实现Wide&amp;Deep是非常方便的，Deep部分基本没有变化，我们只需要加上Wide部分的特征和设置就可以了。Wide&amp;Deep的全部相关代码，我都实现在了Sparrow Recsys的WideNDeep.py文件中，你可以直接参考源代码。但我更希望，你能尝试设置不同的特征，以及不同的参数组合，来真实地体验一下深度学习模型的调参过程。</p><h2>小结</h2><p>这节课，我们一起实现了业界影响力非常大的深度学习模型Wide&amp;Deep，它是由Wide部分和Deep部分组成的。其中，Wide部分主要是为了增强模型的“记忆能力”，让模型记住“如果A，那么B”这样的简单但数量非常多的规则。Deep部分是为了增强模型的“泛化能力”，让模型具备对于稀缺样本、以及从未出现过的特征组合的预测能力。Wide&amp;Deep正是通过这样取长补短的方式，让模型的综合能力提升。</p><p>在具体实践的时候，我们继续使用TensorFlow的Keras接口实现了Wide&amp;Deep模型。相比上节课Embedding MLP模型的实现，我们新加入了“用户已好评电影”和“当前评价电影”组成的交叉特征crossed_feature，让Wide部分学习“一个喜欢电影A的用户，也会喜欢电影B”这样的规则。</p><p>好了，这就是我们这节课的主要内容，同样，我也把重要的知识点总结在了表格里，你可以利用它来巩固复习。</p><p><img src=\"https://static001.geekbang.org/resource/image/1d/12/1d5985d8e9b7d92a87baa80f619a8a12.jpeg?wh=1920*975\" alt=\"\"></p><h2>课后思考</h2><p>对于Deep部分来说，你觉得我们一股脑地把所有特征都扔进MLP中去训练，这样的方式有没有什么改进的空间？比如说，“用户喜欢的电影风格”和“电影本身的风格”这两个特征，我们能不能进一步挖掘出它们之间的相关性，而不是简单粗暴地扔给神经网络去处理呢？</p><p>欢迎把你的思考和疑问写在留言区，如果的你朋友也正在为Wide&amp;Deep模型的实现而困扰，欢迎你把这节课转发给他，我们下节课见！</p>","comments":[{"had_liked":false,"id":268850,"user_name":"giraffa126","can_delete":false,"product_type":"c1","uid":1626750,"ip_address":"","ucode":"E925F5D280B0BB","user_header":"https://static001.geekbang.org/account/avatar/00/18/d2/7e/38f369b5.jpg","comment_is_top":false,"comment_ctime":1608369815,"is_pvip":false,"replies":[{"id":"97538","content":"这是个很好的问题，也推荐其他同学思考。<br><br>我的思考是不会，因为wide部分一般来说都是非常稀疏的特征，虽然总的维度很大，但是在实际inference的过程中，wide部分往往只有几个维度是有值的，而deep部分一般都是稠密的特征向量，所以理论上两个部分对结果的影响不存在太大的bias。<br><br>","user_name":"作者回复","comment_id":268850,"uid":"1662192","ip_address":"","utype":1,"ctime":1608406385,"user_name_real":"王喆"}],"discussion_count":3,"race_medal":0,"score":"173407061655","product_id":100060801,"comment_content":"冒昧问一下，deep的输出是128，wide是10000，两个不在一个量纲，感觉直接这么concate，会不会削弱deep的效果，模型退化成LR？","like_count":41,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512062,"discussion_content":"这是个很好的问题，也推荐其他同学思考。\n\n我的思考是不会，因为wide部分一般来说都是非常稀疏的特征，虽然总的维度很大，但是在实际inference的过程中，wide部分往往只有几个维度是有值的，而deep部分一般都是稠密的特征向量，所以理论上两个部分对结果的影响不存在太大的bias。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608406385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1626750,"avatar":"https://static001.geekbang.org/account/avatar/00/18/d2/7e/38f369b5.jpg","nickname":"giraffa126","note":"","ucode":"E925F5D280B0BB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336159,"discussion_content":" outputs = tf.nn.sigmoid(\n                tf.add(tf.add(self.w1 * wide_outputs, self.w2 * deep_outputs), self.bias))\n感觉这种比较常见。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1608519060,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2404154,"avatar":"","nickname":"Geek_9d589c","note":"","ucode":"4E7D6A4D62FCBC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1626750,"avatar":"https://static001.geekbang.org/account/avatar/00/18/d2/7e/38f369b5.jpg","nickname":"giraffa126","note":"","ucode":"E925F5D280B0BB","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":361914,"discussion_content":"这个跟concat之后feed给linear layer是等价的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616802252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":336159,"ip_address":""},"score":361914,"extra":""}]}]},{"had_liked":false,"id":284003,"user_name":"Alan","can_delete":false,"product_type":"c1","uid":2115316,"ip_address":"","ucode":"591A28E310A8F5","user_header":"https://static001.geekbang.org/account/avatar/00/20/46/f4/93b1275b.jpg","comment_is_top":false,"comment_ctime":1616034964,"is_pvip":false,"replies":[{"id":"103417","content":"说的很好，推荐其他同学参考。","user_name":"作者回复","comment_id":284003,"uid":"1662192","ip_address":"","utype":1,"ctime":1616636475,"user_name_real":"王喆"}],"discussion_count":1,"race_medal":0,"score":"96105315476","product_id":100060801,"comment_content":"答：改进空间大致上我能想到两种方式：我选2<br>1、手动人工两个特征交叉或求解相关性（即，电影风格类型较低情况下，数据维度较低、数据量较小情况下是可以的，但是在实际工业应用领域是不切实际的），<br>2、改进算法的wide部分，提升记忆能力，使用端到端模型，减少人工操作。例如DCNMix、DeepFM。以DeepFM这个模型都可以很好学习到高低特征与交叉。（实际业界常用，推荐）<br>普及一下高低阶特征知识：<br>低阶特征：是指线性-线性组合，只能算一个有效的线性组合，线性-非线性-线性，这样算两个有效的线性组合，一般常说的低阶特征只有小于等于2阶；<br>高阶特征：说高阶特征，可以理解为经过多次线性-非线性组合操作之后形成的特征，为高度抽象特征，一般人脑很难解析出原有的特征了","like_count":23,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517200,"discussion_content":"说的很好，推荐其他同学参考。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616636475,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":265392,"user_name":"范闲","can_delete":false,"product_type":"c1","uid":1073125,"ip_address":"","ucode":"F21FD7DF6BA53C","user_header":"https://static001.geekbang.org/account/avatar/00/10/5f/e5/54325854.jpg","comment_is_top":false,"comment_ctime":1606888274,"is_pvip":false,"replies":[{"id":"96521","content":"很好的idea，人工的特征组合有时候反而效果是好的。不能因为有深度学习就完全不考虑一些手动的特征组合。","user_name":"作者回复","comment_id":265392,"uid":"1662192","ip_address":"","utype":1,"ctime":1606940349,"user_name_real":"王喆"}],"discussion_count":1,"race_medal":0,"score":"74621332306","product_id":100060801,"comment_content":"电影本身风格和用户倾向风格可以做个融合~~用户偏离本身风格的程度~~","like_count":18,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510915,"discussion_content":"很好的idea，人工的特征组合有时候反而效果是好的。不能因为有深度学习就完全不考虑一些手动的特征组合。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606940349,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":262759,"user_name":"那时刻","can_delete":false,"product_type":"c1","uid":1150927,"ip_address":"","ucode":"B0D150856C3A4A","user_header":"https://static001.geekbang.org/account/avatar/00/11/8f/cf/890f82d6.jpg","comment_is_top":false,"comment_ctime":1605838391,"is_pvip":false,"replies":[{"id":"95381","content":"做不做normalization还是看你自己的实践。我一般推荐在实际工作中做normalization或者bucketize。会有助于模型收敛。","user_name":"作者回复","comment_id":262759,"uid":"1662192","ip_address":"","utype":1,"ctime":1605903387,"user_name_real":"王喆"}],"discussion_count":2,"race_medal":0,"score":"66030347831","product_id":100060801,"comment_content":"请问老师，文中例子中把类别型特征放入到wide里，如果把数值型特征放到wide部分，是否需要做normalization呢？","like_count":16,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509962,"discussion_content":"做不做normalization还是看你自己的实践。我一般推荐在实际工作中做normalization或者bucketize。会有助于模型收敛。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605903387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1539649,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/OwZuBRbVUkziazePs2xTKskNpZachRtCBZLHlv4dAUgaBC5qHI292xaxvg3atGnHlDwjIOXPKEbc7zOrtMyicSNg/132","nickname":"罗辑","note":"","ucode":"06AB60316B51C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401196,"discussion_content":"我看到后也想问这个问题，因为数值型的特征数值取值差距较大，movieRatingCount和userAvgRating差了3个数量级，我觉得如果不做normalization会导致movieRatingCount影响盖过userAvgRating，不知道对不对，请老师指点。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633600027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":264035,"user_name":"马龙流","can_delete":false,"product_type":"c1","uid":1087792,"ip_address":"","ucode":"16F9CE022297FF","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erUKWZy1fBBcJncWRNh9M3TkjThqgsIIpmGOTCyg2IN80IDf3COkeWyTLHliczAppIkfBgCJTsUn1g/132","comment_is_top":false,"comment_ctime":1606316910,"is_pvip":false,"replies":[{"id":"95782","content":"这个思路非常好。跟之后我们要讲的DIN中的attention机制做法一致了。","user_name":"作者回复","comment_id":264035,"uid":"1662192","ip_address":"","utype":1,"ctime":1606352271,"user_name_real":"王喆"}],"discussion_count":1,"race_medal":0,"score":"53145924462","product_id":100060801,"comment_content":"用户喜欢的风格和电影本身自己的风格，做attention做为一个值喂给mlp，这种做法是否可以","like_count":13,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510394,"discussion_content":"这个思路非常好。跟之后我们要讲的DIN中的attention机制做法一致了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606352271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266282,"user_name":"Geek_b027e7","can_delete":false,"product_type":"c1","uid":1667354,"ip_address":"","ucode":"4A7315AAF8D406","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL357Eqdgfv7hVpPql5WYshNkd4YGtJ3PD801zjJs2nVpJIia92YZAjsK9dKJoN5rwLUEBEk6T4Xmg/132","comment_is_top":false,"comment_ctime":1607268745,"is_pvip":false,"replies":[{"id":"96789","content":"是的，可以自己多修改，多尝试","user_name":"作者回复","comment_id":266282,"uid":"1662192","ip_address":"","utype":1,"ctime":1607390222,"user_name_real":"王喆"}],"discussion_count":2,"race_medal":0,"score":"23082105225","product_id":100060801,"comment_content":"老师，deepfm中crossed_column是不是只写了一个好评电影的交叉例子，按文中意思是把所有好评过的历史电影与所有电影做交叉","like_count":5,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511197,"discussion_content":"是的，可以自己多修改，多尝试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607390222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2645198,"avatar":"","nickname":"Geek_d389c9","note":"","ucode":"CEABD38D05A030","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380932,"discussion_content":"看起来像是 所有好评电影 因为数据集那一列已经涵盖了所有好评电影了吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624802332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278690,"user_name":"王继伟","can_delete":false,"product_type":"c1","uid":2337824,"ip_address":"","ucode":"A9D2C24BE576FE","user_header":"https://static001.geekbang.org/account/avatar/00/23/ac/20/0f1eefaf.jpg","comment_is_top":false,"comment_ctime":1613203477,"is_pvip":false,"replies":[{"id":"101386","content":"这两个问题都不错：<br>1、其实深度模型一般都有处理稀疏id的部分，即使没有wide部分，大量其他模型的embedding也需要处理这样的特征。所以肯定会降低训练速度，但深度学习模型几乎都必须有这样的结构<br><br>2、虽然稀疏特征维度很大，但是往往仅有很少的几个维度在inference过程中是1。所以对结果的贡献不会淹没deep部分。这是从原理上说的，从实践上说的话，自己去做evaluation。","user_name":"作者回复","comment_id":278690,"uid":"1662192","ip_address":"","utype":1,"ctime":1613529229,"user_name_real":"王喆"}],"discussion_count":1,"race_medal":0,"score":"18793072661","product_id":100060801,"comment_content":"请问老师，文中说Wide 部分就是把输入层直接连接到输出层。<br>1、如果输入层特征特别稀疏（上千万维的one_hot）这样即使是直接连接到输出层也会增加上千万个参数，这样会降低模型训练速度吗？<br>2、如果Wide 部分输入的稀疏特征维度上亿，那wide部分的训练的参数会比deep部分训练的参数还要多，这样合理吗？<br>还是说wide部分的输入是要控制特征维度的？","like_count":4,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515468,"discussion_content":"这两个问题都不错：\n1、其实深度模型一般都有处理稀疏id的部分，即使没有wide部分，大量其他模型的embedding也需要处理这样的特征。所以肯定会降低训练速度，但深度学习模型几乎都必须有这样的结构\n\n2、虽然稀疏特征维度很大，但是往往仅有很少的几个维度在inference过程中是1。所以对结果的贡献不会淹没deep部分。这是从原理上说的，从实践上说的话，自己去做evaluation。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613529229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274837,"user_name":"Jacky","can_delete":false,"product_type":"c1","uid":2419697,"ip_address":"","ucode":"B5C148C61B0BE9","user_header":"https://static001.geekbang.org/account/avatar/00/24/eb/f1/77b9d336.jpg","comment_is_top":false,"comment_ctime":1611193972,"is_pvip":false,"replies":[{"id":"99768","content":"微信上已经回复你了吧？这些小问题自己多调试，可能不能一一帮助大家。","user_name":"作者回复","comment_id":274837,"uid":"1662192","ip_address":"","utype":1,"ctime":1611280047,"user_name_real":"王喆"}],"discussion_count":6,"race_medal":0,"score":"18791063156","product_id":100060801,"comment_content":"老师，您好！我想咨询一下，我在pycharm里运行py文件的时候，出现了cast string to int32 is not supported的问题，想咨询一下如何修改代码。谢谢您！感谢！","like_count":4,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514139,"discussion_content":"微信上已经回复你了吧？这些小问题自己多调试，可能不能一一帮助大家。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611280047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2156292,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/4icayE3ic5IA7RWwZcrxpMZE4T1WViakEgPsDC3UnhZwU83ad65IjmxPficy0vNZz6Q6vCiclnmyBDc5IYf7soHAXrQ/132","nickname":"Geek_790c43","note":"","ucode":"FFFAE0636A91EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346172,"discussion_content":"求加群啊","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1611884604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1848573,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/TEAw3V4pholicTgMLKMK2pIg5H98qQoMiaLWU4C0IGVAJzJQ9EfxR1HDf3VbPvbtCQ7eyBL03me53a4IjYVUYL9A/132","nickname":"赵春亮","note":"","ucode":"C4B5277C644A9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":362346,"discussion_content":"求加群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616923700,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2028941,"avatar":"","nickname":"Geek1254","note":"","ucode":"BC2F7756A0676D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352330,"discussion_content":"我也想加老师的微信。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614686516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2199659,"avatar":"https://static001.geekbang.org/account/avatar/00/21/90/6b/24ca47da.jpg","nickname":"黄佳恒","note":"","ucode":"1E3812DB22CC42","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345986,"discussion_content":"你好，请问你是怎么解决的？我也碰到了这个问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611830031,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2407410,"avatar":"http://thirdwx.qlogo.cn/mmopen/VdM9K3h96B7usk6dk8Q2KsAJmLDuFBXKEUtcKxS2yhSt4aKgtO9FgC7ZdVztkPAT71c7vJQgafU70hvUgPXJXerJ7LIZ3Bxn/132","nickname":"彭小鑫","note":"","ucode":"9BEFBE52BC124E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2199659,"avatar":"https://static001.geekbang.org/account/avatar/00/21/90/6b/24ca47da.jpg","nickname":"黄佳恒","note":"","ucode":"1E3812DB22CC42","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348110,"discussion_content":"你尝试下把string转成int类型","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612427197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":345986,"ip_address":""},"score":348110,"extra":""}]}]},{"had_liked":false,"id":273965,"user_name":"骚动","can_delete":false,"product_type":"c1","uid":2280216,"ip_address":"","ucode":"EBEBF417C866D4","user_header":"https://static001.geekbang.org/account/avatar/00/22/cb/18/0139e086.jpg","comment_is_top":false,"comment_ctime":1610768792,"is_pvip":true,"replies":[{"id":"99567","content":"不可以这样理解，wide&amp;deep两部分是并列的，GBDT+LR，两部分是先后关系。<br><br>至于具体的区别，自己找GBDT+LR的结构去深入理解。","user_name":"作者回复","comment_id":273965,"uid":"1662192","ip_address":"","utype":1,"ctime":1610947822,"user_name_real":"王喆"}],"discussion_count":3,"race_medal":0,"score":"18790637976","product_id":100060801,"comment_content":"请问老师，我觉得Wide&amp;Deep和GBDT+LR在逻辑上很像，Wide对应LR，Deep对应GBDT，不知道我的想法对不对？这两个模型对比，老师能给我讲下吗，有什么共性？另外，GBDT+LR中输入LR的数据，也是原始特征+GBDT训练的特征，是否可以理解为原始特征就是模型的记忆能力，GBDT训练的组合特征就是泛化能力？","like_count":5,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513879,"discussion_content":"不可以这样理解，wide&amp;amp;deep两部分是并列的，GBDT+LR，两部分是先后关系。\n\n至于具体的区别，自己找GBDT+LR的结构去深入理解。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610947822,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1658932,"avatar":"https://static001.geekbang.org/account/avatar/00/19/50/34/172342fd.jpg","nickname":"吴十一","note":"","ucode":"47232ED3225081","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343094,"discussion_content":"我觉得GBDT的泛化能力应该是比deep弱的，而且树模型本身就是特征之间交叉选择，LR是特征的一阶组合，只能说GBDT的特征组合比LR更复杂。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1610942162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1269211,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5d/db/b0e61da0.jpg","nickname":"T_大坤","note":"","ucode":"CAC3087FE8A776","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1658932,"avatar":"https://static001.geekbang.org/account/avatar/00/19/50/34/172342fd.jpg","nickname":"吴十一","note":"","ucode":"47232ED3225081","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371224,"discussion_content":"哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619687776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":343094,"ip_address":""},"score":371224,"extra":""}]}]},{"had_liked":false,"id":263760,"user_name":"浣熊当家","can_delete":false,"product_type":"c1","uid":1952248,"ip_address":"","ucode":"939F06050423E4","user_header":"https://static001.geekbang.org/account/avatar/00/1d/c9/f8/72955ef9.jpg","comment_is_top":false,"comment_ctime":1606263869,"is_pvip":false,"replies":[{"id":"95688","content":"很好的观察，也是很有意思的问题。<br><br>其实没有什么讲究，不用非要是2的倍数。<br>究其根源可能因为最开始做CNN图像相关模型的人喜欢用2进制的神经元数量，因为很多图像像素是1024之类的大小。所以大家就保留这个习惯了。","user_name":"作者回复","comment_id":263760,"uid":"1662192","ip_address":"","utype":1,"ctime":1606269605,"user_name_real":"王喆"}],"discussion_count":1,"race_medal":0,"score":"18786133053","product_id":100060801,"comment_content":" 图二模型中Relu层从下到上分别是1024， 512， 256， 很好奇这些数字的设定有什么讲究吗？ 比如1）是不是设置成这种2进制相关的数字比较有效率？ 2）神经网络的维度一般都是往上每层除2这种规则吗？","like_count":4,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":510290,"discussion_content":"很好的观察，也是很有意思的问题。\n\n其实没有什么讲究，不用非要是2的倍数。\n究其根源可能因为最开始做CNN图像相关模型的人喜欢用2进制的神经元数量，因为很多图像像素是1024之类的大小。所以大家就保留这个习惯了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606269605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280244,"user_name":"江峰","can_delete":false,"product_type":"c1","uid":1011627,"ip_address":"","ucode":"DA693C09C131B9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6f/ab/4fc3f494.jpg","comment_is_top":false,"comment_ctime":1614141552,"is_pvip":false,"replies":[{"id":"101874","content":"当然按照原文的思路，是把维度很高的交叉类特征放在wide侧，把比较稠密的特征放在deep侧，我们的实践也基本依次逻辑。<br><br>但是我觉得倒也没必要一成不变的按它的逻辑，你这种实践出真知的过程是最好的。","user_name":"作者回复","comment_id":280244,"uid":"1662192","ip_address":"","utype":1,"ctime":1614305026,"user_name_real":"王喆"}],"discussion_count":2,"race_medal":0,"score":"14499043440","product_id":100060801,"comment_content":"在工业界应用wide deep模型的时候，wide侧和deep侧分别应该放什么样的特征呢？ 我在实践过程中都是把 原始id特征放到deep侧，把id类别大的，和其他id特征的交叉放在wide侧。比如adid和分词交叉，memberid和分词交叉等。这样处理合适吗？ 把这种交叉特征同时放在wide侧和deep侧，是不是会更好？","like_count":4,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516033,"discussion_content":"当然按照原文的思路，是把维度很高的交叉类特征放在wide侧，把比较稠密的特征放在deep侧，我们的实践也基本依次逻辑。\n\n但是我觉得倒也没必要一成不变的按它的逻辑，你这种实践出真知的过程是最好的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614305026,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1011627,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6f/ab/4fc3f494.jpg","nickname":"江峰","note":"","ucode":"DA693C09C131B9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351495,"discussion_content":"多谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614305869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304100,"user_name":"Yang Hong","can_delete":false,"product_type":"c1","uid":2664414,"ip_address":"","ucode":"B92C87587CE9E1","user_header":"","comment_is_top":false,"comment_ctime":1627255130,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10217189722","product_id":100060801,"comment_content":"老师，我理解的Embedding+MLP中对于low dimension的feature和embedding后的feature在连接层的拼接，与Wide&amp;Deep中对wide部分和deep部分的feature的拼接原理一样，都是stack的方式。<br><br>但为什么在代码中它们不一样呢？比如在Embedding+MLP中我们用的是+号拼接： tf.keras.layers.DenseFeatures(numerical_columns + categorical_columns)，但是在Wide&amp;Deep中我们是用tf.keras.layers.concatenate([deep, wide])的方式拼接。","like_count":2,"discussions":[{"author":{"id":2413045,"avatar":"https://static001.geekbang.org/account/avatar/00/24/d1/f5/efe2175a.jpg","nickname":"Alvin","note":"","ucode":"6F5E9AFAD16FB6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387574,"discussion_content":"同问老师， 我看tf.keras.layers.DenseFeatures， TF官方文档正常就是后面括号输入input 但是老师这里是“deep = tf.keras.layers.DenseFeatures(numerical_columns + categorical_columns)(inputs)” 有两个括号，不是很明白为啥要输入两个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628258853,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":262832,"user_name":"Sebastian","can_delete":false,"product_type":"c1","uid":1797634,"ip_address":"","ucode":"62E6FC13DB00E3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/55lYKUdcPFgUHibRYmaRiaBdrsmnLGOHdPp4OicjBh197X0vyGa9qAwruEqicAPuUgibXO4Lz5jLudlcbtsqq2p3CpA/132","comment_is_top":false,"comment_ctime":1605855922,"is_pvip":false,"replies":[{"id":"95380","content":"这个做法没问题，但主要还是针对attention这个机制做处理，并不直接涉及到特征交叉。","user_name":"作者回复","comment_id":262832,"uid":"1662192","ip_address":"","utype":1,"ctime":1605903325,"user_name_real":"王喆"}],"discussion_count":2,"race_medal":0,"score":"10195790514","product_id":100060801,"comment_content":"可以在deep网络中加入attention机制，比如用户行为序列作为特征时，近期的行为一般比远期行为更加能反映user的兴趣，这种时候可以对行为序列做attention处理。","like_count":2,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509990,"discussion_content":"这个做法没问题，但主要还是针对attention这个机制做处理，并不直接涉及到特征交叉。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605903325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2419697,"avatar":"https://static001.geekbang.org/account/avatar/00/24/eb/f1/77b9d336.jpg","nickname":"Jacky","note":"","ucode":"B5C148C61B0BE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343840,"discussion_content":"您好！我想咨询一下，我在pycharm里运行py文件的时候，出现了cast string to int32 is not supported的问题，想咨询一下如何修改代码。谢谢您！感谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611194000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308330,"user_name":"Geek_8a732a","can_delete":false,"product_type":"c1","uid":2723806,"ip_address":"","ucode":"97A312D97F7B91","user_header":"","comment_is_top":false,"comment_ctime":1629537839,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5924505135","product_id":100060801,"comment_content":"不应该，“用户喜欢的电影风格”和“电影本身的风格”，可以考虑做合并成一个变量。","like_count":1},{"had_liked":false,"id":304188,"user_name":"石忠会","can_delete":false,"product_type":"c1","uid":2642286,"ip_address":"","ucode":"E1A315BA743E40","user_header":"https://static001.geekbang.org/account/avatar/00/28/51/6e/a226e158.jpg","comment_is_top":false,"comment_ctime":1627289686,"is_pvip":false,"replies":[{"id":"110099","content":"当然是有深意的。可以参考我这篇文章的解答https:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;142958834","user_name":"作者回复","comment_id":304188,"uid":"1662192","ip_address":"","utype":1,"ctime":1627334085,"user_name_real":"王喆"}],"discussion_count":1,"race_medal":0,"score":"5922256982","product_id":100060801,"comment_content":"老师，我看代码里面的优化器只给出了Adam 但是在在tf单独给接口或者理论中不是宽度模型使用FTRL进行优化，深度模型用 adgrad 或者Adam进行优化 这其中有什么深意吗","like_count":2,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523968,"discussion_content":"当然是有深意的。可以参考我这篇文章的解答https://zhuanlan.zhihu.com/p/142958834","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627334085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279498,"user_name":"续费专用","can_delete":false,"product_type":"c1","uid":2028938,"ip_address":"","ucode":"1B585A131B64B4","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f5/8a/dc9a23a1.jpg","comment_is_top":false,"comment_ctime":1613806805,"is_pvip":false,"replies":[{"id":"101714","content":"哈哈，这是我臆想的一个例子，仅用于说明道理，不要深究。","user_name":"作者回复","comment_id":279498,"uid":"1662192","ip_address":"","utype":1,"ctime":1614046633,"user_name_real":"王喆"}],"discussion_count":3,"race_medal":0,"score":"5908774101","product_id":100060801,"comment_content":"我就是想问问，25 岁的男性用户喜欢看电影 A，35 岁的女性用户也喜欢看电影 A，那么按照常识，这部电影A大概是部什么样的电影呢？🤔","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515756,"discussion_content":"哈哈，这是我臆想的一个例子，仅用于说明道理，不要深究。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614046633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1516796,"avatar":"","nickname":"时间小偷","note":"","ucode":"0EBC79DDD822C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":563477,"discussion_content":"脑洞清奇啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650004546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1239343,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e9/2f/3c989133.jpg","nickname":"不将就","note":"","ucode":"44138E2164DC83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351001,"discussion_content":"我知道","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614093486,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277079,"user_name":"hurun","can_delete":false,"product_type":"c1","uid":1883212,"ip_address":"","ucode":"001913A6B669C4","user_header":"https://static001.geekbang.org/account/avatar/00/1c/bc/4c/fb5452bd.jpg","comment_is_top":false,"comment_ctime":1612255053,"is_pvip":false,"replies":[{"id":"100805","content":"非常好的点。这也是我在之后的模型评估章节介绍的问题，可以看看到时候能不能回答你的问题。","user_name":"作者回复","comment_id":277079,"uid":"1662192","ip_address":"","utype":1,"ctime":1612595030,"user_name_real":"王喆"}],"discussion_count":1,"race_medal":0,"score":"5907222349","product_id":100060801,"comment_content":"王老师好，你在代码注释详细，个人学完后收获良多，感谢你的付出。<br>我参考代码和你的讲解文档，对crossed_feature特征的生成及其在训练集、测试集的使用，有一点小小的疑惑：在代码WideNDeep.py的72行，使用了userRatedMovie1特征，我查看trainingSamples.csv和testSamples.csv，发现训练集的userRatedMovie特征movie_id，出现在测试集movie_id列，这样会不会有future feature问题呢，比如训练集中(user_id, movie_id, userRatedMovie1) =(3033, 970, 969) 出现在训练集(user_id, movie_id, userRatedMovie1) =(3033, 969, 288) ，相当于在训练集中提前告诉模型，对于3033这个用户，969是高质量评价的电影<br><br><br>","like_count":2,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514923,"discussion_content":"非常好的点。这也是我在之后的模型评估章节介绍的问题，可以看看到时候能不能回答你的问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612595030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323363,"user_name":"白马飞飞","can_delete":false,"product_type":"c1","uid":2197597,"ip_address":"","ucode":"040746A4679199","user_header":"https://static001.geekbang.org/account/avatar/00/21/88/5d/7b02da07.jpg","comment_is_top":false,"comment_ctime":1637854729,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637854729","product_id":100060801,"comment_content":"请问含有crossed_column特征处理的模型，如何保存模型？ 推理时，如何crossed_column这部分特征如何输入模型。","like_count":0},{"had_liked":false,"id":323093,"user_name":"Geek_3cdb56","can_delete":false,"product_type":"c1","uid":2113188,"ip_address":"","ucode":"442D6C12551057","user_header":"","comment_is_top":false,"comment_ctime":1637725436,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637725436","product_id":100060801,"comment_content":"哪些特诊适合放在wide里面，哪些特征适合放在deep里面","like_count":0},{"had_liked":false,"id":309567,"user_name":"kakaymi","can_delete":false,"product_type":"c1","uid":1529270,"ip_address":"","ucode":"FC675F3796FECF","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epW1MiaFR2RTu5YTIBLzZLVm8GJNphfRltWWgRPnKMQJsrpvCXZQa5K0U9jozbfLNWKkTSPlSNkiaSg/132","comment_is_top":false,"comment_ctime":1630236535,"is_pvip":false,"replies":[{"id":"112198","content":"logloss是逻辑回归的损失函数","user_name":"作者回复","comment_id":309567,"uid":"1662192","ip_address":"","utype":1,"ctime":1630345840,"user_name_real":"王喆"}],"discussion_count":1,"race_medal":0,"score":"1630236535","product_id":100060801,"comment_content":"logloss是logistic回归吗?最终输出的是一个0-1之间的标量?这个标量的含义是什么呢？","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525917,"discussion_content":"logloss是逻辑回归的损失函数","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630345840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303620,"user_name":"Geek_790c43","can_delete":false,"product_type":"c1","uid":2156292,"ip_address":"","ucode":"FFFAE0636A91EF","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/4icayE3ic5IA7RWwZcrxpMZE4T1WViakEgPsDC3UnhZwU83ad65IjmxPficy0vNZz6Q6vCiclnmyBDc5IYf7soHAXrQ/132","comment_is_top":false,"comment_ctime":1626879171,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1626879171","product_id":100060801,"comment_content":"交叉之后为何是10000维度，如何选取","like_count":0,"discussions":[{"author":{"id":2807409,"avatar":"","nickname":"Geek_c7b54e","note":"","ucode":"B9688B5C6C0DFD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533863,"discussion_content":"也有同样的问题，movieId 与userRatedMovie1都被categorized之后，如果作交叉的话, hash_bucket_size是不是应该1000*1000 = 1000,000。否则是否会出现hash collision的情况？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637998530,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283144,"user_name":"haolison","can_delete":false,"product_type":"c1","uid":1740391,"ip_address":"","ucode":"7BF883557C461A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/60UgZMiaYPUp1xRqRuRLCclg25KuKyL81pwwj9meQwF7ribZU3t7AhxVC2AxUia4iawcsb3fuiaJJx2BsrWeYGoDERA/132","comment_is_top":false,"comment_ctime":1615592273,"is_pvip":false,"replies":[{"id":"102832","content":"如果有使用pycharm的同学可以帮忙看一下能否复现该问题。<br>使用课程中推荐的环境我这边没有错误。","user_name":"作者回复","user_name_real":"王喆","uid":"1662192","ctime":1615793579,"ip_address":"","comment_id":283144,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1615592273","product_id":100060801,"comment_content":"王老师好，用pycharm运行WideNDeep.py<br>此行代码model.fit(train_dataset, epochs=5)报错，信息如下：<br>tensorflow.python.framework.errors_impl.FailedPreconditionError: Table not initialized.<br>\t [[{{node dense_features&#47;movieGenre3_embedding&#47;hash_table_Lookup&#47;LookupTableFindV2}}]]<br>请问是bug呢？还是数据出了问题呢？<br>","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516945,"discussion_content":"如果有使用pycharm的同学可以帮忙看一下能否复现该问题。\n使用课程中推荐的环境我这边没有错误。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615793579,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2254434,"avatar":"https://static001.geekbang.org/account/avatar/00/22/66/62/3168f8e5.jpg","nickname":"龙猫差不多先生","note":"","ucode":"54CC61A80D98A7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580396,"discussion_content":"估计应该是用的tf1x吧，两种解决方案，1、tf.enable_eager_execution()转变成动态图模型 2、K.get_session().run(tf.tables_initializer(name=&#34;init_all_tables&#34;)) 在fit前添加，任选其一","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658139389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282885,"user_name":"FayeChen","can_delete":false,"product_type":"c1","uid":2421713,"ip_address":"","ucode":"72AA0C00128017","user_header":"https://static001.geekbang.org/account/avatar/00/24/f3/d1/0663e55c.jpg","comment_is_top":false,"comment_ctime":1615451980,"is_pvip":false,"replies":[{"id":"102838","content":"在一个样本中，当前待评分的电影只会有一个，不会有多个。","user_name":"作者回复","user_name_real":"王喆","uid":"1662192","ctime":1615794141,"ip_address":"","comment_id":282885,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615451980","product_id":100060801,"comment_content":"我理解wide的部分是待评分的电影\b和 评分完成的电影 做笛卡尔积，然后hash再输入LR中。但是如果看过的电影有多个，比如一共有n个电影，那不是有2的n次方种记忆的选择。对于历史点继续列这种多值离散的特征怎么处理比较好呢","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516866,"discussion_content":"在一个样本中，当前待评分的电影只会有一个，不会有多个。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615794141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277699,"user_name":"Sanders","can_delete":false,"product_type":"c1","uid":1697075,"ip_address":"","ucode":"3D460FEEDCDF34","user_header":"","comment_is_top":false,"comment_ctime":1612518072,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612518072","product_id":100060801,"comment_content":"可否在Wide层加入某个激活函数输出后跟Deep层Concat？这样会对模型的记忆和泛化能力会有什么影响？","like_count":0},{"had_liked":false,"id":276869,"user_name":"黄佳恒","can_delete":false,"product_type":"c1","uid":2199659,"ip_address":"","ucode":"1E3812DB22CC42","user_header":"https://static001.geekbang.org/account/avatar/00/21/90/6b/24ca47da.jpg","comment_is_top":false,"comment_ctime":1612161959,"is_pvip":false,"replies":[{"id":"100803","content":"不是太明白你的提问。<br>你在tf上训练的输入是什么样子，tf serving中就应该输入什么样子，一般来讲是item id","user_name":"作者回复","user_name_real":"王喆","uid":"1662192","ctime":1612594857,"ip_address":"","comment_id":276869,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612161959","product_id":100060801,"comment_content":"老师，请教一个问题。在wide deep中的wide部分，使用movieid与历史点击的item做交叉，那当模型上线的时候，tf serving的输入的历史item应该是什么样子的","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514846,"discussion_content":"不是太明白你的提问。\n你在tf上训练的输入是什么样子，tf serving中就应该输入什么样子，一般来讲是item id","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612594857,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276314,"user_name":"Geek_790c43","can_delete":false,"product_type":"c1","uid":2156292,"ip_address":"","ucode":"FFFAE0636A91EF","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/4icayE3ic5IA7RWwZcrxpMZE4T1WViakEgPsDC3UnhZwU83ad65IjmxPficy0vNZz6Q6vCiclnmyBDc5IYf7soHAXrQ/132","comment_is_top":false,"comment_ctime":1611885267,"is_pvip":false,"replies":[{"id":"100798","content":"一个sample中的两个feature组成crossed_feature","user_name":"作者回复","user_name_real":"王喆","uid":"1662192","ctime":1612594477,"ip_address":"","comment_id":276314,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1611885267","product_id":100060801,"comment_content":"请问 crossed_feature具体含义是什么？怎么个交叉法？","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514659,"discussion_content":"一个sample中的两个feature组成crossed_feature","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612594477,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2577469,"avatar":"https://static001.geekbang.org/account/avatar/00/27/54/3d/366462d0.jpg","nickname":"Yvonne","note":"","ucode":"85287A0AC7456C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":371812,"discussion_content":"我的理解是，这里模型要预测一个用户对“当前评价电影”(B）的得分。把这个电影（B）和过往的“用户已好评电影”做交叉。若其中某个已好评电影（A) 和“当前评价电影”（B）的交叉对预测分数有贡献（该input有权重），那强调了AB的关联项对B的预测分数有贡献？即“一个喜欢电影 A 的用户，也会喜欢电影 B”？\n\n至于crossed_feature这个函数具体操作，这篇文章写得不错：https://medium.com/ml-book/demonstration-of-tensorflow-feature-columns-tf-feature-column-3bfcca4ca5c4","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1620003370,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1883212,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/bc/4c/fb5452bd.jpg","nickname":"hurun","note":"","ucode":"001913A6B669C4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347723,"discussion_content":"在生成 crossed_feature 的过程中，我其实仿照了 Google Play 的应用方式，生成了一个由“用户已好评电影”和“当前评价电影”组成的一个交叉特征，就是代码中的 crossed_feature，设置这个特征的目的在于让模型记住好评电影之间的相关规则，更具体点来说就是，就是让模型记住“一个喜欢电影 A 的用户，也会喜欢电影 B”这样的规则\n\n个人理解：将用户以前看过的好评的电影，把这些电影作为交叉","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612317113,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":272315,"user_name":"梁栋💝","can_delete":false,"product_type":"c1","uid":1067594,"ip_address":"","ucode":"16EEF0DD596A80","user_header":"https://static001.geekbang.org/account/avatar/00/10/4a/4a/fdae1e16.jpg","comment_is_top":false,"comment_ctime":1610029167,"is_pvip":false,"replies":[{"id":"98733","content":"你说的是wide部分对吧，是这样的。","user_name":"作者回复","user_name_real":"王喆","uid":"1662192","ctime":1610046219,"ip_address":"","comment_id":272315,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1610029167","product_id":100060801,"comment_content":"老师好，我下面的理解对吗。<br><br>如果是1个历史ID和当前ID做交叉后hash取模bucket，应该onehot向量只有1个非0。<br>如果是N个历史ID和当前ID做交叉，得到的是不是多个hash值各自取模，得到multihot向量。<br>","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"王喆","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513234,"discussion_content":"你说的是wide部分对吧，是这样的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610046219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2419697,"avatar":"https://static001.geekbang.org/account/avatar/00/24/eb/f1/77b9d336.jpg","nickname":"Jacky","note":"","ucode":"B5C148C61B0BE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343841,"discussion_content":"您好！我想咨询一下，我在pycharm里运行py文件的时候，出现了cast string to int32 is not supported的问题，想咨询一下如何修改代码。谢谢您！感谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611194011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}