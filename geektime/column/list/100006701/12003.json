{"id":12003,"title":"第35讲 | JVM优化Java代码时都做了什么？","content":"<p>我在专栏上一讲介绍了微基准测试和相关的注意事项，其核心就是避免JVM运行中对Java代码的优化导致失真。所以，系统地理解Java代码运行过程，有利于在实践中进行更进一步的调优。</p>\n<p>今天我要问你的问题是，<span class=\"orange\">JVM优化Java代码时都做了什么？</span></p>\n<p>与以往我来给出典型回答的方式不同，今天我邀请了隔壁专栏<a href=\"http://time.geekbang.org/column/intro/108?utm_source=app&amp;utm_medium=article&amp;utm_campaign=108-presell&amp;utm_content=java\">《深入拆解Java虚拟机》</a>的作者，同样是来自Oracle的郑雨迪博士，让他以JVM专家的身份去思考并回答这个问题。</p>\n<h2>来自JVM专栏作者郑雨迪博士的回答</h2>\n<p>JVM在对代码执行的优化可分为运行时（runtime）优化和即时编译器（JIT）优化。运行时优化主要是解释执行和动态编译通用的一些机制，比如说锁机制（如偏斜锁）、内存分配机制（如TLAB）等。除此之外，还有一些专门用于优化解释执行效率的，比如说模版解释器、内联缓存（inline cache，用于优化虚方法调用的动态绑定）。</p>\n<p>JVM的即时编译器优化是指将热点代码以方法为单位转换成机器码，直接运行在底层硬件之上。它采用了多种优化方式，包括静态编译器可以使用的如方法内联、逃逸分析，也包括基于程序运行profile的投机性优化（speculative/optimistic optimization）。这个怎么理解呢？比如我有一条instanceof指令，在编译之前的执行过程中，测试对象的类一直是同一个，那么即时编译器可以假设编译之后的执行过程中还会是这一个类，并且根据这个类直接返回instanceof的结果。如果出现了其他类，那么就抛弃这段编译后的机器码，并且切换回解释执行。</p><!-- [[[read_end]]] -->\n<p>当然，JVM的优化方式仅仅作用在运行应用代码的时候。如果应用代码本身阻塞了，比如说并发时等待另一线程的结果，这就不在JVM的优化范畴啦。</p>\n<h2>考点分析</h2>\n<p>感谢郑雨迪博士从JVM的角度给出的回答。今天这道面试题在专栏里有不少同学问我，也是会在面试时被面试官刨根问底的一个知识点，郑博士的回答已经非常全面和深入啦。</p>\n<p>大多数Java工程师并不是JVM工程师，知识点总归是要落地的，面试官很有可能会从实践的角度探讨，例如，如何在生产实践中，与JIT等JVM模块进行交互，落实到如何真正进行实际调优。</p>\n<p>在今天这一讲，我会从Java工程师日常的角度出发，侧重于：</p>\n<ul>\n<li>\n<p>从整体去了解Java代码编译、执行的过程，目的是对基本机制和流程有个直观的认识，以保证能够理解调优选择背后的逻辑。</p>\n</li>\n<li>\n<p>从生产系统调优的角度，谈谈将JIT的知识落实到实际工作中的可能思路。这里包括两部分：如何收集JIT相关的信息，以及具体的调优手段。</p>\n</li>\n</ul>\n<h2>知识扩展</h2>\n<p>首先，我们从整体的角度来看看Java代码的整个生命周期，你可以参考我提供的示意图。<br />\n<img src=\"https://static001.geekbang.org/resource/image/12/9d/12526a857a7685af0d7c2ee389c0ca9d.png?wh=788*624\" alt=\"\" /></p>\n<p>我在<a href=\"http://time.geekbang.org/column/article/6845\">专栏第1讲</a>就已经提到过，Java通过引入字节码这种中间表达方式，屏蔽了不同硬件的差异，由JVM负责完成从字节码到机器码的转化。</p>\n<p>通常所说的编译期，是指javac等编译器或者相关API等将源码转换成为字节码的过程，这个阶段也会进行少量类似常量折叠之类的优化，只要利用反编译工具，就可以直接查看细节。</p>\n<p>javac优化与JVM内部优化也存在关联，毕竟它负责了字节码的生成。例如，Java 9中的字符串拼接，会被javac替换成对StringConcatFactory的调用，进而为JVM进行字符串拼接优化提供了统一的入口。在实际场景中，还可以通过不同的<a href=\"http://openjdk.java.net/jeps/280\">策略</a>选项来干预这个过程。</p>\n<p>今天我要讲的重点是<strong>JVM运行时的优化</strong>，在通常情况下，编译器和解释器是共同起作用的，具体流程可以参考下面的示意图。<br />\n<img src=\"https://static001.geekbang.org/resource/image/5c/78/5c095075dcda0f39f0e7395ab9636378.png?wh=628*411\" alt=\"\" /></p>\n<p>JVM会根据统计信息，动态决定什么方法被编译，什么方法解释执行，即使是已经编译过的代码，也可能在不同的运行阶段不再是热点，JVM有必要将这种代码从Code Cache中移除出去，毕竟其大小是有限的。</p>\n<p>就如郑博士所回答的，解释器和编译器也会进行一些通用优化，例如：</p>\n<ul>\n<li>\n<p>锁优化，你可以参考我在<a href=\"http://time.geekbang.org/column/article/9042\">专栏第16讲</a>提供的解释器运行时的源码分析。</p>\n</li>\n<li>\n<p>Intrinsic机制，或者叫作内建方法，就是针对特别重要的基础方法，JDK团队直接提供定制的实现，利用汇编或者编译器的中间表达方式编写，然后JVM会直接在运行时进行替换。</p>\n</li>\n</ul>\n<p>这么做的理由有很多，例如，不同体系结构的CPU在指令等层面存在着差异，定制才能充分发挥出硬件的能力。我们日常使用的典型字符串操作、数组拷贝等基础方法，Hotspot都提供了内建实现。</p>\n<p>而<strong>即时编译器（JIT）</strong>，则是更多优化工作的承担者。JIT对Java编译的基本单元是整个方法，通过对方法调用的计数统计，甄别出热点方法，编译为本地代码。另外一个优化场景，则是最针对所谓热点循环代码，利用通常说的栈上替换技术（OSR，On-Stack Replacement，更加细节请参考<a href=\"https://github.com/AdoptOpenJDK/jitwatch/wiki/Understanding-the-On-Stack-Replacement-(OSR)-optimisation-in-the-HotSpot-C1-compiler\">R大的文章</a>），如果方法本身的调用频度还不够编译标准，但是内部有大的循环之类，则还是会有进一步优化的价值。</p>\n<p>从理论上来看，JIT可以看作就是基于两个计数器实现，方法计数器和回边计数器提供给JVM统计数据，以定位到热点代码。实际中的JIT机制要复杂得多，郑博士提到了<a href=\"https://en.wikipedia.org/wiki/Escape_analysis\">逃逸分析</a>、<a href=\"https://en.wikipedia.org/wiki/Loop_unrolling\">循环展开</a>、方法内联等，包括前面提到的Intrinsic等通用机制同样会在JIT阶段发生。</p>\n<p>第二，有哪些手段可以探查这些优化的具体发生情况呢？</p>\n<p>专栏中已经陆陆续续介绍了一些，我来简单总结一下并补充部分细节。</p>\n<ul>\n<li>打印编译发生的细节。</li>\n</ul>\n<pre><code>-XX:+PrintCompilation\n</code></pre>\n<ul>\n<li>输出更多编译的细节。</li>\n</ul>\n<pre><code>-XX:UnlockDiagnosticVMOptions -XX:+LogCompilation -XX:LogFile=&lt;your_file_path&gt;\n</code></pre>\n<p>JVM会生成一个xml形式的文件，另外， LogFile选项是可选的，不指定则会输出到</p>\n<pre><code>hotspot_pid&lt;pid&gt;.log\n</code></pre>\n<p>具体格式可以参考Ben Evans提供的<a href=\"https://github.com/AdoptOpenJDK/jitwatch/\">JitWatch</a>工具和<a href=\"http://www.oracle.com/technetwork/articles/java/architect-evans-pt1-2266278.html\">分析指南</a>。</p>\n<p><img src=\"https://static001.geekbang.org/resource/image/07/46/07b00499b0ca857fc3ccd51f7046d946.png?wh=1478*181\" alt=\"\" /></p>\n<ul>\n<li>打印内联的发生，可利用下面的诊断选项，也需要明确解锁。</li>\n</ul>\n<pre><code>-XX:+PrintInlining\n</code></pre>\n<ul>\n<li>如何知晓Code Cache的使用状态呢？</li>\n</ul>\n<p>很多工具都已经提供了具体的统计信息，比如，JMC、JConsole之类，我也介绍过使用NMT监控其使用。</p>\n<p>第三，我们作为应用开发者，有哪些可以触手可及的调优角度和手段呢？</p>\n<ul>\n<li>调整热点代码门限值</li>\n</ul>\n<p>我曾经介绍过JIT的默认门限，server模式默认10000次，client是1500次。门限大小也存在着调优的可能，可以使用下面的参数调整；与此同时，该参数还可以变相起到降低预热时间的作用。</p>\n<pre><code>-XX:CompileThreshold=N\n</code></pre>\n<p>很多人可能会产生疑问，既然是热点，不是早晚会达到门限次数吗？这个还真未必，因为JVM会周期性的对计数的数值进行衰减操作，导致调用计数器永远不能达到门限值，除了可以利用CompileThreshold适当调整大小，还有一个办法就是关闭计数器衰减。</p>\n<pre><code>-XX:-UseCounterDecay\n</code></pre>\n<p>如果你是利用debug版本的JDK，还可以利用下面的参数进行试验，但是生产版本是不支持这个选项的。</p>\n<pre><code>-XX:CounterHalfLifeTime\n</code></pre>\n<ul>\n<li>调整Code Cache大小</li>\n</ul>\n<p>我们知道JIT编译的代码是存储在Code Cache中的，需要注意的是Code Cache是存在大小限制的，而且不会动态调整。这意味着，如果Code Cache太小，可能只有一小部分代码可以被JIT编译，其他的代码则没有选择，只能解释执行。所以，一个潜在的调优点就是调整其大小限制。</p>\n<pre><code>-XX:ReservedCodeCacheSize=&lt;SIZE&gt;\n</code></pre>\n<p>当然，也可以调整其初始大小。</p>\n<pre><code>-XX:InitialCodeCacheSize=&lt;SIZE&gt;\n</code></pre>\n<p>注意，在相对较新版本的Java中，由于分层编译（Tiered-Compilation）的存在，Code Cache的空间需求大大增加，其本身默认大小也被提高了。</p>\n<ul>\n<li>调整编译器线程数，或者选择适当的编译器模式</li>\n</ul>\n<p>JVM的编译器线程数目与我们选择的模式有关，选择client模式默认只有一个编译线程，而server模式则默认是两个，如果是当前最普遍的分层编译模式，则会根据CPU内核数目计算C1和C2的数值，你可以通过下面的参数指定的编译线程数。</p>\n<pre><code>-XX:CICompilerCount=N\n</code></pre>\n<p>在强劲的多处理器环境中，增大编译线程数，可能更加充分的利用CPU资源，让预热等过程更加快速；但是，反之也可能导致编译线程争抢过多资源，尤其是当系统非常繁忙时。例如，系统部署了多个Java应用实例的时候，那么减小编译线程数目，则是可以考虑的。</p>\n<p>生产实践中，也有人推荐在服务器上关闭分层编译，直接使用server编译器，虽然会导致稍慢的预热速度，但是可能在特定工作负载上会有微小的吞吐量提高。</p>\n<ul>\n<li>其他一些相对边界比较混淆的所谓“优化”</li>\n</ul>\n<p>比如，减少进入安全点。严格说，它远远不只是发生在动态编译的时候，GC阶段发生的更加频繁，你可以利用下面选项诊断安全点的影响。</p>\n<pre><code>-XX:+PrintSafepointStatistics ‑XX:+PrintGCApplicationStoppedTime\n</code></pre>\n<p>注意，在JDK 9之后，PrintGCApplicationStoppedTime已经被移除了，你需要使用“-Xlog:safepoint”之类方式来指定。</p>\n<p>很多优化阶段都可能和安全点相关，例如：</p>\n<ul>\n<li>\n<p>在JIT过程中，逆优化等场景会需要插入安全点。</p>\n</li>\n<li>\n<p>常规的锁优化阶段也可能发生，比如，偏斜锁的设计目的是为了避免无竞争时的同步开销，但是当真的发生竞争时，撤销偏斜锁会触发安全点，是很重的操作。所以，在并发场景中偏斜锁的价值其实是被质疑的，经常会明确建议关闭偏斜锁。</p>\n</li>\n</ul>\n<pre><code>-XX:-UseBiasedLocking\n</code></pre>\n<p>主要的优化手段就介绍到这里，这些方法都是普通Java开发者就可以利用的。如果你想对JVM优化手段有更深入的了解，建议你订阅JVM专家郑雨迪博士的专栏。</p>\n<h2>一课一练</h2>\n<p>关于今天我们讨论的题目你做到心中有数了吗？ 请思考一个问题，如何程序化验证final关键字是否会影响性能？</p>\n<p>请你在留言区写写你对这个问题的思考，我会选出经过认真思考的留言，送给你一份学习奖励礼券，欢迎你与我一起讨论。</p>\n<p>你的朋友是不是也在准备面试呢？你可以“请朋友读”，把今天的题目分享给好友，或许你能帮到他。</p>\n<p><span class=\"orange\">点击下方图片进入JVM专栏</span><br />\n<a href=\"http://time.geekbang.org/column/intro/108?utm_source=app&amp;utm_medium=article&amp;utm_campaign=108-presell&amp;utm_content=java\"><img src=\"https://static001.geekbang.org/resource/image/2a/d5/2a62e58cbdf56a5dc40748567d346fd5.jpg?wh=1110*549\" alt=\"\" /></a></p>\n","comments":[{"had_liked":false,"id":17315,"user_name":"BY","can_delete":false,"product_type":"c1","uid":1119827,"ip_address":"","ucode":"9FFA0F414A978D","user_header":"https://static001.geekbang.org/account/avatar/00/11/16/53/03930a6b.jpg","comment_is_top":false,"comment_ctime":1532565877,"is_pvip":false,"replies":[{"id":"6050","content":"这个我也不知道翻译用什么词好，大家平时都这么交流...","user_name":"作者回复","user_name_real":"杨晓峰","uid":"1009360","ctime":1532679993,"ip_address":"","comment_id":17315,"utype":1}],"discussion_count":9,"race_medal":0,"score":"61662108021","product_id":100006701,"comment_content":"profile是啥意思。。。","like_count":14,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"杨晓峰","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421113,"discussion_content":"这个我也不知道翻译用什么词好，大家平时都这么交流...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532679993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2459923,"avatar":"https://static001.geekbang.org/account/avatar/00/25/89/13/0d3c5008.jpg","nickname":"最好不过","note":"","ucode":"C7DBCD08402DF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377935,"discussion_content":"维基百科是这样描述的\n在软件工程中，性能分析（performance analysis也称为profiling），是以收集程序运行时信息为手段研究程序行为的分析方法，是一种动态程序分析的方法。\n\n性能分析量测像是程序的空间或时间复杂度、特定指令的使用情形、函数调用的频率及运行时间等。性能分析的目的在于决定程序的哪个部分应该被优化，从而提高程序的速度或者内存使用效率。\n\n性能分析可以由程序的源代码或是可执行档进行。一般会使用称为性能分析工具（profiler）的工具进行。性能分析工具会使用许多不同的技术，可能是以事件为基础（Event-based）的、统计的、指令导向的、仿真的方法。性能分析工具常用在性能工程的过程中使用。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1622971485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1144504,"avatar":"https://static001.geekbang.org/account/avatar/00/11/76/b8/e4cd7997.jpg","nickname":"KAGEMUSHA","note":"","ucode":"DFC05BE62A9C10","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307569,"discussion_content":"预处理配置文件","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1600688045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1093258,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ae/8a/e67def95.jpg","nickname":"赤云","note":"","ucode":"67476D582D8B6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":237227,"discussion_content":"我理解为 详细拆解的信息","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1587136455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1331611,"avatar":"https://static001.geekbang.org/account/avatar/00/14/51/9b/ccea47d9.jpg","nickname":"安迪密恩","note":"","ucode":"A6F3F67CF8E6F8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579064,"discussion_content":"侧写，类似于快照分析？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657161432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1508990,"avatar":"https://static001.geekbang.org/account/avatar/00/17/06/7e/735968e2.jpg","nickname":"西门吹牛","note":"","ucode":"E5D3624DDE1E83","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547660,"discussion_content":"可以理解为收集的信息，针对收集的信息进行预测，类似cpu的分支预测","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642787402,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"子瞻","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352213,"discussion_content":"特征分析吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614651282,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1033425,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c4/d1/209abdd6.jpg","nickname":"小狼","note":"","ucode":"FEAC7864FC1D20","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351555,"discussion_content":"我也对这个词的含义比较模糊，说不清是个什么东东","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614322993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1330065,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/N0NACGUr8dNAbN6BdiagPHBaB0EnyDsI9zWpwJteqTY38apOEnTOA7JkBAQnzYKJBgxu3Q8YMUILwLAB6camn4w/132","nickname":"Swing","note":"","ucode":"55FCA9ECEFBBEB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221091,"discussion_content":"作者都说不好翻译。。好像是看场景吧。。\n我是觉得 类似：轮廓分析之类的、、","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585972834,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":72706,"user_name":"armado","can_delete":false,"product_type":"c1","uid":1153522,"ip_address":"","ucode":"FAFEE00F1D7137","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/E1X9XzIJkqMpMZX6uicoq1WuNuibkpJXLxdMFVOF2g7hMfXrRTBfY2LYymCvfsoKgCOiaYo894qpaEyWI7libNSXOA/132","comment_is_top":false,"comment_ctime":1551698724,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"35911437092","product_id":100006701,"comment_content":"这一讲真的难啊，基本没看懂。","like_count":8,"discussions":[{"author":{"id":2550743,"avatar":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","nickname":"if...else...","note":"","ucode":"D0565908C99695","race_medal":4,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376576,"discussion_content":"我也是😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622198560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":17628,"user_name":"傑","can_delete":false,"product_type":"c1","uid":1188469,"ip_address":"","ucode":"31E62923B5FC1E","user_header":"https://static001.geekbang.org/account/avatar/00/12/22/75/e17ee93a.jpg","comment_is_top":false,"comment_ctime":1532794489,"is_pvip":false,"replies":[{"id":"6115","content":"Profile可以看作是jvm学习的过程，统计程序执行的特点，找到热点，然后编译执行，最后是说仍然可能会发生逆优化","user_name":"作者回复","user_name_real":"杨晓峰","uid":"1009360","ctime":1532842858,"ip_address":"","comment_id":17628,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31597565561","product_id":100006701,"comment_content":"第二个图没有看太明白","like_count":7,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"杨晓峰","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421206,"discussion_content":"Profile可以看作是jvm学习的过程，统计程序执行的特点，找到热点，然后编译执行，最后是说仍然可能会发生逆优化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532842858,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":93128,"user_name":"Lynn","can_delete":false,"product_type":"c1","uid":1181539,"ip_address":"","ucode":"92988AD2FF241A","user_header":"https://static001.geekbang.org/account/avatar/00/12/07/63/a9e1ff40.jpg","comment_is_top":false,"comment_ctime":1557403435,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27327207211","product_id":100006701,"comment_content":"code cache 既然不能动态调整大小 为什么还有初始大小这个参数","like_count":6},{"had_liked":false,"id":133880,"user_name":"BewhY","can_delete":false,"product_type":"c1","uid":1079811,"ip_address":"","ucode":"4BC26D47A79967","user_header":"https://static001.geekbang.org/account/avatar/00/10/7a/03/c9b43b21.jpg","comment_is_top":false,"comment_ctime":1568689965,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23043526445","product_id":100006701,"comment_content":"这一章感觉没几个人能看得懂，那些平时说老师讲的很浅的人呢？","like_count":5},{"had_liked":false,"id":231203,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1593606950,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"10183541542","product_id":100006701,"comment_content":"这章看了好多遍，却还是感觉不好理解。当然郑雨迪老师的课，我也已经订阅了。会抽时间慢慢消化","like_count":2,"discussions":[{"author":{"id":1330357,"avatar":"https://static001.geekbang.org/account/avatar/00/14/4c/b5/fcede1a9.jpg","nickname":"IT小村","note":"","ucode":"BDFEE0D821CB6E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555966,"discussion_content":"你不清楚不是你的问题，是作者自己也不是很清楚，文章里边已推荐了好几个jvm专家了。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647146211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"子瞻","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352214,"discussion_content":"感觉质量怎么样呀？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614651312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1250907,"avatar":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","nickname":"Monday","note":"","ucode":"77B9BACC783598","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"子瞻","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352279,"discussion_content":"感觉不好懂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614671326,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":352214,"ip_address":""},"score":352279,"extra":""},{"author":{"id":1324314,"avatar":"https://static001.geekbang.org/account/avatar/00/14/35/1a/9fa38dc9.jpg","nickname":"子瞻","note":"","ucode":"5C26FF10934534","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1250907,"avatar":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","nickname":"Monday","note":"","ucode":"77B9BACC783598","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352315,"discussion_content":"哎我也同感，课程有的不错，有的。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614680189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":352279,"ip_address":""},"score":352315,"extra":""}]}]},{"had_liked":false,"id":76639,"user_name":"Geek_65a596","can_delete":false,"product_type":"c1","uid":1308547,"ip_address":"","ucode":"DCE701DC7B6D99","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ZEUY0xPncofNx0djiaAnYRClAibkLIq4mGcx2Re7jsne2f6qLgiaByiaicxr18BpQeIXYxCrvQmsFTp5X3LQkR43micA/132","comment_is_top":false,"comment_ctime":1552653648,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10142588240","product_id":100006701,"comment_content":"final对性能的影响看看字节码就知道了<br>，也可以通过查看编译详情查看","like_count":3},{"had_liked":false,"id":272194,"user_name":"随心而至","can_delete":false,"product_type":"c1","uid":1097836,"ip_address":"","ucode":"31866865255101","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg","comment_is_top":false,"comment_ctime":1609986141,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5904953437","product_id":100006701,"comment_content":"我觉得，这个问题的涉及面非常广，不是专门做这个的，了解一下就行了，不懂其实也没关系，毕竟社会分工不同。<br>真的想学JVM的，可以参考R大的豆列<br>https:&#47;&#47;www.douban.com&#47;doulist&#47;2545443&#47;","like_count":2},{"had_liked":false,"id":41356,"user_name":"achenbj","can_delete":false,"product_type":"c1","uid":1178990,"ip_address":"","ucode":"E5A4F7EB173C2F","user_header":"","comment_is_top":false,"comment_ctime":1542768531,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5837735827","product_id":100006701,"comment_content":"感觉去面试了才准备有点晚啊...","like_count":1},{"had_liked":false,"id":17638,"user_name":"茶底","can_delete":false,"product_type":"c1","uid":1188926,"ip_address":"","ucode":"687DD3686A84D2","user_header":"https://static001.geekbang.org/account/avatar/00/12/24/3e/692a93f7.jpg","comment_is_top":false,"comment_ctime":1532828916,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5827796212","product_id":100006701,"comment_content":"老师下一期能不能加点模块化的东西啊","like_count":1},{"had_liked":false,"id":17430,"user_name":"杨东yy","can_delete":false,"product_type":"c1","uid":1125212,"ip_address":"","ucode":"2355344A5D6C01","user_header":"https://static001.geekbang.org/account/avatar/00/11/2b/5c/a00fef79.jpg","comment_is_top":false,"comment_ctime":1532650078,"is_pvip":false,"replies":[{"id":"6049","content":"没有，你可以截取主干","user_name":"作者回复","user_name_real":"杨晓峰","uid":"1009360","ctime":1532679893,"ip_address":"","comment_id":17430,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5827617374","product_id":100006701,"comment_content":"老师，请问下，整个内容有ppt么，我这快整体总结下，在做思考，如果有的话，希望可以提供下，可以节约我一些时间，感谢","like_count":1,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"杨晓峰","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":421150,"discussion_content":"没有，你可以截取主干","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532679893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351878,"user_name":"张翀","can_delete":false,"product_type":"c1","uid":1241064,"ip_address":"","ucode":"835A01424FDD5E","user_header":"https://static001.geekbang.org/account/avatar/00/12/ef/e8/076a6f59.jpg","comment_is_top":false,"comment_ctime":1658275887,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1658275887","product_id":100006701,"comment_content":"C1 C2的数值是什么意思  前面讲过  但是忘了😂","like_count":0},{"had_liked":false,"id":258434,"user_name":"蒙奇•D•273°","can_delete":false,"product_type":"c1","uid":1179601,"ip_address":"","ucode":"5570919A507386","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/d1/28adb620.jpg","comment_is_top":false,"comment_ctime":1604442305,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604442305","product_id":100006701,"comment_content":"这章内容不错","like_count":0},{"had_liked":false,"id":194717,"user_name":"wt","can_delete":false,"product_type":"c1","uid":1317581,"ip_address":"","ucode":"925B16C8262914","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq5rPOOXGnzcSUD7O14DEHE55gxtS09Uic5nqYEliask4nhozufHia0Ktc7xZH3B6YeTVza6ZNejAupQ/132","comment_is_top":false,"comment_ctime":1585099602,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585099602","product_id":100006701,"comment_content":"&quot;偏向锁的撤销会触发安全点&quot;。这句是不是有点问题，是否是&quot;偏向锁的撤销需要等待安全点&quot;？可能效果一样，因为不到安全点线程还需要等待，同样不能执行","like_count":0},{"had_liked":false,"id":187420,"user_name":"柳十三","can_delete":false,"product_type":"c1","uid":1385852,"ip_address":"","ucode":"FE50C9778914C6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/tKvmZ3Vs4t6RZ3X7cAliaW47Zatxhn1aV5PcCYT9NZ9k9WWqRrEBGHicGtRWvsG6yQqHnaWw6cGNSbicNLjZebcHA/132","comment_is_top":false,"comment_ctime":1584105918,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584105918","product_id":100006701,"comment_content":"循环有final和无final的情况，打印循环前后的时间，比较两种情况的时间差","like_count":0},{"had_liked":false,"id":88152,"user_name":"流光","can_delete":false,"product_type":"c1","uid":1434612,"ip_address":"","ucode":"2B41D1B890018D","user_header":"https://static001.geekbang.org/account/avatar/00/15/e3/f4/ecb33aef.jpg","comment_is_top":false,"comment_ctime":1555859435,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555859435","product_id":100006701,"comment_content":"方法复用,调用次数多了就可以成为热点方法了,有这方面的意思吗","like_count":0},{"had_liked":false,"id":23337,"user_name":"XiaoYeGe","can_delete":false,"product_type":"c1","uid":1122953,"ip_address":"","ucode":"F07027153B6971","user_header":"https://static001.geekbang.org/account/avatar/00/11/22/89/5757eb43.jpg","comment_is_top":false,"comment_ctime":1536288686,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1536288686","product_id":100006701,"comment_content":"好容易学到这儿了，几个月了，我是不是有点菜。现在才看到这儿。嗯嗯，我是很菜。杨大神，后续考虑出一些视频课程吗？😂 🤓 🤓 🤓 🤓 ","like_count":0,"discussions":[{"author":{"id":1617059,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJ4C5xMfrgT207aLahibGGaeQGKMGwIiclYxZDcQpnJ05PsKFHn7ZX75sE3z8lbIryyVmL1DCML1Q3Q/132","nickname":"Geek_a3c961","note":"","ucode":"8CCD690FD0535A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":20843,"discussion_content":"我看到这边花了三天时间","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569384720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1248905,"avatar":"https://static001.geekbang.org/account/avatar/00/13/0e/89/a46b46dc.jpg","nickname":"李振召","note":"","ucode":"DDEB6B6D6355F2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5162,"discussion_content":"说明你看的仔细。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566015875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}