{"id":86490,"title":"50 | æ¡ˆä¾‹ç¯‡ï¼šåŠ¨æ€è¿½è¸ªæ€ä¹ˆç”¨ï¼Ÿï¼ˆä¸Šï¼‰","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å€ªæœ‹é£ã€‚</p><p>ä¸Šä¸€èŠ‚ï¼Œæˆ‘ä»¥ ksoftirqd CPU ä½¿ç”¨ç‡é«˜çš„é—®é¢˜ä¸ºä¾‹ï¼Œå¸¦ä½ ä¸€èµ·å­¦ä¹ äº†å†…æ ¸çº¿ç¨‹ CPU ä½¿ç”¨ç‡é«˜æ—¶çš„åˆ†ææ–¹æ³•ã€‚å…ˆç®€å•å›é¡¾ä¸€ä¸‹ã€‚</p><p>å½“ç¢°åˆ°å†…æ ¸çº¿ç¨‹çš„èµ„æºä½¿ç”¨å¼‚å¸¸æ—¶ï¼Œå¾ˆå¤šå¸¸ç”¨çš„è¿›ç¨‹çº§æ€§èƒ½å·¥å…·ï¼Œå¹¶ä¸èƒ½ç›´æ¥ç”¨åˆ°å†…æ ¸çº¿ç¨‹ä¸Šã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å†…æ ¸è‡ªå¸¦çš„ perf æ¥è§‚å¯Ÿå®ƒä»¬çš„è¡Œä¸ºï¼Œæ‰¾å‡ºçƒ­ç‚¹å‡½æ•°ï¼Œè¿›ä¸€æ­¥å®šä½æ€§èƒ½ç“¶é¢ˆã€‚ä¸è¿‡ï¼Œperf äº§ç”Ÿçš„æ±‡æ€»æŠ¥å‘Šå¹¶ä¸ç›´è§‚ï¼Œæ‰€ä»¥æˆ‘é€šå¸¸ä¹Ÿæ¨èç”¨ç«ç„°å›¾æ¥ååŠ©æ’æŸ¥ã€‚</p><p>å…¶å®ï¼Œä½¿ç”¨ perf å¯¹ç³»ç»Ÿå†…æ ¸çº¿ç¨‹è¿›è¡Œåˆ†ææ—¶ï¼Œå†…æ ¸çº¿ç¨‹ä¾ç„¶è¿˜åœ¨æ­£å¸¸è¿è¡Œä¸­ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•ä¹Ÿè¢«ç§°ä¸ºåŠ¨æ€è¿½è¸ªæŠ€æœ¯ã€‚</p><p><strong>åŠ¨æ€è¿½è¸ªæŠ€æœ¯ï¼Œé€šè¿‡æ¢é’ˆæœºåˆ¶ï¼Œæ¥é‡‡é›†å†…æ ¸æˆ–è€…åº”ç”¨ç¨‹åºçš„è¿è¡Œä¿¡æ¯ï¼Œä»è€Œå¯ä»¥ä¸ç”¨ä¿®æ”¹å†…æ ¸å’Œåº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œå°±è·å¾—ä¸°å¯Œçš„ä¿¡æ¯ï¼Œå¸®ä½ åˆ†æã€å®šä½æƒ³è¦æ’æŸ¥çš„é—®é¢˜ã€‚</strong></p><p>ä»¥å¾€ï¼Œåœ¨æ’æŸ¥å’Œè°ƒè¯•æ€§èƒ½é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦å…ˆä¸ºåº”ç”¨ç¨‹åºè®¾ç½®ä¸€ç³»åˆ—çš„æ–­ç‚¹ï¼ˆæ¯”å¦‚ä½¿ç”¨ GDBï¼‰ï¼Œç„¶åä»¥æ‰‹åŠ¨æˆ–è€…è„šæœ¬ï¼ˆæ¯”å¦‚ GDB çš„ Python æ‰©å±•ï¼‰çš„æ–¹å¼ï¼Œåœ¨è¿™äº›æ–­ç‚¹å¤„åˆ†æåº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚æˆ–è€…ï¼Œå¢åŠ ä¸€ç³»åˆ—çš„æ—¥å¿—ï¼Œä»æ—¥å¿—ä¸­å¯»æ‰¾çº¿ç´¢ã€‚</p><p>ä¸è¿‡ï¼Œæ–­ç‚¹å¾€å¾€ä¼šä¸­æ–­åº”ç”¨çš„æ­£å¸¸è¿è¡Œï¼›è€Œå¢åŠ æ–°çš„æ—¥å¿—ï¼Œå¾€å¾€éœ€è¦é‡æ–°ç¼–è¯‘å’Œéƒ¨ç½²ã€‚è¿™äº›æ–¹æ³•è™½ç„¶åœ¨ä»Šå¤©ä¾ç„¶å¹¿æ³›ä½¿ç”¨ï¼Œä½†åœ¨æ’æŸ¥å¤æ‚çš„æ€§èƒ½é—®é¢˜æ—¶ï¼Œå¾€å¾€è€—æ—¶è€—åŠ›ï¼Œæ›´ä¼šå¯¹åº”ç”¨çš„æ­£å¸¸è¿è¡Œé€ æˆå·¨å¤§å½±å“ã€‚</p><!-- [[[read_end]]] --><p>æ­¤å¤–ï¼Œè¿™ç±»æ–¹å¼è¿˜æœ‰å¤§é‡çš„æ€§èƒ½é—®é¢˜ã€‚æ¯”å¦‚ï¼Œå‡ºç°çš„æ¦‚ç‡å°ï¼Œåªæœ‰çº¿ä¸Šç¯å¢ƒæ‰èƒ½ç¢°åˆ°ã€‚è¿™ç§éš¾ä»¥å¤ç°çš„é—®é¢˜ï¼Œäº¦æ˜¯ä¸€ä¸ªå·¨å¤§æŒ‘æˆ˜ã€‚</p><p>è€ŒåŠ¨æ€è¿½è¸ªæŠ€æœ¯çš„å‡ºç°ï¼Œå°±ä¸ºè¿™äº›é—®é¢˜æä¾›äº†å®Œç¾çš„æ–¹æ¡ˆï¼šå®ƒæ—¢ä¸éœ€è¦åœæ­¢æœåŠ¡ï¼Œä¹Ÿä¸éœ€è¦ä¿®æ”¹åº”ç”¨ç¨‹åºçš„ä»£ç ï¼›æ‰€æœ‰ä¸€åˆ‡è¿˜æŒ‰ç…§åŸæ¥çš„æ–¹å¼æ­£å¸¸è¿è¡Œæ—¶ï¼Œå°±å¯ä»¥å¸®ä½ åˆ†æå‡ºé—®é¢˜çš„æ ¹æºã€‚</p><p>åŒæ—¶ï¼Œç›¸æ¯”ä»¥å¾€çš„è¿›ç¨‹çº§è·Ÿè¸ªæ–¹æ³•ï¼ˆæ¯”å¦‚ ptraceï¼‰ï¼ŒåŠ¨æ€è¿½è¸ªå¾€å¾€åªä¼šå¸¦æ¥å¾ˆå°çš„æ€§èƒ½æŸè€—ï¼ˆé€šå¸¸åœ¨ 5% æˆ–è€…æ›´å°‘ï¼‰ã€‚</p><p>æ—¢ç„¶åŠ¨æ€è¿½è¸ªæœ‰è¿™ä¹ˆå¤šå¥½å¤„ï¼Œé‚£ä¹ˆï¼Œéƒ½æœ‰å“ªäº›åŠ¨æ€è¿½è¸ªçš„æ–¹æ³•ï¼Œåˆè¯¥å¦‚ä½•ä½¿ç”¨è¿™äº›åŠ¨æ€è¿½è¸ªæ–¹æ³•å‘¢ï¼Ÿä»Šå¤©ï¼Œæˆ‘å°±å¸¦ä½ ä¸€èµ·æ¥çœ‹çœ‹è¿™ä¸ªé—®é¢˜ã€‚ç”±äºåŠ¨æ€è¿½è¸ªæ¶‰åŠçš„çŸ¥è¯†æ¯”è¾ƒå¤šï¼Œæˆ‘å°†åˆ†ä¸ºä¸Šã€ä¸‹ä¸¤ç¯‡ä¸ºä½ è®²è§£ï¼Œå…ˆæ¥çœ‹ä»Šå¤©è¿™éƒ¨åˆ†å†…å®¹ã€‚</p><h2>åŠ¨æ€è¿½è¸ª</h2><p>è¯´åˆ°åŠ¨æ€è¿½è¸ªï¼ˆDynamic Tracingï¼‰ï¼Œå°±ä¸å¾—ä¸ææºäº Solaris ç³»ç»Ÿçš„ DTraceã€‚DTrace æ˜¯åŠ¨æ€è¿½è¸ªæŠ€æœ¯çš„é¼»ç¥–ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªé€šç”¨çš„è§‚æµ‹æ¡†æ¶ï¼Œå¹¶å¯ä»¥ä½¿ç”¨ D è¯­è¨€è¿›è¡Œè‡ªç”±æ‰©å±•ã€‚</p><p>DTrace çš„å·¥ä½œåŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<strong>å®ƒçš„è¿è¡Œå¸¸é©»åœ¨å†…æ ¸ä¸­ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ dtrace å‘½ä»¤ï¼ŒæŠŠD è¯­è¨€ç¼–å†™çš„è¿½è¸ªè„šæœ¬ï¼Œæäº¤åˆ°å†…æ ¸ä¸­çš„è¿è¡Œæ—¶æ¥æ‰§è¡Œ</strong>ã€‚DTrace å¯ä»¥è·Ÿè¸ªç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„æ‰€æœ‰äº‹ä»¶ï¼Œå¹¶é€šè¿‡ä¸€äº›åˆ—çš„ä¼˜åŒ–æªæ–½ï¼Œä¿è¯æœ€å°çš„æ€§èƒ½å¼€é”€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/61/a6/6144b1947373bd5668010502bd0e45a6.png?wh=1798*1020\" alt=\"\"></p><p>ï¼ˆå›¾ç‰‡æ¥è‡ª <a href=\"https://www.bsdcan.org/2017/schedule/attachments/433_dtrace_internals.html#(24)\">BSDCan</a>ï¼‰</p><p>è™½ç„¶ç›´åˆ°ä»Šå¤©ï¼ŒDTrace æœ¬èº«ä¾ç„¶æ— æ³•åœ¨ Linux ä¸­è¿è¡Œï¼Œä½†å®ƒåŒæ ·å¯¹ Linux åŠ¨æ€è¿½è¸ªäº§ç”Ÿäº†å·¨å¤§çš„å½±å“ã€‚å¾ˆå¤šå·¥ç¨‹å¸ˆéƒ½å°è¯•è¿‡æŠŠ DTrace ç§»æ¤åˆ° Linux ä¸­ï¼Œè¿™å…¶ä¸­ï¼Œæœ€è‘—åçš„å°±æ˜¯ RedHat ä¸»æ¨çš„ SystemTapã€‚</p><p>åŒ DTrace ä¸€æ ·ï¼ŒSystemTap ä¹Ÿå®šä¹‰äº†ä¸€ç§ç±»ä¼¼çš„è„šæœ¬è¯­è¨€ï¼Œæ–¹ä¾¿ç”¨æˆ·æ ¹æ®éœ€è¦è‡ªç”±æ‰©å±•ã€‚ä¸è¿‡ï¼Œä¸åŒäº DTraceï¼ŒSystemTap å¹¶æ²¡æœ‰å¸¸é©»å†…æ ¸çš„è¿è¡Œæ—¶ï¼Œå®ƒéœ€è¦å…ˆæŠŠè„šæœ¬ç¼–è¯‘ä¸ºå†…æ ¸æ¨¡å—ï¼Œç„¶åå†æ’å…¥åˆ°å†…æ ¸ä¸­æ‰§è¡Œã€‚è¿™ä¹Ÿå¯¼è‡´ SystemTap å¯åŠ¨æ¯”è¾ƒç¼“æ…¢ï¼Œå¹¶ä¸”ä¾èµ–äºå®Œæ•´çš„è°ƒè¯•ç¬¦å·è¡¨ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e0/db/e09aa4a00aee93f27f0d666a2bb1c4db.png?wh=888*422\" alt=\"\"></p><p>ï¼ˆå›¾ç‰‡æ¥è‡ª<a href=\"https://openresty.org/posts/dynamic-tracing/\">åŠ¨æ€è¿½è¸ªæŠ€æœ¯æ¼«è°ˆ</a>ï¼‰</p><p>æ€»çš„æ¥è¯´ï¼Œä¸ºäº†è¿½è¸ªå†…æ ¸æˆ–ç”¨æˆ·ç©ºé—´çš„äº‹ä»¶ï¼ŒDtrace å’Œ SystemTap éƒ½ä¼šæŠŠç”¨æˆ·ä¼ å…¥çš„è¿½è¸ªå¤„ç†å‡½æ•°ï¼ˆä¸€èˆ¬ç§°ä¸º Actionï¼‰ï¼Œå…³è”åˆ°è¢«ç§°ä¸ºæ¢é’ˆçš„æ£€æµ‹ç‚¹ä¸Šã€‚è¿™äº›æ¢é’ˆï¼Œå®é™…ä¸Šä¹Ÿå°±æ˜¯å„ç§åŠ¨æ€è¿½è¸ªæŠ€æœ¯æ‰€ä¾èµ–çš„äº‹ä»¶æºã€‚</p><h3>åŠ¨æ€è¿½è¸ªçš„äº‹ä»¶æº</h3><p>æ ¹æ®äº‹ä»¶ç±»å‹çš„ä¸åŒï¼Œ<strong>åŠ¨æ€è¿½è¸ªæ‰€ä½¿ç”¨çš„äº‹ä»¶æºï¼Œå¯ä»¥åˆ†ä¸ºé™æ€æ¢é’ˆã€åŠ¨æ€æ¢é’ˆä»¥åŠç¡¬ä»¶äº‹ä»¶ç­‰ä¸‰ç±»</strong>ã€‚å®ƒä»¬çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/ba/61/ba6c9ed0dcccc7f4f46bb19c69946e61.png?wh=1500*1050\" alt=\"\"></p><p>ï¼ˆå›¾ç‰‡æ¥è‡ª <a href=\"http://www.brendangregg.com/perf.html#Events\">Brendan Gregg Blog</a>ï¼‰</p><p>å…¶ä¸­ï¼Œ<strong>ç¡¬ä»¶äº‹ä»¶é€šå¸¸ç”±æ€§èƒ½ç›‘æ§è®¡æ•°å™¨ PMCï¼ˆPerformance Monitoring Counterï¼‰äº§ç”Ÿ</strong>ï¼ŒåŒ…æ‹¬äº†å„ç§ç¡¬ä»¶çš„æ€§èƒ½æƒ…å†µï¼Œæ¯”å¦‚ CPU çš„ç¼“å­˜ã€æŒ‡ä»¤å‘¨æœŸã€åˆ†æ”¯é¢„æµ‹ç­‰ç­‰ã€‚</p><p><strong>é™æ€æ¢é’ˆï¼Œæ˜¯æŒ‡äº‹å…ˆåœ¨ä»£ç ä¸­å®šä¹‰å¥½ï¼Œå¹¶ç¼–è¯‘åˆ°åº”ç”¨ç¨‹åºæˆ–è€…å†…æ ¸ä¸­çš„æ¢é’ˆ</strong>ã€‚è¿™äº›æ¢é’ˆåªæœ‰åœ¨å¼€å¯æ¢æµ‹åŠŸèƒ½æ—¶ï¼Œæ‰ä¼šè¢«æ‰§è¡Œåˆ°ï¼›æœªå¼€å¯æ—¶å¹¶ä¸ä¼šæ‰§è¡Œã€‚å¸¸è§çš„é™æ€æ¢é’ˆåŒ…æ‹¬å†…æ ¸ä¸­çš„è·Ÿè¸ªç‚¹ï¼ˆtracepointsï¼‰å’Œ USDTï¼ˆUserland Statically Defined Tracingï¼‰æ¢é’ˆã€‚</p><ul>\n<li>\n<p>è·Ÿè¸ªç‚¹ï¼ˆtracepointsï¼‰ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨æºç ä¸­æ’å…¥çš„ä¸€äº›å¸¦æœ‰æ§åˆ¶æ¡ä»¶çš„æ¢æµ‹ç‚¹ï¼Œè¿™äº›æ¢æµ‹ç‚¹å…è®¸äº‹åå†æ·»åŠ å¤„ç†å‡½æ•°ã€‚æ¯”å¦‚åœ¨å†…æ ¸ä¸­ï¼Œæœ€å¸¸è§çš„é™æ€è·Ÿè¸ªæ–¹æ³•å°±æ˜¯ printkï¼Œå³è¾“å‡ºæ—¥å¿—ã€‚Linux å†…æ ¸å®šä¹‰äº†å¤§é‡çš„è·Ÿè¸ªç‚¹ï¼Œå¯ä»¥é€šè¿‡å†…æ ¸ç¼–è¯‘é€‰é¡¹ï¼Œæ¥å¼€å¯æˆ–è€…å…³é—­ã€‚</p>\n</li>\n<li>\n<p>USDT æ¢é’ˆï¼Œå…¨ç§°æ˜¯ç”¨æˆ·çº§é™æ€å®šä¹‰è·Ÿè¸ªï¼Œéœ€è¦åœ¨æºç ä¸­æ’å…¥ DTRACE_PROBE() ä»£ç ï¼Œå¹¶ç¼–è¯‘åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚ä¸è¿‡ï¼Œä¹Ÿæœ‰å¾ˆå¤šåº”ç”¨ç¨‹åºå†…ç½®äº† USDT æ¢é’ˆï¼Œæ¯”å¦‚ MySQLã€PostgreSQL ç­‰ã€‚</p>\n</li>\n</ul><p><strong>åŠ¨æ€æ¢é’ˆï¼Œåˆ™æ˜¯æŒ‡æ²¡æœ‰äº‹å…ˆåœ¨ä»£ç ä¸­å®šä¹‰ï¼Œä½†å´å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ·»åŠ çš„æ¢é’ˆ</strong>ï¼Œæ¯”å¦‚å‡½æ•°çš„è°ƒç”¨å’Œè¿”å›ç­‰ã€‚åŠ¨æ€æ¢é’ˆæ”¯æŒæŒ‰éœ€åœ¨å†…æ ¸æˆ–è€…åº”ç”¨ç¨‹åºä¸­æ·»åŠ æ¢æµ‹ç‚¹ï¼Œå…·æœ‰æ›´é«˜çš„çµæ´»æ€§ã€‚å¸¸è§çš„åŠ¨æ€æ¢é’ˆæœ‰ä¸¤ç§ï¼Œå³ç”¨äºå†…æ ¸æ€çš„ kprobes å’Œç”¨äºç”¨æˆ·æ€çš„ uprobesã€‚</p><ul>\n<li>\n<p>kprobes ç”¨æ¥è·Ÿè¸ªå†…æ ¸æ€çš„å‡½æ•°ï¼ŒåŒ…æ‹¬ç”¨äºå‡½æ•°è°ƒç”¨çš„ kprobe å’Œç”¨äºå‡½æ•°è¿”å›çš„ kretprobeã€‚</p>\n</li>\n<li>\n<p>uprobes ç”¨æ¥è·Ÿè¸ªç”¨æˆ·æ€çš„å‡½æ•°ï¼ŒåŒ…æ‹¬ç”¨äºå‡½æ•°è°ƒç”¨çš„ uprobe å’Œç”¨äºå‡½æ•°è¿”å›çš„ uretprobeã€‚</p>\n</li>\n</ul><blockquote>\n<p>æ³¨æ„ï¼Œkprobes éœ€è¦å†…æ ¸ç¼–è¯‘æ—¶å¼€å¯ CONFIG_KPROBE_EVENTSï¼›è€Œ uprobes åˆ™éœ€è¦å†…æ ¸ç¼–è¯‘æ—¶å¼€å¯ CONFIG_UPROBE_EVENTSã€‚</p>\n</blockquote><h3>åŠ¨æ€è¿½è¸ªæœºåˆ¶</h3><p>è€Œåœ¨è¿™äº›æ¢é’ˆçš„åŸºç¡€ä¸Šï¼ŒLinux ä¹Ÿæä¾›äº†ä¸€ç³»åˆ—çš„åŠ¨æ€è¿½è¸ªæœºåˆ¶ï¼Œæ¯”å¦‚ ftraceã€perfã€eBPF ç­‰ã€‚</p><p><strong>ftrace</strong> æœ€æ—©ç”¨äºå‡½æ•°è·Ÿè¸ªï¼Œåæ¥åˆæ‰©å±•æ”¯æŒäº†å„ç§äº‹ä»¶è·Ÿè¸ªåŠŸèƒ½ã€‚ftrace çš„ä½¿ç”¨æ¥å£è·Ÿæˆ‘ä»¬ä¹‹å‰æåˆ°çš„ procfs ç±»ä¼¼ï¼Œå®ƒé€šè¿‡ debugfsï¼ˆ4.1 ä»¥åä¹Ÿæ”¯æŒ tracefsï¼‰ï¼Œä»¥æ™®é€šæ–‡ä»¶çš„å½¢å¼ï¼Œå‘ç”¨æˆ·ç©ºé—´æä¾›è®¿é—®æ¥å£ã€‚</p><p>è¿™æ ·ï¼Œä¸éœ€è¦é¢å¤–çš„å·¥å…·ï¼Œä½ å°±å¯ä»¥é€šè¿‡æŒ‚è½½ç‚¹ï¼ˆé€šå¸¸ä¸º /sys/kernel/debug/tracing ç›®å½•ï¼‰å†…çš„æ–‡ä»¶è¯»å†™ï¼Œæ¥è·Ÿ ftrace äº¤äº’ï¼Œè·Ÿè¸ªå†…æ ¸æˆ–è€…åº”ç”¨ç¨‹åºçš„è¿è¡Œäº‹ä»¶ã€‚</p><p><strong>perf</strong> æ˜¯æˆ‘ä»¬çš„è€æœ‹å‹äº†ï¼Œæˆ‘ä»¬åœ¨å‰é¢çš„å¥½å¤šæ¡ˆä¾‹ä¸­ï¼Œéƒ½ä½¿ç”¨äº†å®ƒçš„äº‹ä»¶è®°å½•å’Œåˆ†æåŠŸèƒ½ï¼Œè¿™å®é™…ä¸Šåªæ˜¯ä¸€ç§æœ€ç®€å•çš„é™æ€è·Ÿè¸ªæœºåˆ¶ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡ perf ï¼Œæ¥è‡ªå®šä¹‰åŠ¨æ€äº‹ä»¶ï¼ˆperf probeï¼‰ï¼Œåªå…³æ³¨çœŸæ­£æ„Ÿå…´è¶£çš„äº‹ä»¶ã€‚</p><p><strong>eBPF</strong> åˆ™åœ¨ BPFï¼ˆBerkeley Packet Filterï¼‰çš„åŸºç¡€ä¸Šæ‰©å±•è€Œæ¥ï¼Œä¸ä»…æ”¯æŒäº‹ä»¶è·Ÿè¸ªæœºåˆ¶ï¼Œè¿˜å¯ä»¥é€šè¿‡è‡ªå®šä¹‰çš„ BPF ä»£ç ï¼ˆä½¿ç”¨ C è¯­è¨€ï¼‰æ¥è‡ªç”±æ‰©å±•ã€‚æ‰€ä»¥ï¼ŒeBPF å®é™…ä¸Šå°±æ˜¯å¸¸é©»äºå†…æ ¸çš„è¿è¡Œæ—¶ï¼Œå¯ä»¥è¯´å°±æ˜¯ Linux ç‰ˆçš„ DTraceã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šå†…æ ¸å¤–çš„å·¥å…·ï¼Œä¹Ÿæä¾›äº†ä¸°å¯Œçš„åŠ¨æ€è¿½è¸ªåŠŸèƒ½ã€‚æœ€å¸¸è§çš„å°±æ˜¯å‰é¢æåˆ°çš„ <strong>SystemTap</strong>ï¼Œæˆ‘ä»¬ä¹‹å‰å¤šæ¬¡ä½¿ç”¨è¿‡çš„ <strong>BCC</strong>ï¼ˆBPF Compiler Collectionï¼‰ï¼Œä»¥åŠå¸¸ç”¨äºå®¹å™¨æ€§èƒ½åˆ†æçš„ <strong>sysdig</strong> ç­‰ã€‚</p><p>è€Œåœ¨åˆ†æå¤§é‡äº‹ä»¶æ—¶ï¼Œä½¿ç”¨æˆ‘ä»¬ä¸ŠèŠ‚è¯¾æåˆ°çš„ç«ç„°å›¾ï¼Œå¯ä»¥å°†å¤§é‡æ•°æ®å¯è§†åŒ–å±•ç¤ºï¼Œè®©ä½ æ›´ç›´è§‚å‘ç°æ½œåœ¨çš„é—®é¢˜ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘å°±é€šè¿‡å‡ ä¸ªä¾‹å­ï¼Œå¸¦ä½ æ¥çœ‹çœ‹ï¼Œè¦æ€ä¹ˆä½¿ç”¨è¿™äº›æœºåˆ¶ï¼Œæ¥åŠ¨æ€è¿½è¸ªå†…æ ¸å’Œåº”ç”¨ç¨‹åºçš„æ‰§è¡Œæƒ…å†µã€‚ä»¥ä¸‹æ¡ˆä¾‹è¿˜æ˜¯åŸºäº Ubuntu 18.04 ç³»ç»Ÿï¼ŒåŒæ ·é€‚ç”¨äºå…¶ä»–ç³»ç»Ÿã€‚</p><blockquote>\n<p>æ³¨æ„ï¼Œä»¥ä¸‹æ‰€æœ‰å‘½ä»¤éƒ½é»˜è®¤ä»¥ root ç”¨æˆ·è¿è¡Œï¼Œå¦‚æœä½ ç”¨æ™®é€šç”¨æˆ·èº«ä»½ç™»é™†ç³»ç»Ÿï¼Œè¯·è¿è¡Œ sudo su root å‘½ä»¤åˆ‡æ¢åˆ° root ç”¨æˆ·ã€‚</p>\n</blockquote><h2>ftrace</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹ ftraceã€‚åˆšåˆšæåˆ°è¿‡ï¼Œftrace é€šè¿‡ debugfsï¼ˆæˆ–è€… tracefsï¼‰ï¼Œä¸ºç”¨æˆ·ç©ºé—´æä¾›æ¥å£ã€‚æ‰€ä»¥ä½¿ç”¨ ftraceï¼Œå¾€å¾€æ˜¯ä»åˆ‡æ¢åˆ° debugfs çš„æŒ‚è½½ç‚¹å¼€å§‹ã€‚</p><pre><code>$ cd /sys/kernel/debug/tracing\n$ ls\nREADME                      instances            set_ftrace_notrace  trace_marker_raw\navailable_events            kprobe_events        set_ftrace_pid      trace_options\n...\n</code></pre><p>å¦‚æœè¿™ä¸ªç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™è¯´æ˜ä½ çš„ç³»ç»Ÿè¿˜æ²¡æœ‰æŒ‚è½½ debugfsï¼Œä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥æŒ‚è½½å®ƒï¼š</p><pre><code>$ mount -t debugfs nodev /sys/kernel/debug\n</code></pre><p>ftrace æä¾›äº†å¤šä¸ªè·Ÿè¸ªå™¨ï¼Œç”¨äºè·Ÿè¸ªä¸åŒç±»å‹çš„ä¿¡æ¯ï¼Œæ¯”å¦‚å‡½æ•°è°ƒç”¨ã€ä¸­æ–­å…³é—­ã€è¿›ç¨‹è°ƒåº¦ç­‰ã€‚å…·ä½“æ”¯æŒçš„è·Ÿè¸ªå™¨å–å†³äºç³»ç»Ÿé…ç½®ï¼Œä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œæ¥æŸ¥è¯¢æ‰€æœ‰æ”¯æŒçš„è·Ÿè¸ªå™¨ï¼š</p><pre><code>$ cat available_tracers\nhwlat blk mmiotrace function_graph wakeup_dl wakeup_rt wakeup function nop\n</code></pre><p>è¿™å…¶ä¸­ï¼Œfunction è¡¨ç¤ºè·Ÿè¸ªå‡½æ•°çš„æ‰§è¡Œï¼Œfunction_graph åˆ™æ˜¯è·Ÿè¸ªå‡½æ•°çš„è°ƒç”¨å…³ç³»ï¼Œä¹Ÿå°±æ˜¯ç”Ÿæˆç›´è§‚çš„è°ƒç”¨å…³ç³»å›¾ã€‚è¿™ä¾¿æ˜¯æœ€å¸¸ç”¨çš„ä¸¤ç§è·Ÿè¸ªå™¨ã€‚</p><p>é™¤äº†è·Ÿè¸ªå™¨å¤–ï¼Œä½¿ç”¨ ftrace å‰ï¼Œè¿˜éœ€è¦ç¡®è®¤è·Ÿè¸ªç›®æ ‡ï¼ŒåŒ…æ‹¬å†…æ ¸å‡½æ•°å’Œå†…æ ¸äº‹ä»¶ã€‚å…¶ä¸­ï¼Œ</p><ul>\n<li>\n<p>å‡½æ•°å°±æ˜¯å†…æ ¸ä¸­çš„å‡½æ•°åã€‚</p>\n</li>\n<li>\n<p>è€Œäº‹ä»¶ï¼Œåˆ™æ˜¯å†…æ ¸æºç ä¸­é¢„å…ˆå®šä¹‰çš„è·Ÿè¸ªç‚¹ã€‚</p>\n</li>\n</ul><p>åŒæ ·åœ°ï¼Œä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œæ¥æŸ¥è¯¢æ”¯æŒçš„å‡½æ•°å’Œäº‹ä»¶ï¼š</p><pre><code>$ cat available_filter_functions\n$ cat available_events\n</code></pre><p>æ˜ç™½äº†è¿™äº›åŸºæœ¬ä¿¡æ¯ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘å°±ä»¥ ls å‘½ä»¤ä¸ºä¾‹ï¼Œå¸¦ä½ ä¸€èµ·çœ‹çœ‹ ftrace çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><p>ä¸ºäº†åˆ—å‡ºæ–‡ä»¶ï¼Œls å‘½ä»¤ä¼šé€šè¿‡ open ç³»ç»Ÿè°ƒç”¨æ‰“å¼€ç›®å½•æ–‡ä»¶ï¼Œè€Œ open åœ¨å†…æ ¸ä¸­å¯¹åº”çš„å‡½æ•°åä¸º do_sys_openã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦åšçš„ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯æŠŠè¦è·Ÿè¸ªçš„å‡½æ•°è®¾ç½®ä¸º do_sys_openï¼š</p><pre><code>$ echo do_sys_open &gt; set_graph_function\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œç¬¬äºŒæ­¥ï¼Œé…ç½®è·Ÿè¸ªé€‰é¡¹ï¼Œå¼€å¯å‡½æ•°è°ƒç”¨è·Ÿè¸ªï¼Œå¹¶è·Ÿè¸ªè°ƒç”¨è¿›ç¨‹ï¼š</p><pre><code>$ echo function_graph &gt; current_tracer\n$ echo funcgraph-proc &gt; trace_options\n</code></pre><p>æ¥ç€ï¼Œç¬¬ä¸‰æ­¥ï¼Œä¹Ÿå°±æ˜¯å¼€å¯è·Ÿè¸ªï¼š</p><pre><code>$ echo 1 &gt; tracing_on\n</code></pre><p>ç¬¬å››æ­¥ï¼Œæ‰§è¡Œä¸€ä¸ª ls å‘½ä»¤åï¼Œå†å…³é—­è·Ÿè¸ªï¼š</p><pre><code>$ ls\n$ echo 0 &gt; tracing_on\n</code></pre><p>ç¬¬äº”æ­¥ï¼Œä¹Ÿæ˜¯æœ€åä¸€æ­¥ï¼ŒæŸ¥çœ‹è·Ÿè¸ªç»“æœï¼š</p><pre><code>$ cat trace\n# tracer: function_graph\n#\n# CPU  TASK/PID         DURATION                  FUNCTION CALLS\n# |     |    |           |   |                     |   |   |   |\n 0)    ls-12276    |               |  do_sys_open() {\n 0)    ls-12276    |               |    getname() {\n 0)    ls-12276    |               |      getname_flags() {\n 0)    ls-12276    |               |        kmem_cache_alloc() {\n 0)    ls-12276    |               |          _cond_resched() {\n 0)    ls-12276    |   0.049 us    |            rcu_all_qs();\n 0)    ls-12276    |   0.791 us    |          }\n 0)    ls-12276    |   0.041 us    |          should_failslab();\n 0)    ls-12276    |   0.040 us    |          prefetch_freepointer();\n 0)    ls-12276    |   0.039 us    |          memcg_kmem_put_cache();\n 0)    ls-12276    |   2.895 us    |        }\n 0)    ls-12276    |               |        __check_object_size() {\n 0)    ls-12276    |   0.067 us    |          __virt_addr_valid();\n 0)    ls-12276    |   0.044 us    |          __check_heap_object();\n 0)    ls-12276    |   0.039 us    |          check_stack_object();\n 0)    ls-12276    |   1.570 us    |        }\n 0)    ls-12276    |   5.790 us    |      }\n 0)    ls-12276    |   6.325 us    |    }\n...\n</code></pre><p>åœ¨æœ€åå¾—åˆ°çš„è¾“å‡ºä¸­ï¼š</p><ul>\n<li>\n<p>ç¬¬ä¸€åˆ—è¡¨ç¤ºè¿è¡Œçš„ CPUï¼›</p>\n</li>\n<li>\n<p>ç¬¬äºŒåˆ—æ˜¯ä»»åŠ¡åç§°å’Œè¿›ç¨‹ PIDï¼›</p>\n</li>\n<li>\n<p>ç¬¬ä¸‰åˆ—æ˜¯å‡½æ•°æ‰§è¡Œå»¶è¿Ÿï¼›</p>\n</li>\n<li>\n<p>æœ€åä¸€åˆ—ï¼Œåˆ™æ˜¯å‡½æ•°è°ƒç”¨å…³ç³»å›¾ã€‚</p>\n</li>\n</ul><p>ä½ å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°è°ƒç”¨å›¾ï¼Œé€šè¿‡ä¸åŒçº§åˆ«çš„ç¼©è¿›ï¼Œç›´è§‚å±•ç¤ºäº†å„å‡½æ•°é—´çš„è°ƒç”¨å…³ç³»ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘æƒ³ä½ åº”è¯¥ä¹Ÿå‘ç°äº† ftrace çš„ä½¿ç”¨ç¼ºç‚¹â€”â€”äº”ä¸ªæ­¥éª¤å®åœ¨æ˜¯éº»çƒ¦ï¼Œç”¨èµ·æ¥å¹¶ä¸æ–¹ä¾¿ã€‚ä¸è¿‡ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œ <a href=\"https://git.kernel.org/pub/scm/utils/trace-cmd/trace-cmd.git/\">trace-cmd</a> å·²ç»å¸®ä½ æŠŠè¿™äº›æ­¥éª¤ç»™åŒ…è£…äº†èµ·æ¥ã€‚è¿™æ ·ï¼Œä½ å°±å¯ä»¥åœ¨åŒä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·é‡Œï¼Œå®Œæˆä¸Šè¿°æ‰€æœ‰è¿‡ç¨‹ã€‚</p><p>ä½ å¯ä»¥æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œæ¥å®‰è£… trace-cmd ï¼š</p><pre><code># Ubuntu\n$ apt-get install trace-cmd\n# CentOS\n$ yum install trace-cmd\n</code></pre><p>å®‰è£…å¥½åï¼ŒåŸæœ¬çš„äº”æ­¥è·Ÿè¸ªè¿‡ç¨‹ï¼Œå°±å¯ä»¥ç®€åŒ–ä¸ºä¸‹é¢è¿™ä¸¤æ­¥ï¼š</p><pre><code>$ trace-cmd record -p function_graph -g do_sys_open -O funcgraph-proc ls\n$ trace-cmd report\n...\n              ls-12418 [000] 85558.075341: funcgraph_entry:                   |  do_sys_open() {\n              ls-12418 [000] 85558.075363: funcgraph_entry:                   |    getname() {\n              ls-12418 [000] 85558.075364: funcgraph_entry:                   |      getname_flags() {\n              ls-12418 [000] 85558.075364: funcgraph_entry:                   |        kmem_cache_alloc() {\n              ls-12418 [000] 85558.075365: funcgraph_entry:                   |          _cond_resched() {\n              ls-12418 [000] 85558.075365: funcgraph_entry:        0.074 us   |            rcu_all_qs();\n              ls-12418 [000] 85558.075366: funcgraph_exit:         1.143 us   |          }\n              ls-12418 [000] 85558.075366: funcgraph_entry:        0.064 us   |          should_failslab();\n              ls-12418 [000] 85558.075367: funcgraph_entry:        0.075 us   |          prefetch_freepointer();\n              ls-12418 [000] 85558.075368: funcgraph_entry:        0.085 us   |          memcg_kmem_put_cache();\n              ls-12418 [000] 85558.075369: funcgraph_exit:         4.447 us   |        }\n              ls-12418 [000] 85558.075369: funcgraph_entry:                   |        __check_object_size() {\n              ls-12418 [000] 85558.075370: funcgraph_entry:        0.132 us   |          __virt_addr_valid();\n              ls-12418 [000] 85558.075370: funcgraph_entry:        0.093 us   |          __check_heap_object();\n              ls-12418 [000] 85558.075371: funcgraph_entry:        0.059 us   |          check_stack_object();\n              ls-12418 [000] 85558.075372: funcgraph_exit:         2.323 us   |        }\n              ls-12418 [000] 85558.075372: funcgraph_exit:         8.411 us   |      }\n              ls-12418 [000] 85558.075373: funcgraph_exit:         9.195 us   |    }\n...\n</code></pre><p>ä½ ä¼šå‘ç°ï¼Œtrace-cmd çš„è¾“å‡ºï¼Œè·Ÿä¸Šè¿° cat trace çš„è¾“å‡ºæ˜¯ç±»ä¼¼çš„ã€‚</p><p>é€šè¿‡è¿™ä¸ªä¾‹å­æˆ‘ä»¬çŸ¥é“ï¼Œå½“ä½ æƒ³è¦äº†è§£æŸä¸ªå†…æ ¸å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹æ—¶ï¼Œä½¿ç”¨ ftrace ï¼Œå°±å¯ä»¥è·Ÿè¸ªåˆ°å®ƒçš„æ‰§è¡Œè¿‡ç¨‹ã€‚</p><h2>å°ç»“</h2><p>ä»Šå¤©ï¼Œæˆ‘å¸¦ä½ ä¸€èµ·å­¦ä¹ äº†å¸¸è§çš„åŠ¨æ€è¿½è¸ªæ–¹æ³•ã€‚æ‰€è°“åŠ¨æ€è¿½è¸ªï¼Œå°±æ˜¯åœ¨ç³»ç»Ÿæˆ–åº”ç”¨ç¨‹åºæ­£å¸¸è¿è¡Œæ—¶ï¼Œé€šè¿‡å†…æ ¸ä¸­æä¾›çš„æ¢é’ˆæ¥åŠ¨æ€è¿½è¸ªå®ƒä»¬çš„è¡Œä¸ºï¼Œä»è€Œè¾…åŠ©æ’æŸ¥å‡ºæ€§èƒ½ç“¶é¢ˆã€‚</p><p>è€Œåœ¨ Linux ç³»ç»Ÿä¸­ï¼Œå¸¸è§çš„åŠ¨æ€è¿½è¸ªæ–¹æ³•åŒ…æ‹¬ ftraceã€perfã€eBPF ä»¥åŠ SystemTap ç­‰ã€‚å½“ä½ å·²ç»å®šä½äº†æŸä¸ªå†…æ ¸å‡½æ•°ï¼Œä½†ä¸æ¸…æ¥šå®ƒçš„å®ç°åŸç†æ—¶ï¼Œå°±å¯ä»¥ç”¨ ftrace æ¥è·Ÿè¸ªå®ƒçš„æ‰§è¡Œè¿‡ç¨‹ã€‚è‡³äºå…¶ä»–åŠ¨æ€è¿½è¸ªæ–¹æ³•ï¼Œæˆ‘å°†åœ¨ä¸‹èŠ‚è¯¾ç»§ç»­ä¸ºä½ è¯¦ç»†è§£è¯»ã€‚</p><h2>æ€è€ƒ</h2><p>æœ€åï¼Œç»™ä½ ç•™ä¸€ä¸ªæ€è€ƒé¢˜ã€‚ä»Šå¤©çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Linux å†…æ ¸æä¾›çš„ ftrace æœºåˆ¶ï¼Œæ¥äº†è§£å†…æ ¸å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ï¼›è€Œä¸ŠèŠ‚è¯¾æˆ‘ä»¬åˆ™ç”¨äº† perf å’Œç«ç„°å›¾ï¼Œæ¥è§‚å¯Ÿå†…æ ¸çš„è°ƒç”¨å †æ ˆã€‚</p><p>æ ¹æ®è¿™ä¸¤ä¸ªæ¡ˆä¾‹ï¼Œä½ è§‰å¾—è¿™ä¸¤ç§æ–¹æ³•æœ‰ä»€ä¹ˆä¸ä¸€æ ·çš„åœ°æ–¹ï¼Ÿå½“éœ€è¦äº†è§£å†…æ ¸çš„è¡Œä¸ºæ—¶ï¼Œå¦‚ä½•åœ¨äºŒè€…ä¸­é€‰æ‹©ï¼Œæˆ–è€…è¯´ï¼Œè¿™ä¸¤ç§æ–¹æ³•åˆ†åˆ«é€‚ç”¨äºä»€ä¹ˆæ ·çš„åœºæ™¯å‘¢ï¼Ÿä½ å¯ä»¥ç»“åˆä»Šå¤©çš„å†…å®¹ï¼Œå’Œä½ è‡ªå·±çš„æ“ä½œè®°å½•ï¼Œæ¥æ€»ç»“æ€è·¯ã€‚</p><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œä¹Ÿæ¬¢è¿æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„åŒäº‹ã€æœ‹å‹ã€‚æˆ‘ä»¬ä¸€èµ·åœ¨å®æˆ˜ä¸­æ¼”ç»ƒï¼Œåœ¨äº¤æµä¸­è¿›æ­¥ã€‚</p><p></p>","comments":[{"had_liked":false,"id":78002,"user_name":"æˆ‘æ¥ä¹Ÿ","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1553052469,"is_pvip":false,"replies":[{"id":"28779","content":"å—¯å—¯ï¼Œéå¸¸å‡†ç¡®ã€‚å‡½æ•°è·Ÿè¸ªéœ€è¦å®ç°çŸ¥é“å‡½æ•°åï¼Œè€Œperf&#47;ç«ç„°å›¾å°±å¯ä»¥æ‰¾å‡ºçƒ­ç‚¹å‡½æ•°ã€‚","user_name":"ä½œè€…å›å¤","comment_id":78002,"uid":"1001282","ip_address":"","utype":1,"ctime":1553319726,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"147581940533","product_id":100020901,"comment_content":"[D50æ‰“å¡]<br>è¯¾åæ€è€ƒé¢˜,æˆ‘çš„æ€è€ƒ,ä¸ä¸€å®šå‡†ç¡®.<br>æˆ‘è§‰å¾—æ˜¨å¤©çš„perfå’Œç«ç„°å›¾,æ˜¯é‡‡æ ·. è€Œä»Šå¤©çš„ftraceæ˜¯å®å®åœ¨åœ¨çš„åˆ†ææ¯æ¬¡ä¸€çš„è°ƒç”¨.<br>è™½ç„¶éƒ½å¯ä»¥çœ‹è°ƒç”¨å †æ ˆå’Œè€—æ—¶æ¯”ä¾‹. ä½†æ˜¯ftraceåº”è¯¥æ˜¯éå¸¸å‡†ç¡®,è€Œperfåªæ˜¯ä¸€ä¸ªé‡‡æ ·,æ¯”å¦‚é‡‡æ ·é¢‘ç‡1%.<br><br>æˆ‘è§‰å¾—æ‰¾å¤§æ–¹å‘æ—¶,ä½¿ç”¨perfå’Œç«ç„°å›¾, æ‰¾å…·ä½“é—®é¢˜æ—¶,ç”¨ftrace.æ¯•ç«Ÿftraceéœ€è¦çŸ¥é“è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•°.<br>ftraceéœ€è¦è¿½è¸ªçš„ä¿¡æ¯å¯ä»¥æ¥æºäºperfçš„åˆ†æç»“æœ.","like_count":35,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443932,"discussion_content":"å—¯å—¯ï¼Œéå¸¸å‡†ç¡®ã€‚å‡½æ•°è·Ÿè¸ªéœ€è¦å®ç°çŸ¥é“å‡½æ•°åï¼Œè€Œperf/ç«ç„°å›¾å°±å¯ä»¥æ‰¾å‡ºçƒ­ç‚¹å‡½æ•°ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1553319726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1484184,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a5/98/a65ff31a.jpg","nickname":"djfhchdh","note":"","ucode":"E71D75328CE398","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293238,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595489586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78013,"user_name":"lizh","can_delete":false,"product_type":"c1","uid":1387601,"ip_address":"","ucode":"EF3BF85E212D53","user_header":"https://static001.geekbang.org/account/avatar/00/15/2c/51/fdf460ba.jpg","comment_is_top":false,"comment_ctime":1553054306,"is_pvip":false,"replies":[{"id":"28773","content":"ğŸ‘è°¢è°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":78013,"uid":"1001282","ip_address":"","utype":1,"ctime":1553319201,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"117517171298","product_id":100020901,"comment_content":"æ—©äº›æ—¶é—´æ•´ç†è¿‡çš„ä¸€ç¯‡æ–‡ç« ï¼Œå’Œè¿™ä¸ªä¸»é¢˜å¾ˆmatchï¼Œåˆ†äº«åœ¨è¿™é‡Œ^_^ã€‚https:&#47;&#47;leezhenghui.github.io&#47;linux&#47;2019&#47;03&#47;05&#47;exploring-usdt-on-linux.html","like_count":28,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443935,"discussion_content":"ğŸ‘è°¢è°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553319201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78147,"user_name":"Huayra","can_delete":false,"product_type":"c1","uid":1031596,"ip_address":"","ucode":"5F8F6EF2783C1B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bd/ac/c9154dfe.jpg","comment_is_top":false,"comment_ctime":1553078772,"is_pvip":false,"replies":[{"id":"28767","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":78147,"uid":"1001282","ip_address":"","utype":1,"ctime":1553318582,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":2,"race_medal":0,"score":"78862490100","product_id":100020901,"comment_content":"å°†æ€§èƒ½ä¼˜åŒ–å¤§å¸ˆBrendan Greggçš„blogé˜…è¯»ä¸€éï¼Œå°±èƒ½å¤Ÿæ›´æ·±åˆ»åœ°ç†è§£è¿™ä¸€ç« ã€‚æ®è¯´ï¼ŒOpenRestyçš„ä½œè€…å¼ äº¦æ˜¥ä¹Ÿé˜…è¯»è¿‡Brendan Greggçš„æ‰€æœ‰åšå®¢ï¼Œä»–ç°åœ¨æ›´è¿›ä¸€æ­¥åœ°å¼€å‘äº†ä¸€ä¸ªå°†é«˜çº§ç¼–ç¨‹è¯­è¨€ç¼–è¯‘æˆåŠ¨æ€è¿½è¸ªè„šæœ¬çš„å·¥å…·","like_count":19,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443984,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553318582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300059,"discussion_content":"éƒ½æ˜¯å‰å®³äººç‰©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597924176,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77888,"user_name":"æ¾èŠ±çš®è›‹me","can_delete":false,"product_type":"c1","uid":1000054,"ip_address":"","ucode":"B0846CEEF6B0D1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/42/76/256bbd43.jpg","comment_is_top":false,"comment_ctime":1553013646,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"31617784718","product_id":100020901,"comment_content":"è¿™ç¯‡å®Œå…¨å¬ä¸æ‡‚","like_count":7,"discussions":[{"author":{"id":2031689,"avatar":"","nickname":"ä¸å‡¡","note":"","ucode":"28A3EC4C309C56","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381825,"discussion_content":"ä½ ä¸æ˜¯ä¸€ä¸ªäºº","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1625226955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336475,"avatar":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","nickname":"J.Smile","note":"","ucode":"C4D98DFDBF7584","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300061,"discussion_content":"èƒ½çœ‹åˆ°ç°åœ¨åº”è¯¥è¯´å¤§éƒ¨åˆ†éƒ½å¯ä»¥æ‡‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597924211,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78935,"user_name":"ä½³","can_delete":false,"product_type":"c1","uid":1334190,"ip_address":"","ucode":"482C90C3DC17DB","user_header":"https://static001.geekbang.org/account/avatar/00/14/5b/ae/3d639ea4.jpg","comment_is_top":false,"comment_ctime":1553303472,"is_pvip":false,"replies":[{"id":"28778","content":"ğŸ‘è°¢è°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":78935,"uid":"1001282","ip_address":"","utype":1,"ctime":1553319653,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"14438205360","product_id":100020901,"comment_content":"åœ¨å’ŒåŒäº‹è®¨è®ºnodejsä½¿ç”¨ä»thriftè½¬åŒ–åˆ°grpcæ—¶å€™ä¼šæ€§èƒ½ä¸‹é™é—®é¢˜å°±ç”¨è€å¸ˆä»‹ç»<br><br>strace -T -ttt -p pid<br><br>æ‰¾åˆ°æ ¹æºã€‚<br><br>grpc -nodeç‰ˆæœ¬å‘é€åˆ†ä¸¤æ¬¡writevç³»ç»Ÿè°ƒç”¨ï¼Œç¬¬ä¸€æ¬¡å‘é€ grpcè·¯å¾„ï¼Œç¬¬äºŒæ¬¡å‘é€å‚æ•°ã€‚æ¯”thriftåè®®ä¸€æ¬¡æ•ˆç‡ä¸€äº›ã€‚<br><br>å†å‘ç°nodeå¹¶å‘æ¬¡æ•°å¤šï¼Œå›è°ƒç®—æ—¶é—´å¾€å¾€æ˜¯å¤šä¸ªè°ƒç”¨æ‰€èŠ±çš„æ—¶é—´ã€‚è¿™äº›æ•ˆç‡éƒ½ç”¨straceçœ‹åˆ°ï¼Œåœ¨å‰é¢æ—¶é—´","like_count":4,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444294,"discussion_content":"ğŸ‘è°¢è°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553319653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77933,"user_name":"Linuxer","can_delete":false,"product_type":"c1","uid":1153978,"ip_address":"","ucode":"272D9D8089C3D6","user_header":"https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg","comment_is_top":false,"comment_ctime":1553043537,"is_pvip":false,"replies":[{"id":"28774","content":"å…ˆè¦ç”¨å…¶ä»–å·¥å…·å®šä½å‡ºå¤§æ¦‚çš„ä½ç½®ï¼Œæ¯”å¦‚ç”¨perfæˆ–è€…bccç­‰ç­‰ã€‚æœ‰äº†å‡½æ•°ä¹‹åï¼Œå†å›æ¥è·Ÿè¸ªå‡½æ•°çš„å†…éƒ¨ã€‚","user_name":"ä½œè€…å›å¤","comment_id":77933,"uid":"1001282","ip_address":"","utype":1,"ctime":1553319283,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"14437945425","product_id":100020901,"comment_content":"è€å¸ˆï¼Œç¢°åˆ°ä¸€ä¸ªé—®é¢˜æ€ä¹ˆé€‰æ‹©tracepointå’Œtracefunctionå‘¢ï¼Ÿç„¶åæ€ä¹ˆç»“åˆè¾“å‡ºåˆ†æé—®é¢˜å‘¢ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443902,"discussion_content":"å…ˆè¦ç”¨å…¶ä»–å·¥å…·å®šä½å‡ºå¤§æ¦‚çš„ä½ç½®ï¼Œæ¯”å¦‚ç”¨perfæˆ–è€…bccç­‰ç­‰ã€‚æœ‰äº†å‡½æ•°ä¹‹åï¼Œå†å›æ¥è·Ÿè¸ªå‡½æ•°çš„å†…éƒ¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553319283,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78849,"user_name":"é’çŸ³","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1553257051,"is_pvip":false,"replies":[{"id":"28740","content":"è°¢è°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":78849,"uid":"1001282","ip_address":"","utype":1,"ctime":1553315997,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"10143191643","product_id":100020901,"comment_content":"#echo function_graph &gt; current_trace<br>-bash: current_trace: Permission denied<br><br>æŠ¥ä¸Šé¢é”™è¯¯çš„åŒå­¦ï¼Œå¯ä»¥å°è¯•ä¸‹é¢çš„å‘½ä»¤ï¼Œç¯å¢ƒæ˜¯CentOS 7.6<br>$ echo function_graph &gt; current_tracer<br>$ echo funcgraph-proc &gt; trace_options","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444255,"discussion_content":"è°¢è°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553315997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":155306,"user_name":"è¾‰æ™–","can_delete":false,"product_type":"c1","uid":1574062,"ip_address":"","ucode":"E5EC033EE4952B","user_header":"https://static001.geekbang.org/account/avatar/00/18/04/ae/0118c132.jpg","comment_is_top":false,"comment_ctime":1574676702,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5869643998","product_id":100020901,"comment_content":"æ‰§è¡Œè¿™å¥æœºå™¨å¡æ­»ï¼Œåªèƒ½å¼ºåˆ¶é‡å¯ï¼š<br>echo funcgraph-proc &gt; trace_options<br>æ‰§è¡Œè¿™å¥æŠ¥é”™ï¼š<br># trace-cmd record -p function_graph -g do_sys_open -O funcgraph-proc ls<br>  plugin &#39;function_graph&#39;<br>trace-cmd: Permission denied<br>  can&#39;t create recorder<br>trace-cmd: Permission denied<br>  can&#39;t create recorder<br>trace-cmd: Permission denied<br>  can&#39;t create recorder<br>trace-cmd: Permission denied<br>  can&#39;t create recorder<br>available_events\t    events\t\t      options\t\t   set_ftrace_notrace  trace_clock\t    tracing_thresh<br>available_filter_functions  free_buffer\t\t      per_cpu\t\t   set_ftrace_pid      trace_marker\t    uprobe_events<br>available_tracers\t    function_profile_enabled  printk_formats\t   set_graph_function  trace_options\t    uprobe_profile<br>buffer_size_kb\t\t    hwlat_detector\t      README\t\t   snapshot\t       trace_pipe<br>buffer_total_size_kb\t    instances\t\t      saved_cmdlines\t   stack_max_size      trace_stat<br>current_tracer\t\t    kprobe_events\t      saved_cmdlines_size  stack_trace\t       tracing_cpumask<br>dyn_ftrace_total_info\t    kprobe_profile\t      set_event\t\t   stack_trace_filter  tracing_max_latency<br>enabled_functions\t    max_graph_depth\t      set_ftrace_filter    trace\t       tracing_on<br>trace-cmd: Permission denied<br>  Error creating output file","like_count":1,"discussions":[{"author":{"id":1443017,"avatar":"https://static001.geekbang.org/account/avatar/00/16/04/c9/ef585c96.jpg","nickname":"ç¢Œèˆ°è™¾","note":"","ucode":"B947C229E767D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387305,"discussion_content":"ä¸è¦å†/sys/kernel/debug/tracingç›®å½•æ‰§è¡Œtrace-cmd record -p function_graph -g do_sys_open -O funcgraph-proc ls ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1628094854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":88145,"user_name":"z.l","can_delete":false,"product_type":"c1","uid":1181055,"ip_address":"","ucode":"805CC5784D3F76","user_header":"https://static001.geekbang.org/account/avatar/00/12/05/7f/d35ab9a1.jpg","comment_is_top":false,"comment_ctime":1555858285,"is_pvip":false,"replies":[{"id":"31958","content":"ä»Šå¤©ä»‹ç»çš„å·¥å…·éƒ½æ˜¯ç³»ç»Ÿçº§å·¥å…·ï¼Œå¯ä»¥ç”¨åœ¨ä»»ä½•åº”ç”¨ï¼›è€Œbtraceæ˜¯åº”ç”¨çº§çš„ï¼Œåªèƒ½ç”¨åœ¨Javaåº”ç”¨ä¸Šã€‚","user_name":"ä½œè€…å›å¤","comment_id":88145,"uid":"1001282","ip_address":"","utype":1,"ctime":1556113991,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5850825581","product_id":100020901,"comment_content":"è¯·æ•™ä¸‹javaé‡Œå¸¸ç”¨çš„btraceå’Œä»Šå¤©è®²çš„å‡ ä¸ªå·¥å…·æ˜¯ä»€ä¹ˆå…³ç³»å•Š","like_count":2,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447746,"discussion_content":"ä»Šå¤©ä»‹ç»çš„å·¥å…·éƒ½æ˜¯ç³»ç»Ÿçº§å·¥å…·ï¼Œå¯ä»¥ç”¨åœ¨ä»»ä½•åº”ç”¨ï¼›è€Œbtraceæ˜¯åº”ç”¨çº§çš„ï¼Œåªèƒ½ç”¨åœ¨Javaåº”ç”¨ä¸Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1556113991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78708,"user_name":"xfan","can_delete":false,"product_type":"c1","uid":1315147,"ip_address":"","ucode":"48ED8D498D7F56","user_header":"https://static001.geekbang.org/account/avatar/00/14/11/4b/fa64f061.jpg","comment_is_top":false,"comment_ctime":1553221597,"is_pvip":false,"replies":[{"id":"28747","content":"è¿™ä¸ªé—®é¢˜æˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡è§åˆ°ï¼Œæ£€æŸ¥ä¸‹ç³»ç»Ÿæ—¥å¿—é‡Œé¢æœ‰æ²¡æœ‰é”™è¯¯ï¼Ÿ","user_name":"ä½œè€…å›å¤","comment_id":78708,"uid":"1001282","ip_address":"","utype":1,"ctime":1553316506,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5848188893","product_id":100020901,"comment_content":"æˆ‘çš„æœºå™¨ä¸€è¿è¡Œ<br>echo function_graph &gt; current_traceæˆ–trace-cmdçš„å‘½ä»¤å°±å¡æ­»ï¼Œtty1ä¹Ÿè¾“å…¥ä¸äº†ï¼Œæˆ‘ç°åœ¨æ˜¯ubuntu18.04 åŒå¤„ç†å™¨ 1Gå†…å­˜ <br>","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444198,"discussion_content":"è¿™ä¸ªé—®é¢˜æˆ‘ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡è§åˆ°ï¼Œæ£€æŸ¥ä¸‹ç³»ç»Ÿæ—¥å¿—é‡Œé¢æœ‰æ²¡æœ‰é”™è¯¯ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553316506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77930,"user_name":"å…¨å¤§ç¥å•Š","can_delete":false,"product_type":"c1","uid":1318564,"ip_address":"","ucode":"934EC7D0B0FF24","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJLm7IbU8V19ENfAnAaeibr4X5zQDw2yI8pHy1xtRgVC7S0YjdqI6jKlcQ0ueicuCaIkebSTNelRibsA/132","comment_is_top":false,"comment_ctime":1553043097,"is_pvip":false,"replies":[{"id":"28775","content":"è°¢è°¢æ”¯æŒğŸ˜Š","user_name":"ä½œè€…å›å¤","comment_id":77930,"uid":"1001282","ip_address":"","utype":1,"ctime":1553319299,"user_name_real":"å€ªæœ‹é£"}],"discussion_count":1,"race_medal":0,"score":"5848010393","product_id":100020901,"comment_content":"è¿™ä¸ªä¸“æ å¾ˆä¸é”™ï¼Œå­¦äº†å¾ˆå¤šå¹²è´§ï¼Œè€å¸ˆæŒºè´Ÿè´£ä»»çš„ï¼Œå¸Œæœ›è€å¸ˆä»¥åå¤šå¤šå¼€ç‚¹ä¸“æ ï¼Œåˆ†äº«æ–°çŸ¥è¯†ï¼Œå¼€äº†è®°å¾—é€šçŸ¥ğŸ˜™","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443901,"discussion_content":"è°¢è°¢æ”¯æŒğŸ˜Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553319299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77911,"user_name":"ninuxer","can_delete":false,"product_type":"c1","uid":1243135,"ip_address":"","ucode":"5394ADAF2667D6","user_header":"https://wx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKQMM4m7NHuicr55aRiblTSEWIYe0QqbpyHweaoAbG7j2v7UUElqqeP3Ihrm3UfDPDRb1Hv8LvPwXqA/132","comment_is_top":false,"comment_ctime":1553041201,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5848008497","product_id":100020901,"comment_content":"æ‰“å¡day53<br>ä¸ªäººè®¤ä¸ºperfçš„åŠŸèƒ½å…¨é¢ï¼Œå¯ç”¨äºç³»ç»Ÿå’Œå†…æ ¸çš„åˆ†æï¼Œftraceç”¨äºå†…æ ¸çº§åˆ«çš„åˆ†æï½","like_count":1},{"had_liked":false,"id":353016,"user_name":"janey","can_delete":false,"product_type":"c1","uid":1619748,"ip_address":"é™•è¥¿","ucode":"B2160B363F23EB","user_header":"https://static001.geekbang.org/account/avatar/00/18/b7/24/17f6c240.jpg","comment_is_top":false,"comment_ctime":1659080149,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1659080149","product_id":100020901,"comment_content":"Uprobeã€kprobeã€tracepointã€USDTè¿™4ç§æ¢é’ˆæœ‰ä¸¤ç§å½’ç±»æ–¹æ³•ï¼š<br>ä¸€æ˜¯æŒ‰ç…§åŠ¨é™åˆ†ï¼Œé™æ€è·Ÿè¸ªæœ‰tracepointå’ŒUSDTï¼›åŠ¨æ€è·Ÿè¸ªæœ‰kprobeå’ŒUprobeã€‚<br>äºŒæ˜¯æŒ‰ç…§ç”¨æˆ·æ€å†…æ ¸æ€åˆ†ï¼Œå†…æ ¸æ€æœ‰kprobeã€tracepointï¼›ç”¨æˆ·æ€æœ‰USDTå’ŒUprobeã€‚<br>è¿™æ ·ç†è§£å¯¹å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":308766,"user_name":"ding","can_delete":false,"product_type":"c1","uid":1014401,"ip_address":"","ucode":"54AF950B3CA740","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/81/69874318.jpg","comment_is_top":false,"comment_ctime":1629790532,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"1629790532","product_id":100020901,"comment_content":"trace-cmdæŠ¥æ²¡æœ‰æƒé™<br><br>root@jamesdvm:&#47;sys&#47;kernel&#47;debug&#47;tracing# trace-cmd record -p function_graph -g do_sys_open -O funcgraph-proc ls<br>  plugin &#39;function_graph&#39;<br>trace-cmd: Permission denied<br>  can&#39;t create recorder<br>trace-cmd: Permission denied<br>  can&#39;t create recorder<br>available_events            buffer_total_size_kb   events                    instances        options         saved_cmdlines       set_event_pid       set_graph_function  stack_trace         trace_marker      trace_stat           tracing_thresh<br>available_filter_functions  current_tracer         free_buffer               kprobe_events    per_cpu         saved_cmdlines_size  set_ftrace_filter   set_graph_notrace   stack_trace_filter  trace_marker_raw  tracing_cpumask      uprobe_events<br>available_tracers           dyn_ftrace_total_info  function_profile_enabled  kprobe_profile   printk_formats  saved_tgids          set_ftrace_notrace  snapshot            trace               trace_options     tracing_max_latency  uprobe_profile<br>buffer_size_kb              enabled_functions      hwlat_detector            max_graph_depth  README          set_event            set_ftrace_pid      stack_max_size      trace_clock         trace_pipe        tracing_on<br>trace-cmd: Permission denied<br>  Error creating output file","like_count":0,"discussions":[{"author":{"id":1970516,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLK4NPyaFDl4rzrd4A9z42tQDibFLdCicbrAdyUa5P2B5u8UCUBenpHX7VgUCibvHvhpza4icMBKVnhmA/132","nickname":"å­¦æ— æ­¢å¢ƒ","note":"","ucode":"2C28E8E54DAB4E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":536783,"discussion_content":"è·¯å¾„é—®é¢˜ï¼Œä½ é€€å‡ºè¿™ä¸ªè·¯å¾„ åˆ°æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼Œå°±æ²¡æƒé™é—®é¢˜äº† ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1638867166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1333523,"avatar":"https://static001.geekbang.org/account/avatar/00/14/59/13/ff6f3ed5.jpg","nickname":"ç‹ç« æ¶›","note":"","ucode":"6EC55EC116A58D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1970516,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLK4NPyaFDl4rzrd4A9z42tQDibFLdCicbrAdyUa5P2B5u8UCUBenpHX7VgUCibvHvhpza4icMBKVnhmA/132","nickname":"å­¦æ— æ­¢å¢ƒ","note":"","ucode":"2C28E8E54DAB4E","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":552222,"discussion_content":"æˆ‘ä¹Ÿé‡åˆ°äº†ï¼Œå’Œä½ ä¸€æ ·","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645353573,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":536783,"ip_address":""},"score":552222,"extra":""}]},{"author":{"id":2058258,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/68/12/031a05c3.jpg","nickname":"Aå…å¸…å«å“¥","note":"","ucode":"76D2522E602AEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":403299,"discussion_content":"ä½ ä¸‹è½½çš„tracecmdæ˜¯ä¸æ˜¯å’Œå†…æ ¸ç‰ˆæœ¬ä¸åŒ¹é…ï¼Œå¯èƒ½ä½ å‡çº§è¿‡å†…æ ¸ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634046230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281155,"user_name":"crystal","can_delete":false,"product_type":"c1","uid":2364604,"ip_address":"","ucode":"C91479DF393D06","user_header":"https://static001.geekbang.org/account/avatar/00/24/14/bc/74bdef48.jpg","comment_is_top":false,"comment_ctime":1614601200,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614601200","product_id":100020901,"comment_content":"è€å¸ˆï¼Œéº»çƒ¦é—®ä¸‹ä½ å“¦ï¼Œå†è¿™èŠ‚è¯¾ç¨‹ä¸­æˆ‘æ‰§è¡Œtrace-cmd report ç•Œé¢ä¸ºä»€ä¹ˆæ²¡æœ‰ä»»ä½•è¾“å‡ºå‘¢ï¼Ÿæ²¡æœ‰æŠ¥é”™ä¹Ÿæ²¡æœ‰è¾“å‡ºå‘¢","like_count":0},{"had_liked":false,"id":267675,"user_name":"æ˜“æ°´","can_delete":false,"product_type":"c1","uid":2260684,"ip_address":"","ucode":"D501B826680D4A","user_header":"https://static001.geekbang.org/account/avatar/00/22/7e/cc/bab7c820.jpg","comment_is_top":false,"comment_ctime":1607868815,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1607868815","product_id":100020901,"comment_content":"æˆ‘çš„ç”¨çš„ç³»ç»Ÿå†…æ ¸è¾ƒæ–°,  echo do_sys_open &gt; set_graph_function çœ‹ä¸åˆ°ç»“æœ,æ¢æˆ<br>do_sys_openat2 å°±å¯ä»¥äº†,strace lsçœ‹äº†ä¸‹ æ–°kerneléƒ½ç”¨ openat æ‰“å¼€, è€kernelä½¿ç”¨openæ‰“å¼€","like_count":1},{"had_liked":false,"id":242419,"user_name":"Tom","can_delete":false,"product_type":"c1","uid":2002345,"ip_address":"","ucode":"BC0C848CE40A7A","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep92Vogxvtnl4UsKiaj5LIHZo5dL0IdpgysKWFGJp1PeZiaUDkKJUicakXOFkLvKPzZ6BYClKHromSzA/132","comment_is_top":false,"comment_ctime":1597717803,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597717803","product_id":100020901,"comment_content":"æˆ‘ä¹Ÿæ‰“ä¸ªå¡ï¼Œç»™è€å¸ˆç‚¹ä¸ªèµï¼Œå¹²è´§å¤šå¤šï¼ï¼æœ‰äº›å†…å®¹ç¬¬ä¸€æ¬¡æ¥è§¦ï¼Œéœ€è¦å¤šå¬å‡ éã€‚","like_count":0},{"had_liked":false,"id":191741,"user_name":"201200986","can_delete":false,"product_type":"c1","uid":1900861,"ip_address":"","ucode":"6042C42D1C904E","user_header":"","comment_is_top":false,"comment_ctime":1584793662,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1584793662","product_id":100020901,"comment_content":"åŸºäºtraceçš„æ–¹æ³•æ˜¯ä¸æ˜¯ä¼šå¯¹ç¨‹åºæœ¬èº«çš„æ€§èƒ½é€ æˆå¾ˆå¤§å½±å“ï¼Ÿä¸é€‚åˆåœ¨çº¿åˆ†æå‘¢","like_count":0,"discussions":[{"author":{"id":1329532,"avatar":"https://static001.geekbang.org/account/avatar/00/14/49/7c/51088797.jpg","nickname":"toughGuy","note":"","ucode":"BF0445F4CBE9B3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552381,"discussion_content":"perfå’Œftraceå¯¹æ€§èƒ½æ¶ˆè€—å¾ˆå°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645440797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182288,"user_name":"Li. Mr","can_delete":false,"product_type":"c1","uid":1588871,"ip_address":"","ucode":"5F628D66A913FC","user_header":"https://static001.geekbang.org/account/avatar/00/18/3e/87/ff97c31e.jpg","comment_is_top":false,"comment_ctime":1582763507,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1582763507","product_id":100020901,"comment_content":"æ‚¨å¥½ï¼Œè¯·é—®æ‰“å¼€debugfså¯¹ç³»ç»Ÿæ€§èƒ½æœ‰å½±å“ä¹ˆï¼Ÿ","like_count":0},{"had_liked":false,"id":87343,"user_name":"å¦‚æœ","can_delete":false,"product_type":"c1","uid":1320638,"ip_address":"","ucode":"138A3EEEE50850","user_header":"","comment_is_top":false,"comment_ctime":1555572379,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555572379","product_id":100020901,"comment_content":"DAY50ï¼Œæ‰“å¡","like_count":0},{"had_liked":false,"id":85423,"user_name":"å¤§åç‹ç‹¸","can_delete":false,"product_type":"c1","uid":1325678,"ip_address":"","ucode":"5044F89A505C5B","user_header":"https://static001.geekbang.org/account/avatar/00/14/3a/6e/e39e90ca.jpg","comment_is_top":false,"comment_ctime":1555057839,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1555057839","product_id":100020901,"comment_content":"$ trace-cmd record -p function_graph -g do_sys_open -O funcgraph-proc ls  è¿™ä¸ªæ‰§è¡Œä¹‹åå°±å¼¹å‡ºä¸€ä¸ªæ¡†ï¼Œè¯´å®¿ä¸»æœºCPUå·´æ‹‰å·´æ‹‰ï¼Œå°±æŠŠæˆ‘æœºå™¨å¡æ­»äº†ã€‚ã€‚ã€‚åªèƒ½ç”¨ç½‘ç®¡é‡å¯å¤§æ³•ã€‚ã€‚ã€‚","like_count":0},{"had_liked":false,"id":79394,"user_name":"é‡‘æ³¢","can_delete":false,"product_type":"c1","uid":1315886,"ip_address":"","ucode":"A50860CA422EBB","user_header":"https://static001.geekbang.org/account/avatar/00/14/14/2e/400913b1.jpg","comment_is_top":false,"comment_ctime":1553474445,"is_pvip":false,"replies":[{"id":"29037","content":"åŠ¨æ€è¿½è¸ªï¼ˆæ¯”å¦‚bccæˆ–è€…systemtapï¼‰åº”è¯¥æ˜¯æœ€å¥½ç”¨çš„æ–¹æ³•äº†ã€‚å¦‚æœå‘é€äº†OOMï¼Œä»ç³»ç»Ÿæ—¥å¿—é‡Œé¢ä¹Ÿå¯ä»¥æ‰¾åˆ°çº¿ç´¢","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553525686,"ip_address":"","comment_id":79394,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553474445","product_id":100020901,"comment_content":"è¯·æ•™è€å¸ˆä¸ªé—®é¢˜ï¼Œé‡åˆ°ä¸€ä¸ªé—®é¢˜æ˜¯ï¼ŒåµŒå…¥å¼linuxç³»ç»Ÿä¸Šï¼Œå‡ ç§’é’Ÿä¹‹å†…æŸä¸ªè¿›åŸçªç„¶å¯¼è‡´OOMã€‚<br>      è¯·é—®æœ‰æ²¡æœ‰ä»€ä¹ˆå¥½çš„æ–¹æ³•è°ƒæŸ¥æˆ–è€…æ•æ‰è°çŸ­æ—¶é—´å ç”¨å¤§é‡å†…å­˜å—ï¼Ÿ è„šæœ¬å‡ ç§’æ£€æµ‹mapsè¯•è¿‡ï¼Œæ•æ‰ä¸åˆ°ã€‚å†…å­˜é’©å­ä¸€æ˜¯ä¸çº¿ç¨‹å®‰å…¨ï¼Œå†å°±æ˜¯åº”è¯¥ç”¨äº†tcmallocï¼Œåº”è¯¥ä¹Ÿä¸è¡Œã€‚ valgrindå¤ªé‡é‡çº§ï¼Œå¤§ç¨‹åºè·‘ä¸åŠ¨ã€‚å¤šè°¢","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444482,"discussion_content":"åŠ¨æ€è¿½è¸ªï¼ˆæ¯”å¦‚bccæˆ–è€…systemtapï¼‰åº”è¯¥æ˜¯æœ€å¥½ç”¨çš„æ–¹æ³•äº†ã€‚å¦‚æœå‘é€äº†OOMï¼Œä»ç³»ç»Ÿæ—¥å¿—é‡Œé¢ä¹Ÿå¯ä»¥æ‰¾åˆ°çº¿ç´¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553525686,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78465,"user_name":"arron","can_delete":false,"product_type":"c1","uid":1202253,"ip_address":"","ucode":"C7B04C66067637","user_header":"https://static001.geekbang.org/account/avatar/00/12/58/4d/fec92a8d.jpg","comment_is_top":false,"comment_ctime":1553154457,"is_pvip":false,"replies":[{"id":"28741","content":"è¯•è¯•ç•™è¨€ä¸­é’çŸ³çš„æ–¹æ³•å¯ä»¥å—","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553316095,"ip_address":"","comment_id":78465,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553154457","product_id":100020901,"comment_content":"æ‰§è¡Œç¬¬äºŒæ­¥æŠ¥é”™ï¼š<br>#echo function_graph &gt; current_trace<br>-bash: current_trace: Permission denied<br><br>ç”¨rootç”¨æˆ·æ“ä½œçš„ï¼Œè¿™æ˜¯ä¸ºä½•ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444104,"discussion_content":"è¯•è¯•ç•™è¨€ä¸­é’çŸ³çš„æ–¹æ³•å¯ä»¥å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553316095,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78452,"user_name":"arron","can_delete":false,"product_type":"c1","uid":1202253,"ip_address":"","ucode":"C7B04C66067637","user_header":"https://static001.geekbang.org/account/avatar/00/12/58/4d/fec92a8d.jpg","comment_is_top":false,"comment_ctime":1553151736,"is_pvip":false,"replies":[{"id":"28757","content":"è¯•è¯•ç•™è¨€ä¸­é’çŸ³çš„æ–¹æ³•å¯ä»¥å—","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553317782,"ip_address":"","comment_id":78452,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553151736","product_id":100020901,"comment_content":"æ‰§è¡Œç¬¬äºŒæ­¥æ˜¯æŠ¥é”™ï¼š<br>#echo function_graph &gt; current_trace<br>-bash: current_trace: Permission denied<br><br>rootç”¨æˆ·æ‰§è¡Œçš„ï¼Œä¸ºä½•æ²¡æƒé™ï¼Œä½•è§£ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444100,"discussion_content":"è¯•è¯•ç•™è¨€ä¸­é’çŸ³çš„æ–¹æ³•å¯ä»¥å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553317782,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78186,"user_name":"Chn.K","can_delete":false,"product_type":"c1","uid":1285191,"ip_address":"","ucode":"F82E8CE20C16FA","user_header":"https://static001.geekbang.org/account/avatar/00/13/9c/47/50cf2cab.jpg","comment_is_top":false,"comment_ctime":1553088481,"is_pvip":false,"replies":[{"id":"28742","content":"coredumpæä¾›äº†é—®é¢˜çš„ç°åœºï¼Œä»coredumpåˆ†æï¼ˆæ¯”å¦‚ä½¿ç”¨GDBï¼‰åº”è¯¥å°±æ˜¯æœ€å¥½çš„æ–¹æ³•äº†ï¼Œ","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553316175,"ip_address":"","comment_id":78186,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553088481","product_id":100020901,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œå¯¹äºè¸©å†…å­˜å¯¼è‡´çš„coredumpé—®é¢˜ï¼ˆä»coreæ–‡ä»¶å¤§è‡´èƒ½çœ‹å‡ºæ¥å†…å­˜å·²ç»ä¹±äº†ï¼Œä½†æ˜¯çœ‹ä¸å‡ºæ¥æ˜¯å“ªé‡ŒæŠŠå†…å­˜æä¹±äº†ï¼‰ï¼Œæœ‰æ²¡æœ‰å¥½çš„å®šä½æ–¹æ³•ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443997,"discussion_content":"coredumpæä¾›äº†é—®é¢˜çš„ç°åœºï¼Œä»coredumpåˆ†æï¼ˆæ¯”å¦‚ä½¿ç”¨GDBï¼‰åº”è¯¥å°±æ˜¯æœ€å¥½çš„æ–¹æ³•äº†ï¼Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553316175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78180,"user_name":"Linuxer","can_delete":false,"product_type":"c1","uid":1153978,"ip_address":"","ucode":"272D9D8089C3D6","user_header":"https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg","comment_is_top":false,"comment_ctime":1553087023,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553087023","product_id":100020901,"comment_content":"æ¥¼ä¸Šè¿™ä½å¯ä»¥ç¿»è¯‘åˆ†äº«å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":78142,"user_name":"æ€€ç‰¹","can_delete":false,"product_type":"c1","uid":1072331,"ip_address":"","ucode":"3DACB205798ED3","user_header":"https://static001.geekbang.org/account/avatar/00/10/5c/cb/3ebdcc49.jpg","comment_is_top":false,"comment_ctime":1553077613,"is_pvip":true,"replies":[{"id":"28769","content":"è¿™é‡Œæœ‰äº›å·¥å…·ä¹Ÿé€‚ç”¨äºç”¨æˆ·æ€åˆ†æçš„","user_name":"ä½œè€…å›å¤","user_name_real":"å€ªæœ‹é£","uid":"1001282","ctime":1553318709,"ip_address":"","comment_id":78142,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1553077613","product_id":100020901,"comment_content":"è¿™ä¸€èŠ‚æœ‰äº›è·Ÿä¸ä¸Šäº†ã€‚è¶Šæ¥è¶Šæ·±å…¥å†…æ ¸äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1001282,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/42/5b55bd1a.jpg","nickname":"å€ªæœ‹é£","note":"","ucode":"F0FAC195CDE7AC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443982,"discussion_content":"è¿™é‡Œæœ‰äº›å·¥å…·ä¹Ÿé€‚ç”¨äºç”¨æˆ·æ€åˆ†æçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553318709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":77912,"user_name":"è¥¿çº¢æŸ¿ç‰›è…©","can_delete":false,"product_type":"c1","uid":1152898,"ip_address":"","ucode":"DEC94B4A647A92","user_header":"https://static001.geekbang.org/account/avatar/00/11/97/82/394c88ad.jpg","comment_is_top":false,"comment_ctime":1553041229,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1553041229","product_id":100020901,"comment_content":"æ–°æŠ€èƒ½Getâœ…","like_count":0}]}