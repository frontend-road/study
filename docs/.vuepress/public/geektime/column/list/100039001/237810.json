{"id":237810,"title":"85 | å¼€æºå®æˆ˜å››ï¼ˆä¸­ï¼‰ï¼šå‰–æSpringæ¡†æ¶ä¸­ç”¨æ¥æ”¯æŒæ‰©å±•çš„ä¸¤ç§è®¾è®¡æ¨¡å¼","content":"<p>ä¸Šä¸€èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†Springæ¡†æ¶èƒŒåè•´è—çš„ä¸€äº›ç»å…¸è®¾è®¡æ€æƒ³ï¼Œæ¯”å¦‚çº¦å®šä¼˜äºé…ç½®ã€ä½ä¾µå…¥æ¾è€¦åˆã€æ¨¡å—åŒ–è½»é‡çº§ç­‰ç­‰ã€‚æˆ‘ä»¬å¯ä»¥å°†è¿™äº›è®¾è®¡æ€æƒ³å€Ÿé‰´åˆ°å…¶ä»–æ¡†æ¶å¼€å‘ä¸­ï¼Œåœ¨å¤§çš„è®¾è®¡å±‚é¢æé«˜æ¡†æ¶çš„ä»£ç è´¨é‡ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨ä¸“æ ä¸­è®²è§£è¿™éƒ¨åˆ†å†…å®¹çš„åŸå› ã€‚</p><p>é™¤äº†ä¸Šä¸€èŠ‚è¯¾ä¸­è®²åˆ°çš„è®¾è®¡æ€æƒ³ï¼Œå®é™…ä¸Šï¼Œå¯æ‰©å±•ä¹Ÿæ˜¯å¤§éƒ¨åˆ†æ¡†æ¶åº”è¯¥å…·å¤‡çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ã€‚æ‰€è°“çš„æ¡†æ¶å¯æ‰©å±•ï¼Œæˆ‘ä»¬ä¹‹å‰ä¹Ÿæåˆ°è¿‡ï¼Œæ„æ€å°±æ˜¯ï¼Œæ¡†æ¶ä½¿ç”¨è€…åœ¨ä¸ä¿®æ”¹æ¡†æ¶æºç çš„æƒ…å†µä¸‹ï¼ŒåŸºäºæ‰©å±•ç‚¹å®šåˆ¶æ‰©å±•æ–°çš„åŠŸèƒ½ã€‚</p><p>å‰é¢åœ¨ç†è®ºéƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¹Ÿè®²åˆ°ï¼Œå¸¸ç”¨æ¥å®ç°æ‰©å±•ç‰¹æ€§çš„è®¾è®¡æ¨¡å¼æœ‰ï¼šè§‚å¯Ÿè€…æ¨¡å¼ã€æ¨¡æ¿æ¨¡å¼ã€èŒè´£é“¾æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ç­‰ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å†å‰–æSpringæ¡†æ¶ä¸ºäº†æ”¯æŒå¯æ‰©å±•ç‰¹æ€§ç”¨çš„2ç§è®¾è®¡æ¨¡å¼ï¼šè§‚å¯Ÿè€…æ¨¡å¼å’Œæ¨¡æ¿æ¨¡å¼ã€‚</p><p>è¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬æ­£å¼å¼€å§‹ä»Šå¤©çš„å­¦ä¹ å§ï¼</p><h2>è§‚å¯Ÿè€…æ¨¡å¼åœ¨Springä¸­çš„åº”ç”¨</h2><p>åœ¨å‰é¢æˆ‘ä»¬è®²åˆ°ï¼ŒJavaã€Google Guavaéƒ½æä¾›äº†è§‚å¯Ÿè€…æ¨¡å¼çš„å®ç°æ¡†æ¶ã€‚Javaæä¾›çš„æ¡†æ¶æ¯”è¾ƒç®€å•ï¼ŒåªåŒ…å«java.util.Observableå’Œjava.util.Observerä¸¤ä¸ªç±»ã€‚Google Guavaæä¾›çš„æ¡†æ¶åŠŸèƒ½æ¯”è¾ƒå®Œå–„å’Œå¼ºå¤§ï¼šé€šè¿‡EventBusäº‹ä»¶æ€»çº¿æ¥å®ç°è§‚å¯Ÿè€…æ¨¡å¼ã€‚å®é™…ä¸Šï¼ŒSpringä¹Ÿæä¾›äº†è§‚å¯Ÿè€…æ¨¡å¼çš„å®ç°æ¡†æ¶ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°±å†æ¥è®²ä¸€è®²å®ƒã€‚</p><!-- [[[read_end]]] --><p>Springä¸­å®ç°çš„è§‚å¯Ÿè€…æ¨¡å¼åŒ…å«ä¸‰éƒ¨åˆ†ï¼šEventäº‹ä»¶ï¼ˆç›¸å½“äºæ¶ˆæ¯ï¼‰ã€Listenerç›‘å¬è€…ï¼ˆç›¸å½“äºè§‚å¯Ÿè€…ï¼‰ã€Publisherå‘é€è€…ï¼ˆç›¸å½“äºè¢«è§‚å¯Ÿè€…ï¼‰ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥çœ‹ä¸‹ï¼ŒSpringæä¾›çš„è§‚å¯Ÿè€…æ¨¡å¼æ˜¯æ€ä¹ˆä½¿ç”¨çš„ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>// Eventäº‹ä»¶\npublic class DemoEvent extends ApplicationEvent {\n  private String message;\n\n  public DemoEvent(Object source, String message) {\n    super(source);\n  }\n\n  public String getMessage() {\n    return this.message;\n  }\n}\n\n// Listenerç›‘å¬è€…\n@Component\npublic class DemoListener implements ApplicationListener&lt;DemoEvent&gt; {\n  @Override\n  public void onApplicationEvent(DemoEvent demoEvent) {\n    String message = demoEvent.getMessage();\n    System.out.println(message);\n  }\n}\n\n// Publisherå‘é€è€…\n@Component\npublic class DemoPublisher {\n  @Autowired\n  private ApplicationContext applicationContext;\n\n  public void publishEvent(DemoEvent demoEvent) {\n    this.applicationContext.publishEvent(demoEvent);\n  }\n}\n</code></pre><p>ä»ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ¡†æ¶ä½¿ç”¨èµ·æ¥å¹¶ä¸å¤æ‚ï¼Œä¸»è¦åŒ…å«ä¸‰éƒ¨åˆ†å·¥ä½œï¼šå®šä¹‰ä¸€ä¸ªç»§æ‰¿ApplicationEventçš„äº‹ä»¶ï¼ˆDemoEventï¼‰ï¼›å®šä¹‰ä¸€ä¸ªå®ç°äº†ApplicationListenerçš„ç›‘å¬å™¨ï¼ˆDemoListenerï¼‰ï¼›å®šä¹‰ä¸€ä¸ªå‘é€è€…ï¼ˆDemoPublisherï¼‰ï¼Œå‘é€è€…è°ƒç”¨ApplicationContextæ¥å‘é€äº‹ä»¶æ¶ˆæ¯ã€‚</p><p>å…¶ä¸­ï¼ŒApplicationEventå’ŒApplicationListenerçš„ä»£ç å®ç°éƒ½éå¸¸ç®€å•ï¼Œå†…éƒ¨å¹¶ä¸åŒ…å«å¤ªå¤šå±æ€§å’Œæ–¹æ³•ã€‚å®é™…ä¸Šï¼Œå®ƒä»¬æœ€å¤§çš„ä½œç”¨æ˜¯åšç±»å‹æ ‡è¯†ä¹‹ç”¨ï¼ˆç»§æ‰¿è‡ªApplicationEventçš„ç±»æ˜¯äº‹ä»¶ï¼Œå®ç°ApplicationListenerçš„ç±»æ˜¯ç›‘å¬å™¨ï¼‰ã€‚</p><pre><code>public abstract class ApplicationEvent extends EventObject {\n  private static final long serialVersionUID = 7099057708183571937L;\n  private final long timestamp = System.currentTimeMillis();\n\n  public ApplicationEvent(Object source) {\n    super(source);\n  }\n\n  public final long getTimestamp() {\n    return this.timestamp;\n  }\n}\n\npublic class EventObject implements java.io.Serializable {\n    private static final long serialVersionUID = 5516075349620653480L;\n    protected transient Object  source;\n\n    public EventObject(Object source) {\n        if (source == null)\n            throw new IllegalArgumentException(&quot;null source&quot;);\n        this.source = source;\n    }\n\n    public Object getSource() {\n        return source;\n    }\n\n    public String toString() {\n        return getClass().getName() + &quot;[source=&quot; + source + &quot;]&quot;;\n    }\n}\n\npublic interface ApplicationListener&lt;E extends ApplicationEvent&gt; extends EventListener {\n  void onApplicationEvent(E var1);\n}\n</code></pre><p>åœ¨å‰é¢è®²åˆ°è§‚å¯Ÿè€…æ¨¡å¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬æåˆ°ï¼Œè§‚å¯Ÿè€…éœ€è¦äº‹å…ˆæ³¨å†Œåˆ°è¢«è§‚å¯Ÿè€…ï¼ˆJDKçš„å®ç°æ–¹å¼ï¼‰æˆ–è€…äº‹ä»¶æ€»çº¿ï¼ˆEventBusçš„å®ç°æ–¹å¼ï¼‰ä¸­ã€‚é‚£åœ¨Springçš„å®ç°ä¸­ï¼Œè§‚å¯Ÿè€…æ³¨å†Œåˆ°äº†å“ªé‡Œå‘¢ï¼Ÿåˆæ˜¯å¦‚ä½•æ³¨å†Œçš„å‘¢ï¼Ÿ</p><p>æˆ‘æƒ³ä½ åº”è¯¥çŒœåˆ°äº†ï¼Œæˆ‘ä»¬æŠŠè§‚å¯Ÿè€…æ³¨å†Œåˆ°äº†ApplicationContextå¯¹è±¡ä¸­ã€‚è¿™é‡Œçš„ApplicationContextå°±ç›¸å½“äºGoogle EventBusæ¡†æ¶ä¸­çš„â€œäº‹ä»¶æ€»çº¿â€ã€‚ä¸è¿‡ï¼Œç¨å¾®æé†’ä¸€ä¸‹ï¼ŒApplicationContextè¿™ä¸ªç±»å¹¶ä¸åªæ˜¯ä¸ºè§‚å¯Ÿè€…æ¨¡å¼æœåŠ¡çš„ã€‚å®ƒåº•å±‚ä¾èµ–BeanFactoryï¼ˆIOCçš„ä¸»è¦å®ç°ç±»ï¼‰ï¼Œæä¾›åº”ç”¨å¯åŠ¨ã€è¿è¡Œæ—¶çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæ˜¯è®¿é—®è¿™äº›ä¿¡æ¯çš„æœ€é¡¶å±‚æ¥å£ã€‚</p><p>å®é™…ä¸Šï¼Œå…·ä½“åˆ°æºç æ¥è¯´ï¼ŒApplicationContextåªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…·ä½“çš„ä»£ç å®ç°åŒ…å«åœ¨å®ƒçš„å®ç°ç±»AbstractApplicationContextä¸­ã€‚æˆ‘æŠŠè·Ÿè§‚å¯Ÿè€…æ¨¡å¼ç›¸å…³çš„ä»£ç ï¼Œæ‘˜æŠ„åˆ°äº†ä¸‹é¢ã€‚ä½ åªéœ€è¦å…³æ³¨å®ƒæ˜¯å¦‚ä½•å‘é€äº‹ä»¶å’Œæ³¨å†Œç›‘å¬è€…å°±å¥½ï¼Œå…¶ä»–ç»†èŠ‚ä¸éœ€è¦ç»†ç©¶ã€‚</p><pre><code>public abstract class AbstractApplicationContext extends ... {\n  private final Set&lt;ApplicationListener&lt;?&gt;&gt; applicationListeners;\n  \n  public AbstractApplicationContext() {\n    this.applicationListeners = new LinkedHashSet();\n    //...\n  }\n  \n  public void publishEvent(ApplicationEvent event) {\n    this.publishEvent(event, (ResolvableType)null);\n  }\n\n  public void publishEvent(Object event) {\n    this.publishEvent(event, (ResolvableType)null);\n  }\n\n  protected void publishEvent(Object event, ResolvableType eventType) {\n    //...\n    Object applicationEvent;\n    if (event instanceof ApplicationEvent) {\n      applicationEvent = (ApplicationEvent)event;\n    } else {\n      applicationEvent = new PayloadApplicationEvent(this, event);\n      if (eventType == null) {\n        eventType = ((PayloadApplicationEvent)applicationEvent).getResolvableType();\n      }\n    }\n\n    if (this.earlyApplicationEvents != null) {\n      this.earlyApplicationEvents.add(applicationEvent);\n    } else {\n      this.getApplicationEventMulticaster().multicastEvent(\n            (ApplicationEvent)applicationEvent, eventType);\n    }\n\n    if (this.parent != null) {\n      if (this.parent instanceof AbstractApplicationContext) {\n        ((AbstractApplicationContext)this.parent).publishEvent(event, eventType);\n      } else {\n        this.parent.publishEvent(event);\n      }\n    }\n  }\n  \n  public void addApplicationListener(ApplicationListener&lt;?&gt; listener) {\n    Assert.notNull(listener, &quot;ApplicationListener must not be null&quot;);\n    if (this.applicationEventMulticaster != null) {\n    this.applicationEventMulticaster.addApplicationListener(listener);\n    } else {\n      this.applicationListeners.add(listener);\n    }  \n  }\n  \n  public Collection&lt;ApplicationListener&lt;?&gt;&gt; getApplicationListeners() {\n    return this.applicationListeners;\n  }\n  \n  protected void registerListeners() {\n    Iterator var1 = this.getApplicationListeners().iterator();\n\n    while(var1.hasNext()) {\n      ApplicationListener&lt;?&gt; listener = (ApplicationListener)var1.next();     this.getApplicationEventMulticaster().addApplicationListener(listener);\n    }\n\n    String[] listenerBeanNames = this.getBeanNamesForType(ApplicationListener.class, true, false);\n    String[] var7 = listenerBeanNames;\n    int var3 = listenerBeanNames.length;\n\n    for(int var4 = 0; var4 &lt; var3; ++var4) {\n      String listenerBeanName = var7[var4];\n      this.getApplicationEventMulticaster().addApplicationListenerBean(listenerBeanName);\n    }\n\n    Set&lt;ApplicationEvent&gt; earlyEventsToProcess = this.earlyApplicationEvents;\n    this.earlyApplicationEvents = null;\n    if (earlyEventsToProcess != null) {\n      Iterator var9 = earlyEventsToProcess.iterator();\n\n      while(var9.hasNext()) {\n        ApplicationEvent earlyEvent = (ApplicationEvent)var9.next();\n        this.getApplicationEventMulticaster().multicastEvent(earlyEvent);\n      }\n    }\n  }\n}\n</code></pre><p>ä»ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒçœŸæ­£çš„æ¶ˆæ¯å‘é€ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡ApplicationEventMulticasterè¿™ä¸ªç±»æ¥å®Œæˆçš„ã€‚è¿™ä¸ªç±»çš„æºç æˆ‘åªæ‘˜æŠ„äº†æœ€å…³é”®çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯multicastEvent()è¿™ä¸ªæ¶ˆæ¯å‘é€å‡½æ•°ã€‚ä¸è¿‡ï¼Œå®ƒçš„ä»£ç ä¹Ÿå¹¶ä¸å¤æ‚ï¼Œæˆ‘å°±ä¸å¤šè§£é‡Šäº†ã€‚è¿™é‡Œæˆ‘ç¨å¾®æç¤ºä¸€ä¸‹ï¼Œå®ƒé€šè¿‡çº¿ç¨‹æ± ï¼Œæ”¯æŒå¼‚æ­¥éé˜»å¡ã€åŒæ­¥é˜»å¡è¿™ä¸¤ç§ç±»å‹çš„è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p><pre><code>public void multicastEvent(ApplicationEvent event) {\n  this.multicastEvent(event, this.resolveDefaultEventType(event));\n}\n\npublic void multicastEvent(final ApplicationEvent event, ResolvableType eventType) {\n  ResolvableType type = eventType != null ? eventType : this.resolveDefaultEventType(event);\n  Iterator var4 = this.getApplicationListeners(event, type).iterator();\n\n  while(var4.hasNext()) {\n    final ApplicationListener&lt;?&gt; listener = (ApplicationListener)var4.next();\n    Executor executor = this.getTaskExecutor();\n    if (executor != null) {\n      executor.execute(new Runnable() {\n        public void run() {\n          SimpleApplicationEventMulticaster.this.invokeListener(listener, event);\n        }\n      });\n    } else {\n      this.invokeListener(listener, event);\n    }\n  }\n\n}\n</code></pre><p>å€ŸåŠ©Springæä¾›çš„è§‚å¯Ÿè€…æ¨¡å¼çš„éª¨æ¶ä»£ç ï¼Œå¦‚æœæˆ‘ä»¬è¦åœ¨Springä¸‹å®ç°æŸä¸ªäº‹ä»¶çš„å‘é€å’Œç›‘å¬ï¼Œåªéœ€è¦åšå¾ˆå°‘çš„å·¥ä½œï¼Œå®šä¹‰äº‹ä»¶ã€å®šä¹‰ç›‘å¬å™¨ã€å¾€ApplicationContextä¸­å‘é€äº‹ä»¶å°±å¯ä»¥äº†ï¼Œå‰©ä¸‹çš„å·¥ä½œéƒ½ç”±Springæ¡†æ¶æ¥å®Œæˆã€‚å®é™…ä¸Šï¼Œè¿™ä¹Ÿä½“ç°äº†Springæ¡†æ¶çš„æ‰©å±•æ€§ï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç çš„æƒ…å†µä¸‹ï¼Œæ‰©å±•æ–°çš„äº‹ä»¶å’Œç›‘å¬ã€‚</p><h2>æ¨¡æ¿æ¨¡å¼åœ¨Springä¸­çš„åº”ç”¨</h2><p>åˆšåˆšè®²çš„æ˜¯è§‚å¯Ÿè€…æ¨¡å¼åœ¨Springä¸­çš„åº”ç”¨ï¼Œç°åœ¨æˆ‘ä»¬å†è®²ä¸‹æ¨¡æ¿æ¨¡å¼ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹ä¸‹ä¸€ä¸‹ç»å¸¸åœ¨é¢è¯•ä¸­è¢«é—®åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼šè¯·ä½ è¯´ä¸‹Spring Beançš„åˆ›å»ºè¿‡ç¨‹åŒ…å«å“ªäº›ä¸»è¦çš„æ­¥éª¤ã€‚è¿™å…¶ä¸­å°±æ¶‰åŠæ¨¡æ¿æ¨¡å¼ã€‚å®ƒä¹Ÿä½“ç°äº†Springçš„æ‰©å±•æ€§ã€‚åˆ©ç”¨æ¨¡æ¿æ¨¡å¼ï¼ŒSpringèƒ½è®©ç”¨æˆ·å®šåˆ¶Beançš„åˆ›å»ºè¿‡ç¨‹ã€‚</p><p>Spring Beançš„åˆ›å»ºè¿‡ç¨‹ï¼Œå¯ä»¥å¤§è‡´åˆ†ä¸ºä¸¤å¤§æ­¥ï¼šå¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡çš„åˆå§‹åŒ–ã€‚</p><p>å¯¹è±¡çš„åˆ›å»ºæ˜¯é€šè¿‡åå°„æ¥åŠ¨æ€ç”Ÿæˆå¯¹è±¡ï¼Œè€Œä¸æ˜¯newæ–¹æ³•ã€‚ä¸ç®¡æ˜¯å“ªç§æ–¹å¼ï¼Œè¯´ç™½äº†ï¼Œæ€»å½’è¿˜æ˜¯è°ƒç”¨æ„é€ å‡½æ•°æ¥ç”Ÿæˆå¯¹è±¡ï¼Œæ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„ã€‚å¯¹è±¡çš„åˆå§‹åŒ–æœ‰ä¸¤ç§å®ç°æ–¹å¼ã€‚ä¸€ç§æ˜¯åœ¨ç±»ä¸­è‡ªå®šä¹‰ä¸€ä¸ªåˆå§‹åŒ–å‡½æ•°ï¼Œå¹¶ä¸”é€šè¿‡é…ç½®æ–‡ä»¶ï¼Œæ˜¾å¼åœ°å‘ŠçŸ¥Springï¼Œå“ªä¸ªå‡½æ•°æ˜¯åˆå§‹åŒ–å‡½æ•°ã€‚æˆ‘ä¸¾äº†ä¸€ä¸ªä¾‹å­è§£é‡Šä¸€ä¸‹ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡init-methodå±æ€§æ¥æŒ‡å®šåˆå§‹åŒ–å‡½æ•°ã€‚</p><pre><code>public class DemoClass {\n  //...\n  \n  public void initDemo() {\n    //...åˆå§‹åŒ–..\n  }\n}\n\n// é…ç½®ï¼šéœ€è¦é€šè¿‡init-methodæ˜¾å¼åœ°æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•\n&lt;bean id=&quot;demoBean&quot; class=&quot;com.xzg.cd.DemoClass&quot; init-method=&quot;initDemo&quot;&gt;&lt;/bean&gt;\n</code></pre><p>è¿™ç§åˆå§‹åŒ–æ–¹å¼æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œåˆå§‹åŒ–å‡½æ•°å¹¶ä¸å›ºå®šï¼Œç”±ç”¨æˆ·éšæ„å®šä¹‰ï¼Œè¿™å°±éœ€è¦Springé€šè¿‡åå°„ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è°ƒç”¨è¿™ä¸ªåˆå§‹åŒ–å‡½æ•°ã€‚è€Œåå°„åˆä¼šå½±å“ä»£ç æ‰§è¡Œçš„æ€§èƒ½ï¼Œé‚£æœ‰æ²¡æœ‰æ›¿ä»£æ–¹æ¡ˆå‘¢ï¼Ÿ</p><p>Springæä¾›äº†å¦å¤–ä¸€ä¸ªå®šä¹‰åˆå§‹åŒ–å‡½æ•°çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯è®©ç±»å®ç°Initializingbeanæ¥å£ã€‚è¿™ä¸ªæ¥å£åŒ…å«ä¸€ä¸ªå›ºå®šçš„åˆå§‹åŒ–å‡½æ•°å®šä¹‰ï¼ˆafterPropertiesSet()å‡½æ•°ï¼‰ã€‚Springåœ¨åˆå§‹åŒ–Beançš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡bean.afterPropertiesSet()çš„æ–¹å¼ï¼Œè°ƒç”¨Beanå¯¹è±¡ä¸Šçš„è¿™ä¸ªå‡½æ•°ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨åå°„æ¥è°ƒç”¨äº†ã€‚æˆ‘ä¸¾ä¸ªä¾‹å­è§£é‡Šä¸€ä¸‹ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code>public class DemoClass implements InitializingBean{\n  @Override\n  public void afterPropertiesSet() throws Exception {\n    //...åˆå§‹åŒ–...      \n  }\n}\n\n// é…ç½®ï¼šä¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•\n&lt;bean id=&quot;demoBean&quot; class=&quot;com.xzg.cd.DemoClass&quot;&gt;&lt;/bean&gt;\n</code></pre><p>å°½ç®¡è¿™ç§å®ç°æ–¹å¼ä¸ä¼šç”¨åˆ°åå°„ï¼Œæ‰§è¡Œæ•ˆç‡æé«˜äº†ï¼Œä½†ä¸šåŠ¡ä»£ç ï¼ˆDemoClassï¼‰è·Ÿæ¡†æ¶ä»£ç ï¼ˆInitializingBeanï¼‰è€¦åˆåœ¨äº†ä¸€èµ·ã€‚æ¡†æ¶ä»£ç ä¾µå…¥åˆ°äº†ä¸šåŠ¡ä»£ç ä¸­ï¼Œæ›¿æ¢æ¡†æ¶çš„æˆæœ¬å°±å˜é«˜äº†ã€‚æ‰€ä»¥ï¼Œæˆ‘å¹¶ä¸æ˜¯å¤ªæ¨èè¿™ç§å†™æ³•ã€‚</p><p>å®é™…ä¸Šï¼Œåœ¨Springå¯¹Beanæ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªè·Ÿåˆå§‹åŒ–ç›¸å¯¹åº”çš„è¿‡ç¨‹ï¼Œé‚£å°±æ˜¯Beançš„é”€æ¯è¿‡ç¨‹ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨Javaä¸­ï¼Œå¯¹è±¡çš„å›æ”¶æ˜¯é€šè¿‡JVMæ¥è‡ªåŠ¨å®Œæˆçš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å°†Beanæ­£å¼äº¤ç»™JVMåƒåœ¾å›æ”¶å‰ï¼Œæ‰§è¡Œä¸€äº›é”€æ¯æ“ä½œï¼ˆæ¯”å¦‚å…³é—­æ–‡ä»¶å¥æŸ„ç­‰ç­‰ï¼‰ã€‚</p><p>é”€æ¯è¿‡ç¨‹è·Ÿåˆå§‹åŒ–è¿‡ç¨‹éå¸¸ç›¸ä¼¼ï¼Œä¹Ÿæœ‰ä¸¤ç§å®ç°æ–¹å¼ã€‚ä¸€ç§æ˜¯é€šè¿‡é…ç½®destroy-methodæŒ‡å®šç±»ä¸­çš„é”€æ¯å‡½æ•°ï¼Œå¦ä¸€ç§æ˜¯è®©ç±»å®ç°DisposableBeanæ¥å£ã€‚å› ä¸ºdestroy-methodã€DisposableBeanè·Ÿinit-methodã€InitializingBeanéå¸¸ç›¸ä¼¼ï¼Œæ‰€ä»¥ï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬å°±ä¸è¯¦ç»†è®²è§£äº†ï¼Œä½ å¯ä»¥è‡ªè¡Œç ”ç©¶ä¸‹ã€‚</p><p>å®é™…ä¸Šï¼ŒSpringé’ˆå¯¹å¯¹è±¡çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè¿˜åšäº†è¿›ä¸€æ­¥çš„ç»†åŒ–ï¼Œå°†å®ƒæ‹†åˆ†æˆäº†ä¸‰ä¸ªå°æ­¥éª¤ï¼šåˆå§‹åŒ–å‰ç½®æ“ä½œã€åˆå§‹åŒ–ã€åˆå§‹åŒ–åç½®æ“ä½œã€‚å…¶ä¸­ï¼Œä¸­é—´çš„åˆå§‹åŒ–æ“ä½œå°±æ˜¯æˆ‘ä»¬åˆšåˆšè®²çš„é‚£éƒ¨åˆ†ï¼Œåˆå§‹åŒ–çš„å‰ç½®å’Œåç½®æ“ä½œï¼Œå®šä¹‰åœ¨æ¥å£BeanPostProcessorä¸­ã€‚BeanPostProcessorçš„æ¥å£å®šä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>public interface BeanPostProcessor {\n  Object postProcessBeforeInitialization(Object var1, String var2) throws BeansException;\n\n  Object postProcessAfterInitialization(Object var1, String var2) throws BeansException;\n}\n</code></pre><p>æˆ‘ä»¬å†æ¥çœ‹ä¸‹ï¼Œå¦‚ä½•é€šè¿‡BeanPostProcessoræ¥å®šä¹‰åˆå§‹åŒ–å‰ç½®å’Œåç½®æ“ä½œï¼Ÿ</p><p>æˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªå®ç°äº†BeanPostProcessoræ¥å£çš„å¤„ç†å™¨ç±»ï¼Œå¹¶åœ¨é…ç½®æ–‡ä»¶ä¸­åƒé…ç½®æ™®é€šBeanä¸€æ ·å»é…ç½®å°±å¯ä»¥äº†ã€‚Springä¸­çš„ApplicationContextä¼šè‡ªåŠ¨æ£€æµ‹åœ¨é…ç½®æ–‡ä»¶ä¸­å®ç°äº†BeanPostProcessoræ¥å£çš„æ‰€æœ‰Beanï¼Œå¹¶æŠŠå®ƒä»¬æ³¨å†Œåˆ°BeanPostProcessorå¤„ç†å™¨åˆ—è¡¨ä¸­ã€‚åœ¨Springå®¹å™¨åˆ›å»ºBeançš„è¿‡ç¨‹ä¸­ï¼ŒSpringä¼šé€ä¸€å»è°ƒç”¨è¿™äº›å¤„ç†å™¨ã€‚</p><p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¼„æ¸…æ¥šäº†Spring Beançš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼ˆåˆ›å»ºåŠ é”€æ¯ï¼‰ã€‚é’ˆå¯¹è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ç”»äº†ä¸€å¼ å›¾ï¼Œä½ å¯ä»¥ç»“åˆç€åˆšåˆšè®²è§£ä¸€å—çœ‹ä¸‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/ca/4d/cacaf86b03a9432a4885385d2869264d.jpg?wh=2693*1352\" alt=\"\"></p><p>ä¸è¿‡ï¼Œä½ å¯èƒ½ä¼šè¯´ï¼Œè¿™é‡Œå“ªé‡Œç”¨åˆ°äº†æ¨¡æ¿æ¨¡å¼å•Šï¼Ÿæ¨¡æ¿æ¨¡å¼ä¸æ˜¯éœ€è¦å®šä¹‰ä¸€ä¸ªåŒ…å«æ¨¡æ¿æ–¹æ³•çš„æŠ½è±¡æ¨¡æ¿ç±»ï¼Œä»¥åŠå®šä¹‰å­ç±»å®ç°æ¨¡æ¿æ–¹æ³•å—ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œè¿™é‡Œçš„æ¨¡æ¿æ¨¡å¼çš„å®ç°ï¼Œå¹¶ä¸æ˜¯æ ‡å‡†çš„æŠ½è±¡ç±»çš„å®ç°æ–¹å¼ï¼Œè€Œæ˜¯æœ‰ç‚¹ç±»ä¼¼æˆ‘ä»¬å‰é¢è®²åˆ°çš„Callbackå›è°ƒçš„å®ç°æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å°†è¦æ‰§è¡Œçš„å‡½æ•°å°è£…æˆå¯¹è±¡ï¼ˆæ¯”å¦‚ï¼Œåˆå§‹åŒ–æ–¹æ³•å°è£…æˆInitializingBeanå¯¹è±¡ï¼‰ï¼Œä¼ é€’ç»™æ¨¡æ¿ï¼ˆBeanFactoryï¼‰æ¥æ‰§è¡Œã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>å¥½äº†ï¼Œä»Šå¤©çš„å†…å®¹åˆ°æ­¤å°±è®²å®Œäº†ã€‚æˆ‘ä»¬ä¸€å—æ¥æ€»ç»“å›é¡¾ä¸€ä¸‹ï¼Œä½ éœ€è¦é‡ç‚¹æŒæ¡çš„å†…å®¹ã€‚</p><p>ä»Šå¤©æˆ‘è®²åˆ°äº†Springä¸­ç”¨åˆ°çš„ä¸¤ç§æ”¯æŒæ‰©å±•çš„è®¾è®¡æ¨¡å¼ï¼Œè§‚å¯Ÿè€…æ¨¡å¼å’Œæ¨¡æ¿æ¨¡å¼ã€‚</p><p>å…¶ä¸­ï¼Œè§‚å¯Ÿè€…æ¨¡å¼åœ¨Javaã€Google Guavaã€Springä¸­éƒ½æœ‰æä¾›ç›¸åº”çš„å®ç°ä»£ç ã€‚åœ¨å¹³æ—¶çš„é¡¹ç›®å¼€å‘ä¸­ï¼ŒåŸºäºè¿™äº›å®ç°ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å®ç°ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼ã€‚</p><p>Javaæä¾›çš„æ¡†æ¶æ¯”è¾ƒç®€å•ï¼ŒåªåŒ…å«java.util.Observableå’Œjava.util.Observerä¸¤ä¸ªç±»ã€‚Google Guavaæä¾›çš„æ¡†æ¶åŠŸèƒ½æ¯”è¾ƒå®Œå–„å’Œå¼ºå¤§ï¼Œå¯ä»¥é€šè¿‡EventBusäº‹ä»¶æ€»çº¿æ¥å®ç°è§‚å¯Ÿè€…æ¨¡å¼ã€‚Springæä¾›äº†è§‚å¯Ÿè€…æ¨¡å¼åŒ…å«Eventäº‹ä»¶ã€Listenerç›‘å¬è€…ã€Publisherå‘é€è€…ä¸‰éƒ¨åˆ†ã€‚äº‹ä»¶å‘é€åˆ°ApplicationContextä¸­ï¼Œç„¶åï¼ŒApplicationConextå°†æ¶ˆæ¯å‘é€ç»™äº‹å…ˆæ³¨å†Œå¥½çš„ç›‘å¬è€…ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜è®²åˆ°æ¨¡æ¿æ¨¡å¼åœ¨Springä¸­çš„ä¸€ä¸ªå…¸å‹åº”ç”¨ï¼Œé‚£å°±æ˜¯Beançš„åˆ›å»ºè¿‡ç¨‹ã€‚Beançš„åˆ›å»ºåŒ…å«ä¸¤ä¸ªå¤§çš„æ­¥éª¤ï¼Œå¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡çš„åˆå§‹åŒ–ã€‚å…¶ä¸­ï¼Œå¯¹è±¡çš„åˆå§‹åŒ–åˆå¯ä»¥åˆ†è§£ä¸º3ä¸ªå°çš„æ­¥éª¤ï¼šåˆå§‹åŒ–å‰ç½®æ“ä½œã€åˆå§‹åŒ–ã€åˆå§‹åŒ–åç½®æ“ä½œã€‚</p><h2>è¯¾å ‚è®¨è®º</h2><p>åœ¨Google Guavaçš„EventBuså®ç°ä¸­ï¼Œè¢«è§‚å¯Ÿè€…å‘é€æ¶ˆæ¯åˆ°äº‹ä»¶æ€»çº¿ï¼Œäº‹ä»¶æ€»çº¿æ ¹æ®æ¶ˆæ¯çš„ç±»å‹ï¼Œå°†æ¶ˆæ¯å‘é€ç»™å¯åŒ¹é…çš„è§‚å¯Ÿè€…ã€‚é‚£åœ¨Springæä¾›çš„è§‚å¯Ÿè€…æ¨¡å¼çš„å®ç°ä¸­ï¼Œæ˜¯å¦ä¹Ÿæ”¯æŒæŒ‰ç…§æ¶ˆæ¯ç±»å‹åŒ¹é…è§‚å¯Ÿè€…å‘¢ï¼Ÿå¦‚æœèƒ½ï¼Œå®ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå¦‚æœä¸èƒ½ï¼Œä½ æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥è®©å®ƒæ”¯æŒå—ï¼Ÿ</p><p>æ¬¢è¿ç•™è¨€å’Œæˆ‘åˆ†äº«ä½ çš„æƒ³æ³•ã€‚å¦‚æœæœ‰æ”¶è·ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p>","neighbors":{"left":{"article_title":"84 | å¼€æºå®æˆ˜å››ï¼ˆä¸Šï¼‰ï¼šå‰–æSpringæ¡†æ¶ä¸­è•´å«çš„ç»å…¸è®¾è®¡æ€æƒ³æˆ–åŸåˆ™","id":236935},"right":{"article_title":"86 | å¼€æºå®æˆ˜å››ï¼ˆä¸‹ï¼‰ï¼šæ€»ç»“Springæ¡†æ¶ç”¨åˆ°çš„11ç§è®¾è®¡æ¨¡å¼","id":238418}},"comments":[{"had_liked":false,"id":224237,"user_name":"zz","can_delete":false,"product_type":"c1","uid":1237202,"ip_address":"","ucode":"EA1CD86520FE14","user_header":"https://static001.geekbang.org/account/avatar/00/12/e0/d2/fb5306c4.jpg","comment_is_top":false,"comment_ctime":1591321761,"is_pvip":false,"discussion_count":7,"race_medal":0,"score":"126145373345","product_id":100039001,"comment_content":"çœ‹åˆ°æºç ä¸­æœ‰è¿™ä¹ˆå¤šçš„if elseï¼Œç¬é—´ç»™äº†è‡ªå·±ä¸€äº›ä¿¡å¿ƒã€‚","like_count":29,"discussions":[{"author":{"id":1133194,"avatar":"https://static001.geekbang.org/account/avatar/00/11/4a/8a/c1069412.jpg","nickname":"makermade","note":"","ucode":"03386B90CB8F20","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557718,"discussion_content":"æºç ä¸æ˜¯ç»™ä½ åŒäº‹çœ‹çš„ï¼›ä½†æ˜¯ä½ çš„ä»£ç  æ˜¯ç»™ä½ åŒäº‹çœ‹çš„ã€‚æ¡†æ¶æ›´æ³¨é‡é€šç”¨ æ€§èƒ½ï¼Œä¸šåŠ¡ä»£ç æ›´æ³¨é‡å¯è¯»æ€§","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1647940180,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1441569,"avatar":"https://static001.geekbang.org/account/avatar/00/15/ff/21/8815d2e5.jpg","nickname":"äº®å­","note":"","ucode":"DF37D5E0714D02","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550944,"discussion_content":"ä½œè€…è¯´è¿‡ï¼Œä¸è¦è¿‡åº¦è®¾è®¡ï¼Œæœ‰æ—¶å€™æœ€ç®€å•çš„ï¼Œä¹Ÿæ˜¯æœ€æ˜“è¯»çš„","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1644821037,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1103292,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/2m49Z7YV3PGMA15rXTubL3psY8X9bdpd4Xe4qnv7iaVBQjnt5YWicBP2icQCpSYphricllXDLzm8KfZHK3GUOLZBNg/132","nickname":"Ngzhilin","note":"","ucode":"F8EFEC2ACD08A2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351567,"discussion_content":"æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¦æ¯”æºç æ›´å¤š","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614327753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1213322,"avatar":"https://static001.geekbang.org/account/avatar/00/12/83/8a/7c7df3b3.jpg","nickname":"è‘£æ˜Œå¼º","note":"","ucode":"0803D7E3ABD3FD","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":591604,"discussion_content":"æ“¦ï¼Œè¿™æ˜¯æºç çš„æ§½ç‚¹ï¼Œè¿™å•¥è¦å­¦ç¼ºç‚¹äº† ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666696153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1992059,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/65/7b/058d17f3.jpg","nickname":"è€¶low","note":"","ucode":"4CCEB741583544","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405766,"discussion_content":"å®é™…å»çœ‹çœ‹ï¼Œä¿¡å¿ƒé©¬ä¸Šåˆæ²¡äº†ï¼ŒğŸ˜‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634641972,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1455958,"avatar":"https://static001.geekbang.org/account/avatar/00/16/37/56/11068390.jpg","nickname":"å€¡å°","note":"","ucode":"4F53AA5D017D89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388982,"discussion_content":"è·‘åäº†+","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629083628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1438860,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f4/8c/0866b228.jpg","nickname":"å­æˆ¿","note":"","ucode":"CB05938C248BB3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348117,"discussion_content":"å“ˆå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612430371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218271,"user_name":"æ‚Ÿå…‰","can_delete":false,"product_type":"c1","uid":1439777,"ip_address":"","ucode":"E81339EBC4F492","user_header":"https://static001.geekbang.org/account/avatar/00/15/f8/21/3fa228e6.jpg","comment_is_top":false,"comment_ctime":1589769196,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35949507564","product_id":100039001,"comment_content":"æ”¯æŒæŒ‰ç…§æ¶ˆæ¯ç±»å‹åŒ¹é…è§‚å¯Ÿè€…ï¼Œæœ€ç»ˆè°ƒç”¨ SimpleApplicationEventMulticaster ç±»çš„multicastEventæ–¹æ³•é€šè¿‡åå°„åŒ¹é…ç±»å‹ã€‚æ ¹æ®é…ç½®é‡‡ç”¨å¼‚æ­¥è¿˜æ˜¯åŒæ­¥çš„ç›‘å¬æ–¹å¼ã€‚<br>\tpublic void multicastEvent(final ApplicationEvent event, @Nullable ResolvableType eventType) {<br>\t\tResolvableType type = (eventType != null ? eventType : resolveDefaultEventType(event));<br>\t\tExecutor executor = getTaskExecutor();<br>\t\tfor (ApplicationListener&lt;?&gt; listener : getApplicationListeners(event, type)) {<br>\t\t\tif (executor != null) {<br>\t\t\t\texecutor.execute(() -&gt; invokeListener(listener, event));<br>\t\t\t}<br>\t\t\telse {<br>\t\t\t\tinvokeListener(listener, event);<br>\t\t\t}<br>\t\t}<br>\t}<br>","like_count":9},{"had_liked":false,"id":218249,"user_name":"test","can_delete":false,"product_type":"c1","uid":1065849,"ip_address":"","ucode":"9A4973E591DD12","user_header":"https://static001.geekbang.org/account/avatar/00/10/43/79/18073134.jpg","comment_is_top":false,"comment_ctime":1589765140,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35949503508","product_id":100039001,"comment_content":"ç”¨åå°„è·å–çš„type","like_count":8},{"had_liked":false,"id":218396,"user_name":"Heaven","can_delete":false,"product_type":"c1","uid":1694207,"ip_address":"","ucode":"FA33FBCC66C911","user_header":"https://static001.geekbang.org/account/avatar/00/19/d9/ff/b23018a6.jpg","comment_is_top":false,"comment_ctime":1589796160,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"31654567232","product_id":100039001,"comment_content":"çœ‹äº†ä¸‹æºç ,å…¶æµç¨‹å¯ä»¥ä»<br>å›¾ç‰‡: https:&#47;&#47;uploader.shimo.im&#47;f&#47;fZuIVWFIlWQnnRFq.png<br>æ¨é€Eventæ—¶å€™,å»å‘é€Eventå¼€å§‹èµ°<br>ä¸»è¦å°±æ˜¯è¿™ä¸ª<br>åœ¨æ­¤æ–¹æ³•ä¸­,ä¼šè°ƒç”¨getApplicationListeners(event,eventType)å‡½æ•°<br>å›¾ç‰‡: https:&#47;&#47;uploader.shimo.im&#47;f&#47;3mZZvSBhmc8CXLnx.png<br>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­,ä¼šè·å–åˆ°å¯¹åº”çš„æ‰€æœ‰ç›‘å¬è€…,å¦‚ä½•è·å–åˆ°çš„,ä¼šå…ˆé€šè¿‡ä¸€ä¸ªé”æ¥ä»ä¸€ä¸ªåä¸ºretrieverCacheçš„mapä¸­å°è¯•è·å–åˆ°å¯¹åº”çš„ç›‘å¬è€…<br>å¦‚æœæ‹¿ä¸åˆ°,ä¼šè¿›å…¥åˆ°retrieveApplicationListeners()è¿™ä¸ªå‡½æ•°ä¹‹ä¸­<br>å›¾ç‰‡: https:&#47;&#47;uploader.shimo.im&#47;f&#47;GFvS2QEKGlMctZrc.png<br>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­,ä¼šåœ¨addè¿”å›çš„ç»“æœçš„æ—¶å€™,ä¼šè°ƒç”¨ä¸€ä¸ªæ–¹æ³•supportsEvent(),<br>è¿™æ‰æ˜¯çœŸæ­£è¿›è¡ŒåŒ¹é…çš„æ–¹æ³•<br>å›¾ç‰‡: https:&#47;&#47;uploader.shimo.im&#47;f&#47;102Ia9ToqIw5ZOyq.png<br>åŒ¹é…äº‹ä»¶å’Œæºç±»å‹æ˜¯å¦ä¸€è‡´,ä¸€è‡´æ‰ç®—åšå¯ä»¥å‘é€","like_count":7},{"had_liked":false,"id":219298,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1589985550,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"27359789326","product_id":100039001,"comment_content":"å®šä¹‰äº†ä¸€ä¸ªbeanåŒæ—¶å®ç°äº†InitializingBean, BeanPostProcessor, DisposableBeanï¼Œå‘ç°æ–¹æ³•è·Ÿè€å¸ˆæœ€åä¸€å¼ å›¾çš„ä¸ä¸€è‡´ï¼š<br>1ã€é¡ºåºæ˜¯æ„é€ å™¨ã€afterPropertiesSetã€postProcessBeforeInitializationã€postProcessAfterInitializationã€destroy<br>2ã€postProcessBeforeInitializationã€postProcessAfterInitializationè¿™ä¸¤ä¸ªæ–¹æ³•äº¤æ›¿æ‰§è¡Œäº†Næ¬¡","like_count":6,"discussions":[{"author":{"id":1237655,"avatar":"https://static001.geekbang.org/account/avatar/00/12/e2/97/dfadcc92.jpg","nickname":"Kang","note":"","ucode":"088A8DA0A16BDE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":115372,"discussion_content":"è®©ä»–ä»¬ç­‰ç€ï¼Œä½ å…ˆæƒ³æƒ³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578012923,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218217,"user_name":"æˆ‘çš„è…¿è…¿","can_delete":false,"product_type":"c1","uid":1239277,"ip_address":"","ucode":"2AAA36A7C3AD75","user_header":"https://static001.geekbang.org/account/avatar/00/12/e8/ed/f9347e5e.jpg","comment_is_top":false,"comment_ctime":1589760884,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"23064597364","product_id":100039001,"comment_content":"æ˜¨å¤©åˆšå¥½åœ¨éš”å£å°é©¬å“¥é‚£é‡Œçœ‹åˆ°äº†ï¼Œä¸¤ä¸ªè¯¾ä¸€èµ·å¬ï¼Œä¾§é‡ç‚¹ä¸åŒï¼Œéƒ½å¾ˆé‡è¦å•Š","like_count":5,"discussions":[{"author":{"id":1190123,"avatar":"https://static001.geekbang.org/account/avatar/00/12/28/eb/af064421.jpg","nickname":"ç‹äº‰","note":"","ucode":"2B611BE0E0EDD4","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480213,"discussion_content":"å•å…ƒæµ‹è¯•çœŸçš„å¾ˆæœ‰ç”¨ï¼Œè°å†™è°çŸ¥é“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1578490425,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1323102,"avatar":"https://static001.geekbang.org/account/avatar/00/14/30/5e/c42bc33f.jpg","nickname":"Younger Ku","note":"","ucode":"D157DC38BDB515","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":307550,"discussion_content":"å•å…ƒæµ‹è¯•éœ€è¦æµ‹è¯•serviceè¿˜æ˜¯controller?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600682144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1055334,"avatar":"https://static001.geekbang.org/account/avatar/00/10/1a/66/2d9db9ed.jpg","nickname":"è‹¦è¡Œåƒ§","note":"","ucode":"726024A9A9CF44","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278330,"discussion_content":"å•å…ƒæµ‹è¯•æ˜¯ç‹é“","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591174754,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":237477,"user_name":"Tobias","can_delete":false,"product_type":"c1","uid":1803858,"ip_address":"","ucode":"F3225639EDA193","user_header":"https://static001.geekbang.org/account/avatar/00/1b/86/52/b92dc111.jpg","comment_is_top":false,"comment_ctime":1595841397,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14480743285","product_id":100039001,"comment_content":"Spring æä¾›çš„è§‚å¯Ÿè€…æ¨¡å¼æ˜¯æ”¯æŒæŒ‰ç…§æ¶ˆæ¯ç±»å‹åŒ¹é…è§‚å¯Ÿè€…ã€‚getApplicationListeners(event, type) æ–¹æ³•ä¼šæ ¹æ®eventtype æ‰¾åˆ°å¯¹åº”çš„çš„listeners. getApplicationListeners(event, type) é€šè¿‡åå°„æ‰¾åˆ° event ä»¥åŠeventçš„å­ç±» å¯¹åº”çš„listeners.","like_count":3},{"had_liked":false,"id":252743,"user_name":"æ¡äº†ä¸ªå¤§èš‚èš±","can_delete":false,"product_type":"c1","uid":1488356,"ip_address":"","ucode":"AD34AD4FA37371","user_header":"https://static001.geekbang.org/account/avatar/00/16/b5/e4/e6faf686.jpg","comment_is_top":false,"comment_ctime":1602472939,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5897440235","product_id":100039001,"comment_content":"1.å®ç°InitializingBeançš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¹Ÿæ˜¯çº¦å®šä¼˜äºé…ç½®çš„ä¸€ä¸ªä½“ç°ï¼Œåªä¸è¿‡ä¸æ˜¯è¦†ç›–é»˜è®¤å€¼è€Œæ˜¯å®ç°init-methodçš„ä¸€ä¸ªå‰ç½®æ–¹æ³•afterPropertiesSetã€‚<br>2.å®ç°InitializingBeançš„åˆå§‹åŒ–æ–¹æ³•å’Œè‡ªå·±æŒ‡å®šinit-methodç›¸æ¯”ï¼Œä¾µå…¥æ€§æ›´é«˜ï¼Œæ‰€ä»¥ä¸å¤ªæ¨èã€‚å¯ä»¥ç”¨æ³¨è§£ç‰ˆçš„@Bean(initMethod = &quot;xx&quot;)æ¥æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ï¼Œæˆ–è€…ä½¿ç”¨JSR250ä¸­çš„@PostConstructæ ‡æ³¨åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸Šæ¥è®©ç¨‹åºå›è°ƒã€‚","like_count":1},{"had_liked":false,"id":232333,"user_name":"å‰‘å…«","can_delete":false,"product_type":"c1","uid":1297630,"ip_address":"","ucode":"0A09F41DB8A4E7","user_header":"https://static001.geekbang.org/account/avatar/00/13/cc/de/e28c01e1.jpg","comment_is_top":false,"comment_ctime":1593959081,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"5888926377","product_id":100039001,"comment_content":"springä¸­çš„refreshæ˜¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ï¼š<br>å¤§è‡´æœ‰ï¼šæ³¨å†ŒbeanFactoryPostProcessorï¼ŒbeanPostProcessorï¼Œè¯»å–bean definitionï¼Œåˆ›å»ºå¹¶åˆå§‹åŒ–bean,ç­‰","like_count":1,"discussions":[{"author":{"id":1087243,"avatar":"https://static001.geekbang.org/account/avatar/00/10/97/0b/a943bcb3.jpg","nickname":"zhou","note":"","ucode":"E1CE8575B3F106","race_medal":3,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":239195,"discussion_content":"å—¯ å¾€å¾€å‡ ä¸ªæœˆåï¼Œå›å¤´æŸ¥ä¸€ä¸ªé—®é¢˜çš„æ—¶å€™ä¼šæŒ‡ç€è‡ªå·±çš„ä»£ç è¯´ï¼Œè¿™æ˜¯å“ªä¸ªå‚»Xå†™çš„ä»£ç ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1587283604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":357700,"user_name":"tonyli","can_delete":false,"product_type":"c1","uid":1011969,"ip_address":"ä¸­å›½é¦™æ¸¯","ucode":"6001A47BC5C9E7","user_header":"","comment_is_top":false,"comment_ctime":1663573250,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663573250","product_id":100039001,"comment_content":"ä½¿ç”¨æ¨¡æ¿æ¨¡å¼å®šä¹‰äº†ä¸€ç³»åˆ—æ­¥éª¤çš„éª¨æ¶ï¼Œæ˜¯å„ç±»æ¡†æ¶çš„æ ¹æœ¬è®¾è®¡æ¨¡å¼ã€‚","like_count":0},{"had_liked":false,"id":332124,"user_name":"æé‡‘é¹","can_delete":false,"product_type":"c1","uid":1445362,"ip_address":"","ucode":"8FCCA5B8BD8DDD","user_header":"https://static001.geekbang.org/account/avatar/00/16/0d/f2/3865fe28.jpg","comment_is_top":false,"comment_ctime":1643030474,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1643030474","product_id":100039001,"comment_content":"è‡ªå®šä¹‰æ³¨è§£åŠ AOPå¯ä»¥å®ç°æ”¯æŒæŒ‰ç…§æ¶ˆæ¯ç±»å‹åŒ¹é…è§‚å¯Ÿè€…","like_count":0},{"had_liked":false,"id":280432,"user_name":"David","can_delete":false,"product_type":"c1","uid":1021825,"ip_address":"","ucode":"22CBBC13FC97A9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/97/81/e1eaf621.jpg","comment_is_top":false,"comment_ctime":1614216376,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1614216376","product_id":100039001,"comment_content":"ç­–è®ºæ¨¡å¼ ç¼“å­˜å¯¹è±¡ç±»å‹å’Œå¤„ç†å™¨çš„å…³ç³»","like_count":0,"discussions":[{"author":{"id":1463740,"avatar":"https://static001.geekbang.org/account/avatar/00/16/55/bc/fad0090b.jpg","nickname":"Yeyw","note":"","ucode":"C9D20DB91C3BE5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368756,"discussion_content":"æˆ‘ä¹‹å‰é¡¹ç›®çš„å°±æ˜¯è‡ªå·±å®ç°æ³¨å†Œç­–ç•¥æ¥å£ç±»å‹å’Œç­–ç•¥å®ç°ï¼Œæ¯ä¸ªç­–ç•¥éƒ½å¸¦æœ‰ç›¸åº”çš„types","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618824106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277491,"user_name":"å­æˆ¿","can_delete":false,"product_type":"c1","uid":1438860,"ip_address":"","ucode":"CB05938C248BB3","user_header":"https://static001.geekbang.org/account/avatar/00/15/f4/8c/0866b228.jpg","comment_is_top":false,"comment_ctime":1612430476,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612430476","product_id":100039001,"comment_content":"spring ä¸­é€šè¿‡ simple å®ç°ç±»å‘é€äº‹ä»¶ï¼Œå¹¶ç»´æŠ¤äº†äº‹ä»¶å’Œç›‘å¬è€…çš„æ˜ å°„å…³ç³»ï¼Œå½“éœ€è¦å‘é€ä¸€ä¸ªäº‹ä»¶æ—¶ä¼šæŠŠè¯¥äº‹ä»¶å¯¹åº”çš„ç›‘å¬è€…å–å‡ºï¼Œå¹¶æ‰§è¡Œã€‚","like_count":0},{"had_liked":false,"id":258071,"user_name":"o0oi1i","can_delete":false,"product_type":"c1","uid":1132312,"ip_address":"","ucode":"D1F6AD4AAEAFBE","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/18/293cd24d.jpg","comment_is_top":false,"comment_ctime":1604286104,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1604286104","product_id":100039001,"comment_content":"æ‰“å¡85","like_count":0}]}