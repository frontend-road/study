{"id":711805,"title":"03 | 初识LangChain：你的瑞士军刀","content":"<p>由于openai 11月6日发布的新的API  v1.0.0, 不兼容以前的版本，所以课程代码会做一定的更新。老师已经更新了部分章节的典型代码，<br>\n链接如下（两个链接都可以，国内用户推荐第二个）：</p><p><a href=\"https://github.com/chaocai2001/gpt_in_practice_v1\">https://github.com/chaocai2001/gpt_in_practice_v1</a></p><p><a href=\"https://gitee.com/chao-superman/llm_in_practice_v1\">https://gitee.com/chao-superman/llm_in_practice_v1</a></p><p>其他部分学员可以参考修改。老师也会在近期陆续更新代码。</p>","comments":[{"had_liked":false,"id":382493,"user_name":"lei","can_delete":false,"product_type":"c3","uid":1122652,"ip_address":"陕西","ucode":"B7C87F2130F1E8","user_header":"https://static001.geekbang.org/account/avatar/00/11/21/5c/66090d2d.jpg","comment_is_top":false,"comment_ctime":1697456316,"is_pvip":false,"replies":[{"id":139304,"content":"我将langchain 升级为 0.0.315，运行示例代码也是没有问题的。","user_name":"作者回复","user_name_real":"编辑","uid":1008262,"ctime":1697504379,"ip_address":"北京","comment_id":382493,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100625601,"comment_content":"老师 课程中langchain 版本 是多少？我这里运行实例代码 报错 ，应该是langchain版本问题 我换成你课程里的版本试试 谢谢","like_count":1,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629661,"discussion_content":"我将langchain 升级为 0.0.315，运行示例代码也是没有问题的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1697504379,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1122652,"avatar":"https://static001.geekbang.org/account/avatar/00/11/21/5c/66090d2d.jpg","nickname":"lei","note":"","ucode":"B7C87F2130F1E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630860,"discussion_content":"问题已经解决了  在pycharm里面  也可以正常运行 但是有warning  是因为我没有打印出结果  没有输出  以为执行错误了 。 pycharm里面运行 需要加上 print(llm_chain.run(&#34;colorful socks&#34;))   才能看到结果。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698980038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1122652,"avatar":"https://static001.geekbang.org/account/avatar/00/11/21/5c/66090d2d.jpg","nickname":"lei","note":"","ucode":"B7C87F2130F1E8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630795,"discussion_content":"老师 您好 我在jupyter 里面运行代码是没问题的，但是同样的代码我写在pycharm里面运行报这个错误：C:\\Users\\wl112\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\langchain\\__init__.py:39: UserWarning: Importing PromptTemplate from langchain root module is no longer supported.\n  warnings.warn(\nC:\\Users\\wl112\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\langchain\\__init__.py:39: UserWarning: Importing OpenAI from langchain root module is no longer supported.\n  warnings.warn(\nC:\\Users\\wl112\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\langchain\\__init__.py:39: UserWarning: Importing LLMChain from langchain root module is no longer supported.\n  warnings.warn(\nC:\\Users\\wl112\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\langchain\\__init__.py:34: UserWarning: Importing llm_cache from langchain root module is no longer supported. Please use langchain.globals.set_llm_cache() / langchain.globals.get_llm_cache() instead.\n  warnings.warn(\n\n我在网上没有找到合适的解决办法，麻烦您能帮我看看吗？ 谢谢~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698894496,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":388846,"user_name":"志远","can_delete":false,"product_type":"c3","uid":1108762,"ip_address":"湖北","ucode":"11015D14034130","user_header":"https://static001.geekbang.org/account/avatar/00/10/eb/1a/579c941e.jpg","comment_is_top":false,"comment_ctime":1711002530,"is_pvip":false,"replies":[{"id":141535,"content":"你可以在这个 链接 https:&#47;&#47;python.langchain.com&#47;docs&#47;integrations&#47;llms&#47; 里看到 Langchain支持的LLM","user_name":"作者回复","user_name_real":"编辑","uid":1008262,"ctime":1711158792,"ip_address":"北京","comment_id":388846,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100625601,"comment_content":"在这个示例中，langchain 可以使用国内的一些大模型的api吗？例如月之暗面kimi？","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":640104,"discussion_content":"你可以在这个 链接 https://python.langchain.com/docs/integrations/llms/ 里看到 Langchain支持的LLM","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711158793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383418,"user_name":"golf","can_delete":false,"product_type":"c3","uid":1250558,"ip_address":"陕西","ucode":"9BE715230B0EE9","user_header":"https://static001.geekbang.org/account/avatar/00/13/14/fe/ae89ad97.jpg","comment_is_top":false,"comment_ctime":1699001932,"is_pvip":false,"replies":[{"id":139697,"content":"是用来对应http request返回的一个key，是有LangChain的实现来注入的，可以参考源码：\nhttps:&#47;&#47;github.com&#47;langchain-ai&#47;langchain&#47;blob&#47;e43b4079c80cb4495cfa7b2b454abc3a32deec00&#47;libs&#47;langchain&#47;langchain&#47;chains&#47;llm_requests.py#L17","user_name":"作者回复","user_name_real":"编辑","uid":1008262,"ctime":1699065975,"ip_address":"北京","comment_id":383418,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100625601,"comment_content":"我运行报这个错：ValueError: Missing some input keys: {&#39;request_results&#39;}， 看代码也没看明白这个request_results是怎么注入到prompt templete中的，是LLMRequestsChain约定的响应结果占位符吗？","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630923,"discussion_content":"是用来对应http request返回的一个key，是有LangChain的实现来注入的，可以参考源码：\nhttps://github.com/langchain-ai/langchain/blob/e43b4079c80cb4495cfa7b2b454abc3a32deec00/libs/langchain/langchain/chains/llm_requests.py#L17","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699065975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1250558,"avatar":"https://static001.geekbang.org/account/avatar/00/13/14/fe/ae89ad97.jpg","nickname":"golf","note":"","ucode":"9BE715230B0EE9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630899,"discussion_content":"好像第二个例子里的output_key=&#34;query_info&#34;应该是output_key=&#34;requests_result&#34;才能解释通吧。\n另外链式请求里的output_variables如果传多个，会报下面的错误：\nValueError: `run` not supported when there is not exactly one output key. Got [&#39;summary&#39;, &#39;translated&#39;].","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1699015018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382543,"user_name":"Revive","can_delete":false,"product_type":"c3","uid":3733027,"ip_address":"湖南","ucode":"AE9B0E531D5571","user_header":"https://static001.geekbang.org/account/avatar/00/38/f6/23/10ccfe80.jpg","comment_is_top":false,"comment_ctime":1697545241,"is_pvip":false,"replies":[{"id":139326,"content":"这里核心是利用了LangChain LLMRequestChain。\n首先LLMRequestChain向作为输入的{URL}发出HTTP GET请求，示例中的请求携带了用户的问题{query}，并且示例中的{URL}就是百度的查询URL，所以会返回用户问题查询结果。\n然后，在调用LLM根据用户问题对返回的结果进行总结加工，形成最终结果。\n你可以通过代码中的Prompt来理解这个过程\n\n","user_name":"作者回复","user_name_real":"编辑","uid":1008262,"ctime":1697594619,"ip_address":"北京","comment_id":382543,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100625601,"comment_content":"不是很理解langchain对百度发起请求，是在哪个部分实现的","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629738,"discussion_content":"这里核心是利用了LangChain LLMRequestChain。\n首先LLMRequestChain向作为输入的{URL}发出HTTP GET请求，示例中的请求携带了用户的问题{query}，并且示例中的{URL}就是百度的查询URL，所以会返回用户问题查询结果。\n然后，在调用LLM根据用户问题对返回的结果进行总结加工，形成最终结果。\n你可以通过代码中的Prompt来理解这个过程\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1697594619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382536,"user_name":"招谁惹谁","can_delete":false,"product_type":"c3","uid":1014054,"ip_address":"浙江","ucode":"F4B43C8C098E96","user_header":"https://static001.geekbang.org/account/avatar/00/0f/79/26/9ac98036.jpg","comment_is_top":false,"comment_ctime":1697534703,"is_pvip":false,"replies":[{"id":139329,"content":"其实是两个完全不同的项目：\nLangchain是一个开发工具包，旨在简化使用大型语言模型创建应用程序的过程。\nFastchatFastChat是一个用于训练、部署和评估基于大型语言模型的聊天机器人的开放平台。","user_name":"作者回复","user_name_real":"编辑","uid":1008262,"ctime":1697595382,"ip_address":"北京","comment_id":382536,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100625601,"comment_content":"Langchain和fastchat是什么关系呢？","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"蔡超","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":629741,"discussion_content":"其实是两个完全不同的项目：\nLangchain是一个开发工具包，旨在简化使用大型语言模型创建应用程序的过程。\nFastchatFastChat是一个用于训练、部署和评估基于大型语言模型的聊天机器人的开放平台。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1697595382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":390913,"user_name":"账号已注销...","can_delete":false,"product_type":"c3","uid":1374898,"ip_address":"广东","ucode":"D80E2A435946E3","user_header":"https://static001.geekbang.org/account/avatar/00/14/fa/b2/d637b234.jpg","comment_is_top":false,"comment_ctime":1716733475,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100625601,"comment_content":"代码里的key “url”应该换成“requests_result”吧","like_count":0},{"had_liked":false,"id":390534,"user_name":"寻海却不见水","can_delete":false,"product_type":"c3","uid":1226723,"ip_address":"湖北","ucode":"B62C9BB757F515","user_header":"https://static001.geekbang.org/account/avatar/00/12/b7/e3/76ebcc41.jpg","comment_is_top":false,"comment_ctime":1715582624,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100625601,"comment_content":"目前langchain的版本已经到了0.1.x了，然后学习代码中函数就不是很流畅，很多都已经不推荐使用了，这块后续会更新到0.1.x的版本吗？","like_count":0,"discussions":[{"author":{"id":1794294,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/60/f6/6a9b2c83.jpg","nickname":"水都远山望","note":"","ucode":"C81A877CBDDBE1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646447,"discussion_content":"现在已经0.2的版本了，迭代得蛮快的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1717997478,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}