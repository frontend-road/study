{"id":378082,"title":"03 | 项目部署：如何快速部署 IAM 系统？","content":"<p>你好，我是孔令飞。</p><p>上一讲，我们一起安装和配置了一个基本的 Go 开发环境。这一讲，我就来教你怎么在它的基础上，快速部署好 IAM 系统。</p><p>因为我们要通过一个 IAM 项目来讲解怎么开发企业级 Go 项目，所以你要对 IAM 项目有比较好的了解，了解 IAM 项目一个最直接有效的方式就是去部署和使用它。</p><p>这不仅能让你了解到 IAM 系统中各个组件功能之间的联系，加深你对 IAM 系统的理解，还可以协助你排障，尤其是跟部署相关的故障。此外，部署好 IAM 系统也能给你后面的学习准备好实验环境，边学、边练，从而提高你的学习效率。</p><p>所以，今天我们专门花一讲的时间来说说怎么部署和使用 IAM 系统。同时，因为 IAM 系统是一个企业级的项目，有一定的复杂度，我建议你严格按照我说的步骤去操作，否则可能会安装失败。</p><p>总的来说，我把部署过程分成 2 大步。</p><ol>\n<li>安装和配置数据库：我们需要安装和配置 MariaDB、Redis和MongoDB。</li>\n<li>安装和配置 IAM 服务：我们需要安装和配置 iam-apiserver、iam-authz-server、iam-pump、iamctl和man 文件。</li>\n</ol><p>当然啦，如果你实在不想这么麻烦地去安装，我也在这一讲的最后给出了一键部署 IAM 系统的方法，但我还是希望你能按照我今天讲的详细步骤来操作。</p><!-- [[[read_end]]] --><p>那话不多说，我们直接开始操作吧！</p><h2>下载 iam 项目代码</h2><p>因为 IAM 的安装脚本存放在 iam 代码仓库中，安装需要的二进制文件也需要通过 iam 代码构建，所以在安装之前，我们需要先下载 iam 代码：</p><pre><code>$ mkdir -p $WORKSPACE/golang/src/github.com/marmotedu\n$ cd $WORKSPACE/golang/src/github.com/marmotedu\n$ git clone --depth=1 https://github.com/marmotedu/iam\n$ go work use ./iam\n</code></pre><p>其中，marmotedu 和 marmotedu/iam 目录存放了本实战项目的代码，在学习过程中，你需要频繁访问这 2 个目录，为了访问方便，我们可以追加如下 2 个环境变量和 2 个 alias 到<code>$HOME/.bashrc</code> 文件中：</p><pre><code>$ tee -a $HOME/.bashrc &lt;&lt; 'EOF'\n# Alias for quick access\nexport GOSRC=&quot;$WORKSPACE/golang/src&quot;\nexport IAM_ROOT=&quot;$GOSRC/github.com/marmotedu/iam&quot;\nalias mm=&quot;cd $GOSRC/github.com/marmotedu&quot;\nalias i=&quot;cd $GOSRC/github.com/marmotedu/iam&quot;\nEOF\n$ bash\n</code></pre><p>之后，你就可以先通过执行 alias 命令 <code>mm</code> 访问 <code>$GOSRC/github.com/marmotedu</code> 目录；通过执行 alias 命令 <code>i</code> 访问 <code>$GOSRC/github.com/marmotedu/iam</code> 目录。</p><p>这里我也建议你善用 alias，将常用操作配置成 alias，方便以后操作。</p><p>在安装配置之前需要执行以下命令export going用户的密码，这里假设密码是 <code>iam59!z$</code>：</p><pre><code>export LINUX_PASSWORD='iam59!z$'\n\n</code></pre><h2>安装和配置数据库</h2><p>因为 IAM 系统用到了 MariaDB、Redis、MongoDB 数据库来存储数据，而 IAM 服务在启动时会先尝试连接这些数据库，所以为了避免启动时连接数据库失败，这里我们先来安装需要的数据库。</p><h3>安装和配置 MariaDB</h3><p>IAM 会把 REST 资源的定义信息存储在关系型数据库中，关系型数据库我选择了 MariaDB。为啥选择 MariaDB，而不是 MySQL呢？。选择 MariaDB 一方面是因为它是发展最快的 MySQL 分支，相比 MySQL，它加入了很多新的特性，并且它能够完全兼容 MySQL，包括 API 和命令行。另一方面是因为 MariaDB 是开源的，而且迭代速度很快。</p><p>首先，我们可以通过以下命令安装和配置 MariaDB，并将 Root 密码设置为 <code>iam59!z$</code>：</p><pre><code>$ cd $IAM_ROOT\n$ ./scripts/install/mariadb.sh iam::mariadb::install\n</code></pre><p>然后，我们可以通过以下命令，来测试 MariaDB 是否安装成功：</p><pre><code>$ mysql -h127.0.0.1 -uroot -p'iam59!z$'\nMariaDB [(none)]&gt;\n</code></pre><h3>安装和配置 Redis</h3><p>在 IAM 系统中，由于 iam-authz-server 是从 iam-apiserver 拉取并缓存用户的密钥/策略信息的，因此同一份密钥/策略数据会分别存在 2 个服务中，这可能会出现数据不一致的情况。数据不一致会带来一些问题，例如当我们通过 iam-apiserver 创建了一对密钥，但是这对密钥还没有被 iam-authz-server 缓存，这时候通过这对密钥访问 iam-authz-server 就会访问失败。</p><p>为了保证数据的一致性，我们可以使用 Redis 的发布订阅(pub/sub)功能进行消息通知。同时，iam-authz-server 也会将授权审计日志缓存到 Redis 中，所以也需要安装 Redis key-value 数据库。我们可以通过以下命令来安装和配置 Redis，并将 Redis 的初始密码设置为 <code>iam59!z$</code> ：</p><pre><code>$ cd $IAM_ROOT\n$ ./scripts/install/redis.sh iam::redis::install\n</code></pre><p>这里我们要注意，scripts/install/redis.sh 脚本中 iam::redis::install 函数对 Redis 做了一些配置，例如修改 Redis 使其以守护进程的方式运行、修改 Redis 的密码为 <code>iam59!z$</code>等，详细配置可参考函数 <a href=\"https://github.com/marmotedu/iam/blob/v1.0.0/scripts/install/redis.sh#L20\">iam::redis::install</a> 函数。</p><p>安装完成后，我们可以通过以下命令，来测试 Redis 是否安装成功：</p><pre><code> $ redis-cli -h 127.0.0.1 -p 6379 -a 'iam59!z$' # 连接 Redis，-h 指定主机，-p 指定监听端口，-a 指定登录密码\n\n</code></pre><h3>安装和配置 MongoDB</h3><p>因为 iam-pump 会将 iam-authz-server 产生的数据处理后存储在 MongoDB 中，所以我们也需要安装 MongoDB 数据库。主要分两步安装：首先安装 MongoDB，然后再创建 MongoDB 账号。</p><h4>第 1 步，安装 MongoDB</h4><p>首先，我们可以通过以下 4 步来安装 MongoDB。</p><ol>\n<li>配置 MongoDB yum 源，并安装 MongoDB。</li>\n</ol><p>CentOS8.x 系统默认没有配置安装 MongoDB 需要的 yum 源，所以我们需要先配置好 yum 源再安装：</p><pre><code>$ sudo tee /etc/yum.repos.d/mongodb-org-5.0.repo&lt;&lt;'EOF'\n[mongodb-org-5.0]\nname=MongoDB Repository\nbaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/5.0/x86_64/\ngpgcheck=1\nenabled=1\ngpgkey=https://www.mongodb.org/static/pgp/server-5.0.asc\nEOF\n \n$ sudo yum install -y mongodb-org\n</code></pre><ol start=\"2\">\n<li>关闭 SELinux。</li>\n</ol><p>在安装的过程中，SELinux 有可能会阻止 MongoDB 访问/sys/fs/cgroup，所以我们还需要关闭 SELinux：</p><pre><code>$ sudo setenforce 0\n$ sudo sed -i 's/^SELINUX=.*$/SELINUX=disabled/' /etc/selinux/config # 永久关闭 SELINUX\n</code></pre><ol start=\"3\">\n<li>开启外网访问权限和登录验证。</li>\n</ol><p>MongoDB 安装完之后，默认情况下是不会开启外网访问权限和登录验证，为了方便使用，我建议你先开启这些功能，执行如下命令开启：</p><pre><code>$ sudo sed -i '/bindIp/{s/127.0.0.1/0.0.0.0/}' /etc/mongod.conf\n$ sudo sed -i '/^#security/a\\security:\\n  authorization: enabled' /etc/mongod.conf\n</code></pre><ol start=\"4\">\n<li>启动 MongoDB。</li>\n</ol><p>配置完 MongoDB 之后，我们就可以启动它了，具体的命令如下：</p><pre><code>$ sudo systemctl start mongod\n$ sudo systemctl enable mongod # 设置开机启动\n$ sudo systemctl status mongod # 查看 mongod 运行状态，如果输出中包含 active (running)字样说明 mongod 成功启动\n\n</code></pre><p>安装完 MongoDB 后，我们就可以通过 <code>mongo</code> 命令登录 MongoDB Shell。如果没有报错，就说明 MongoDB 被成功安装了。</p><pre><code>$ mongosh --quiet &quot;mongodb://127.0.0.1:27017&quot;\ntest&gt;\n</code></pre><h4>第 2 步，创建 MongoDB 账号</h4><p>安装完 MongoDB 之后，默认是没有用户账号的，为了方便 IAM 服务使用，我们需要先创建好管理员账号，通过管理员账户登录 MongoDB，我们可以执行创建普通用户、数据库等操作。</p><ol>\n<li>创建管理员账户。</li>\n</ol><p>首先，我们通过 <code>use admin</code> 指令切换到 admin 数据库，再通过 <code>db.auth(\"用户名\"，\"用户密码\")</code> 验证用户登录权限。如果返回 1 表示验证成功；如果返回 0 表示验证失败。具体的命令如下：</p><pre><code>$ mongosh --quiet &quot;mongodb://127.0.0.1:27017&quot;\ntest&gt; use admin\nswitched to db admin\nadmin&gt; db.createUser({user:&quot;root&quot;,pwd:&quot;iam59!z$&quot;,roles:[&quot;root&quot;]})\n{ ok: 1 }\nadmin&gt; db.auth(&quot;root&quot;, &quot;iam59!z$&quot;)\n{ ok: 1 }\n</code></pre><p>此外，如果想删除用户，可以使用 <code>db.dropUser(\"用户名\")</code> 命令。</p><p><code>db.createUser</code> 用到了以下 3 个参数。</p><ul>\n<li>user: 用户名。</li>\n<li>pwd: 用户密码。</li>\n<li>roles: 用来设置用户的权限，比如读、读写、写等。</li>\n</ul><p>因为 admin 用户具有 MongoDB 的 Root 权限，权限过大安全性会降低。为了提高安全性，我们还需要创建一个 iam 普通用户来连接和操作 MongoDB。</p><ol start=\"2\">\n<li>创建 iam 用户，命令如下：</li>\n</ol><pre><code>$ mongosh --quiet mongodb://root:'iam59!z$'@127.0.0.1:27017/iam_analytics?authSource=admin # 用管理员账户连接 MongoDB\niam_analytics&gt; db.createUser({user:&quot;iam&quot;,pwd:&quot;iam59!z$&quot;,roles:[&quot;dbOwner&quot;]})\n{ ok: 1 }\niam_analytics&gt; db.auth(&quot;iam&quot;, &quot;iam59!z$&quot;)\n{ ok: 1 }\n</code></pre><p>创建完 iam 普通用户后，我们就可以通过 iam 用户登录 MongoDB 了：</p><pre><code>$ mongosh --quiet mongodb://iam:'iam59!z$'@127.0.0.1:27017/iam_analytics?authSource=iam_analytics\n</code></pre><p>至此，我们成功安装了 IAM 系统需要的数据库 MariaDB、Redis 和 MongoDB。</p><h2>安装和配置 IAM 系统</h2><p>要想完成 IAM 系统的安装，我们还需要安装和配置 iam-apiserver、iam-authz-server、iam-pump 和 iamctl。这些组件的功能我们在<a href=\"https://time.geekbang.org/column/article/377998\">第1讲</a>详细讲过，如果不记得你可以翻回去看看。</p><blockquote>\n<p>提示：IAM 项目我会长期维护、定期更新，欢迎你 Star &amp; Contributing。</p>\n</blockquote><h3>准备工作</h3><p>在开始安装之前，我们需要先做一些准备工作，主要有 5 步。</p><ol>\n<li>初始化 MariaDB 数据库，创建 iam 数据库。</li>\n<li>配置 scripts/install/environment.sh。</li>\n<li>创建需要的目录。</li>\n<li>创建 CA 根证书和密钥。</li>\n<li>配置 hosts。</li>\n</ol><p><strong>第 1 步，初始化 MariaDB 数据库，创建 iam 数据库。</strong></p><p>安装完 MariaDB 数据库之后，我们需要在 MariaDB 数据库中创建 IAM 系统需要的数据库、表和存储过程，以及创建 SQL 语句保存在 IAM 代码仓库中的 configs/iam.sql 文件中。具体的创建步骤如下。</p><ol>\n<li>登录数据库并创建 iam 用户。</li>\n</ol><pre><code>$ cd $IAM_ROOT\n$ mysql -h127.0.0.1 -P3306 -uroot -p'iam59!z$' # 连接 MariaDB，-h 指定主机，-P 指定监听端口，-u 指定登录用户，-p 指定登录密码\nMariaDB [(none)]&gt; grant all on iam.* TO iam@127.0.0.1 identified by 'iam59!z$';\nQuery OK, 0 rows affected (0.000 sec)\nMariaDB [(none)]&gt; flush privileges;\nQuery OK, 0 rows affected (0.000 sec)\n</code></pre><ol start=\"2\">\n<li>用 iam 用户登录 MariaDB，执行 iam.sql 文件，创建 iam 数据库。</li>\n</ol><pre><code>$ mysql -h127.0.0.1 -P3306 -uiam -p'iam59!z$'\nMariaDB [(none)]&gt; source configs/iam.sql;\nMariaDB [iam]&gt; show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| iam                |\n| information_schema |\n+--------------------+\n2 rows in set (0.000 sec)\n</code></pre><p>上面的命令会创建 iam 数据库，并创建以下数据库资源。</p><ul>\n<li>表：user 是用户表，用来存放用户信息；secret 是密钥表，用来存放密钥信息；policy 是策略表，用来存放授权策略信息；policy_audit 是策略历史表，被删除的策略会被转存到该表。</li>\n<li>admin 用户：在 user 表中，我们需要创建一个管理员用户，用户名是 admin，密码是 Admin@2021。</li>\n<li>存储过程：删除用户时会自动删除该用户所属的密钥和策略信息。</li>\n</ul><p><strong>第 2 步，配置 scripts/install/environment.sh。</strong></p><p>IAM 组件的安装配置都是通过环境变量文件 <a href=\"https://github.com/marmotedu/iam/blob/master/scripts/install/environment.sh\">scripts/install/environment.sh</a> 进行配置的，所以我们要先配置好 scripts/install/environment.sh 文件。这里，你可以直接使用默认值，提高你的安装效率。</p><p><strong>第 3 步，创建需要的目录。</strong></p><p>在安装和运行 IAM 系统的时候，我们需要将配置、二进制文件和数据文件存放到指定的目录。所以我们需要先创建好这些目录，创建步骤如下。</p><pre><code>$ cd $IAM_ROOT\n$ source scripts/install/environment.sh\n$ sudo mkdir -p ${IAM_DATA_DIR}/{iam-apiserver,iam-authz-server,iam-pump} # 创建 Systemd WorkingDirectory 目录\n$ sudo mkdir -p ${IAM_INSTALL_DIR}/bin #创建 IAM 系统安装目录\n$ sudo mkdir -p ${IAM_CONFIG_DIR}/cert # 创建 IAM 系统配置文件存放目录\n$ sudo mkdir -p ${IAM_LOG_DIR} # 创建 IAM 日志文件存放目录\n</code></pre><p><strong>第 4 步， 创建 CA 根证书和密钥。</strong></p><p>为了确保安全，IAM 系统各组件需要使用 x509 证书对通信进行加密和认证。所以，这里我们需要先创建 CA 证书。CA 根证书是所有组件共享的，只需要创建一个 CA 证书，后续创建的所有证书都由它签名。</p><p>我们可以使用 CloudFlare 的 PKI 工具集 cfssl 来创建所有的证书。</p><ol>\n<li>安装 cfssl 工具集。</li>\n</ol><p>我们可以直接安装 cfssl 已经编译好的二进制文件，cfssl 工具集中包含很多工具，这里我们需要安装 cfssl、cfssljson、cfssl-certinfo，功能如下。</p><ul>\n<li>cfssl：证书签发工具。</li>\n<li>cfssljson：将 cfssl 生成的证书（json 格式）变为文件承载式证书。</li>\n</ul><p>这两个工具的安装方法如下：</p><pre><code>$ cd $IAM_ROOT\n$ ./scripts/install/install.sh iam::install::install_cfssl\n</code></pre><ol start=\"2\">\n<li>创建配置文件。</li>\n</ol><p>CA 配置文件是用来配置根证书的使用场景 (profile) 和具体参数 (usage、过期时间、服务端认证、客户端认证、加密等)，可以在签名其它证书时用来指定特定场景：</p><pre><code>$ cd $IAM_ROOT\n$ tee ca-config.json &lt;&lt; EOF\n{\n  &quot;signing&quot;: {\n    &quot;default&quot;: {\n      &quot;expiry&quot;: &quot;87600h&quot;\n    },\n    &quot;profiles&quot;: {\n      &quot;iam&quot;: {\n        &quot;usages&quot;: [\n          &quot;signing&quot;,\n          &quot;key encipherment&quot;,\n          &quot;server auth&quot;,\n          &quot;client auth&quot;\n        ],\n        &quot;expiry&quot;: &quot;876000h&quot;\n      }\n    }\n  }\n}\nEOF\n</code></pre><p>上面的 JSON 配置中，有一些字段解释如下。</p><ul>\n<li>signing：表示该证书可用于签名其它证书（生成的 ca.pem 证书中 CA=TRUE）。</li>\n<li>server auth：表示 client 可以用该证书对 server 提供的证书进行验证。</li>\n<li>client auth：表示 server 可以用该证书对 client 提供的证书进行验证。</li>\n<li>expiry：876000h，证书有效期设置为 100 年。</li>\n</ul><ol start=\"3\">\n<li>创建证书签名请求文件。</li>\n</ol><p>我们创建用来生成 CA 证书签名请求（CSR）的 JSON 配置文件：</p><pre><code>$ cd $IAM_ROOT\n$ tee ca-csr.json &lt;&lt; EOF\n{\n  &quot;CN&quot;: &quot;iam-ca&quot;,\n  &quot;key&quot;: {\n    &quot;algo&quot;: &quot;rsa&quot;,\n    &quot;size&quot;: 2048\n  },\n  &quot;names&quot;: [\n    {\n      &quot;C&quot;: &quot;CN&quot;,\n      &quot;ST&quot;: &quot;BeiJing&quot;,\n      &quot;L&quot;: &quot;BeiJing&quot;,\n      &quot;O&quot;: &quot;marmotedu&quot;,\n      &quot;OU&quot;: &quot;iam&quot;\n    }\n  ],\n  &quot;ca&quot;: {\n    &quot;expiry&quot;: &quot;876000h&quot;\n  }\n}\nEOF\n</code></pre><p>上面的 JSON 配置中，有一些字段解释如下。</p><ul>\n<li>C：Country，国家。</li>\n<li>ST：State，省份。</li>\n<li>L：Locality (L) or City，城市。</li>\n<li>CN：Common Name，iam-apiserver 从证书中提取该字段作为请求的用户名 (User Name) ，浏览器使用该字段验证网站是否合法。</li>\n<li>O：Organization，iam-apiserver 从证书中提取该字段作为请求用户所属的组 (Group)。</li>\n<li>OU：Company division (or Organization Unit – OU)，部门/单位。</li>\n</ul><p>除此之外，还有两点需要我们注意。</p><ul>\n<li>不同证书 csr 文件的 CN、C、ST、L、O、OU 组合必须不同，否则可能出现 <code>PEER'S CERTIFICATE HAS AN INVALID SIGNATURE</code> 错误。</li>\n<li>后续创建证书的 csr 文件时，CN、OU都不相同（C、ST、L、O相同），以达到区分的目的。</li>\n</ul><ol start=\"4\">\n<li>创建 CA 证书和私钥</li>\n</ol><p>首先，我们通过 <code>cfssl gencert</code> 命令来创建：</p><pre><code>$ cd $IAM_ROOT\n$ source scripts/install/environment.sh\n$ cfssl gencert -initca ca-csr.json | cfssljson -bare ca\n$ ls ca*\nca-config.json  ca.csr  ca-csr.json  ca-key.pem  ca.pem\n$ sudo mv ca* ${IAM_CONFIG_DIR}/cert # 需要将证书文件拷贝到指定文件夹下（分发证书），方便各组件引用\n</code></pre><p>上述命令会创建运行 CA 所必需的文件 ca-key.pem（私钥）和 ca.pem（证书），还会生成 ca.csr（证书签名请求），用于交叉签名或重新签名。</p><p>创建完之后，我们可以通过 <code>cfssl certinfo</code> 命名查看 cert 和 csr 信息：</p><pre><code>$ cfssl certinfo -cert ${IAM_CONFIG_DIR}/cert/ca.pem # 查看 cert(证书信息)\n$ cfssl certinfo -csr ${IAM_CONFIG_DIR}/cert/ca.csr # 查看 CSR(证书签名请求)信息\n</code></pre><p><strong>第 5 步，配置 hosts。</strong></p><p>iam 通过域名访问 API 接口，因为这些域名没有注册过，还不能在互联网上解析，所以需要配置 hosts，具体的操作如下：</p><pre><code>$ sudo tee -a /etc/hosts &lt;&lt;EOF\n127.0.0.1 iam.api.marmotedu.com\n127.0.0.1 iam.authz.marmotedu.com\nEOF\n</code></pre><h3>安装和配置 iam-apiserver</h3><p>完成了准备工作之后，我们就可以安装 IAM 系统的各个组件了。首先我们通过以下 3 步来安装 iam-apiserver 服务。</p><p><strong>第 1 步，创建 iam-apiserver 证书和私钥。</strong></p><p>其它服务为了安全都是通过 HTTPS 协议访问 iam-apiserver，所以我们要先创建 iam-apiserver 证书和私钥。</p><ol>\n<li>创建证书签名请求：</li>\n</ol><pre><code>$ cd $IAM_ROOT\n$ source scripts/install/environment.sh\n$ tee iam-apiserver-csr.json &lt;&lt;EOF\n{\n  &quot;CN&quot;: &quot;iam-apiserver&quot;,\n  &quot;key&quot;: {\n    &quot;algo&quot;: &quot;rsa&quot;,\n    &quot;size&quot;: 2048\n  },\n  &quot;names&quot;: [\n    {\n      &quot;C&quot;: &quot;CN&quot;,\n      &quot;ST&quot;: &quot;BeiJing&quot;,\n      &quot;L&quot;: &quot;BeiJing&quot;,\n      &quot;O&quot;: &quot;marmotedu&quot;,\n      &quot;OU&quot;: &quot;iam-apiserver&quot;\n    }\n  ],\n  &quot;hosts&quot;: [\n    &quot;127.0.0.1&quot;,\n    &quot;localhost&quot;,\n    &quot;iam.api.marmotedu.com&quot;\n  ]\n}\nEOF\n</code></pre><p>代码中的 hosts 字段是用来指定授权使用该证书的 IP 和域名列表，上面的 hosts 列出了 iam-apiserver 服务的 IP 和域名。</p><ol start=\"2\">\n<li>生成证书和私钥：</li>\n</ol><pre><code>$ cfssl gencert -ca=${IAM_CONFIG_DIR}/cert/ca.pem \\\n  -ca-key=${IAM_CONFIG_DIR}/cert/ca-key.pem \\\n  -config=${IAM_CONFIG_DIR}/cert/ca-config.json \\\n  -profile=iam iam-apiserver-csr.json | cfssljson -bare iam-apiserver\n$ sudo mv iam-apiserver*pem ${IAM_CONFIG_DIR}/cert # 将生成的证书和私钥文件拷贝到配置文件目录\n</code></pre><p><strong>第 2 步，安装并运行 iam-apiserver。</strong></p><p>iam-apiserver 作为 iam 系统的核心组件，需要第一个安装。</p><ol>\n<li>安装 iam-apiserver 可执行程序：</li>\n</ol><pre><code>$ cd $IAM_ROOT\n$ source scripts/install/environment.sh\n$ make build BINS=iam-apiserver\n$ sudo cp _output/platforms/linux/amd64/iam-apiserver ${IAM_INSTALL_DIR}/bin\n</code></pre><ol start=\"2\">\n<li>生成并安装 iam-apiserver 的配置文件（iam-apiserver.yaml）：</li>\n</ol><pre><code>$ ./scripts/genconfig.sh scripts/install/environment.sh configs/iam-apiserver.yaml &gt; iam-apiserver.yaml\n$ sudo mv iam-apiserver.yaml ${IAM_CONFIG_DIR}\n</code></pre><ol start=\"3\">\n<li>创建并安装 iam-apiserver systemd unit 文件：</li>\n</ol><pre><code>$ ./scripts/genconfig.sh scripts/install/environment.sh init/iam-apiserver.service &gt; iam-apiserver.service\n$ sudo mv iam-apiserver.service /etc/systemd/system/\n</code></pre><ol start=\"4\">\n<li>启动 iam-apiserver 服务：</li>\n</ol><pre><code>$ sudo systemctl daemon-reload\n$ sudo systemctl enable iam-apiserver\n$ sudo systemctl restart iam-apiserver\n$ systemctl status iam-apiserver # 查看 iam-apiserver 运行状态，如果输出中包含 active (running)字样说明 iam-apiserver 成功启动\n</code></pre><p><strong>第 3 步，测试 iam-apiserver 是否成功安装。</strong></p><p>测试 iam-apiserver 主要是测试 RESTful 资源的 CURD：用户 CURD、密钥 CURD、授权策略 CURD。</p><p>首先，我们需要获取访问 iam-apiserver 的 Token，请求如下 API 访问：</p><pre><code>$ curl -s -XPOST -H'Content-Type: application/json' -d'{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;Admin@2021&quot;}' http://127.0.0.1:8080/login | jq -r .token\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA\n</code></pre><p>代码中下面的 HTTP 请求通过<code>-H'Authorization: Bearer &lt;Token&gt;'</code> 指定认证头信息，将上面请求的 Token 替换 <code>&lt;Token&gt;</code> 。</p><p><strong>用户 CURD</strong></p><p>创建用户、列出用户、获取用户详细信息、修改用户、删除单个用户、批量删除用户，请求方法如下：</p><pre><code># 创建用户\n$ curl -s -XPOST -H'Content-Type: application/json' -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' -d'{&quot;password&quot;:&quot;User@2021&quot;,&quot;metadata&quot;:{&quot;name&quot;:&quot;colin&quot;},&quot;nickname&quot;:&quot;colin&quot;,&quot;email&quot;:&quot;colin@foxmail.com&quot;,&quot;phone&quot;:&quot;1812884xxxx&quot;}' http://127.0.0.1:8080/v1/users\n\n# 列出用户\n$ curl -s -XGET -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' 'http://127.0.0.1:8080/v1/users?offset=0&amp;limit=10'\n\n# 获取 colin 用户的详细信息\n$ curl -s -XGET -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' http://127.0.0.1:8080/v1/users/colin\n\n# 修改 colin 用户\n$ curl -s -XPUT -H'Content-Type: application/json' -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' -d'{&quot;nickname&quot;:&quot;colin&quot;,&quot;email&quot;:&quot;colin_modified@foxmail.com&quot;,&quot;phone&quot;:&quot;1812884xxxx&quot;}' http://127.0.0.1:8080/v1/users/colin\n\n# 删除 colin 用户\n$ curl -s -XDELETE -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' http://127.0.0.1:8080/v1/users/colin\n\n# 批量删除用户\n$ curl -s -XDELETE -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' 'http://127.0.0.1:8080/v1/users?name=colin&amp;name=mark&amp;name=john'\n</code></pre><p><strong>密钥 CURD</strong></p><p>创建密钥、列出密钥、获取密钥详细信息、修改密钥、删除密钥请求方法如下：</p><pre><code># 创建 secret0 密钥\n$ curl -s -XPOST -H'Content-Type: application/json' -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' -d'{&quot;metadata&quot;:{&quot;name&quot;:&quot;secret0&quot;},&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret&quot;}' http://127.0.0.1:8080/v1/secrets\n\n# 列出所有密钥\n$ curl -s -XGET -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' http://127.0.0.1:8080/v1/secrets\n\n# 获取 secret0 密钥的详细信息\n$ curl -s -XGET -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' http://127.0.0.1:8080/v1/secrets/secret0\n\n# 修改 secret0 密钥\n$ curl -s -XPUT -H'Content-Type: application/json' -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' -d'{&quot;metadata&quot;:{&quot;name&quot;:&quot;secret0&quot;},&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret(modified)&quot;}' http://127.0.0.1:8080/v1/secrets/secret0\n\n# 删除 secret0 密钥\n$ curl -s -XDELETE -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' http://127.0.0.1:8080/v1/secrets/secret0\n</code></pre><p>这里我们要注意，因为密钥属于重要资源，被删除会导致所有的访问请求失败，所以密钥不支持批量删除。</p><p><strong>授权策略 CURD</strong></p><p>创建策略、列出策略、获取策略详细信息、修改策略、删除策略请求方法如下：</p><pre><code># 创建策略\n$ curl -s -XPOST -H'Content-Type: application/json' -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' -d'{&quot;metadata&quot;:{&quot;name&quot;:&quot;policy0&quot;},&quot;policy&quot;:{&quot;description&quot;:&quot;One policy to rule them all.&quot;,&quot;subjects&quot;:[&quot;users:&lt;peter|ken&gt;&quot;,&quot;users:maria&quot;,&quot;groups:admins&quot;],&quot;actions&quot;:[&quot;delete&quot;,&quot;&lt;create|update&gt;&quot;],&quot;effect&quot;:&quot;allow&quot;,&quot;resources&quot;:[&quot;resources:articles:&lt;.*&gt;&quot;,&quot;resources:printer&quot;],&quot;conditions&quot;:{&quot;remoteIPAddress&quot;:{&quot;type&quot;:&quot;CIDRCondition&quot;,&quot;options&quot;:{&quot;cidr&quot;:&quot;192.168.0.1/16&quot;}}}}}' http://127.0.0.1:8080/v1/policies\n\n# 列出所有策略\n$ curl -s -XGET -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' http://127.0.0.1:8080/v1/policies\n\n# 获取 policy0 策略的详细信息\n$ curl -s -XGET -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' http://127.0.0.1:8080/v1/policies/policy0\n\n# 修改 policy0 策略\n$ curl -s -XPUT -H'Content-Type: application/json' -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' -d'{&quot;metadata&quot;:{&quot;name&quot;:&quot;policy0&quot;},&quot;policy&quot;:{&quot;description&quot;:&quot;One policy to rule them all(modified).&quot;,&quot;subjects&quot;:[&quot;users:&lt;peter|ken&gt;&quot;,&quot;users:maria&quot;,&quot;groups:admins&quot;],&quot;actions&quot;:[&quot;delete&quot;,&quot;&lt;create|update&gt;&quot;],&quot;effect&quot;:&quot;allow&quot;,&quot;resources&quot;:[&quot;resources:articles:&lt;.*&gt;&quot;,&quot;resources:printer&quot;],&quot;conditions&quot;:{&quot;remoteIPAddress&quot;:{&quot;type&quot;:&quot;CIDRCondition&quot;,&quot;options&quot;:{&quot;cidr&quot;:&quot;192.168.0.1/16&quot;}}}}}' http://127.0.0.1:8080/v1/policies/policy0\n\n# 删除 policy0 策略\n$ curl -s -XDELETE -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MTc5MjI4OTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MTc4MzY0OTQsInN1YiI6ImFkbWluIn0.9qztVJseQ9XwqOFVUHNOtG96-KUovndz0SSr_QBsxAA' http://127.0.0.1:8080/v1/policies/policy0\n\n</code></pre><h3>安装 iamctl</h3><p>上面，我们安装了 iam 系统的 API 服务。但是想要访问 iam 服务，我们还需要安装客户端工具 iamctl。具体来说，我们可以通过 3 步完成 iamctl 的安装和配置。</p><p><strong>第 1 步，创建 iamctl 证书和私钥。</strong></p><p>iamctl 使用 https 协议与 iam-apiserver 进行安全通信，iam-apiserver 对 iamctl 请求包含的证书进行认证和授权。iamctl 后续用于 iam 系统访问和管理，所以这里创建具有最高权限的 admin 证书。</p><ol>\n<li>创建证书签名请求。</li>\n</ol><p>下面创建的证书只会被 iamctl 当作 client 证书使用，所以 hosts 字段为空。代码如下：</p><pre><code>$ cd $IAM_ROOT\n$ source scripts/install/environment.sh\n$ cat &gt; admin-csr.json &lt;&lt;EOF\n{\n  &quot;CN&quot;: &quot;admin&quot;,\n  &quot;key&quot;: {\n    &quot;algo&quot;: &quot;rsa&quot;,\n    &quot;size&quot;: 2048\n  },\n  &quot;names&quot;: [\n    {\n      &quot;C&quot;: &quot;CN&quot;,\n      &quot;ST&quot;: &quot;BeiJing&quot;,\n      &quot;L&quot;: &quot;BeiJing&quot;,\n      &quot;O&quot;: &quot;marmotedu&quot;,\n      &quot;OU&quot;: &quot;iamctl&quot;\n    }\n  ],\n  &quot;hosts&quot;: []\n}\nEOF\n</code></pre><ol start=\"2\">\n<li>生成证书和私钥：</li>\n</ol><pre><code>$ cfssl gencert -ca=${IAM_CONFIG_DIR}/cert/ca.pem \\\n  -ca-key=${IAM_CONFIG_DIR}/cert/ca-key.pem \\\n  -config=${IAM_CONFIG_DIR}/cert/ca-config.json \\\n  -profile=iam admin-csr.json | cfssljson -bare admin\n$ mkdir -p $(dirname ${CONFIG_USER_CLIENT_CERTIFICATE}) $(dirname ${CONFIG_USER_CLIENT_KEY}) # 创建客户端证书存放的目录\n$ mv admin.pem ${CONFIG_USER_CLIENT_CERTIFICATE} # 安装 TLS 的客户端证书\n$ mv admin-key.pem ${CONFIG_USER_CLIENT_KEY} # 安装 TLS 的客户端私钥文件\n</code></pre><p><strong>第 2 步，安装 iamctl。</strong></p><p>iamctl 是 IAM 系统的客户端工具，其安装位置和 iam-apiserver、iam-authz-server、iam-pump 位置不同，为了能够在 shell 下直接运行 iamctl 命令，我们需要将 iamctl 安装到<code>$HOME/bin</code> 下，同时将 iamctl 的配置存放在默认加载的目录下：<code>$HOME/.iam</code>。主要分 2 步进行。</p><ol>\n<li>安装 iamctl 可执行程序：</li>\n</ol><pre><code>$ cd $IAM_ROOT\n$ source scripts/install/environment.sh\n$ make build BINS=iamctl\n$ cp _output/platforms/linux/amd64/iamctl $HOME/bin\n\n</code></pre><ol start=\"2\">\n<li>生成并安装 iamctl 的配置文件（iamctl.yaml）：</li>\n</ol><pre><code>$ ./scripts/genconfig.sh scripts/install/environment.sh configs/iamctl.yaml&gt; iamctl.yaml\n$ mkdir -p $HOME/.iam\n$ mv iamctl.yaml $HOME/.iam\n</code></pre><p>因为 iamctl 是一个客户端工具，可能会在多台机器上运行。为了简化部署 iamctl 工具的复杂度，我们可以把 config 配置文件中跟 CA 认证相关的 CA 文件内容用 base64 加密后，放置在 config 配置文件中。具体的思路就是把 config 文件中的配置项 client-certificate、client-key、certificate-authority 分别用如下配置项替换 client-certificate-data、client-key-data、certificate-authority-data。这些配置项的值可以通过对 CA 文件使用 base64 加密获得。</p><p>假如，<code>certificate-authority</code> 值为<code>/etc/iam/cert/ca.pem</code>，则 <code>certificate-authority-data</code> 的值为 <code>cat \"/etc/iam/cert/ca.pem\" | base64 | tr -d '\\r\\n'</code>，其它<code>-data</code> 变量的值类似。这样当我们再部署 iamctl 工具时，只需要拷贝 iamctl 和配置文件，而不用再拷贝 CA 文件了。</p><p><strong>第 3 步，测试 iamctl 是否成功安装。</strong></p><p>执行 <code>iamctl user list</code> 可以列出预创建的 admin 用户，如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/3f/17/3f24e2f6ddd12aae99cd62de5b037d17.png?wh=1920*152\" alt=\"\"></p><h3>安装和配置 iam-authz-server</h3><p>接下来，我们需要安装另外一个核心组件：iam-authz-server，可以通过以下 3 步来安装。</p><p><strong>第 1 步，创建 iam-authz-server 证书和私钥。</strong></p><ol>\n<li>创建证书签名请求：</li>\n</ol><pre><code>$ cd $IAM_ROOT\n$ source scripts/install/environment.sh\n$ tee iam-authz-server-csr.json &lt;&lt;EOF\n{\n  &quot;CN&quot;: &quot;iam-authz-server&quot;,\n  &quot;key&quot;: {\n    &quot;algo&quot;: &quot;rsa&quot;,\n    &quot;size&quot;: 2048\n  },\n  &quot;names&quot;: [\n    {\n      &quot;C&quot;: &quot;CN&quot;,\n      &quot;ST&quot;: &quot;BeiJing&quot;,\n      &quot;L&quot;: &quot;BeiJing&quot;,\n      &quot;O&quot;: &quot;marmotedu&quot;,\n      &quot;OU&quot;: &quot;iam-authz-server&quot;\n    }\n  ],\n  &quot;hosts&quot;: [\n    &quot;127.0.0.1&quot;,\n    &quot;localhost&quot;,\n    &quot;iam.authz.marmotedu.com&quot;\n  ]\n}\nEOF\n</code></pre><p>代码中的 hosts 字段指定授权使用该证书的 IP 和域名列表，上面的hosts列出了 iam-authz-server 服务的 IP 和域名。</p><ol start=\"2\">\n<li>生成证书和私钥：</li>\n</ol><pre><code>$ cfssl gencert -ca=${IAM_CONFIG_DIR}/cert/ca.pem \\\n  -ca-key=${IAM_CONFIG_DIR}/cert/ca-key.pem \\\n  -config=${IAM_CONFIG_DIR}/cert/ca-config.json \\\n  -profile=iam iam-authz-server-csr.json | cfssljson -bare iam-authz-server\n$ sudo mv iam-authz-server*pem ${IAM_CONFIG_DIR}/cert # 将生成的证书和私钥文件拷贝到配置文件目录\n</code></pre><p><strong>第 2 步，安装并运行 iam-authz-server。</strong></p><p>安装 iam-authz-server 步骤和安装 iam-apiserver 步骤基本一样，也需要 4 步。</p><ol>\n<li>安装 iam-authz-server 可执行程序：</li>\n</ol><pre><code>$ cd $IAM_ROOT\n$ source scripts/install/environment.sh\n$ make build BINS=iam-authz-server\n$ sudo cp _output/platforms/linux/amd64/iam-authz-server ${IAM_INSTALL_DIR}/bin\n\n</code></pre><ol start=\"2\">\n<li>生成并安装 iam-authz-server 的配置文件（iam-authz-server.yaml）：</li>\n</ol><pre><code>$ ./scripts/genconfig.sh scripts/install/environment.sh configs/iam-authz-server.yaml &gt; iam-authz-server.yaml\n$ sudo mv iam-authz-server.yaml ${IAM_CONFIG_DIR}\n</code></pre><ol start=\"3\">\n<li>创建并安装 iam-authz-server systemd unit 文件：</li>\n</ol><pre><code>$ ./scripts/genconfig.sh scripts/install/environment.sh init/iam-authz-server.service &gt; iam-authz-server.service\n$ sudo mv iam-authz-server.service /etc/systemd/system/\n</code></pre><ol start=\"4\">\n<li>启动 iam-authz-server 服务：</li>\n</ol><pre><code>$ sudo systemctl daemon-reload\n$ sudo systemctl enable iam-authz-server\n$ sudo systemctl restart iam-authz-server\n$ systemctl status iam-authz-server # 查看 iam-authz-server 运行状态，如果输出中包含 active (running)字样说明 iam-authz-server 成功启动。\n</code></pre><p><strong>第 3 步，测试 iam-authz-server 是否成功安装。</strong></p><ol>\n<li>重新登陆系统，并获取访问令牌</li>\n</ol><pre><code>$ token=`curl -s -XPOST -H'Content-Type: application/json' -d'{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;Admin@2021&quot;}' http://127.0.0.1:8080/login | jq -r .token`\n</code></pre><ol start=\"2\">\n<li>创建授权策略</li>\n</ol><pre><code>$ curl -s -XPOST -H&quot;Content-Type: application/json&quot; -H&quot;Authorization: Bearer $token&quot; -d'{&quot;metadata&quot;:{&quot;name&quot;:&quot;authztest&quot;},&quot;policy&quot;:{&quot;description&quot;:&quot;One policy to rule them all.&quot;,&quot;subjects&quot;:[&quot;users:&lt;peter|ken&gt;&quot;,&quot;users:maria&quot;,&quot;groups:admins&quot;],&quot;actions&quot;:[&quot;delete&quot;,&quot;&lt;create|update&gt;&quot;],&quot;effect&quot;:&quot;allow&quot;,&quot;resources&quot;:[&quot;resources:articles:&lt;.*&gt;&quot;,&quot;resources:printer&quot;],&quot;conditions&quot;:{&quot;remoteIPAddress&quot;:{&quot;type&quot;:&quot;CIDRCondition&quot;,&quot;options&quot;:{&quot;cidr&quot;:&quot;192.168.0.1/16&quot;}}}}}' http://127.0.0.1:8080/v1/policies\n</code></pre><ol start=\"3\">\n<li>创建密钥，并从命令的输出中提取secretID 和 secretKey</li>\n</ol><pre><code>$ curl -s -XPOST -H&quot;Content-Type: application/json&quot; -H&quot;Authorization: Bearer $token&quot; -d'{&quot;metadata&quot;:{&quot;name&quot;:&quot;authztest&quot;},&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret&quot;}' http://127.0.0.1:8080/v1/secrets\n{&quot;metadata&quot;:{&quot;id&quot;:23,&quot;name&quot;:&quot;authztest&quot;,&quot;createdAt&quot;:&quot;2021-04-08T07:24:50.071671422+08:00&quot;,&quot;updatedAt&quot;:&quot;2021-04-08T07:24:50.071671422+08:00&quot;},&quot;username&quot;:&quot;admin&quot;,&quot;secretID&quot;:&quot;ZuxvXNfG08BdEMqkTaP41L2DLArlE6Jpqoox&quot;,&quot;secretKey&quot;:&quot;7Sfa5EfAPIwcTLGCfSvqLf0zZGCjF3l8&quot;,&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret&quot;}\n</code></pre><ol start=\"4\">\n<li>生成访问 iam-authz-server 的 token</li>\n</ol><p>iamctl 提供了 <code>jwt sigin</code> 命令，可以根据 secretID 和 secretKey 签发 Token，方便你使用。</p><pre><code>$ iamctl jwt sign ZuxvXNfG08BdEMqkTaP41L2DLArlE6Jpqoox 7Sfa5EfAPIwcTLGCfSvqLf0zZGCjF3l8 # iamctl jwt sign $secretID $secretKey，替换成上一步创建的密钥对\neyJhbGciOiJIUzI1NiIsImtpZCI6Ilp1eHZYTmZHMDhCZEVNcWtUYVA0MUwyRExBcmxFNkpwcW9veCIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYxNzg0NTE5NSwiaWF0IjoxNjE3ODM3OTk1LCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MTc4Mzc5OTV9.za9yLM7lHVabPAlVQLCqXEaf8sTU6sodAsMXnmpXjMQ\n</code></pre><p>如果你的开发过程中有些重复性的操作，为了方便使用，也可以将这些操作以iamctl子命令的方式集成到iamctl命令行中。</p><ol start=\"5\">\n<li>测试资源授权是否通过</li>\n</ol><p>我们可以通过请求 <code>/v1/authz</code> 来完成资源授权：</p><pre><code>$ curl -s -XPOST -H'Content-Type: application/json' -H'Authorization: Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6Ilp1eHZYTmZHMDhCZEVNcWtUYVA0MUwyRExBcmxFNkpwcW9veCIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYxNzg0NTE5NSwiaWF0IjoxNjE3ODM3OTk1LCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MTc4Mzc5OTV9.za9yLM7lHVabPAlVQLCqXEaf8sTU6sodAsMXnmpXjMQ' -d'{&quot;subject&quot;:&quot;users:maria&quot;,&quot;action&quot;:&quot;delete&quot;,&quot;resource&quot;:&quot;resources:articles:ladon-introduction&quot;,&quot;context&quot;:{&quot;remoteIPAddress&quot;:&quot;192.168.0.5&quot;}}' http://127.0.0.1:9090/v1/authz\n{&quot;allowed&quot;:true}\n</code></pre><p>如果授权通过会返回：<code>{\"allowed\":true}</code> 。</p><h3>安装和配置 iam-pump</h3><p>安装 iam-pump 步骤和安装 iam-apiserver、iam-authz-server 步骤基本一样，具体步骤如下。</p><p><strong>第 1 步，安装 iam-pump 可执行程序。</strong></p><pre><code>$ cd $IAM_ROOT\n$ source scripts/install/environment.sh\n$ make build BINS=iam-pump\n$ sudo cp _output/platforms/linux/amd64/iam-pump ${IAM_INSTALL_DIR}/bin\n</code></pre><p><strong>第 2 步，生成并安装 iam-pump 的配置文件（iam-pump.yaml）。</strong></p><pre><code>$ ./scripts/genconfig.sh scripts/install/environment.sh configs/iam-pump.yaml &gt; iam-pump.yaml\n$ sudo mv iam-pump.yaml ${IAM_CONFIG_DIR}\n</code></pre><p><strong>第 3 步，创建并安装 iam-pump systemd unit 文件。</strong></p><pre><code>$ ./scripts/genconfig.sh scripts/install/environment.sh init/iam-pump.service &gt; iam-pump.service\n$ sudo mv iam-pump.service /etc/systemd/system/\n</code></pre><p><strong>第 4 步，启动 iam-pump 服务。</strong></p><pre><code>$ sudo systemctl daemon-reload\n$ sudo systemctl enable iam-pump\n$ sudo systemctl restart iam-pump\n$ systemctl status iam-pump # 查看 iam-pump 运行状态，如果输出中包含 active (running)字样说明 iam-pump 成功启动。\n</code></pre><p><strong>第 5 步，测试 iam-pump 是否成功安装。</strong></p><pre><code>$ curl http://127.0.0.1:7070/healthz\n{&quot;status&quot;: &quot;ok&quot;}\n</code></pre><p>经过上面这  5  个步骤，如果返回 <strong>{“status”: “ok”}</strong>  就说明 iam-pump 服务健康。</p><h2>安装 man 文件</h2><p>IAM 系统通过组合调用包：<code>github.com/cpuguy83/go-md2man/v2/md2man</code> 和 <code>github.com/spf13/cobra</code> 的相关函数生成了各个组件的 man1 文件，主要分 3 步实现。</p><p><strong>第 1 步，生成各个组件的 man1 文件。</strong></p><pre><code>$ cd $IAM_ROOT\n$ ./scripts/update-generated-docs.sh\n</code></pre><p><strong>第 2 步，安装生成的 man1 文件。</strong></p><pre><code>$ sudo cp docs/man/man1/* /usr/share/man/man1/\n</code></pre><p><strong>第 3 步，检查是否成功安装 man1 文件。</strong></p><pre><code>$ man iam-apiserver\n</code></pre><p>执行 <code>man iam-apiserver</code> 命令后，会弹出 man 文档界面，如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/a7/37/a7415f8a7ea08302067ccc93c2cab437.png?wh=1796*423\" alt=\"\"></p><p>至此，IAM 系统所有组件都已经安装成功了，你可以通过 <code>iamctl version</code> 查看客户端和服务端版本，代码如下：</p><pre><code>$ iamctl version -o yaml\nclientVersion:\n  buildDate: &quot;2021-04-08T01:56:20Z&quot;\n  compiler: gc\n  gitCommit: 1d682b0317396347b568a3ef366c1c54b3b0186b\n  gitTreeState: dirty\n  gitVersion: v0.6.1-5-g1d682b0\n  goVersion: go1.16.2\n  platform: linux/amd64\nserverVersion:\n  buildDate: &quot;2021-04-07T22:30:53Z&quot;\n  compiler: gc\n  gitCommit: bde163964b8c004ebb20ca4abd8a2ac0cd1f71ad\n  gitTreeState: dirty\n  gitVersion: bde1639\n  goVersion: go1.16.2\n  platform: linux/amd64\n\n</code></pre><h2>总结</h2><p>这一讲，我带你一步一步安装了 IAM 应用，完成安装的同时，也希望能加深你对 IAM 应用的理解，并为后面的实战准备好环境。为了更清晰地展示安装流程，这里我把整个安装步骤梳理成了一张脑图，你可以看看。</p><p><img src=\"https://static001.geekbang.org/resource/image/76/23/7688d7cdf5050dc3f3f839150b5e2723.jpg?wh=2905x1968\" alt=\"\"></p><p>此外，我还有一点想提醒你，我们今天讲到的所有组件设置的密码都是 <strong>iam59!z$</strong>，你一定要记住啦。</p><h2>课后练习</h2><p>请你试着调用 iam-apiserver 提供的 API 接口创建一个用户：<code>xuezhang</code>，并在该用户下创建 policy 和 secret 资源。最后调用 iam-authz-server 提供的<code>/v1/authz</code> 接口进行资源鉴权。如果有什么有趣的发现，记得分享出来。</p><p>期待在留言区看到你的尝试，我们下一讲见！</p><hr><h2>彩蛋：一键安装</h2><p>如果学完了<a href=\"https://time.geekbang.org/column/article/378076\">第02讲</a>，你可以直接执行如下脚本，来完成 IAM 系统的安装：</p><pre><code>$ export LINUX_PASSWORD='iam59!z$' # 重要：这里要 export going 用户的密码\n$ version=latest &amp;&amp; curl https://marmotedu-1254073058.cos.ap-beijing.myqcloud.com/iam-release/${version}/iam.tar.gz | tar -xz -C / tmp/       \n$ cd /tmp/iam/ &amp;&amp; ./scripts/install/install.sh iam::install::install\n\n</code></pre><p>此外，你也可以参考 <a href=\"https://github.com/marmotedu/iam/tree/master/docs/guide/zh-CN/installation/README.md\">IAM 部署指南</a> 教程进行安装，这个安装手册可以让你在创建完普通用户后，一键部署整个 IAM 系统，包括实战环境和 IAM 服务。</p>","comments":[{"had_liked":false,"id":294818,"user_name":"Q","can_delete":false,"product_type":"c1","uid":1047423,"ip_address":"","ucode":"785546C617D3DF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fb/7f/746a6f5e.jpg","comment_is_top":true,"comment_ctime":1622101419,"is_pvip":false,"replies":[{"id":"107036","content":"感谢Q哥的反馈。<br><br>这个报错最新的master分支和v1.0.0版本已经修复了。<br><br>已经安装的同学可以通过以下操作来修复下：<br>$ git clone --depth=1 https:&#47;&#47;github.com&#47;marmotedu&#47;iam<br>$ mysql -h127.0.0.1 -uiam -p<br><br>登陆mysql之后执行：<br>&gt; drop database iam;<br>&gt; source iam&#47;config&#47;iam.sql<br><br>通过以上步骤就可以。<br>这里失败的原因是，user, secret, policy表中少了一个字段：instanceID。","user_name":"作者回复","comment_id":294818,"uid":"1167883","ip_address":"","utype":1,"ctime":1622116073,"user_name_real":"CK1.0"}],"discussion_count":5,"race_medal":0,"score":"9.2233720599517e+18","product_id":100079601,"comment_content":"---用户名和密码有错---<br>$ curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -d &#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;Admin@2021&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;login<br>{&quot;message&quot;:&quot;incorrect Username or Password&quot;}<br>----<br>2021-05-27 15:36:32.340\tINFO\tgorm@v1.21.4&#47;callbacks.go:124\tmysql&#47;user.go:69 ReadMapCB: expect { or n, but found , error found in #0 byte of ...||..., bigger context ...||...[1.701ms] [rows:1] SELECT * FROM `user` WHERE name = &#39;admin&#39; ORDER BY `user`.`id` LIMIT 1<br>2021-05-27 15:36:32.340\tERROR\tapiserver&#47;auth.go:146\tget user information failed: ReadMapCB: expect { or n, but found , error found in #0 byte of ...||..., bigger context ...||...<br>2021-05-27 15:36:32.341\tINFO\tmiddleware&#47;logger.go:135\t401 - [127.0.0.1] &quot;2.055136ms POST &#47;login&quot; \t{&quot;requestID&quot;: &quot;c4bdae71-6fb4-4a74-9730-06102f5e4e0e&quot;, &quot;username&quot;: &quot;&quot;}","like_count":5,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520823,"discussion_content":"感谢Q哥的反馈。\n\n这个报错最新的master分支和v1.0.0版本已经修复了。\n\n已经安装的同学可以通过以下操作来修复下：\n$ git clone --depth=1 https://github.com/marmotedu/iam\n$ mysql -h127.0.0.1 -uiam -p\n\n登陆mysql之后执行：\n&amp;gt; drop database iam;\n&amp;gt; source iam/config/iam.sql\n\n通过以上步骤就可以。\n这里失败的原因是，user, secret, policy表中少了一个字段：instanceID。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622116073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376480,"discussion_content":"source iam/configs/iam.sql 哈，少些了个s，大家注意下~","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1622160416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1200704,"avatar":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","nickname":"pedro","note":"","ucode":"F40C839DDFD599","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376410,"discussion_content":"我估计是 mariadb 数据返回格式与 MySQL 不兼容，导致解析失败，从而报错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622113358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1200704,"avatar":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","nickname":"pedro","note":"","ucode":"F40C839DDFD599","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376379,"discussion_content":"我也是这个地方的问题，不是用户名、密码错误，而是 reflect 出现了问题，见报错信息是 ReadMapCB，调了半天也没有解决，差点劝退","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622102331,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1047423,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fb/7f/746a6f5e.jpg","nickname":"Q","note":"","ucode":"785546C617D3DF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1200704,"avatar":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","nickname":"pedro","note":"","ucode":"F40C839DDFD599","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376380,"discussion_content":"那得等老师答复了，估计老师还在写代码吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622102731,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":376379,"ip_address":""},"score":376380,"extra":""}]}]},{"had_liked":false,"id":324252,"user_name":"越努力丨越幸运","can_delete":false,"product_type":"c1","uid":1302603,"ip_address":"","ucode":"1E11FA1A2AFA9E","user_header":"https://static001.geekbang.org/account/avatar/00/13/e0/4b/bbb48b22.jpg","comment_is_top":false,"comment_ctime":1638349194,"is_pvip":false,"replies":[{"id":"117700","content":"加油！！","user_name":"作者回复","comment_id":324252,"uid":"1167883","ip_address":"","utype":1,"ctime":1638363523,"user_name_real":"编辑"}],"discussion_count":4,"race_medal":0,"score":"57472924042","product_id":100079601,"comment_content":"老师讲的真的很细致，按照老师的教程基本没什么问题，我自己是在 docker 容器中部署的，我把项目部署好的容器打包上传了，有需要的同学可以直接拉下来用（docker pull mjcjm&#47;centos-go-project），启动参数一定要用：docker run -tid --name 容器名称 -v &#47;sys&#47;fs&#47;cgroup:&#47;sys&#47;fs&#47;cgroup  --privileged=true 镜像id &#47;usr&#47;sbin&#47;init。 最后继续加油💪🏻，冲冲冲！","like_count":13,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535185,"discussion_content":"加油！！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638363523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2008023,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/a3/d7/59a98619.jpg","nickname":"快乐呀！","note":"","ucode":"68A6A0EA4469A5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587931,"discussion_content":"镜像地址： https://hub.docker.com/r/mjcjm/centos-go-project/tags\ndocker pull mjcjm/centos-go-project:v1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1663395735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3177960,"avatar":"https://static001.geekbang.org/account/avatar/00/30/7d/e8/791d0f5e.jpg","nickname":"唐经","note":"","ucode":"C54F49F5AF414E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":587250,"discussion_content":"我被分了arm架构的镜像 等我放出来","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662906974,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1254562,"avatar":"https://static001.geekbang.org/account/avatar/00/13/24/a2/d61e4e28.jpg","nickname":"jack","note":"","ucode":"040741A40A47B9","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586738,"discussion_content":"膜拜大佬，要的就是这个镜像","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662470304,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351657,"user_name":"哇哈哈","can_delete":false,"product_type":"c1","uid":1175537,"ip_address":"","ucode":"47453D1C96A1DD","user_header":"https://static001.geekbang.org/account/avatar/00/11/ef/f1/8b06801a.jpg","comment_is_top":false,"comment_ctime":1658056213,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"31722827285","product_id":100079601,"comment_content":"在执行“make build BINS=iam-apiserver” 的时候报错了，麻烦老师看一下<br>===========&gt; Building binary iam-apiserver 132d18e for linux amd64<br>no required module provides package github.com&#47;marmotedu&#47;iam&#47;cmd&#47;iam-apiserver: go.mod file not found in current directory or any parent directory; see &#39;go help modules&#39;<br>make[1]: *** [scripts&#47;make-rules&#47;golang.mk:60: go.build.linux_amd64.iam-apiserver] Error 1<br>make: *** [Makefile:62: build] Error 2","like_count":7,"discussions":[{"author":{"id":1115465,"avatar":"https://static001.geekbang.org/account/avatar/00/11/05/49/11b69b1f.jpg","nickname":"GeXeLr","note":"","ucode":"9FE5463B240C35","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590708,"discussion_content":"执行go work use ./iam，然后就好了，可能是配置的workspace目录失效导致的报错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1666019491,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1078973,"avatar":"https://static001.geekbang.org/account/avatar/00/10/76/bd/48c3eece.jpg","nickname":"朦喳喳","note":"","ucode":"8B07F9202D2BF2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":582748,"discussion_content":"同报错，请问这里怎么修改？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659627022,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3048349,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/83/9d/57cdc461.jpg","nickname":"SquatCobbler","note":"","ucode":"D9476BBD0EDCD9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581161,"discussion_content":"同，卡在这里了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658561512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2832633,"avatar":"","nickname":"Geek_3267a8","note":"","ucode":"1C4037A7239AD0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580880,"discussion_content":"同学请问你发现怎么修改了吗 我也报错了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658393475,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349744,"user_name":"真想","can_delete":false,"product_type":"c1","uid":3010433,"ip_address":"","ucode":"095B00CB2FD33A","user_header":"https://static001.geekbang.org/account/avatar/00/2d/ef/81/b411e863.jpg","comment_is_top":false,"comment_ctime":1656300653,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31721071725","product_id":100079601,"comment_content":"配置环境劝退   折腾了很久 最终放弃了  希望能简化配置流程   把重心放在开发实战 而不是环境实战 ","like_count":7},{"had_liked":false,"id":299143,"user_name":"garlic","can_delete":false,"product_type":"c1","uid":1019579,"ip_address":"","ucode":"FEB147EDB5774E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/bb/c039dc11.jpg","comment_is_top":false,"comment_ctime":1624493076,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"31689264148","product_id":100079601,"comment_content":"创建用户：密码复杂度要求还是比较高， 需要大小写字母特殊字符加数字8位以上，否则报错&quot;code&quot;:100004,&quot;message&quot;:&quot;Validation failed&quot;}， 与 policy不同secret资源没有指定用户。","like_count":7},{"had_liked":false,"id":295071,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1622204797,"is_pvip":false,"replies":[{"id":"107222","content":"学习最高效的方式是，发现问题，解决问题。老哥一定收货了很多，另外文档中的坑，今后我也会努力避免!","user_name":"作者回复","comment_id":295071,"uid":"1167883","ip_address":"","utype":1,"ctime":1622435394,"user_name_real":"CK1.0"}],"discussion_count":2,"race_medal":0,"score":"31686975869","product_id":100079601,"comment_content":"不容易啊，经过了三天，期间换了一次操作系统（从centos7 到 centos8），换了一次电脑（从低配云主机到本地虚拟机），踩了无数次坑，遇到了 n 多问题，终于按照本节步骤实打实的跑出来了，期间还为了 ReadMapCB 的问题翻了半天的源代码，虽然没有找到问题所在，但是也大致读懂了项目结构和作用，一把辛酸泪，终究得到了如下收获：<br>```<br>iamctl version -o yaml<br>clientVersion:<br>  buildDate: &quot;2021-05-28T11:57:56Z&quot;<br>  compiler: gc<br>  gitCommit: fb0a7b4ee5d497e7b1707fb5251d844d8538c5d8<br>  gitTreeState: dirty<br>  gitVersion: fb0a7b4<br>  goVersion: go1.16.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2021-05-28T11:12:56Z&quot;<br>  compiler: gc<br>  gitCommit: fb0a7b4ee5d497e7b1707fb5251d844d8538c5d8<br>  gitTreeState: dirty<br>  gitVersion: fb0a7b4<br>  goVersion: go1.16.2<br>  platform: linux&#47;amd64<br>```","like_count":7,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520935,"discussion_content":"学习最高效的方式是，发现问题，解决问题。老哥一定收货了很多，另外文档中的坑，今后我也会努力避免!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1200704,"avatar":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","nickname":"pedro","note":"","ucode":"F40C839DDFD599","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376961,"discussion_content":"别老哥，我过段时间就毕业入职鹅厂了，跟孔老师一个BG，以后多多照顾🤣","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1622438586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297371,"user_name":"单推dd","can_delete":false,"product_type":"c1","uid":1866351,"ip_address":"","ucode":"A114AA91B5D7C9","user_header":"https://static001.geekbang.org/account/avatar/00/1c/7a/6f/db08c945.jpg","comment_is_top":false,"comment_ctime":1623489098,"is_pvip":true,"replies":[{"id":"108013","content":"机智的boy","user_name":"作者回复","comment_id":297371,"uid":"1167883","ip_address":"","utype":1,"ctime":1623582394,"user_name_real":"CK1.0"}],"discussion_count":4,"race_medal":0,"score":"27393292874","product_id":100079601,"comment_content":"在启动iam-authz-server服务的时候一直启动不起来，然后我通过日志发现他用的端口是9090，正好和我阿里云服务器的web界面管理工具cockpit用的一样，所以用了sudo systemctl stop cockpit.socket命令，让9090端口空出来，成功启动iam-authz-server服务。","like_count":6,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521811,"discussion_content":"机智的boy","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582394,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1313498,"avatar":"https://static001.geekbang.org/account/avatar/00/14/0a/da/dcf8f2b1.jpg","nickname":"qiutian","note":"","ucode":"99658A8E342498","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575822,"discussion_content":"我也碰到了这个问题：发现是要替换生成的信息，有两次：一个是iamctl jwt sign $secretID $secretKey  另一个是：-H&#39;Authorization: Bearer&lt;Token&gt;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655125115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2725464,"avatar":"https://static001.geekbang.org/account/avatar/00/29/96/58/b91503e7.jpg","nickname":"forever_ele","note":"","ucode":"CBC4ADD1763607","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387257,"discussion_content":"sudo vi /usr/lib/systemd/system/cockpit.socket 把端口号改掉就好啦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628074778,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2725464,"avatar":"https://static001.geekbang.org/account/avatar/00/29/96/58/b91503e7.jpg","nickname":"forever_ele","note":"","ucode":"CBC4ADD1763607","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387255,"discussion_content":"同样问题哈~~握爪","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628074533,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295812,"user_name":"Aliliin","can_delete":false,"product_type":"c1","uid":1025239,"ip_address":"","ucode":"61F9A09BB6650F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/d7/5d2bfaa7.jpg","comment_is_top":false,"comment_ctime":1622605673,"is_pvip":false,"replies":[{"id":"107417","content":"可以的，学习项目最好得方式是看源码","user_name":"作者回复","comment_id":295812,"uid":"1167883","ip_address":"","utype":1,"ctime":1622676891,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"27392409449","product_id":100079601,"comment_content":"经过一上午的奋战总算是搭建完了，我在想就这样子的项目，入职一家新公司，如果没有文档，大佬级别的人物能在本地运行起来进行开发吗？<br><br>iamctl version -o yaml<br>clientVersion:<br>  buildDate: &quot;2021-06-02T03:23:02Z&quot;<br>  compiler: gc<br>  gitCommit: c01dd7bc7ee8aa2c06b9b70e565dff9f5e13e5ce<br>  gitTreeState: dirty<br>  gitVersion: c01dd7b<br>  goVersion: go1.16.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2021-06-02T03:13:04Z&quot;<br>  compiler: gc<br>  gitCommit: c01dd7bc7ee8aa2c06b9b70e565dff9f5e13e5ce<br>  gitTreeState: dirty<br>  gitVersion: c01dd7b<br>  goVersion: go1.16.2<br>  platform: linux&#47;amd64","like_count":6,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521227,"discussion_content":"可以的，学习项目最好得方式是看源码","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622676891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307832,"user_name":"chinandy","can_delete":false,"product_type":"c1","uid":2737221,"ip_address":"","ucode":"396E8478BB0393","user_header":"https://static001.geekbang.org/account/avatar/00/29/c4/45/88287ede.jpg","comment_is_top":false,"comment_ctime":1629275035,"is_pvip":false,"replies":[{"id":"112026","content":"你用的是最新的master分支吧，master分支中把config改成了iamctl.yaml了。<br><br>你可以使用v1.0.8版本。","user_name":"作者回复","comment_id":307832,"uid":"1167883","ip_address":"","utype":1,"ctime":1630113373,"user_name_real":"CK1.0"}],"discussion_count":5,"race_medal":0,"score":"23104111515","product_id":100079601,"comment_content":"安装 iamctl。第二步生成并安装 iamctl 的配置文件（config）：$ .&#47;scripts&#47;genconfig.sh scripts&#47;install&#47;environment.sh configs&#47;config &gt; config<br>在configs下面没有config文件，这个文件是怎么来的，我自己touch了一个显然不对的，我打开看.iam目录下看他是空的。","like_count":5,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525308,"discussion_content":"你用的是最新的master分支吧，master分支中把config改成了iamctl.yaml了。\n\n你可以使用v1.0.8版本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630113373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1600709,"avatar":"","nickname":"Geek_ec7115","note":"","ucode":"8E6D5E6ED96C86","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390526,"discussion_content":" ./scripts/genconfig.sh scripts/install/environment.sh configs/iamctl.yaml > iamctl","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1629875711,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1069133,"avatar":"https://static001.geekbang.org/account/avatar/00/10/50/4d/db91e218.jpg","nickname":"sam700000","note":"","ucode":"C2ABDDC56B2D50","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394932,"discussion_content":"还好有人问了，不然还要去看仓库之前的版本","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1632132329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1485107,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEK5LqjpiajvBgW7QmRiamBXcFCTibicZibA39ZCCZh9YR4emjVBIY1EOpcJC9ZNW5Snz5QUmSfXeT38pww/132","nickname":"lysch","note":"","ucode":"5CACF6E4857E05","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390390,"discussion_content":"应该是代码最新版本和这个安装教程已经不匹配了。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1629813458,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1628191,"avatar":"https://static001.geekbang.org/account/avatar/00/18/d8/1f/2f546401.jpg","nickname":"小李","note":"","ucode":"DFD609453906F2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390359,"discussion_content":"我也遇到这个问题了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629798584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296634,"user_name":"Ransang","can_delete":false,"product_type":"c1","uid":1133041,"ip_address":"","ucode":"DB67566A627DF2","user_header":"https://static001.geekbang.org/account/avatar/00/11/49/f1/bd61dbb1.jpg","comment_is_top":false,"comment_ctime":1623075593,"is_pvip":false,"replies":[{"id":"107803","content":"老哥，加油","user_name":"作者回复","comment_id":296634,"uid":"1167883","ip_address":"","utype":1,"ctime":1623161662,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"23097912073","product_id":100079601,"comment_content":"好家伙，就这个项目安装就够我喝几壶里","like_count":5,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521531,"discussion_content":"老哥，加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623161662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298099,"user_name":"小可爱(`へ´*)ノ","can_delete":false,"product_type":"c1","uid":1016404,"ip_address":"","ucode":"E75189846F6616","user_header":"https://static001.geekbang.org/account/avatar/00/0f/82/54/b9cd3674.jpg","comment_is_top":false,"comment_ctime":1623913067,"is_pvip":false,"replies":[{"id":"108226","content":"分域，通过分域可以知道是哪个项目哪个功能模块的函数，便于理解","user_name":"作者回复","comment_id":298099,"uid":"1167883","ip_address":"","utype":1,"ctime":1623993847,"user_name_real":"CK1.0"}],"discussion_count":1,"race_medal":0,"score":"18803782251","product_id":100079601,"comment_content":"老师，你mariadb安装脚本中的出现类似iam::mariadb::uninstall的命名，使用::有什么目的吗","like_count":4,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522014,"discussion_content":"分域，通过分域可以知道是哪个项目哪个功能模块的函数，便于理解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623993847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296331,"user_name":"呵呵哒","can_delete":false,"product_type":"c1","uid":2234743,"ip_address":"","ucode":"CEC8B421BB564A","user_header":"https://static001.geekbang.org/account/avatar/00/22/19/77/3ca9f42d.jpg","comment_is_top":false,"comment_ctime":1622902338,"is_pvip":false,"replies":[{"id":"107545","content":"请求的iam-aliserver吗，看是不是token过期了。","user_name":"作者回复","comment_id":296331,"uid":"1167883","ip_address":"","utype":1,"ctime":1622952269,"user_name_real":"CK1.0"}],"discussion_count":19,"race_medal":0,"score":"18802771522","product_id":100079601,"comment_content":"最后的鉴权验证一直这样{&quot;code&quot;:100202,&quot;message&quot;:&quot;Signature is invalid&quot;}<br>换了token 新加的用户  策略 和秘钥 都不行","like_count":4,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521400,"discussion_content":"请求的iam-aliserver吗，看是不是token过期了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622952269,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043780,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ed/44/2267a5a7.jpg","nickname":"一期一会","note":"","ucode":"1C44A6453F6381","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533254,"discussion_content":"找到问题所在了，关键是“生成token” 这一步，老师的命令里面是他的机器上生成的secretID和secretKey，我们不能直接用，而是要靠上一步“创建密钥” 中的返回值来获取。如果你生成的时候没有复制当时的密钥，需要先删除原密钥： \ncurl -s -XDELETE -H&#34;Authorization: Bearer $token&#34; http://127.0.0.1:8080/v1/secrets/authztest\n再执行生成密钥。返回值中找到secretID和secretKey：\n{&#34;metadata&#34;:{&#34;...&#34;,&#34;secretID&#34;:&#34;C62mSgXlqkale75uc3LsqXjduBx1iGeuVrHe&#34;,&#34;secretKey&#34;:&#34;IO7Fh3G0dTRdlvH55Uvi212iv8SFFl0c&#34;,&#34;...}\n然后再生成token：\niamctl jwt sign C62mSgXlqkale75uc3LsqXjduBx1iGeuVrHe IO7Fh3G0dTRdlvH55Uvi212iv8SFFl0c ，\n这样的token用到最后一步，就可以成功了：\n{&#34;allowed&#34;:true}","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1637825528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2639918,"avatar":"https://static001.geekbang.org/account/avatar/00/28/48/2e/3d11dcc3.jpg","nickname":"哄哄","note":"","ucode":"82285594E3159A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392628,"discussion_content":"大家这个问题解决了吗？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631080338,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2925541,"avatar":"","nickname":"Geek_f0ae52","note":"","ucode":"C0CF6A54280522","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560049,"discussion_content":"检查一下是不是redis出问题了，测试一下是否可以连接redis","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649145487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2687465,"avatar":"","nickname":"Infp","note":"","ucode":"17467CFFB40E6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547679,"discussion_content":"我发现redis服务不知道怎么自己就关闭了。我重新安装一下就OK：{&#34;status&#34;: &#34;ok&#34;}","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642819052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1043780,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ed/44/2267a5a7.jpg","nickname":"一期一会","note":"","ucode":"1C44A6453F6381","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":533248,"discussion_content":"我也遇到了，还是不知道怎么解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637824563,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1150143,"avatar":"https://static001.geekbang.org/account/avatar/00/11/8c/bf/182ee8e6.jpg","nickname":"周Sir","note":"","ucode":"905991012EFF53","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":409264,"discussion_content":"哎嘿嘿，我也遇到了，锲而不舍，刨根问底，解决了。把/etc/iam/iam-authz-server.yaml 这个配置文件里面的redis密码设置正确。如果redis没有配置密码，那么需要注释掉","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635404924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2826394,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/20/9a/b011d743.jpg","nickname":"段润刚","note":"","ucode":"9D9F4BD84F291E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408853,"discussion_content":"会影响后续么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635333608,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2826394,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/20/9a/b011d743.jpg","nickname":"段润刚","note":"","ucode":"9D9F4BD84F291E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408851,"discussion_content":"这个问题有解决的了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635333266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2068776,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/91/28/f2dcbbfe.jpg","nickname":"宋世杰","note":"","ucode":"0869FF74808452","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390442,"discussion_content":"也遇到了相同的问题，求帮助","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629846672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1437699,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f0/03/56b6fd4f.jpg","nickname":"浮尘","note":"","ucode":"00969A3D5C5346","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389160,"discussion_content":"[0m authzserver     storage/redis_cluster.go:125    Error trying to set test key: dial tcp 127.0.0.1:6379: connect: connection refused","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629162965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1437699,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f0/03/56b6fd4f.jpg","nickname":"浮尘","note":"","ucode":"00969A3D5C5346","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389157,"discussion_content":"我遇到这个问题好像是redis的问题, 127.0.0.1:6379 拒绝连接","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629162892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1437699,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f0/03/56b6fd4f.jpg","nickname":"浮尘","note":"","ucode":"00969A3D5C5346","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388121,"discussion_content":"我也遇到这个问题，搞了好久都不行，是不是要重新删代码","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628601114,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2692914,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKB2930aZlw6wbiaP7dqAuJE6Isj8J1ST9rHYDfRzLbDK92yiaLXwz1O4gvWqJoErQzYdic6W1wggZibw/132","nickname":"Geek_da7878","note":"","ucode":"EFA75FBA4B3237","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387679,"discussion_content":"我也遇到了同样的问题 怎么尝试都不行\n[going@dev ~]$ curl -s -XPOST -H&#39;Content-Type: application/json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6ImNJV2NNR2FmWDhGbmxzemVFeWRMbDZScmhYeGZwaGc3WlplaSIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYyODM0NTExNCwiaWF0IjoxNjI4MzM3OTE0LCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MjgzMzc5MTR9.dHlmqFLoSwtY1nNo9aZqtDjDLB_ArJCWK0UZrmNX_vU&#39; -d&#39;{&#34;subject&#34;:&#34;users:maria1&#34;,&#34;action&#34;:&#34;delete&#34;,&#34;resource&#34;:&#34;resources:articles:ladon-introduction&#34;,&#34;context&#34;:{&#34;remoteIP&#34;:&#34;192.168.0.1&#34;}}&#39; http://127.0.0.1:9090/v1/authz\n{&#34;code&#34;:100202,&#34;message&#34;:&#34;Signature is invalid&#34;}[going@dev ~]$ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628338070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1810532,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKVAVOYIoohh3bCdgErne0VHtoPorcrtmOAR45rsWPmJsLkzlvqMulbRyv0Skj8JHajrA9bPia3Lxw/132","nickname":"Geek_0315ca","note":"","ucode":"675254A9FC25A8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387646,"discussion_content":"我也遇到同样得问题：我是在iam-authz-server安装成功后，测试资源授权那里，一直提示签名无效；\n{&#34;code&#34;:100202,&#34;message&#34;:&#34;Signature is invalid&#34;}[","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628320777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2535600,"avatar":"https://static001.geekbang.org/account/avatar/00/26/b0/b0/8c0e3236.jpg","nickname":"逆流向善的阿鱼","note":"","ucode":"C0514B1C364EAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380681,"discussion_content":"老师您好，我也遇到了同样的问题。此外我在执行增删改查用户密钥、策略等 都是返回 {&#34;message&#34;:&#34;Token is expired&#34;}[gouser@dev iam]$ ，不确定是因为什么原因，希望老师能指导一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624628036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2655412,"avatar":"https://static001.geekbang.org/account/avatar/00/28/84/b4/3ed5adc7.jpg","nickname":"pudu168","note":"","ucode":"5262769FE8B208","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380125,"discussion_content":"对，一样的问题，iamctl jwt sign  签出来的 jwt 验证本身是 invliad 的 signature， 通过 jwt.io 网站验证","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624349847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1566294,"avatar":"https://static001.geekbang.org/account/avatar/00/17/e6/56/020f2209.jpg","nickname":"Dpp的小跟班儿","note":"","ucode":"4AF5F9892C575E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379854,"discussion_content":"我也一样，我是在iam-authz-server安装成功后，测试资源授权那里，一直提示签名无效；重建策略和秘钥都不行，我还专门解析了jwt，也没有过期；不知道影不影响后续课程的学习，还望老师能指导一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624192632,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1031828,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erEHTaQDkWqEYib9iabib8rACYpSFBHTPFmgicUKaib79MB6VIxNwiajHUS8kYFEKCGOjpibf0dibhIjqhfzg/132","nickname":"plh","note":"","ucode":"D79F2B87AC3AD2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379670,"discussion_content":"我也遇到同样问题呢。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624068770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295415,"user_name":"夜空中最亮的星","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1622423408,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18802292592","product_id":100079601,"comment_content":"老师讲解的很详细","like_count":4},{"had_liked":false,"id":294769,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1622085433,"is_pvip":false,"replies":[{"id":"107039","content":"感谢pedro的反馈。<br><br>最新的master分支和v1.0.0版本已经修复了。<br><br>这里可以通过下面的方法来修复：<br>$ rm go.sum<br>$ go mod tidy<br>","user_name":"作者回复","comment_id":294769,"uid":"1167883","ip_address":"","utype":1,"ctime":1622116222,"user_name_real":"CK1.0"}],"discussion_count":7,"race_medal":0,"score":"18801954617","product_id":100079601,"comment_content":"老师的脚本玩的真的非常溜，我几乎无阻碍的到了 iam-apiserver 安装这个地方了，但是遇到了两个问题，第一个文中关于 git clone --depth 的命令有错误，depth 没有指定参数，导致 clone 失败；第二个问题很棘手，google 尝试了几个办法都没有解决，在运行：<br>```sh<br>make build BINS=iam-apiserver<br>```<br>脚本的时候，会报错：<br>```sh<br>===========&gt; Building binary iam-apiserver f96a5c8 for linux amd64<br>verifying github.com&#47;marmotedu&#47;marmotedu-sdk-go@v1.0.0&#47;go.mod: checksum mismatch<br>\tdownloaded: h1:QAuHe4YwnwlHYcktAFodwYyzxp2lqRDIi0yh1WbLtOM=<br>\tgo.sum:     h1:314QsW&#47;6+tVtngSxPzipgFJNCQMPFtDQQiXC7O66BwM=<br><br>SECURITY ERROR<br>This download does NOT match an earlier download recorded in go.sum.<br>The bits may have been replaced on the origin server, or an attacker may<br>have intercepted the download attempt.<br>```<br>我尝试用 go clean --modcache 和 go mod tidy 都没有解决，还是报校验错误，可能 sdk-go 这个包本身就有问题，这个包又是老师维护的，麻烦老师答疑解惑，多谢了～","like_count":4,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520799,"discussion_content":"感谢pedro的反馈。\n\n最新的master分支和v1.0.0版本已经修复了。\n\n这里可以通过下面的方法来修复：\n$ rm go.sum\n$ go mod tidy\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622116222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":2,"child_discussions":[{"author":{"id":2871999,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/d2/bf/c9abe2c6.jpg","nickname":"Scottylu","note":"","ucode":"C8845254A59C37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":579897,"discussion_content":"现在会报这个错\nno required module provides package github.com/marmotedu/iam/cmd/iam-apiserver: go.mod file not found in current directory or any parent directory; see &#39;go help modules&#39;\nmake[1]: *** [scripts/make-rules/golang.mk:60: go.build.linux_amd64.iam-apiserver] Error 1\nmake: *** [Makefile:62: build] Error 2\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657763616,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":520799,"ip_address":""},"score":579897,"extra":""},{"author":{"id":1356077,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/2d/661132f3.jpg","nickname":"佚名","note":"","ucode":"A4E35B21AC3C31","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2871999,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/d2/bf/c9abe2c6.jpg","nickname":"Scottylu","note":"","ucode":"C8845254A59C37","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579912,"discussion_content":"我也遇到这个错误了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657770722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":579897,"ip_address":""},"score":579912,"extra":""}]},{"author":{"id":1200704,"avatar":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","nickname":"pedro","note":"","ucode":"F40C839DDFD599","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376371,"discussion_content":"我目前是这样解决的：\n```sh\nmv go.sum go.sum1\ngo mod tidy\n```\n丢弃原来的 sum 文件，重新生成一个，可以运行成功","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1622098492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1047423,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fb/7f/746a6f5e.jpg","nickname":"Q","note":"","ucode":"785546C617D3DF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1200704,"avatar":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","nickname":"pedro","note":"","ucode":"F40C839DDFD599","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376372,"discussion_content":"可用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622099384,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":376371,"ip_address":""},"score":376372,"extra":""}]},{"author":{"id":2757858,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","nickname":"顺势而为","note":"","ucode":"FE7D688D24823E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580816,"discussion_content":"附带一条：升级1.8以上版本才有 go work 命令：https://go.dev/doc/tutorial/workspaces","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658385111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2757858,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","nickname":"顺势而为","note":"","ucode":"FE7D688D24823E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580814,"discussion_content":"当出现如下问题：\n[going@dev iam]$ make build BINS=iam-apiserver\n===========&gt; Building binary iam-apiserver v1.1.0 for linux amd64\nno required module provides package github.com/marmotedu/iam/cmd/iam-apiserver: go.mod file not found in current directory or any parent directory; see &#39;go help modules&#39;\nmake[1]: *** [scripts/make-rules/golang.mk:60: go.build.linux_amd64.iam-apiserver] Error 1\nmake: *** [Makefile:62: build] Error 2\n\n说明go的工作目录切换有问题，\n执行两个命令\nmm\ngo work use ./iam\n\n再返回\ncd $IAM_ROOT 目录，执行 make build BINS=iam-apiserver 命令","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658384825,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":343656,"user_name":"fahsa","can_delete":false,"product_type":"c1","uid":1535891,"ip_address":"","ucode":"5ABBBEF0A6221D","user_header":"https://static001.geekbang.org/account/avatar/00/17/6f/93/e5bcd0f4.jpg","comment_is_top":false,"comment_ctime":1650969839,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"14535871727","product_id":100079601,"comment_content":"因为第一步安装 MariaDB 的时候就遇到各种问题，后面尝试使用 一键安装，重试安装了好几次也是遇到各种问题，本来想放弃，或者最后用评论区同学的docker容器试试。<br>也花了挺长时间的，心有不甘，最后想还是一步一步按照教程走，经过一下午的折腾，果真安装成功了，感谢老师，不得不佩服老师的技术。<br>总结一下，主要问题：<br>1、 CentOS 8已于2021年12月31日寿终正非，但软件包仍在官方镜像上保留了一段时间。现在他们被转移到https:&#47;&#47;vault.centos.org<br>cd &#47;etc&#47;yum.repos.d&#47; 里的多个文件的 baseurl <br>如果要继续使用就需要将 vault.centos.org代替mirror.centos.org<br><br>2、Linux下访问 Github 慢的问题<br><br>编辑 sudo vim ~&#47;.gitconfig <br>将 git config --global url.&quot;https:&#47;&#47;github.com.cnpmjs.org&#47;&quot;.insteadOf &quot;https:&#47;&#47;github.com&#47;&quot; 注释掉了，<br>修改了 sudo vi &#47;etc&#47;hosts 添加了多个ip指向 github.com <br><br>然后继续跟着教程一步一步下来，没有报任何错误，<br>以上就是个人实操过程的经历，具体还是要根据实际情况来<br>最后贴上成功安装后的收获：<br>clientVersion:<br>  buildDate: &quot;2022-04-26T09:41:36Z&quot;<br>  compiler: gc<br>  gitCommit: 26bf0c0d0f853a0a60123309ff03a4569aa2e631<br>  gitTreeState: dirty<br>  gitVersion: v1.6.2<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2022-04-26T09:20:46Z&quot;<br>  compiler: gc<br>  gitCommit: 26bf0c0d0f853a0a60123309ff03a4569aa2e631<br>  gitTreeState: dirty<br>  gitVersion: v1.6.2<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>","like_count":3,"discussions":[{"author":{"id":1322612,"avatar":"https://static001.geekbang.org/account/avatar/00/14/2e/74/88c613e0.jpg","nickname":"扶幽","note":"","ucode":"1400EDFF8970D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575474,"discussion_content":"遇到了跟老哥同样的坑👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654856576,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305629,"user_name":"forever_ele","can_delete":false,"product_type":"c1","uid":2725464,"ip_address":"","ucode":"CBC4ADD1763607","user_header":"https://static001.geekbang.org/account/avatar/00/29/96/58/b91503e7.jpg","comment_is_top":false,"comment_ctime":1628076649,"is_pvip":false,"replies":[{"id":"110630","content":"强！","user_name":"作者回复","comment_id":305629,"uid":"1167883","ip_address":"","utype":1,"ctime":1628165328,"user_name_real":"CK1.0"}],"discussion_count":2,"race_medal":0,"score":"14512978537","product_id":100079601,"comment_content":"创建授权策略时如果报 {&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;} ，说明策略已经存在了，可执行<br>curl -s -XDELETE -H&#39;Authorization: Bearer {Token}&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;policies&#47;{策略名} 删除后重试","like_count":3,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524455,"discussion_content":"强！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628165328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2593667,"avatar":"https://static001.geekbang.org/account/avatar/00/27/93/83/cb37c46e.jpg","nickname":"cshzet","note":"","ucode":"A343CCB6E5D519","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395066,"discussion_content":"我还以为是我这边出问题了，强啊，老哥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632213720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303386,"user_name":"morris","can_delete":false,"product_type":"c1","uid":2648051,"ip_address":"","ucode":"48F51BA018A11D","user_header":"https://static001.geekbang.org/account/avatar/00/28/67/f3/db05d1b8.jpg","comment_is_top":false,"comment_ctime":1626765109,"is_pvip":false,"replies":[{"id":"109983","content":"看下$HOME&#47;.iam&#47;config配置文件中的用户名和密码是否配置的是admin，以及admin的正确密码 Admin@2021","user_name":"作者回复","comment_id":303386,"uid":"1167883","ip_address":"","utype":1,"ctime":1627031304,"user_name_real":"CK1.0"}],"discussion_count":2,"race_medal":0,"score":"14511666997","product_id":100079601,"comment_content":"执行：   iamctl user list <br>error: {&quot;code&quot;:100207,&quot;message&quot;:&quot;Permission denied&quot;}<br><br>这是为啥呢","like_count":3,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523654,"discussion_content":"看下$HOME/.iam/config配置文件中的用户名和密码是否配置的是admin，以及admin的正确密码 Admin@2021","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627031304,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2641288,"avatar":"https://static001.geekbang.org/account/avatar/00/28/4d/88/43707555.jpg","nickname":"Ricardo","note":"","ucode":"B129D4590DB2CD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386145,"discussion_content":"请问解决了吗，我也是这个问题\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627442200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297473,"user_name":"ling.zeng","can_delete":false,"product_type":"c1","uid":1028615,"ip_address":"","ucode":"A78CF6D519BFF8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b2/07/7711d239.jpg","comment_is_top":false,"comment_ctime":1623570861,"is_pvip":true,"replies":[{"id":"108010","content":"后面可能会，哈哈哈哈","user_name":"作者回复","comment_id":297473,"uid":"1167883","ip_address":"","utype":1,"ctime":1623582222,"user_name_real":"CK1.0"}],"discussion_count":2,"race_medal":0,"score":"14508472749","product_id":100079601,"comment_content":"老师 后边能加入云原生的功能吗？ 目前云原生化挺火的，能加上就好了。","like_count":3,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521833,"discussion_content":"后面可能会，哈哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1028615,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b2/07/7711d239.jpg","nickname":"ling.zeng","note":"","ucode":"A78CF6D519BFF8","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378995,"discussion_content":"期待ing","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582363,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294913,"user_name":"Derek","can_delete":false,"product_type":"c1","uid":1146983,"ip_address":"","ucode":"A4D5DED1E00F60","user_header":"https://static001.geekbang.org/account/avatar/00/11/80/67/4e381da5.jpg","comment_is_top":false,"comment_ctime":1622128651,"is_pvip":false,"replies":[{"id":"107145","content":"文档顺序有问题，文档已经更新了","user_name":"作者回复","comment_id":294913,"uid":"1167883","ip_address":"","utype":1,"ctime":1622253859,"user_name_real":"CK1.0"}],"discussion_count":3,"race_medal":0,"score":"14507030539","product_id":100079601,"comment_content":" cd $IAM_ROOT 这个路径是哪个啊？我咋没看到，我的环境变量里没这个值啊","like_count":3,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520866,"discussion_content":"文档顺序有问题，文档已经更新了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622253859,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2188564,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/mEASWaicRcYrU1TtnkoN7Dx7IEL5godockwSZicz1j9UXN88vtoG2ynJ2yib2oCMcnIjwJtLx60JHsm9moWrNM64A/132","nickname":"Geek_c3e438","note":"","ucode":"98ECC14625735B","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376530,"discussion_content":"在下文有提到：\nexport IAM_ROOT=&#34;$GOWORK/github.com/marmotedu/iam&#34;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622177456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1488804,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b7/a4/04a8731e.jpg","nickname":"蟹","note":"","ucode":"F35304B42194C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376507,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622168559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309612,"user_name":"Geek_9b9ea5","can_delete":false,"product_type":"c1","uid":2722438,"ip_address":"","ucode":"7D0393C73900EC","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqHKnvztWJLQBCFibpEZYA8HXqMz3SibTiajj8JXBAMjmXYHCD1rqG5aw6ghIWc5I9gP2I4DmGktSuWg/132","comment_is_top":false,"comment_ctime":1630253435,"is_pvip":false,"replies":[{"id":"112820","content":"remoteIP -&gt; remoteIPAddress。已经找编辑更新了","user_name":"作者回复","comment_id":309612,"uid":"1167883","ip_address":"","utype":1,"ctime":1631177675,"user_name_real":"CK1.0"}],"discussion_count":6,"race_medal":0,"score":"10220188027","product_id":100079601,"comment_content":"第 3 步，测试 iam-authz-server 是否成功安装中，测试资源授权是否通过，执行<br>$ curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6Ilp1eHZYTmZHMDhCZEVNcWtUYVA0MUwyRExBcmxFNkpwcW9veCIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYxNzg0NTE5NSwiaWF0IjoxNjE3ODM3OTk1LCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MTc4Mzc5OTV9.za9yLM7lHVabPAlVQLCqXEaf8sTU6sodAsMXnmpXjMQ&#39; -d&#39;{&quot;subject&quot;:&quot;users:maria&quot;,&quot;action&quot;:&quot;delete&quot;,&quot;resource&quot;:&quot;resources:articles:ladon-introduction&quot;,&quot;context&quot;:{&quot;remoteIP&quot;:&quot;192.168.0.5&quot;}}&#39; http:&#47;&#47;127.0.0.1:9090&#47;v1&#47;authz<br>{&quot;allowed&quot;:true}报错，在问题区发现有人提出问题并且未有正确的解决方案，望老师解惑。<br>{&quot;code&quot;:100202,&quot;message&quot;:&quot;Signature is invalid&quot;}","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525931,"discussion_content":"remoteIP -&amp;gt; remoteIPAddress。已经找编辑更新了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631177675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2655184,"avatar":"https://static001.geekbang.org/account/avatar/00/28/83/d0/86d4417a.jpg","nickname":"浅言浅笑","note":"","ucode":"796B44DDD3BCD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393073,"discussion_content":"我也碰到了，重新生成token还是一样，后来我就重启了一下iam-authz-server服务，再验证就好了\nsudo systemctl restart iam-authz-server\n","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1631240647,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1186004,"avatar":"https://static001.geekbang.org/account/avatar/00/12/18/d4/73260a43.jpg","nickname":"ECHOLOG","note":"","ucode":"4350973F4D4FB0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2655184,"avatar":"https://static001.geekbang.org/account/avatar/00/28/83/d0/86d4417a.jpg","nickname":"浅言浅笑","note":"","ucode":"796B44DDD3BCD6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410648,"discussion_content":"重启了，确实好用了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635752039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":393073,"ip_address":""},"score":410648,"extra":""}]},{"author":{"id":2054611,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKBENQekdV3e9XwRQ5kpO9Y9d81sEMm52qcwJWbFbWbW2rniaTFYCChoR0ibZ0E3soQqod9rvfmBibmQ/132","nickname":"校歌","note":"","ucode":"CD257668BB1A33","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577588,"discussion_content":"可以看下iam-apiserver的日志，我这边也出现同样的问题，看了下日志，发现redis链接被拒了，最后发现redis没有挂到systemctl下守护，重启虚拟机，redis不会启动，只要把redis启动下，验证就能通过。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656220267,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1150143,"avatar":"https://static001.geekbang.org/account/avatar/00/11/8c/bf/182ee8e6.jpg","nickname":"周Sir","note":"","ucode":"905991012EFF53","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":409265,"discussion_content":"还有可能是你的redis密码没有配置正确","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635405220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2826394,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/20/9a/b011d743.jpg","nickname":"段润刚","note":"","ucode":"9D9F4BD84F291E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408911,"discussion_content":"curl -s -XPOST -H&#39;Content-Type: application/json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6Iko2M1ZMeHlQZDdWbklKaE9wbXlxUFlhUXRyWWhQY2tDUmJ3YiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYzNTM0MDE3NywiaWF0IjoxNjM1MzMyOTc3LCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MzUzMzI5Nzd9.suEEWBDoLCvKR9NXZJxjxg9Q8EOfxz-_LqF0bxPZTDE&#39; -d&#39;{&#34;subject&#34;:&#34;users:maria&#34;,&#34;action&#34;:&#34;delete&#34;,&#34;resource&#34;:&#34;resources:articles:ladon-introduction&#34;,&#34;context&#34;:{&#34;remoteIPAddress&#34;:&#34;192.168.0.5&#34;}}&#39; http://127.0.0.1:9090/v1/authz\n{&#34;code&#34;:100202,&#34;message&#34;:&#34;Signature is invalid&#34;}[going@dev iam]$","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635341938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305588,"user_name":"Geek_3650cc","can_delete":false,"product_type":"c1","uid":2707819,"ip_address":"","ucode":"08F8F15267F20C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKor4hwrdAK8E6XBLAUdznRLRUn29vdw7mBYRRN3TDhWz9KgGSicDibxiarlNjIf4yd2JeiafUVb0sE2A/132","comment_is_top":false,"comment_ctime":1628061102,"is_pvip":false,"replies":[{"id":"110632","content":"systemctl cat iam-apiserver 看下systemctl读的是哪个目录下的unit文件。再确认下这个目录下有没有iam-apiserver的unit文件。如果没有需要重新安装","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628165455,"ip_address":"","comment_id":305588,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10217995694","product_id":100079601,"comment_content":"systemctl启动iam-apiserver失败，确认文件存在<br>systemctl list-unit-files --type=service<br>iam-apiserver.service                      bad <br><br>systemctl enable iam-apiserver.service <br>Failed to enable unit: Unit file iam-apiserver.service does not exist<br>","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524441,"discussion_content":"systemctl cat iam-apiserver 看下systemctl读的是哪个目录下的unit文件。再确认下这个目录下有没有iam-apiserver的unit文件。如果没有需要重新安装","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628165455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2917721,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/85/59/b09ac63b.jpg","nickname":"biubiubiu~","note":"","ucode":"6C66C1BF67142D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585607,"discussion_content":"请问这个问题解决了吗？   我遇到这个问题 还是没有解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661701899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304476,"user_name":"今天也要加油鸭！","can_delete":false,"product_type":"c1","uid":2618487,"ip_address":"","ucode":"C94F6E3DC34689","user_header":"https://static001.geekbang.org/account/avatar/00/27/f4/77/dbb2aad8.jpg","comment_is_top":false,"comment_ctime":1627441423,"is_pvip":false,"replies":[{"id":"110214","content":"程序Bug已经修复了，你可以再pull下代码。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627597606,"ip_address":"","comment_id":304476,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10217376015","product_id":100079601,"comment_content":"老师 这个错误怎么解决呢<br>[parallels@dev iam]$iamctl user list<br>error: {&quot;code&quot;:100207,&quot;message&quot;:&quot;Permission denied&quot;}<br><br>[parallels@dev iam]$cat $HOME&#47;.iam&#47;config<br>apiVersion: v1<br>user:<br>  #token: # JWT Token<br>  username: admin # iam 用户名<br>  password: Admin@2021 # iam 密码<br>  #secret-id: # 密钥 ID<br>  #secret-key: # 密钥 Key<br>  client-certificate: &#47;home&#47;parallels&#47;.iam&#47;cert&#47;admin.pem # 用于 TLS 的客户端证书文件路径<br>  client-key: &#47;home&#47;parallels&#47;.iam&#47;cert&#47;admin-key.pem # 用于 TLS 的客户端 key 文件路径<br>  #client-certificate-data:<br>  #client-key-data:<br><br>server:<br>  address: 127.0.0.1:8443 # iam api-server 地址<br>  timeout: 10s # 请求 api-server 超时时间<br>  #max-retries: # 最大重试次数，默认为 0<br>  #retry-interval: # 重试间隔，默认为 1s<br>  #tls-server-name: # TLS 服务器名称<br>  #insecure-skip-tls-verify: # 设置为 true 表示跳过 TLS 安全验证模式，将使得 HTTPS 连接不安全<br>  certificate-authority: &#47;etc&#47;iam&#47;cert&#47;ca.pem # 用于 CA 授权的 cert 文件路径<br>  #certificate-authority-data:<br>","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524053,"discussion_content":"程序Bug已经修复了，你可以再pull下代码。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627597606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304337,"user_name":"噼里啪啦啪啦噼里噼里啪啦","can_delete":false,"product_type":"c1","uid":1109143,"ip_address":"","ucode":"2A4B86D38F7E11","user_header":"https://static001.geekbang.org/account/avatar/00/10/ec/97/58e7bc9a.jpg","comment_is_top":false,"comment_ctime":1627356974,"is_pvip":false,"replies":[{"id":"110218","content":"sorry，这个是程序Bug，已经修复了。可以再pull下代码。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627597727,"ip_address":"","comment_id":304337,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10217291566","product_id":100079601,"comment_content":"老师，在获取用户列表错误：<br> curl -s -XGET -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2Mjc0NDI5NzUsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MjczNTY1NzUsInN1YiI6ImFkbWluIn0.95HBXRxC0IYUH-mfmImZ4dxe1E_DcwXhfQyBJSB-UgQ&#39; &#39;http:&#47;&#47;127.0.0.1:8070&#47;v1&#47;users?offset=0&amp;limit=10&#39;<br>{&quot;code&quot;:100207,&quot;message&quot;:&quot;Permission denied&quot;}<br><br>我查看了其他同学也有同样的问题，我根据回答都修改了，并重新生成了token，但还是不行。<br>查看日志文件后显示：<br><br>2021-07-27 11:30:08.763 INFO    apiserver       middleware&#47;logger.go:135        200 - [127.0.0.1] &quot;146.40118ms POST &#47;v1&#47;users&quot;  {&quot;requestID&quot;: &quot;73bcefbe-4abf-45d0-bd7d-961b10046a6d&quot;, &quot;username&quot;: &quot;&quot;}<br>2021-07-27 11:31:37.397 INFO    apiserver       gorm@v1.21.12&#47;callbacks.go:133  mysql&#47;user.go:76 record not found[0.729ms] [rows:0] SELECT * FROM `user` WHERE name = &#39;&#39; ORDER BY `user`.`id` LIMIT 1<br>2021-07-27 11:31:37.398 INFO    apiserver       middleware&#47;logger.go:135        403 - [127.0.0.1] &quot;1.125017ms GET &#47;v1&#47;users?offset=0&amp;limit=10&quot;  {&quot;requestID&quot;: &quot;b3d3e22b-1528-41a8-94f9-313c5d5c3d2a&quot;, &quot;username&quot;: &quot;&quot;}<br><br>请问怎么解决呀<br>","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524018,"discussion_content":"sorry，这个是程序Bug，已经修复了。可以再pull下代码。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627597727,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2641288,"avatar":"https://static001.geekbang.org/account/avatar/00/28/4d/88/43707555.jpg","nickname":"Ricardo","note":"","ucode":"B129D4590DB2CD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386309,"discussion_content":"我也遇到相同的问题了，还没解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627523407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303942,"user_name":"Terence孫","can_delete":false,"product_type":"c1","uid":1157674,"ip_address":"","ucode":"8C3A89C18A2182","user_header":"https://static001.geekbang.org/account/avatar/00/11/aa/2a/ce7c487d.jpg","comment_is_top":false,"comment_ctime":1627113385,"is_pvip":false,"replies":[{"id":"110035","content":"linux man page，供用户在linux系统上方便查阅某个软件的使用文档。例如：man grep, man sed等","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627256413,"ip_address":"","comment_id":303942,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10217047977","product_id":100079601,"comment_content":"老师，想请问下man这部分的安装，想知道man这个是用来做什么的？？不是很懂，希望能有一点资料可以了解一下","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523883,"discussion_content":"linux man page，供用户在linux系统上方便查阅某个软件的使用文档。例如：man grep, man sed等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627256413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300558,"user_name":"Geek_399957","can_delete":false,"product_type":"c1","uid":2676396,"ip_address":"","ucode":"A121DE94B6EC6E","user_header":"","comment_is_top":false,"comment_ctime":1625217960,"is_pvip":false,"replies":[{"id":"108957","content":"构建iam-apiserver二进制文件。makefile中执行的是go build命令","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625388985,"ip_address":"","comment_id":300558,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10215152552","product_id":100079601,"comment_content":"<br>$ cd $IAM_ROOT<br>$ source scripts&#47;install&#47;environment.sh<br>$ make build BINS=iam-apiserver<br>$ sudo cp _output&#47;platforms&#47;linux&#47;amd64&#47;iam-apiserver ${IAM_INSTALL_DIR}&#47;bin<br><br><br>新手求解，make build BINS=iam-apiserver 这句命令是啥意思？","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522762,"discussion_content":"构建iam-apiserver二进制文件。makefile中执行的是go build命令","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625388985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297323,"user_name":"lianyz","can_delete":false,"product_type":"c1","uid":1330879,"ip_address":"","ucode":"A2536B49AEC4DD","user_header":"https://static001.geekbang.org/account/avatar/00/14/4e/bf/0f0754aa.jpg","comment_is_top":false,"comment_ctime":1623452202,"is_pvip":true,"replies":[{"id":"108016","content":"这个不影响使用，hosts会限制来源主机，这里没限制，如果有需要你可以加上","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623582810,"ip_address":"","comment_id":297323,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10213386794","product_id":100079601,"comment_content":"老师好，在生成证书的环节，运行cfssl gencert...，报了没有hosts的警告，是不是不太对啊，如下。<br>cfssl gencert -ca=${IAM_CONFIG_DIR}&#47;cert&#47;ca.pem \\<br>  -ca-key=${IAM_CONFIG_DIR}&#47;cert&#47;ca-key.pem \\<br>  -config=${IAM_CONFIG_DIR}&#47;cert&#47;ca-config.json \\<br>  -profile=iam iam-apiserver-csr.json | cfssljson -bare iam-apiserver。<br><br><br>[WARNING] This certificate lacks a &quot;hosts&quot; field. This makes it unsuitable for<br>websites. For more information see the Baseline Requirements for the Issuance and Management<br>of Publicly-Trusted Certificates, v.1.1.6, from the CA&#47;Browser Forum (https:&#47;&#47;cabforum.org);<br>specifically, section 10.2.3 (&quot;Information Requirements&quot;).","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521799,"discussion_content":"这个不影响使用，hosts会限制来源主机，这里没限制，如果有需要你可以加上","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582810,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1105161,"avatar":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","nickname":"helloworld","note":"","ucode":"1EECCA0F43E278","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380661,"discussion_content":"csr文件里有hosts配置, 所以老师的解释说不通, 实测这个问题是cfssl版本的问题,  升级到最新版(1.6.0)就没有这个警告提示了.","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1624619892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1866351,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/7a/6f/db08c945.jpg","nickname":"单推dd","note":"","ucode":"A114AA91B5D7C9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378884,"discussion_content":"同，我也遇到这个问题\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623485375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296996,"user_name":"默契","can_delete":false,"product_type":"c1","uid":2640269,"ip_address":"","ucode":"86AB4D3EBFA5B6","user_header":"https://static001.geekbang.org/account/avatar/00/28/49/8d/1a588fb4.jpg","comment_is_top":false,"comment_ctime":1623253542,"is_pvip":false,"replies":[{"id":"107908","content":"GOWORK少了个$，看下是不是复制的时候少粘了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623321327,"ip_address":"","comment_id":296996,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10213188134","product_id":100079601,"comment_content":"老师为什么我的环境变量 $IAM_ROOT不能执行<br>[lin@dev iam]$ pwd<br>&#47;home&#47;lin&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam<br>[lin@dev iam]$ cd $IAM_ROOT<br>bash: cd: GOWORK&#47;github.com&#47;marmotedu&#47;iam: No such file or directory","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521678,"discussion_content":"GOWORK少了个$，看下是不是复制的时候少粘了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623321327,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296618,"user_name":"StayLet","can_delete":false,"product_type":"c1","uid":1249652,"ip_address":"","ucode":"6B748CA3AF3C5B","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/74/72ffa6d6.jpg","comment_is_top":false,"comment_ctime":1623066072,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10213000664","product_id":100079601,"comment_content":"分享：v1.0.0 的仓库脚本已经包含 mongodb 安装及创建用户的过程，所以应该不用再按照文章中的步骤再执行一遍。<br>问题在于如果是 zsh 环境下，按原文：<br>$ mongo --quiet mongodb:&#47;&#47;iam:&#39;iam59!z$&#39;@127.0.0.1:27017&#47;iam_analytics?authSource=iam_analytics<br>是无法登录的，只是因为符号太多而且没转义，可以用：<br>mongo --quiet mongodb:&#47;&#47;iam@127.0.0.1:27017&#47;iam_analytics\\?authSource=iam_analytics<br>然后再通过提示输入密码来验证登录成功。","like_count":2,"discussions":[{"author":{"id":2712334,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/pWlCcThica6hHNnzw1Nj76otnzq5eo6lAkVr8kEy8ZV22Y01hPseJGPDt4K45xANMKY9a33YqjEmskIwQf0hkWg/132","nickname":"Geek_0827c6","note":"","ucode":"19D7C50E46BE9F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575882,"discussion_content":"就是这个原因,导致我都以为是版本问题,google 也找不到答案,直接用 卸载重装mongodb,后来直接放弃了这个操作,选择直接新建用户, \n ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655170795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295178,"user_name":"Tiandh","can_delete":false,"product_type":"c1","uid":1114508,"ip_address":"","ucode":"581C14BAE84AE7","user_header":"https://static001.geekbang.org/account/avatar/00/11/01/8c/41adb537.jpg","comment_is_top":false,"comment_ctime":1622286043,"is_pvip":false,"replies":[{"id":"107225","content":"优秀!","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435512,"ip_address":"","comment_id":295178,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10212220635","product_id":100079601,"comment_content":"项目部署完成。<br>环境：centos8.2 （内存 1G）<br>按照文章的部署顺序，在部署到 iam-pump 时遇到一个问题，<br>解决方法：kill 掉占用内存较多的进程<br>错误如下：<br>[going@dev iam]$ make build BINS=iam-pump<br>===========&gt; Building binary iam-pump c01dd7b for linux amd64<br># github.com&#47;olivere&#47;elastic&#47;v7<br>fatal error: runtime: out of memory<br>...","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520973,"discussion_content":"优秀!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294919,"user_name":"kkgo","can_delete":false,"product_type":"c1","uid":1199356,"ip_address":"","ucode":"AFCCBFD96CFA21","user_header":"https://static001.geekbang.org/account/avatar/00/12/4c/fc/0e887697.jpg","comment_is_top":false,"comment_ctime":1622130239,"is_pvip":false,"replies":[{"id":"107143","content":"大佬，优秀！","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622253839,"ip_address":"","comment_id":294919,"utype":1}],"discussion_count":2,"race_medal":1,"score":"10212064831","product_id":100079601,"comment_content":"已看完，坐等更新","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520871,"discussion_content":"大佬，优秀！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622253839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2625791,"avatar":"","nickname":"Geek_539ac5","note":"","ucode":"49C86DD7DDC028","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377950,"discussion_content":"Fedora31系统行吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622978209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294850,"user_name":"孔令飞","can_delete":false,"product_type":"c1","uid":1167883,"ip_address":"","ucode":"8363EA4BD0AAF0","user_header":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","comment_is_top":false,"comment_ctime":1622109087,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10212043679","product_id":100079601,"comment_content":"感谢pedro的反馈。<br><br>在最新的master分支和v1.0.0 2个问题均已修复。<br><br>如果遇到这类问题，可通过以下方式继续安装：<br><br>$ cd ${IAM_ROOT}<br>$ cd ..&#47; <br>$ rm -rf iam<br>$ git clone --depth=1 https:&#47;&#47;github.com&#47;marmotedu&#47;iam<br>$ cd iam <br>$ .&#47;scripts&#47;install&#47;iam-apiserver.sh iam::apiserver::install<br>$ .&#47;scripts&#47;install&#47;iam-authz-server.sh iam::authzserver::install<br>$ .&#47;scripts&#47;install&#47;iam-pump.sh iam::pump::install<br>$ .&#47;scripts&#47;install&#47;iamctl.sh iam::iamctl::install<br>$ .&#47;scripts&#47;install&#47;man.sh iam::man::install<br>$ .&#47;scripts&#47;install&#47;test.sh iam::test::test # 全量测试","like_count":2,"discussions":[{"author":{"id":1200704,"avatar":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","nickname":"pedro","note":"","ucode":"F40C839DDFD599","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376425,"discussion_content":"apiserver 已经跑起来了，完美 work 了两个服务，可惜云主机配置不够，后面已经不能再开进程了，想想办法用其它的方式来搞吧，哈哈哈~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622117574,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294648,"user_name":"赵新星","can_delete":false,"product_type":"c1","uid":1045345,"ip_address":"","ucode":"317BFF5B0311E4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f3/61/93b4ce97.jpg","comment_is_top":false,"comment_ctime":1622031787,"is_pvip":true,"replies":[{"id":"106960","content":"因为云原声化会涉及到很多内容，比如日志，监控，容器化部署等，内容很多，不太适合，在前面加进来，增加上手难度。刚开始也只是准备一个开发联调环境，直接虚拟机部署反而更高效","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622043009,"ip_address":"","comment_id":294648,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10211966379","product_id":100079601,"comment_content":"为什么不云原生化呢","like_count":2,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520754,"discussion_content":"因为云原声化会涉及到很多内容，比如日志，监控，容器化部署等，内容很多，不太适合，在前面加进来，增加上手难度。刚开始也只是准备一个开发联调环境，直接虚拟机部署反而更高效","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622043009,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1070043,"avatar":"https://static001.geekbang.org/account/avatar/00/10/53/db/858337e3.jpg","nickname":"Ethan Liu","note":"","ucode":"231F944F7CD56A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376297,"discussion_content":"什么是云原生化啊？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622074125,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1483818,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a4/2a/9cf95b09.jpg","nickname":"梭罗的小屋","note":"","ucode":"72B74D652DCE58","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1070043,"avatar":"https://static001.geekbang.org/account/avatar/00/10/53/db/858337e3.jpg","nickname":"Ethan Liu","note":"","ucode":"231F944F7CD56A","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":376317,"discussion_content":"DevOps+持续交付+微服务+容器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622079150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":376297,"ip_address":""},"score":376317,"extra":""}]}]},{"had_liked":false,"id":355729,"user_name":"biubiubiu~","can_delete":false,"product_type":"c1","uid":2917721,"ip_address":"北京","ucode":"6C66C1BF67142D","user_header":"https://static001.geekbang.org/account/avatar/00/2c/85/59/b09ac63b.jpg","comment_is_top":false,"comment_ctime":1661698736,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5956666032","product_id":100079601,"comment_content":"老师你好，我在“第 2 步，安装并运行 iam-apiserver”中，创建并安装unit文件后，在&#47;etc&#47;systemd&#47;system目录下可以找到iam-apiserver.service文件，但在执行sudo systemctl enable iam-apiserver时会提示错误：Failed to enable unit: Unit file iam-apiserver.service does not exist.请问这是什么情况？   对linux不是很懂，希望老师能够指导～<br>","like_count":1},{"had_liked":false,"id":349405,"user_name":"VENI VIDI VICI","can_delete":false,"product_type":"c1","uid":3003166,"ip_address":"","ucode":"6E73C0F8C83BD7","user_header":"https://static001.geekbang.org/account/avatar/00/2d/d3/1e/79cb4fa5.jpg","comment_is_top":false,"comment_ctime":1655951148,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"5950918444","product_id":100079601,"comment_content":"make[1]: *** [scripts&#47;make-rules&#47;golang.mk:60: go.build.linux_amd64.iam-apiserver] Error 1<br>麻了","like_count":1,"discussions":[{"author":{"id":2054611,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKBENQekdV3e9XwRQ5kpO9Y9d81sEMm52qcwJWbFbWbW2rniaTFYCChoR0ibZ0E3soQqod9rvfmBibmQ/132","nickname":"校歌","note":"","ucode":"CD257668BB1A33","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577580,"discussion_content":"看了下makefile，其实最终就是 go build cmd/iam-apiserver/apiserver.go ， 盲猜你用的go 1.18+的版本，换成老师的go1.17.2 。\n\n原因好像是go1.18 引入了go.work。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656214627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":2871999,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/d2/bf/c9abe2c6.jpg","nickname":"Scottylu","note":"","ucode":"C8845254A59C37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2054611,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKBENQekdV3e9XwRQ5kpO9Y9d81sEMm52qcwJWbFbWbW2rniaTFYCChoR0ibZ0E3soQqod9rvfmBibmQ/132","nickname":"校歌","note":"","ucode":"CD257668BB1A33","race_medal":1,"user_type":1,"is_pvip":true},"discussion":{"id":579894,"discussion_content":"上一节准备的时候不是让安装go1.18.3 linux/amd64吗，怎么又改成了1.17.2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657762680,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":577580,"ip_address":""},"score":579894,"extra":""},{"author":{"id":1356077,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/2d/661132f3.jpg","nickname":"佚名","note":"","ucode":"A4E35B21AC3C31","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2871999,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/d2/bf/c9abe2c6.jpg","nickname":"Scottylu","note":"","ucode":"C8845254A59C37","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579914,"discussion_content":"麻了，我本来1.17，看前面说要1.18.3，才升级的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657771249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":579894,"ip_address":""},"score":579914,"extra":""},{"author":{"id":2871999,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/d2/bf/c9abe2c6.jpg","nickname":"Scottylu","note":"","ucode":"C8845254A59C37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1356077,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/2d/661132f3.jpg","nickname":"佚名","note":"","ucode":"A4E35B21AC3C31","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":579951,"discussion_content":"😅","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657783857,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":579914,"ip_address":""},"score":579951,"extra":""}]},{"author":{"id":2054611,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKBENQekdV3e9XwRQ5kpO9Y9d81sEMm52qcwJWbFbWbW2rniaTFYCChoR0ibZ0E3soQqod9rvfmBibmQ/132","nickname":"校歌","note":"","ucode":"CD257668BB1A33","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":577542,"discussion_content":"遇到同样的问题了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656169845,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347084,"user_name":"Geek_9e1c1a","can_delete":false,"product_type":"c1","uid":2903968,"ip_address":"","ucode":"A79B61F7118DF6","user_header":"","comment_is_top":false,"comment_ctime":1653704041,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5948671337","product_id":100079601,"comment_content":"老师这个依赖包一直下载不下来<br>github.com&#47;coreos&#47;go-semver@v0.3.0: reading github.com&#47;coreos&#47;go-semver&#47;go.mod at revision v0.3.0: git ls-remote -q origin in &#47;home&#47;going&#47;workspace&#47;golang&#47;pkg&#47;mod&#47;cache&#47;vcs&#47;54f8ad6f53ef8355bbb6f0e79032ea69bdb4fb42df4d33b51ee236693d58179f: exit status 128:<br>        fatal: unable to access &#39;https:&#47;&#47;github.com.cnpmjs.org&#47;coreos&#47;go-semver&#47;&#39;: Could not resolve host: github.com.cnpmjs.org","like_count":1,"discussions":[{"author":{"id":1001225,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/09/316b0aa1.jpg","nickname":"张浩","note":"","ucode":"DBEAFFB7660813","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574699,"discussion_content":"我也遇到类似的问题了， 直接使用https://github.com不会遇到问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654262946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2816898,"avatar":"","nickname":"Geek_562197","note":"","ucode":"E17FCB9C3F349D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574651,"discussion_content":"我也是\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654234624,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345627,"user_name":"东方奇骥","can_delete":false,"product_type":"c1","uid":1354850,"ip_address":"","ucode":"DEE7085F7E55A4","user_header":"https://static001.geekbang.org/account/avatar/00/14/ac/62/37912d51.jpg","comment_is_top":false,"comment_ctime":1652440392,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"5947407688","product_id":100079601,"comment_content":"api server如果起不来，可以去看日志：<br>1. 先从配置文件目录中找到日志目录<br>cd ${IAM_CONFIG_DIR}<br>vim iam-apiserver.yaml<br><br>2. 查看日志<br>vim &#47;var&#47;log&#47;iam&#47;iam-apiserver.log<br><br>2022-05-13 19:05:16.486 ^[[34mINFO^[[0m apiserver       gorm@v1.22.4&#47;gorm.go:202        mysql&#47;mysql.go:79[error] failed to initialize database, got error Error 1045: Access denied for user &#39;iam&#39;@&#39;172.18.0.1&#39; (using password: YES)<br>2022-05-13 19:05:16.486 ^[[31mFATAL^[[0m        apiserver       apiserver&#47;server.go:139 Failed to get cache instance: got nil cache server<br><br>我遇到的问题是，MariaDB数据库连接的密码和老师的不一样，改了就好了。","like_count":1,"discussions":[{"author":{"id":1484631,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a7/57/5d679705.jpg","nickname":"MafiaAlien","note":"","ucode":"28F60D540AC50B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590019,"discussion_content":"不好意思我也遇到同样问题了，请问MariaDB连接密码怎么改呢，我用的docker安装的，谢谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665470165,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"美国"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344795,"user_name":"H.xu","can_delete":false,"product_type":"c1","uid":2058007,"ip_address":"","ucode":"5FD118EA1A44B0","user_header":"https://static001.geekbang.org/account/avatar/00/1f/67/17/cbd5c23f.jpg","comment_is_top":false,"comment_ctime":1651796377,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5946763673","product_id":100079601,"comment_content":"执行curl https:&#47;&#47;marmotedu-1254073058.cos.ap-beijing.myqcloud.com&#47;iam-release&#47;latest&#47;iam.tar.gz这条命令会有如下情况<br>&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39; ?&gt;<br>&lt;Error&gt;<br>        &lt;Code&gt;UnavailableForLegalReasons&lt;&#47;Code&gt;<br>        &lt;Message&gt;Your account has been banned for the reason of violations, please delete the illegal objects.&lt;&#47;Message&gt;<br>        &lt;Resource&gt;marmotedu-1254073058.cos.ap-beijing.myqcloud.com&#47;iam-release&#47;latest&#47;iam.tar.gz&lt;&#47;Resource&gt;<br>        &lt;RequestId&gt;NjI3NDY4NjlfOTBjOTJhMDlfOWUwYV8zZGI1N2M1&lt;&#47;RequestId&gt;<br>        &lt;TraceId&gt;OGVmYzZiMmQzYjA2OWNhODk0NTRkMTBiOWVmMDAxODc0OWRkZjk0ZDM1NmI1M2E2MTRlY2MzZDhmNmI5MWI1OTVmYzc0YmEzZDg5YTVjMDA4YzA3ZWY5ZjQwZTE2ZGU1NDIzMTk4YTA3NzNhMmIzMWZhMTNhNWM2NmVmMDc5MmM=&lt;&#47;TraceId&gt;<br>&lt;&#47;Error&gt;","like_count":1,"discussions":[{"author":{"id":3038509,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/5d/2d/f601e57e.jpg","nickname":"B.B.dong💣💣💣💣💣💣","note":"","ucode":"905243901A8D88","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578234,"discussion_content":"因为这个地址访问不了， 很恼火  ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656596181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2088369,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqfyg3qhXibiamn0vTSW8vSQlY7thTv9BnDHnNQbkVyHnxJSfXG1via5sia8iboQ5jpj9BXHQfFINkYHwQ/132","nickname":"Geek_bc2ff7","note":"","ucode":"88063F9848D1B9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":578190,"discussion_content":"我也出现了一样的情况，请问你知道是什么原因了吗，是不是老师的服务挂掉了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1656561991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340612,"user_name":"fcl","can_delete":false,"product_type":"c1","uid":2774638,"ip_address":"","ucode":"9FC74C4B1DD0B3","user_header":"https://static001.geekbang.org/account/avatar/00/2a/56/6e/de7da340.jpg","comment_is_top":false,"comment_ctime":1648973283,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5943940579","product_id":100079601,"comment_content":"去年搞了半个星期没弄出来直接放弃了，本来该vi开打粘贴的内容，我以为是复制到命令行去输入。vim实在用不惯，暂时安装了vscode来用（然而也启动不了）。<br>学了半年各种课程之后回来半天全部搭建完毕，除了&#47;v1&#47;authz返回的是invalid，其他都没问题，对https只有粗浅的了解，完全看不懂cfssl，但还是很有收获，哈哈~ 继续看后面的课程希望可以找到答案","like_count":1},{"had_liked":false,"id":320073,"user_name":"早睡使人快乐","can_delete":false,"product_type":"c1","uid":2097952,"ip_address":"","ucode":"060FA610B12E39","user_header":"https://static001.geekbang.org/account/avatar/00/20/03/20/a7fa8c64.jpg","comment_is_top":false,"comment_ctime":1636076082,"is_pvip":true,"replies":[{"id":"116861","content":"什么系统呢。看报错少了libsepol 。可以先安装libsepol ：<br><br>yum -y install libsepol.x86_64 libsepol-static.x86_64 libsepol-devel.x86_64<br><br>","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1637062336,"ip_address":"","comment_id":320073,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5931043378","product_id":100079601,"comment_content":"安装MariDb的时候报错是为啥,看报错是缺少依赖?<br>Error: Package: MariaDB-server-10.5.12-1.el8.x86_64 (mariadb)<br>           Requires: libsepol &gt;= 2.8<br>           Installed: libsepol-2.5-10.el7.x86_64 (@anaconda)<br>               libsepol = 2.5-10.el7<br> You could try using --skip-broken to work around the problem<br> You could try running: rpm -Va --nofiles --nodigest<br>!!! [1105 09:19:55] Call tree:<br>!!! [1105 09:19:55]  1: .&#47;scripts&#47;install&#47;mariadb.sh:36 iam::common::sudo(...)<br>!!! [1105 09:19:55]  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23<br>  Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23. &#39;((i&lt;4-1))&#39; exited with status 0 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23 iam::common::sudo(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:36 iam::mariadb::install(...)<br>  3: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)<br>","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530378,"discussion_content":"什么系统呢。看报错少了libsepol 。可以先安装libsepol ：\n\nyum -y install libsepol.x86_64 libsepol-static.x86_64 libsepol-devel.x86_64\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637062336,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886549,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c9/55/8973db30.jpg","nickname":"七桐木","note":"","ucode":"90B766A0A6C334","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535395,"discussion_content":"我知道你的错误因为啥，哈哈，因为你的系统不是centos8吧，需要改动安装脚本的哦，把 老师的centos8改为你的系统版本","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638426685,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318297,"user_name":"pmpleader","can_delete":false,"product_type":"c1","uid":2805709,"ip_address":"","ucode":"3D0723F627A97C","user_header":"https://static001.geekbang.org/account/avatar/00/2a/cf/cd/32b1c1a7.jpg","comment_is_top":false,"comment_ctime":1635235380,"is_pvip":false,"replies":[{"id":"115972","content":"应该是网络抖动，可以手动下载安装cfssl工具。","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1636004761,"ip_address":"","comment_id":318297,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5930202676","product_id":100079601,"comment_content":"安装cfssl时报错误；<br><br> .&#47;scripts&#47;install&#47;install.sh:293. &#39;((i&lt;3-1))&#39; exited with status 4<br><br>麻烦看看啥原因呢？","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529175,"discussion_content":"应该是网络抖动，可以手动下载安装cfssl工具。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636004761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2757858,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","nickname":"顺势而为","note":"","ucode":"FE7D688D24823E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580790,"discussion_content":"建议加proxy安装，我本来安装需要很久，加了代理之后，几分钟搞定。\n# 配置 GOPROXY 环境变量\nexport GOPROXY=https://proxy.golang.com.cn,direct\n# 还可以设置不走 proxy 的私有仓库或组，多个用逗号相隔（可选）\nexport GOPRIVATE=git.mycompany.com,github.com/my/private\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658374127,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315843,"user_name":"授人以🐟，不如授人以渔","can_delete":false,"product_type":"c1","uid":1193874,"ip_address":"","ucode":"BD53829E924B66","user_header":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","comment_is_top":false,"comment_ctime":1634019898,"is_pvip":true,"replies":[{"id":"114938","content":"感谢分享！","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1634742410,"ip_address":"","comment_id":315843,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5928987194","product_id":100079601,"comment_content":"如果是 Mac 的同学，尽量在 VirtualBox 中虚拟 CentOS。如果模拟处的 CentOS 有一些复制&#47;粘贴，以及界面预览受限的问题，可以考虑在 Mac 端 SSH 连接到本地虚拟机上。","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528182,"discussion_content":"感谢分享！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634742410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310963,"user_name":"热爱学习","can_delete":false,"product_type":"c1","uid":1046673,"ip_address":"","ucode":"9F7D4054F65D66","user_header":"","comment_is_top":false,"comment_ctime":1631002289,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5925969585","product_id":100079601,"comment_content":"从虚拟机安装到项目部署，两气呵成，运维可能两周的工作量，这里四五个小时就over了，可见作者对项目部署脚本质量把控的很好。","like_count":1},{"had_liked":false,"id":306453,"user_name":"陈麒文","can_delete":false,"product_type":"c1","uid":2187256,"ip_address":"","ucode":"41475885FA5AD5","user_header":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","comment_is_top":false,"comment_ctime":1628566794,"is_pvip":false,"replies":[{"id":"111439","content":"systemctl status mariadb -l 看看报啥错，不行自己手动安装下","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1629251709,"ip_address":"","comment_id":306453,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5923534090","product_id":100079601,"comment_content":"执行：.&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::install<br>Installed:<br>  MariaDB-client-10.5.12-1.el8.x86_64            MariaDB-common-10.5.12-1.el8.x86_64                            MariaDB-server-10.5.12-1.el8.x86_64           <br>  MariaDB-shared-10.5.12-1.el8.x86_64            boost-program-options-1.66.0-10.el8.x86_64                     galera-4-26.4.9-1.el8.x86_64                  <br>  lsof-4.93.2-1.el8.x86_64                       perl-DBI-1.641-3.module_el8.1.0+199+8f0a6bbd.x86_64            rsync-3.1.3-12.el8.x86_64                     <br>  socat-1.7.3.3-2.el8.x86_64                    <br><br>Complete!<br>Created symlink &#47;etc&#47;systemd&#47;system&#47;multi-user.target.wants&#47;mariadb.service → &#47;usr&#47;lib&#47;systemd&#47;system&#47;mariadb.service.<br>Job for mariadb.service failed because the control process exited with error code.<br>See &quot;systemctl status mariadb.service&quot; and &quot;journalctl -xe&quot; for details.<br>!!! [0809 23:37:42] Call tree:<br>!!! [0809 23:37:42]  1: .&#47;scripts&#47;install&#47;mariadb.sh:40 iam::common::sudo(...)<br>!!! [0809 23:37:42]  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23<br>  Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23. &#39;((i&lt;4-1))&#39; exited with status 0 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23 iam::common::sudo(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:40 iam::mariadb::install(...)<br>  3: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)<br>Exiting with status 1<br><br>后面执行：.&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::uninstall 后再执行.&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::install 还是抱同样的错<br>","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524773,"discussion_content":"systemctl status mariadb -l 看看报啥错，不行自己手动安装下","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1629251709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2282358,"avatar":"https://static001.geekbang.org/account/avatar/00/22/d3/76/5d0c15b7.jpg","nickname":"xiao","note":"","ucode":"D00D6823DB240C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394574,"discussion_content":"想问下这个问题解决了没，我也遇到了同样的问题","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1631944412,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306281,"user_name":"Fan","can_delete":false,"product_type":"c1","uid":1115232,"ip_address":"","ucode":"3BF28670FD9407","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/60/64d166b6.jpg","comment_is_top":false,"comment_ctime":1628485097,"is_pvip":false,"replies":[{"id":"110896","content":"优秀了！","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628524569,"ip_address":"","comment_id":306281,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5923452393","product_id":100079601,"comment_content":"终于安装完了。哈哈哈","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524702,"discussion_content":"优秀了！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628524569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305176,"user_name":"欧雄虎(Badguy）","can_delete":false,"product_type":"c1","uid":1573307,"ip_address":"","ucode":"D72B1CC455AA56","user_header":"https://static001.geekbang.org/account/avatar/00/18/01/bb/7d15d44a.jpg","comment_is_top":false,"comment_ctime":1627869915,"is_pvip":true,"replies":[{"id":"110640","content":"这个不是IAM的问题。<br><br>redis要你加个systemd unit文件了，然后调用：<br>systemctl enable redis。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628165768,"ip_address":"","comment_id":305176,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5922837211","product_id":100079601,"comment_content":"老师服务器重启之后redis不会自启动，我排查了一下，貌似不是我这边步骤的问题，建议修复一下哦！","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524305,"discussion_content":"这个不是IAM的问题。\n\nredis要你加个systemd unit文件了，然后调用：\nsystemctl enable redis。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628165768,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305038,"user_name":"⁶₆⁶₆⁶₆","can_delete":false,"product_type":"c1","uid":1940453,"ip_address":"","ucode":"25AE3F77318541","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9b/e5/bd0be5c3.jpg","comment_is_top":false,"comment_ctime":1627786887,"is_pvip":true,"replies":[{"id":"110649","content":"好主意，我后面搞个！","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628166056,"ip_address":"","comment_id":305038,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5922754183","product_id":100079601,"comment_content":"建议老师的一键安装可以制作成dockers镜像，直接拉取镜像的话就可以屏蔽平台差异了，不然我这边使用的是Ubuntu环境，还不能直接使用那个一键安装脚本，还得一项项的去适配，比较麻烦了","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524256,"discussion_content":"好主意，我后面搞个！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628166056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301667,"user_name":"oneWalker","can_delete":false,"product_type":"c1","uid":1368775,"ip_address":"","ucode":"0FC573E3243760","user_header":"https://static001.geekbang.org/account/avatar/00/14/e2/c7/3e1d396e.jpg","comment_is_top":false,"comment_ctime":1625806379,"is_pvip":false,"replies":[{"id":"109211","content":"这么排障：<br><br>1. 首先执行以下命令：<br>$ scripts&#47;install&#47;environment.sh <br><br>2. 看下iam-apiserver是否成功安装到${IAM_INSTALL_DIR}&#47;bin目录下，如果没有手动安装下<br><br>3. 确保iam-apiserver成功安装之后，可以执行以下命令:<br>$ ${IAM_INSTALL_DIR}&#47;bin&#47;iam-apiserver --config=${IAM_CONFIG_DIR}&#47;iam-apiserver.yaml<br><br>看下有错误输出没，如果有根据错误输出进行排障<br>看下命令报什么错误。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625849513,"ip_address":"","comment_id":301667,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5920773675","product_id":100079601,"comment_content":"~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam<br>===========&gt; Building binary iam-apiserver v1.0.3 for linux amd64<br>!!! [0709 12:52:07] iam-apiserver failed to start, maybe not installed properly<br>!!! Error in .&#47;scripts&#47;install&#47;install.sh:387<br>  Error in .&#47;scripts&#47;install&#47;install.sh:387. &#39;return 1&#39; exited with status 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;install.sh:387 main(...)<br>Exiting with status 1<br>","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523061,"discussion_content":"这么排障：\n\n1. 首先执行以下命令：\n$ scripts/install/environment.sh \n\n2. 看下iam-apiserver是否成功安装到${IAM_INSTALL_DIR}/bin目录下，如果没有手动安装下\n\n3. 确保iam-apiserver成功安装之后，可以执行以下命令:\n$ ${IAM_INSTALL_DIR}/bin/iam-apiserver --config=${IAM_CONFIG_DIR}/iam-apiserver.yaml\n\n看下有错误输出没，如果有根据错误输出进行排障\n看下命令报什么错误。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625849513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1368775,"avatar":"https://static001.geekbang.org/account/avatar/00/14/e2/c7/3e1d396e.jpg","nickname":"oneWalker","note":"","ucode":"0FC573E3243760","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383571,"discussion_content":"提供的environment.sh根本无法在系统中运行起来，用的腾讯云的服务器和centos8.2哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626162900,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300146,"user_name":"井雨姗🐳","can_delete":false,"product_type":"c1","uid":2383018,"ip_address":"","ucode":"9ABBE140B789A9","user_header":"https://static001.geekbang.org/account/avatar/00/24/5c/aa/f032e8e2.jpg","comment_is_top":false,"comment_ctime":1625020971,"is_pvip":false,"replies":[{"id":"108920","content":"给力!","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625273222,"ip_address":"","comment_id":300146,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5919988267","product_id":100079601,"comment_content":"在 ”安装 iam-pump 可执行程序“ 遇到问题如下：<br>go build github.com&#47;olivere&#47;elastic&#47;v7: &#47;root&#47;go&#47;go1.16.2&#47;pkg&#47;tool&#47;linux_amd64&#47;compile: signal: killed<br>make[1]: *** [scripts&#47;make-rules&#47;golang.mk:60: go.build.linux_amd64.iam-pump] Error 1<br>make: *** [Makefile:60: build] Error 2<br><br>原因是整个系统的内存已经不足<br>1. 判断是不是内存原因：https:&#47;&#47;blog.csdn.net&#47;ktigerhero3&#47;article&#47;details&#47;80004315<br>2. 解决办法：https:&#47;&#47;blog.csdn.net&#47;weixin_33805557&#47;article&#47;details&#47;88924468","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522654,"discussion_content":"给力!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625273222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299035,"user_name":"Summing余苏明","can_delete":false,"product_type":"c1","uid":1309332,"ip_address":"","ucode":"20FF0ED6B5FFC1","user_header":"https://static001.geekbang.org/account/avatar/00/13/fa/94/479b0b00.jpg","comment_is_top":false,"comment_ctime":1624433119,"is_pvip":false,"replies":[{"id":"108642","content":"如果脚本名叫test.sh，直接执行.&#47;test.sh，不要执行sh test.sh","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624710030,"ip_address":"","comment_id":299035,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5919400415","product_id":100079601,"comment_content":"老师,我看您的shell脚本里面函数命名都是以::分割的,但是我自己测试的时候,使用这样的命名,执行报错<br>`echo::test&#39;: not a valid identifier<br>是需要加什么参数么?","like_count":1,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522309,"discussion_content":"如果脚本名叫test.sh，直接执行./test.sh，不要执行sh test.sh","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624710030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":360271,"user_name":"帅到没朋友","can_delete":false,"product_type":"c1","uid":1939759,"ip_address":"湖北","ucode":"A3DBC3040DE2BC","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/gLTQicPPdEmAG98BSC1Cia9YwztjpaKxlAVA2TV8IXu95n48f3doGTGMZhXIxa2s5SsgBygHne3RftjhOVnh0q6Q/132","comment_is_top":false,"comment_ctime":1666362262,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1666362262","product_id":100079601,"comment_content":"$ curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6Ikw1WGdNaWRTbTJjcmViNWtjRGM3UVZDWEQ0M0J6aElQNlprbSIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTY2NjM2ODc1OSwiaWF0IjoxNjY2MzYxNTU5LCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2NjYzNjE1NTl9.KLTtHfIIr-SUdijCpO6R1doTxIXEFHj0X5reMK49mhU&#39; -d&#39;{&quot;subject&quot;:&quot;users:maria&quot;,&quot;action&quot;:&quot;delete&quot;,&quot;resource&quot;:&quot;resources:articles:ladon-introduction&quot;,&quot;context&quot;:{&quot;remoteIPAddress&quot;:&quot;192.168.0.5&quot;}}&#39; http:&#47;&#47;127.0.0.1:9090&#47;v1&#47;authz<br>{&quot;code&quot;:100202,&quot;message&quot;:&quot;Signature is invalid&quot;}<br>换了token 新加的用户  策略 和秘钥 都不行，都是这个错误。","like_count":0},{"had_liked":false,"id":360175,"user_name":"Geek_b317dc","can_delete":false,"product_type":"c1","uid":3202080,"ip_address":"英国","ucode":"22BCAE226CF541","user_header":"","comment_is_top":false,"comment_ctime":1666254383,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666254383","product_id":100079601,"comment_content":"centos7 安装redis之前需要先安装epel，即yum install epel-release","like_count":0},{"had_liked":false,"id":360154,"user_name":"Geek_b317dc","can_delete":false,"product_type":"c1","uid":3202080,"ip_address":"英国","ucode":"22BCAE226CF541","user_header":"","comment_is_top":false,"comment_ctime":1666236072,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1666236072","product_id":100079601,"comment_content":"用了centos7 x86_64的机器，安装mariadb的时候一直报错，尝试了好久才发现原来是需要修改下mariadb.sh脚本中的版本","like_count":0},{"had_liked":false,"id":359353,"user_name":"MafiaAlien","can_delete":false,"product_type":"c1","uid":1484631,"ip_address":"美国","ucode":"28F60D540AC50B","user_header":"https://static001.geekbang.org/account/avatar/00/16/a7/57/5d679705.jpg","comment_is_top":false,"comment_ctime":1665467545,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665467545","product_id":100079601,"comment_content":"老师请教两个问题<br>1.iamctl安装完毕后执行user list报错<br>error: Get &quot;https:&#47;&#47;127.0.0.1:8443&#47;v1&#47;users?limit=1000&amp;offset=0&quot;: dial tcp 127.0.0.1:8443: connect: connection refused<br>找了半天也没找到问题原因，请问是什么引起的呢<br>2.iam-apiserver安装完成后查看status一直是activating状态，清楚什么原因<br>iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Tue 2022-10-11 04:48:39 UTC; 3s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 32760 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=1&#47;FAILURE)<br>  Process: 32758 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 32757 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 32760 (code=exited, status=1&#47;FAILURE)<br>感谢解答！！","like_count":0},{"had_liked":false,"id":359179,"user_name":"Jiaozn","can_delete":false,"product_type":"c1","uid":1150056,"ip_address":"山东","ucode":"DB8F1F150B0533","user_header":"https://static001.geekbang.org/account/avatar/00/11/8c/68/712b7445.jpg","comment_is_top":false,"comment_ctime":1665307211,"is_pvip":false,"discussion_count":0,"race_medal":5,"score":"1665307211","product_id":100079601,"comment_content":"采坑无数，go版本问题、系统问题、yum问题、脚本问题等，<br>安装成功，继续下一节","like_count":0},{"had_liked":false,"id":358145,"user_name":"MrDa","can_delete":false,"product_type":"c1","uid":1997697,"ip_address":"四川","ucode":"CF54205FB69FAA","user_header":"https://static001.geekbang.org/account/avatar/00/1e/7b/81/9ae9680a.jpg","comment_is_top":false,"comment_ctime":1663941781,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1663941781","product_id":100079601,"comment_content":"我吐了。 `.&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::install`，这个`mariadb.sh`是哪儿来的嘛","like_count":0},{"had_liked":false,"id":357071,"user_name":"唐经","can_delete":false,"product_type":"c1","uid":3177960,"ip_address":"广东","ucode":"C54F49F5AF414E","user_header":"https://static001.geekbang.org/account/avatar/00/30/7d/e8/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1662908702,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662908702","product_id":100079601,"comment_content":"安装脚本中数据库下的是amd的。但是我是arm架构，要换机器了。","like_count":0},{"had_liked":false,"id":356380,"user_name":"qiutian","can_delete":false,"product_type":"c1","uid":1313498,"ip_address":"浙江","ucode":"99658A8E342498","user_header":"https://static001.geekbang.org/account/avatar/00/14/0a/da/dcf8f2b1.jpg","comment_is_top":false,"comment_ctime":1662221777,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1662221777","product_id":100079601,"comment_content":"又装了一遍，发现在MongoDB那里下载的时候一直timeout，我发现直接去https:&#47;&#47;repo.mongodb.org&#47;yum&#47;redhat&#47;8&#47;mongodb-org&#47;5.0&#47;x86_64&#47;RPMS&#47; 这个地址将文件下载下来，然后通过SFTP传到&#47;var&#47;cache&#47;dnf&#47;mongodb-org-5.0-85529b2afce6c228&#47;packages这个目录下，再安装就好了","like_count":0},{"had_liked":false,"id":356225,"user_name":"Beemaven","can_delete":false,"product_type":"c1","uid":2002714,"ip_address":"云南","ucode":"B6AD26C8E3A55A","user_header":"https://static001.geekbang.org/account/avatar/00/1e/8f/1a/5d6b48c7.jpg","comment_is_top":false,"comment_ctime":1662051576,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1662051576","product_id":100079601,"comment_content":"老师，您好！在执行 .&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::install 代码的时候出现了很多错误，因为字数有限，我这里截取首、尾的报错，烦请老师帮助判断并指导：<br><br>报错（首）：Error: Package: MariaDB-client-10.5.17-1.el8.x86_64 (mariadb)<br>           Requires: libc.so.6(GLIBC_2.28)(64bit)<br>Error: Package: MariaDB-server-10.5.17-1.el8.x86_64 (mariadb)<br>           Requires: libstdc++.so.6(CXXABI_1.3.8)(64bit)<br>Error: Package: MariaDB-server-10.5.17-1.el8.x86_64 (mariadb)<br>           Requires: libstdc++.so.6(GLIBCXX_3.4.22)(64bit)<br>Error: Package: MariaDB-client-10.5.17-1.el8.x86_64 (mariadb)<br>           Requires: libcrypto.so.1.1(OPENSSL_1_1_0)(64bit)<br>Error: Package: galera-4-26.4.12-1.el8.x86_64 (mariadb)<br>           Requires: libssl.so.1.1(OPENSSL_1_1_1)(64bit)<br>报错：<br>You could try using --skip-broken to work around the problem<br> You could try running: rpm -Va --nofiles --nodigest<br>!!! [0902 00:55:35] Call tree:<br>!!! [0902 00:55:35]  1: .&#47;scripts&#47;install&#47;mariadb.sh:36 iam::common::sudo(...)<br>!!! [0902 00:55:35]  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23<br>  Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23. &#39;((i&lt;4-1))&#39; exited with status 0 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23 iam::common::sudo(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:36 iam::mariadb::install(...)<br>  3: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)<br>Exiting with status 1<br><br>然后就导致后面的mysql命令无法使用<br>","like_count":0},{"had_liked":false,"id":354643,"user_name":"includestdio.h","can_delete":false,"product_type":"c1","uid":2314854,"ip_address":"中国香港","ucode":"5027BACE9319CD","user_header":"https://static001.geekbang.org/account/avatar/00/23/52/66/3e4d4846.jpg","comment_is_top":false,"comment_ctime":1660636068,"is_pvip":true,"discussion_count":0,"race_medal":4,"score":"1660636068","product_id":100079601,"comment_content":"Failed to parse input: unexpected end of JSON input 难道就我一个在执行 cfssl gencert -initca ca-csr.json | cfssljson -bare ca 遇到了这个问题 ，我核对了下 ca 文件和老师的配置一摸一样 ","like_count":0},{"had_liked":false,"id":354642,"user_name":"includestdio.h","can_delete":false,"product_type":"c1","uid":2314854,"ip_address":"中国香港","ucode":"5027BACE9319CD","user_header":"https://static001.geekbang.org/account/avatar/00/23/52/66/3e4d4846.jpg","comment_is_top":false,"comment_ctime":1660636003,"is_pvip":true,"discussion_count":0,"race_medal":4,"score":"1660636003","product_id":100079601,"comment_content":"Failed to parse input: unexpected end of JSON input","like_count":0},{"had_liked":false,"id":354042,"user_name":"无名","can_delete":false,"product_type":"c1","uid":2373540,"ip_address":"河南","ucode":"965FAF66824A42","user_header":"https://static001.geekbang.org/account/avatar/00/24/37/a4/e357c13a.jpg","comment_is_top":false,"comment_ctime":1660038749,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1660038749","product_id":100079601,"comment_content":"老师请问在安装aim-server的时候 以下这几句没看懂，没看到在哪里编译了go文件成一个可执行程序<br>source scripts&#47;install&#47;environment.sh<br>$ make build BINS=iam-apiserver<br>$ sudo cp _output&#47;platforms&#47;linux&#47;amd64&#47;iam-apiserver ${IAM_INSTALL_DIR}&#47;bin","like_count":0},{"had_liked":false,"id":352615,"user_name":"朱元彬🗿","can_delete":false,"product_type":"c1","uid":2725689,"ip_address":"","ucode":"9CBD43225EE65B","user_header":"https://static001.geekbang.org/account/avatar/00/29/97/39/1f5c6350.jpg","comment_is_top":false,"comment_ctime":1658813256,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658813256","product_id":100079601,"comment_content":"sudo systemctl restart iam-authz-server 一直报错啊<br>执行systemctl status iam-authz-server 提示：<br>Precess: 4552 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-zuthz-server (code=exited, status=200&#47;CHDIR)<br>google了各种办法都没法解决，请问下老师，这是咋回事？","like_count":0},{"had_liked":false,"id":352425,"user_name":"码小呆","can_delete":false,"product_type":"c1","uid":2055809,"ip_address":"","ucode":"44532D6ABF9340","user_header":"https://static001.geekbang.org/account/avatar/00/1f/5e/81/82709d6e.jpg","comment_is_top":false,"comment_ctime":1658657375,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1658657375","product_id":100079601,"comment_content":"其实用一个和老师一样环境的机器是很好就安装成功的,<br>clientVersion:<br>  buildDate: &quot;2022-07-24T09:54:50Z&quot;<br>  compiler: gc<br>  gitCommit: ad51512971643ccc64735c07246a99804078209d<br>  gitTreeState: dirty<br>  gitVersion: ad51512<br>  goVersion: go1.18.3<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2022-07-24T09:37:45Z&quot;<br>  compiler: gc<br>  gitCommit: ad51512971643ccc64735c07246a99804078209d<br>  gitTreeState: dirty<br>  gitVersion: ad51512<br>  goVersion: go1.18.3<br>  platform: linux&#47;amd64","like_count":0},{"had_liked":false,"id":352345,"user_name":"SquatCobbler","can_delete":false,"product_type":"c1","uid":3048349,"ip_address":"","ucode":"D9476BBD0EDCD9","user_header":"https://static001.geekbang.org/account/avatar/00/2e/83/9d/57cdc461.jpg","comment_is_top":false,"comment_ctime":1658566565,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658566565","product_id":100079601,"comment_content":"安装完iam-apiserver后启动失败，请问是什么原因呢？<br><br>[squatcobbler@dev iam]$ systemctl status iam-apiserver<br>● iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Sat 2022-07-23 16:13:35 CST; 3s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 13698 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=1&#47;FAILURE)<br>  Process: 13697 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 13695 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 13698 (code=exited, status=1&#47;FAILURE)<br><br>Jul 23 16:13:35 centos-linux.shared systemd[1]: iam-apiserver.service: Main process exited, code=exited, status=1&#47;FAILURE<br>Jul 23 16:13:35 centos-linux.shared systemd[1]: iam-apiserver.service: Failed with result &#39;exit-code&#39;.","like_count":0},{"had_liked":false,"id":352240,"user_name":"抚凌","can_delete":false,"product_type":"c1","uid":1553271,"ip_address":"","ucode":"D549A14FB82EA7","user_header":"https://static001.geekbang.org/account/avatar/00/17/b3/77/1098203c.jpg","comment_is_top":false,"comment_ctime":1658474568,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658474568","product_id":100079601,"comment_content":"centos8 镜像都下不到了，怎么办，这么好的课程做不了实验呀！","like_count":0},{"had_liked":false,"id":352136,"user_name":"Geek_3267a8","can_delete":false,"product_type":"c1","uid":2832633,"ip_address":"","ucode":"1C4037A7239AD0","user_header":"","comment_is_top":false,"comment_ctime":1658396545,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658396545","product_id":100079601,"comment_content":"弄了一天终于完成了 555 希望坚持学习下去 <br>iamctl version -o yaml<br>clientVersion:<br>  buildDate: &quot;2022-07-21T09:23:24Z&quot;<br>  compiler: gc<br>  gitCommit: 6a8f18a190f3079e48eca22b0eba4cb4a2c078d1<br>  gitTreeState: dirty<br>  gitVersion: v1.1.0<br>  goVersion: go1.18.3<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2022-07-21T09:03:37Z&quot;<br>  compiler: gc<br>  gitCommit: 6a8f18a190f3079e48eca22b0eba4cb4a2c078d1<br>  gitTreeState: dirty<br>  gitVersion: v1.1.0<br>  goVersion: go1.18.3<br>  platform: linux&#47;amd64","like_count":0},{"had_liked":false,"id":352066,"user_name":"顺势而为","can_delete":false,"product_type":"c1","uid":2757858,"ip_address":"","ucode":"FE7D688D24823E","user_header":"https://static001.geekbang.org/account/avatar/00/2a/14/e2/f6f1627c.jpg","comment_is_top":false,"comment_ctime":1658372039,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658372039","product_id":100079601,"comment_content":"<br>$ cd $IAM_ROOT<br>$ .&#47;scripts&#47;install&#47;install.sh iam::install::install_cfssl<br>证书安装太慢了，建议作者优化一下。","like_count":0},{"had_liked":false,"id":351973,"user_name":"Geek_2423f8","can_delete":false,"product_type":"c1","uid":3066580,"ip_address":"","ucode":"6E50FC15FC2E62","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/QSia8D5qtTGNAqU5Pgme2QBEaiags3pqurWjn6qplU3009JibcKVpW2NibNL1WlhRmO04cBO2ytBOxXzDgHcC6iaRoQ/132","comment_is_top":false,"comment_ctime":1658311495,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1658311495","product_id":100079601,"comment_content":"在部署apiserver的时候，遇到这个问题，没有错误日志，更改output-path也没成功，不知道是哪里有问题<br>iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Thu 2021-07-15 22:44:26 CST; 2s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 70273 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=203&#47;EXEC)<br>  Process: 70271 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 70270 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 70273 (code=exited, status=203&#47;EXEC)","like_count":0},{"had_liked":false,"id":351376,"user_name":"Scottylu","can_delete":false,"product_type":"c1","uid":2871999,"ip_address":"","ucode":"C8845254A59C37","user_header":"https://static001.geekbang.org/account/avatar/00/2b/d2/bf/c9abe2c6.jpg","comment_is_top":false,"comment_ctime":1657762542,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1657762542","product_id":100079601,"comment_content":"老师你好，执行命令make build BINS=iam-apiserver报错<br>===========&gt; Building binary iam-apiserver 9277899 for linux amd64<br>no required module provides package github.com&#47;marmotedu&#47;iam&#47;cmd&#47;iam-apiserver: go.mod file not found in current directory or any parent directory; see &#39;go help modules&#39;<br>make[1]: *** [scripts&#47;make-rules&#47;golang.mk:60: go.build.linux_amd64.iam-apiserver] Error 1<br>make: *** [Makefile:62: build] Error 2<br>我尝试过将go.sum移除并重新生成，但还是无效，请问下是什么问题呢","like_count":0,"discussions":[{"author":{"id":2871999,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/d2/bf/c9abe2c6.jpg","nickname":"Scottylu","note":"","ucode":"C8845254A59C37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580427,"discussion_content":"问了老师后已解决，此处是因为使用了go 1.18，需要配置go.work，执行以下命令\nmm\ngo work use ./iam\n再运行即可","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1658162257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1356077,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/2d/661132f3.jpg","nickname":"佚名","note":"","ucode":"A4E35B21AC3C31","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579932,"discussion_content":"我看了一圈，说是因为版本的问题，然后看了下go.mod里的内容，发现go写的是1.17，把它改成1.18，这条命令就成功了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657779635,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351219,"user_name":"Cai-WB","can_delete":false,"product_type":"c1","uid":2167169,"ip_address":"","ucode":"27F0DF7E1A2AF1","user_header":"https://static001.geekbang.org/account/avatar/00/21/11/81/4401bed8.jpg","comment_is_top":false,"comment_ctime":1657615994,"is_pvip":true,"discussion_count":3,"race_medal":0,"score":"1657615994","product_id":100079601,"comment_content":"$ cd $IAM_ROOT<br>$ source scripts&#47;install&#47;environment.sh<br>$ make build BINS=iam-apiserver<br>执行make build BINS=iam-apiserver报错，提示no required module provides package github.com&#47;marmotedu&#47;iam&#47;cmd&#47;iam-apiserver: go.mod file not found in current directory or any parent directory;缺少go.mod文件","like_count":0,"discussions":[{"author":{"id":1356077,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/2d/661132f3.jpg","nickname":"佚名","note":"","ucode":"A4E35B21AC3C31","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579933,"discussion_content":"我看了一圈，说是因为版本的问题，然后看了下go.mod里的内容，发现go写的是1.17，把它改成1.18，这条命令就成功了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657779644,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2167169,"avatar":"https://static001.geekbang.org/account/avatar/00/21/11/81/4401bed8.jpg","nickname":"Cai-WB","note":"","ucode":"27F0DF7E1A2AF1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1356077,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b1/2d/661132f3.jpg","nickname":"佚名","note":"","ucode":"A4E35B21AC3C31","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":580084,"discussion_content":"好像还是不行哦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657866606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":579933,"ip_address":""},"score":580084,"extra":""}]},{"author":{"id":2871999,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/d2/bf/c9abe2c6.jpg","nickname":"Scottylu","note":"","ucode":"C8845254A59C37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579895,"discussion_content":"+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657762860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350140,"user_name":"B.B.dong💣💣💣💣💣💣","can_delete":false,"product_type":"c1","uid":3038509,"ip_address":"","ucode":"905243901A8D88","user_header":"https://static001.geekbang.org/account/avatar/00/2e/5d/2d/f601e57e.jpg","comment_is_top":false,"comment_ctime":1656595945,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656595945","product_id":100079601,"comment_content":"https:&#47;&#47;marmotedu-1254073058.cos.ap-beijing.myqcloud.com&#47;    这个地址不维护了吗 ， 怎么访问不了呢 ？？？","like_count":0},{"had_liked":false,"id":350037,"user_name":"Beemaven","can_delete":false,"product_type":"c1","uid":2002714,"ip_address":"","ucode":"B6AD26C8E3A55A","user_header":"https://static001.geekbang.org/account/avatar/00/1e/8f/1a/5d6b48c7.jpg","comment_is_top":false,"comment_ctime":1656514145,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656514145","product_id":100079601,"comment_content":"老师，请问MariaDB和Mysql会不会有环境冲突","like_count":0},{"had_liked":false,"id":349801,"user_name":"有原","can_delete":false,"product_type":"c1","uid":2927617,"ip_address":"","ucode":"BA2B4911E66EDB","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wFFLMkicZicdsG0H4oETYokjdZvg9kzhbU31KGRDBNDc1cDZPa8tnOz0D9TNAibia4wLkLObnAGhvhksKsRibZnSKXA/132","comment_is_top":false,"comment_ctime":1656334599,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656334599","product_id":100079601,"comment_content":"终于。。。<br><br>clientVersion:<br>  buildDate: &quot;2022-06-27T12:42:18Z&quot;<br>  compiler: gc<br>  gitCommit: eb0436e90e1adcedc2d6a8b3c3ea232491a65d92<br>  gitTreeState: dirty<br>  gitVersion: v1.6.2<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2022-06-27T12:28:52Z&quot;<br>  compiler: gc<br>  gitCommit: eb0436e90e1adcedc2d6a8b3c3ea232491a65d92<br>  gitTreeState: dirty<br>  gitVersion: v1.6.2<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64","like_count":0},{"had_liked":false,"id":349738,"user_name":"The brain is a good thing","can_delete":false,"product_type":"c1","uid":1710489,"ip_address":"","ucode":"7CE2C85BC5C092","user_header":"https://static001.geekbang.org/account/avatar/00/1a/19/99/ba3719e1.jpg","comment_is_top":false,"comment_ctime":1656297076,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1656297076","product_id":100079601,"comment_content":"这里有个坑就是，sudo yum install -y mongodb-org 是下载最新版，现在已经5.0了，如果还是配置4.4版本会导致下载超时。官网地址：https:&#47;&#47;www.mongodb.com&#47;docs&#47;manual&#47;tutorial&#47;install-mongodb-on-red-hat&#47; ，根据官网配置最新版本或选择安装特定版本方式。","like_count":0},{"had_liked":false,"id":349677,"user_name":"校歌","can_delete":false,"product_type":"c1","uid":2054611,"ip_address":"","ucode":"CD257668BB1A33","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKBENQekdV3e9XwRQ5kpO9Y9d81sEMm52qcwJWbFbWbW2rniaTFYCChoR0ibZ0E3soQqod9rvfmBibmQ/132","comment_is_top":false,"comment_ctime":1656220580,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1656220580","product_id":100079601,"comment_content":"先说结论，周末花了一天时间，部署成功了，：），这个项目应该能学到 不少东西，赞一个👍🏻","like_count":0},{"had_liked":false,"id":349619,"user_name":"Geek_8de965","can_delete":false,"product_type":"c1","uid":2831170,"ip_address":"","ucode":"75880FD1790C37","user_header":"","comment_is_top":false,"comment_ctime":1656149343,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656149343","product_id":100079601,"comment_content":"老师，我想问一下，机器重启后，redis不会自动启动是吧，也需要添加成服务自动启动","like_count":0},{"had_liked":false,"id":349369,"user_name":"Geek_8de965","can_delete":false,"product_type":"c1","uid":2831170,"ip_address":"","ucode":"75880FD1790C37","user_header":"","comment_is_top":false,"comment_ctime":1655912322,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655912322","product_id":100079601,"comment_content":"老师，关于证书相关的内容有推荐的资料吗","like_count":0},{"had_liked":false,"id":349309,"user_name":"Conn","can_delete":false,"product_type":"c1","uid":1363613,"ip_address":"","ucode":"BC34C44169B1FD","user_header":"https://static001.geekbang.org/account/avatar/00/14/ce/9d/07dd82cf.jpg","comment_is_top":false,"comment_ctime":1655880602,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655880602","product_id":100079601,"comment_content":"半天时间，ubuntu20.04 成功安装。","like_count":0},{"had_liked":false,"id":349246,"user_name":"Morgan","can_delete":false,"product_type":"c1","uid":1192369,"ip_address":"","ucode":"B5E6EAED492864","user_header":"https://static001.geekbang.org/account/avatar/00/12/31/b1/36535da5.jpg","comment_is_top":false,"comment_ctime":1655827802,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655827802","product_id":100079601,"comment_content":"为什么不用docker来安装？","like_count":0},{"had_liked":false,"id":348767,"user_name":"树心","can_delete":false,"product_type":"c1","uid":1589523,"ip_address":"","ucode":"6C329F0FF798B9","user_header":"https://static001.geekbang.org/account/avatar/00/18/41/13/ab14ad25.jpg","comment_is_top":false,"comment_ctime":1655375516,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1655375516","product_id":100079601,"comment_content":"请问后续有对这一节部署内容的介绍吗？使用环境不一样得对操作内容理解了之后才能部署成功，想在后面讲解中一步一步做","like_count":0},{"had_liked":false,"id":348728,"user_name":"水一","can_delete":false,"product_type":"c1","uid":1197807,"ip_address":"","ucode":"BBB7A2C37A20F1","user_header":"https://static001.geekbang.org/account/avatar/00/12/46/ef/cec4a3c7.jpg","comment_is_top":false,"comment_ctime":1655351627,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655351627","product_id":100079601,"comment_content":"[going@dev ~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam]$ ^C<br>[going@dev ~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam]$ sudo systemctl stop cockpit.socket<br>[going@dev ~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam]$ sudo systemctl restart iam-apiserver<br>[going@dev ~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam]$ systemctl status iam-apiserver<br>● iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Thu 2022-06-16 11:46:14 CST; 3s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 19916 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=1&#47;FAILURE)  Process: 19914 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 19912 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 19916 (code=exited, status=1&#47;FAILURE)<br><br><br>卡在iam-apiserver怎么都启动不起来，启动时也没报错","like_count":0},{"had_liked":false,"id":348583,"user_name":"Zvector","can_delete":false,"product_type":"c1","uid":1201888,"ip_address":"","ucode":"DE3ECF18966A74","user_header":"https://static001.geekbang.org/account/avatar/00/12/56/e0/03c8a3e4.jpg","comment_is_top":false,"comment_ctime":1655215183,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655215183","product_id":100079601,"comment_content":"请问这门课有课程讨论群组吗？","like_count":0},{"had_liked":false,"id":348416,"user_name":"追影子的人","can_delete":false,"product_type":"c1","uid":2174687,"ip_address":"","ucode":"D26A00D918454B","user_header":"https://static001.geekbang.org/account/avatar/00/21/2e/df/ac2e0397.jpg","comment_is_top":false,"comment_ctime":1655091415,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1655091415","product_id":100079601,"comment_content":"求求老师帮忙看看，这个是什么原因导致的？<br>iamctl version -o yaml<br>error: Get &quot;https:&#47;&#47;127.0.0.1:8443&#47;version&quot;: x509: certificate signed by unknown authority (possibly because of &quot;crypto&#47;rsa: verification error&quot; while trying to verify candidate authority certificate &quot;iam-ca&quot;)","like_count":0,"discussions":[{"author":{"id":2174687,"avatar":"https://static001.geekbang.org/account/avatar/00/21/2e/df/ac2e0397.jpg","nickname":"追影子的人","note":"","ucode":"D26A00D918454B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575786,"discussion_content":"已经解决了，原因是我更改了ca认证后，没有重新生成apiserver的pem","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655107634,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347885,"user_name":"打工人yyds","can_delete":false,"product_type":"c1","uid":2094061,"ip_address":"","ucode":"6E79D669C88379","user_header":"https://static001.geekbang.org/account/avatar/00/1f/f3/ed/46299341.jpg","comment_is_top":false,"comment_ctime":1654539238,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1654539238","product_id":100079601,"comment_content":"请问为何会出现删除用户错误。mysql未使用上述用户名和密码，在CRUD中，除了删除外均可成功，删除返回如下错误<br>```<br>INFO    apiserver       gorm@v1.21.15&#47;callbacks.go:133  mysql&#47;user.go:69 Error 1449: The user specified as a definer (&#39;iam&#39;@&#39;127.0.0.1&#39;) does not exist[2.500ms] [rows:0] DELETE FROM `user` WHERE name in (&#39;colin&#39;,&#39;mark&#39;,&#39;john&#39;)<br>error   [{&quot;caller&quot;:&quot;#0 &#47;data&#47;gopath&#47;src&#47;github.com&#47;marmotedu&#47;iam&#47;internal&#47;apiserver&#47;service&#47;v1&#47;user.go:153 (github.com&#47;marmotedu&#47;iam&#47;internal&#47;apiserver&#47;service&#47;v1.(*userService).DeleteCollection)&quot;,&quot;code&quot;:100101,&quot;error&quot;:&quot;Error 1449: The user specified as a definer (&#39;iam&#39;@&#39;127.0.0.1&#39;) does not exist&quot;,&quot;message&quot;:&quot;Database error&quot;}]<br>```<br>这似乎是mysql实例使用了其他用户登录，但是<br>打印的dsn和部分iam-apiserver.yaml如下<br>```<br>dsn= root:123456@tcp(127.0.0.1:3306)&#47;iam?charset=utf8&amp;parseTime=true&amp;loc=Local<br><br>mysql:<br>  host: 127.0.0.1:3306 # MySQL 机器 ip 和端口，默认 127.0.0.1:3306<br>  username: root # MySQL 用户名(建议授权最小权限集)<br>  password: 123456 # MySQL 用户密码<br>  database: iam # iam 系统所用的数据库名<br>  max-idle-connections: 100 # MySQL 最大空闲连接数，默认 100<br>  max-open-connections: 100 # MySQL 最大打开的连接数，默认 100<br>  max-connection-life-time: 10s # 空闲连接最大存活时间，默认 10s<br>  log-level: 4 # GORM log level, 1: silent, 2:error, 3:warn, 4:info<br>```<br>PS: iam tag v1.1.0","like_count":0,"discussions":[{"author":{"id":2712334,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/pWlCcThica6hHNnzw1Nj76otnzq5eo6lAkVr8kEy8ZV22Y01hPseJGPDt4K45xANMKY9a33YqjEmskIwQf0hkWg/132","nickname":"Geek_0827c6","note":"","ucode":"19D7C50E46BE9F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575883,"discussion_content":"密钥要一致,可能在他写的shell 脚本中固定了, 我用了 123456登录, 登陆失败了\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655170947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347777,"user_name":"王朝刚","can_delete":false,"product_type":"c1","uid":1752548,"ip_address":"","ucode":"11C0468F747460","user_header":"https://static001.geekbang.org/account/avatar/00/1a/bd/e4/fc8ca6a5.jpg","comment_is_top":false,"comment_ctime":1654417962,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1654417962","product_id":100079601,"comment_content":"手动启动apiserver报了堆栈错误，&#47;opt&#47;iam&#47;bin&#47;iam-apiserver<br>2022-06-05 08:26:13.570 DEBUG   apiserver       storage&#47;redis_cluster.go:189    Creating new Redis connection pool<br>2022-06-05 08:26:13.570 INFO    apiserver       storage&#47;redis_cluster.go:232    --&gt; [REDIS] Creating single-node client<br>unexpected fault address 0x0<br>fatal error: fault<br>[signal SIGSEGV: segmentation violation code=0x80 addr=0x0 pc=0x46695f]<br><br>goroutine 71 [running]:<br>runtime.throw({0xf62e6c?, 0xc0008eec88?})<br>&#47;usr&#47;local&#47;go&#47;src&#47;runtime&#47;panic.go:992 +0x71 fp=0xc0008eec48 sp=0xc0008eec18 pc=0x4366d1<br>runtime.sigpanic()<br>&#47;usr&#47;local&#47;go&#47;src&#47;runtime&#47;signal_unix.go:825 +0x305 fp=0xc0008eec98 sp=0xc0008eec48 pc=0x44c8c5","like_count":0,"discussions":[{"author":{"id":2394693,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/R0t2U57ez7rwmPjyGrmF41tyiaEcib0yQHGarxYvc71N1ooDrK6GMf3THBdDRNTNTJPOACshTib5ibpga6KFibMr6VQ/132","nickname":"Geek_e69b04","note":"","ucode":"7B88DFE1B9F954","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576239,"discussion_content":"请问你这个问题解决了吗，我同样遇到了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655364986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347619,"user_name":"林凯","can_delete":false,"product_type":"c1","uid":3016238,"ip_address":"","ucode":"CC9767F874D098","user_header":"https://static001.geekbang.org/account/avatar/00/2e/06/2e/b5ec6778.jpg","comment_is_top":false,"comment_ctime":1654234412,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1654234412","product_id":100079601,"comment_content":"老师，这个是什么问题，用的一键安装脚本<br>MongoDB Login: mongo mongodb:&#47;&#47;iam:&#39;iam59!z$&#39;@127.0.0.1:27017&#47;iam_analytics?authSource=iam_analytics<br>install MongoDB successfully<br>install storage successfully<br>Cloning into &#39;iam&#39;...<br>fatal: unable to access &#39;https:&#47;&#47;github.com.cnpmjs.org&#47;marmotedu&#47;iam&#47;&#39;: Could not resolve host: github.com.cnpmjs.org<br>.&#47;scripts&#47;install&#47;install.sh: line 222: pushd: &#47;root&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam: No such file or directory<br>ERROR at line 1: Failed to open file &#39;configs&#47;iam.sql&#39;, error: 2<br>prepare for iam installation successfully<br>.&#47;scripts&#47;install&#47;install.sh: line 268: popd: directory stack empty<br>!!! Error in .&#47;scripts&#47;install&#47;install.sh:407<br>  Error in .&#47;scripts&#47;install&#47;install.sh:407. &#39;return 1&#39; exited with status 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;install.sh:407 main(...)<br>Exiting with status 1","like_count":0,"discussions":[{"author":{"id":1468464,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJeUmrVJiaiasCMpK7poias9eicibhXoSWf3jibCC3ECcsk6koLkyV0XqHh1CJibbC5cvbqriaTJHWxDfsicOA/132","nickname":"Geek_6bb688","note":"","ucode":"5B36B8DC5F524B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575659,"discussion_content":"我也碰到这个问题 请问你解决了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655006292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347280,"user_name":"王新","can_delete":false,"product_type":"c1","uid":3016013,"ip_address":"","ucode":"A296149C6C4CAB","user_header":"","comment_is_top":false,"comment_ctime":1653899000,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653899000","product_id":100079601,"comment_content":"想知道老师 这部分 在数据库选型上是有什么考量吗 pg数据库在这方面是否是更适合的","like_count":0},{"had_liked":false,"id":346578,"user_name":"Yin.Deng","can_delete":false,"product_type":"c1","uid":2960122,"ip_address":"","ucode":"1E0E298EB40E49","user_header":"https://static001.geekbang.org/account/avatar/00/2d/2a/fa/7c8bdef2.jpg","comment_is_top":false,"comment_ctime":1653241143,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653241143","product_id":100079601,"comment_content":"如果有遇到服务器重启之后redis就被莫名其妙关闭的小伙伴，如果<br>*** FATAL CONFIG FILE ERROR ***<br>Reading the configuration file, at line 171<br>&gt;&gt;&gt; &#39;logfile &#47;var&#47;log&#47;redis&#47;redis-server.log&#39;<br>Can&#39;t open the log file: No such file or directory<br><br>请用如下命令<br>sudo chown redis:redis &#47;var&#47;log&#47;redis&#47;redis.log","like_count":0},{"had_liked":false,"id":346532,"user_name":"Yin.Deng","can_delete":false,"product_type":"c1","uid":2960122,"ip_address":"","ucode":"1E0E298EB40E49","user_header":"https://static001.geekbang.org/account/avatar/00/2d/2a/fa/7c8bdef2.jpg","comment_is_top":false,"comment_ctime":1653217146,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1653217146","product_id":100079601,"comment_content":"晕，文章那个密码最好不要用自己的，太坑了，各种问题都是跟这个密码有关，就跟作者一样的文章比较好，浪费这么多时间太气人了","like_count":0},{"had_liked":false,"id":346518,"user_name":"张浩轩","can_delete":false,"product_type":"c1","uid":1628040,"ip_address":"","ucode":"6CB5A6F6FA209B","user_header":"https://static001.geekbang.org/account/avatar/00/18/d7/88/6f6b245c.jpg","comment_is_top":false,"comment_ctime":1653210684,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1653210684","product_id":100079601,"comment_content":"请问老师，iam-apiserver启动之后，如何通过浏览器或者curl来跑通https的接口呢?","like_count":0},{"had_liked":false,"id":346301,"user_name":"czy","can_delete":false,"product_type":"c1","uid":2398831,"ip_address":"","ucode":"660826F2ABA3E4","user_header":"https://static001.geekbang.org/account/avatar/00/24/9a/6f/c4490cf2.jpg","comment_is_top":false,"comment_ctime":1653010690,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1653010690","product_id":100079601,"comment_content":"csr中hosts为空列表，是不是代表适用于所有的域名和IP？","like_count":0},{"had_liked":false,"id":346291,"user_name":"czy","can_delete":false,"product_type":"c1","uid":2398831,"ip_address":"","ucode":"660826F2ABA3E4","user_header":"https://static001.geekbang.org/account/avatar/00/24/9a/6f/c4490cf2.jpg","comment_is_top":false,"comment_ctime":1653007714,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1653007714","product_id":100079601,"comment_content":"为什么证书配置文件有两个expired，如果这两个到期时间不同的话以哪个为准？","like_count":0},{"had_liked":false,"id":345643,"user_name":"极客酱酱","can_delete":false,"product_type":"c1","uid":2934665,"ip_address":"","ucode":"18CDC1DB754D58","user_header":"https://static001.geekbang.org/account/avatar/00/2c/c7/89/16437396.jpg","comment_is_top":false,"comment_ctime":1652452035,"is_pvip":true,"discussion_count":0,"race_medal":2,"score":"1652452035","product_id":100079601,"comment_content":"按照老师的教程一步步做下来，一气呵成！","like_count":0},{"had_liked":false,"id":344278,"user_name":"！","can_delete":false,"product_type":"c1","uid":2916501,"ip_address":"","ucode":"9C90F33B43177C","user_header":"https://static001.geekbang.org/account/avatar/00/2c/80/95/00354621.jpg","comment_is_top":false,"comment_ctime":1651416980,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1651416980","product_id":100079601,"comment_content":"我快破防了<br><br>!!! [0501 22:55:41] Call tree:<br>!!! [0501 22:55:41]  1: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;mariadb.sh:24<br>  Error in .&#47;scripts&#47;install&#47;mariadb.sh:24. &#39;sudo -S bash -c &quot;cat &lt;&lt; &#39;EOF&#39; &gt; &#47;etc&#47;yum.repos.d&#47;mariadb-10.5.repo<br># MariaDB 10.5 CentOS repository list - created 2020-10-23 01:54 UTC<br># http:&#47;&#47;downloads.mariadb.org&#47;mariadb&#47;repositories&#47;<br>[mariadb]<br>name = MariaDB<br>baseurl = https:&#47;&#47;mirrors.aliyun.com&#47;mariadb&#47;yum&#47;10.5&#47;centos8-amd64&#47;<br>module_hotfixes=1<br>gpgkey=https:&#47;&#47;yum.mariadb.org&#47;RPM-GPG-KEY-MariaDB<br>gpgcheck=0<br>EOF&quot;&#39; exited with status 0 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;mariadb.sh:24 iam::mariadb::install(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)","like_count":0},{"had_liked":false,"id":344124,"user_name":"t1ostang","can_delete":false,"product_type":"c1","uid":2961360,"ip_address":"","ucode":"676EC225C6C826","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/4ibWhAJFdicxiciaCzgnAsSNARGT8c5XOqcuItnMbOsibcY5c3q4wISibrUwnPGiclubYEdGRIAVFiaiclRlyjzwGCTRUog/132","comment_is_top":false,"comment_ctime":1651287273,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651287273","product_id":100079601,"comment_content":"老哥微信同意下 拉我进群 👀  我有好多问题","like_count":0},{"had_liked":false,"id":343973,"user_name":"Geek_f289b5","can_delete":false,"product_type":"c1","uid":2981035,"ip_address":"","ucode":"615F1A8B2DE719","user_header":"","comment_is_top":false,"comment_ctime":1651150731,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1651150731","product_id":100079601,"comment_content":"经过1天的努力，终于安装完了。 给电脑装了双系统，单独一个Centos系统来安装。 比虚拟机流畅多了<br>Client Version: version.Info {<br>\tGitVersion: &quot;f5ccb35&quot;,<br>\tGitCommit: &quot;f5ccb35b0ffe59b6b805f5e241f8054f66c4ef96&quot;,<br>\tGitTreeState: &quot;dirty&quot;,<br>\tBuildDate: &quot;2022-04-28T12:23:21Z&quot;,<br>\tGoVersion: &quot;go1.17.2&quot;,<br>\tCompiler: &quot;gc&quot;,<br>\tPlatform: &quot;linux&#47;amd64&quot;<br>}<br>Server Version: version.Info {<br>\tGitVersion: &quot;f5ccb35&quot;,<br>\tGitCommit: &quot;f5ccb35b0ffe59b6b805f5e241f8054f66c4ef96&quot;,<br>\tGitTreeState: &quot;dirty&quot;,<br>\tBuildDate: &quot;2022-04-28T05:13:54Z&quot;,<br>\tGoVersion: &quot;go1.17.2&quot;,<br>\tCompiler: &quot;gc&quot;,<br>\tPlatform: &quot;linux&#47;amd64&quot;<br>}","like_count":0},{"had_liked":false,"id":342361,"user_name":"撇撇","can_delete":false,"product_type":"c1","uid":1010786,"ip_address":"","ucode":"938305F9F3F19C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6c/62/cbb91635.jpg","comment_is_top":false,"comment_ctime":1650206591,"is_pvip":false,"replies":[{"id":"125527","content":"没有一个统计数据。我观察到的现象是：<br>1. mac比较多<br>2. Windows次之<br>3. Linux次之<br><br>没有标准答案，按个人喜好选择，区别不大","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651078356,"ip_address":"","comment_id":342361,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1650206591","product_id":100079601,"comment_content":"实际项目开发的时候是不是我们基本都是在Mac或者Windows下开发，而不是Linux ？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568218,"discussion_content":"没有一个统计数据。我观察到的现象是：\n1. mac比较多\n2. Windows次之\n3. Linux次之\n\n没有标准答案，按个人喜好选择，区别不大","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651078356,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342202,"user_name":"allen","can_delete":false,"product_type":"c1","uid":1744063,"ip_address":"","ucode":"EEFA5AB2F945EC","user_header":"","comment_is_top":false,"comment_ctime":1650099707,"is_pvip":true,"replies":[{"id":"125531","content":"方法1：可能网络不稳定，重试<br>方法2：<br>    1. 登录github官网，下载这个失败的包<br>    2. 将下载的包，上传到开发机，解压<br>    3. go.mod中replace这个包到刚解压的包","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651078881,"ip_address":"","comment_id":342202,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1650099707","product_id":100079601,"comment_content":"v1.1.0 go mod tidy 后返回如下错误，这个怎么解决？<br>go: downloading github.com&#47;mattn&#47;go-runewidth v0.0.10<br>go: downloading golang.org&#47;x&#47;mod v0.4.2<br><br>go: github.com&#47;coreos&#47;go-systemd&#47;v22@v22.3.2 requires<br>\tgithub.com&#47;godbus&#47;dbus&#47;v5@v5.0.4: reading github.com&#47;godbus&#47;dbus&#47;go.mod at revision v5.0.4: git ls-remote -q origin in &#47;home&#47;going&#47;workspace&#47;golang&#47;pkg&#47;mod&#47;cache&#47;vcs&#47;d9e1e146d092a9c1265cbe829964881f85d662d3af90aa6b307416f2d7a307bf: exit status 128:<br>\tfatal: unable to access &#39;https:&#47;&#47;github.com&#47;godbus&#47;dbus&#47;&#39;: Failed to connect to github.com port 443: Connection refused","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568222,"discussion_content":"方法1：可能网络不稳定，重试\n方法2：\n    1. 登录github官网，下载这个失败的包\n    2. 将下载的包，上传到开发机，解压\n    3. go.mod中replace这个包到刚解压的包","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651078881,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342179,"user_name":"allen","can_delete":false,"product_type":"c1","uid":1744063,"ip_address":"","ucode":"EEFA5AB2F945EC","user_header":"","comment_is_top":false,"comment_ctime":1650085960,"is_pvip":true,"replies":[{"id":"125529","content":"网络不稳定，也没太多好的办法。<br><br>一个workaround:<br>1. 登录github页面，下载相应开源项目的zip包<br>2. 将zip包上传到开发机上，unzip后，再在go.mod中replace这个本地包","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651078617,"ip_address":"","comment_id":342179,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1650085960","product_id":100079601,"comment_content":"一开始通过centos7一键安装提示各自依赖，然后重新安装了centos8系统，然后提示yum有问题，然后把yum都解决了，然后提示git源有问题，然后我把install.sh中的 #git config --global url.&quot;https:&#47;&#47;github.com.cnpmjs.org&#47;&quot;.insteadOf &quot;https:&#47;&#47;github.com&#47;&quot; 注释了。然后后面都能正常安装了。现在前面的基础功能都安装完后，现在提示下面的错误，google了一下，说是github有问题，但是我直接git clone其他的源码都能正常clone下来，找了很多办法, 也尝试取消httpproxy：”git config --global --unset http.proxy“ 还是没解决，请求这个该怎么解决？<br><br>执行如下：执行之后就报错了(一键安装的报错)<br>~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam<br>===========&gt; Building binary iam-apiserver v1.6.2-35-gf5ccb35 for linux amd64<br>go: downloading github.com&#47;appleboy&#47;gin-jwt&#47;v2 v2.6.4<br>.....<br>internal&#47;apiserver&#47;controller&#47;v1&#47;secret&#47;create.go:8:2: reading github.com&#47;AlekSi&#47;pointer&#47;go.mod at revision v1.1.0: git ls-remote -q origin in &#47;home&#47;going&#47;workspace&#47;golang&#47;pkg&#47;mod&#47;cache&#47;vcs&#47;3ea127f4d2eaf9a276cfe19613a97eff8fb97e21dc327801653c6293422ce35f: exit status 128:<br>\tfatal: unable to access &#39;https:&#47;&#47;github.com&#47;AlekSi&#47;pointer&#47;&#39;: Failed to connect to github.com port 443: Connection refused<br>internal&#47;apiserver&#47;auth.go:14:2: reading github.com&#47;appleboy&#47;gin-jwt&#47;go.mod at revision v2.6.4: git ls-remote -q origin in &#47;home&#47;going&#47;workspace&#47;golang&#47;pkg&#47;mod&#47;cache&#47;vcs&#47;6c33183445df72dd8134fc649f7adce41c24dd94aa99f0132ccc2d7be9b1450c: exit status 128:<br>\tfatal: unable to access &#39;https:&#47;&#47;github.com&#47;appleboy&#47;gin-jwt&#47;&#39;: Empty reply from server<br>..&#47;..&#47;..&#47;..&#47;pkg&#47;mod&#47;github.com&#47;marmotedu&#47;component-base@v1.6.2&#47;pkg&#47;util&#47;stringutil&#47;stringutil.go:10:2: github.com&#47;asaskevich&#47;govalidator@v0.0.0-20210307081110-f21760c49a8d: invalid version: git fetch -f origin refs&#47;heads&#47;*:refs&#47;heads&#47;* refs&#47;tags&#47;*:refs&#47;tags&#47;* in &#47;home&#47;going&#47;workspace&#47;golang&#47;pkg&#47;mod&#47;cache&#47;vcs&#47;f9896ddfbe91f3e08207f80400fac797422f9ea4506df8bf0e8dd25d59e6d40b: exit status 128","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568220,"discussion_content":"网络不稳定，也没太多好的办法。\n\n一个workaround:\n1. 登录github页面，下载相应开源项目的zip包\n2. 将zip包上传到开发机上，unzip后，再在go.mod中replace这个本地包","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651078617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342116,"user_name":"Bert 陈","can_delete":false,"product_type":"c1","uid":2345014,"ip_address":"","ucode":"022BA03561E54D","user_header":"https://static001.geekbang.org/account/avatar/00/23/c8/36/18e49330.jpg","comment_is_top":false,"comment_ctime":1650018577,"is_pvip":true,"replies":[{"id":"125533","content":"6666","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651078957,"ip_address":"","comment_id":342116,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1650018577","product_id":100079601,"comment_content":"[going@localhost iam]$ iamctl version -o yaml<br>clientVersion:<br>  buildDate: &quot;2022-04-15T10:01:33Z&quot;<br>  compiler: gc<br>  gitCommit: f5ccb35b0ffe59b6b805f5e241f8054f66c4ef96<br>  gitTreeState: dirty<br>  gitVersion: f5ccb35<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2022-04-15T09:45:13Z&quot;<br>  compiler: gc<br>  gitCommit: f5ccb35b0ffe59b6b805f5e241f8054f66c4ef96<br>  gitTreeState: dirty<br>  gitVersion: f5ccb35<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568224,"discussion_content":"6666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651078957,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340574,"user_name":"SmartsYoung","can_delete":false,"product_type":"c1","uid":1843402,"ip_address":"","ucode":"7277B790D470DE","user_header":"https://static001.geekbang.org/account/avatar/00/1c/20/ca/2b0f69bc.jpg","comment_is_top":false,"comment_ctime":1648912877,"is_pvip":true,"replies":[{"id":"125546","content":"666666","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651079423,"ip_address":"","comment_id":340574,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1648912877","product_id":100079601,"comment_content":"不容易啊！特地搞了台centos的机子，总算是部署完成了","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568242,"discussion_content":"666666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651079423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":340544,"user_name":"颜鑫","can_delete":false,"product_type":"c1","uid":1127637,"ip_address":"","ucode":"527F3C5C6E8DA5","user_header":"https://static001.geekbang.org/account/avatar/00/11/34/d5/2bb2f670.jpg","comment_is_top":false,"comment_ctime":1648893327,"is_pvip":true,"replies":[{"id":"125550","content":"是不是少了这一步：<br><br><br>export LINUX_PASSWORD=&#39;iam59!z$&#39;<br>","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651079749,"ip_address":"","comment_id":340544,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1648893327","product_id":100079601,"comment_content":"[going@dev iam]$ .&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::install<br>[sudo] password for going: xxxxxxxxxxx<br>Sorry, try again.<br>[sudo] password for going: <br>sudo: no password was provided<br>sudo: 1 incorrect password attempt<br>!!! [0402 17:53:21] Call tree:<br>!!! [0402 17:53:21]  1: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;mariadb.sh:24<br>  Error in .&#47;scripts&#47;install&#47;mariadb.sh:24. &#39;((i&lt;3-1))&#39; exited with status 0 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;mariadb.sh:24 iam::mariadb::install(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)<br>Exiting with status 1<br><br>整不会了，密码都还没输完就完了。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568247,"discussion_content":"是不是少了这一步：\n\n\nexport LINUX_PASSWORD=&#39;iam59!z$&#39;\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651079749,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":339521,"user_name":"庄小P","can_delete":false,"product_type":"c1","uid":1489063,"ip_address":"","ucode":"A71FA01F713790","user_header":"","comment_is_top":false,"comment_ctime":1648171406,"is_pvip":false,"replies":[{"id":"125555","content":"是什么操作系统呀","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651080049,"ip_address":"","comment_id":339521,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1648171406","product_id":100079601,"comment_content":"[going@dev iam]$ .&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::install<br>&#47;var&#47;tmp&#47;sclzCqTgn: line 8: -S: command not found<br>!!! [0325 09:22:59] Call tree:<br>!!! [0325 09:22:59]  1: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;mariadb.sh:24<br>  Error in .&#47;scripts&#47;install&#47;mariadb.sh:24. &#39;((i&lt;3-1))&#39; exited with status 0 127<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;mariadb.sh:24 iam::mariadb::install(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)<br>Exiting with status 1<br><br>请问这个是怎么回事","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568252,"discussion_content":"是什么操作系统呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651080050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1535891,"avatar":"https://static001.geekbang.org/account/avatar/00/17/6f/93/e5bcd0f4.jpg","nickname":"fahsa","note":"","ucode":"5ABBBEF0A6221D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567581,"discussion_content":"解决了吗，我也遇到这问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650947808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":339038,"user_name":"Geek_a363b3","can_delete":false,"product_type":"c1","uid":1454261,"ip_address":"","ucode":"231E443C75BF52","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epOtn6NmwQLPH9FHEUlwiaOibDkp1M7bf6nPJm9uc71J2x2f4Gb6KIcR94YqDxTLV8O0ca7YE1kVntQ/132","comment_is_top":false,"comment_ctime":1647869869,"is_pvip":false,"replies":[{"id":"123938","content":"我查了下后台，你的留言在02评论区～","user_name":"编辑回复","user_name_real":"编辑","uid":"2562791","ctime":1647926278,"ip_address":"","comment_id":339038,"utype":2}],"discussion_count":1,"race_medal":0,"score":"1647869869","product_id":100079601,"comment_content":"我的留言呢 大神 我怎么看不见 我还没配置好linux的配置呢 上次留言了","like_count":0,"discussions":[{"author":{"id":2562791,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/MaygtS9JLKOhljn4Vaic7twtCYq0p4EJqia7BB1nCiaZKXAricom9cdeEQHtgTOEBD0WpMJ5IoGI1nzYqpDsEsjsJQ/132","nickname":"🐑 🐑 得意","note":"","ucode":"9BF26FA42C3B61","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":557674,"discussion_content":"我查了下后台，你的留言在02评论区～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647926278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338725,"user_name":"大口吃肉喝酒","can_delete":false,"product_type":"c1","uid":2132654,"ip_address":"","ucode":"E429EAD5262AC9","user_header":"https://static001.geekbang.org/account/avatar/00/20/8a/ae/2edc03e9.jpg","comment_is_top":false,"comment_ctime":1647686243,"is_pvip":false,"replies":[{"id":"125562","content":"这里还有问题吗，可以加我微信，问下上下文","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651080343,"ip_address":"","comment_id":338725,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1647686243","product_id":100079601,"comment_content":"ca-config.json ca.csr ca-csr.json ca-key.pem ca.pem<br><br>执行该命令后，没有生成任何文件和证书，不知道是哪里出问题了？能帮忙解答下么","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568259,"discussion_content":"这里还有问题吗，可以加我微信，问下上下文","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651080343,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338338,"user_name":"Geek_4c858e","can_delete":false,"product_type":"c1","uid":2937108,"ip_address":"","ucode":"4758B5E84BD653","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ZdeWzNbp2uzsrib04NWIteb3hAX6vojc7X1uuW52jZupC4WvXV63lwASxEl41EHtIjFKzdyQHFRiauH0wcBzH4Zg/132","comment_is_top":false,"comment_ctime":1647431685,"is_pvip":false,"replies":[{"id":"125564","content":"直接将git配置中的insteadOf配置删除吧，就是下载会慢点","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1651080497,"ip_address":"","comment_id":338338,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1647431685","product_id":100079601,"comment_content":"<br>git的国内镜像换了好几个不行git config --global url.&quot;https:&#47;&#47;github.com.cnpmjs.org&#47;&quot;.insteadOf&quot;https:&#47;&#47;github.com&#47;&quot;<br><br>[going@dev workspace]$ git clone --depth=1 https:&#47;&#47;github.com&#47;marmotedu&#47;iam<br><br>Cloning into &#39;iam&#39;...<br>fatal: unable to access &#39;https:&#47;&#47;hub.fastgit.org&#47;marmotedu&#47;iam&#47;&#39;: OpenSSL SSL_connect: SSL_ERROR_SYSCALL in connection to hub.fastgit.org:443 <br>[going@dev workspace]$ vim $HOME&#47;.bash","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568261,"discussion_content":"直接将git配置中的insteadOf配置删除吧，就是下载会慢点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651080497,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338087,"user_name":"Geek_4c858e","can_delete":false,"product_type":"c1","uid":2937108,"ip_address":"","ucode":"4758B5E84BD653","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ZdeWzNbp2uzsrib04NWIteb3hAX6vojc7X1uuW52jZupC4WvXV63lwASxEl41EHtIjFKzdyQHFRiauH0wcBzH4Zg/132","comment_is_top":false,"comment_ctime":1647272213,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647272213","product_id":100079601,"comment_content":"这个算安装好了吗？？？","like_count":0},{"had_liked":false,"id":337862,"user_name":"李晓东","can_delete":false,"product_type":"c1","uid":2648103,"ip_address":"","ucode":"5EA26007C72792","user_header":"","comment_is_top":false,"comment_ctime":1647095970,"is_pvip":false,"replies":[{"id":"123563","content":"脚本，我自己测试下看看","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1647216776,"ip_address":"","comment_id":337862,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1647095970","product_id":100079601,"comment_content":"太难了，终于搞好了，不知道为啥用最后的脚本一键脚本装一直失败，后来按照文档一步一步装才成功。<br><br>[going@dev iam]$ iamctl version -o yaml<br>clientVersion:<br>  buildDate: &quot;2022-03-12T14:22:43Z&quot;<br>  compiler: gc<br>  gitCommit: 26bf0c0d0f853a0a60123309ff03a4569aa2e631<br>  gitTreeState: dirty<br>  gitVersion: v1.6.2<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2022-03-12T13:14:21Z&quot;<br>  compiler: gc<br>  gitCommit: 26bf0c0d0f853a0a60123309ff03a4569aa2e631<br>  gitTreeState: clean<br>  gitVersion: v1.6.2<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556094,"discussion_content":"脚本，我自己测试下看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647216776,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337839,"user_name":"Geek_4c858e","can_delete":false,"product_type":"c1","uid":2937108,"ip_address":"","ucode":"4758B5E84BD653","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ZdeWzNbp2uzsrib04NWIteb3hAX6vojc7X1uuW52jZupC4WvXV63lwASxEl41EHtIjFKzdyQHFRiauH0wcBzH4Zg/132","comment_is_top":false,"comment_ctime":1647087873,"is_pvip":false,"replies":[{"id":"123562","content":"yum镜像源失效了，参考这篇文章处理下：https:&#47;&#47;blog.csdn.net&#47;qq_20677507&#47;article&#47;details&#47;105591353","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1647216759,"ip_address":"","comment_id":337839,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1647087873","product_id":100079601,"comment_content":"这些算安装iam成功了吗？？？<br>install vim ide successfully<br>initialize linux to go development machine  successfully<br>CentOS Linux 8 - AppStream                       48  B&#47;s |  38  B     00:00    <br>Error: Failed to download metadata for repo &#39;appstream&#39;: Cannot prepare internal mirrorlist: No URLs in mirrorlist<br>Failed to enable unit: Unit file mariadb.service does not exist.<br>Failed to start mariadb.service: Unit mariadb.service not found.<br>sudo: mysqladmin: command not found<br>Unit mariadb.service could not be found.<br>!!! [0312 04:19:21] mariadb failed to start, maybe not installed properly<br>!!! Error in .&#47;scripts&#47;install&#47;install.sh:397<br>  Error in .&#47;scripts&#47;install&#47;install.sh:397. &#39;return 1&#39; exited with status 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;install.sh:397 main(...)<br>Exiting with status 1<br>[root@localhost iam]# cd &#47;tmp&#47;iam&#47; &amp;&amp; .&#47;scripts&#47;install&#47;test.sh iam::test::test<br>!!! [0312 04:20:29] Call tree:<br>!!! [0312 04:20:29]  1: .&#47;scripts&#47;install&#47;test.sh:112 iam::test::user(...)<br>!!! [0312 04:20:29]  2: .&#47;scripts&#47;install&#47;test.sh:188 iam::test::apiserver(...)<br>!!! [0312 04:20:29]  3: .&#47;scripts&#47;install&#47;test.sh:197 iam::test::smoke(...)<br>!!! [0312 04:20:29]  4: .&#47;scripts&#47;install&#47;test.sh:204 iam::test::test(...)<br>!!! Error in .&#47;scripts&#47;install&#47;test.sh:29<br>  Error in .&#47;scripts&#47;install&#47;test.sh:29. &#39;((i&lt;6-1))&#39; exited with status 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;test.sh:29 iam::test::user(...)<br>  2: .&#47;scripts&#47;install&#47;test.sh:112 iam::test::apiserver(...)<br>  3: .&#47;scripts&#47;install&#47;test.sh:188 iam::test::smoke(...)<br>  4: .&#47;scripts&#47;install&#47;test.sh:197 iam::test::test(...)<br>  5: .&#47;scripts&#47;install&#47;test.sh:204 main(...)<br>Exiting with status 1<br>[root@localhost iam]# <br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556093,"discussion_content":"yum镜像源失效了，参考这篇文章处理下：https://blog.csdn.net/qq_20677507/article/details/105591353","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647216759,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337583,"user_name":"Geek_579642","can_delete":false,"product_type":"c1","uid":2852718,"ip_address":"","ucode":"8ADEB4C3D6A4A6","user_header":"","comment_is_top":false,"comment_ctime":1646903412,"is_pvip":false,"replies":[{"id":"123444","content":"iam仓库的README.md有我微信。<br><br>这个地方只能等下，因为初次要下载包，所以速度会依赖网速","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1647039353,"ip_address":"","comment_id":337583,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1646903412","product_id":100079601,"comment_content":"make build BINS=iam-apiserver 特别慢，github加速也没用，卡在这步，有什么办法吗？<br>另外，怎么联系老师呢？或者有没有学习讨论群？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555704,"discussion_content":"iam仓库的README.md有我微信。\n\n这个地方只能等下，因为初次要下载包，所以速度会依赖网速","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647039353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337481,"user_name":"Geek_f3fe7a","can_delete":false,"product_type":"c1","uid":2725433,"ip_address":"","ucode":"BBFAF5FF21E102","user_header":"","comment_is_top":false,"comment_ctime":1646841355,"is_pvip":false,"replies":[{"id":"123423","content":"可以加老师微信，直接@我","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1647037802,"ip_address":"","comment_id":337481,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1646841355","product_id":100079601,"comment_content":"一个晚上都没弄出来","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555683,"discussion_content":"可以加老师微信，直接@我","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647037802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337480,"user_name":"Geek_f3fe7a","can_delete":false,"product_type":"c1","uid":2725433,"ip_address":"","ucode":"BBFAF5FF21E102","user_header":"","comment_is_top":false,"comment_ctime":1646841338,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646841338","product_id":100079601,"comment_content":"shell 命令用的真好","like_count":0},{"had_liked":false,"id":336517,"user_name":"妙啊","can_delete":false,"product_type":"c1","uid":2007938,"ip_address":"","ucode":"CA4B4B3FED71B5","user_header":"https://static001.geekbang.org/account/avatar/00/1e/a3/82/1b994623.jpg","comment_is_top":false,"comment_ctime":1646197797,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1646197797","product_id":100079601,"comment_content":"fatal: unable to access &#39;https:&#47;&#47;github.com.cnpmjs.org&#47;zsais&#47;go-gin-prometheus&#47;&#39;: Could not resolve host: github.com.cnpmjs.org<br>一直显示这种错误需要将 https: 改为 git：才行，但是安装 iam-apiserver 可执行二进制文件的时候无法进行这样的更改。","like_count":0},{"had_liked":false,"id":335915,"user_name":"大布丁","can_delete":false,"product_type":"c1","uid":1389744,"ip_address":"","ucode":"3C655AA79A538C","user_header":"https://static001.geekbang.org/account/avatar/00/15/34/b0/8d14a2a1.jpg","comment_is_top":false,"comment_ctime":1645769199,"is_pvip":false,"replies":[{"id":"123435","content":"可以试试，一键部署","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1647038859,"ip_address":"","comment_id":335915,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645769199","product_id":100079601,"comment_content":"期间还是有报错，但是还是搞出来了，就是不知道那些错误会在之后的那些地方出现了。等着出现 bug 在修了，部署确实难顶。还是代码写起来轻松<br>clientVersion:<br>  buildDate: &quot;2022-02-25T05:18:45Z&quot;<br>  compiler: gc<br>  gitCommit: a1576850403a86575134e23cc2ce2213a149a7b4<br>  gitTreeState: dirty<br>  gitVersion: a157685<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2022-02-25T05:14:06Z&quot;<br>  compiler: gc<br>  gitCommit: a1576850403a86575134e23cc2ce2213a149a7b4<br>  gitTreeState: dirty<br>  gitVersion: a157685<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555695,"discussion_content":"可以试试，一键部署","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647038860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335337,"user_name":"LH20110","can_delete":false,"product_type":"c1","uid":1956109,"ip_address":"","ucode":"C541CA1B0B5797","user_header":"https://static001.geekbang.org/account/avatar/00/1d/d9/0d/438b3052.jpg","comment_is_top":false,"comment_ctime":1645456106,"is_pvip":true,"replies":[{"id":"123438","content":"6666","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1647038949,"ip_address":"","comment_id":335337,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1645456106","product_id":100079601,"comment_content":"congratulations, &#47;v1&#47;authz test passed!<br>congratulations, iam-authz-server test passed!<br>congratulations, iam-pump test passed!<br>congratulations, iam-watcher test passed!<br>congratulations, iamctl test passed!<br>congratulations, smoke test passed!<br>congratulations, man test passed!<br>congratulations, all test passed!<br><br>[going@iZwz90pegu9budqh3sdmksZ iam]$ iamctl version -o yaml<br>clientVersion:<br>  buildDate: &quot;2022-02-21T14:52:32Z&quot;<br>  compiler: gc<br>  gitCommit: 26bf0c0d0f853a0a60123309ff03a4569aa2e631<br>  gitTreeState: clean<br>  gitVersion: v1.6.2<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2022-02-21T14:50:14Z&quot;<br>  compiler: gc<br>  gitCommit: 26bf0c0d0f853a0a60123309ff03a4569aa2e631<br>  gitTreeState: clean<br>  gitVersion: v1.6.2<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555698,"discussion_content":"6666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647038949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":334189,"user_name":"燃","can_delete":false,"product_type":"c1","uid":1102570,"ip_address":"","ucode":"FA524638AB2C21","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLaL0mCsCCictI0VqUk9wEicq4nibogt9252Kg2Ke3G7czDKOsAAuTkXXiadticZv3CxgUo7xialx70cljg/132","comment_is_top":false,"comment_ctime":1644805559,"is_pvip":true,"replies":[{"id":"123454","content":"拉下最新的master分支看看","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1647040285,"ip_address":"","comment_id":334189,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1644805559","product_id":100079601,"comment_content":"internal\\pump\\pumps\\syslog.go:21:14: undefined: syslog.Writer<br>internal\\pump\\pumps\\syslog.go:74:23: undefined: syslog.Dial<br>internal\\pump\\pumps\\syslog.go:77:3: undefined: syslog.Priority<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555715,"discussion_content":"拉下最新的master分支看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647040285,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333822,"user_name":"张靖","can_delete":false,"product_type":"c1","uid":1243566,"ip_address":"","ucode":"18AF868CCAA9D6","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/ae/ca227c21.jpg","comment_is_top":false,"comment_ctime":1644549049,"is_pvip":true,"replies":[{"id":"123450","content":"66666","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1647039637,"ip_address":"","comment_id":333822,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1644549049","product_id":100079601,"comment_content":"clientVersion:<br>  buildDate: &quot;2022-02-10T08:00:10Z&quot;<br>  compiler: gc<br>  gitCommit: 28f98f3a6b03d53ba73dd061d8a20115fcfc0e89<br>  gitTreeState: dirty<br>  gitVersion: 28f98f3<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2022-02-10T07:37:57Z&quot;<br>  compiler: gc<br>  gitCommit: 28f98f3a6b03d53ba73dd061d8a20115fcfc0e89<br>  gitTreeState: dirty<br>  gitVersion: 28f98f3<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br><br>深入学习go<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555710,"discussion_content":"66666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1647039638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332305,"user_name":"陈晓涛","can_delete":false,"product_type":"c1","uid":1588873,"ip_address":"","ucode":"E80D318348CA47","user_header":"https://static001.geekbang.org/account/avatar/00/18/3e/89/ccc2ebd9.jpg","comment_is_top":false,"comment_ctime":1643166505,"is_pvip":false,"replies":[{"id":"121555","content":"你可以试试，之前有读者配置成功过。","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1643454953,"ip_address":"","comment_id":332305,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1643166505","product_id":100079601,"comment_content":"我想知道，如何在window上使用golang调试起来，好多配置","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548948,"discussion_content":"你可以试试，之前有读者配置成功过。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643454954,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332179,"user_name":"EvanSung","can_delete":false,"product_type":"c1","uid":1542472,"ip_address":"","ucode":"0945F016568422","user_header":"https://static001.geekbang.org/account/avatar/00/17/89/48/7c849f0d.jpg","comment_is_top":false,"comment_ctime":1643082540,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1643082540","product_id":100079601,"comment_content":"这个项目真牛逼，看跪了！！！","like_count":0},{"had_liked":false,"id":331242,"user_name":"颖_one","can_delete":false,"product_type":"c1","uid":2301484,"ip_address":"","ucode":"F1BCDFADA572AB","user_header":"https://static001.geekbang.org/account/avatar/00/23/1e/2c/ea2d4be2.jpg","comment_is_top":false,"comment_ctime":1642498191,"is_pvip":true,"replies":[{"id":"121260","content":"66666","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642867560,"ip_address":"","comment_id":331242,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1642498191","product_id":100079601,"comment_content":"先用docker尝试一次，🐴的问题太多了。装到iam服务启动时放弃了。因为无法使用&#47;usr&#47;bin&#47;mkdir果断回腾讯把服务器升到8.2，一路顺畅<br><br>Client Version: version.Info{GitVersion:&quot;e1d780e&quot;, GitCommit:&quot;e1d780ed092898b9e48cf9b3e6afc15abe216d34&quot;, GitTreeState:&quot;dirty&quot;, BuildDate:&quot;2022-01-18T09:01:59Z&quot;, GoVersion:&quot;go1.17.2&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux&#47;amd64&quot;}<br>Server Version: version.Info{GitVersion:&quot;e1d780e&quot;, GitCommit:&quot;e1d780ed092898b9e48cf9b3e6afc15abe216d34&quot;, GitTreeState:&quot;dirty&quot;, BuildDate:&quot;2022-01-18T08:46:23Z&quot;, GoVersion:&quot;go1.17.2&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux&#47;amd64&quot;}","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":547820,"discussion_content":"66666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642867560,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":330472,"user_name":"Jacky","can_delete":false,"product_type":"c1","uid":1118289,"ip_address":"","ucode":"EB78E23F3D3C23","user_header":"https://static001.geekbang.org/account/avatar/00/11/10/51/192abff0.jpg","comment_is_top":false,"comment_ctime":1641989403,"is_pvip":false,"replies":[{"id":"120941","content":"可以的，后面有介绍如何容器化部署","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642433866,"ip_address":"","comment_id":330472,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641989403","product_id":100079601,"comment_content":"老师，可以容器化部署吗？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546842,"discussion_content":"可以的，后面有介绍如何容器化部署","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642433867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329897,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1641632277,"is_pvip":true,"replies":[{"id":"120954","content":"看下这个项目的README文件：https:&#47;&#47;github.com&#47;cpuguy83&#47;go-md2man","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642434766,"ip_address":"","comment_id":329897,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641632277","product_id":100079601,"comment_content":"老师，这个库md2man是怎么使用的，这个man文件又是怎么生成的呢？有没有学习资料呀？老师的课真的惊喜连连，学到很多。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546857,"discussion_content":"看下这个项目的README文件：https://github.com/cpuguy83/go-md2man","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642434766,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329896,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1641632020,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1641632020","product_id":100079601,"comment_content":"文末彩蛋绝对惊喜<br>","like_count":0},{"had_liked":false,"id":329871,"user_name":"HelloBug","can_delete":false,"product_type":"c1","uid":1249598,"ip_address":"","ucode":"E61A4AD5C2F724","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/3e/925aa996.jpg","comment_is_top":false,"comment_ctime":1641614909,"is_pvip":true,"replies":[{"id":"120952","content":"创建根证书时，的配置文件","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642434627,"ip_address":"","comment_id":329871,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641614909","product_id":100079601,"comment_content":"请问下老师，在创建证书和密钥的时候，ca-config.json这个文件是什么时候使用的呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546855,"discussion_content":"创建根证书时，的配置文件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642434627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329254,"user_name":"杨帅","can_delete":false,"product_type":"c1","uid":1684811,"ip_address":"","ucode":"0A558B1BA62E44","user_header":"","comment_is_top":false,"comment_ctime":1641258659,"is_pvip":true,"replies":[{"id":"120961","content":"可以加老师微信：nightskong","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642435002,"ip_address":"","comment_id":329254,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641258659","product_id":100079601,"comment_content":"老师，能把我拉到学习群吗？在macos上安装遇到一些问题。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546864,"discussion_content":"可以加老师微信：nightskong","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642435002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329121,"user_name":"给心来块冰块","can_delete":false,"product_type":"c1","uid":1063689,"ip_address":"","ucode":"7AFB56581782A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/09/2cf074a7.jpg","comment_is_top":false,"comment_ctime":1641135374,"is_pvip":true,"replies":[{"id":"120965","content":"加我微信，我看看，这个信息太少了","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642435201,"ip_address":"","comment_id":329121,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641135374","product_id":100079601,"comment_content":"[root@dev iam]# curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2NDEyMjE0MDcsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2NDExMzUwMDcsInN1YiI6ImFkbWluIn0.AJt1Wv9be3BGK5NOOhD83-TN3GfNM8PpwqLZMfvVIA0&#39; -d&#39;{&quot;subject&quot;:&quot;users:maria&quot;,&quot;action&quot;:&quot;delete&quot;,&quot;resource&quot;:&quot;resources:articles:ladon-introduction&quot;,&quot;context&quot;:{&quot;remoteIPAddress&quot;:&quot;192.168.0.5&quot;}}&#39; http:&#47;&#47;127.0.0.1:9090&#47;v1&#47;authz<br>{&quot;code&quot;:100202,&quot;message&quot;:&quot;Signature is invalid&quot;}[root@dev iam]# <br><br>重新生成token也不行","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546870,"discussion_content":"加我微信，我看看，这个信息太少了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642435201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329082,"user_name":"给心来块冰块","can_delete":false,"product_type":"c1","uid":1063689,"ip_address":"","ucode":"7AFB56581782A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/09/2cf074a7.jpg","comment_is_top":false,"comment_ctime":1641102948,"is_pvip":true,"replies":[{"id":"120964","content":"要看下iam-apiserver的具体报错日志。<br><br>可以看下特别放送中的：IAM排障指南","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642435166,"ip_address":"","comment_id":329082,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1641102948","product_id":100079601,"comment_content":"启动不起来<br>[root@dev iam]# systemctl status iam-apiserver<br>● iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Sun 2022-01-02 13:54:18 CST; 2s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 271535 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=1&#47;FAILURE)<br>  Process: 271533 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 271532 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 271535 (code=exited, status=1&#47;FAILURE)<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546869,"discussion_content":"要看下iam-apiserver的具体报错日志。\n\n可以看下特别放送中的：IAM排障指南","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642435166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":329055,"user_name":"kai楷","can_delete":false,"product_type":"c1","uid":1397672,"ip_address":"","ucode":"623D38565BF0EF","user_header":"https://static001.geekbang.org/account/avatar/00/15/53/a8/73618c92.jpg","comment_is_top":false,"comment_ctime":1641087678,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1641087678","product_id":100079601,"comment_content":"这个系统看起来好酷！！！","like_count":0},{"had_liked":false,"id":328791,"user_name":"杨帅","can_delete":false,"product_type":"c1","uid":1684811,"ip_address":"","ucode":"0A558B1BA62E44","user_header":"","comment_is_top":false,"comment_ctime":1640883581,"is_pvip":true,"replies":[{"id":"120967","content":"macos应该也是这样的","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642435233,"ip_address":"","comment_id":328791,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640883581","product_id":100079601,"comment_content":"<br>$ .&#47;scripts&#47;genconfig.sh scripts&#47;install&#47;environment.sh init&#47;iam-apiserver.service &gt; iam-apiserver.service<br>$ sudo mv iam-apiserver.service &#47;etc&#47;systemd&#47;system&#47;<br>老师好，这个部分在mac上有替换的步骤吗","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546872,"discussion_content":"macos应该也是这样的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642435233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328790,"user_name":"杨帅","can_delete":false,"product_type":"c1","uid":1684811,"ip_address":"","ucode":"0A558B1BA62E44","user_header":"","comment_is_top":false,"comment_ctime":1640883435,"is_pvip":true,"replies":[{"id":"120966","content":"macos应该也是这样的","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1642435222,"ip_address":"","comment_id":328790,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640883435","product_id":100079601,"comment_content":"老师好，<br>$ .&#47;scripts&#47;genconfig.sh scripts&#47;install&#47;environment.sh init&#47;iam-apiserver.service &gt; iam-apiserver.service<br>$ sudo mv iam-apiserver.service &#47;etc&#47;systemd&#47;system&#47;。<br>这一段在macos系统有对应的做法吗？没有linux系统的小白。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546871,"discussion_content":"macos应该也是这样的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642435222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":327574,"user_name":"Jone  Chiang","can_delete":false,"product_type":"c1","uid":1009446,"ip_address":"","ucode":"117FBEB03C80F2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/26/fe6d6826.jpg","comment_is_top":false,"comment_ctime":1640175877,"is_pvip":true,"replies":[{"id":"119714","content":"6666","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1640826558,"ip_address":"","comment_id":327574,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640175877","product_id":100079601,"comment_content":"按着老师的步骤一步一步来，一次完美成功<br>```<br>clientVersion:<br>  buildDate: &quot;2021-12-22T12:01:35Z&quot;<br>  compiler: gc<br>  gitCommit: d84137d2309be299fe697838814368d1d237ab7d<br>  gitTreeState: dirty<br>  gitVersion: v1.6.0<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2021-12-21T15:57:50Z&quot;<br>  compiler: gc<br>  gitCommit: d84137d2309be299fe697838814368d1d237ab7d<br>  gitTreeState: dirty<br>  gitVersion: v1.6.0<br>  goVersion: go1.17.2<br>  platform: linux&#47;amd64<br>```","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542661,"discussion_content":"6666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640826558,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326204,"user_name":"VE","can_delete":false,"product_type":"c1","uid":2574335,"ip_address":"","ucode":"C454FC6D8EA08B","user_header":"https://static001.geekbang.org/account/avatar/00/27/47/ff/921868be.jpg","comment_is_top":false,"comment_ctime":1639418304,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1639418304","product_id":100079601,"comment_content":"验证授权时报错：<br>{&quot;allowed&quot;:false,&quot;denied&quot;:true,&quot;reason&quot;:&quot;list policies failed&quot;}","like_count":0},{"had_liked":false,"id":324690,"user_name":"大家说的道理我都懂，就是不知道哪里是哪里","can_delete":false,"product_type":"c1","uid":1549807,"ip_address":"","ucode":"58A0915F7B6B72","user_header":"https://static001.geekbang.org/account/avatar/00/17/a5/ef/6322c02c.jpg","comment_is_top":false,"comment_ctime":1638546578,"is_pvip":false,"replies":[{"id":"118345","content":"暂时没有","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1639399950,"ip_address":"","comment_id":324690,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638546578","product_id":100079601,"comment_content":"老哥， 有没有osx系统的。。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538340,"discussion_content":"暂时没有","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639399950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324593,"user_name":"于善帅","can_delete":false,"product_type":"c1","uid":2860403,"ip_address":"","ucode":"349087E7951605","user_header":"https://static001.geekbang.org/account/avatar/00/2b/a5/73/dde68ee6.jpg","comment_is_top":false,"comment_ctime":1638513352,"is_pvip":false,"replies":[{"id":"118350","content":"centos7部署跟centos8应该一样，不会遇到啥问题，你可以试试。","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1639400175,"ip_address":"","comment_id":324593,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1638513352","product_id":100079601,"comment_content":"有没有centos7系统部署成功的？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538347,"discussion_content":"centos7部署跟centos8应该一样，不会遇到啥问题，你可以试试。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639400175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":323000,"user_name":"Allen","can_delete":false,"product_type":"c1","uid":2851087,"ip_address":"","ucode":"63E53446007D1F","user_header":"https://static001.geekbang.org/account/avatar/00/2b/81/0f/f8ced7d9.jpg","comment_is_top":false,"comment_ctime":1637682470,"is_pvip":false,"replies":[{"id":"117687","content":"NX","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1638362631,"ip_address":"","comment_id":323000,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637682470","product_id":100079601,"comment_content":"少量修改就能跑在macos上，赞赞赞！","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535168,"discussion_content":"NX","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638362631,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322955,"user_name":"Allen","can_delete":false,"product_type":"c1","uid":2851087,"ip_address":"","ucode":"63E53446007D1F","user_header":"https://static001.geekbang.org/account/avatar/00/2b/81/0f/f8ced7d9.jpg","comment_is_top":false,"comment_ctime":1637668908,"is_pvip":false,"replies":[{"id":"117694","content":"加老师微信，现场给你看下？nightskong","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1638363047,"ip_address":"","comment_id":322955,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1637668908","product_id":100079601,"comment_content":"mac上也能编译跑起来， 但是.&#47;iamctl user list 报错，yml配置是正确的<br>2021-11-23 19:59:33.754\tWARN\tserver&#47;config.go:143\tWARNING: viper failed to discover and load the configuration file: While parsing config: yaml: invalid trailing UTF-8 octet<br>error: {&quot;code&quot;:100204,&quot;message&quot;:&quot;Invalid authorization header&quot;}<br><br>-----------------------------------------------------------------------<br>allen@MacBookPro  ~&#47;.iam  cat ~&#47;.iam&#47;iamctl.yaml<br># Copyright 2020 Lingfei Kong &lt;colin404@foxmail.com&gt;. All rights reserved.<br># Use of this source code is governed by a MIT style<br># license that can be found in the LICENSE file.<br><br>apiVersion: v1<br>user:<br>  #token: # JWT Token<br>  username: admin # iam 用户名<br>  password: Admin@2021 # iam 密码<br>  #secret-id: # 密钥 ID<br>  #secret-key: # 密钥 Key<br>  client-certificate: &#47;Users&#47;allen&#47;.iam&#47;cert&#47;admin.pem # 用于 TLS 的客户端证书文件路径<br>  client-key: &#47;Users&#47;allen&#47;.iam&#47;cert&#47;admin-key.pem # 用于 TLS 的客户端 key 文件路径<br>  #client-certificate-data:<br>  #client-key-data:<br><br>server:<br>  address: https:&#47;&#47;127.0.0.1:8443 # iam api-server 地址<br>  timeout: 10s # 请求 api-server 超时时间<br>  #max-retries: # 最大重试次数，默认为 0<br>  #retry-interval: # 重试间隔，默认为 1s<br>  #tls-server-name: # TLS 服务器名称<br>  #insecure-skip-tls-verify: # 设置为 true 表示跳过 TLS 安全验证模式，将使得 HTTPS 连接不安全<br>  certificate-authority: &#47;etc&#47;iam&#47;cert&#47;ca.pem # 用于 CA 授权的 cert 文件路径<br>  #certificate-authority-data:","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535177,"discussion_content":"加老师微信，现场给你看下？nightskong","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638363047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2851087,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/81/0f/f8ced7d9.jpg","nickname":"Allen","note":"","ucode":"63E53446007D1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":535191,"discussion_content":"已经解决，必须是在家目录执行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638364849,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":535177,"ip_address":""},"score":535191,"extra":""}]}]},{"had_liked":false,"id":322760,"user_name":"🔜","can_delete":false,"product_type":"c1","uid":1224046,"ip_address":"","ucode":"E75A44829D9ED8","user_header":"https://static001.geekbang.org/account/avatar/00/12/ad/6e/f08676bf.jpg","comment_is_top":false,"comment_ctime":1637577399,"is_pvip":false,"replies":[{"id":"117689","content":"用最新的maser分支哈","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1638362734,"ip_address":"","comment_id":322760,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637577399","product_id":100079601,"comment_content":"现在iam-apiserver 要用哪个版本的。<br>2021-11-22 18:27:23.259\tINFO\tapiserver\tapiserver&#47;auth.go:209\tuser `admin` is authenticated.<br>2021-11-22 18:27:23.259\tINFO\tapiserver\tgorm@v1.21.15&#47;callbacks.go:133\t[mysql&#47;user.go:76][0.818ms] [rows:1] SELECT * FROM `user` WHERE name = &#39;admin&#39; and status = 1 ORDER BY `user`.`id` LIMIT 1<br>2021-11-22 18:27:23.259\tINFO\tapiserver\tuser&#47;get.go:17\tget user function called.<br>2021-11-22 18:27:23.260\tINFO\tapiserver\tgorm@v1.21.15&#47;callbacks.go:133\tmysql&#47;user.go:76 record not found[0.300ms] [rows:0] SELECT * FROM `user` WHERE name = &#39;colin&#39; and status = 1 ORDER BY `user`.`id` LIMIT 1<br>2021-11-22 18:27:23.260\tINFO\tapiserver\tmiddleware&#47;logger.go:134\t404 - [127.0.0.1] &quot;1.659537ms GET &#47;v1&#47;users&#47;colin&quot;<br><br>有些对不上了，这里创建用户的时候没有把 status 改为1.","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535172,"discussion_content":"用最新的maser分支哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638362734,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322618,"user_name":"随遇而安","can_delete":false,"product_type":"c1","uid":1071463,"ip_address":"","ucode":"18F5A16B687AC8","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/67/7e2fa391.jpg","comment_is_top":false,"comment_ctime":1637501885,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1637501885","product_id":100079601,"comment_content":"最近真机安装了debian11在用，打算在debian上构建，碰到坑了试着去解决呗","like_count":0},{"had_liked":false,"id":322585,"user_name":"yandongxiao","can_delete":false,"product_type":"c1","uid":1017700,"ip_address":"","ucode":"D397F4DB0109C8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg","comment_is_top":false,"comment_ctime":1637489026,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637489026","product_id":100079601,"comment_content":"总结：<br>1. 如何安装三个数据库，mysql、redis、mongod？<br>2. 如何创建CA证书？<br>3. 针对 iam-apiserver, iam-authz-server, iam-pump 组件，它们的安装过程类似：<br>    3.1 通过执行 make build, 安装 二进制文件<br>    3.2 通过执行 genconfig.sh 脚本，渲染出组件的配置文件，许安然处 xxx.service 文件<br>    3.3 启动服务；设置开机自启；验证服务启动成功。<br>4. iam-apiserver 对 iamctl 请求包含的证书进行认证和授权，与 token 方式有区别。<br>5. install.sh 脚本中，包含了一键构建开发环境，一键部署整个IAM系统<br>","like_count":0},{"had_liked":false,"id":322335,"user_name":"Geek_2d574b","can_delete":false,"product_type":"c1","uid":2167512,"ip_address":"","ucode":"B97B7FA5FABF21","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eresygxbLGnHg0TasUgoUHVvicFBDsbRfEUbF7WnUETmze1GyNzDFzhDW2TicpAoeq6GUleMbkyiacmw/132","comment_is_top":false,"comment_ctime":1637307274,"is_pvip":false,"replies":[{"id":"117067","content":"生成证书失败。之前有不少学员也出现过生成证书失败，经排查是因为权限不对，或者目录不对。<br><br>你可以加我微信nightskong，微信现场帮你排查下。","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1637367871,"ip_address":"","comment_id":322335,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637307274","product_id":100079601,"comment_content":"都是，一键部署包失败报以下错误，麻烦帮忙看一下呢，采用默认密码<br>~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam ~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu<br>Database<br>iam<br>information_schema<br>test<br>prepare for iam installation successfully<br>~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu<br>~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam ~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu<br>~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam&#47;_output&#47;cert ~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam<br>Failed to parse input: unexpected end of JSON input<br>!!! [1118 23:17:48] Call tree:<br>!!! [1118 23:17:48]  1: .&#47;scripts&#47;gencerts.sh:149 generate-iam-cert(...)<br>!!! Error in .&#47;scripts&#47;gencerts.sh:81<br>  Error in .&#47;scripts&#47;gencerts.sh:81. &#39;((i&lt;3-1))&#39; exited with status 139 1<br>Call stack:<br>  1: .&#47;scripts&#47;gencerts.sh:81 generate-iam-cert(...)<br>  2: .&#47;scripts&#47;gencerts.sh:149 main(...)<br>Exiting with status 1<br>~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam&#47;_output&#47;cert ~&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam<br>Failed to parse input: unexpected end of JSON input<br>!!! [1118 23:17:48] Call tree:<br>!!! [1118 23:17:48]  1: .&#47;scripts&#47;gencerts.sh:149 generate-iam-cert(...)<br>!!! Error in .&#47;scripts&#47;gencerts.sh:81<br>  Error in .&#47;scripts&#47;gencerts.sh:81. &#39;((i&lt;3-1))&#39; exited with status 139 1<br>Call stack:<br>  1: .&#47;scripts&#47;gencerts.sh:81 generate-iam-cert(...)<br>  2: .&#47;scripts&#47;gencerts.sh:149 main(...)<br>Exiting with status 1<br>cp: cannot stat &#39;&#47;home&#47;going&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam&#47;_output&#47;cert&#47;iam-apiserver*pem&#39;: No such file or directory<br>===========&gt; Building binary iam-apiserver v1.2.0 for linux amd64<br>!!! [1118 23:17:49] iam-apiserver failed to start, maybe not installed properly<br>!!! Error in .&#47;scripts&#47;install&#47;install.sh:407<br>  Error in .&#47;scripts&#47;install&#47;install.sh:407. &#39;return 1&#39; exited with status 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;install.sh:407 main(...)<br>Exiting with status 1","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531630,"discussion_content":"生成证书失败。之前有不少学员也出现过生成证书失败，经排查是因为权限不对，或者目录不对。\n\n你可以加我微信nightskong，微信现场帮你排查下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637367871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":322191,"user_name":"用0和1改变自己","can_delete":false,"product_type":"c1","uid":1527530,"ip_address":"","ucode":"42B8F6ECF6BDD0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/lfMbV8RibrhFxjILg4550cZiaay64mTh5Zibon64TiaicC8jDMEK7VaXOkllHSpS582Jl1SUHm6Jib2AticVlHibiaBvUOA/132","comment_is_top":false,"comment_ctime":1637227329,"is_pvip":false,"replies":[{"id":"117019","content":"是用了最新的代码吗，最新的代码有过更新，可能是以为status=0导致的。<br>你可以加我微信：nightskong，帮你定位下。","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1637293951,"ip_address":"","comment_id":322191,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1637227329","product_id":100079601,"comment_content":"curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -d&#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;Admin@2021&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;login<br>{&quot;message&quot;:&quot;incorrect Username or Password&quot;}<br>求解：这个问题，查看了表都是有个字段：instanceID，还有什么原因会导致这个错误呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531369,"discussion_content":"是用了最新的代码吗，最新的代码有过更新，可能是以为status=0导致的。\n你可以加我微信：nightskong，帮你定位下。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637293951,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1527530,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/lfMbV8RibrhFxjILg4550cZiaay64mTh5Zibon64TiaicC8jDMEK7VaXOkllHSpS582Jl1SUHm6Jib2AticVlHibiaBvUOA/132","nickname":"用0和1改变自己","note":"","ucode":"42B8F6ECF6BDD0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":534512,"discussion_content":"用的是最新的代码，里面有instanceID,微信私聊您了，有时间抽空回下，感谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638200855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":531369,"ip_address":""},"score":534512,"extra":""}]}]},{"had_liked":false,"id":322052,"user_name":"Bosco","can_delete":false,"product_type":"c1","uid":1584512,"ip_address":"","ucode":"2DC13C2F0D469B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eq9seFoiaYyr0d85YI1icW858qjODSUY062CSOwHdEXBukolicJ0eVVnp6Wr1SBsyKHBvWwWggN7ibQIw/132","comment_is_top":false,"comment_ctime":1637149098,"is_pvip":false,"replies":[{"id":"117020","content":"有没有更多错误信息，比如执行命令的上下文。可以加我微信nightskong，帮你看下","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1637294011,"ip_address":"","comment_id":322052,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1637149098","product_id":100079601,"comment_content":"出现错误：<br>zsh: no matches found: mongodb:&#47;&#47;root:iam59!z$@127.0.0.1:27017&#47;iam_analytics?authSource=admin","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":531371,"discussion_content":"有没有更多错误信息，比如执行命令的上下文。可以加我微信nightskong，帮你看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637294011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":320213,"user_name":"销毁first","can_delete":false,"product_type":"c1","uid":2004616,"ip_address":"","ucode":"34685269D0CDD9","user_header":"https://static001.geekbang.org/account/avatar/00/1e/96/88/454e401c.jpg","comment_is_top":false,"comment_ctime":1636129681,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636129681","product_id":100079601,"comment_content":"新技能get","like_count":0},{"had_liked":false,"id":319549,"user_name":"Duan","can_delete":false,"product_type":"c1","uid":1006136,"ip_address":"","ucode":"ECA2A1ACFCDA24","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5a/38/7f9410f1.jpg","comment_is_top":false,"comment_ctime":1635846763,"is_pvip":false,"replies":[{"id":"115955","content":"666666","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1636003523,"ip_address":"","comment_id":319549,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635846763","product_id":100079601,"comment_content":"生成访问 iam-authz-server 的 token 时遇到 {&quot;code&quot;:100202,&quot;message&quot;:&quot;Signature is invalid&quot;} 错误。<br><br>问题发生在 jwt sigin 命令（生成访问 iam-authz-server 的 token）这里，原因是直接复制了老师的命令去执行，但上一步创建出的密钥（secretID 和 secretKey）其实跟老师的不一样，需要替换成自己的（可从数据库查询: select * from secret where name = &#39;authztest&#39;;）","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529667,"discussion_content":"666666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636003523,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319376,"user_name":"martin","can_delete":false,"product_type":"c1","uid":1819565,"ip_address":"","ucode":"11E2A5702E5EEB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QXlhQAlDkJLxC3R28qEIy9wsC2SeDRAvNUYL0w7ltzRq0aCsBddrbx7dkyhBoQicw4PTDYLiafa8Nib6hmIPq3OpQ/132","comment_is_top":false,"comment_ctime":1635765606,"is_pvip":false,"replies":[{"id":"115956","content":"在项目根目录下的configs&#47;目录下","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1636003546,"ip_address":"","comment_id":319376,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635765606","product_id":100079601,"comment_content":"iam.sql这个文件在哪？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529614,"discussion_content":"在项目根目录下的configs/目录下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636003546,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318498,"user_name":"小树苗","can_delete":false,"product_type":"c1","uid":1644500,"ip_address":"","ucode":"71288176D058E2","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqtnoXPFibFwKdrUibJQWYSCmAlc7FeEH5MbjiawszNgwEXAkuWKGYQMTQbnQbjlR8n9lpDgN4GQHoXQ/132","comment_is_top":false,"comment_ctime":1635315689,"is_pvip":false,"replies":[{"id":"116903","content":"要看下redis是否能够连接成功","user_name":"作者回复","user_name_real":"编辑","uid":"1167883","ctime":1637102549,"ip_address":"","comment_id":318498,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1635315689","product_id":100079601,"comment_content":"---安装和配置 iam-authz-server 第3步 【测试 iam-authz-server 是否成功安装。】Signature is invalid---<br>[going@dev iam]$ curl -s -XPOST -H&quot;Content-Type: application&#47;json&quot; -H&quot;Authorization: Bearer $token&quot; -d&#39;{&quot;metadata&quot;:{&quot;name&quot;:&quot;authztest&quot;},&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;secrets<br>{&quot;metadata&quot;:{&quot;id&quot;:27,&quot;instanceID&quot;:&quot;secret-309vjv&quot;,&quot;name&quot;:&quot;authztest&quot;,&quot;createdAt&quot;:&quot;2021-10-27T12:54:22.037+08:00&quot;,&quot;updatedAt&quot;:&quot;2021-10-27T12:54:22.048+08:00&quot;},&quot;username&quot;:&quot;admin&quot;,&quot;secretID&quot;:&quot;SaXocz5Lhmsv1GpswSf6S8c5f22mlyzeJuF6&quot;,&quot;secretKey&quot;:&quot;CrczUxI9QjdquLXPygEilT08NxIH2Fw4&quot;,&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret&quot;}[going@dev iam]$<br>[going@dev iam]$<br>[going@dev iam]$<br>[going@dev iam]$ iamctl jwt sign SaXocz5Lhmsv1GpswSf6S8c5f22mlyzeJuF6 CrczUxI9QjdquLXPygEilT08NxIH2Fw4<br>eyJhbGciOiJIUzI1NiIsImtpZCI6IlNhWG9jejVMaG1zdjFHcHN3U2Y2UzhjNWYyMm1seXplSnVGNiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYzNTMxNzcxMiwiaWF0IjoxNjM1MzEwNTEyLCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MzUzMTA1MTJ9.eTuOaNco7MHNXZ1C1w8MfqE7MRTfKD8iFcpUohFp6Uk<br>[going@dev iam]$<br>[going@dev iam]$<br>[going@dev iam]$<br>[going@dev iam]$ curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6IlNhWG9jejVMaG1zdjFHcHN3U2Y2UzhjNWYyMm1seXplSnVGNiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYzNTMxNzcxMiwiaWF0IjoxNjM1MzEwNTEyLCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MzUzMTA1MTJ9.eTuOaNco7MHNXZ1C1w8MfqE7MRTfKD8iFcpUohFp6Uk&#39; -d&#39;{&quot;subject&quot;:&quot;users:maria&quot;,&quot;action&quot;:&quot;delete&quot;,&quot;resource&quot;:&quot;resources:articles:ladon-introduction&quot;,&quot;context&quot;:{&quot;remoteIPAddress&quot;:&quot;192.168.0.5&quot;}}&#39; http:&#47;&#47;127.0.0.1:9090&#47;v1&#47;authz<br>{&quot;code&quot;:100202,&quot;message&quot;:&quot;Signature is invalid&quot;}[going@dev iam]$ ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530554,"discussion_content":"要看下redis是否能够连接成功","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637102549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":318307,"user_name":"风中劲草","can_delete":false,"product_type":"c1","uid":1107179,"ip_address":"","ucode":"DF4AAEC3FE95A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/e4/eb/a6ec4c1e.jpg","comment_is_top":false,"comment_ctime":1635237161,"is_pvip":false,"replies":[{"id":"115973","content":"这个问题解决了吗，没有日志，不好判断哪里的问题，如果没解决，可以加老师微信，现场帮你看看。","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1636004835,"ip_address":"","comment_id":318307,"utype":1}],"discussion_count":2,"race_medal":1,"score":"1635237161","product_id":100079601,"comment_content":"# 测试 iam-authz-server 是否成功安装中，测试资源授权是否通过，执行<br>curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6Ilp1eHZYTmZHMDhCZEVNcWtUYVA0MUwyRExBcmxFNkpwcW9veCIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXV0aHoubWFybW90ZWR1LmNvbSIsImV4cCI6MTYxNzg0NTE5NSwiaWF0IjoxNjE3ODM3OTk1LCJpc3MiOiJpYW1jdGwiLCJuYmYiOjE2MTc4Mzc5OTV9.za9yLM7lHVabPAlVQLCqXEaf8sTU6sodAsMXnmpXjMQ&#39; -d&#39;{&quot;subject&quot;:&quot;users:maria&quot;,&quot;action&quot;:&quot;delete&quot;,&quot;resource&quot;:&quot;resources:articles:ladon-introduction&quot;,&quot;context&quot;:{&quot;remoteIPAddress&quot;:&quot;192.168.0.5&quot;}}&#39; http:&#47;&#47;127.0.0.1:9090&#47;v1&#47;authz<br><br>老师，执行这条指令后， 抛异常 {&quot;code&quot;:100202,&quot;message&quot;:&quot;Signature is invalid&quot;}","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529179,"discussion_content":"这个问题解决了吗，没有日志，不好判断哪里的问题，如果没解决，可以加老师微信，现场帮你看看。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636004835,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1644500,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqtnoXPFibFwKdrUibJQWYSCmAlc7FeEH5MbjiawszNgwEXAkuWKGYQMTQbnQbjlR8n9lpDgN4GQHoXQ/132","nickname":"小树苗","note":"","ucode":"71288176D058E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":409287,"discussion_content":"我跟你同样情况","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635409628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317074,"user_name":"李浩荣","can_delete":false,"product_type":"c1","uid":1179191,"ip_address":"","ucode":"97D49F4601F5EC","user_header":"https://static001.geekbang.org/account/avatar/00/11/fe/37/05737808.jpg","comment_is_top":false,"comment_ctime":1634658378,"is_pvip":false,"replies":[{"id":"114906","content":"在最新的master分支中是：<br>mv iamctl.yaml $HOME&#47;.iam","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1634736328,"ip_address":"","comment_id":317074,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634658378","product_id":100079601,"comment_content":"mv config $HOME&#47;.iam<br>这里的 config 好像在前面步骤没有生成，这是从哪里来的呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528641,"discussion_content":"在最新的master分支中是：\nmv iamctl.yaml $HOME/.iam","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634736328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316982,"user_name":"咱是吓大的","can_delete":false,"product_type":"c1","uid":1292324,"ip_address":"","ucode":"A47C6DA5C00C6F","user_header":"https://static001.geekbang.org/account/avatar/00/13/b8/24/039f84a2.jpg","comment_is_top":false,"comment_ctime":1634632021,"is_pvip":true,"replies":[{"id":"114909","content":"看是core-dump了。能重装下数据库吗？加老师微信，帮你看下","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1634736429,"ip_address":"","comment_id":316982,"utype":1}],"discussion_count":1,"race_medal":4,"score":"1634632021","product_id":100079601,"comment_content":"mongodb无法启动，始终被卡在这里，老师看看。<br>Job for mongod.service failed because a fatal signal was delivered causing the control process to dump core. See &quot;systemctl status mongod.service&quot; and &quot;journalctl -xe&quot; for details.<br><br>  # systemctl status mongod<br>mongod.service - MongoDB Database Server<br>   Loaded: loaded (&#47;usr&#47;lib&#47;systemd&#47;system&#47;mongod.service; enabled; vendor preset: disabled)<br>   Active: failed (Result: core-dump) since Tue 2021-10-19 16:18:04 CST; 12s ago<br>     Docs: https:&#47;&#47;docs.mongodb.org&#47;manual<br>  Process: 2474 ExecStart=&#47;usr&#47;bin&#47;mongod $OPTIONS (code=dumped, signal=ILL)<br>  Process: 2471 ExecStartPre=&#47;usr&#47;bin&#47;chmod 0755 &#47;var&#47;run&#47;mongodb (code=exited, status=0&#47;SUCCESS)<br>  Process: 2468 ExecStartPre=&#47;usr&#47;bin&#47;chown mongod:mongod &#47;var&#47;run&#47;mongodb (code=exited, status=0&#47;SUCCESS)<br>  Process: 2465 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;run&#47;mongodb (code=exited, status=0&#47;SUCCESS)","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528598,"discussion_content":"看是core-dump了。能重装下数据库吗？加老师微信，帮你看下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634736429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316233,"user_name":"李林","can_delete":false,"product_type":"c1","uid":1116074,"ip_address":"","ucode":"6CE212259A5129","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/aa/48aaac9e.jpg","comment_is_top":false,"comment_ctime":1634210354,"is_pvip":true,"replies":[{"id":"114939","content":"6666","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1634742455,"ip_address":"","comment_id":316233,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634210354","product_id":100079601,"comment_content":"什么是保姆式教学啊（战术后仰），经过一下午的折腾，终于把几个服务搭建起来了，好家伙，文章后面还有一键式部署、卸载教学。爱了爱了，老师对sh脚本运用的很溜🤙🤙🤙","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528320,"discussion_content":"6666","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634742455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316230,"user_name":"静心","can_delete":false,"product_type":"c1","uid":1335457,"ip_address":"","ucode":"EB264FA6519FDA","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/a1/8f003697.jpg","comment_is_top":false,"comment_ctime":1634208715,"is_pvip":true,"replies":[{"id":"114940","content":"对的。iam项目后续会加入docker安装教程","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1634742488,"ip_address":"","comment_id":316230,"utype":1}],"discussion_count":1,"race_medal":5,"score":"1634208715","product_id":100079601,"comment_content":"如果是在公司最好使用现成的基本平台服务（如，Redis、MongoDB、MarianDB等），如果非要在本地开发，建议采用相应的docker镜像，启动docker容器，可能会让安装变得更简单一些，对于本机的压力也会小一些。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528319,"discussion_content":"对的。iam项目后续会加入docker安装教程","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634742488,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316180,"user_name":"Geek_6ed9a9","can_delete":false,"product_type":"c1","uid":2007645,"ip_address":"","ucode":"197EBAC73208FD","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/U3Et3ZNeNuKIvs6aAE4tSlQ3rgLvMKsIlMnZESDJbibW6Z7ibfJvwLnzpGkicfD60F5Fun5xPwA6921xVXyjHiaekg/132","comment_is_top":false,"comment_ctime":1634193091,"is_pvip":false,"replies":[{"id":"114925","content":"用docker会方便很多。后面会提供docker的安装方法和镜像。","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1634737869,"ip_address":"","comment_id":316180,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634193091","product_id":100079601,"comment_content":"用docker做这些事情会不会方便很多？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528296,"discussion_content":"用docker会方便很多。后面会提供docker的安装方法和镜像。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634737869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315564,"user_name":"gecko","can_delete":false,"product_type":"c1","uid":1198048,"ip_address":"","ucode":"2B7122536F1A0E","user_header":"https://static001.geekbang.org/account/avatar/00/12/47/e0/1ff26e99.jpg","comment_is_top":false,"comment_ctime":1633921000,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633921000","product_id":100079601,"comment_content":"mysql 和服务不在一个机器上需要授权下mysql 用户<br><br><br>在mysql 服务器上用 root 用户登陆<br>mysql -h127.0.0.1  -uroot -p&#39;iam59!z$&#39;<br><br>授权<br><br>MariaDB [(none)]&gt; grant all privileges on  iam.* to &#39;iam&#39;@&#39;%&#39; identified by &#39;iam59!z$&#39;;<br>Query OK, 0 rows affected (0.004 sec)<br><br>MariaDB [(none)]&gt; ","like_count":0},{"had_liked":false,"id":315135,"user_name":"fcl","can_delete":false,"product_type":"c1","uid":2774638,"ip_address":"","ucode":"9FC74C4B1DD0B3","user_header":"https://static001.geekbang.org/account/avatar/00/2a/56/6e/de7da340.jpg","comment_is_top":false,"comment_ctime":1633698184,"is_pvip":false,"replies":[{"id":"114944","content":"不应该，是不是哪里执行出问题了。可以再试试， 如果还有问题，可以加老师微信","user_name":"作者回复","user_name_real":"孔令飞","uid":"1167883","ctime":1634742991,"ip_address":"","comment_id":315135,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633698184","product_id":100079601,"comment_content":"MariaDB [(none)]&gt; source configs&#47;iam.sql; 在IAM下面进的DB执行不了 显示ERROR 2<br>切换到 configs里面进DB 直接source iam.sql 才可以 这是为啥？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527877,"discussion_content":"不应该，是不是哪里执行出问题了。可以再试试， 如果还有问题，可以加老师微信","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634742991,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314961,"user_name":"刹那","can_delete":false,"product_type":"c1","uid":1926228,"ip_address":"","ucode":"2D33D2131A4FEB","user_header":"https://static001.geekbang.org/account/avatar/00/1d/64/54/509e33d5.jpg","comment_is_top":false,"comment_ctime":1633613235,"is_pvip":true,"replies":[{"id":"114061","content":"这种WARNING级别的告警不用管，不影响的","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1633660071,"ip_address":"","comment_id":314961,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633613235","product_id":100079601,"comment_content":"$ .&#47;scripts&#47;update-generated-docs.sh<br>===========&gt; Building binary gendocs v1.1.0-1-gc41e791 for darwin amd64<br>===========&gt; Building binary geniamdocs v1.1.0-1-gc41e791 for darwin amd64<br>===========&gt; Building binary genman v1.1.0-1-gc41e791 for darwin amd64<br>===========&gt; Building binary genyaml v1.1.0-1-gc41e791 for darwin amd64<br>WARNING: go-md2man does not handle node type HTMLSpan<br>WARNING: go-md2man does not handle node type HTMLSpan<br>WARNING: go-md2man does not handle node type HTMLSpan<br>WARNING: go-md2man does not handle node type HTMLSpan<br>WARNING: go-md2man does not handle node type HTMLSpan<br>WARNING: go-md2man does not handle node type HTMLSpan<br>WARNING: go-md2man does not handle node type HTMLSpan<br>WARNING: go-md2man does not handle node type HTMLSpan<br>WARNING: go-md2man does not handle node type HTMLSpan<br><br>出了很多这种告警","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527840,"discussion_content":"这种WARNING级别的告警不用管，不影响的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633660071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314844,"user_name":"leetac","can_delete":false,"product_type":"c1","uid":2793745,"ip_address":"","ucode":"F306EF82AA0D7B","user_header":"","comment_is_top":false,"comment_ctime":1633498316,"is_pvip":false,"replies":[{"id":"114064","content":"iamctl是不是没有放到Linux的PATH目录下。可以看下iam源码的README文件中，有我的微信号，加我，我拉你入群","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1633660218,"ip_address":"","comment_id":314844,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633498316","product_id":100079601,"comment_content":"老师，在安装iamctl遇到了个问题，执行iamctl user list 报找不到该命令，是否有相应的交流群？能否拉我进去请教一下？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527807,"discussion_content":"iamctl是不是没有放到Linux的PATH目录下。可以看下iam源码的README文件中，有我的微信号，加我，我拉你入群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633660218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314819,"user_name":"leetac","can_delete":false,"product_type":"c1","uid":2793745,"ip_address":"","ucode":"F306EF82AA0D7B","user_header":"","comment_is_top":false,"comment_ctime":1633452657,"is_pvip":false,"replies":[{"id":"114065","content":"export PATH=$HOME&#47;bin:$PATH 试试。<br><br>可能你的$HOME&#47;bin目录没有加入到Linux PATH搜索路径中。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1633660342,"ip_address":"","comment_id":314819,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633452657","product_id":100079601,"comment_content":"前辈，跟着你的步骤走，到 iamctl user list 这步之后没有这个命令，切换成root 也一样。bash: iamctl: 未找到命令...<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527801,"discussion_content":"export PATH=$HOME/bin:$PATH 试试。\n\n可能你的$HOME/bin目录没有加入到Linux PATH搜索路径中。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633660342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314637,"user_name":"卢山","can_delete":false,"product_type":"c1","uid":1310244,"ip_address":"","ucode":"033EB9C7DEE4DA","user_header":"https://static001.geekbang.org/account/avatar/00/13/fe/24/1b5880e7.jpg","comment_is_top":false,"comment_ctime":1633270288,"is_pvip":false,"replies":[{"id":"114067","content":"本讲中，准备工作部分的的：第 3 步，创建需要的目录。<br><br>实际路径可以看下scripts&#47;install&#47;environment.sh文件中配置的值。<br><br>例如：IAM_DATA_DIR配置的值为：<br>$ grep IAM_DATA_DIR scripts&#47;install&#47;environment.sh<br>readonly IAM_DATA_DIR=${IAM_DATA_DIR:-&#47;data&#47;iam} # iam 各组件数据目录<br><br>默认为&#47;data&#47;iam","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1633660718,"ip_address":"","comment_id":314637,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633270288","product_id":100079601,"comment_content":"${IAM_DATA_DIR}<br>${IAM_INSTALL_DIR}<br>${IAM_CONFIG_DIR}<br>${IAM_LOG_DIR}<br>老师，请问下，上面这几个对应的实际目录，是在哪里建的？实际路径是什么？<br>$IAM_ROOT&#47;加对应的名字吗?<br>比如IAM_DATA_DIR=$IAM_ROOT&#47;data ?","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527747,"discussion_content":"本讲中，准备工作部分的的：第 3 步，创建需要的目录。\n\n实际路径可以看下scripts/install/environment.sh文件中配置的值。\n\n例如：IAM_DATA_DIR配置的值为：\n$ grep IAM_DATA_DIR scripts/install/environment.sh\nreadonly IAM_DATA_DIR=${IAM_DATA_DIR:-/data/iam} # iam 各组件数据目录\n\n默认为/data/iam","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633660718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314611,"user_name":"...","can_delete":false,"product_type":"c1","uid":2621374,"ip_address":"","ucode":"7410A29031EDEA","user_header":"https://static001.geekbang.org/account/avatar/00/27/ff/be/83f2d3f6.jpg","comment_is_top":false,"comment_ctime":1633256799,"is_pvip":false,"replies":[{"id":"114068","content":"是不是token过期了，试试执行下面两行命令：<br>token=`curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -d&#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;Admin@2021&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;login | jq -r .token`<br>curl -s -XGET -H&quot;Authorization: Bearer $token&quot; &#39;http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users?offset=0&amp;limit=10&#39;","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1633660937,"ip_address":"","comment_id":314611,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633256799","product_id":100079601,"comment_content":"[going@dev iam]$ curl -s -XGET -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MzMzMzk3NjksImlkZW50aXR5IjoiYWRtaW4iLCJpc3MJGFU285GH25D2VydmVyIiwib3JpZ19pYXOggJUItE0EFCFJ7lr1r8a4dPawdOtqt3rfJc&#39; &#39;http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users?offset=0&amp;limit=10&#39;<br>{&quot;code&quot;:100207,&quot;message&quot;:&quot;Permission denied&quot;}<br>-----<br>2021-10-03 18:22:07.565\t\u001b[34mINFO\u001b[0m\tapiserver\tapiserver&#47;auth.go:205\tuser `admin` is authenticated.\t{&quot;requestID&quot;: &quot;e0f9dd43-e162-4eb5-9a5f-4e561a145367&quot;, &quot;username&quot;: &quot;admin&quot;}<br>2021-10-03 18:22:07.566\t\u001b[34mINFO\u001b[0m\tapiserver\tgorm@v1.21.12&#47;callbacks.go:133\tmysql&#47;user.go:76 record not found[1.606ms] [rows:0] SELECT * FROM `user` WHERE name = &#39;admin&#39; ORDER BY `user`.`id` LIMIT 1<br>2021-10-03 18:22:07.567\t\u001b[34mINFO\u001b[0m\tapiserver\tmiddleware&#47;logger.go:135\t403 - [127.0.0.1] &quot;2.13881ms GET &#47;v1&#47;users?offset=0&amp;limit=10&quot; \t{&quot;requestID&quot;: &quot;e0f9dd43-e162-4eb5-9a5f-4e561a145367&quot;, &quot;username&quot;: &quot;admin&quot;}","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527736,"discussion_content":"是不是token过期了，试试执行下面两行命令：\ntoken=`curl -s -XPOST -H&amp;#39;Content-Type: application/json&amp;#39; -d&amp;#39;{&amp;quot;username&amp;quot;:&amp;quot;admin&amp;quot;,&amp;quot;password&amp;quot;:&amp;quot;Admin@2021&amp;quot;}&amp;#39; http://127.0.0.1:8080/login | jq -r .token`\ncurl -s -XGET -H&amp;quot;Authorization: Bearer $token&amp;quot; &amp;#39;http://127.0.0.1:8080/v1/users?offset=0&amp;amp;limit=10&amp;#39;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633660937,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314526,"user_name":"卢山","can_delete":false,"product_type":"c1","uid":1310244,"ip_address":"","ucode":"033EB9C7DEE4DA","user_header":"https://static001.geekbang.org/account/avatar/00/13/fe/24/1b5880e7.jpg","comment_is_top":false,"comment_ctime":1633175633,"is_pvip":false,"replies":[{"id":"114077","content":"是不是clone命令错误了。试试：<br><br>git clone https:&#47;&#47;github.com&#47;marmotedu&#47;iam","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1633664208,"ip_address":"","comment_id":314526,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1633175633","product_id":100079601,"comment_content":"Cloning into &#39;D:\\go\\src\\github.com\\marmotedu\\iam&#39;...<br>fatal: unable to access &#39;https:&#47;&#47;github.com&#47;marmotedu&#47;iam.git&#47;&#39;: Empty reply from server<br><br>git 未能顺利结束 (退出码 128) (123469 ms @ 2021&#47;10&#47;2 19:44:52)<br><br>用CENTOS8和windows都试了一下，都报这个错误，请问老师这是原因？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527711,"discussion_content":"是不是clone命令错误了。试试：\n\ngit clone https://github.com/marmotedu/iam","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633664208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1310244,"avatar":"https://static001.geekbang.org/account/avatar/00/13/fe/24/1b5880e7.jpg","nickname":"卢山","note":"","ucode":"033EB9C7DEE4DA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":400417,"discussion_content":"重新pull一次就可以了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633266837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314194,"user_name":"gecko","can_delete":false,"product_type":"c1","uid":1198048,"ip_address":"","ucode":"2B7122536F1A0E","user_header":"https://static001.geekbang.org/account/avatar/00/12/47/e0/1ff26e99.jpg","comment_is_top":false,"comment_ctime":1632895127,"is_pvip":false,"replies":[{"id":"114096","content":"最新的master分支，iamctl的配置文件名换成iamctl.yaml了。可以执行以下命令来生成：<br><br>.&#47;scripts&#47;genconfig.sh scripts&#47;install&#47;environment.sh configs&#47;iamctl.yaml &gt; iamctl.yaml","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1633665700,"ip_address":"","comment_id":314194,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632895127","product_id":100079601,"comment_content":"生成的命令行工具的配置文件是空的<br>[going@dev iam]$ .&#47;scripts&#47;genconfig.sh scripts&#47;install&#47;environment.sh configs&#47;config &gt; config<br>[going@dev iam]$ cat config<br><br>[going@dev iam]$ <br><br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527607,"discussion_content":"最新的master分支，iamctl的配置文件名换成iamctl.yaml了。可以执行以下命令来生成：\n\n./scripts/genconfig.sh scripts/install/environment.sh configs/iamctl.yaml &amp;gt; iamctl.yaml","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633665700,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314058,"user_name":"Geek_602240","can_delete":false,"product_type":"c1","uid":2783658,"ip_address":"","ucode":"231974A772D27C","user_header":"","comment_is_top":false,"comment_ctime":1632821138,"is_pvip":false,"replies":[{"id":"113773","content":"直接执行这个命令看报啥错：<br>&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1632846902,"ip_address":"","comment_id":314058,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632821138","product_id":100079601,"comment_content":"systemctl status iam-apiserver -l<br>● iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Tue 2021-09-28 17:24:19 CST; 4s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 17757 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=1&#47;FAILURE)<br>  Process: 17754 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 17752 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 17757 (code=exited, status=1&#47;FAILURE)<br><br>Sep 28 17:24:19 10-150-81-101.localdomain iam-apiserver[17757]: &#47;var&#47;go_project&#47;learngo&#47;pkg&#47;mod&#47;github.com&#47;spf13&#47;cobra@v1.2.1&#47;command.go:974<br>Sep 28 17:24:19 10-150-81-101.localdomain iam-apiserver[17757]: github.com&#47;spf13&#47;cobra.(*Command).Execute<br>Sep 28 17:24:19 10-150-81-101.localdomain systemd[1]: iam-apiserver.service failed.<br>Sep 28 17:24:19 10-150-81-101.localdomain iam-apiserver[17757]: &#47;var&#47;go_project&#47;learngo&#47;pkg&#47;mod&#47;github.com&#47;spf13&#47;cobra@v1.2.1&#47;command.go:902<br>Sep 28 17:24:19 10-150-81-101.localdomain iam-apiserver[17757]: github.com&#47;marmotedu&#47;iam&#47;pkg&#47;app.(*App).Run<br>Sep 28 17:24:19 10-150-81-101.localdomain iam-apiserver[17757]: &#47;var&#47;go_project&#47;iam&#47;src&#47;github.com&#47;marmotedu&#47;iam&#47;pkg&#47;app&#47;app.go:233<br>Sep 28 17:24:19 10-150-81-101.localdomain iam-apiserver[17757]: main.main<br>Sep 28 17:24:19 10-150-81-101.localdomain iam-apiserver[17757]: &#47;var&#47;go_project&#47;iam&#47;src&#47;github.com&#47;marmotedu&#47;iam&#47;cmd&#47;iam-apiserver&#47;apiserver.go:24<br>Sep 28 17:24:19 10-150-81-101.localdomain iam-apiserver[17757]: runtime.main<br>Sep 28 17:24:19 10-150-81-101.localdomain iam-apiserver[17757]: &#47;usr&#47;local&#47;go&#47;src&#47;runtime&#47;proc.go:204<br><br>我是go 1.15, GOPATH有多个，启动apiserver报错","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527560,"discussion_content":"直接执行这个命令看报啥错：\n/opt/iam/bin/iam-apiserver --config=/etc/iam/iam-apiserver.yaml","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632846902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313661,"user_name":"lysch","can_delete":false,"product_type":"c1","uid":1485107,"ip_address":"","ucode":"5CACF6E4857E05","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEK5LqjpiajvBgW7QmRiamBXcFCTibicZibA39ZCCZh9YR4emjVBIY1EOpcJC9ZNW5Snz5QUmSfXeT38pww/132","comment_is_top":false,"comment_ctime":1632584282,"is_pvip":false,"replies":[{"id":"113654","content":"<br>用v1.1.0版本的：<br><br>$ export LINUX_PASSWORD=&#39;iam59!z$&#39; # 重要：这里要 export going 用户的密码<br>$ version=v1.1.0 &amp;&amp; curl https:&#47;&#47;marmotedu-1254073058.cos.ap-beijing.myqcloud.com&#47;iam-release&#47;${version}&#47;iam.tar.gz | tar -xz -C &#47; tmp&#47;       <br>$ cd &#47;tmp&#47;iam&#47; &amp;&amp; .&#47;scripts&#47;install&#47;install.sh iam::install::install<br>","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1632756978,"ip_address":"","comment_id":313661,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632584282","product_id":100079601,"comment_content":"彩蛋地址失效了<br>[going@dev ~]$ curl https:&#47;&#47;marmotedu-1254073058.cos.ap-beijing.myqcloud.com&#47;iam-release&#47;1.0.0&#47;iam.tar.gz<br>&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39; ?&gt;<br>&lt;Error&gt;<br>        &lt;Code&gt;NoSuchKey&lt;&#47;Code&gt;<br>        &lt;Message&gt;The specified key does not exist.&lt;&#47;Message&gt;<br>        &lt;Resource&gt;marmotedu-1254073058.cos.ap-beijing.myqcloud.com&#47;iam-release&#47;1.0.0&#47;iam.tar.gz&lt;&#47;Resource&gt;<br>        &lt;RequestId&gt;NjE0ZjQxYWJfYTdjMjJhMDlfNzBkN18yZDFmM2Jk&lt;&#47;RequestId&gt;<br>        &lt;TraceId&gt;OGVmYzZiMmQzYjA2OWNhODk0NTRkMTBiOWVmMDAxODc0OWRkZjk0ZDM1NmI1M2E2MTRlY2MzZDhmNmI5MWI1OTkwMTkyODMxODFlYzJhYTVmMmIyNDI0YjMyOGQxMzc1MTJhNjg4YjMxOWNiMGVjYWRiYWRlYTc0MjhlN2M3NWY=&lt;&#47;TraceId&gt;<br>&lt;&#47;Error&gt;<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527430,"discussion_content":"\n用v1.1.0版本的：\n\n$ export LINUX_PASSWORD=&amp;#39;iam59!z$&amp;#39; # 重要：这里要 export going 用户的密码\n$ version=v1.1.0 &amp;amp;&amp;amp; curl https://marmotedu-1254073058.cos.ap-beijing.myqcloud.com/iam-release/${version}/iam.tar.gz | tar -xz -C / tmp/       \n$ cd /tmp/iam/ &amp;amp;&amp;amp; ./scripts/install/install.sh iam::install::install\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632756978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313658,"user_name":"lysch","can_delete":false,"product_type":"c1","uid":1485107,"ip_address":"","ucode":"5CACF6E4857E05","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEK5LqjpiajvBgW7QmRiamBXcFCTibicZibA39ZCCZh9YR4emjVBIY1EOpcJC9ZNW5Snz5QUmSfXeT38pww/132","comment_is_top":false,"comment_ctime":1632583094,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632583094","product_id":100079601,"comment_content":"另外能拉我进技术交流群么？刚上手，感觉文章和代码版本对应的有些问题，迫切需要交流哇","like_count":0},{"had_liked":false,"id":313656,"user_name":"lysch","can_delete":false,"product_type":"c1","uid":1485107,"ip_address":"","ucode":"5CACF6E4857E05","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEK5LqjpiajvBgW7QmRiamBXcFCTibicZibA39ZCCZh9YR4emjVBIY1EOpcJC9ZNW5Snz5QUmSfXeT38pww/132","comment_is_top":false,"comment_ctime":1632582791,"is_pvip":false,"replies":[{"id":"113655","content":"用master分支哈","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1632757197,"ip_address":"","comment_id":313656,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632582791","product_id":100079601,"comment_content":"你好，我是刚加入本课程学习的，我看到github该项目还在持续更新，结合当前课程，我应该使用哪个分支比较好？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527428,"discussion_content":"用master分支哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632757197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313196,"user_name":"FreeMason","can_delete":false,"product_type":"c1","uid":1340120,"ip_address":"","ucode":"3D58AC2F9AB345","user_header":"https://static001.geekbang.org/account/avatar/00/14/72/d8/9eedbc5e.jpg","comment_is_top":false,"comment_ctime":1632306410,"is_pvip":false,"replies":[{"id":"113665","content":"看下是不是配置文件内容有问题，重新生成下配置文件。加我微信nightskong，如果还有问题的话","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1632757763,"ip_address":"","comment_id":313196,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632306410","product_id":100079601,"comment_content":"执行 `iamctl user list` 命令<br><br>总报：<br>```<br>2021-09-22 10:24:28.606 WARN    server&#47;config.go:143    WARNING: viper failed to discover and load the configuration file: While parsing config: yaml: control characters are not allowed<br>error: {&quot;code&quot;:100204,&quot;message&quot;:&quot;Invalid authorization header&quot;}<br>```","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527271,"discussion_content":"看下是不是配置文件内容有问题，重新生成下配置文件。加我微信nightskong，如果还有问题的话","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632757763,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313023,"user_name":"cshzet","can_delete":false,"product_type":"c1","uid":2593667,"ip_address":"","ucode":"A343CCB6E5D519","user_header":"https://static001.geekbang.org/account/avatar/00/27/93/83/cb37c46e.jpg","comment_is_top":false,"comment_ctime":1632213249,"is_pvip":true,"replies":[{"id":"113672","content":"对，修改配置文件名就可以了。最新的master分支已经修复这个问题了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1632758563,"ip_address":"","comment_id":313023,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632213249","product_id":100079601,"comment_content":"执行 iamctl user list 报错了<br>[going@dev iam]$ iamctl user list<br>2021-09-21 16:30:40.230\tWARN\tserver&#47;config.go:143\tWARNING: viper failed to discover and load the configuration file: Config File &quot;iamctl&quot; Not Found in &quot;[&#47;home&#47;hzet&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam &#47;etc&#47;iam &#47;home&#47;hzet&#47;.iam]&quot;<br>error: {&quot;code&quot;:100204,&quot;message&quot;:&quot;Invalid authorization header&quot;}<br><br>将配置名修改为 mv $HOME&#47;.iam&#47;config iamctl 就可以了<br>[going@dev iam]$ mv $HOME&#47;.iam&#47;config iamctl<br>[going@dev iam]$ iamctl user list<br>NAME    NICKNAME   EMAIL               PHONE         CREATED               UPDATED              <br>admin  admin     admin@foxmail.com  1812884xxxx  2021-05-27 18:01:40  2021-05-06 05:13:14  <br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527200,"discussion_content":"对，修改配置文件名就可以了。最新的master分支已经修复这个问题了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632758563,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312950,"user_name":"sam700000","can_delete":false,"product_type":"c1","uid":1069133,"ip_address":"","ucode":"C2ABDDC56B2D50","user_header":"https://static001.geekbang.org/account/avatar/00/10/50/4d/db91e218.jpg","comment_is_top":false,"comment_ctime":1632139241,"is_pvip":true,"replies":[{"id":"113673","content":"强！","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1632758754,"ip_address":"","comment_id":312950,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632139241","product_id":100079601,"comment_content":"在wsl Ubuntu18.04下用docker和supervisor替代了systemd的功能，基础服务mysql mongodb redis全用docker-compose启动，iam守护进程都用supervisord的容器管理，没问题，wsl的docker还可以在windows这边有docker客户端面板查看和控制容器状态","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527176,"discussion_content":"强！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632758754,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312760,"user_name":"Alex","can_delete":false,"product_type":"c1","uid":1675789,"ip_address":"","ucode":"B022989B4C0ACA","user_header":"https://static001.geekbang.org/account/avatar/00/19/92/0d/849760e3.jpg","comment_is_top":false,"comment_ctime":1631971831,"is_pvip":false,"replies":[{"id":"113698","content":"啥系统呢？看起来像是系统差异。<br><br>直接执行以下命令试试：<br><br>sudo yum -y install MariaDB-server MariaDB-client","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1632760872,"ip_address":"","comment_id":312760,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1631971831","product_id":100079601,"comment_content":"--&gt; Finished Dependency Resolution<br>Error: Package: galera-4-26.4.9-1.el8.x86_64 (mariadb)<br>           Requires: libstdc++.so.6(GLIBCXX_3.4.21)(64bit)<br>Error: Package: galera-4-26.4.9-1.el8.x86_64 (mariadb)<br>           Requires: libstdc++.so.6(GLIBCXX_3.4.20)(64bit)<br>Error: Package: galera-4-26.4.9-1.el8.x86_64 (mariadb)<br>           Requires: libboost_program_options.so.1.66.0()(64bit)<br>Error: Package: galera-4-26.4.9-1.el8.x86_64 (mariadb)<br>           Requires: libstdc++.so.6(CXXABI_1.3.8)(64bit)<br> You could try using --skip-broken to work around the problem<br> You could try running: rpm -Va --nofiles --nodigest<br>!!! [0918 21:17:23] Call tree:<br>!!! [0918 21:17:23]  1: .&#47;scripts&#47;install&#47;mariadb.sh:36 iam::common::sudo(...)<br>!!! [0918 21:17:23]  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23<br>  Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23. &#39;((i&lt;4-1))&#39; exited with status 0 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23 iam::common::sudo(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:36 iam::mariadb::install(...)<br>  3: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)<br>Exiting with status 1<br><br>这个问题一直解决不了","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527103,"discussion_content":"啥系统呢？看起来像是系统差异。\n\n直接执行以下命令试试：\n\nsudo yum -y install MariaDB-server MariaDB-client","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632760872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1886549,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/c9/55/8973db30.jpg","nickname":"七桐木","note":"","ucode":"90B766A0A6C334","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":535396,"discussion_content":"请注意，老师的系统是centos8","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1638426758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311240,"user_name":"Q","can_delete":false,"product_type":"c1","uid":1079792,"ip_address":"","ucode":"2D8B22F4A7FF75","user_header":"https://static001.geekbang.org/account/avatar/00/10/79/f0/6ebfcf70.jpg","comment_is_top":false,"comment_ctime":1631114826,"is_pvip":true,"replies":[{"id":"112826","content":"密钥名已经存在了：authztest。<br>最新版本，支持密钥名同名","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1631178976,"ip_address":"","comment_id":311240,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631114826","product_id":100079601,"comment_content":"在获取秘钥的时候，报了一个数据库的错误<br>curl -s -XPOST -H&quot;Content-Type: application&#47;json&quot; -H&quot;Authorization: Bearer $token&quot; -d&#39;{&quot;metadata&quot;:{&quot;name&quot;:&quot;authztest&quot;},&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;secrets<br>{&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;}，数据库命令连接是正常的，select * from secret 也能看到生成的秘钥","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526536,"discussion_content":"密钥名已经存在了：authztest。\n最新版本，支持密钥名同名","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631178976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":311012,"user_name":"Q","can_delete":false,"product_type":"c1","uid":1079792,"ip_address":"","ucode":"2D8B22F4A7FF75","user_header":"https://static001.geekbang.org/account/avatar/00/10/79/f0/6ebfcf70.jpg","comment_is_top":false,"comment_ctime":1631017750,"is_pvip":true,"replies":[{"id":"112749","content":"可以用v1.0.8哈。如果用的是最新的master要这么来操作：<br>.&#47;scripts&#47;genconfig.sh scripts&#47;install&#47;environment.sh configs&#47;iamctl.yaml&gt; iamctl.yaml<br>","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1631078277,"ip_address":"","comment_id":311012,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1631017750","product_id":100079601,"comment_content":"老师，这个命令 <br>$ .&#47;scripts&#47;genconfig.sh scripts&#47;install&#47;environment.sh configs&#47;config &gt; config<br>sed: can&#39;t read configs&#47;config: No such file or directory<br>cat: configs&#47;config: No such file or directory<br><br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526434,"discussion_content":"可以用v1.0.8哈。如果用的是最新的master要这么来操作：\n./scripts/genconfig.sh scripts/install/environment.sh configs/iamctl.yaml&amp;gt; iamctl.yaml\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631078277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310758,"user_name":"Dawin_Park","can_delete":false,"product_type":"c1","uid":1412457,"ip_address":"","ucode":"2F8281C81D9FBE","user_header":"https://static001.geekbang.org/account/avatar/00/15/8d/69/46aaa88f.jpg","comment_is_top":false,"comment_ctime":1630895677,"is_pvip":false,"replies":[{"id":"112745","content":"这里是为了学习快速部署。后面会讲解如何部署iam系统，里面会使用docker来部署。<br><br>不过，这里后面也准备加入docker的部署方式。感谢老哥反馈","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1631077636,"ip_address":"","comment_id":310758,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630895677","product_id":100079601,"comment_content":"为什么没有使用docker部署呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526340,"discussion_content":"这里是为了学习快速部署。后面会讲解如何部署iam系统，里面会使用docker来部署。\n\n不过，这里后面也准备加入docker的部署方式。感谢老哥反馈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631077636,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310510,"user_name":"Kevin","can_delete":false,"product_type":"c1","uid":1165862,"ip_address":"","ucode":"47DB03287476A3","user_header":"https://static001.geekbang.org/account/avatar/00/11/ca/26/84354e08.jpg","comment_is_top":false,"comment_ctime":1630689741,"is_pvip":true,"replies":[{"id":"112566","content":"老哥，你 太强了，理解到了精髓。<br><br>已经优化了，commit id: 83004c249e6f6a304c0059d2ece1440bbb274685","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1630864001,"ip_address":"","comment_id":310510,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630689741","product_id":100079601,"comment_content":"在iam的source code內<br>iam\\pkg\\db\\mysql.go  裡面用了 &quot;github.com&#47;marmotedu&#47;iam&#47;internal&#47;pkg&#47;logger&quot;<br>是不是錯了?<br><br>外部pkg不應該使用內部pkg","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526256,"discussion_content":"老哥，你 太强了，理解到了精髓。\n\n已经优化了，commit id: 83004c249e6f6a304c0059d2ece1440bbb274685","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630864001,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":310329,"user_name":"小蚂蚁","can_delete":false,"product_type":"c1","uid":2459100,"ip_address":"","ucode":"6B60BB03BB08DA","user_header":"https://static001.geekbang.org/account/avatar/00/25/85/dc/f18b4658.jpg","comment_is_top":false,"comment_ctime":1630596778,"is_pvip":false,"replies":[{"id":"112568","content":"如果用的是master的最代码，可以这么来生成：<br><br> $ .&#47;scripts&#47;genconfig.sh <br>$ scripts&#47;install&#47;environment.sh configs&#47;iamctl.yaml &gt; iamctl.yaml<br>$ mkdir -p $HOME&#47;.iam<br>$ mv iamctl.yaml $HOME&#47;.iam","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1630864164,"ip_address":"","comment_id":310329,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630596778","product_id":100079601,"comment_content":"IAM对应master分支<br>执行如下：<br>[going@dev iam]$ .&#47;scripts&#47;genconfig.sh scripts&#47;install&#47;environment.sh configs&#47;iamctl.yaml &gt; config<br>[going@dev iam]$ mkdir -p $HOME&#47;.iam<br>[going@dev iam]$ mv config $HOME&#47;.iam<br>[going@dev iam]$ iamctl user list<br>error: Get &quot;https:&#47;&#47;iam.api.marmotedu.com:8443&#47;v1&#47;users?limit=1000&amp;offset=0&quot;: x509: certificate signed by unknown authority (possibly because of &quot;crypto&#47;rsa: verification error&quot; while trying to verify candidate authority certificate &quot;iam-ca&quot;)<br>[going@dev iam]$<br><br>求助下，谢谢","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526198,"discussion_content":"如果用的是master的最代码，可以这么来生成：\n\n $ ./scripts/genconfig.sh \n$ scripts/install/environment.sh configs/iamctl.yaml &amp;gt; iamctl.yaml\n$ mkdir -p $HOME/.iam\n$ mv iamctl.yaml $HOME/.iam","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630864164,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309466,"user_name":"⁶₆⁶₆⁶₆","can_delete":false,"product_type":"c1","uid":1940453,"ip_address":"","ucode":"25AE3F77318541","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9b/e5/bd0be5c3.jpg","comment_is_top":false,"comment_ctime":1630148760,"is_pvip":true,"replies":[{"id":"112821","content":"将remoteIP 替换成 remoteIPAddress。<br>已经找编译更新文章了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1631177706,"ip_address":"","comment_id":309466,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1630148760","product_id":100079601,"comment_content":"能够获取到用户信息，但是在执行iamctl user list的时候，报错了：<br>[admin@dev ~]$ curl -s -XGET -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MzAyMzQ5NDAsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MzAxNDg1NDAsInN1YiI6ImFkbWluIn0.8HFlHwJzmuC3yR3NfOfqcnkJWM6jKl574hVPkTbzXew&#39; &#39;http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users?offset=0&amp;limit=10&#39;<br>{&quot;totalCount&quot;:1,&quot;items&quot;:[{&quot;metadata&quot;:{&quot;instanceID&quot;:&quot;user-lingfei&quot;,&quot;name&quot;:&quot;admin&quot;,&quot;createdAt&quot;:&quot;2021-05-27T18:01:40+08:00&quot;,&quot;updatedAt&quot;:&quot;2021-05-06T05:13:14+08:00&quot;},&quot;nickname&quot;:&quot;admin&quot;,&quot;email&quot;:&quot;admin@foxmail.com&quot;,&quot;phone&quot;:&quot;1812884xxxx&quot;,&quot;totalPolicy&quot;:1}]}[admin@dev ~]$<br>[admin@dev ~]$<br>[admin@dev ~]$ iamctl user list<br>2021-08-28 19:03:56.455 WARN    server&#47;config.go:143    WARNING: viper failed to discover and load the configuration file: Config File &quot;iamctl&quot; Not Found in &quot;[&#47;home&#47;admin &#47;etc&#47;iam &#47;home&#47;admin&#47;.iam]&quot;<br>error: {&quot;code&quot;:100204,&quot;message&quot;:&quot;Invalid authorization header&quot;}<br>[admin@dev ~]$<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525884,"discussion_content":"将remoteIP 替换成 remoteIPAddress。\n已经找编译更新文章了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631177706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309080,"user_name":"l_time","can_delete":false,"product_type":"c1","uid":1049277,"ip_address":"","ucode":"ECAE412A9F99A6","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/bd/7431e82e.jpg","comment_is_top":false,"comment_ctime":1629937119,"is_pvip":false,"replies":[{"id":"112016","content":"cp $HOME&#47;.iam&#47;config $HOME&#47;.iam&#47;iamctl.yaml<br><br>master分支，后来有把iamctl的配置文件config重命名为iamctl.yaml了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1630112958,"ip_address":"","comment_id":309080,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1629937119","product_id":100079601,"comment_content":"iamctl version -o yaml运行出现告警<br>2021-08-26 08:03:25.277 WARN    server&#47;config.go:143    WARNING: viper failed to discover and load the configuration file: Config File &quot;iamctl&quot; Not Found in &quot;[&#47;home&#47;going&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam &#47;etc&#47;iam &#47;home&#47;going&#47;.iam]&quot;<br>clientVersion:<br>  buildDate: &quot;2021-08-25T10:54:14Z&quot;<br>  compiler: gc<br>  gitCommit: 77da1ed7fd6839e269fc225384b666693b83c06a<br>  gitTreeState: dirty<br>  gitVersion: 77da1ed<br>  goVersion: go1.16.2<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2021-08-25T13:39:34Z&quot;<br>  compiler: gc<br>  gitCommit: 77da1ed7fd6839e269fc225384b666693b83c06a<br>  gitTreeState: dirty<br>  gitVersion: 77da1ed<br>  goVersion: go1.16.2<br>  platform: linux&#47;amd64<br>是什么原因","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525736,"discussion_content":"cp $HOME/.iam/config $HOME/.iam/iamctl.yaml\n\nmaster分支，后来有把iamctl的配置文件config重命名为iamctl.yaml了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630112958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307814,"user_name":"蜗gua牛","can_delete":false,"product_type":"c1","uid":2527692,"ip_address":"","ucode":"6A382FA87269DF","user_header":"https://static001.geekbang.org/account/avatar/00/26/91/cc/ea929b3d.jpg","comment_is_top":false,"comment_ctime":1629267551,"is_pvip":false,"replies":[{"id":"112028","content":"把bind参数改成0.0.0.0吧","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1630113413,"ip_address":"","comment_id":307814,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1629267551","product_id":100079601,"comment_content":"redis安装好后返现是127.0.0.1:6379根本没法远程链接","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525300,"discussion_content":"把bind参数改成0.0.0.0吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630113413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":307061,"user_name":"陈麒文","can_delete":false,"product_type":"c1","uid":2187256,"ip_address":"","ucode":"41475885FA5AD5","user_header":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","comment_is_top":false,"comment_ctime":1628844734,"is_pvip":false,"replies":[{"id":"111392","content":"哈哈，自动手动安装，这个过程也是学习，而且学习效率最好。发现问题 -&gt;研究问题 -&gt; 解决问题，这个过程学习效果最好。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1629243229,"ip_address":"","comment_id":307061,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628844734","product_id":100079601,"comment_content":"彩蛋来的太迟了，门头苦干好久了","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525033,"discussion_content":"哈哈，自动手动安装，这个过程也是学习，而且学习效率最好。发现问题 -&amp;gt;研究问题 -&amp;gt; 解决问题，这个过程学习效果最好。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629243229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306883,"user_name":"Nio","can_delete":false,"product_type":"c1","uid":1529642,"ip_address":"","ucode":"A1B8D3C01FB937","user_header":"https://static001.geekbang.org/account/avatar/00/17/57/2a/c6c95f37.jpg","comment_is_top":false,"comment_ctime":1628761512,"is_pvip":true,"replies":[{"id":"111399","content":"Mac可以运行的","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1629243544,"ip_address":"","comment_id":306883,"utype":1}],"discussion_count":1,"race_medal":4,"score":"1628761512","product_id":100079601,"comment_content":"Mac能运行服务吗？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524960,"discussion_content":"Mac可以运行的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629243544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306577,"user_name":"yandongxiao","can_delete":false,"product_type":"c1","uid":1017700,"ip_address":"","ucode":"D397F4DB0109C8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/87/64/3882d90d.jpg","comment_is_top":false,"comment_ctime":1628611959,"is_pvip":false,"replies":[{"id":"111041","content":"老哥学到，凌晨12点，太优秀了！！","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628654604,"ip_address":"","comment_id":306577,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628611959","product_id":100079601,"comment_content":"一遍过，文档很不错","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524817,"discussion_content":"老哥学到，凌晨12点，太优秀了！！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628654604,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306449,"user_name":"陈麒文","can_delete":false,"product_type":"c1","uid":2187256,"ip_address":"","ucode":"41475885FA5AD5","user_header":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","comment_is_top":false,"comment_ctime":1628566175,"is_pvip":false,"replies":[{"id":"110953","content":"有群的，我拉你进去哈～","user_name":"编辑回复","user_name_real":"杨静","uid":"2562791","ctime":1628579622,"ip_address":"","comment_id":306449,"utype":2}],"discussion_count":6,"race_medal":0,"score":"1628566175","product_id":100079601,"comment_content":"环境安装太复杂了，各种问题，昨天扛到今天都还没解决，是不是提供个技术交流群啊，跟着实践都一脸懵哈","like_count":0,"discussions":[{"author":{"id":2562791,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/MaygtS9JLKOhljn4Vaic7twtCYq0p4EJqia7BB1nCiaZKXAricom9cdeEQHtgTOEBD0WpMJ5IoGI1nzYqpDsEsjsJQ/132","nickname":"🐑 🐑 得意","note":"","ucode":"9BF26FA42C3B61","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524770,"discussion_content":"有群的，我拉你进去哈～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628579622,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":1,"child_discussions":[{"author":{"id":2831170,"avatar":"","nickname":"Geek_8de965","note":"","ucode":"75880FD1790C37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2562791,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/MaygtS9JLKOhljn4Vaic7twtCYq0p4EJqia7BB1nCiaZKXAricom9cdeEQHtgTOEBD0WpMJ5IoGI1nzYqpDsEsjsJQ/132","nickname":"🐑 🐑 得意","note":"","ucode":"9BF26FA42C3B61","race_medal":0,"user_type":8,"is_pvip":false},"discussion":{"id":577095,"discussion_content":"拉下群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655912219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":524770,"ip_address":""},"score":577095,"extra":""}]},{"author":{"id":1744063,"avatar":"","nickname":"allen","note":"","ucode":"EEFA5AB2F945EC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":563825,"discussion_content":"有群的话，麻烦拉我一下，谢谢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650086344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1684811,"avatar":"","nickname":"杨帅","note":"","ucode":"0A558B1BA62E44","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":542966,"discussion_content":"需要加群，求老师拉","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640917447,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2282358,"avatar":"https://static001.geekbang.org/account/avatar/00/22/d3/76/5d0c15b7.jpg","nickname":"xiao","note":"","ucode":"D00D6823DB240C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394575,"discussion_content":"老师也拉我进去下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631944461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1529642,"avatar":"https://static001.geekbang.org/account/avatar/00/17/57/2a/c6c95f37.jpg","nickname":"Nio","note":"","ucode":"A1B8D3C01FB937","race_medal":4,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388432,"discussion_content":"太复杂了，需要加群，搞了半天没研究明白","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628761431,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306399,"user_name":"lianyz","can_delete":false,"product_type":"c1","uid":1330879,"ip_address":"","ucode":"A2536B49AEC4DD","user_header":"https://static001.geekbang.org/account/avatar/00/14/4e/bf/0f0754aa.jpg","comment_is_top":false,"comment_ctime":1628524731,"is_pvip":true,"replies":[{"id":"111440","content":"看下是不是密钥名已经存在了，换个名字试试","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1629251803,"ip_address":"","comment_id":306399,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628524731","product_id":100079601,"comment_content":"老师，在测试iam-authz-server的创建密钥的接口时，返回错误{&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;}是什么原因呢？<br><br>curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2Mjg2MTAwMzQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2Mjg1MjM2MzQsInN1YiI6ImFkbWluIn0.Z5g7fgqxdG7TgPydqOsPzwWbcuewBne54Z8zuASQmRc&#39; -d&#39;{&quot;metadata&quot;:{&quot;name&quot;:&quot;authztest&quot;},&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;secrets","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524747,"discussion_content":"看下是不是密钥名已经存在了，换个名字试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629251803,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306395,"user_name":"lianyz","can_delete":false,"product_type":"c1","uid":1330879,"ip_address":"","ucode":"A2536B49AEC4DD","user_header":"https://static001.geekbang.org/account/avatar/00/14/4e/bf/0f0754aa.jpg","comment_is_top":false,"comment_ctime":1628523563,"is_pvip":true,"replies":[{"id":"111441","content":"重新生成并安装下iam-authz-server的证书","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1629251824,"ip_address":"","comment_id":306395,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628523563","product_id":100079601,"comment_content":"iam-authz-server运行成功了，查看日志发现缺少iam-authz-server.pem文件","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524744,"discussion_content":"重新生成并安装下iam-authz-server的证书","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629251824,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306387,"user_name":"lianyz","can_delete":false,"product_type":"c1","uid":1330879,"ip_address":"","ucode":"A2536B49AEC4DD","user_header":"https://static001.geekbang.org/account/avatar/00/14/4e/bf/0f0754aa.jpg","comment_is_top":false,"comment_ctime":1628521996,"is_pvip":true,"replies":[{"id":"111442","content":"要看下日志","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1629251837,"ip_address":"","comment_id":306387,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628521996","product_id":100079601,"comment_content":"老师好，在查看iam-authz-server的运行状态时，显示启动失败（如下），是什么原因呢？<br><br>$ systemctl status iam-authz-server<br>● iam-authz-server.service - IAM AuthzServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-authz-server.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Mon 2021-08-09 23:12:08 CST; 3s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 161046 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-authz-server --config=&#47;etc&#47;iam&#47;iam-authz-server.yaml (code=exited, status=1&#47;FAILURE)<br>  Process: 161044 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 161043 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-authz-server (code=exited, status=0&#47;SUCCESS)<br> Main PID: 161046 (code=exited, status=1&#47;FAILURE)","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524741,"discussion_content":"要看下日志","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629251837,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306381,"user_name":"lianyz","can_delete":false,"product_type":"c1","uid":1330879,"ip_address":"","ucode":"A2536B49AEC4DD","user_header":"https://static001.geekbang.org/account/avatar/00/14/4e/bf/0f0754aa.jpg","comment_is_top":false,"comment_ctime":1628520939,"is_pvip":true,"replies":[{"id":"111443","content":"接口报错了，看下报啥错","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1629251851,"ip_address":"","comment_id":306381,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628520939","product_id":100079601,"comment_content":"老师好，在执行测试资源授权是否通过的接口&#47;v1&#47;authz时，返回的结果为空，什么原因呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524737,"discussion_content":"接口报错了，看下报啥错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629251851,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306341,"user_name":"陈麒文","can_delete":false,"product_type":"c1","uid":2187256,"ip_address":"","ucode":"41475885FA5AD5","user_header":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","comment_is_top":false,"comment_ctime":1628503303,"is_pvip":false,"replies":[{"id":"110891","content":"用的什么系统，mysql安装成功了没","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628524397,"ip_address":"","comment_id":306341,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1628503303","product_id":100079601,"comment_content":"[going@dev iam]$ mysql -h127.0.0.1 -uroot -p&#39;iam59!z$&#39;<br>bash: &#47;usr&#47;bin&#47;mysql: 没有那个文件或目录<br>[going@dev iam]$ ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524725,"discussion_content":"用的什么系统，mysql安装成功了没","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628524397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2187256,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","nickname":"陈麒文","note":"","ucode":"41475885FA5AD5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388035,"discussion_content":"virtualbox 安装centos8,安装mysql一直成功不了，卸了再装还是不行，试了好几次了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628565944,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306339,"user_name":"陈麒文","can_delete":false,"product_type":"c1","uid":2187256,"ip_address":"","ucode":"41475885FA5AD5","user_header":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","comment_is_top":false,"comment_ctime":1628502856,"is_pvip":false,"replies":[{"id":"110892","content":"At least 2MB more space needed on the &#47; filesystem.<br><br><br>硬盘空间不够了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628524473,"ip_address":"","comment_id":306339,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1628502856","product_id":100079601,"comment_content":"执行：.&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::install<br>报错：<br>Total                                                                                                                          12 MB&#47;s |  55 MB     00:04     <br>Running transaction check<br>Transaction check succeeded.<br>Running transaction test<br>The downloaded packages were saved in cache until the next successful transaction.<br>You can remove cached packages by executing &#39;yum clean packages&#39;.<br>Error: Transaction test error:<br>  installing package MariaDB-server-10.5.12-1.el8.x86_64 needs 2MB on the &#47; filesystem<br><br>Error Summary<br>-------------<br>Disk Requirements:<br>   At least 2MB more space needed on the &#47; filesystem.<br><br>!!! [0809 05:53:35] Call tree:<br>!!! [0809 05:53:35]  1: .&#47;scripts&#47;install&#47;mariadb.sh:36 iam::common::sudo(...)<br>!!! [0809 05:53:35]  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23<br>  Error in .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23. &#39;((i&lt;4-1))&#39; exited with status 0 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;..&#47;..&#47;scripts&#47;install&#47;common.sh:23 iam::common::sudo(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:36 iam::mariadb::install(...)<br>  3: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)<br>Exiting with status 1","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524724,"discussion_content":"At least 2MB more space needed on the / filesystem.\n\n\n硬盘空间不够了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628524473,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2187256,"avatar":"https://static001.geekbang.org/account/avatar/00/21/5f/f8/1d16434b.jpg","nickname":"陈麒文","note":"","ucode":"41475885FA5AD5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388036,"discussion_content":"虚拟机里设置的不是自动扩容么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628565992,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306092,"user_name":"Geek_0315ca","can_delete":false,"product_type":"c1","uid":1810532,"ip_address":"","ucode":"675254A9FC25A8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKVAVOYIoohh3bCdgErne0VHtoPorcrtmOAR45rsWPmJsLkzlvqMulbRyv0Skj8JHajrA9bPia3Lxw/132","comment_is_top":false,"comment_ctime":1628345100,"is_pvip":false,"replies":[{"id":"110900","content":"http:&#47;&#47;tool.chinaz.com&#47;Tools&#47;unixtime.aspx  这个将时间转换成unix时间戳，例如：<br><br>2022&#47;1&#47;1 01:01:01 -&gt; 1640970061","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628524811,"ip_address":"","comment_id":306092,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628345100","product_id":100079601,"comment_content":"[going@dev iam]$ iamctl secret list<br>NAME        SECRETID                               SECRETKEY                          EXPIRES               CREATED<br>authztest  YGxtEyfqZw9ArAxfxGBLugatMPVgQkEU9Yjw  vJU6pW6PXIaY2pHbmefXlV3M1XcfCujU  2001-09-09 09:46:39  2021-08-07 22:02:42<br><br>这个密钥的 &quot;expires&quot;字段怎么才能超过2021年？<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524624,"discussion_content":"http://tool.chinaz.com/Tools/unixtime.aspx  这个将时间转换成unix时间戳，例如：\n\n2022/1/1 01:01:01 -&amp;gt; 1640970061","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628524811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305962,"user_name":"Fan","can_delete":false,"product_type":"c1","uid":1115232,"ip_address":"","ucode":"3BF28670FD9407","user_header":"https://static001.geekbang.org/account/avatar/00/11/04/60/64d166b6.jpg","comment_is_top":false,"comment_ctime":1628245395,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628245395","product_id":100079601,"comment_content":"&lt;token&gt; 那个太长了。😂<br># 创建用户<br>$ curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer &lt;token&gt;&#39; -d&#39;{&quot;password&quot;:&quot;User@2021&quot;,&quot;metadata&quot;:{&quot;name&quot;:&quot;colin&quot;},&quot;nickname&quot;:&quot;colin&quot;,&quot;email&quot;:&quot;colin@foxmail.com&quot;,&quot;phone&quot;:&quot;1812884xxxx&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users<br><br># 列出用户<br>$ curl -s -XGET -H&#39;Authorization: Bearer &lt;token&gt;&#39; &#39;http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users?offset=0&amp;limit=10&#39;<br><br># 获取 colin 用户的详细信息<br>$ curl -s -XGET -H&#39;Authorization: Bearer &lt;token&gt;&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users&#47;colin<br><br># 修改 colin 用户<br>$ curl -s -XPUT -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer &lt;token&gt;&#39; -d&#39;{&quot;nickname&quot;:&quot;colin&quot;,&quot;email&quot;:&quot;colin_modified@foxmail.com&quot;,&quot;phone&quot;:&quot;1812884xxxx&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users&#47;colin<br><br># 删除 colin 用户<br>$ curl -s -XDELETE -H&#39;Authorization: Bearer &lt;token&gt;&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users&#47;colin<br><br># 批量删除用户<br>$ curl -s -XDELETE -H&#39;Authorization: Bearer &lt;token&gt;&#39; &#39;http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users?name=colin&amp;name=mark&amp;name=john&#39;","like_count":0},{"had_liked":false,"id":305613,"user_name":"forever_ele","can_delete":false,"product_type":"c1","uid":2725464,"ip_address":"","ucode":"CBC4ADD1763607","user_header":"https://static001.geekbang.org/account/avatar/00/29/96/58/b91503e7.jpg","comment_is_top":false,"comment_ctime":1628070277,"is_pvip":false,"replies":[{"id":"110631","content":"可能是策略重名了，改个名字重新创建下","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628165345,"ip_address":"","comment_id":305613,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1628070277","product_id":100079601,"comment_content":"iam-authz-server 创建策略返回：{&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;} 请问可能是哪里的问题呢","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524450,"discussion_content":"可能是策略重名了，改个名字重新创建下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628165345,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305418,"user_name":"wfatec","can_delete":false,"product_type":"c1","uid":1300686,"ip_address":"","ucode":"AB86F73A12E59C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoeNMibYsgHBsbhIwf9YR4Shy6psfqiblneVHA5CYrBRoqJwkw1ZUbVAPRGAfFfWjia7MZlDZzddeE2w/132","comment_is_top":false,"comment_ctime":1627964178,"is_pvip":false,"replies":[{"id":"110637","content":"报错信息太少了，你可以再深入debug下。或者用centos8试试","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628165618,"ip_address":"","comment_id":305418,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627964178","product_id":100079601,"comment_content":"系统 debian9，证书生成环节执行和结果如下:<br>$ cfssl gencert -initca ca-csr.json | cfssljson -bare self-ca<br>2021&#47;08&#47;03 12:13:17 [INFO] generating a new CA key and certificate from CSR<br>2021&#47;08&#47;03 12:13:17 [INFO] generate received request<br>2021&#47;08&#47;03 12:13:17 [INFO] received CSR<br>2021&#47;08&#47;03 12:13:17 [INFO] generating key: rsa-2048<br>2021&#47;08&#47;03 12:13:18 [INFO] encoded CSR<br>2021&#47;08&#47;03 12:13:18 [INFO] signed certificate with serial number 462238734347076885131071835789698801107977470718<br>————————————————————————————<br>然后就结束了，没有抛出任何错误，ca-pem等文件也没有生成，请问这个可能是什么原因呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524380,"discussion_content":"报错信息太少了，你可以再深入debug下。或者用centos8试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628165618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305209,"user_name":"欧雄虎(Badguy）","can_delete":false,"product_type":"c1","uid":1573307,"ip_address":"","ucode":"D72B1CC455AA56","user_header":"https://static001.geekbang.org/account/avatar/00/18/01/bb/7d15d44a.jpg","comment_is_top":false,"comment_ctime":1627877270,"is_pvip":true,"replies":[{"id":"110653","content":"看下策略名是否重名了，换个策略名字试试","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1628166214,"ip_address":"","comment_id":305209,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1627877270","product_id":100079601,"comment_content":"老师，在测试 iam-authz-server 是否成功安装<br><br>命令报错{&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;}<br>http状态码500：HTTP&#47;1.1 500 Internal Server Error<br><br>我排查了数据库的服务是正常的（可以正常连接和创建表和库），请教一下这个还有啥排错思路吗？<br>[going@dev iam]$ curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2Mjc5NTk2OTUsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2Mjc4NzMyOTUsInN1YiI6ImFkbWluIn0.plQpBBfW-9s-STzkb7eKXAxsCm0-m0RsNJD1Xjq0oSA&#39; -d&#39;{&quot;metadata&quot;:{&quot;name&quot;:&quot;authztest&quot;},&quot;policy&quot;:{&quot;description&quot;:&quot;One policy to rule them all.&quot;,&quot;subjects&quot;:[&quot;users:&lt;peter|ken&gt;&quot;,&quot;users:maria&quot;,&quot;groups:admins&quot;],&quot;actions&quot;:[&quot;delete&quot;,&quot;&lt;create|update&gt;&quot;],&quot;effect&quot;:&quot;allow&quot;,&quot;resources&quot;:[&quot;resources:articles:&lt;.*&gt;&quot;,&quot;resources:printer&quot;],&quot;conditions&quot;:{&quot;remoteIP&quot;:{&quot;type&quot;:&quot;CIDRCondition&quot;,&quot;options&quot;:{&quot;cidr&quot;:&quot;192.168.0.1&#47;16&quot;}}}}}&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;policies<br>{&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;}<br><br>[going@dev iam]$ curl -svo &#47;dev&#47;null  -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2Mjc5NTk2OTUsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQi<br><br><br><br><br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524317,"discussion_content":"看下策略名是否重名了，换个策略名字试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628166214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2725464,"avatar":"https://static001.geekbang.org/account/avatar/00/29/96/58/b91503e7.jpg","nickname":"forever_ele","note":"","ucode":"CBC4ADD1763607","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":387260,"discussion_content":"同样问题+1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628075308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305036,"user_name":"⁶₆⁶₆⁶₆","can_delete":false,"product_type":"c1","uid":1940453,"ip_address":"","ucode":"25AE3F77318541","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9b/e5/bd0be5c3.jpg","comment_is_top":false,"comment_ctime":1627786040,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1627786040","product_id":100079601,"comment_content":"一键安装看着挺强大的，可是我是Ubuntu的，不能直接使用，还得修改修改","like_count":0},{"had_liked":false,"id":304367,"user_name":"Geek_d10dae","can_delete":false,"product_type":"c1","uid":2647731,"ip_address":"","ucode":"7575A486F84628","user_header":"","comment_is_top":false,"comment_ctime":1627373510,"is_pvip":false,"replies":[{"id":"110216","content":"sorry，这个是程序Bug，已经修复了。可以再pull下代码。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627597669,"ip_address":"","comment_id":304367,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1627373510","product_id":100079601,"comment_content":"curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -d&#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;Admin@2021&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;login | jq -r .token<br>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2Mjc0NTkzNTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MjczNzI5NTQsInN1YiI6ImFkbWluIn0.GIM9y-gnTlZMfF9FOfFfOahi-36Mi7J3NElVgpOmBys<br>以上获取TOKEN成功，然后获取用户失败。命令如下：<br>curl -s -XGET -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2Mjc0NTkzNTQsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MjczNzI5NTQsInN1YiI6ImFkbWluIn0.GIM9y-gnTlZMfF9FOfFfOahi-36Mi7J3NElVgpOmBys&#39; &#39;http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users?offset=0&amp;limit=10&#39;<br>{&quot;code&quot;:100207,&quot;message&quot;:&quot;Permission denied&quot;}<br> &#47;var&#47;log&#47;iam&#47;iam-apiserver.log显示：<br>2021-07-27 16:02:34.677 INFO    apiserver       gorm@v1.21.12&#47;callbacks.go:133  [mysql&#47;user.go:76][2.005ms] [rows:1] SELECT * FROM `user` WHERE name = &#39;admin&#39; ORDER BY `user`.`id` LIMIT 1<br>2021-07-27 16:02:34.808 INFO    apiserver       middleware&#47;logger.go:135        200 - [127.0.0.1] &quot;133.539358ms POST &#47;login&quot;    {&quot;requestID&quot;: &quot;6413ae95-44f6-4aa2-88a6-219d4fe1e6ed&quot;, &quot;username&quot;: &quot;&quot;}<br>2021-07-27 16:03:09.420 INFO    apiserver       gorm@v1.21.12&#47;callbacks.go:133  mysql&#47;user.go:76 record not found[1.989ms] [rows:0] SELECT * FROM `user` WHERE name = &#39;&#39; ORDER BY `user`.`id` LIMIT 1<br>2021-07-27 16:03:09.420 INFO    apiserver       middleware&#47;logger.go:135        403 - [127.0.0.1] &quot;2.946674ms GET &#47;v1&#47;users?offset=0&amp;limit=10&quot;  {&quot;requestID&quot;: &quot;a0c96847-8a88-4997-adb5-7094e579289d&quot;, &quot;username&quot;: &quot;&quot;}<br>看了留言有遇见同样问题的朋友，请问老师，这个问题怎么解决呢，望老师抽空指导一下，谢谢！","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524024,"discussion_content":"sorry，这个是程序Bug，已经修复了。可以再pull下代码。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627597669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2641288,"avatar":"https://static001.geekbang.org/account/avatar/00/28/4d/88/43707555.jpg","nickname":"Ricardo","note":"","ucode":"B129D4590DB2CD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386310,"discussion_content":"我也遇到相同的问题了，还没解决呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627523421,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304148,"user_name":"噼里啪啦啪啦噼里噼里啪啦","can_delete":false,"product_type":"c1","uid":1109143,"ip_address":"","ucode":"2A4B86D38F7E11","user_header":"https://static001.geekbang.org/account/avatar/00/10/ec/97/58e7bc9a.jpg","comment_is_top":false,"comment_ctime":1627273630,"is_pvip":false,"replies":[{"id":"110142","content":"会影响的，建议直接复用。改下mysql和redis的用户名和密码为你当前使用的就可以了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627382199,"ip_address":"","comment_id":304148,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627273630","product_id":100079601,"comment_content":"老师你好，我是在我个人的阿里云上部署go以及IAM环境。阿里云个人已经使用很长时间了，已经安装了MYSQL和Redis。请问使用课程里的命令重新安装mariDB和Redis会影响原来的数据库吗？如果有影响，我可以还使用mysql和Redis，会影响后续的学习吗？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523950,"discussion_content":"会影响的，建议直接复用。改下mysql和redis的用户名和密码为你当前使用的就可以了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627382199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304077,"user_name":"蜗gua牛","can_delete":false,"product_type":"c1","uid":2527692,"ip_address":"","ucode":"6A382FA87269DF","user_header":"https://static001.geekbang.org/account/avatar/00/26/91/cc/ea929b3d.jpg","comment_is_top":false,"comment_ctime":1627222770,"is_pvip":false,"replies":[{"id":"110140","content":"systemctl start mariadb","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627382024,"ip_address":"","comment_id":304077,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1627222770","product_id":100079601,"comment_content":"老师，我的centos已经安装了mysql了，在安装mariadb后怎么启动mariadb呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523924,"discussion_content":"systemctl start mariadb","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627382024,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303983,"user_name":"豆浆油条","can_delete":false,"product_type":"c1","uid":1378413,"ip_address":"","ucode":"466635EE57AA6E","user_header":"","comment_is_top":false,"comment_ctime":1627142149,"is_pvip":false,"replies":[{"id":"110034","content":"这里具体要看下iam-apiserver的日志。这个错误可能是因为创建的密钥名字重复了，可以换个密钥名再试试","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627256369,"ip_address":"","comment_id":303983,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627142149","product_id":100079601,"comment_content":"在测试iam-apiserver的时候，通过curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -d&#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;Admin@2021&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;login | jq -r .token<br>是可以获取到token的，但是把token放在下面的<br>curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer <br>之后创建用户就会失败{&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;}<br>请问要怎么处理","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523894,"discussion_content":"这里具体要看下iam-apiserver的日志。这个错误可能是因为创建的密钥名字重复了，可以换个密钥名再试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627256369,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303936,"user_name":"Jdjf","can_delete":false,"product_type":"c1","uid":2323137,"ip_address":"","ucode":"B899227B8D9CE5","user_header":"https://static001.geekbang.org/account/avatar/00/23/72/c1/49dfb810.jpg","comment_is_top":false,"comment_ctime":1627109194,"is_pvip":false,"replies":[{"id":"110036","content":"什么系统，没遇到过这个问题。可以google下有没有相关问题的解决方法。<br><br>试试yum install --skip-broken 或者yum install --nobest","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627256648,"ip_address":"","comment_id":303936,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627109194","product_id":100079601,"comment_content":"MariaDB                                                                                                          658  B&#47;s | 3.4 kB     00:05    <br>Error: <br> Problem: cannot install the best candidate for the job<br>  - nothing provides rsync needed by MariaDB-server-10.5.11-1.el8.x86_64<br>(try to add &#39;--skip-broken&#39; to skip uninstallable packages or &#39;--nobest&#39; to use not only best candidate packages)<br><br>请问，这个怎么解决？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523880,"discussion_content":"什么系统，没遇到过这个问题。可以google下有没有相关问题的解决方法。\n\n试试yum install --skip-broken 或者yum install --nobest","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627256648,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303901,"user_name":"Terence孫","can_delete":false,"product_type":"c1","uid":1157674,"ip_address":"","ucode":"8C3A89C18A2182","user_header":"https://static001.geekbang.org/account/avatar/00/11/aa/2a/ce7c487d.jpg","comment_is_top":false,"comment_ctime":1627062833,"is_pvip":false,"replies":[{"id":"110038","content":"不是的哈，只有admin用户才能拉取所有用户的列表。但每个用户都可以使用POST注册用户。上面的逻辑其实是：允许所有用户注册用户，只允许admin用户获取用户列表","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627256819,"ip_address":"","comment_id":303901,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1627062833","product_id":100079601,"comment_content":"老师，这个接口中，路由是&#47;v1&#47;users<br># 列出用户<br>$ curl -s -XGET -H&#39;Authorization: Bearer &lt;Token&gt;&#39; &#39;http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users?offset=0&amp;limit=10&#39;<br><br>代码在鉴权的时候<br>&#47;&#47; 文件&#47;internal&#47;pkg&#47;middleware&#47;user_validation.go<br>&#47;&#47; 第20到46行<br>func Validation() gin.HandlerFunc {<br>\treturn func(c *gin.Context) {<br>\t\tif err := isAdmin(c); err != nil {<br>\t\t\tswitch c.FullPath() {<br>\t\t\tcase &quot;&#47;v1&#47;users&quot;:<br>\t\t\t\tif c.Request.Method != http.MethodPost {<br>\t\t\t\t\tcore.WriteResponse(c, errors.WithCode(code.ErrPermissionDenied, &quot;&quot;), nil)<br>\t\t\t\t\tc.Abort()<br><br>\t\t\t\t\treturn<br>\t\t\t\t}<br>\t\t\tcase &quot;&#47;v1&#47;users&#47;:name&quot;, &quot;&#47;v1&#47;users&#47;:name&#47;change_password&quot;:<br>\t\t\t\tusername := c.GetString(&quot;username&quot;)<br>\t\t\t\tif c.Request.Method == http.MethodDelete ||<br>\t\t\t\t\t(c.Request.Method != http.MethodDelete &amp;&amp; username != c.Param(&quot;name&quot;)) {<br>\t\t\t\t\tcore.WriteResponse(c, errors.WithCode(code.ErrPermissionDenied, &quot;&quot;), nil)<br>\t\t\t\t\tc.Abort()<br><br>\t\t\t\t\treturn<br>\t\t\t\t}<br>\t\t\tdefault:<br>\t\t\t}<br>\t\t}<br><br>\t\tc.Next()<br>\t}<br>}<br><br>其中我用admin登录获取的jwt，这里判断会进入到<br>case &quot;&#47;v1&#47;users&quot;:<br>\t\t\t\tif c.Request.Method != http.MethodPost {<br>\t\t\t\t\tcore.WriteResponse(c, errors.WithCode(code.ErrPermissionDenied, &quot;&quot;), nil)<br>\t\t\t\t\tc.Abort()<br><br>\t\t\t\t\treturn<br>\t\t\t\t}<br><br>同时，因为我curl使用的是GET方法，这里就会判断为非POST方法，于是返回403<br><br>还请老师看下是不是bug","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523871,"discussion_content":"不是的哈，只有admin用户才能拉取所有用户的列表。但每个用户都可以使用POST注册用户。上面的逻辑其实是：允许所有用户注册用户，只允许admin用户获取用户列表","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627256819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303860,"user_name":"ᶫᵒᵛᵉᵧₒᵤ 💕","can_delete":false,"product_type":"c1","uid":2139102,"ip_address":"","ucode":"2AA574239D010F","user_header":"https://static001.geekbang.org/account/avatar/00/20/a3/de/e05ee31d.jpg","comment_is_top":false,"comment_ctime":1627031780,"is_pvip":false,"replies":[{"id":"110230","content":"加大服务器带宽，或者本地浏览器下载好后，上传到服务器上。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627599073,"ip_address":"","comment_id":303860,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1627031780","product_id":100079601,"comment_content":"安装cfssl的时候下载很慢怎么解决？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523848,"discussion_content":"加大服务器带宽，或者本地浏览器下载好后，上传到服务器上。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627599073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1157674,"avatar":"https://static001.geekbang.org/account/avatar/00/11/aa/2a/ce7c487d.jpg","nickname":"Terence孫","note":"","ucode":"8C3A89C18A2182","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385522,"discussion_content":"我是慢慢等的QAQ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627111686,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303744,"user_name":"DogDong","can_delete":false,"product_type":"c1","uid":1486993,"ip_address":"","ucode":"BE2B69B81F2F19","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/yzDxbtf2qp9r392ykR1xMrzBUQwhgAt3UgDDYucoh2gJ3ax6yWLTcsd7Nty6OfAiabhd4k6GUTDDARHC1xYj6iaA/132","comment_is_top":false,"comment_ctime":1626958000,"is_pvip":false,"replies":[{"id":"110231","content":"是个bug，已经修复了，可以重新pull下代码。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627599993,"ip_address":"","comment_id":303744,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1626958000","product_id":100079601,"comment_content":".&#47;scripts&#47;update-generated-docs.sh<br>make: Entering directory &#39;&#47;home&#47;boyu&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam&#39;<br>===========&gt; Building binary gendocs abdbc50 for linux amd64<br>===========&gt; Building binary geniamdocs abdbc50 for linux amd64<br>===========&gt; Building binary genman abdbc50 for linux amd64<br>===========&gt; Building binary genyaml abdbc50 for linux amd64<br>make: Leaving directory &#39;&#47;home&#47;boyu&#47;workspace&#47;golang&#47;src&#47;github.com&#47;marmotedu&#47;iam&#39;<br>panic: unable to redefine &#39;v&#39; shorthand in &quot;verify&quot; flagset: it&#39;s already used for &quot;debug&quot; flag","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523806,"discussion_content":"是个bug，已经修复了，可以重新pull下代码。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627599993,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1157674,"avatar":"https://static001.geekbang.org/account/avatar/00/11/aa/2a/ce7c487d.jpg","nickname":"Terence孫","note":"","ucode":"8C3A89C18A2182","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385523,"discussion_content":"我也遇到这个情况。。。想知道解决办法QAQ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627111714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303495,"user_name":"Geek_857795","can_delete":false,"product_type":"c1","uid":2684775,"ip_address":"","ucode":"F8E606D9F53F51","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/0bexhQ6hllTrjTP7myzica4HCJkkW0duKtBQgmibZa351MGeDyy5H2HDoBPhwTlufhMCJy54nqNWibXkkyq36JOdQ/132","comment_is_top":false,"comment_ctime":1626832065,"is_pvip":false,"replies":[{"id":"109850","content":"机器访问不了pkg.cfssl.org，可以手动下载安装","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626839389,"ip_address":"","comment_id":303495,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626832065","product_id":100079601,"comment_content":"安装cfssl时候出错<br>.&#47;scripts&#47;install&#47;install.sh iam::install::install_cfssl<br>--2021-07-21 09:44:16--  https:&#47;&#47;pkg.cfssl.org&#47;R1.2&#47;cfssl_linux-amd64<br>Resolving pkg.cfssl.org (pkg.cfssl.org)... 104.18.23.229, 104.18.22.229, 2606:4700::6812:17e5, ...<br>Connecting to pkg.cfssl.org (pkg.cfssl.org)|104.18.23.229|:443... connected.<br>GnuTLS: Error in the pull function.<br>Unable to establish SSL connection.<br>!!! [0721 09:44:16] Call tree:<br>!!! [0721 09:44:16]  1: .&#47;scripts&#47;install&#47;install.sh:387 iam::install::install_cfssl(...)<br>!!! Error in .&#47;scripts&#47;install&#47;install.sh:285<br>  Error in .&#47;scripts&#47;install&#47;install.sh:285. &#39;((i&lt;3-1))&#39; exited with status 4<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;install.sh:285 iam::install::install_cfssl(...)<br>  2: .&#47;scripts&#47;install&#47;install.sh:387 main(...)<br>Exiting with status 1","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523706,"discussion_content":"机器访问不了pkg.cfssl.org，可以手动下载安装","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626839389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303463,"user_name":"scorpio","can_delete":false,"product_type":"c1","uid":1265510,"ip_address":"","ucode":"183AA132ECBB27","user_header":"https://static001.geekbang.org/account/avatar/00/13/4f/66/88acb1cc.jpg","comment_is_top":false,"comment_ctime":1626801297,"is_pvip":false,"replies":[{"id":"109984","content":"是不是token过期了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627031347,"ip_address":"","comment_id":303463,"utype":1}],"discussion_count":5,"race_medal":0,"score":"1626801297","product_id":100079601,"comment_content":"----------------------------------------<br>拿到Token后，访问资源接口提示权限不足：<br>----------------------------------------<br>[going@dev iam]$ curl -s -XGET -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MjY4ODY3MjUsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MjY4MDAzMjUsInN1YiI6ImFkbWluIn0.EyhOFKI3QoGKLl4LJVpFYiY12kCSr6QiicHPpK2SEuM&#39; &#39;http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users?offset=0&amp;limit=10&#39;<br>{&quot;code&quot;:100207,&quot;message&quot;:&quot;Permission denied&quot;}<br>----------------------------------------<br>日志 &#47;var&#47;log&#47;iam&#47;iam-apiserver.log：<br>----------------------------------------<br>2021-07-21 01:11:26.954 INFO    apiserver       gorm@v1.21.12&#47;callbacks.go:133  mysql&#47;user.go:76 record not found[1.650ms] [rows:0] SELECT * FROM `user` WHERE name = &#39;&#39; ORDER BY `user`.`id` LIMIT 1<br>2021-07-21 01:11:26.955 INFO    apiserver       middleware&#47;logger.go:135        403 - [127.0.0.1] &quot;2.426295ms GET &#47;v1&#47;users?offset=0&amp;limit=10&quot;  {&quot;requestID&quot;: &quot;04c3d781-e8ca-42fb-b39f-08f7e2d46096&quot;, &quot;username&quot;: &quot;&quot;}<br><br>----------------------------------------<br>日志中 username 为空，不清楚是不是生成的 jwt 有问题？<br>----------------------------------------","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523690,"discussion_content":"是不是token过期了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627031347,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2139102,"avatar":"https://static001.geekbang.org/account/avatar/00/20/a3/de/e05ee31d.jpg","nickname":"ᶫᵒᵛᵉᵧₒᵤ 💕","note":"","ucode":"2AA574239D010F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385846,"discussion_content":"有解决吗，好像token没作用一样，创建curl创建用户token那随便更改都能执行，其它操作就是permission denied","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1627298252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1109143,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ec/97/58e7bc9a.jpg","nickname":"噼里啪啦啪啦噼里噼里啪啦","note":"","ucode":"2A4B86D38F7E11","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385952,"discussion_content":"请问这个解决了吗？调了好几天都没成功","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627359043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2647731,"avatar":"","nickname":"Geek_d10dae","note":"","ucode":"7575A486F84628","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385800,"discussion_content":"我也遇到了同样的问题，请问怎么解决的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627281487,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1265510,"avatar":"https://static001.geekbang.org/account/avatar/00/13/4f/66/88acb1cc.jpg","nickname":"scorpio","note":"","ucode":"183AA132ECBB27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385431,"discussion_content":"不会，我刚调用登录接口拿到的token","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627035986,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303448,"user_name":"Geek_015c6c","can_delete":false,"product_type":"c1","uid":2683582,"ip_address":"","ucode":"FE7CC0B2602F6F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM7VzUqZsiaLkF04rljsnXdj5xmibDBeyU27A637PSfDsiczArAic8760GHRIw113OE79nV01NJn66UEWg/132","comment_is_top":false,"comment_ctime":1626792203,"is_pvip":false,"replies":[{"id":"109986","content":"看下是不是cfssl、cfssljson工具没可执行权限呢","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1627031401,"ip_address":"","comment_id":303448,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626792203","product_id":100079601,"comment_content":"创建 CA 证书和私钥中，cfssl gencert -initca ca-csr.json | cfssljson -bare ca执行后返回Permission denied，请问怎么处理呢？<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523681,"discussion_content":"看下是不是cfssl、cfssljson工具没可执行权限呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627031401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303102,"user_name":"Geek_b52974","can_delete":false,"product_type":"c1","uid":1298252,"ip_address":"","ucode":"59884399646620","user_header":"","comment_is_top":false,"comment_ctime":1626592078,"is_pvip":true,"replies":[{"id":"109752","content":"感谢老哥分享！","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626684752,"ip_address":"","comment_id":303102,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626592078","product_id":100079601,"comment_content":"在 AWS 上用 Amazon Linux 2 os 的话只要改一下 mariadb mongodb redis 的安装方法一样也可以跑的起来<br>P.S. 建议文章里的长长的 token 换成 $TOKEN 变数文章会比较好读<br><br>```<br>$ iamctl version -o yaml<br>clientVersion:<br>  buildDate: &quot;2021-07-18T06:31:30Z&quot;<br>  compiler: gc<br>  gitCommit: 210a49c6f6d2df13c4d4dff52ba787acbb51fc99<br>  gitTreeState: dirty<br>  gitVersion: 210a49c<br>  goVersion: go1.15.12<br>  platform: linux&#47;amd64<br>serverVersion:<br>  buildDate: &quot;2021-07-18T06:19:54Z&quot;<br>  compiler: gc<br>  gitCommit: 210a49c6f6d2df13c4d4dff52ba787acbb51fc99<br>  gitTreeState: dirty<br>  gitVersion: 210a49c<br>  goVersion: go1.15.12<br>  platform: linux&#47;amd64<br>```","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523552,"discussion_content":"感谢老哥分享！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626684752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303026,"user_name":"Geek_785c56","can_delete":false,"product_type":"c1","uid":2699659,"ip_address":"","ucode":"DA0688B229ACC6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKWcNxgTWLRePZhJesADwfia8MKuBQqHuzia6bWEHUBhR79wXkDLNEUcic6UjoqFPTvHVSgkSxhUqgkw/132","comment_is_top":false,"comment_ctime":1626522832,"is_pvip":false,"replies":[{"id":"109740","content":"要用sudo启动哈，或者直接切换到root用户，执行：<br><br>systemctl start mongod.service","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626683205,"ip_address":"","comment_id":303026,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626522832","product_id":100079601,"comment_content":"[going@dev iam]$ systemctl start mongod.service<br>Failed to start mongod.service: The name org.freedesktop.PolicyKit1 was not provided by any .service files<br>See system logs and &#39;systemctl status mongod.service&#39; for details.<br><br>请问怎么不能启动mongodb","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523519,"discussion_content":"要用sudo启动哈，或者直接切换到root用户，执行：\n\nsystemctl start mongod.service","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626683205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":303025,"user_name":"Geek_785c56","can_delete":false,"product_type":"c1","uid":2699659,"ip_address":"","ucode":"DA0688B229ACC6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKWcNxgTWLRePZhJesADwfia8MKuBQqHuzia6bWEHUBhR79wXkDLNEUcic6UjoqFPTvHVSgkSxhUqgkw/132","comment_is_top":false,"comment_ctime":1626522546,"is_pvip":false,"replies":[{"id":"109741","content":"用的哪个系统，看样子系统没有安装selinux相关的工具和服务。建议使用centos8","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626683244,"ip_address":"","comment_id":303025,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626522546","product_id":100079601,"comment_content":"一键安装，到最后提示这个，请问如何修复？<br><br>Complete!<br>sudo: setenforce: command not found<br>sed: can&#39;t read &#47;etc&#47;selinux&#47;config: No such file or directory<br><br>Job for mongod.service failed because a timeout was exceeded.<br>See &quot;systemctl status mongod.service&quot; and &quot;journalctl -xe&quot; for details.<br>Error: couldn&#39;t connect to server 127.0.0.1:27017, connection attempt failed: SocketException: Error connecting to 127.0.0.1:27017 :: caused by :: Connection refused :<br>connect@src&#47;mongo&#47;shell&#47;mongo.js:374:17<br>@(connect):3:6<br>exception: connect failed<br>exiting with code 1<br>Error: couldn&#39;t connect to server 127.0.0.1:27017, connection attempt failed: SocketException: Error connecting to 127.0.0.1:27017 :: caused by :: Connection refused :<br>connect@src&#47;mongo&#47;shell&#47;mongo.js:374:17<br>@(connect):3:6<br>exception: connect failed<br>exiting with code 1<br>!!! [0717 11:44:39] mongodb failed to start, maybe not installed properly<br>!!! Error in .&#47;scripts&#47;install&#47;install.sh:387<br>  Error in .&#47;scripts&#47;install&#47;install.sh:387. &#39;return 1&#39; exited with status 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;install.sh:387 main(...)<br>Exiting with status 1","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523518,"discussion_content":"用的哪个系统，看样子系统没有安装selinux相关的工具和服务。建议使用centos8","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626683244,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302778,"user_name":"Geek_72141d","can_delete":false,"product_type":"c1","uid":2608731,"ip_address":"","ucode":"9573E68C340CCD","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epJo44GuuyRFNiaicEbXBpqu1WqLFQ4wj7pernCWibYD2CQyBlqUs0oF9xlFibACdoEmSJp7Ips1xDkiaw/132","comment_is_top":false,"comment_ctime":1626360284,"is_pvip":false,"replies":[{"id":"109746","content":"看下是不是iam-apiserver的配置文件iam-apiserver.yaml中的output-paths配置的有问题？如果是，可以更正下，再重启下。<br><br>可以更正成：&#47;var&#47;log&#47;iam-apiserver.log,stdout","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626683811,"ip_address":"","comment_id":302778,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626360284","product_id":100079601,"comment_content":"启动IAM-SERVER失败是什么原因？<br>● iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Thu 2021-07-15 22:44:26 CST; 2s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 70273 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=203&#47;EXEC)<br>  Process: 70271 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 70270 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 70273 (code=exited, status=203&#47;EXEC)","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523420,"discussion_content":"看下是不是iam-apiserver的配置文件iam-apiserver.yaml中的output-paths配置的有问题？如果是，可以更正下，再重启下。\n\n可以更正成：/var/log/iam-apiserver.log,stdout","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626683811,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302604,"user_name":"小蚂蚁","can_delete":false,"product_type":"c1","uid":2459100,"ip_address":"","ucode":"6B60BB03BB08DA","user_header":"https://static001.geekbang.org/account/avatar/00/25/85/dc/f18b4658.jpg","comment_is_top":false,"comment_ctime":1626277558,"is_pvip":false,"replies":[{"id":"109750","content":"看下&#47;etc&#47;iam&#47;iam-apiserver.yaml中的第77行，output-paths配置项是否正确，如果不正确，可以配置成这样：<br>output-paths: &#47;var&#47;log&#47;iam-apiserver.log,stdout","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626684650,"ip_address":"","comment_id":302604,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626277558","product_id":100079601,"comment_content":"启动iam-apiserver的时候报错，执行，systemctl status iam-apiserver查看<br>● iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Wed 2021-07-14 23:44:22 CST; 3s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 51286 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=1&#47;FAILURE)<br>  Process: 51284 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 51283 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 51286 (code=exited, status=1&#47;FAILURE)<br><br>详细报错如下：<br>localhost iam-apiserver[51124]: Error: failed to read configuration file(&#47;etc&#47;iam&#47;iam-apiserver.yaml): While parsing config: yaml: line 77: did not find expected key<br><br>要怎么解决啊？<br><br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523361,"discussion_content":"看下/etc/iam/iam-apiserver.yaml中的第77行，output-paths配置项是否正确，如果不正确，可以配置成这样：\noutput-paths: /var/log/iam-apiserver.log,stdout","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626684650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302541,"user_name":"Geek_da7878","can_delete":false,"product_type":"c1","uid":2692914,"ip_address":"","ucode":"EFA75FBA4B3237","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKB2930aZlw6wbiaP7dqAuJE6Isj8J1ST9rHYDfRzLbDK92yiaLXwz1O4gvWqJoErQzYdic6W1wggZibw/132","comment_is_top":false,"comment_ctime":1626254576,"is_pvip":false,"replies":[{"id":"109486","content":"接口报错了，没有返回正确的信息。把 &quot;|jq -r .token&quot; 去掉，看下接口返回什么报错。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626280173,"ip_address":"","comment_id":302541,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626254576","product_id":100079601,"comment_content":"curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -d&#39;{&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;Admin@2021&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;login | jq -r .token<br>老师 访问 iam-apiserver 的 Token没有返回值,会是什么情况","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523344,"discussion_content":"接口报错了，没有返回正确的信息。把 &amp;quot;|jq -r .token&amp;quot; 去掉，看下接口返回什么报错。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626280173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302062,"user_name":"你赖东东不错嘛","can_delete":false,"product_type":"c1","uid":2426387,"ip_address":"","ucode":"3B11CA3BD80F3E","user_header":"https://static001.geekbang.org/account/avatar/00/25/06/13/e4f9f79b.jpg","comment_is_top":false,"comment_ctime":1626059703,"is_pvip":false,"replies":[{"id":"109497","content":"要重新执行下以下命令，在生成配置文件:<br>$ source scripts&#47;install&#47;environment.sh","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626280950,"ip_address":"","comment_id":302062,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1626059703","product_id":100079601,"comment_content":"命令行生成后的配置文件 iam-apiserver.yaml 第78行的{IAM_LOG_DIR}环境变量没有被正确替换为对应的值导致服务无法启动。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523164,"discussion_content":"要重新执行下以下命令，在生成配置文件:\n$ source scripts/install/environment.sh","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626280950,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301996,"user_name":"后视镜","can_delete":false,"product_type":"c1","uid":1250406,"ip_address":"","ucode":"0975031017BA02","user_header":"https://static001.geekbang.org/account/avatar/00/13/14/66/70a6a206.jpg","comment_is_top":false,"comment_ctime":1626012957,"is_pvip":false,"replies":[{"id":"109500","content":"这个配置项可能没配置对，注释掉没影响的。不过，最好可以纠正过来。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626281038,"ip_address":"","comment_id":301996,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1626012957","product_id":100079601,"comment_content":"执行  ${IAM_INSTALL_DIR}&#47;bin&#47;iam-apiserver --config=${IAM_CONFIG_DIR}&#47;iam-apiserver.yaml<br>Error: failed to read configuration file(&#47;etc&#47;iam&#47;iam-apiserver.yaml): While parsing config: yaml: line 77: did not find expected key<br><br>最后注释了 &#47;etc&#47;iam&#47;iam-apiserver.yaml的error-output-paths才跑起来，不知道有没有影响：<br>output-paths: &#47;var&#47;log&#47;iam&#47;iam-apiserver.log,stdout # 支持输出到多个输出，逗号分开。支持输出到标准输出（stdout）和文件。<br>    #error-output-paths: {IAM_LOG_DIR}&#47;iam-apiserver.error.log # zap内部(非业务)错误日志输出路径，多个输出，逗号分开","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523147,"discussion_content":"这个配置项可能没配置对，注释掉没影响的。不过，最好可以纠正过来。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626281038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2354116,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/AFCV3m6dk64EONfK6EnmgMibjQ1kscAiapiaTTme7v8SCShYypkR88aYXkkspD4VcOgsThQiampevxGqzjqDn0ECUQ/132","nickname":"Bit_haonan","note":"","ucode":"8BD7B10DB9434E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383361,"discussion_content":"log:\n 70   ┊ name: apiserver # Logger的名字\n 71   ┊ development: true # 是否是开发模式。如果是开发模式，会对DPanicLevel进行堆栈跟踪。\n 72   ┊ level: debug # 日志级别，优先级从低到高依次为：debug, info, warn, error, dpanic, panic, fatal。\n 73   ┊ format: console # 支持的日志输出格式，目前支持console和json两种。console其实就是text格式。\n 74   ┊ enable-color: true # 是否开启颜色输出，true:是，false:否\n 75   ┊ disable-caller: false # 是否开启 caller，如果开启会在日志中显示调用日志所在的文件、函数和行号\n 76   ┊ disable-stacktrace: false # 是否再panic及以上级别禁止打印堆栈信息\n 77   ┊ output-paths: /var/log/iam/iam-apiserver.log,stdout # 支持输出到多个输出，逗号分开。支持输出到标准输出（stdout）和文件。\n 78   ┊ error-output-paths: /var/log/iam/iam-apiserver.error.log # zap内部(非业务)错误日志输出路径，多个输出，逗号分开","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626068999,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2426387,"avatar":"https://static001.geekbang.org/account/avatar/00/25/06/13/e4f9f79b.jpg","nickname":"你赖东东不错嘛","note":"","ucode":"3B11CA3BD80F3E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383329,"discussion_content":" {IAM_LOG_DIR} 替换为 /var/log/iam 就可以了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626059544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301963,"user_name":"Geek_131c6c","can_delete":false,"product_type":"c1","uid":2346440,"ip_address":"","ucode":"D77E8FCDFEFF14","user_header":"","comment_is_top":false,"comment_ctime":1625999331,"is_pvip":false,"replies":[{"id":"109501","content":"要看下iam-apiserver的日志哈。<br><br>或者systemctl status iam-apiserver -l看下有啥报错没。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626281071,"ip_address":"","comment_id":301963,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1625999331","product_id":100079601,"comment_content":"iam-apiserver 启动失败<br>systemctl status iam-apiserver<br>● iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Sun 2021-07-11 18:26:09 CST; 2s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 84793 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=1&#47;FAILURE)<br>  Process: 84791 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 84790 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 84793 (code=exited, status=1&#47;FAILURE)<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523137,"discussion_content":"要看下iam-apiserver的日志哈。\n\n或者systemctl status iam-apiserver -l看下有啥报错没。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626281071,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2692914,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKB2930aZlw6wbiaP7dqAuJE6Isj8J1ST9rHYDfRzLbDK92yiaLXwz1O4gvWqJoErQzYdic6W1wggZibw/132","nickname":"Geek_da7878","note":"","ucode":"EFA75FBA4B3237","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383859,"discussion_content":"同学你的问题解决了吗  我也遇到了这个问题\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626256820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301948,"user_name":"Geek_131c6c","can_delete":false,"product_type":"c1","uid":2346440,"ip_address":"","ucode":"D77E8FCDFEFF14","user_header":"","comment_is_top":false,"comment_ctime":1625992732,"is_pvip":false,"replies":[{"id":"109502","content":"第一次编译吗？Go编译器在执行go get下载Go包，可能会比较慢","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1626281118,"ip_address":"","comment_id":301948,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625992732","product_id":100079601,"comment_content":"老师 执行如下命令 一直卡在那不动了？<br>make build BINS=iam-apiserver<br>===========&gt; Building binary iam-apiserver v1.0.4 for linux amd64","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523131,"discussion_content":"第一次编译吗？Go编译器在执行go get下载Go包，可能会比较慢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626281118,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301748,"user_name":"陶然然","can_delete":false,"product_type":"c1","uid":1344827,"ip_address":"","ucode":"43BB6784CC78DC","user_header":"https://static001.geekbang.org/account/avatar/00/14/85/3b/b80575ea.jpg","comment_is_top":false,"comment_ctime":1625834826,"is_pvip":false,"replies":[{"id":"109210","content":"是不是cfssljson、cfssl工具没有可执行权限呢，执行：<br>chmod +x cfssljson cfssl命令后再试试","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625849173,"ip_address":"","comment_id":301748,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625834826","product_id":100079601,"comment_content":"[going@dev iam]$ cfssl gencert -initca ca-csr.json | cfssljson -bare ca<br>bash: &#47;home&#47;going&#47;bin&#47;cfssljson: Permission denied<br>bash: &#47;home&#47;going&#47;bin&#47;cfssl: Permission denied<br>卡这了","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523079,"discussion_content":"是不是cfssljson、cfssl工具没有可执行权限呢，执行：\nchmod +x cfssljson cfssl命令后再试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625849173,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301352,"user_name":"噤声。","can_delete":false,"product_type":"c1","uid":2216441,"ip_address":"","ucode":"D5A02302877818","user_header":"https://static001.geekbang.org/account/avatar/00/21/d1/f9/0741407d.jpg","comment_is_top":false,"comment_ctime":1625642872,"is_pvip":false,"replies":[{"id":"109219","content":"没问题的，加密算法，相同字符串每次加密的字符串是不一样的。<br><br>bcrypt.CompareHashAndPassword这个函数可以正确对比加密后的字符串，里面有它的对比算法。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625850997,"ip_address":"","comment_id":301352,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625642872","product_id":100079601,"comment_content":"老师，我使用以下命令创建用户test，密码为Admin@2021：<br>curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MjU3MjY4NzAsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MjU2NDA0NzAsInN1YiI6ImFkbWluIn0.rgZPOGbrADAAnWQXXC8l-lqCKOO2SCvRevjQommEu7w&#39; -d&#39;{&quot;password&quot;:&quot;Admin@2021&quot;,&quot;metadata&quot;:{&quot;name&quot;:&quot;test&quot;},&quot;nickname&quot;:&quot;test&quot;,&quot;email&quot;:&quot;test@foxmail.com&quot;,&quot;phone&quot;:&quot;1812114xxxx&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;users<br><br>然后，去数据库里查看user表，发现和admin的字符串不一致：<br><br>MariaDB [iam]&gt; select name,password from user;<br>+----------+--------------------------------------------------------------+<br>| name     | password                                                     |<br>+----------+--------------------------------------------------------------+<br>| admin    | $2a$10$WnQD2DCfWVhlGmkQ8pdLkesIGPf9KJB7N1mhSOqulbgN7ZMo44Mv2 |<br>| xuezhang | $2a$10$WnQD2DCfWVhlGmkQ8pdLkesIGPf9KJB7N1mhSOqulbgN7ZMo44Mv2 |<br>| test     | $2a$10$YYleBwkP93ktfYsFsEjYNepFWvw0KkbnY1kal8jOl2CFTfuIf0wx. |<br>+----------+--------------------------------------------------------------+<br>3 rows in set (0.000 sec)<br><br>这个是我安装的有问题吗？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522975,"discussion_content":"没问题的，加密算法，相同字符串每次加密的字符串是不一样的。\n\nbcrypt.CompareHashAndPassword这个函数可以正确对比加密后的字符串，里面有它的对比算法。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625850997,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301180,"user_name":"张名哲","can_delete":false,"product_type":"c1","uid":1260121,"ip_address":"","ucode":"0476910BC2FE81","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/59/d0f326e7.jpg","comment_is_top":false,"comment_ctime":1625566594,"is_pvip":false,"replies":[{"id":"109224","content":"token过期了，可以重新生成下token。<br><br>iamctl jwt sign $secretId $secretKey","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625851427,"ip_address":"","comment_id":301180,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1625566594","product_id":100079601,"comment_content":"请问下老板 ，我在执行这一步的时候<br>第 3 步，测试 iam-authz-server 是否成功安装。创建授权策略。<br><br>每次都提醒我：{&quot;message&quot;:&quot;Token is expired&quot;} ，而且接下来的操作无一例外的全部操作错误，这是为啥","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522921,"discussion_content":"token过期了，可以重新生成下token。\n\niamctl jwt sign $secretId $secretKey","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625851427,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2655184,"avatar":"https://static001.geekbang.org/account/avatar/00/28/83/d0/86d4417a.jpg","nickname":"浅言浅笑","note":"","ucode":"796B44DDD3BCD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392651,"discussion_content":"已经解决，重新用 curl -s -XPOST -H&#39;Content-Type: application/json&#39; -d&#39;{&#34;username&#34;:&#34;admin&#34;,&#34;password&#34;:&#34;Admin@2021&#34;}&#39; http://127.0.0.1:8080/login | jq -r .token\n生成新的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631086149,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2655184,"avatar":"https://static001.geekbang.org/account/avatar/00/28/83/d0/86d4417a.jpg","nickname":"浅言浅笑","note":"","ucode":"796B44DDD3BCD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392646,"discussion_content":"同样的问题，执行iamctl jwt sign $secretId $secretKey  \nbash: iamctl: command not found...\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631085432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301062,"user_name":"等星星睡着","can_delete":false,"product_type":"c1","uid":2082744,"ip_address":"","ucode":"F889DEADE89C14","user_header":"https://static001.geekbang.org/account/avatar/00/1f/c7/b8/810a663b.jpg","comment_is_top":false,"comment_ctime":1625499384,"is_pvip":false,"replies":[{"id":"109227","content":"先确认下ca.pem是否存在，如果存在执行下vim看是否能打开ca.pem。<br><br>如果ca.pem不存在，要看下为什么生成ca.pem失败，可能跟环境有关，可能哪一步没有执行成功。<br><br>如果没法打开ca.pem，要看下为啥没有权限了。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625851678,"ip_address":"","comment_id":301062,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1625499384","product_id":100079601,"comment_content":"老师，执行以下命令，会出现错误，无法生成.pem 文件，问题是出在那里呢？<br>[going@dev iam]$cfssl gencert -initca ca-csr.json | cfssljson -bare ca<br>2021&#47;07&#47;05 23:29:00 [INFO] generating a new CA key and certificate from CSR<br>2021&#47;07&#47;05 23:29:00 [INFO] generate received request<br>2021&#47;07&#47;05 23:29:00 [INFO] received CSR<br>2021&#47;07&#47;05 23:29:00 [INFO] generating key: rsa-2048<br>2021&#47;07&#47;05 23:29:01 [INFO] encoded CSR<br>2021&#47;07&#47;05 23:29:01 [INFO] signed certificate with serial number 300040014568982289538465172258411970746271102381<br>open ca.pem: permission denied<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522886,"discussion_content":"先确认下ca.pem是否存在，如果存在执行下vim看是否能打开ca.pem。\n\n如果ca.pem不存在，要看下为什么生成ca.pem失败，可能跟环境有关，可能哪一步没有执行成功。\n\n如果没法打开ca.pem，要看下为啥没有权限了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625851678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1368775,"avatar":"https://static001.geekbang.org/account/avatar/00/14/e2/c7/3e1d396e.jpg","nickname":"oneWalker","note":"","ucode":"0FC573E3243760","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382986,"discussion_content":"前面要加上sudo 你这个是登陆用户没有管理员权限引起的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625816284,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300835,"user_name":"我来也","can_delete":false,"product_type":"c1","uid":1205253,"ip_address":"","ucode":"773D6104F56767","user_header":"https://static001.geekbang.org/account/avatar/00/12/64/05/6989dce6.jpg","comment_is_top":false,"comment_ctime":1625399071,"is_pvip":false,"replies":[{"id":"108977","content":"感谢推荐~","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625440220,"ip_address":"","comment_id":300835,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625399071","product_id":100079601,"comment_content":"建议小伙伴们也试试使用docker部署基础的数据库服务。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522829,"discussion_content":"感谢推荐~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625440220,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300384,"user_name":"Geek_399957","can_delete":false,"product_type":"c1","uid":2676396,"ip_address":"","ucode":"A121DE94B6EC6E","user_header":"","comment_is_top":false,"comment_ctime":1625133675,"is_pvip":false,"replies":[{"id":"108961","content":"兼容的","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625389341,"ip_address":"","comment_id":300384,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625133675","product_id":100079601,"comment_content":"我想问下用Mysql是否兼容呢","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522722,"discussion_content":"兼容的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625389341,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300217,"user_name":"Geek_c9a012","can_delete":false,"product_type":"c1","uid":1315231,"ip_address":"","ucode":"839BD7B5D348E7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJPZN07CicHGCjkv5FuD013mpLxHN3y78UZA8FhvYkuNyqzqyA7A2XxxkUC1ax3V2JfdfJWWZgkVmg/132","comment_is_top":false,"comment_ctime":1625049172,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1625049172","product_id":100079601,"comment_content":"把yum改成apt在ubutnu下安装就没问题了","like_count":0},{"had_liked":false,"id":300097,"user_name":"Scorpio","can_delete":false,"product_type":"c1","uid":2645215,"ip_address":"","ucode":"6E86A843D772D7","user_header":"https://static001.geekbang.org/account/avatar/00/28/5c/df/127669f6.jpg","comment_is_top":false,"comment_ctime":1624983575,"is_pvip":false,"replies":[{"id":"108951","content":"systemctl cat iam-apiserver看下。<br><br>systemctl报文件不存在，说明确实找不到，要看下systemctl是去哪个目录下找unit文件。<br><br>或者systemctl cat sshd，看下ssd所在的目录。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1625388428,"ip_address":"","comment_id":300097,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624983575","product_id":100079601,"comment_content":"$sudo systemctl enable iam-apiserver<br>Failed to enable unit: Unit file iam-apiserver.service does not exist.<br>启动服务提示这个错误是因为什么，如何解决？<br>&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service 存在<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522642,"discussion_content":"systemctl cat iam-apiserver看下。\n\nsystemctl报文件不存在，说明确实找不到，要看下systemctl是去哪个目录下找unit文件。\n\n或者systemctl cat sshd，看下ssd所在的目录。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625388428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299798,"user_name":"Geek_d167a6","can_delete":false,"product_type":"c1","uid":2660981,"ip_address":"","ucode":"DEA888212AA044","user_header":"","comment_is_top":false,"comment_ctime":1624864153,"is_pvip":false,"replies":[{"id":"108755","content":"重新生成下unit文件","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624930080,"ip_address":"","comment_id":299798,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624864153","product_id":100079601,"comment_content":"使用命令$ systemt1 enable iam-apiserver 时报错：<br>Filed to enable unit：Unit file iam-apisercver.service does notexits.","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522545,"discussion_content":"重新生成下unit文件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624930080,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299705,"user_name":"Geek_d167a6","can_delete":false,"product_type":"c1","uid":2660981,"ip_address":"","ucode":"DEA888212AA044","user_header":"","comment_is_top":false,"comment_ctime":1624806226,"is_pvip":false,"replies":[{"id":"108714","content":"看下configs&#47;iam.sql文件","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624847065,"ip_address":"","comment_id":299705,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624806226","product_id":100079601,"comment_content":"有没有数据库那段建表的代码，就是user，等等，数据库小白还请照顾<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522510,"discussion_content":"看下configs/iam.sql文件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624847065,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299417,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1624617444,"is_pvip":false,"replies":[{"id":"108624","content":"感谢反馈，代码已修改，文章稍后更新","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624707420,"ip_address":"","comment_id":299417,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624617444","product_id":100079601,"comment_content":"&quot;names&quot;: [ { &quot;C&quot;: &quot;CN&quot;, &quot;ST&quot;: &quot;BeiJing&quot;, &quot;L&quot;: &quot;BeiJing&quot;, &quot;O&quot;: &quot;iam&quot;, &quot;OU&quot;: &quot;marmotedu&quot; } ]<br><br>每个csr文件中的如上部分, 按照正常的逻辑O应该是marmotedu, OU应该是iam, 这样更符合层级逻辑吧","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522436,"discussion_content":"感谢反馈，代码已修改，文章稍后更新","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624707420,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299120,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1624464775,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624464775","product_id":100079601,"comment_content":"“上述命令会创建运行 CA 所必需的文件 ca-key.pem（私钥）和 ca.pem（证书），还会生成 ca.csr（证书签名请求），用于交叉签名或重新签名。”，还是不太理解ca.csr文件的作用，能否详细说明下原理呢","like_count":0},{"had_liked":false,"id":299097,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1624456350,"is_pvip":false,"replies":[{"id":"108647","content":"根据需要，选择，没有统一标准。可以设置为1年、20年等，可以支持自动续签。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624710680,"ip_address":"","comment_id":299097,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624456350","product_id":100079601,"comment_content":"“expiry：876000h，证书有效期设置为 100 年”，对于实际生产项目，证书的有效期一般设置成几年呢？如果更新证书的话，有什么便捷的方式吗","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522325,"discussion_content":"根据需要，选择，没有统一标准。可以设置为1年、20年等，可以支持自动续签。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624710680,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":299095,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1624455630,"is_pvip":false,"replies":[{"id":"108640","content":"方便，减少学习成本。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624709872,"ip_address":"","comment_id":299095,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624455630","product_id":100079601,"comment_content":"为什么测试访问的url都是http，而不是https呢，不是安装证书了嘛","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522324,"discussion_content":"方便，减少学习成本。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624709872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298925,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1624376415,"is_pvip":false,"replies":[{"id":"108646","content":"感谢反馈，github.com&#47;marmotedu&#47;errors包错误信息已更改","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624710639,"ip_address":"","comment_id":298925,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624376415","product_id":100079601,"comment_content":"{<br>  &quot;code&quot;: 1,<br>  &quot;message&quot;: &quot;An internal server occurred&quot;,<br>  &quot;reference&quot;: &quot;http:&#47;&#47;github.com&#47;marmotedu&#47;errors&#47;README.md&quot;<br>}<br><br>http:&#47;&#47;github.com&#47;marmotedu&#47;errors&#47;README.md 这个url 404;<br><br>另外这个 An internal server occurred 错误信息, 是不是少了一个单词, 应该是: An internal server error occurred ?","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522278,"discussion_content":"感谢反馈，github.com/marmotedu/errors包错误信息已更改","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624710639,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298589,"user_name":"lesserror","can_delete":false,"product_type":"c1","uid":1351076,"ip_address":"","ucode":"25A54D1165FCF6","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","comment_is_top":false,"comment_ctime":1624205999,"is_pvip":false,"replies":[{"id":"108355","content":"老哥真是辛苦了!","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624286420,"ip_address":"","comment_id":298589,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624205999","product_id":100079601,"comment_content":"设备是MacBook Pro（m1），发这个评论的时候，除了最后的man1安装文件出了问题，其它的基本正常吧......","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522178,"discussion_content":"老哥真是辛苦了!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624286420,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298507,"user_name":"冷月","can_delete":false,"product_type":"c1","uid":1141769,"ip_address":"","ucode":"31CC5A412C504D","user_header":"https://static001.geekbang.org/account/avatar/00/11/6c/09/1aca109b.jpg","comment_is_top":false,"comment_ctime":1624160995,"is_pvip":false,"replies":[{"id":"108303","content":"要看下具体日志","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624181847,"ip_address":"","comment_id":298507,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1624160995","product_id":100079601,"comment_content":"iam-apiserver启动失败呢，不知道什么原因<br>$ systemctl status iam-apiserver<br>● iam-apiserver.service - IAM APIServer<br>   Loaded: loaded (&#47;etc&#47;systemd&#47;system&#47;iam-apiserver.service; enabled; vendor preset: disabled)<br>   Active: activating (auto-restart) (Result: exit-code) since Sun 2021-06-20 11:23:46 CST; 4s ago<br>     Docs: https:&#47;&#47;github.com&#47;marmotedu&#47;iam&#47;blob&#47;master&#47;init&#47;README.md<br>  Process: 5066 ExecStart=&#47;opt&#47;iam&#47;bin&#47;iam-apiserver --config=&#47;etc&#47;iam&#47;iam-apiserver.yaml (code=exited, status=1&#47;FAILURE)<br>  Process: 5064 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;var&#47;log&#47;iam (code=exited, status=0&#47;SUCCESS)<br>  Process: 5063 ExecStartPre=&#47;usr&#47;bin&#47;mkdir -p &#47;data&#47;iam&#47;iam-apiserver (code=exited, status=0&#47;SUCCESS)<br> Main PID: 5066 (code=exited, status=1&#47;FAILURE)","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522162,"discussion_content":"要看下具体日志","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624181847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2676876,"avatar":"https://static001.geekbang.org/account/avatar/00/28/d8/8c/40f4a375.jpg","nickname":"loook","note":"","ucode":"67B5D4CEF65CC6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381424,"discussion_content":"我也遇见了这个问题，不知道什么原因，用这个方法解决了：\n1. 删除 _output 目录\n2. 重新安装可执行程序\n3. 最后重启服务","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625047862,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298383,"user_name":"撒旦","can_delete":false,"product_type":"c1","uid":1089889,"ip_address":"","ucode":"A69AE694358EDC","user_header":"https://static001.geekbang.org/account/avatar/00/10/a1/61/1734383f.jpg","comment_is_top":false,"comment_ctime":1624071295,"is_pvip":false,"replies":[{"id":"108314","content":"看下接口报什么错误，如果还有问题，可以加我微信。","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624209191,"ip_address":"","comment_id":298383,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624071295","product_id":100079601,"comment_content":"创建密钥，并从代码的输出中提取 secretID 和 secretKey。  它什么也没输出，是空的。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522120,"discussion_content":"看下接口报什么错误，如果还有问题，可以加我微信。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624209191,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298372,"user_name":"撒旦","can_delete":false,"product_type":"c1","uid":1089889,"ip_address":"","ucode":"A69AE694358EDC","user_header":"https://static001.geekbang.org/account/avatar/00/10/a1/61/1734383f.jpg","comment_is_top":false,"comment_ctime":1624067083,"is_pvip":false,"replies":[{"id":"108315","content":"是不是没有执行：sudo mv ca* ${IAM_CONFIG_DIR}&#47;cert","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624209309,"ip_address":"","comment_id":298372,"utype":1}],"discussion_count":4,"race_medal":0,"score":"1624067083","product_id":100079601,"comment_content":"执行生成证书和秘钥的时候出现打不开这个文件的情况，我怀疑是不是它把整个路径全部当成文件了<br>[going@dev ~]$cfssl gencert -ca=~&#47;iam&#47;etc&#47;iam&#47;cert&#47;ca.pem \\ -ca-key=~&#47;iam&#47;etc&#47;iam&#47;cert&#47;ca-key.pem \\ -config=~&#47;iam&#47;etc&#47;iam&#47;cert&#47;ca-config.json \\ -profile=iam iam-apiserver-csr.json | cfssljson -bare iam-apiserver<br>open  -ca-key=~&#47;iam&#47;etc&#47;iam&#47;cert&#47;ca-key.pem: no such file or directory<br>Failed to parse input: unexpected end of JSON input","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522117,"discussion_content":"是不是没有执行：sudo mv ca* ${IAM_CONFIG_DIR}/cert","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624209309,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1519230,"avatar":"https://static001.geekbang.org/account/avatar/00/17/2e/7e/acc47ee1.jpg","nickname":"OUO","note":"","ucode":"52EEB72E80BAF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579612,"discussion_content":"cfssl gencert -ca=${IAM_CONFIG_DIR}/cert/ca.pem -ca-key=${IAM_CONFIG_DIR}/cert/ca-key.pem -config=${IAM_CONFIG_DIR}/cert/ca-config.json -profile=iam iam-apiserver-csr.json | cfssljson -bare iam-apiserver","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657572901,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1105595,"avatar":"https://static001.geekbang.org/account/avatar/00/10/de/bb/e73c6367.jpg","nickname":"无节操抠脚大汉","note":"","ucode":"B0BE13E028E5B2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382163,"discussion_content":"兄弟 我也碰到了这个问题 请问你是如何解决的 sudo mv ca* ${IAM_CONFIG_DIR}/cert 已经执行过了 文件也存在。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625454829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1519230,"avatar":"https://static001.geekbang.org/account/avatar/00/17/2e/7e/acc47ee1.jpg","nickname":"OUO","note":"","ucode":"52EEB72E80BAF8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1105595,"avatar":"https://static001.geekbang.org/account/avatar/00/10/de/bb/e73c6367.jpg","nickname":"无节操抠脚大汉","note":"","ucode":"B0BE13E028E5B2","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579613,"discussion_content":"cfssl gencert -ca=${IAM_CONFIG_DIR}/cert/ca.pem -ca-key=${IAM_CONFIG_DIR}/cert/ca-key.pem -config=${IAM_CONFIG_DIR}/cert/ca-config.json -profile=iam iam-apiserver-csr.json | cfssljson -bare iam-apiserver","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657572909,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":382163,"ip_address":""},"score":579613,"extra":""}]}]},{"had_liked":false,"id":298320,"user_name":"stopper","can_delete":false,"product_type":"c1","uid":1231840,"ip_address":"","ucode":"A049638521D6DF","user_header":"https://static001.geekbang.org/account/avatar/00/12/cb/e0/30b70102.jpg","comment_is_top":false,"comment_ctime":1624015245,"is_pvip":false,"replies":[{"id":"108297","content":"本地硬盘空间不够了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624181609,"ip_address":"","comment_id":298320,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1624015245","product_id":100079601,"comment_content":"执行make build BINS=iam-apiserver报错了 这个咋解决<br>===========&gt; Building binary iam-apiserver 2dac43a for linux amd64<br>-&gt; unzip &#47;home&#47;vagrant&#47;workspace&#47;golang&#47;pkg&#47;mod&#47;cache&#47;download&#47;google.golang.org&#47;genproto&#47;@v&#47;v0.0.0-20200707001353-8e8330bf89df.zip: open &#47;home&#47;vagrant&#47;workspace&#47;golang&#47;pkg&#47;mod&#47;google.golang.org&#47;genproto@v0.0.0-20200707001353-8e8330bf89df&#47;googleapis&#47;ads&#47;googleads&#47;v1&#47;enums&#47;slot.pb.go: no space left on device<br>..&#47;..&#47;..&#47;..&#47;pkg&#47;mod&#47;google.golang.org&#47;grpc@v1.27.0&#47;status&#47;status.go:37:2: unzip &#47;home&#47;vagrant&#47;workspace&#47;golang&#47;pkg&#47;mod&#47;cache&#47;download&#47;google.golang.org&#47;genproto&#47;@v&#47;v0.0.0-20200707001353-8e8330bf89df.zip: open &#47;home&#47;vagrant&#47;workspace&#47;golang&#47;pkg&#47;mod&#47;google.golang.org&#47;genproto@v0.0.0-20200707001353-8e8330bf89df&#47;googleapis&#47;ads&#47;googleads&#47;v1&#47;enums&#47;slot.pb.go: no space left on device<br>make[1]: *** [scripts&#47;make-rules&#47;golang.mk:60: go.build.linux_amd64.iam-apiserver] Error 1<br>make: *** [Makefile:60: build] Error 2","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522095,"discussion_content":"本地硬盘空间不够了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624181609,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298314,"user_name":"管清麟","can_delete":false,"product_type":"c1","uid":1198013,"ip_address":"","ucode":"7CA1651D0DE257","user_header":"https://static001.geekbang.org/account/avatar/00/12/47/bd/5c34df95.jpg","comment_is_top":false,"comment_ctime":1624010584,"is_pvip":false,"replies":[{"id":"108296","content":"不太明白啥问题","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1624181580,"ip_address":"","comment_id":298314,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1624010584","product_id":100079601,"comment_content":"ima-authz-server服务器启动了没问题，为什么9090端口不起来？日志也正常没有error，端口因为没占用","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522092,"discussion_content":"不太明白啥问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624181580,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1198013,"avatar":"https://static001.geekbang.org/account/avatar/00/12/47/bd/5c34df95.jpg","nickname":"管清麟","note":"","ucode":"7CA1651D0DE257","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379615,"discussion_content":"就是起不来，看日志都是正常的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624013905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":298139,"user_name":"叫我去学习好么","can_delete":false,"product_type":"c1","uid":2074982,"ip_address":"","ucode":"C51B86D507E887","user_header":"https://static001.geekbang.org/account/avatar/00/1f/a9/66/2df6b3fe.jpg","comment_is_top":false,"comment_ctime":1623922105,"is_pvip":false,"replies":[{"id":"108221","content":"没问题的","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623993547,"ip_address":"","comment_id":298139,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623922105","product_id":100079601,"comment_content":"老师redis的脚本是不是有点问题？<br><br># 2.2 在`bind 127.0.0.1`前面添加 `#` 将其注释掉，默认情况下只允许本地连接，注释掉后外网可以连接Redis<br>  echo ${LINUX_PASSWORD} | sudo -S sed -i &#39;&#47;^# bind 127.0.0.1&#47;{s&#47;# &#47;&#47;}&#39; &#47;etc&#47;redis.conf","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522029,"discussion_content":"没问题的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623993547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297542,"user_name":"Richeir","can_delete":false,"product_type":"c1","uid":1005500,"ip_address":"","ucode":"1D58234F917724","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/bc/cd0761ff.jpg","comment_is_top":false,"comment_ctime":1623607683,"is_pvip":true,"replies":[{"id":"108122","content":"看下操作文档，是不是没生成iam-apiserver.pem","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623774227,"ip_address":"","comment_id":297542,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623607683","product_id":100079601,"comment_content":"老师，ima-apiserver 一直启动不了，看了日志，显示：<br>apiserver&#47;server.go:129 Failed to generate credentials open &#47;etc&#47;iam&#47;cert&#47;iam-apiserver.pem: no such file or directory","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521852,"discussion_content":"看下操作文档，是不是没生成iam-apiserver.pem","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623774227,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297540,"user_name":"Richeir","can_delete":false,"product_type":"c1","uid":1005500,"ip_address":"","ucode":"1D58234F917724","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/bc/cd0761ff.jpg","comment_is_top":false,"comment_ctime":1623606764,"is_pvip":true,"replies":[{"id":"108123","content":"要看下日志","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623774262,"ip_address":"","comment_id":297540,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623606764","product_id":100079601,"comment_content":"systemctl status iam-apiserver<br><br>卡在这个地方了，一直起不来","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521851,"discussion_content":"要看下日志","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623774262,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297539,"user_name":"Richeir","can_delete":false,"product_type":"c1","uid":1005500,"ip_address":"","ucode":"1D58234F917724","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/bc/cd0761ff.jpg","comment_is_top":false,"comment_ctime":1623605851,"is_pvip":true,"replies":[{"id":"108124","content":"要重新source scripts&#47;install&#47;environments.sh","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623774325,"ip_address":"","comment_id":297539,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623605851","product_id":100079601,"comment_content":"执行这个命令的时候报错：<br>sudo mv ca* ${IAM_CONFIG_DIR}&#47;cert<br><br>mv: target &#39;&#47;cert&#39; is not a directory<br><br>最后只能一个文件一个文件挪过去了","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521850,"discussion_content":"要重新source scripts/install/environments.sh","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623774325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297445,"user_name":"知鱼君","can_delete":false,"product_type":"c1","uid":1076719,"ip_address":"","ucode":"8B1958BEB5FB2C","user_header":"https://static001.geekbang.org/account/avatar/00/10/6d/ef/08132ab2.jpg","comment_is_top":false,"comment_ctime":1623555603,"is_pvip":false,"replies":[{"id":"108011","content":"可能是策略名重复了，可以换个策略名，再创建试试","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623582265,"ip_address":"","comment_id":297445,"utype":1}],"discussion_count":1,"race_medal":2,"score":"1623555603","product_id":100079601,"comment_content":"老师你好，在测试 iam-authz-server 是否成功安装那一步，创建授权策略，出现{&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;}这个报错，是什么原因呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521826,"discussion_content":"可能是策略名重复了，可以换个策略名，再创建试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297442,"user_name":"qiaocc","can_delete":false,"product_type":"c1","uid":1510656,"ip_address":"","ucode":"C8EAD84757D11C","user_header":"https://static001.geekbang.org/account/avatar/00/17/0d/00/d07ea760.jpg","comment_is_top":false,"comment_ctime":1623553315,"is_pvip":false,"replies":[{"id":"108012","content":"老哥加油，也能学学部署脚本怎么写哇","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623582302,"ip_address":"","comment_id":297442,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623553315","product_id":100079601,"comment_content":"这一节太劝退了，shell脚本太长了。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521824,"discussion_content":"老哥加油，也能学学部署脚本怎么写哇","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582302,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297317,"user_name":"Gregory","can_delete":false,"product_type":"c1","uid":1027448,"ip_address":"","ucode":"ED561E7CE3A334","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ad/78/7872b7b6.jpg","comment_is_top":false,"comment_ctime":1623428449,"is_pvip":false,"replies":[{"id":"108017","content":"看下密钥名是不是重了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623582842,"ip_address":"","comment_id":297317,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1623428449","product_id":100079601,"comment_content":"测试 iam-authz-server 是否成功安装,第二步 创建密钥，并从代码的输出中提取 secretID 和 secretKey。  database error<br><br>curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -H&#39;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MjM1MTE5MjAsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MjM0MjU1MjAsInN1YiI6ImFkbWluIn0.CZHL6dqt24tVQxRvTF3lccwKPQ7rdVN02Fv4JO6DWmQ&#39; -d&#39;{&quot;metadata&quot;:{&quot;name&quot;:&quot;authztest&quot;},&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;v1&#47;secrets<br><br>{&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;}","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521795,"discussion_content":"看下密钥名是不是重了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623582842,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1027448,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ad/78/7872b7b6.jpg","nickname":"Gregory","note":"","ucode":"ED561E7CE3A334","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379099,"discussion_content":"删了重新创建还是有问题，我再看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623682223,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297290,"user_name":"88duif","can_delete":false,"product_type":"c1","uid":1012018,"ip_address":"","ucode":"C332AEC6EF1984","user_header":"","comment_is_top":false,"comment_ctime":1623407875,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623407875","product_id":100079601,"comment_content":"iam&#47;internal&#47;authzserver&#47;analytics&#47;analytics.go:99 为什么要在start the analytics service. 里面 再stop analytics workers 因为我一直看不到mongodb有数据  查了半天找到这里有stop","like_count":0},{"had_liked":false,"id":297222,"user_name":"李云飞","can_delete":false,"product_type":"c1","uid":2641368,"ip_address":"","ucode":"02ACD40B2D189F","user_header":"https://static001.geekbang.org/account/avatar/00/28/4d/d8/72c4a037.jpg","comment_is_top":false,"comment_ctime":1623382717,"is_pvip":false,"replies":[{"id":"108233","content":"这个错误没有遇到过，现在问题解决了吗","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623994605,"ip_address":"","comment_id":297222,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623382717","product_id":100079601,"comment_content":"老师，最后一步启动 iam-pump没有成功<br>错误信息如下：<br>ERROR\tpumps&#47;mongo.go:411\tMongo connection failed. Retrying.\t{&quot;error&quot;: &quot;server returned error on SASL authentication step: BSON field &#39;saslContinue.mechanism&#39; is an unknown field.&quot;}<br>能否分析一下原因","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521764,"discussion_content":"这个错误没有遇到过，现在问题解决了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623994605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297122,"user_name":"低调","can_delete":false,"product_type":"c1","uid":1124982,"ip_address":"","ucode":"7D29B371BE9A46","user_header":"https://static001.geekbang.org/account/avatar/00/11/2a/76/36fdddb3.jpg","comment_is_top":false,"comment_ctime":1623318174,"is_pvip":true,"replies":[{"id":"107912","content":"是centos8吗，看起来缺少了很多基础库，可以根据提示安装下","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623321511,"ip_address":"","comment_id":297122,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1623318174","product_id":100079601,"comment_content":"安装mariaDB，一堆这玩意，查了半天也没解决。。。。。<br>Error: Package: MariaDB-server-10.5.10-1.el8.x86_64 (mariadb)<br>           Requires: libstdc++.so.6(GLIBCXX_3.4.21)(64bit)<br>Error: Package: galera-4-26.4.8-1.el8.x86_64 (mariadb)<br>           Requires: libboost_program_options.so.1.66.0()(64bit)<br>Error: Package: MariaDB-server-10.5.10-1.el8.x86_64 (mariadb)<br>           Requires: libcrypt.so.1(XCRYPT_2.0)(64bit)<br>......","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521725,"discussion_content":"是centos8吗，看起来缺少了很多基础库，可以根据提示安装下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623321511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1124982,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2a/76/36fdddb3.jpg","nickname":"低调","note":"","ucode":"7D29B371BE9A46","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378808,"discussion_content":"centos 7\nhttps://mariadb.com/kb/en/yum/\n执行了下这个，然后自己yum安装的有了，执行项目里的script还是不行\ncurl -sS https://downloads.mariadb.com/MariaDB/mariadb_repo_setup | sudo bash\n不管咋样，装上了哈哈😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623409633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297086,"user_name":"◑▂◐","can_delete":false,"product_type":"c1","uid":1338732,"ip_address":"","ucode":"42E6C1191FF63B","user_header":"https://static001.geekbang.org/account/avatar/00/14/6d/6c/81fa79a2.jpg","comment_is_top":false,"comment_ctime":1623304538,"is_pvip":false,"replies":[{"id":"107917","content":"看下为啥这个文件不存在，是不是操作不对，可以重新执行下安装步骤","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623326840,"ip_address":"","comment_id":297086,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623304538","product_id":100079601,"comment_content":"老师您好：启动 iam-apiserver 服务 启动失败 我查看了启动日志发现 又一个这样的错误 但是查看之前没有这个文件 请问可能是哪里出错了<br>apiserver&#47;server.go:129 Failed to generate credentials open &#47;etc&#47;iam&#47;cert&#47;iam-apiserver.pem: no such file or directory<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521712,"discussion_content":"看下为啥这个文件不存在，是不是操作不对，可以重新执行下安装步骤","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623326840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297066,"user_name":"杜子","can_delete":false,"product_type":"c1","uid":1045942,"ip_address":"","ucode":"DC9FA67EF7B490","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f5/b6/294dafbb.jpg","comment_is_top":false,"comment_ctime":1623296720,"is_pvip":true,"replies":[{"id":"107918","content":"生成token的命令是哪个","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623326873,"ip_address":"","comment_id":297066,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1623296720","product_id":100079601,"comment_content":"新生成的token，然后创建授权策略返回这个msg,{&quot;message&quot;:&quot;token contains an invalid number of segments&quot;},啥情况呢","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521707,"discussion_content":"生成token的命令是哪个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623326873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1496037,"avatar":"https://static001.geekbang.org/account/avatar/00/16/d3/e5/08dad30d.jpg","nickname":"Amber","note":"","ucode":"EDCB252D72D3D3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380906,"discussion_content":"我是把获取的token定义成变量了，然后报的这个错。把老师示例代码里-H后面的单引号换成双引号就行了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624786807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296987,"user_name":"噤声。","can_delete":false,"product_type":"c1","uid":2216441,"ip_address":"","ucode":"D5A02302877818","user_header":"https://static001.geekbang.org/account/avatar/00/21/d1/f9/0741407d.jpg","comment_is_top":false,"comment_ctime":1623250579,"is_pvip":false,"replies":[{"id":"107907","content":"调用 POST &#47;v1&#47;secrets接口，创建密钥对，之后调用iamctl jwt sign工具生成token","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623321271,"ip_address":"","comment_id":296987,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1623250579","product_id":100079601,"comment_content":"如何为用户创建token呢","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521674,"discussion_content":"调用 POST /v1/secrets接口，创建密钥对，之后调用iamctl jwt sign工具生成token","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623321271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1133041,"avatar":"https://static001.geekbang.org/account/avatar/00/11/49/f1/bd61dbb1.jpg","nickname":"Ransang","note":"","ucode":"DB67566A627DF2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381576,"discussion_content":"这个时候还没有token，怎么调用接口创建密钥对呢，调用接口是需要token的呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625130868,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296903,"user_name":"李云飞","can_delete":false,"product_type":"c1","uid":2641368,"ip_address":"","ucode":"02ACD40B2D189F","user_header":"https://static001.geekbang.org/account/avatar/00/28/4d/d8/72c4a037.jpg","comment_is_top":false,"comment_ctime":1623219678,"is_pvip":false,"replies":[{"id":"108021","content":"看看是不是命令复制错了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623583039,"ip_address":"","comment_id":296903,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1623219678","product_id":100079601,"comment_content":"老师你好，我在创建 iam-apiserver 证书和私钥时出错了，帮忙看一下呗<br>cfssl gencert -ca=~&#47;iam&#47;etc&#47;iam&#47;cert&#47;ca.pem \\ -ca-key=~&#47;iam&#47;etc&#47;iam&#47;cert&#47;ca-key.pem \\ -config=~&#47;iam&#47;etc&#47;iam&#47;cert&#47;ca-config.json \\ -profile=iam iam-apiserver-csr.json | cfssljson -bare iam-apiserver<br><br>错误信息：<br>only one argument is accepted, please check with usage<br>Failed to parse input: unexpected end of JSON input","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521637,"discussion_content":"看看是不是命令复制错了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623583039,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2641368,"avatar":"https://static001.geekbang.org/account/avatar/00/28/4d/d8/72c4a037.jpg","nickname":"李云飞","note":"","ucode":"02ACD40B2D189F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378437,"discussion_content":"不好意思，老师，命令拷贝后，忘了删除\\了，已经好使了，谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623223018,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296855,"user_name":"知鱼君","can_delete":false,"product_type":"c1","uid":1076719,"ip_address":"","ucode":"8B1958BEB5FB2C","user_header":"https://static001.geekbang.org/account/avatar/00/10/6d/ef/08132ab2.jpg","comment_is_top":false,"comment_ctime":1623204317,"is_pvip":false,"replies":[{"id":"107877","content":"应该可以，你可以试试，但里面的操作流程都是基于linux的，用windows还是不太方便。如果是腾讯云新用户可以花一百多买一年的cvm虚拟机来用","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623287157,"ip_address":"","comment_id":296855,"utype":1}],"discussion_count":1,"race_medal":2,"score":"1623204317","product_id":100079601,"comment_content":"老师，问下这个项目可以不用centos直接在windows电脑上部署吗？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521613,"discussion_content":"应该可以，你可以试试，但里面的操作流程都是基于linux的，用windows还是不太方便。如果是腾讯云新用户可以花一百多买一年的cvm虚拟机来用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623287157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296740,"user_name":"鉄","can_delete":false,"product_type":"c1","uid":2641109,"ip_address":"","ucode":"858F2EAEC7C097","user_header":"https://static001.geekbang.org/account/avatar/00/28/4c/d5/a7e7cfba.jpg","comment_is_top":false,"comment_ctime":1623140454,"is_pvip":false,"replies":[{"id":"107814","content":"报啥错误呢","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623162500,"ip_address":"","comment_id":296740,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1623140454","product_id":100079601,"comment_content":"请问我是按照最后一键彩蛋的脚本安装的，为啥执行amctl version -o yaml没得到预期结果呢？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521569,"discussion_content":"报啥错误呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623162500,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2641109,"avatar":"https://static001.geekbang.org/account/avatar/00/28/4c/d5/a7e7cfba.jpg","nickname":"鉄","note":"","ucode":"858F2EAEC7C097","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378289,"discussion_content":"显示bash: amctl:  command not found","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623148740,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296681,"user_name":"华亭007","can_delete":false,"product_type":"c1","uid":1324230,"ip_address":"","ucode":"EDABD230748359","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/BGx0tBP1qaDllErDk0PlrQ0HM5a7tDocpNnDLANGgNWib1xXMS3SicM24tdP3j1AuARgp7YlWJku2VoaTrHRDRhw/132","comment_is_top":false,"comment_ctime":1623116002,"is_pvip":false,"replies":[{"id":"107807","content":"第一次make后台耗时会久点，主要是在go get包，可以再等下。<br>","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623161824,"ip_address":"","comment_id":296681,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623116002","product_id":100079601,"comment_content":" make build BINS=iam-apiserver 耗时很长吗？ 等了好久了屏幕没什么变化~","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521548,"discussion_content":"第一次make后台耗时会久点，主要是在go get包，可以再等下。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623161824,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296653,"user_name":"Ransang","can_delete":false,"product_type":"c1","uid":1133041,"ip_address":"","ucode":"DB67566A627DF2","user_header":"https://static001.geekbang.org/account/avatar/00/11/49/f1/bd61dbb1.jpg","comment_is_top":false,"comment_ctime":1623084035,"is_pvip":false,"replies":[{"id":"107805","content":"安装教程写这么详细的原因是，希望大家知道怎么安装，所以建议弄明白每一步，老哥加油","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623161773,"ip_address":"","comment_id":296653,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623084035","product_id":100079601,"comment_content":"一步一步的安装好了，感觉自己像个无情的cv机器人，好多东西都不明就里，真的是除了菜一无所有","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521538,"discussion_content":"安装教程写这么详细的原因是，希望大家知道怎么安装，所以建议弄明白每一步，老哥加油","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623161773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296652,"user_name":"Ransang","can_delete":false,"product_type":"c1","uid":1133041,"ip_address":"","ucode":"DB67566A627DF2","user_header":"https://static001.geekbang.org/account/avatar/00/11/49/f1/bd61dbb1.jpg","comment_is_top":false,"comment_ctime":1623083459,"is_pvip":false,"replies":[{"id":"107804","content":"<br>那是没有用这个用户创建token?","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623161698,"ip_address":"","comment_id":296652,"utype":1}],"discussion_count":5,"race_medal":0,"score":"1623083459","product_id":100079601,"comment_content":"创建了“xuezhang”用户，然后用这个用户登陆获取token的时候一直返回null，看数据库是有这个用户的啊<br>$ curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -d&#39;{&quot;username&quot;:&quot;xuezhang&quot;,&quot;password&quot;:&quot;User@2021&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;login | jq -r .token<br>null","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521537,"discussion_content":"\n那是没有用这个用户创建token?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623161698,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1436177,"avatar":"https://static001.geekbang.org/account/avatar/00/15/ea/11/4f464693.jpg","nickname":"徐蕴","note":"","ucode":"1FDA719936FDA2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386383,"discussion_content":"我也遇到了类似的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627558428,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379990,"discussion_content":"老哥这个问题解决了吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624273926,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1133041,"avatar":"https://static001.geekbang.org/account/avatar/00/11/49/f1/bd61dbb1.jpg","nickname":"Ransang","note":"","ucode":"DB67566A627DF2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1351076,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/a4/e481ae48.jpg","nickname":"lesserror","note":"","ucode":"25A54D1165FCF6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381573,"discussion_content":"没有解决啊，除了admin用户，新建的用户全都获取不到token","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625130709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":379990,"ip_address":""},"score":381573,"extra":""}]},{"author":{"id":1133041,"avatar":"https://static001.geekbang.org/account/avatar/00/11/49/f1/bd61dbb1.jpg","nickname":"Ransang","note":"","ucode":"DB67566A627DF2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378425,"discussion_content":"啊？token还要设置吗，在哪里设置呢？我理解的这个登陆不就是为了获取token吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623220208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296612,"user_name":"StayLet","can_delete":false,"product_type":"c1","uid":1249652,"ip_address":"","ucode":"6B748CA3AF3C5B","user_header":"https://static001.geekbang.org/account/avatar/00/13/11/74/72ffa6d6.jpg","comment_is_top":false,"comment_ctime":1623063954,"is_pvip":false,"replies":[{"id":"107802","content":"不一定要把密码hardcode到文件中，这种情况一般是通过export LINUX_PASSWORD来保障安全","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623161653,"ip_address":"","comment_id":296612,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623063954","product_id":100079601,"comment_content":"这一节学的不是 Go，学的是 Shell 🤣，这样写 Shell 看起来特别规范。<br>另外我 visudo 配置了当前用户的 `NOPASSWD:ALL` ，所以没有配置 `LINUX_PASSWORD` 的环境变量，也倒不影响脚本执行，因为总觉得密码明文写环境变量不安全。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521519,"discussion_content":"不一定要把密码hardcode到文件中，这种情况一般是通过export LINUX_PASSWORD来保障安全","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623161653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296590,"user_name":"高布斯","can_delete":false,"product_type":"c1","uid":1532469,"ip_address":"","ucode":"5243F2629E21FD","user_header":"https://static001.geekbang.org/account/avatar/00/17/62/35/c0a5dffb.jpg","comment_is_top":false,"comment_ctime":1623054239,"is_pvip":false,"replies":[{"id":"107718","content":"应该是网络不通，可以手动下载","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623061925,"ip_address":"","comment_id":296590,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1623054239","product_id":100079601,"comment_content":"执行 .&#47;scripts&#47;install&#47;install.sh iam::install::install_cfssl 报错<br>--2021-06-07 01:21:48--  https:&#47;&#47;pkg.cfssl.org&#47;R1.2&#47;cfssl_linux-amd64<br>Resolving pkg.cfssl.org (pkg.cfssl.org)... 104.18.23.229, 104.18.22.229, 2606:4700::6812:17e5, ...<br>Connecting to pkg.cfssl.org (pkg.cfssl.org)|104.18.23.229|:443... connected.<br>HTTP request sent, awaiting response... 301 Moved Permanently<br>Location: https:&#47;&#47;github.com&#47;cloudflare&#47;cfssl&#47;releases&#47;download&#47;1.2.0&#47;cfssl_linux-amd64 [following]<br>--2021-06-07 01:21:48--  https:&#47;&#47;github.com&#47;cloudflare&#47;cfssl&#47;releases&#47;download&#47;1.2.0&#47;cfssl_linux-amd64<br>Resolving github.com (github.com)... 13.229.188.59<br>Connecting to github.com (github.com)|13.229.188.59|:443... connected.<br><br>GnuTLS: Error in the pull function.<br>Unable to establish SSL connection.<br>!!! [0607 01:23:28] Call tree:<br>!!! [0607 01:23:28]  1: .&#47;scripts&#47;install&#47;install.sh:387 iam::install::install_cfssl(...)<br>!!! Error in .&#47;scripts&#47;install&#47;install.sh:285<br>  Error in .&#47;scripts&#47;install&#47;install.sh:285. &#39;((i&lt;3-1))&#39; exited with status 4<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;install.sh:285 iam::install::install_cfssl(...)<br>  2: .&#47;scripts&#47;install&#47;install.sh:387 main(...)<br>Exiting with status 1","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521507,"discussion_content":"应该是网络不通，可以手动下载","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623061925,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2648276,"avatar":"","nickname":"Geek_2adb32","note":"","ucode":"FF6EAE92DCE751","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378313,"discussion_content":"https://blog.csdn.net/weixin_37153605/article/details/117716532 \n这里可以下，因为要墙的，手动没环境也下不了的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623158714,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296495,"user_name":"lianyz","can_delete":false,"product_type":"c1","uid":1330879,"ip_address":"","ucode":"A2536B49AEC4DD","user_header":"https://static001.geekbang.org/account/avatar/00/14/4e/bf/0f0754aa.jpg","comment_is_top":false,"comment_ctime":1623018600,"is_pvip":true,"replies":[{"id":"107714","content":"密码错误，需要在mysql中授权，可以网上搜下mysql授权语法","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623061846,"ip_address":"","comment_id":296495,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623018600","product_id":100079601,"comment_content":"老师，您好，刚开始是正常的，后来连接MariaDB就连不上了<br>[root@iZ2ze2z5tvvs324h1zqb52Z ~]# mysql -h127.0.0.1 -uroot -p&#39;xxxx&#39;<br>ERROR 1698 (28000): Access denied for user &#39;root&#39;@&#39;localhost&#39;","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521462,"discussion_content":"密码错误，需要在mysql中授权，可以网上搜下mysql授权语法","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623061846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296449,"user_name":"Geek_539ac5","can_delete":false,"product_type":"c1","uid":2625791,"ip_address":"","ucode":"49C86DD7DDC028","user_header":"","comment_is_top":false,"comment_ctime":1622978400,"is_pvip":false,"replies":[{"id":"107717","content":"没测过哈，原则上只要是类unix系统都使用，不过中间出问题，需要老哥你定位修复了，不会有太复杂的问题 你可以试试","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1623061903,"ip_address":"","comment_id":296449,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622978400","product_id":100079601,"comment_content":"Fedora31系统可以吗","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521443,"discussion_content":"没测过哈，原则上只要是类unix系统都使用，不过中间出问题，需要老哥你定位修复了，不会有太复杂的问题 你可以试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623061903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296342,"user_name":"呵呵哒","can_delete":false,"product_type":"c1","uid":2234743,"ip_address":"","ucode":"CEC8B421BB564A","user_header":"https://static001.geekbang.org/account/avatar/00/22/19/77/3ca9f42d.jpg","comment_is_top":false,"comment_ctime":1622905743,"is_pvip":false,"replies":[{"id":"107546","content":"是不是没创建成功，查询下数据库，有没有xxxxxx用户。另外xxxxxx密码是校验不通过的","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622952353,"ip_address":"","comment_id":296342,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622905743","product_id":100079601,"comment_content":"user表里面有我创建的用户但是就是显示账号密码错误<br>curl -s -XPOST -H&#39;Content-Type: application&#47;json&#39; -d&#39;{&quot;username&quot;:&quot;xxxxxx&quot;,&quot;password&quot;:&quot;xxxxxx&quot;}&#39; http:&#47;&#47;127.0.0.1:8080&#47;login<br>{&quot;message&quot;:&quot;incorrect Username or Password&quot;}","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521404,"discussion_content":"是不是没创建成功，查询下数据库，有没有xxxxxx用户。另外xxxxxx密码是校验不通过的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622952353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":296194,"user_name":"dll","can_delete":false,"product_type":"c1","uid":1264401,"ip_address":"","ucode":"5773CBC8BFB91F","user_header":"https://static001.geekbang.org/account/avatar/00/13/4b/11/d7e08b5b.jpg","comment_is_top":false,"comment_ctime":1622798679,"is_pvip":true,"replies":[{"id":"107542","content":"因为操作系统太多，所以没法每个系统都去测试，centos7出现问题，可以基于自己的知识积累解决下，应该问题不会多","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622952011,"ip_address":"","comment_id":296194,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622798679","product_id":100079601,"comment_content":"老师考虑兼容一下centos7吗","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521358,"discussion_content":"因为操作系统太多，所以没法每个系统都去测试，centos7出现问题，可以基于自己的知识积累解决下，应该问题不会多","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622952011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295745,"user_name":"Knox","can_delete":false,"product_type":"c1","uid":1160252,"ip_address":"","ucode":"C8005E0A199F49","user_header":"https://static001.geekbang.org/account/avatar/00/11/b4/3c/efa06774.jpg","comment_is_top":false,"comment_ctime":1622588895,"is_pvip":false,"replies":[{"id":"107414","content":"换个策略名，可能是策略名重复了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622676609,"ip_address":"","comment_id":295745,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622588895","product_id":100079601,"comment_content":"测试 iam-authz-server 是否成功安装    一节中<br>创建授权策略  会失败，报错Database error<br><br>{&quot;code&quot;:100101,&quot;message&quot;:&quot;Database error&quot;}<br><br>是前面哪步可能失败了吗？以前的步骤也没看到失败的状态，所以目前有点懵了。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521203,"discussion_content":"换个策略名，可能是策略名重复了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622676609,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295733,"user_name":"陈sir","can_delete":false,"product_type":"c1","uid":1043450,"ip_address":"","ucode":"5B60CCA6C00359","user_header":"https://static001.geekbang.org/account/avatar/00/0f/eb/fa/5dc2bcae.jpg","comment_is_top":false,"comment_ctime":1622563769,"is_pvip":true,"replies":[{"id":"107413","content":" k8s源码下的脚本函数命名非常棒，语义化的函数命名方式，看函数名就知道函数完成的功能类别和具体功能","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622676529,"ip_address":"","comment_id":295733,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622563769","product_id":100079601,"comment_content":"ubuntu 21.04 上运行通过，配置风格非常的k8s。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521198,"discussion_content":" k8s源码下的脚本函数命名非常棒，语义化的函数命名方式，看函数名就知道函数完成的功能类别和具体功能","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622676529,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295568,"user_name":"Dust","can_delete":false,"product_type":"c1","uid":1663859,"ip_address":"","ucode":"08423283E78B0F","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epS5HVaLf8zPMQDoYCS6WHgISUyCjlQrNfOf4ZLzZiaYjhdU9dZQOFxicsib7RnNUFSejIw8bLaN0wyw/132","comment_is_top":false,"comment_ctime":1622477387,"is_pvip":false,"replies":[{"id":"107354","content":"Token是不是过期了","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622522368,"ip_address":"","comment_id":295568,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1622477387","product_id":100079601,"comment_content":"按照了步骤操作，为什么资源授权总是返回{&quot;code&quot;:100202,&quot;message&quot;:&quot;Signature is invalid&quot;}","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521133,"discussion_content":"Token是不是过期了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622522368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1193874,"avatar":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","nickname":"授人以🐟，不如授人以渔","note":"","ucode":"BD53829E924B66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377604,"discussion_content":"{&#34;code&#34;:100202,&#34;message&#34;:&#34;Signature is invalid&#34;} 我也是这个反馈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622725052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295536,"user_name":"一天","can_delete":false,"product_type":"c1","uid":1078410,"ip_address":"","ucode":"2BE0596D23E4F7","user_header":"https://static001.geekbang.org/account/avatar/00/10/74/8a/88474b8e.jpg","comment_is_top":false,"comment_ctime":1622466695,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1622466695","product_id":100079601,"comment_content":"坐等大佬的docker镜像<br>","like_count":0},{"had_liked":false,"id":295365,"user_name":"Geek_sky","can_delete":false,"product_type":"c1","uid":1733288,"ip_address":"","ucode":"BBFE6FF1193873","user_header":"https://static001.geekbang.org/account/avatar/00/1a/72/a8/c24a66a1.jpg","comment_is_top":false,"comment_ctime":1622384148,"is_pvip":false,"replies":[{"id":"107231","content":"贴下iam-apiserver的日志看看","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435741,"ip_address":"","comment_id":295365,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622384148","product_id":100079601,"comment_content":"老师，我在iam-apiserver创建用户报错，<br>{&quot;code&quot;:1,&quot;message&quot;:&quot;An internal server occurred&quot;,&quot;reference&quot;:&quot;http:&#47;&#47;github.com&#47;marmotedu&#47;errors&#47;README.md&quot;}<br>在接下来的iam-authz-server创建密钥也报相同的错误。<br>这个需要怎么处理？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521048,"discussion_content":"贴下iam-apiserver的日志看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295297,"user_name":"Geek_e41cda","can_delete":false,"product_type":"c1","uid":2639890,"ip_address":"","ucode":"FD78DDC8803F56","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/8P0BdVlohjgCsUQPHSPw4FRAbrlibca3Sg2ITY2q4MDPqBtLyTS8MjhOPvJNPWeF5PngRRnhyiajEduSSYX52Swg/132","comment_is_top":false,"comment_ctime":1622352253,"is_pvip":false,"replies":[{"id":"107229","content":"网络不稳定，重试下，或者自己下载安装","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435703,"ip_address":"","comment_id":295297,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622352253","product_id":100079601,"comment_content":"安装cfssl时报错了，怎么解决呢？<br>Resolving pkg.cfssl.org (pkg.cfssl.org)... 104.18.23.229, 104.18.22.229, 2606:4700::6812:16e5, ...<br>Connecting to pkg.cfssl.org (pkg.cfssl.org)|104.18.23.229|:443... connected.<br>HTTP request sent, awaiting response... 301 Moved Permanently<br>Location: https:&#47;&#47;github.com&#47;cloudflare&#47;cfssl&#47;releases&#47;download&#47;1.2.0&#47;cfssl_linux-amd64 [following]<br>--2021-05-30 05:51:25--  https:&#47;&#47;github.com&#47;cloudflare&#47;cfssl&#47;releases&#47;download&#47;1.2.0&#47;cfssl_linux-amd64<br>Resolving github.com (github.com)... 13.250.177.223, 52.74.223.119, 13.229.188.59<br>Connecting to github.com (github.com)|13.250.177.223|:443... connected.<br>HTTP request sent, awaiting response... 302 Found<br>Location: https:&#47;&#47;github-releases.githubusercontent.com&#47;21591001&#47;6deaa080-9ebe-11eb-919d-cbab8a7bb20b?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20210530%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20210530T045133Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=9e6aa806eae375229aec898a2559e3011e458b2c92e31e86e6609e15d5830d84&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;key_id=0&amp;repo_id=21591001&amp;response-content-disposition=attachment%3B%20filename%3Dcfssl_linux-amd64&amp;response-content-type=application%2Foctet-stream [following]<br>--2021-05-30 05:51:26--  https:&#47;&#47;github-releases.githubusercontent.com&#47;21591001&#47;6deaa080-9ebe-11eb-919d-cbab8a7bb20b?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20210530%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20210530T045133Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=9e6aa806eae375229aec898a2559e3011e458b2c92e31e86e6609e15d5830d84&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;key_id=0&amp;repo_id=21591001&amp;response-content-disposition=attachment%3B%20filename%3Dcfssl_linux-amd64&amp;response-content-type=application%2Foctet-stream<br>Resolving github-releases.githubusercontent.com (github-releases.githubusercontent.com)... 185.199.109.154<br>Connecting to github-releases.githubusercontent.com (github-releases.githubusercontent.com)|185.199.109.154|:443... failed: Connection refused.","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521025,"discussion_content":"网络不稳定，重试下，或者自己下载安装","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435703,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295286,"user_name":"ppd0705","can_delete":false,"product_type":"c1","uid":1155646,"ip_address":"","ucode":"EB63D4E3FD1E9A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132","comment_is_top":false,"comment_ctime":1622346259,"is_pvip":false,"replies":[{"id":"107228","content":"等后面的更新哈","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435675,"ip_address":"","comment_id":295286,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622346259","product_id":100079601,"comment_content":"跟着操作完了 但是对整个大系统还是很陌生 ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521020,"discussion_content":"等后面的更新哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295222,"user_name":"Geek_fe541a","can_delete":false,"product_type":"c1","uid":1740085,"ip_address":"","ucode":"5B3DD7A8E3E55B","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoyNOEic1I3QMyBAAPuPUFAicjtAqmCt1wWP9YyC2mRfibibR5iaexlxbYzaE5ZeX6CwOdfzjF3wXic6zyQ/132","comment_is_top":false,"comment_ctime":1622303620,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1622303620","product_id":100079601,"comment_content":"老师，我在执行命令： make build BINS=iam-pump，报错：<br><br>===========&gt; Building binary iam-pump c01dd7b for linux amd64<br>go build github.com&#47;olivere&#47;elastic&#47;v7: &#47;home&#47;going&#47;go&#47;go1.16.2&#47;pkg&#47;tool&#47;linux_amd64&#47;compile: signal: killed<br>make[1]: *** [scripts&#47;make-rules&#47;golang.mk:60: go.build.linux_amd64.iam-pump] Error 1<br>make: *** [Makefile:60: build] Error 2","like_count":0,"discussions":[{"author":{"id":1231840,"avatar":"https://static001.geekbang.org/account/avatar/00/12/cb/e0/30b70102.jpg","nickname":"stopper","note":"","ucode":"A049638521D6DF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379618,"discussion_content":"你解决了？\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624015662,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1231840,"avatar":"https://static001.geekbang.org/account/avatar/00/12/cb/e0/30b70102.jpg","nickname":"stopper","note":"","ucode":"A049638521D6DF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379617,"discussion_content":"我也遇到了，目前还没解决","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624015457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295215,"user_name":"Geek_e41cda","can_delete":false,"product_type":"c1","uid":2639890,"ip_address":"","ucode":"FD78DDC8803F56","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/8P0BdVlohjgCsUQPHSPw4FRAbrlibca3Sg2ITY2q4MDPqBtLyTS8MjhOPvJNPWeF5PngRRnhyiajEduSSYX52Swg/132","comment_is_top":false,"comment_ctime":1622300942,"is_pvip":false,"replies":[{"id":"107226","content":"source scripts&#47;install&#47;environment.sh 试试","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435575,"ip_address":"","comment_id":295215,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1622300942","product_id":100079601,"comment_content":"安装mariadb报错，怎么解决<br>[going@dev iam]$ .&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::install<br>[sudo] password for going: Sorry, try again.<br>[sudo] password for going: <br>sudo: no password was provided<br>sudo: 1 incorrect password attempt<br>!!! [0529 16:06:21] Call tree:<br>!!! [0529 16:06:21]  1: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;mariadb.sh:24<br>  Error in .&#47;scripts&#47;install&#47;mariadb.sh:24. &#39;((i&lt;3-1))&#39; exited with status 0 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;mariadb.sh:24 iam::mariadb::install(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)<br>Exiting with status 1<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520996,"discussion_content":"source scripts/install/environment.sh 试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435575,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2464409,"avatar":"https://static001.geekbang.org/account/avatar/00/25/9a/99/0576728b.jpg","nickname":"Automano","note":"","ucode":"77FDD9FB587887","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376946,"discussion_content":" ./scripts/install/mariadb.sh iam::mariadb::install 这个命令用sudo执行 试试","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1622432272,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1193874,"avatar":"https://static001.geekbang.org/account/avatar/00/12/37/92/961ba560.jpg","nickname":"授人以🐟，不如授人以渔","note":"","ucode":"BD53829E924B66","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377417,"discussion_content":"确实有效，执行：sudo ./scripts/install/mariadb.sh iam::mariadb::install ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622637511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295168,"user_name":"Tiandh","can_delete":false,"product_type":"c1","uid":1114508,"ip_address":"","ucode":"581C14BAE84AE7","user_header":"https://static001.geekbang.org/account/avatar/00/11/01/8c/41adb537.jpg","comment_is_top":false,"comment_ctime":1622277729,"is_pvip":false,"replies":[{"id":"107224","content":"重拾下试试?可能是网络不稳定","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435480,"ip_address":"","comment_id":295168,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622277729","product_id":100079601,"comment_content":"环境为centos8.2，在安装 iam-pump 的时候出现了下面错误：<br>[going@dev iam]$ make build BINS=iam-pump<br>===========&gt; Building binary iam-pump c01dd7b for linux amd64<br>go build github.com&#47;olivere&#47;elastic&#47;v7: &#47;home&#47;going&#47;go&#47;go1.16.2&#47;pkg&#47;tool&#47;linux_amd64&#47;compile: signal: killed<br>make[1]: *** [scripts&#47;make-rules&#47;golang.mk:60: go.build.linux_amd64.iam-pump] Error 1<br>make: *** [Makefile:60: build] Error 2<br>[going@dev iam]$ ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520970,"discussion_content":"重拾下试试?可能是网络不稳定","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295158,"user_name":"Geek_e41cda","can_delete":false,"product_type":"c1","uid":2639890,"ip_address":"","ucode":"FD78DDC8803F56","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/8P0BdVlohjgCsUQPHSPw4FRAbrlibca3Sg2ITY2q4MDPqBtLyTS8MjhOPvJNPWeF5PngRRnhyiajEduSSYX52Swg/132","comment_is_top":false,"comment_ctime":1622275968,"is_pvip":false,"replies":[{"id":"107223","content":"用going用户安装，或者把root用户加到sudoer中","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435437,"ip_address":"","comment_id":295158,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622275968","product_id":100079601,"comment_content":"安装数据库出错了，求解：<br>[root@dev iam]# .&#47;scripts&#47;install&#47;mariadb.sh iam::mariadb::install<br>root is not in the sudoers file.  This incident will be reported.<br>!!! [0529 08:11:56] Call tree:<br>!!! [0529 08:11:56]  1: .&#47;scripts&#47;install&#47;mariadb.sh:79 iam::mariadb::install(...)<br>!!! Error in .&#47;scripts&#47;install&#47;mariadb.sh:24<br>  Error in .&#47;scripts&#47;install&#47;mariadb.sh:24. &#39;((i&lt;3-1))&#39; exited with status 0 1<br>Call stack:<br>  1: .&#47;scripts&#47;install&#47;mariadb.sh:24 iam::mariadb::install(...)<br>  2: .&#47;scripts&#47;install&#47;mariadb.sh:79 main(...)<br>Exiting with status 1<br>","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520969,"discussion_content":"用going用户安装，或者把root用户加到sudoer中","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435437,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295147,"user_name":"spider","can_delete":false,"product_type":"c1","uid":1593307,"ip_address":"","ucode":"029BB715644BAA","user_header":"https://static001.geekbang.org/account/avatar/00/18/4f/db/d4b956aa.jpg","comment_is_top":false,"comment_ctime":1622272370,"is_pvip":false,"replies":[{"id":"107220","content":"没问题哈","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435318,"ip_address":"","comment_id":295147,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622272370","product_id":100079601,"comment_content":"mongo 脚本写的有问题吧","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520964,"discussion_content":"没问题哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435318,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295072,"user_name":"🌱 机器猫 Go！","can_delete":false,"product_type":"c1","uid":2640347,"ip_address":"","ucode":"6B577864EADDCE","user_header":"https://static001.geekbang.org/account/avatar/00/28/49/db/078c24ec.jpg","comment_is_top":false,"comment_ctime":1622205447,"is_pvip":false,"replies":[{"id":"107219","content":"优秀啊!我可以加到项目文档中吗","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435312,"ip_address":"","comment_id":295072,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1622205447","product_id":100079601,"comment_content":"macOs 简单踩坑集锦，macOS 的朋友可以看下<br>https:&#47;&#47;blog.qfdk.me&#47;post&#47;Go%20yu-yan-xiang-mu-kai-fa-shi-zhan-%20-%20macOS%20cai-keng-ji-jin.html","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520936,"discussion_content":"优秀啊!我可以加到项目文档中吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2640347,"avatar":"https://static001.geekbang.org/account/avatar/00/28/49/db/078c24ec.jpg","nickname":"🌱 机器猫 Go！","note":"","ucode":"6B577864EADDCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376966,"discussion_content":"可以可以 后面我抽空再修改下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622440650,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295069,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1622204413,"is_pvip":false,"replies":[{"id":"107216","content":"感谢pedro反馈，已经文章已经更新!","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622435111,"ip_address":"","comment_id":295069,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622204413","product_id":100079601,"comment_content":"发现了一个问题，iamctl 应用在安装的过程中，生成的配置文件，通过如下命令被移动：<br>```sh<br>sudo mv admin* ${IAM_CONFIG_DIR}&#47;cert<br>```<br>但是 iamctl 的 config 配置读取的 cert 文件不在这个目录下，而是 $HOME&#47;.iam&#47;cert，所以直接运行 iamctl 会报错，大家可以直接通过 cp 命令，将${IAM_CONFIG_DIR}&#47;cert下的 admin* 拷贝到该目录就可以直接运行了。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520933,"discussion_content":"感谢pedro反馈，已经文章已经更新!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622435111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295042,"user_name":"Tiandh","can_delete":false,"product_type":"c1","uid":1114508,"ip_address":"","ucode":"581C14BAE84AE7","user_header":"https://static001.geekbang.org/account/avatar/00/11/01/8c/41adb537.jpg","comment_is_top":false,"comment_ctime":1622192932,"is_pvip":false,"replies":[{"id":"107137","content":"感谢Tiandh哥反馈，我联系编辑修改下","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622253491,"ip_address":"","comment_id":295042,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622192932","product_id":100079601,"comment_content":"一键部署 -C 后面应该是 &#47;tmp&#47;<br>| tar -xz -C &#47;  tmp&#47;   ","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520924,"discussion_content":"感谢Tiandh哥反馈，我联系编辑修改下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622253491,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":295005,"user_name":"Geek_sky","can_delete":false,"product_type":"c1","uid":1733288,"ip_address":"","ucode":"BBFE6FF1193873","user_header":"https://static001.geekbang.org/account/avatar/00/1a/72/a8/c24a66a1.jpg","comment_is_top":false,"comment_ctime":1622181391,"is_pvip":false,"replies":[{"id":"107146","content":"是不是新创建的mongodb呢，新建的第一次登陆时不用认证的，可以把mongodb卸载重新安装试试","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622253939,"ip_address":"","comment_id":295005,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1622181391","product_id":100079601,"comment_content":"老师，我在创建mongodb用户db.createUser({user:&quot;root&quot;,pwd:&quot;iam59!z$&quot;,roles:[&quot;root&quot;]})时，报错：<br>uncaught exception: Error: couldn&#39;t add user: command createUser requires authentication :<br>_getErrorWithCode@src&#47;mongo&#47;shell&#47;utils.js:25:13<br>DB.prototype.createUser@src&#47;mongo&#47;shell&#47;db.js:1386:11<br>@(shell):1:1<br>这个需要怎么处理？","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520911,"discussion_content":"是不是新创建的mongodb呢，新建的第一次登陆时不用认证的，可以把mongodb卸载重新安装试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622253939,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1733288,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/72/a8/c24a66a1.jpg","nickname":"Geek_sky","note":"","ucode":"BBFE6FF1193873","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376842,"discussion_content":"嗯，已经卸载重新安装了。问题产生的原因是我使用github上的一键安装，这个安装方式中已经用户也创建了，我看过源码发现的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622375615,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1198013,"avatar":"https://static001.geekbang.org/account/avatar/00/12/47/bd/5c34df95.jpg","nickname":"管清麟","note":"","ucode":"7CA1651D0DE257","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1733288,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/72/a8/c24a66a1.jpg","nickname":"Geek_sky","note":"","ucode":"BBFE6FF1193873","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379518,"discussion_content":"我的也这样啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623935450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":376842,"ip_address":""},"score":379518,"extra":""}]}]},{"had_liked":false,"id":294989,"user_name":"Iron Man","can_delete":false,"product_type":"c1","uid":2453901,"ip_address":"","ucode":"9F1324CED4F4CA","user_header":"https://static001.geekbang.org/account/avatar/00/25/71/8d/a4191f06.jpg","comment_is_top":false,"comment_ctime":1622172593,"is_pvip":false,"replies":[{"id":"107138","content":"已经修复了，感谢反馈！","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622253602,"ip_address":"","comment_id":294989,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622172593","product_id":100079601,"comment_content":"文章的顺序有点问题，创建$IAM_ROOT和从github clone代码的描述应该放到数据库安装之前，不然第一个cd $IAM_ROOT命令就报错了","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520906,"discussion_content":"已经修复了，感谢反馈！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622253602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":294637,"user_name":"dobby","can_delete":false,"product_type":"c1","uid":2549097,"ip_address":"","ucode":"9C1992C4DD28F5","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoib6BjEV4KPEaIdlLEfoVFRCxCSlL2XaIVDiaakvjhWEibibym323ZeHXAY46JMO3nSHmjiaWtAY47eww/132","comment_is_top":false,"comment_ctime":1622029071,"is_pvip":true,"replies":[{"id":"106961","content":"优秀!","user_name":"作者回复","user_name_real":"CK1.0","uid":"1167883","ctime":1622043029,"ip_address":"","comment_id":294637,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1622029071","product_id":100079601,"comment_content":"已看完，等更新咯。","like_count":0,"discussions":[{"author":{"id":1167883,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d2/0b/cdd0787a.jpg","nickname":"孔令飞","note":"","ucode":"8363EA4BD0AAF0","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520747,"discussion_content":"优秀!","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622043029,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}