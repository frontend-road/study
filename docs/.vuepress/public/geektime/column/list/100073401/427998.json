{"id":427998,"title":"Spark UIï¼ˆä¸‹ï¼‰ï¼šæ·±å…¥è§£è¯»Sparkä½œä¸šçš„â€œä½“æ£€æŠ¥å‘Šâ€","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯å´ç£Šã€‚</p><p>åœ¨ä¸Šä¸€è®²ï¼Œæˆ‘ä»¬ä¸€èµ·æ¢³ç†äº†Spark UIçš„ä¸€çº§å…¥å£ã€‚å…¶ä¸­Executorsã€Environmentã€Storageæ˜¯è¯¦æƒ…é¡µï¼Œå¼€å‘è€…å¯ä»¥é€šè¿‡è¿™3ä¸ªé¡µé¢ï¼Œè¿…é€Ÿåœ°äº†è§£é›†ç¾¤æ•´ä½“çš„è®¡ç®—è´Ÿè½½ã€è¿è¡Œç¯å¢ƒï¼Œä»¥åŠæ•°æ®é›†ç¼“å­˜çš„è¯¦ç»†æƒ…å†µã€‚è€ŒSQLã€Jobsã€Stagesï¼Œæ›´å¤šåœ°æ˜¯ä¸€ç§ç½—åˆ—å¼çš„å±•ç¤ºï¼Œæƒ³è¦äº†è§£å…¶ä¸­çš„ç»†èŠ‚ï¼Œè¿˜éœ€è¦è¿›å…¥åˆ°äºŒçº§å…¥å£ã€‚</p><p>æ²¿ç”¨ä¹‹å‰çš„æ¯”å–»ï¼Œèº«ä¸ºâ€œå¤§å¤«â€çš„å¼€å‘è€…æƒ³è¦ç»“åˆç»éªŒï¼Œè¿…é€Ÿå®šä½â€œç—…ç¶â€ï¼Œç¦»ä¸å¼€å„å¼å„æ ·çš„æŒ‡æ ‡é¡¹ã€‚è€Œä»Šå¤©è¦è®²çš„äºŒçº§å…¥å£ï¼Œç›¸æ¯”ä¸€çº§å…¥å£ï¼Œå†…å®¹ä¼šæ›´åŠ ä¸°å¯Œã€è¯¦å°½ã€‚è¦æƒ³æˆä¸ºä¸€åâ€œä¸´åºŠç»éªŒä¸°å¯Œâ€çš„è€åŒ»ç”Ÿï¼Œå’±ä»¬å…ˆè¦åšåˆ°ç†Ÿç»ƒè§£è¯»è¿™äº›åº¦é‡æŒ‡æ ‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/56/d2/56563537c4e0ef597629d42618df21d2.png?wh=718x52\" alt=\"å›¾ç‰‡\" title=\"Spark UIå¯¼èˆªæ¡ï¼šä¸€çº§å…¥å£\"></p><p>æ‰€è°“äºŒçº§å…¥å£ï¼Œå®ƒæŒ‡çš„æ˜¯ï¼Œ<strong>é€šè¿‡ä¸€æ¬¡è¶…é“¾æ¥è·³è½¬æ‰èƒ½è®¿é—®åˆ°çš„é¡µé¢</strong>ã€‚å¯¹äºSQLã€Jobså’ŒStagesè¿™3ç±»å…¥å£æ¥è¯´ï¼ŒäºŒçº§å…¥å£å¾€å¾€å·²ç»æä¾›äº†è¶³å¤Ÿçš„ä¿¡æ¯ï¼ŒåŸºæœ¬è¦†ç›–äº†â€œä½“æ£€æŠ¥å‘Šâ€çš„å…¨éƒ¨å†…å®¹ã€‚å› æ­¤ï¼Œå°½ç®¡Spark UIä¹Ÿæä¾›äº†å°‘é‡çš„ä¸‰çº§å…¥å£ï¼ˆéœ€è¦ä¸¤è·³æ‰èƒ½åˆ°è¾¾çš„é¡µé¢ï¼‰ï¼Œä½†æ˜¯è¿™äº›éšè—åœ¨â€œçŠ„è§’æ—®æ—¯â€çš„ä¸‰çº§å…¥å£ï¼Œå¾€å¾€å¹¶ä¸éœ€è¦å¼€å‘è€…å»ç‰¹åˆ«å…³æ³¨ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ²¿ç€SQL -&gt; Jobs -&gt; Stagesçš„é¡ºåºï¼Œä¾æ¬¡åœ°å»è®¿é—®å®ƒä»¬çš„äºŒçº§å…¥å£ï¼Œä»è€Œé’ˆå¯¹å…¨å±€DAGã€ä½œä¸šä»¥åŠæ‰§è¡Œé˜¶æ®µï¼Œè·å¾—æ›´åŠ æ·±å…¥çš„æ¢ç´¢ä¸æ´å¯Ÿã€‚</p><!-- [[[read_end]]] --><h4>SQLè¯¦æƒ…é¡µ</h4><p>åœ¨SQL Tabä¸€çº§å…¥å£ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ‰3ä¸ªæ¡ç›®ï¼Œåˆ†åˆ«æ˜¯countï¼ˆç»Ÿè®¡ç”³è¯·ç¼–å·ï¼‰ã€countï¼ˆç»Ÿè®¡ä¸­ç­¾ç¼–å·ï¼‰å’Œsaveã€‚å‰ä¸¤è€…çš„è®¡ç®—è¿‡ç¨‹ï¼Œéƒ½æ˜¯è¯»å–æ•°æ®æºã€ç¼“å­˜æ•°æ®å¹¶è§¦å‘ç¼“å­˜çš„ç‰©åŒ–ï¼Œç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬æŠŠç›®å…‰æ”¾åœ¨<strong>save</strong>è¿™ä¸ªæ¡ç›®ä¸Šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/dd/cb/dd3231ca21492ff00c63a111d96516cb.png?wh=1920x613\" alt=\"å›¾ç‰‡\" title=\"SQLæ¦‚è§ˆé¡µ\"></p><p>ç‚¹å‡»å›¾ä¸­çš„â€œsave at<console>:27â€ï¼Œå³å¯è¿›å…¥åˆ°è¯¥ä½œä¸šçš„æ‰§è¡Œè®¡åˆ’é¡µé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</console></p><p><img src=\"https://static001.geekbang.org/resource/image/5e/b9/5e9fa6231dc66db829bb043446c73db9.png?wh=1920x1200\" alt=\"å›¾ç‰‡\" title=\"SQLé¡µé¢äºŒçº§å…¥å£ï¼ˆéƒ¨åˆ†æˆªå›¾ï¼‰\"></p><p>ä¸ºäº†èšç„¦é‡ç‚¹ï¼Œè¿™é‡Œæˆ‘ä»¬ä»…æˆªå–äº†éƒ¨åˆ†çš„æ‰§è¡Œè®¡åˆ’ï¼Œæƒ³è¦è·å–å®Œæ•´çš„æ‰§è¡Œè®¡åˆ’ï¼Œä½ å¯ä»¥é€šè¿‡è®¿é—®<a href=\"https://github.com/wulei-bj-cn/learn-spark/blob/main/chapter22/demo%20-%20Details%20for%20Query%202.webarchive\">è¿™é‡Œ</a>æ¥è·å¾—ã€‚ä¸ºäº†æ–¹ä¾¿ä½ é˜…è¯»ï¼Œè¿™é‡Œæˆ‘æ‰‹ç»˜å‡ºäº†æ‰§è¡Œè®¡åˆ’çš„ç¤ºæ„å›¾ï¼Œä¾›ä½ å‚è€ƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/04/8b/0437e06b8f256b9011e07582d1470d8b.jpg?wh=1920x575\" alt=\"å›¾ç‰‡\" title=\"â€œå€ç‡è®¡ç®—â€SQLæ‰§è¡Œè®¡åˆ’ç¤ºæ„å›¾\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œâ€œå€ç‡è®¡ç®—â€åº”ç”¨çš„è®¡ç®—è¿‡ç¨‹ï¼Œéå¸¸å…·æœ‰ä»£è¡¨æ€§ï¼Œå®ƒæ¶µç›–äº†æ•°æ®åˆ†æåœºæ™¯ä¸­å¤§éƒ¨åˆ†çš„æ“ä½œï¼Œä¹Ÿå³<strong>è¿‡æ»¤ã€æŠ•å½±ã€å…³è”ã€åˆ†ç»„èšåˆå’Œæ’åº</strong>ã€‚å›¾ä¸­çº¢è‰²çš„éƒ¨åˆ†ä¸ºExchangeï¼Œä»£è¡¨çš„æ˜¯Shuffleæ“ä½œï¼Œè“è‰²çš„éƒ¨åˆ†ä¸ºSortï¼Œä¹Ÿå°±æ˜¯æ’åºï¼Œè€Œç»¿è‰²çš„éƒ¨åˆ†æ˜¯Aggregateï¼Œè¡¨ç¤ºçš„æ˜¯ï¼ˆå±€éƒ¨ä¸å…¨å±€çš„ï¼‰æ•°æ®èšåˆã€‚</p><p>æ— ç–‘ï¼Œè¿™ä¸‰éƒ¨åˆ†æ˜¯ç¡¬ä»¶èµ„æºçš„ä¸»è¦æ¶ˆè´¹è€…ï¼ŒåŒæ—¶ï¼Œå¯¹äºè¿™3ç±»æ“ä½œï¼ŒSpark UIæ›´æ˜¯æä¾›äº†è¯¦ç»†çš„Metricsæ¥åˆ»ç”»ç›¸åº”çš„ç¡¬ä»¶èµ„æºæ¶ˆè€—ã€‚æ¥ä¸‹æ¥ï¼Œå’±ä»¬å°±é‡ç‚¹ç ”ç©¶ä¸€ä¸‹è¿™3ç±»æ“ä½œçš„åº¦é‡æŒ‡æ ‡ã€‚</p><p><strong>Exchange</strong></p><p>ä¸‹å›¾ä¸­å¹¶åˆ—çš„ä¸¤ä¸ªExchangeï¼Œå¯¹åº”çš„æ˜¯ç¤ºæ„å›¾ä¸­SortMergeJoinä¹‹å‰çš„ä¸¤ä¸ªExchangeã€‚å®ƒä»¬çš„ä½œç”¨æ˜¯å¯¹ç”³è¯·ç¼–ç æ•°æ®ä¸ä¸­ç­¾ç¼–ç æ•°æ®åšShuffleï¼Œä¸ºæ•°æ®å…³è”åšå‡†å¤‡ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e5/dc/e506b76d435de956e4e20d62f82e10dc.png?wh=1626x756\" alt=\"å›¾ç‰‡\" title=\"Exchangeï¼ˆå·¦ï¼‰ï¼šç”³è¯·ç¼–ç æ•°æ®Shuffleï¼ŒExchangeï¼ˆå³ï¼‰ï¼šä¸­ç­¾ç¼–ç æ•°æ®Shuffle\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºæ¯ä¸€ä¸ªExchangeï¼ŒSpark UIéƒ½æä¾›äº†ä¸°å¯Œçš„Metricsæ¥åˆ»ç”»Shuffleçš„è®¡ç®—è¿‡ç¨‹ã€‚ä»Shuffle Writeåˆ°Shuffle Readï¼Œä»æ•°æ®é‡åˆ°å¤„ç†æ—¶é—´ï¼Œåº”æœ‰å°½æœ‰ã€‚ä¸ºäº†æ–¹ä¾¿è¯´æ˜ï¼Œå¯¹äºMetricsçš„è§£é‡Šä¸é‡Šä¹‰ï¼Œæˆ‘ä»¥è¡¨æ ¼çš„æ–¹å¼è¿›è¡Œäº†æ•´ç†ï¼Œä¾›ä½ éšæ—¶æŸ¥é˜…ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/73/6f/73e87a9d741a1859b287397e46abe16f.jpg?wh=1920x1297\" alt=\"å›¾ç‰‡\" title=\"Shuffle Metrics\"></p><p>ç»“åˆè¿™ä»½Shuffleçš„â€œä½“æ£€æŠ¥å‘Šâ€ï¼Œæˆ‘ä»¬å°±èƒ½ä»¥é‡åŒ–çš„æ–¹å¼ï¼Œå»æŒæ¡Shuffleè¿‡ç¨‹çš„è®¡ç®—ç»†èŠ‚ï¼Œä»è€Œä¸ºè°ƒä¼˜æä¾›æ›´å¤šçš„æ´å¯Ÿä¸æ€è·¯ã€‚</p><p>ä¸ºäº†è®©ä½ è·å¾—ç›´è§‚æ„Ÿå—ï¼Œæˆ‘è¿˜æ˜¯ä¸¾ä¸ªä¾‹å­è¯´æ˜ã€‚æ¯”æ–¹è¯´ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°è¿‡æ»¤ä¹‹åçš„ä¸­ç­¾ç¼–å·æ•°æ®å¤§å°ä¸è¶³10MBï¼ˆ7.4MBï¼‰ï¼Œè¿™æ—¶æˆ‘ä»¬é¦–å…ˆä¼šæƒ³åˆ°ï¼Œå¯¹äºè¿™æ ·çš„å¤§è¡¨Joinå°è¡¨ï¼ŒSpark SQLé€‰æ‹©äº†SortMergeJoinç­–ç•¥æ˜¯ä¸åˆç†çš„ã€‚</p><p>åŸºäºè¿™æ ·çš„åˆ¤æ–­ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥è®©Spark SQLé€‰æ‹©BroadcastHashJoinç­–ç•¥æ¥æä¾›æ›´å¥½çš„æ‰§è¡Œæ€§èƒ½ã€‚è‡³äºè°ƒä¼˜çš„å…·ä½“æ–¹æ³•ï¼Œæƒ³å¿…ä¸ç”¨æˆ‘å¤šè¯´ï¼Œä½ ä¹Ÿæ—©å·²å¿ƒé¢†ç¥ä¼šï¼šè¦ä¹ˆç”¨å¼ºåˆ¶å¹¿æ’­ï¼Œè¦ä¹ˆåˆ©ç”¨3.xç‰ˆæœ¬æä¾›çš„AQEç‰¹æ€§ã€‚</p><p>ä½ ä¸å¦¨ç»“åˆæœ¬è®²å¼€å¤´çš„ä»£ç ï¼Œå»å®ŒæˆSortMergeJoinåˆ°BroadcastHashJoinç­–ç•¥è½¬æ¢çš„è°ƒä¼˜ï¼ŒæœŸå¾…ä½ åœ¨ç•™è¨€åŒºåˆ†äº«ä½ çš„è°ƒä¼˜ç»“æœã€‚</p><p><strong>Sort</strong></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥è¯´è¯´Sortã€‚ç›¸æ¯”Exchangeï¼ŒSortçš„åº¦é‡æŒ‡æ ‡æ²¡é‚£ä¹ˆå¤šï¼Œä¸è¿‡ï¼Œä»–ä»¬è¶³ä»¥è®©æˆ‘ä»¬ä¸€çª¥Sortåœ¨è¿è¡Œæ—¶ï¼Œå¯¹äºå†…å­˜çš„æ¶ˆè€—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/50/90/50e7dba6b9c1700c8b466077e8c34990.png?wh=1760x594\" alt=\"å›¾ç‰‡\" title=\"Sortï¼ˆå·¦ï¼‰ï¼šç”³è¯·ç¼–ç æ•°æ®æ’åºï¼ŒSortï¼ˆå³ï¼‰ï¼šä¸­ç­¾ç¼–ç æ•°æ®æ’åº\"></p><p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆæŠŠè¿™äº›Metricsæ•´ç†åˆ°è¡¨æ ¼ä¸­ï¼Œæ–¹ä¾¿åæœŸæŸ¥çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3d/39/3db747647eyy03b2bed8f972ff967c39.jpg?wh=1883x727\" alt=\"å›¾ç‰‡\" title=\"Sort Metrics\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œâ€œPeak memory totalâ€å’Œâ€œSpill size totalâ€è¿™ä¸¤ä¸ªæ•°å€¼ï¼Œè¶³ä»¥æŒ‡å¯¼æˆ‘ä»¬æ›´æœ‰é’ˆå¯¹æ€§åœ°å»è®¾ç½®spark.executor.memoryã€spark.memory.fractionã€spark.memory.storageFractionï¼Œä»è€Œä½¿å¾—Execution MemoryåŒºåŸŸå¾—åˆ°å……åˆ†çš„ä¿éšœã€‚</p><p>ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œç»“åˆ18.8GBçš„å³°å€¼æ¶ˆè€—ï¼Œä»¥åŠ12.5GBçš„ç£ç›˜æº¢å‡ºè¿™ä¸¤æ¡ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­å‡ºï¼Œå½“å‰3GBçš„Executor Memoryæ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚é‚£ä¹ˆæˆ‘ä»¬è‡ªç„¶è¦å»è°ƒæ•´ä¸Šé¢çš„3ä¸ªå‚æ•°ï¼Œæ¥åŠ é€ŸSortçš„æ‰§è¡Œæ€§èƒ½ã€‚</p><p><strong>Aggregate</strong></p><p>ä¸Sortç±»ä¼¼ï¼Œè¡¡é‡Aggregateçš„åº¦é‡æŒ‡æ ‡ï¼Œä¸»è¦è®°å½•çš„ä¹Ÿæ˜¯æ“ä½œçš„å†…å­˜æ¶ˆè€—ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/cc/c8/cc4617577712fc0b1619bc2d67cb7fc8.png?wh=776x430\" alt=\"å›¾ç‰‡\" title=\"Aggregate Metrics\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºAggregateæ“ä½œï¼ŒSpark UIä¹Ÿè®°å½•ç€ç£ç›˜æº¢å‡ºä¸å³°å€¼æ¶ˆè€—ï¼Œå³Spill sizeå’ŒPeak memory totalã€‚è¿™ä¸¤ä¸ªæ•°å€¼ä¹Ÿä¸ºå†…å­˜çš„è°ƒæ•´æä¾›äº†ä¾æ®ï¼Œä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œé›¶æº¢å‡ºä¸3.2GBçš„å³°å€¼æ¶ˆè€—ï¼Œè¯æ˜å½“å‰3GBçš„Executor Memoryè®¾ç½®ï¼Œå¯¹äºAggregateè®¡ç®—æ¥è¯´æ˜¯ç»°ç»°æœ‰ä½™çš„ã€‚</p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬åˆ†åˆ«ä»‹ç»äº†Exchangeã€Sortå’ŒAggregateçš„åº¦é‡æŒ‡æ ‡ï¼Œå¹¶ç»“åˆâ€œå€ç‡è®¡ç®—â€çš„ä¾‹å­ï¼Œè¿›è¡Œäº†ç®€å•çš„è°ƒä¼˜åˆ†æã€‚</p><p>çºµè§‚â€œå€ç‡è®¡ç®—â€å®Œæ•´çš„DAGï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒåŒ…å«äº†è‹¥å¹²ä¸ªExchangeã€Sortã€Aggregateä»¥åŠFilterå’ŒProjectã€‚<strong>ç»“åˆä¸Šè¿°çš„å„ç±»Metricsï¼Œå¯¹äºæ‰§è¡Œè®¡åˆ’çš„è§‚å¯Ÿä¸æ´è§ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ç»Ÿç­¹çš„æ–¹å¼ï¼Œç”±ç‚¹åˆ°çº¿ã€ç”±å±€éƒ¨åˆ°å…¨å±€åœ°å»è¿›è¡Œ</strong>ã€‚</p><h4>Jobsè¯¦æƒ…é¡µ</h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥è¯´è¯´Jobsè¯¦æƒ…é¡µã€‚Jobsè¯¦æƒ…é¡µéå¸¸çš„ç®€å•ã€ç›´è§‚ï¼Œå®ƒç½—åˆ—ç€éš¶å±äºå½“å‰Jobçš„æ‰€æœ‰Stagesã€‚è¦æƒ³è®¿é—®æ¯ä¸€ä¸ªStageçš„æ‰§è¡Œç»†èŠ‚ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é€šè¿‡â€œDescriptionâ€çš„è¶…é“¾æ¥åšè·³è½¬ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/9e/f2/9ec76b98622cff2b766dfc097d682af2.png?wh=1920x809\" alt=\"å›¾ç‰‡\" title=\"Jobsè¯¦æƒ…é¡µ\"></p><h4>Stagesè¯¦æƒ…é¡µ</h4><p>å®é™…ä¸Šï¼Œè¦è®¿é—®Stageè¯¦æƒ…ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ç§é€‰æ‹©ï¼Œé‚£å°±æ˜¯ç›´æ¥ä»Stagesä¸€çº§å…¥å£è¿›å…¥ï¼Œç„¶åå®Œæˆè·³è½¬ã€‚å› æ­¤ï¼ŒStageè¯¦æƒ…é¡µä¹Ÿå½’ç±»åˆ°äºŒçº§å…¥å£ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»¥Idä¸º10çš„Stageä¸ºä¾‹ï¼Œå»çœ‹ä¸€çœ‹è¯¦æƒ…é¡µéƒ½è®°å½•ç€å“ªäº›å…³é”®ä¿¡æ¯ã€‚</p><p>åœ¨æ‰€æœ‰äºŒçº§å…¥å£ä¸­ï¼ŒStageè¯¦æƒ…é¡µçš„ä¿¡æ¯é‡å¯ä»¥è¯´æ˜¯æœ€å¤§çš„ã€‚ç‚¹è¿›Stageè¯¦æƒ…é¡µï¼Œå¯ä»¥çœ‹åˆ°å®ƒä¸»è¦åŒ…å«3å¤§ç±»ä¿¡æ¯ï¼Œåˆ†åˆ«æ˜¯Stage DAGã€Event Timelineä¸Task Metricsã€‚</p><p>å…¶ä¸­ï¼ŒTask Metricsåˆåˆ†ä¸ºâ€œSummaryâ€ä¸â€œEntry detailsâ€ä¸¤éƒ¨åˆ†ï¼Œæä¾›ä¸åŒç²’åº¦çš„ä¿¡æ¯æ±‡æ€»ã€‚è€ŒTask Metricsä¸­è®°å½•çš„æŒ‡æ ‡ç±»åˆ«ï¼Œè¿˜å¯ä»¥é€šè¿‡â€œShow Additional Metricsâ€é€‰é¡¹è¿›è¡Œæ‰©å±•ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/61/d9/612b82f355072e03400fd162557967d9.png?wh=1920x1200\" alt=\"å›¾ç‰‡\" title=\"Stageè¯¦æƒ…é¡µæ¦‚è§ˆ\"></p><p><strong>Stage DAG</strong></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ²¿ç€â€œStage DAG -&gt; Event Timeline -&gt; Task Metricsâ€çš„é¡ºåºï¼Œä¾æ¬¡è®²è®²è¿™äº›é¡µé¢æ‰€åŒ…å«çš„å†…å®¹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹æœ€ç®€å•çš„Stage DAGã€‚ç‚¹å¼€è“è‰²çš„â€œDAG Visualizationâ€æŒ‰é’®ï¼Œæˆ‘ä»¬å°±èƒ½è·å–åˆ°å½“å‰Stageçš„DAGï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b4/1b/b4fb2fc255674897cb749b2469e32c1b.png?wh=1920x1200\" alt=\"å›¾ç‰‡\" title=\"Stage DAG\"></p><p>ä¹‹æ‰€ä»¥è¯´Stage DAGç®€å•ï¼Œæ˜¯å› ä¸ºå’±ä»¬åœ¨SQLäºŒçº§å…¥å£ï¼Œå·²ç»å¯¹DAGåšè¿‡è¯¦ç»†çš„è¯´æ˜ã€‚è€ŒStage DAGä»…ä»…æ˜¯SQLé¡µé¢å®Œæ•´DAGçš„ä¸€ä¸ªå­é›†ï¼Œæ¯•ç«Ÿï¼ŒSQLé¡µé¢çš„DAGï¼Œé’ˆå¯¹çš„æ˜¯ä½œä¸šï¼ˆJobï¼‰ã€‚å› æ­¤ï¼Œåªè¦æŒæ¡äº†ä½œä¸šçš„DAGï¼Œè‡ªç„¶ä¹Ÿå°±æŒæ¡äº†æ¯ä¸€ä¸ªStageçš„DAGã€‚</p><p><strong>Event Timeline</strong></p><p>ä¸â€œDAG Visualizationâ€å¹¶åˆ—ï¼Œåœ¨â€œSummary Metricsâ€ä¹‹ä¸Šï¼Œæœ‰ä¸€ä¸ªâ€œEvent Timelineâ€æŒ‰é’®ï¼Œç‚¹å¼€å®ƒï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„å¯è§†åŒ–ä¿¡æ¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/51/0c/51d2218b6f2f25a2a15bc0385f51ee0c.png?wh=1920x1200\" alt=\"å›¾ç‰‡\" title=\"Event Timeline\"></p><p>Event Timelineï¼Œè®°å½•ç€åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ä¸æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸åŒè®¡ç®—ç¯èŠ‚ä¸»è¦çš„æ—¶é—´èŠ±é”€ã€‚å›¾ä¸­çš„æ¯ä¸€ä¸ªæ¡å¸¦ï¼Œéƒ½ä»£è¡¨ç€ä¸€ä¸ªåˆ†å¸ƒå¼ä»»åŠ¡ï¼Œæ¡å¸¦ç”±ä¸åŒçš„é¢œè‰²æ„æˆã€‚å…¶ä¸­ä¸åŒé¢œè‰²çš„çŸ©å½¢ï¼Œä»£è¡¨ä¸åŒç¯èŠ‚çš„è®¡ç®—æ—¶é—´ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œæˆ‘è¿˜æ˜¯ç”¨è¡¨æ ¼å½¢å¼å¸®ä½ æ¢³ç†äº†è¿™äº›ç¯èŠ‚çš„å«ä¹‰ä¸ä½œç”¨ï¼Œä½ å¯ä»¥ä¿å­˜ä»¥åéšæ—¶æŸ¥çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/de/40/de11412fbf47989aeyycd7a1c86e0c40.jpg?wh=1920x949\" alt=\"å›¾ç‰‡\" title=\"ä¸åŒç¯èŠ‚çš„è®¡ç®—æ—¶é—´\"></p><p>ç†æƒ³æƒ…å†µä¸‹ï¼Œæ¡å¸¦çš„å¤§éƒ¨åˆ†åº”è¯¥éƒ½æ˜¯ç»¿è‰²çš„ï¼ˆå¦‚å›¾ä¸­æ‰€ç¤ºï¼‰ï¼Œä¹Ÿå°±æ˜¯ä»»åŠ¡çš„æ—¶é—´æ¶ˆè€—ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯æ‰§è¡Œæ—¶é—´ã€‚ä¸è¿‡ï¼Œå®é™…æƒ…å†µå¹¶ä¸æ€»æ˜¯å¦‚æ­¤ï¼Œæ¯”å¦‚ï¼Œæœ‰äº›æ—¶å€™ï¼Œè“è‰²çš„éƒ¨åˆ†å æ¯”è¾ƒå¤šï¼Œæˆ–æ˜¯æ©™è‰²çš„éƒ¨åˆ†å æ¯”è¾ƒå¤§ã€‚</p><p>åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»“åˆEvent Timelineï¼Œæ¥åˆ¤æ–­ä½œä¸šæ˜¯å¦å­˜åœ¨è°ƒåº¦å¼€é”€è¿‡å¤§ã€æˆ–æ˜¯Shuffleè´Ÿè½½è¿‡é‡çš„é—®é¢˜ï¼Œä»è€Œæœ‰é’ˆå¯¹æ€§åœ°å¯¹ä¸åŒç¯èŠ‚åšè°ƒä¼˜ã€‚</p><p>æ¯”æ–¹è¯´ï¼Œå¦‚æœæ¡å¸¦ä¸­æ·±è“çš„éƒ¨åˆ†ï¼ˆScheduler Delayï¼‰å¾ˆå¤šï¼Œé‚£å°±è¯´æ˜ä»»åŠ¡çš„è°ƒåº¦å¼€é”€å¾ˆé‡ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦å‚è€ƒâ€œä¸‰è¶³é¼ç«‹â€çš„è°ƒä¼˜æŠ€å·§ï¼Œå»ç›¸åº”åœ°è°ƒæ•´CPUã€å†…å­˜ä¸å¹¶è¡Œåº¦ï¼Œä»è€Œå‡ä½ä»»åŠ¡çš„è°ƒåº¦å¼€é”€ã€‚</p><p>å†æ¯”å¦‚ï¼Œå¦‚æœæ¡å¸¦ä¸­é»„è‰²ï¼ˆShuffle Write Timeï¼‰ä¸æ©™è‰²ï¼ˆShuffle Read Timeï¼‰çš„é¢ç§¯è¾ƒå¤§ï¼Œå°±è¯´æ˜ä»»åŠ¡çš„Shuffleè´Ÿè½½å¾ˆé‡ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦è€ƒè™‘ï¼Œæœ‰æ²¡æœ‰å¯èƒ½é€šè¿‡åˆ©ç”¨Broadcast Joinæ¥æ¶ˆé™¤Shuffleï¼Œä»è€Œç¼“è§£ä»»åŠ¡çš„Shuffleè´Ÿæ‹…ã€‚</p><p><strong>Task Metrics</strong></p><p>è¯´å®ŒStage DAGä¸Event Timelineï¼Œæœ€åï¼Œæˆ‘ä»¬å†æ¥è¯´ä¸€è¯´Stageè¯¦æƒ…é¡µçš„é‡å¤´æˆï¼šTask Metricsã€‚</p><p>ä¹‹æ‰€ä»¥è¯´å®ƒæ˜¯é‡å¤´æˆï¼Œåœ¨äºTask Metricsä»¥ä¸åŒçš„ç²’åº¦ï¼Œæä¾›äº†è¯¦å°½çš„é‡åŒ–æŒ‡æ ‡ã€‚å…¶ä¸­ï¼Œâ€œTasksâ€ä»¥Taskä¸ºç²’åº¦ï¼Œè®°å½•ç€æ¯ä¸€ä¸ªåˆ†å¸ƒå¼ä»»åŠ¡çš„æ‰§è¡Œç»†èŠ‚ï¼Œè€Œâ€œSummary Metricsâ€åˆ™æ˜¯å¯¹äºæ‰€æœ‰Tasksæ‰§è¡Œç»†èŠ‚çš„ç»Ÿè®¡æ±‡æ€»ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ç²—ç²’åº¦çš„â€œSummary Metricsâ€ï¼Œç„¶åå†å»å±•å¼€ç»†ç²’åº¦çš„â€œTasksâ€ã€‚</p><p><strong>Summary Metrics</strong></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç‚¹å¼€â€œShow Additional Metricsâ€æŒ‰é’®ï¼Œå‹¾é€‰â€œSelect Allâ€ï¼Œè®©æ‰€æœ‰çš„åº¦é‡æŒ‡æ ‡éƒ½ç”Ÿæ•ˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚è¿™ä¹ˆåšçš„ç›®çš„ï¼Œåœ¨äºè·å–æœ€è¯¦å°½çš„Taskæ‰§è¡Œä¿¡æ¯ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/bf/0a/bf916cabf5de22fbf16bcbda1bfb640a.png?wh=1920x1200\" alt=\"å›¾ç‰‡\" title=\"Summary Metrics\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œâ€œSelect Allâ€ç”Ÿæ•ˆä¹‹åï¼ŒSpark UIæ‰“å°å‡ºäº†æ‰€æœ‰çš„æ‰§è¡Œç»†èŠ‚ã€‚è€è§„çŸ©ï¼Œä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œæˆ‘è¿˜æ˜¯æŠŠè¿™äº›Metricsæ•´ç†åˆ°è¡¨æ ¼ä¸­ï¼Œæ–¹ä¾¿ä½ éšæ—¶æŸ¥é˜…ã€‚å…¶ä¸­ï¼ŒTask Deserialization Timeã€Result Serialization Timeã€Getting Result Timeã€Scheduler Delayä¸åˆšåˆšè¡¨æ ¼ä¸­çš„å«ä¹‰ç›¸åŒï¼Œä¸å†èµ˜è¿°ï¼Œè¿™é‡Œæˆ‘ä»¬ä»…æ•´ç†æ–°å‡ºç°çš„Task Metricsã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c6/d8/c6d49f5ae074078dcfa9bc28619eebd8.jpg?wh=1920x1242\" alt=\"å›¾ç‰‡\" title=\"ä¸åŒç¯èŠ‚çš„è®¡ç®—æ—¶é—´\"></p><p>å¯¹äºè¿™äº›è¯¦å°½çš„Task Metricsï¼Œéš¾èƒ½å¯è´µåœ°ï¼ŒSpark UIä»¥æœ€å¤§æœ€å°ï¼ˆmaxã€minï¼‰ä»¥åŠåˆ†ä½ç‚¹ï¼ˆ25%åˆ†ä½ã€50%åˆ†ä½ã€75%åˆ†ä½ï¼‰çš„æ–¹å¼ï¼Œæä¾›äº†ä¸åŒMetricsçš„ç»Ÿè®¡åˆ†å¸ƒã€‚è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼ŒåŸå› åœ¨äºï¼Œ<strong>è¿™äº›Metricsçš„ç»Ÿè®¡åˆ†å¸ƒï¼Œå¯ä»¥è®©æˆ‘ä»¬éå¸¸æ¸…æ™°åœ°é‡åŒ–ä»»åŠ¡çš„è´Ÿè½½åˆ†å¸ƒ</strong>ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œæ ¹æ®ä¸åŒMetricsçš„ç»Ÿè®¡åˆ†å¸ƒä¿¡æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è½»è€Œæ˜“ä¸¾åœ°åˆ¤å®šï¼Œå½“å‰ä½œä¸šçš„ä¸åŒä»»åŠ¡ä¹‹é—´ï¼Œæ˜¯ç›¸å¯¹å‡è¡¡ï¼Œè¿˜æ˜¯å­˜åœ¨ä¸¥é‡çš„å€¾æ–œã€‚å¦‚æœåˆ¤å®šè®¡ç®—è´Ÿè½½å­˜åœ¨å€¾æ–œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦åˆ©ç”¨â€œæ‰‹å·¥åŠ ç›â€æˆ–æ˜¯AQEçš„è‡ªåŠ¨å€¾æ–œå¤„ç†ï¼Œå»æ¶ˆé™¤ä»»åŠ¡ä¹‹é—´çš„ä¸å‡è¡¡ï¼Œä»è€Œæ”¹å–„ä½œä¸šæ€§èƒ½ã€‚</p><p>åœ¨ä¸Šé¢çš„è¡¨æ ¼ä¸­ï¼Œæœ‰ä¸€åŠçš„Metricsæ˜¯ä¸Shuffleç›´æ¥ç›¸å…³çš„ï¼Œæ¯”å¦‚Shuffle Read Size / Recordsï¼ŒShuffle Remote Readsï¼Œç­‰ç­‰ã€‚</p><p>è¿™äº›Metricsæˆ‘ä»¬åœ¨ä»‹ç»SQLè¯¦æƒ…çš„æ—¶å€™ï¼Œå·²ç»è¯¦ç»†è¯´è¿‡äº†ã€‚å¦å¤–ï¼ŒDurationã€GC Timeã€ä»¥åŠPeak Execution Memoryï¼Œè¿™äº›Metricsçš„å«ä¹‰ï¼Œè¦ä¹ˆå·²ç»è®²è¿‡ï¼Œè¦ä¹ˆè¿‡äºç®€å•ã€æ— éœ€è§£é‡Šã€‚å› æ­¤ï¼Œå¯¹äºè¿™3ä¸ªæŒ‡æ ‡ï¼Œå’±ä»¬ä¹Ÿä¸å†å¤šç€ç¬”å¢¨ã€‚</p><p>è¿™é‡Œç‰¹åˆ«å€¼å¾—ä½ å…³æ³¨çš„ï¼Œæ˜¯<strong>Spillï¼ˆMemoryï¼‰å’ŒSpillï¼ˆDiskï¼‰è¿™ä¸¤ä¸ªæŒ‡æ ‡</strong>ã€‚Spillï¼Œä¹Ÿå³æº¢å‡ºæ•°æ®ï¼Œå®ƒæŒ‡çš„æ˜¯å› å†…å­˜æ•°æ®ç»“æ„ï¼ˆPartitionedPairBufferã€AppendOnlyMapï¼Œç­‰ç­‰ï¼‰ç©ºé—´å—é™ï¼Œè€Œè…¾æŒªå‡ºå»çš„æ•°æ®ã€‚Spillï¼ˆMemoryï¼‰è¡¨ç¤ºçš„æ˜¯ï¼Œè¿™éƒ¨åˆ†æ•°æ®åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å¤§å°ï¼Œè€ŒSpillï¼ˆDiskï¼‰è¡¨ç¤ºçš„æ˜¯ï¼Œè¿™äº›æ•°æ®åœ¨ç£ç›˜ä¸­çš„å¤§å°ã€‚</p><p>å› æ­¤ï¼Œç”¨Spillï¼ˆMemoryï¼‰é™¤ä»¥Spillï¼ˆDiskï¼‰ï¼Œå°±å¯ä»¥å¾—åˆ°â€œæ•°æ®è†¨èƒ€ç³»æ•°â€çš„è¿‘ä¼¼å€¼ï¼Œæˆ‘ä»¬æŠŠå®ƒè®°ä¸º<strong>Explosion ratio</strong>ã€‚æœ‰äº†Explosion ratioï¼Œå¯¹äºä¸€ä»½å­˜å‚¨åœ¨ç£ç›˜ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¼°ç®—å®ƒåœ¨å†…å­˜ä¸­çš„å­˜å‚¨å¤§å°ï¼Œä»è€Œå‡†ç¡®åœ°æŠŠæ¡æ•°æ®çš„å†…å­˜æ¶ˆè€—ã€‚</p><p><strong>Tasks</strong></p><p>ä»‹ç»å®Œç²—ç²’åº¦çš„Summary Metricsï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥è¯´è¯´ç»†ç²’åº¦çš„â€œTasksâ€ã€‚å®é™…ä¸Šï¼ŒTasksçš„ä¸å°‘æŒ‡æ ‡ï¼Œä¸Summaryæ˜¯é«˜åº¦é‡åˆçš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚åŒç†ï¼Œè¿™äº›é‡åˆçš„Metricsï¼Œå’±ä»¬ä¸å†èµ˜è¿°ï¼Œä½ å¯ä»¥å‚è€ƒSummaryçš„éƒ¨åˆ†ï¼Œæ¥ç†è§£è¿™äº›Metricsã€‚å”¯ä¸€çš„åŒºåˆ«ï¼Œå°±æ˜¯è¿™äº›æŒ‡æ ‡æ˜¯é’ˆå¯¹æ¯ä¸€ä¸ªTaskè¿›è¡Œåº¦é‡çš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c2/3b/c23bc53203358611328e656d64c2a43b.png?wh=1920x1200\" alt=\"å›¾ç‰‡\" title=\"Tasksæ‰§è¡Œç»†èŠ‚\"></p><p>æŒ‰ç…§æƒ¯ä¾‹ï¼Œå’±ä»¬è¿˜æ˜¯æŠŠTasksä¸­é‚£äº›æ–°å‡ºç°çš„æŒ‡æ ‡ï¼Œæ•´ç†åˆ°è¡¨æ ¼ä¸­ï¼Œä»¥å¤‡åç»­æŸ¥çœ‹ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/57/82/57182b44ca360239a1b4777458b73982.jpg?wh=1903x744\" alt=\"å›¾ç‰‡\" title=\"Tasksåº¦é‡æŒ‡æ ‡\"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ–°æŒ‡æ ‡å¹¶ä¸å¤šï¼Œè¿™é‡Œæœ€å€¼å¾—å…³æ³¨çš„ï¼Œæ˜¯<strong>Locality level</strong>ï¼Œä¹Ÿå°±æ˜¯æœ¬åœ°æ€§çº§åˆ«ã€‚åœ¨è°ƒåº¦ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬è®²è¿‡ï¼Œæ¯ä¸ªTaskéƒ½æœ‰è‡ªå·±çš„æœ¬åœ°æ€§å€¾å‘ã€‚ç»“åˆæœ¬åœ°æ€§å€¾å‘ï¼Œè°ƒåº¦ç³»ç»Ÿä¼šæŠŠTasksè°ƒåº¦åˆ°åˆé€‚çš„Executorsæˆ–æ˜¯è®¡ç®—èŠ‚ç‚¹ï¼Œå°½å¯èƒ½ä¿è¯â€œæ•°æ®ä¸åŠ¨ã€ä»£ç åŠ¨â€ã€‚</p><p>Logsä¸Errorså±äºSpark UIçš„ä¸‰çº§å…¥å£ï¼Œå®ƒä»¬æ˜¯Tasksçš„æ‰§è¡Œæ—¥å¿—ï¼Œè¯¦ç»†è®°å½•äº†Tasksåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„è¿è¡Œæ—¶çŠ¶æ€ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ·±å…¥åˆ°ä¸‰çº§å…¥å£å»è¿›è¡ŒDebugã€‚Errorsåˆ—æä¾›çš„æŠ¥é”™ä¿¡æ¯ï¼Œå¾€å¾€è¶³ä»¥è®©æˆ‘ä»¬è®¯é€Ÿåœ°å®šä½é—®é¢˜æ‰€åœ¨ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>å¥½å•¦ï¼Œä»Šå¤©çš„è¯¾ç¨‹ï¼Œåˆ°è¿™é‡Œå°±è®²å®Œå•¦ã€‚ä»Šå¤©è¿™ä¸€è®²ï¼Œæˆ‘ä»¬åˆ†åˆ«å­¦ä¹ äº†äºŒçº§å…¥å£çš„SQLã€Jobsä¸Stagesã€‚æ¯ä¸ªäºŒçº§å…¥å£çš„å†…å®¹éƒ½å¾ˆä¸°å¯Œï¼Œæå‰çŸ¥é“å®ƒä»¬æ‰€æ¶µç›–çš„ä¿¡æ¯ï¼Œå¯¹æˆ‘ä»¬å¯»æ‰¾ã€å¯å‘ä¸æ¢ç´¢æ€§èƒ½è°ƒä¼˜çš„æ€è·¯éå¸¸æœ‰å¸®åŠ©ã€‚</p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œå…³äºSpark UIçš„å…¨éƒ¨å†…å®¹å°±è®²å®Œå•¦ã€‚Spark UIæ¶‰åŠçš„Metricsçº·ç¹è€Œåˆå¤æ‚ï¼Œä»…ä»…è·Ÿç€æˆ‘å»ç”¨â€œè‚‰çœ¼â€å­¦ä¹ ä¸€éåªæ˜¯ç¬¬ä¸€æ­¥ï¼Œä¹‹åè¿˜éœ€è¦ä½ ç»“åˆæ—¥å¸¸çš„å¼€å‘ï¼Œå»å¤šå¤šæ‘¸ç´¢ä¸ä½“ä¼šï¼ŒåŠ æ²¹ï¼</p><p>ä¹Ÿæ¬¢è¿ä½ æŠŠSpark UIä½¿ç”¨çš„å¿ƒå¾—ä½“ä¼šï¼Œåˆ†äº«åˆ°è¯¾åçš„è¯„è®ºåŒºï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºï¼Œå…±åŒè¿›æ­¥ï¼</p><p>æœ€åçš„æœ€åï¼Œè¿˜æ˜¯æƒ³æé†’ä½ ï¼Œç”±äºæˆ‘ä»¬çš„åº”ç”¨æ˜¯é€šè¿‡spark-shellæäº¤çš„ï¼Œå› æ­¤èŠ‚ç‚¹8080ç«¯å£çš„Spark UIä¼šä¸€ç›´å±•ç¤ºåº”ç”¨çš„â€œä½“æ£€æŠ¥å‘Šâ€ã€‚åœ¨æˆ‘ä»¬é€€å‡ºspark-shellä¹‹åï¼ŒèŠ‚ç‚¹8080ç«¯å£çš„å†…å­˜ä¹Ÿéšå³æ¶ˆå¤±ï¼ˆ404 Page not foundï¼‰ã€‚</p><p>è¦æƒ³å†æ¬¡æŸ¥çœ‹åº”ç”¨çš„â€œä½“æ£€æŠ¥å‘Šâ€ï¼Œéœ€è¦ç§»æ­¥è‡³èŠ‚ç‚¹çš„18080ç«¯å£ï¼Œè¿™é‡Œæ˜¯Spark History Serverçš„é¢†åœ°ï¼Œå®ƒæ”¶é›†äº†æ‰€æœ‰ï¼ˆå·²æ‰§è¡Œå®Œæ¯•ï¼‰åº”ç”¨çš„â€œä½“æ£€æŠ¥å‘Šâ€ï¼Œå¹¶åŒæ ·ä½¿ç”¨Spark UIçš„å½¢å¼è¿›è¡Œå±•ç¤ºï¼Œåˆ‡è®°åˆ‡è®°ã€‚</p><h2>æ¯è¯¾ä¸€ç»ƒ</h2><p>ä»Šå¤©çš„æ€è€ƒé¢˜ï¼Œéœ€è¦ä½ å‘æ•£æ€ç»´ã€‚å­¦ä¹ è¿‡Spark UIä¹‹åï¼Œè¯·ä½ è¯´ä¸€è¯´ï¼Œéƒ½å¯ä»¥é€šè¿‡å“ªäº›é€”å¾„ï¼Œæ¥å®šä½æ•°æ®å€¾æ–œé—®é¢˜ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå’Œæˆ‘äº¤æµæ¢è®¨ï¼Œä¹Ÿæ¬¢è¿æ¨èä½ æŠŠè¿™ä¸€è®²åˆ†äº«ç»™æœ‰éœ€è¦çš„æœ‹å‹ã€åŒäº‹ã€‚</p>","comments":[{"had_liked":false,"id":338584,"user_name":"Geek_d50b3e","can_delete":false,"product_type":"c1","uid":2815576,"ip_address":"","ucode":"5BB718A8A04258","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL9ia0mXYEzfkZdhOAqnujnQSAcFY4atjHvzLrF2BeKiay1mPqwxHVszmpj0aSNZWSAnT8O2iblMB0SA/132","comment_is_top":true,"comment_ctime":1647577712,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"9.2233720385024e+18","product_id":100073401,"comment_content":"æˆ‘æœ‰ä¸ªé—®é¢˜ã€‚æˆ‘æ˜¯2ä¸ªå¤§è¡¨å…³è”shullfe çš„æ—¶å€™çœ‹åˆ°å¾ˆå¤šexecutoréƒ½æ˜¯ç©ºå°±executor æœ‰æ•°ï¼Œå€¾æ–œäº†æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ","like_count":0},{"had_liked":false,"id":317345,"user_name":"ç‹æ¬¢","can_delete":false,"product_type":"c1","uid":1931030,"ip_address":"","ucode":"A2D5C3AF6F6D7F","user_header":"https://static001.geekbang.org/account/avatar/00/1d/77/16/96ef147f.jpg","comment_is_top":false,"comment_ctime":1634746497,"is_pvip":false,"replies":[{"id":"115129","content":"æ²¡é”™~ æ­£è§£ï¼Œæ»¡åˆ†ğŸ’¯","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634889584,"ip_address":"","comment_id":317345,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14519648385","product_id":100073401,"comment_content":"spark shuffle readä¸­maxå’Œmediançš„æ¯”å€¼å¤§å°ï¼Œå¯ä»¥è¡¡é‡æ•°æ®å€¾æ–œç¨‹åº¦","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528780,"discussion_content":"æ²¡é”™~ æ­£è§£ï¼Œæ»¡åˆ†ğŸ’¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634889584,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317226,"user_name":"onee","can_delete":false,"product_type":"c1","uid":1613204,"ip_address":"","ucode":"48C0A8938548C3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIO6eRuuA6V34kREveXkNaebicNzy3oUvEM3t48ehMRJIuCnYNe9B54VuAndjo1cZZ5ykHDHL8ZlhA/132","comment_is_top":false,"comment_ctime":1634716549,"is_pvip":false,"replies":[{"id":"115115","content":"æ˜¯çš„~ Execution memoryä½¿ç”¨å³°å€¼ï¼Œä¸åŒ…æ‹¬Storage memoryã€‚å¦å¤–ï¼ŒPeak memory Totalæ˜¯æŸä¸€æ—¶åˆ»ï¼Œæ•´ä¸ªé›†ç¾¤åœ¨è¿è¡Œæ—¶çš„å†…å­˜æ¶ˆè€—å³°å€¼ï¼Œä¸æ˜¯æ‰€æœ‰taskçš„å†…å­˜ç”¨é‡ï¼Œä¹Ÿä¸æ˜¯ä½ è¯´çš„â€œæ‰€æœ‰taskçš„å³°å€¼ä¹‹å’Œâ€ã€‚<br><br>ä½ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œä½ æŠŠä¸€ä¸ªJobçš„è¿è¡Œæ—¶é—´ï¼Œçœ‹ä½œæ˜¯æ¨ªåæ ‡ï¼Œçºµåæ ‡ï¼Œæ˜¯æ¯ä¸ªæ—¶åˆ»è¿™ä¸ªJobå¯¹äºé›†ç¾¤å†…å­˜çš„æ¶ˆè€—ã€‚æ¯ä¸ªæ—¶åˆ»æ‰€è¿è¡Œçš„tasksæ•°é‡ï¼Œè‡ªç„¶ä¸æ˜¯æ•´ä¸ªJobçš„æ‰€æœ‰tasksï¼Œè€Œæ˜¯å…¶ä¸€éƒ¨åˆ†ï¼Œä¸€ä¸ªâ€œä¾§åˆ‡é¢â€ã€‚è¿™æ¡æ›²çº¿çš„å³°å€¼ï¼Œå°±æ˜¯è¿™é‡Œçš„Peak memory Total~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634888216,"ip_address":"","comment_id":317226,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14519618437","product_id":100073401,"comment_content":"è€å¸ˆï¼Œæœ‰å‡ ä¸ªç–‘é—®ã€‚Peak memoryæ˜¯å•ä¸ªexecutorå †å†…å­˜çš„ä½¿ç”¨å³°å€¼è¿˜æ˜¯å•executorå†…execution memoryçš„ä½¿ç”¨å³°å€¼ï¼Ÿå…¶æ¬¡ï¼ŒPeak memory Totalæ˜¯stageæ‰€æœ‰taskçš„å³°å€¼ä¹‹å’Œå—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528725,"discussion_content":"æ˜¯çš„~ Execution memoryä½¿ç”¨å³°å€¼ï¼Œä¸åŒ…æ‹¬Storage memoryã€‚å¦å¤–ï¼ŒPeak memory Totalæ˜¯æŸä¸€æ—¶åˆ»ï¼Œæ•´ä¸ªé›†ç¾¤åœ¨è¿è¡Œæ—¶çš„å†…å­˜æ¶ˆè€—å³°å€¼ï¼Œä¸æ˜¯æ‰€æœ‰taskçš„å†…å­˜ç”¨é‡ï¼Œä¹Ÿä¸æ˜¯ä½ è¯´çš„â€œæ‰€æœ‰taskçš„å³°å€¼ä¹‹å’Œâ€ã€‚\n\nä½ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œä½ æŠŠä¸€ä¸ªJobçš„è¿è¡Œæ—¶é—´ï¼Œçœ‹ä½œæ˜¯æ¨ªåæ ‡ï¼Œçºµåæ ‡ï¼Œæ˜¯æ¯ä¸ªæ—¶åˆ»è¿™ä¸ªJobå¯¹äºé›†ç¾¤å†…å­˜çš„æ¶ˆè€—ã€‚æ¯ä¸ªæ—¶åˆ»æ‰€è¿è¡Œçš„tasksæ•°é‡ï¼Œè‡ªç„¶ä¸æ˜¯æ•´ä¸ªJobçš„æ‰€æœ‰tasksï¼Œè€Œæ˜¯å…¶ä¸€éƒ¨åˆ†ï¼Œä¸€ä¸ªâ€œä¾§åˆ‡é¢â€ã€‚è¿™æ¡æ›²çº¿çš„å³°å€¼ï¼Œå°±æ˜¯è¿™é‡Œçš„Peak memory Total~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634888216,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1613204,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIO6eRuuA6V34kREveXkNaebicNzy3oUvEM3t48ehMRJIuCnYNe9B54VuAndjo1cZZ5ykHDHL8ZlhA/132","nickname":"onee","note":"","ucode":"48C0A8938548C3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407008,"discussion_content":"å—¯ï¼Œå°±æ˜¯æŒ‡æŸä¸ªæ—¶åˆ»çš„å†…å­˜æ¶ˆè€—æ€»å’Œå–å³°å€¼ï¼Œè€Œä¸æ˜¯æ¯ä¸ªtaskçš„å³°å€¼ä¹‹å’Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634890665,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":319154,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":2162751,"ip_address":"","ucode":"69234046BFD81B","user_header":"https://static001.geekbang.org/account/avatar/00/21/00/3f/a0f84788.jpg","comment_is_top":false,"comment_ctime":1635645026,"is_pvip":false,"replies":[{"id":"115721","content":"èµğŸ‘ï¼Œæ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€~ ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635687822,"ip_address":"","comment_id":319154,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10225579618","product_id":100073401,"comment_content":"ç£Šå“¥,æœ‰ä¸ªç–‘é—®æƒ³è¦è¯·æ•™ä¸‹,æ‚¨è¯´çš„åˆ°çš„ &quot;Peak memroy,æŸä¸ªJobåœ¨æŸä¸ªæ—¶åˆ»å¯¹äºé›†ç¾¤å†…å­˜çš„æ¶ˆè€—,æ¯”ç„¶è¿™ä¸ªæ—¶åˆ»ä¸ä¼šåŒ…å«æ‰€æœ‰task,è€Œæ˜¯è¿™ä¸ªæ—¶åˆ»æ­£åœ¨runingçš„task&quot; å¯¹äºè¿™ä¸€ç‚¹æˆ‘ä¸ªäººç†è§£ä¸ºé’ˆå¯¹è¿™ä¸ªæ—¶åˆ»å› è¯¥æ˜¯numActiveTasksæœ€å¤§æ—¶æ‰€æ¶ˆè€—çš„å†…å­˜,ä¹Ÿå³é…ç½®å‚æ•°æ‰€ç¤ºæœ€å¤§ä¸º6ä¸ªaxtivetaskæ—¶çš„æ¶ˆè€—peak memoryæ˜¯æœ€å¤§çš„(è¿™ä¸ªç£Šå“¥æˆªå›¾ui ä¸Šçš„é…ç½®executor=2,cores=3,å’Œç£Šå“¥æœ€å¼€å§‹è¡¨æ ¼é‡Œç»™å‡ºçš„executor=3gä¸ä¸€è‡´)<br>å¦‚æœè¿™é‡Œç†è§£æ²¡é”™çš„è¯,é‚£ä¹ˆæ ¹æ®æ¡ˆä¾‹ä¸­peak memory=18.8GBæ¥è¯´,å¯è°ƒæ•´executor.memroy=10G(18.8&#47;6â‰ˆ3.13G,3.13 * 3 = 9.39G,å½“ç„¶è¿™é‡Œæˆ‘çœç•¥äº†Storage,User,Reservedçš„æ¶ˆè€—) æˆ‘ä¸ªäººç†è§£å°±æ˜¯è¿™æ ·çš„,ä¸çŸ¥é“æ˜¯å¦æ­£ç¡®,æ±‚ç£Šå“¥è§£æƒ‘,æ„Ÿè°¢~","like_count":2,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529522,"discussion_content":"èµğŸ‘ï¼Œæ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€~ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635687822,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2410289,"avatar":"https://static001.geekbang.org/account/avatar/00/24/c7/31/6934ac2e.jpg","nickname":"Jack","note":"","ucode":"CD602A6D6F7C36","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":570352,"discussion_content":"è¿™æ ·ä¹Ÿä¸ä¸€å®šexecutorå†…å­˜å‡åŒ€å§ï¼Œè¿™æ ·è®¡ç®—æ²¡å•¥ç”¨å•Šï¼Œæ²¡æœ‰æ¯ä¸€ä¸ªå‚æ•°è¡¨ç¤ºä¸€ä¸ªexecutoræœ€é«˜å†…å­˜ï¼ˆæ‰§è¡Œå’Œç¼“å­˜ï¼‰ä½¿ç”¨çš„å³°å€¼å‘¢ï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651740820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317736,"user_name":"æ•¬å½¦è¾‰","can_delete":false,"product_type":"c1","uid":1029952,"ip_address":"","ucode":"99C18D514673FE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b7/40/979af7cc.jpg","comment_is_top":false,"comment_ctime":1634912030,"is_pvip":false,"replies":[{"id":"115578","content":"å…³äºSpillï¼Œå…¶å®å°±æ˜¯å’±ä»¬åœ¨Shuffleé‚£è®²ï¼Œä»‹ç»çš„ç”ŸæˆShuffleä¸­é—´æ–‡ä»¶çš„è¿‡ç¨‹ã€‚åœ¨Mapé˜¶æ®µï¼ŒSparkå…ˆå¾€å†…å­˜æ•°æ®ç»“æ„é‡Œé¢å†™ï¼Œå†™ä¸ä¸‹äº†ï¼Œå°±Spillåˆ°ç£ç›˜çš„ä¸´æ—¶æ–‡ä»¶ã€‚<br><br>Spillæ•°æ®åœ¨å†…å­˜ä¸­çš„æ€»å°ºå¯¸ï¼Œå°±æ˜¯Spillï¼ˆMemory)ï¼Œåœ¨ç£ç›˜ä¸­çš„æ€»å¤§å°ï¼Œå°±æ˜¯Spillï¼ˆDiskï¼‰ã€‚å…¶å®ä¸ç®¡å†…å­˜è®¾ç½®å¤šå¤§ï¼ŒSpilléƒ½æ˜¯éš¾å…çš„ï¼Œè¿™å€’æ²¡ä»€ä¹ˆå¯æ€•çš„ã€‚<br><br>æ‰€ä»¥è¯´å†…å­˜ä¸å¤Ÿå¤§ï¼Œä¸æ˜¯é—®é¢˜ï¼Œé—®é¢˜æ˜¯CPUã€å†…å­˜ã€æ•°æ®ä¸‰è€…æ˜¯ä¸æ˜¯å¹³è¡¡ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œè¿™ä¸€éƒ¨åˆ†å¯ä»¥å‚è€ƒâ€œä¸‰è¶³é¼ç«‹â€çš„è°ƒä¼˜æ–¹æ³•å»å¹³è¡¡ã€‚å†æœ‰ä¸€ä¸ªæ€è·¯ï¼Œå°±æ˜¯æŠŠShuffleå¹²æ‰ï¼Œè‡ªç„¶å°±æ²¡æœ‰Spilläº†ï¼Œå¹²æ‰Shuffleçš„æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒBroadcast Joinã€‚å†æœ‰ï¼Œå³ä¾¿å¹²ä¸æ‰Shuffleï¼Œè¿˜å¯ä»¥ç”¨â€œèƒ½çœåˆ™çœã€èƒ½æ‹–åˆ™æ‹–â€çš„åŠæ³•ï¼Œå‡å°‘éœ€è¦Shuffleçš„æ•°æ®é‡~<br><br>åŠæ³•å…¶å®æœ‰å¾ˆå¤šï¼Œéƒ½å†™åœ¨å’±ä»¬ä¸“æ çš„ä¸åŒè¯¾ç¨‹é‡Œå•¦~","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635426652,"ip_address":"","comment_id":317736,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5929879326","product_id":100073401,"comment_content":"Spillï¼ˆMemoryï¼‰å’Œ Spillï¼ˆDiskï¼‰è¿™ä¸¤ä¸ªæŒ‡æ ‡è¿˜æ˜¯ä¸å¤ªæ¸…æ¥šï¼Œä¹‹å‰é‡åˆ°è¿‡ä¸€ä¸ªä»»åŠ¡ï¼Œæœ€å¤§æ‰§è¡Œæ—¶é—´çš„taskï¼Œå®ƒçš„Spill(Memory)æœ‰3gï¼ŒSpill(Disk)åªæœ‰200mï¼Œè¿™äº›æ•°æ®æ˜¯å†…å­˜å­˜äº†3gï¼Œå†…å­˜å­˜ä¸ä¸‹åˆæº¢å‡ºåˆ°ç£ç›˜å—ï¼Ÿè¿™ç§åœºæ™¯è¯¥æ€ä¹ˆä¼˜åŒ–ï¼Œè€å¸ˆå¸®å¿™ç»™è§£ç­”ä¸‹","like_count":1,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528949,"discussion_content":"å…³äºSpillï¼Œå…¶å®å°±æ˜¯å’±ä»¬åœ¨Shuffleé‚£è®²ï¼Œä»‹ç»çš„ç”ŸæˆShuffleä¸­é—´æ–‡ä»¶çš„è¿‡ç¨‹ã€‚åœ¨Mapé˜¶æ®µï¼ŒSparkå…ˆå¾€å†…å­˜æ•°æ®ç»“æ„é‡Œé¢å†™ï¼Œå†™ä¸ä¸‹äº†ï¼Œå°±Spillåˆ°ç£ç›˜çš„ä¸´æ—¶æ–‡ä»¶ã€‚\n\nSpillæ•°æ®åœ¨å†…å­˜ä¸­çš„æ€»å°ºå¯¸ï¼Œå°±æ˜¯Spillï¼ˆMemory)ï¼Œåœ¨ç£ç›˜ä¸­çš„æ€»å¤§å°ï¼Œå°±æ˜¯Spillï¼ˆDiskï¼‰ã€‚å…¶å®ä¸ç®¡å†…å­˜è®¾ç½®å¤šå¤§ï¼ŒSpilléƒ½æ˜¯éš¾å…çš„ï¼Œè¿™å€’æ²¡ä»€ä¹ˆå¯æ€•çš„ã€‚\n\næ‰€ä»¥è¯´å†…å­˜ä¸å¤Ÿå¤§ï¼Œä¸æ˜¯é—®é¢˜ï¼Œé—®é¢˜æ˜¯CPUã€å†…å­˜ã€æ•°æ®ä¸‰è€…æ˜¯ä¸æ˜¯å¹³è¡¡ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œè¿™ä¸€éƒ¨åˆ†å¯ä»¥å‚è€ƒâ€œä¸‰è¶³é¼ç«‹â€çš„è°ƒä¼˜æ–¹æ³•å»å¹³è¡¡ã€‚å†æœ‰ä¸€ä¸ªæ€è·¯ï¼Œå°±æ˜¯æŠŠShuffleå¹²æ‰ï¼Œè‡ªç„¶å°±æ²¡æœ‰Spilläº†ï¼Œå¹²æ‰Shuffleçš„æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒBroadcast Joinã€‚å†æœ‰ï¼Œå³ä¾¿å¹²ä¸æ‰Shuffleï¼Œè¿˜å¯ä»¥ç”¨â€œèƒ½çœåˆ™çœã€èƒ½æ‹–åˆ™æ‹–â€çš„åŠæ³•ï¼Œå‡å°‘éœ€è¦Shuffleçš„æ•°æ®é‡~\n\nåŠæ³•å…¶å®æœ‰å¾ˆå¤šï¼Œéƒ½å†™åœ¨å’±ä»¬ä¸“æ çš„ä¸åŒè¯¾ç¨‹é‡Œå•¦~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635426652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1051904,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PNmB3mOQ4jTSoDMGPwp5j8a2NL1Mibu4iaebBNnuDQltb2yZ3sygJpxTHuLrG9ewCDLEialorSK3pzXBCQ3JFCZPA/132","nickname":"æœå­","note":"","ucode":"0A669B6DE26F21","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":409301,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635412883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348693,"user_name":"Geek_6048ff","can_delete":false,"product_type":"c1","uid":2184550,"ip_address":"","ucode":"8C76764575A937","user_header":"https://static001.geekbang.org/account/avatar/00/21/55/66/8cc4ee54.jpg","comment_is_top":false,"comment_ctime":1655304074,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655304074","product_id":100073401,"comment_content":"Event Timelineä¸­ç©ºç™½æ¯”è¾ƒå¤šæ˜¯ä»£è¡¨å•¥æ„æ€å‘€","like_count":0},{"had_liked":false,"id":348557,"user_name":"ã€†ã€ç»´ç”Ÿç´ ã‚","can_delete":false,"product_type":"c1","uid":1230071,"ip_address":"","ucode":"7A2AB5A26F0F49","user_header":"https://static001.geekbang.org/account/avatar/00/12/c4/f7/3cff78f1.jpg","comment_is_top":false,"comment_ctime":1655195028,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655195028","product_id":100073401,"comment_content":"æ‚¨å¥½ï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œstageä¸Šçš„taskæ•°é‡å¯ä»¥ç²¾ç¡®è®¡ç®—å‡ºæ¥å—ï¼Ÿæˆ‘çš„task readæ˜¯ç©º ä¼šæ˜¯å•¥åŸå› å‘€<br><br>","like_count":0},{"had_liked":false,"id":318066,"user_name":"Sean","can_delete":false,"product_type":"c1","uid":2162751,"ip_address":"","ucode":"69234046BFD81B","user_header":"https://static001.geekbang.org/account/avatar/00/21/00/3f/a0f84788.jpg","comment_is_top":false,"comment_ctime":1635138379,"is_pvip":false,"replies":[{"id":"115464","content":"è¿™ä¸ªå°±è¹Šè··äº†ï¼Œæœ‰ä»»åŠ¡çš„ä¸Šä¸‹æ–‡å—ï¼Ÿå‘å‡ºæ¥ä¸€èµ·çœ‹çœ‹~<br>ä½ è¯´çš„Peak Execution Memoryä¸º0ï¼Œæ˜¯æ•´ä¸ªé›†ç¾¤ï¼Œè¿˜æ˜¯by taskçš„å„ç§quantileå€¼ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1635260777,"ip_address":"","comment_id":318066,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1635138379","product_id":100073401,"comment_content":"é—®ä¸‹ç£Šå“¥,å‘ç°æœ‰çš„ä»»åŠ¡Peak Execution Memoryä¸º0è¿™ç§æƒ…å†µä¼šæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´å‘¢?ä»»åŠ¡æ‰§è¡Œå€’æ˜¯æ­£å¸¸","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":529087,"discussion_content":"è¿™ä¸ªå°±è¹Šè··äº†ï¼Œæœ‰ä»»åŠ¡çš„ä¸Šä¸‹æ–‡å—ï¼Ÿå‘å‡ºæ¥ä¸€èµ·çœ‹çœ‹~\nä½ è¯´çš„Peak Execution Memoryä¸º0ï¼Œæ˜¯æ•´ä¸ªé›†ç¾¤ï¼Œè¿˜æ˜¯by taskçš„å„ç§quantileå€¼ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635260777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2162751,"avatar":"https://static001.geekbang.org/account/avatar/00/21/00/3f/a0f84788.jpg","nickname":"Sean","note":"","ucode":"69234046BFD81B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":410245,"discussion_content":"sqlæ ‡ç­¾é‡Œé¢çš„æœ‰æŸ¥çœ‹åˆ°,Summary Metricsæ˜¾ç¤ºä¸º0,æ„Ÿè§‰æ˜¯bug,è°¢è°¢è§£ç­”,å˜»å˜»å˜»~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635642989,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317247,"user_name":"onee","can_delete":false,"product_type":"c1","uid":1613204,"ip_address":"","ucode":"48C0A8938548C3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIO6eRuuA6V34kREveXkNaebicNzy3oUvEM3t48ehMRJIuCnYNe9B54VuAndjo1cZZ5ykHDHL8ZlhA/132","comment_is_top":false,"comment_ctime":1634720190,"is_pvip":false,"replies":[{"id":"115127","content":"å¯¹ï¼ŒExecution memory","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634889568,"ip_address":"","comment_id":317247,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634720190","product_id":100073401,"comment_content":"è€å¸ˆï¼Œsparksqlæ‰§è¡Œè®¡åˆ’é¡µä¸­çš„peak memory total(min,mid,max)ï¼ŒæŒ‡çš„æ˜¯peak execution memoryå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528732,"discussion_content":"å¯¹ï¼ŒExecution memory","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634889568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":317122,"user_name":"ç‹—å“­","can_delete":false,"product_type":"c1","uid":2725399,"ip_address":"","ucode":"56E48A6FC1298A","user_header":"https://static001.geekbang.org/account/avatar/00/29/96/17/200c21f0.jpg","comment_is_top":false,"comment_ctime":1634692212,"is_pvip":false,"replies":[{"id":"114890","content":"æ¬ çš„å€ºè¿Ÿæ—©æ˜¯è¦è¿˜çš„ï¼Œå“ˆå“ˆ","user_name":"ä½œè€…å›å¤","user_name_real":"å´ç£Š","uid":"1043100","ctime":1634706551,"ip_address":"","comment_id":317122,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634692212","product_id":100073401,"comment_content":"è€å¸ˆå¤ªç»™åŠ›äº†","like_count":0,"discussions":[{"author":{"id":1043100,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ea/9c/230061e7.jpg","nickname":"å´ç£Š","note":"","ucode":"136DC8CF1B10DC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528667,"discussion_content":"æ¬ çš„å€ºè¿Ÿæ—©æ˜¯è¦è¿˜çš„ï¼Œå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634706551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}