{"id":67968,"title":"07 | ä¸ºä»€ä¹ˆè¯´MapReduceæ—¢æ˜¯ç¼–ç¨‹æ¨¡å‹åˆæ˜¯è®¡ç®—æ¡†æ¶ï¼Ÿ","content":"<p>åœ¨Hadoopé—®ä¸–ä¹‹å‰ï¼Œå…¶å®å·²ç»æœ‰äº†åˆ†å¸ƒå¼è®¡ç®—ï¼Œåªæ˜¯é‚£ä¸ªæ—¶å€™çš„åˆ†å¸ƒå¼è®¡ç®—éƒ½æ˜¯ä¸“ç”¨çš„ç³»ç»Ÿï¼Œåªèƒ½ä¸“é—¨å¤„ç†æŸä¸€ç±»è®¡ç®—ï¼Œæ¯”å¦‚è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ’åºã€‚å¾ˆæ˜¾ç„¶ï¼Œè¿™æ ·çš„ç³»ç»Ÿæ— æ³•å¤ç”¨åˆ°å…¶ä»–çš„å¤§æ•°æ®è®¡ç®—åœºæ™¯ï¼Œæ¯ä¸€ç§åº”ç”¨éƒ½éœ€è¦å¼€å‘ä¸ç»´æŠ¤ä¸“é—¨çš„ç³»ç»Ÿã€‚è€ŒHadoop  MapReduceçš„å‡ºç°ï¼Œä½¿å¾—å¤§æ•°æ®è®¡ç®—é€šç”¨ç¼–ç¨‹æˆä¸ºå¯èƒ½ã€‚æˆ‘ä»¬åªè¦éµå¾ªMapReduceç¼–ç¨‹æ¨¡å‹ç¼–å†™ä¸šåŠ¡å¤„ç†é€»è¾‘ä»£ç ï¼Œå°±å¯ä»¥è¿è¡Œåœ¨Hadoopåˆ†å¸ƒå¼é›†ç¾¤ä¸Šï¼Œæ— éœ€å…³å¿ƒåˆ†å¸ƒå¼è®¡ç®—æ˜¯å¦‚ä½•å®Œæˆçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦å…³å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œä¸ç”¨å…³å¿ƒç³»ç»Ÿè°ƒç”¨ä¸è¿è¡Œç¯å¢ƒï¼Œè¿™å’Œæˆ‘ä»¬ç›®å‰çš„ä¸»æµå¼€å‘æ–¹å¼æ˜¯ä¸€è‡´çš„ã€‚</p><p>è¯·ä½ å…ˆå›å¿†ä¸€ä¸‹ï¼Œåœ¨å‰é¢<a href=\"http://time.geekbang.org/column/article/65106\">ä¸“æ ç¬¬4æœŸ</a>æˆ‘ä»¬è®¨è®ºè¿‡ï¼Œå¤§æ•°æ®è®¡ç®—çš„æ ¸å¿ƒæ€è·¯æ˜¯ç§»åŠ¨è®¡ç®—æ¯”ç§»åŠ¨æ•°æ®æ›´åˆ’ç®—ã€‚æ—¢ç„¶è®¡ç®—æ–¹æ³•è·Ÿä¼ ç»Ÿè®¡ç®—æ–¹æ³•ä¸ä¸€æ ·ï¼Œç§»åŠ¨è®¡ç®—è€Œä¸æ˜¯ç§»åŠ¨æ•°æ®ï¼Œé‚£ä¹ˆç”¨ä¼ ç»Ÿçš„ç¼–ç¨‹æ¨¡å‹è¿›è¡Œå¤§æ•°æ®è®¡ç®—å°±ä¼šé‡åˆ°å¾ˆå¤šå›°éš¾ï¼Œå› æ­¤Hadoopå¤§æ•°æ®è®¡ç®—ä½¿ç”¨äº†ä¸€ç§å«ä½œMapReduceçš„ç¼–ç¨‹æ¨¡å‹ã€‚</p><p>å…¶å®MapReduceç¼–ç¨‹æ¨¡å‹å¹¶ä¸æ˜¯HadoopåŸåˆ›ï¼Œç”šè‡³ä¹Ÿä¸æ˜¯GoogleåŸåˆ›ï¼Œä½†æ˜¯Googleå’ŒHadoopåˆ›é€ æ€§åœ°å°†MapReduceç¼–ç¨‹æ¨¡å‹ç”¨åˆ°å¤§æ•°æ®è®¡ç®—ä¸Šï¼Œç«‹åˆ»äº§ç”Ÿäº†ç¥å¥‡çš„æ•ˆæœï¼Œçœ‹ä¼¼å¤æ‚çš„å„ç§å„æ ·çš„æœºå™¨å­¦ä¹ ã€æ•°æ®æŒ–æ˜ã€SQLå¤„ç†ç­‰å¤§æ•°æ®è®¡ç®—å˜å¾—ç®€å•æ¸…æ™°èµ·æ¥ã€‚</p><!-- [[[read_end]]] --><p>ä»Šå¤©æˆ‘ä»¬å°±æ¥èŠèŠ<span class=\"orange\">Hadoopè§£å†³å¤§è§„æ¨¡æ•°æ®åˆ†å¸ƒå¼è®¡ç®—çš„æ–¹æ¡ˆâ€”â€”MapReduce</span>ã€‚</p><p>åœ¨æˆ‘çœ‹æ¥ï¼Œ<strong>MapReduceæ—¢æ˜¯ä¸€ä¸ªç¼–ç¨‹æ¨¡å‹ï¼Œåˆæ˜¯ä¸€ä¸ªè®¡ç®—æ¡†æ¶</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¼€å‘äººå‘˜å¿…é¡»åŸºäºMapReduceç¼–ç¨‹æ¨¡å‹è¿›è¡Œç¼–ç¨‹å¼€å‘ï¼Œç„¶åå°†ç¨‹åºé€šè¿‡MapReduceè®¡ç®—æ¡†æ¶åˆ†å‘åˆ°Hadoopé›†ç¾¤ä¸­è¿è¡Œã€‚æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹ä½œä¸ºç¼–ç¨‹æ¨¡å‹çš„MapReduceã€‚</p><p>ä¸ºä»€ä¹ˆè¯´MapReduceæ˜¯ä¸€ç§éå¸¸ç®€å•åˆéå¸¸å¼ºå¤§çš„ç¼–ç¨‹æ¨¡å‹ï¼Ÿ</p><p>ç®€å•åœ¨äºå…¶ç¼–ç¨‹æ¨¡å‹åªåŒ…å«Mapå’ŒReduceä¸¤ä¸ªè¿‡ç¨‹ï¼Œmapçš„ä¸»è¦è¾“å…¥æ˜¯ä¸€å¯¹&lt;Key, Value&gt;å€¼ï¼Œç»è¿‡mapè®¡ç®—åè¾“å‡ºä¸€å¯¹&lt;Key, Value&gt;å€¼ï¼›ç„¶åå°†ç›¸åŒKeyåˆå¹¶ï¼Œå½¢æˆ&lt;Key, Valueé›†åˆ&gt;ï¼›å†å°†è¿™ä¸ª&lt;Key, Valueé›†åˆ&gt;è¾“å…¥reduceï¼Œç»è¿‡è®¡ç®—è¾“å‡ºé›¶ä¸ªæˆ–å¤šä¸ª&lt;Key, Value&gt;å¯¹ã€‚</p><p>åŒæ—¶ï¼ŒMapReduceåˆæ˜¯éå¸¸å¼ºå¤§çš„ï¼Œä¸ç®¡æ˜¯å…³ç³»ä»£æ•°è¿ç®—ï¼ˆSQLè®¡ç®—ï¼‰ï¼Œè¿˜æ˜¯çŸ©é˜µè¿ç®—ï¼ˆå›¾è®¡ç®—ï¼‰ï¼Œå¤§æ•°æ®é¢†åŸŸå‡ ä¹æ‰€æœ‰çš„è®¡ç®—éœ€æ±‚éƒ½å¯ä»¥é€šè¿‡MapReduceç¼–ç¨‹æ¥å®ç°ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¥WordCountç¨‹åºä¸ºä¾‹ï¼Œä¸€èµ·æ¥çœ‹ä¸‹MapReduceçš„è®¡ç®—è¿‡ç¨‹ã€‚</p><p>WordCountä¸»è¦è§£å†³çš„æ˜¯æ–‡æœ¬å¤„ç†ä¸­è¯é¢‘ç»Ÿè®¡çš„é—®é¢˜ï¼Œå°±æ˜¯ç»Ÿè®¡æ–‡æœ¬ä¸­æ¯ä¸€ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°ã€‚å¦‚æœåªæ˜¯ç»Ÿè®¡ä¸€ç¯‡æ–‡ç« çš„è¯é¢‘ï¼Œå‡ åKBåˆ°å‡ MBçš„æ•°æ®ï¼Œåªéœ€è¦å†™ä¸€ä¸ªç¨‹åºï¼Œå°†æ•°æ®è¯»å…¥å†…å­˜ï¼Œå»ºä¸€ä¸ªHashè¡¨è®°å½•æ¯ä¸ªè¯å‡ºç°çš„æ¬¡æ•°å°±å¯ä»¥äº†ã€‚è¿™ä¸ªç»Ÿè®¡è¿‡ç¨‹ä½ å¯ä»¥çœ‹ä¸‹é¢è¿™å¼ å›¾ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/fc/1d/fc8d1ca01c9a81bb75c16dcd504c281d.png?wh=846*218\" alt=\"\"></p><p>å¦‚æœç”¨Pythonè¯­è¨€ï¼Œå•æœºå¤„ç†WordCountçš„ä»£ç æ˜¯è¿™æ ·çš„ã€‚</p><pre><code># æ–‡æœ¬å‰æœŸå¤„ç†\nstrl_ist = str.replace('\\n', '').lower().split(' ')\ncount_dict = {}\n# å¦‚æœå­—å…¸é‡Œæœ‰è¯¥å•è¯åˆ™åŠ 1ï¼Œå¦åˆ™æ·»åŠ å…¥å­—å…¸\nfor str in strl_ist:\nif str in count_dict.keys():\n    count_dict[str] = count_dict[str] + 1\n    else:\n        count_dict[str] = 1\n</code></pre><p>ç®€å•è¯´æ¥ï¼Œå°±æ˜¯å»ºä¸€ä¸ªHashè¡¨ï¼Œç„¶åå°†å­—ç¬¦ä¸²é‡Œçš„æ¯ä¸ªè¯æ”¾åˆ°è¿™ä¸ªHashè¡¨é‡Œã€‚å¦‚æœè¿™ä¸ªè¯ç¬¬ä¸€æ¬¡æ”¾åˆ°Hashè¡¨ï¼Œå°±æ–°å»ºä¸€ä¸ªKeyã€Valueå¯¹ï¼ŒKeyæ˜¯è¿™ä¸ªè¯ï¼ŒValueæ˜¯1ã€‚å¦‚æœHashè¡¨é‡Œå·²ç»æœ‰è¿™ä¸ªè¯äº†ï¼Œé‚£ä¹ˆå°±ç»™è¿™ä¸ªè¯çš„Value  +  1ã€‚</p><p>å°æ•°æ®é‡ç”¨å•æœºç»Ÿè®¡è¯é¢‘å¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœæƒ³ç»Ÿè®¡å…¨ä¸–ç•Œäº’è”ç½‘æ‰€æœ‰ç½‘é¡µï¼ˆæ•°ä¸‡äº¿è®¡ï¼‰çš„è¯é¢‘æ•°ï¼ˆè€Œè¿™æ­£æ˜¯Googleè¿™æ ·çš„æœç´¢å¼•æ“çš„å…¸å‹éœ€æ±‚ï¼‰ï¼Œä¸å¯èƒ½å†™ä¸€ä¸ªç¨‹åºæŠŠå…¨ä¸–ç•Œçš„ç½‘é¡µéƒ½è¯»å…¥å†…å­˜ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨MapReduceç¼–ç¨‹æ¥è§£å†³ã€‚</p><p>WordCountçš„MapReduceç¨‹åºå¦‚ä¸‹ã€‚</p><pre><code>public class WordCount {\n\n  public static class TokenizerMapper\n       extends Mapper&lt;Object, Text, Text, IntWritable&gt;{\n\n    private final static IntWritable one = new IntWritable(1);\n    private Text word = new Text();\n\n    public void map(Object key, Text value, Context context\n                    ) throws IOException, InterruptedException {\n      StringTokenizer itr = new StringTokenizer(value.toString());\n      while (itr.hasMoreTokens()) {\n        word.set(itr.nextToken());\n        context.write(word, one);\n      }\n    }\n  }\n\n  public static class IntSumReducer\n       extends Reducer&lt;Text,IntWritable,Text,IntWritable&gt; {\n    private IntWritable result = new IntWritable();\n\n    public void reduce(Text key, Iterable&lt;IntWritable&gt; values,\n                       Context context\n                       ) throws IOException, InterruptedException {\n      int sum = 0;\n      for (IntWritable val : values) {\n        sum += val.get();\n      }\n      result.set(sum);\n      context.write(key, result);\n    }\n  }\n}\n</code></pre><p>ä½ å¯ä»¥ä»è¿™æ®µä»£ç ä¸­çœ‹åˆ°ï¼ŒMapReduceç‰ˆæœ¬WordCountç¨‹åºçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªmapå‡½æ•°å’Œä¸€ä¸ªreduceå‡½æ•°ã€‚</p><p>mapå‡½æ•°çš„è¾“å…¥ä¸»è¦æ˜¯ä¸€ä¸ª&lt;Key, Value&gt;å¯¹ï¼Œåœ¨è¿™ä¸ªä¾‹å­é‡Œï¼ŒValueæ˜¯è¦ç»Ÿè®¡çš„æ‰€æœ‰æ–‡æœ¬ä¸­çš„ä¸€è¡Œæ•°æ®ï¼ŒKeyåœ¨ä¸€èˆ¬è®¡ç®—ä¸­éƒ½ä¸ä¼šç”¨åˆ°ã€‚</p><pre><code>public void map(Object key, Text value, Context context\n                    )\n</code></pre><p>mapå‡½æ•°çš„è®¡ç®—è¿‡ç¨‹æ˜¯ï¼Œå°†è¿™è¡Œæ–‡æœ¬ä¸­çš„å•è¯æå–å‡ºæ¥ï¼Œé’ˆå¯¹æ¯ä¸ªå•è¯è¾“å‡ºä¸€ä¸ª&lt;word,  1&gt;è¿™æ ·çš„&lt;Key, Value&gt;å¯¹ã€‚</p><p>MapReduceè®¡ç®—æ¡†æ¶ä¼šå°†è¿™äº›&lt;word , 1&gt;æ”¶é›†èµ·æ¥ï¼Œå°†ç›¸åŒçš„wordæ”¾åœ¨ä¸€èµ·ï¼Œå½¢æˆ&lt;word , &lt;1,1,1,1,1,1,1â€¦&gt;&gt;è¿™æ ·çš„&lt;Key, Valueé›†åˆ&gt;æ•°æ®ï¼Œç„¶åå°†å…¶è¾“å…¥ç»™reduceå‡½æ•°ã€‚</p><pre><code>public void reduce(Text key, Iterable&lt;IntWritable&gt; values,\n                       Context context\n                       ) \n</code></pre><p>è¿™é‡Œreduceçš„è¾“å…¥å‚æ•°Valueså°±æ˜¯ç”±å¾ˆå¤šä¸ª1ç»„æˆçš„é›†åˆï¼Œè€ŒKeyå°±æ˜¯å…·ä½“çš„å•è¯wordã€‚</p><p>reduceå‡½æ•°çš„è®¡ç®—è¿‡ç¨‹æ˜¯ï¼Œå°†è¿™ä¸ªé›†åˆé‡Œçš„1æ±‚å’Œï¼Œå†å°†å•è¯ï¼ˆwordï¼‰å’Œè¿™ä¸ªå’Œï¼ˆsumï¼‰ç»„æˆä¸€ä¸ª&lt;Key, Value&gt;ï¼Œä¹Ÿå°±æ˜¯&lt;word, sum&gt;è¾“å‡ºã€‚æ¯ä¸€ä¸ªè¾“å‡ºå°±æ˜¯ä¸€ä¸ªå•è¯å’Œå®ƒçš„è¯é¢‘ç»Ÿè®¡æ€»å’Œã€‚</p><p>ä¸€ä¸ªmapå‡½æ•°å¯ä»¥é’ˆå¯¹ä¸€éƒ¨åˆ†æ•°æ®è¿›è¡Œè¿ç®—ï¼Œè¿™æ ·å°±å¯ä»¥å°†ä¸€ä¸ªå¤§æ•°æ®åˆ‡åˆ†æˆå¾ˆå¤šå—ï¼ˆè¿™ä¹Ÿæ­£æ˜¯HDFSæ‰€åšçš„ï¼‰ï¼ŒMapReduceè®¡ç®—æ¡†æ¶ä¸ºæ¯ä¸ªæ•°æ®å—åˆ†é…ä¸€ä¸ªmapå‡½æ•°å»è®¡ç®—ï¼Œä»è€Œå®ç°å¤§æ•°æ®çš„åˆ†å¸ƒå¼è®¡ç®—ã€‚</p><p>å‡è®¾æœ‰ä¸¤ä¸ªæ•°æ®å—çš„æ–‡æœ¬æ•°æ®éœ€è¦è¿›è¡Œè¯é¢‘ç»Ÿè®¡ï¼ŒMapReduceè®¡ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/55/ba/5571ed29c5c2254520052adceadf9cba.png?wh=1378*298\" alt=\"\"></p><p>ä»¥ä¸Šå°±æ˜¯MapReduceç¼–ç¨‹æ¨¡å‹çš„ä¸»è¦è®¡ç®—è¿‡ç¨‹å’ŒåŸç†ï¼Œä½†æ˜¯è¿™æ ·ä¸€ä¸ªMapReduceç¨‹åºè¦æƒ³åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­æ‰§è¡Œï¼Œå¹¶å¤„ç†æµ·é‡çš„å¤§è§„æ¨¡æ•°æ®ï¼Œè¿˜éœ€è¦ä¸€ä¸ªè®¡ç®—æ¡†æ¶ï¼Œèƒ½å¤Ÿè°ƒåº¦æ‰§è¡Œè¿™ä¸ªMapReduceç¨‹åºï¼Œä½¿å®ƒåœ¨åˆ†å¸ƒå¼çš„é›†ç¾¤ä¸­å¹¶è¡Œè¿è¡Œï¼Œè€Œè¿™ä¸ªè®¡ç®—æ¡†æ¶ä¹Ÿå«MapReduceã€‚</p><p>æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬è¯´MapReduceçš„æ—¶å€™ï¼Œå¯èƒ½æŒ‡ç¼–ç¨‹æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªMapReduceç¨‹åºï¼›ä¹Ÿå¯èƒ½æ˜¯æŒ‡è®¡ç®—æ¡†æ¶ï¼Œè°ƒåº¦æ‰§è¡Œå¤§æ•°æ®çš„åˆ†å¸ƒå¼è®¡ç®—ã€‚å…³äºMapReduceè®¡ç®—æ¡†æ¶ï¼Œæˆ‘ä»¬ä¸‹æœŸå†è¯¦ç»†èŠã€‚</p><h2>å°ç»“</h2><p>æ€»ç»“ä¸€ä¸‹ï¼Œä»Šå¤©æˆ‘ä»¬å­¦ä¹ äº†MapReduceç¼–ç¨‹æ¨¡å‹ã€‚è¿™ä¸ªæ¨¡å‹æ—¢ç®€å•åˆå¼ºå¤§ï¼Œç®€å•æ˜¯å› ä¸ºå®ƒåªåŒ…å«Mapå’ŒReduceä¸¤ä¸ªè¿‡ç¨‹ï¼Œå¼ºå¤§ä¹‹å¤„åˆåœ¨äºå®ƒå¯ä»¥å®ç°å¤§æ•°æ®é¢†åŸŸå‡ ä¹æ‰€æœ‰çš„è®¡ç®—éœ€æ±‚ã€‚è¿™ä¹Ÿæ­£æ˜¯MapReduceè¿™ä¸ªæ¨¡å‹ä»¤äººç€è¿·çš„åœ°æ–¹ã€‚</p><p>è¯´èµ·æ¨¡å‹ï¼Œæˆ‘æƒ³è·Ÿä½ èŠèŠæˆ‘çš„ä½“ä¼šã€‚</p><p>æ¨¡å‹æ˜¯äººä»¬å¯¹ä¸€ç±»äº‹ç‰©çš„æ¦‚æ‹¬ä¸æŠ½è±¡ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£äº‹ç‰©çš„æœ¬è´¨ï¼Œæ›´æ–¹ä¾¿åœ°è§£å†³é—®é¢˜ã€‚æ¯”å¦‚ï¼Œæ•°å­¦å…¬å¼æ˜¯æˆ‘ä»¬å¯¹ç‰©ç†ä¸æ•°å­¦è§„å¾‹çš„æŠ½è±¡ï¼Œåœ°å›¾å’Œæ²™ç›˜æ˜¯æˆ‘ä»¬å¯¹åœ°ç†ç©ºé—´çš„æŠ½è±¡ï¼Œè½¯ä»¶æ¶æ„å›¾æ˜¯è½¯ä»¶å·¥ç¨‹å¸ˆå¯¹è½¯ä»¶ç³»ç»Ÿçš„æŠ½è±¡ã€‚</p><p>é€šè¿‡æŠ½è±¡ï¼Œæˆ‘ä»¬æ›´å®¹æ˜“æŠŠæ¡äº‹ç‰©çš„å†…åœ¨è§„å¾‹ï¼Œè€Œä¸æ˜¯è¢«çº·ç¹å¤æ‚çš„äº‹ç‰©è¡¨è±¡æ‰€è¿·æƒ‘ï¼Œæ›´è¿›ä¸€æ­¥æ·±åˆ»åœ°è®¤è¯†è¿™ä¸ªä¸–ç•Œã€‚é€šè¿‡æŠ½è±¡ï¼Œä¼½åˆ©ç•¥å‘ç°åŠ›æ˜¯æ”¹å˜ç‰©ä½“è¿åŠ¨çš„åŸå› ï¼Œè€Œä¸æ˜¯ä½¿ç‰©ä½“è¿åŠ¨çš„åŸå› ï¼Œä¸ºå…¨äººç±»æ‰“å¼€äº†ç°ä»£ç§‘å­¦çš„å¤§é—¨ã€‚</p><p>è¿™äº›å¹´ï¼Œæˆ‘è‡ªå·±è®¤è¯†äº†å¾ˆå¤šä¼˜ç§€çš„äººï¼Œä»–ä»¬å„æœ‰æ‰€é•¿ã€å„æœ‰ç‰¹ç‚¹ï¼Œä½†æ˜¯æ— ä¸€ä¾‹å¤–éƒ½æœ‰ä¸ªå…±åŒçš„ç‰¹å¾ï¼Œå°±æ˜¯<strong>å¯¹äº‹ç‰©çš„æ´å¯ŸåŠ›</strong>ã€‚ä»–ä»¬èƒ½å¤Ÿç©¿é€äº‹ç‰©çš„å±‚å±‚è¿·é›¾ï¼Œç›´æŒ‡é—®é¢˜çš„æ ¸å¿ƒå’Œè¦å®³ï¼Œä¸ä¼šçŠ¹è±«å’Œè¿·èŒ«ï¼Œè½»æ¾å‡ºæ‰‹å°±æå®šäº†å…¶ä»–äººçœ‹èµ·æ¥æ— æ¯”è‰°éš¾çš„äº‹æƒ…ã€‚æœ‰æ—¶å€™å…‰æ˜¯çœ‹ä»–ä»¬åšäº‹å°±èƒ½æ„Ÿå—åˆ°ä¸€ç§ç¾æ„Ÿï¼Œè®©äººæ„é†‰ç¥è¿·ã€‚</p><p><strong>è¿™ç§æ´å¯ŸåŠ›å°±æ˜¯æ¥æºäºä»–ä»¬å¯¹äº‹ç‰©çš„æŠ½è±¡èƒ½åŠ›</strong>ï¼Œè™½ç„¶æˆ‘ä¸çŸ¥é“è¿™ç§èƒ½åŠ›ç¼˜ä½•è€Œæ¥ï¼Œä½†æ˜¯è§è¯†äº†è¿™ç§èƒ½åŠ›ä»¥åï¼Œæˆ‘ä¹Ÿéå¸¸æ¸´æœ›æ‹¥æœ‰å¯¹äº‹ç‰©çš„æŠ½è±¡èƒ½åŠ›ã€‚æ‰€ä»¥åœ¨é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘å°±ä¼šåœä¸‹æ¥æ€è€ƒï¼šè¿™ä¸ªé—®é¢˜ä¸ºä»€ä¹ˆä¼šå‡ºç°ï¼Œå®ƒæ­ç¤ºå‡ºæ¥èƒŒåçš„è§„å¾‹æ˜¯ä»€ä¹ˆï¼Œæˆ‘åº”è¯¥å¦‚ä½•åšã€‚ç”šè‡³æœ‰æ—¶å€™ä¼šæŠŠè¿™äº›ä¼˜ç§€çš„äººå¸¦å…¥è¿›æ€è€ƒï¼šå¦‚æœæ˜¯æˆ´è€å¸ˆã€å¦‚æœæ˜¯æ½˜å¤§ä¾ ï¼Œä»–ä¼šå¦‚ä½•çœ‹å¾…ã€å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é€šè¿‡è¿™ç§ä¸æ–­åœ°è®­ç»ƒï¼Œè™½ç„¶å’Œé‚£äº›æœ€ä¼˜ç§€çš„äººç›¸æ¯”è¿˜æ˜¯æœ‰å·¨å¤§çš„å·®è·ï¼Œä½†æ˜¯ä»ç„¶èƒ½å¤Ÿæ„Ÿå—åˆ°è‡ªå·±çš„è¿›æ­¥ï¼Œè¿™äº›å°å°çš„è¿›æ­¥ä¹Ÿä¼šè®©è‡ªå·±äº§ç”Ÿå¤§å¤§çš„å¿«ä¹ï¼Œä¸€ç§ä¸è’åºŸå…‰é˜´ã€æ²¡æœ‰è™šåº¦æ­¤ç”Ÿçš„æ„Ÿè§‰ã€‚</p><p>æˆ‘å¸Œæœ›ä½ ä¹Ÿèƒ½å¤Ÿä¸æ–­è®­ç»ƒè‡ªå·±ï¼Œé‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œåœä¸‹æ¥æ€è€ƒä¸€ä¸‹ï¼šè¿™äº›ç°è±¡èƒŒåçš„è§„å¾‹æ˜¯ä»€ä¹ˆã€‚æœ‰æ—¶å€™å¹¶ä¸éœ€è¦å¤šä¹ˆè‰°æ·±çš„æ€è€ƒï¼Œä»…ä»…å°±æ˜¯åœä¸€ä¸‹ï¼Œå°±ä¼šè®©ä½ å¯Ÿè§‰åˆ°ä»¥å‰ä¸æ›¾æ³¨æ„åˆ°çš„ä¸€äº›æƒ…å†µï¼Œè¿›è€Œå‘ç°äº‹ç‰©çš„æ·±å±‚è§„å¾‹ã€‚è¿™å°±æ˜¯æ´å¯ŸåŠ›ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>å¯¹äºè¿™æ ·ä¸€å¼ æ•°æ®è¡¨</p><p><img src=\"https://static001.geekbang.org/resource/image/a6/76/a699fae32164f0c37e03e50bfeec6e76.png?wh=220*234\" alt=\"\"></p><p>å¦‚æœå­˜å‚¨åœ¨HDFSä¸­ï¼Œæ¯ä¸€è¡Œè®°å½•åœ¨HDFSå¯¹åº”ä¸€è¡Œæ–‡æœ¬ï¼Œæ–‡æœ¬æ ¼å¼æ˜¯</p><pre><code>1,25\n2,25\n1,32\n2,25\n</code></pre><p>æ ¹æ®ä¸Šé¢WordCountçš„ç¤ºä¾‹ï¼Œè¯·ä½ å†™ä¸€ä¸ªMapReduceç¨‹åºï¼Œå¾—åˆ°ä¸‹é¢è¿™æ¡SQLçš„è®¡ç®—ç»“æœã€‚</p><pre><code>SELECT pageid, age, count(1) FROM pv_users GROUP BY pageid, age;\n</code></pre><p>TIPSï¼šå¦‚ä½•ç”¨MapReduceå®ç°SQLè®¡ç®—ï¼Œæˆ‘ä»¬åœ¨åé¢è¿˜ä¼šè¿›ä¸€æ­¥è®¨è®ºã€‚</p><p>æ¬¢è¿ä½ å†™ä¸‹è‡ªå·±çš„æ€è€ƒæˆ–ç–‘é—®ï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚</p><p></p>","comments":[{"had_liked":false,"id":38605,"user_name":"è½å¶é£é€çš„æ‹","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1542083000,"is_pvip":false,"discussion_count":10,"race_medal":0,"score":"366614303160","product_id":100020201,"comment_content":"è€å¸ˆï¼Œæˆ‘æ˜¯ä¸ªå¤§æ•°æ®çš„åˆå­¦è€…ï¼Œå› ä¸ºè¿™ä¸ªä¸“æ æ˜¯ä»é›¶å…¥é—¨çš„ï¼Œä½†æ˜¯ç›®å‰çš„æˆ‘è¿˜ä¸çŸ¥é“å¦‚ä½•åœ¨è‡ªå·±æœºå™¨ä¸Šå®‰è£…å“ªäº›è½¯ä»¶ï¼Ÿå¦‚ä½•æ“ä½œï¼Ÿå› ä¸ºè¿™äº›é—®é¢˜æ²¡è§£å†³ï¼Œæ‰€ä»¥æ²¡åŠæ³•çœŸåˆ‡çš„ä½“ä¼šåˆ°æ–‡ä¸­çš„å¤„ç†å•è¯ç»Ÿè®¡å¤§æ•°æ®çš„é­…åŠ›ã€‚æ‰€ä»¥å¸Œæœ›è€å¸ˆèƒ½è®²ä¸‹å¿…å¤‡è½¯ä»¶çš„å®‰è£…çš„å†…å®¹ï¼ŒåŠæ“ä½œç¯èŠ‚ã€‚è°¢è°¢","like_count":86,"discussions":[{"author":{"id":1370659,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ea/23/508f71e3.jpg","nickname":"Jefitar","note":"","ucode":"D7ED9F32ADA5B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":57010,"discussion_content":"æˆ‘è§‰å¾—è¿™ä¸ªè¯¾ç¨‹ä¸é€‚åˆåˆå­¦è€…","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1574558133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1359701,"avatar":"https://static001.geekbang.org/account/avatar/00/14/bf/55/198c6104.jpg","nickname":"å°ä¼Ÿ","note":"","ucode":"124953423491E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":166557,"discussion_content":"è‡ªè¡Œå»hadoopå®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ï¼ŒæŒ‰ç…§æ‰‹å†Œå®‰è£…ã€‚wordcountæ˜¯quickstartæ‰‹å†Œé‡Œçš„ä¸€ä¸ªä¾‹å­ï¼Œæœ‰è¯¦ç»†çš„ç¼–ç å’Œæ‰§è¡Œè¯´æ˜ï¼ŒæŒ‰å›¾ç´¢éª¥å°±å¥½äº†ã€‚å¦‚æœè¿™äº›åŠ¨æ‰‹èƒ½åŠ›éƒ½æ²¡æœ‰ï¼Œé‚£ä¹ˆéœ€è¦é”»ç‚¼ï¼Œ1å¤©ä¸è¡Œå°±2å¤©ï¼Œ2å¤©ä¸è¡Œå°±1å‘¨ï¼Œç›´åˆ°é”»ç‚¼å‡ºæ¥ä¸ºæ­¢ã€‚","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1581411265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1339820,"avatar":"https://static001.geekbang.org/account/avatar/00/14/71/ac/8295e3e7.jpg","nickname":"ä¹¦å¿†æ±Ÿå—","note":"","ucode":"90776A7CE06D66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":254029,"discussion_content":"å·²åœ¨æŸäºŒçº¿å¤§å‚å·¥ä½œæ¥è¿‘ä¸€å¹´ï¼Œæˆ‘æ˜¯ä»ã€ŠHadoopæƒå¨æŒ‡å—ã€‹ï¼ˆç¬¬å››ç‰ˆï¼‰é›¶åŸºç¡€å…¥é—¨çš„ï¼Œä¸‹é¢è¿™ä¸¤ç¯‡åšå®¢æ˜¯æˆ‘çš„Hadoopå®‰è£…ä¸é…ç½®æ€»ç»“ï¼Œç°åœ¨å·²ç»åœ¨æSparkæºç å®šåˆ¶å¼€å‘äº†\nhttps://blog.csdn.net/qq_33588730/article/details/81123614\nhttps://blog.csdn.net/qq_33588730/article/details/81228315","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1588288372,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1033169,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c3/d1/bdf895bf.jpg","nickname":"penng","note":"","ucode":"6087CFCB0AC434","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1339820,"avatar":"https://static001.geekbang.org/account/avatar/00/14/71/ac/8295e3e7.jpg","nickname":"ä¹¦å¿†æ±Ÿå—","note":"","ucode":"90776A7CE06D66","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":314711,"discussion_content":"å‰å®³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603188489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":254029,"ip_address":""},"score":314711,"extra":""}]},{"author":{"id":1523579,"avatar":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLoc8YBNXIiblszCUadC2ZicLiavDibFuH5r8FM8E8tN9H6h1QGCTU0I63z1SNZxXfyuicMWrq0yXXEBnA/132","nickname":"sunyuan","note":"","ucode":"2B1D9DA6E58E80","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":88703,"discussion_content":"è¿™è¯¾é€‚åˆåœ¨å¤§æ•°æ®å„ç§ç»„å»ºä¸­æŒ£æ‰ï¼Œæƒ³è¦å¥½å¥½æ¢³ç†å¤§æ•°æ®å†å²å’ŒåŸç†çš„äºº","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1576726435,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1309726,"avatar":"https://static001.geekbang.org/account/avatar/00/13/fc/1e/1e48fd05.jpg","nickname":"ææ— å®ª","note":"","ucode":"B86438E0930A95","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":139590,"discussion_content":"æˆ‘æƒ³æŠŠä¸Šé¢çš„é—®ç­”é¢˜ç»™å¼„å‡ºæ¥ï¼Œå®‰è£…äº†MyEclipse,ä½†æ˜¯å¤åˆ¶è¿›å»ä¹‹åå¥½å¤šæŠ¥é”™?\næŠ¥é”™å°±å’‹äº†ï¼Œä¸€ä¸ªä¸ªè§£å†³ï¼Œè€å¸ˆè¿™ä¸ªä¾‹å­æ˜¯ç¼ºå°‘äº†å¼•ç”¨ï¼Œé‚£äº›ç±»æ˜¯è€å¸ˆè‡ªå·±å†™çš„ï¼Œè¿˜æ˜¯éœ€è¦å¼•ç”¨å“ªäº›åº“ï¼Ÿå¯¹äºä¸€ä¸ªåªæœ‰javaåˆæ­¥äº†è§£çš„äººæ¥è¯´ï¼Œæœ‰ç‚¹æ‡µã€‚\næˆ‘æƒ³è€å¸ˆè®²è¿™é—¨è¯¾æ˜¯åœ¨åŸ¹å…»æ¶æ„å¸ˆï¼Œè€Œä¸æ˜¯ç»™å¯¹äºjavaæˆ–è€…ç¼–ç¨‹åªæœ‰åˆæ­¥äº†è§£çš„äººçœ‹çš„ã€‚\nè™½ç„¶æˆ‘æœ‰C#çš„ç¼–ç¨‹åŸºç¡€ï¼Œä¸ºäº†å­¦å¥½è¿™é—¨è¯¾ï¼Œæˆ‘è¿˜æ˜¯å¾—å»å­¦ä¹ ä¸€ä¸‹javaçš„ç›¸å…³çŸ¥è¯†ï¼Œè™½ç„¶æˆ‘æƒ³ç”¨C#èƒ½å¤Ÿå®ç°ï¼Ÿé‚£æˆ‘ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨C#å®ç°å‘¢ï¼Ÿå¦‚æœæˆ‘ç”¨C#å»å®ç°ï¼Œä½†æ˜¯æˆ‘ä¸å¯èƒ½å®ç°æ•´ä¸ªHadoopå§ï¼Œå“ªé‡Œä¸ä¼šå­¦å“ªé‡Œå§ï¼Ÿç½‘ä¸Šèµ„æ–™é‚£ä¹ˆå¤šï¼Œå¤šæœç´¢ä¸€ä¸‹å°±å¥½äº†ï¼åˆšå¼€å§‹çš„æ—¶å€™æœ‰ç‚¹éš¾ï¼Œå¤šä¸‹ç‚¹åŠŸå¤«ï¼Œç­‰è¿™é—¨è¯¾ç¨‹å­¦å®Œä¹‹åä¸€å®šä¼šæ”¶è·å¾ˆå¤šçš„å§ï¼åŒå­¦ä»¬åŠ æ²¹å‘€ï¼","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579306089,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3199726,"avatar":"","nickname":"Geek_e4b244","note":"","ucode":"819BBABC05175B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590327,"discussion_content":"è¿™è¯¾ï¼Œæˆ‘è§‰å¾—æ¯”è¾ƒé€‚åˆåšæ•°æ®äº§å“ç»ç†çš„äººï¼Œæˆ–è€…åšæ•°æ®ä¸­å°äº§å“çš„äººã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665659108,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æ²³å—"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1483115,"avatar":"https://static001.geekbang.org/account/avatar/00/16/a1/6b/f5f94a6f.jpg","nickname":"Growing Quiet","note":"","ucode":"ADA66BF76802B6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":581488,"discussion_content":"ä¸æ˜¯è¯¾ç¨‹å‡ºäº†é—®é¢˜ï¼Œè€Œæ˜¯æ•™è‚²å‡ºäº†é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1658811299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1102245,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d1/a5/2bbedc3b.jpg","nickname":"over","note":"","ucode":"FE272AC19842D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395910,"discussion_content":"æœ‰æ²¡æœ‰hadoopçš„docker?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632363046,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1185926,"avatar":"https://static001.geekbang.org/account/avatar/00/12/18/86/3599130b.jpg","nickname":"dany","note":"","ucode":"0990375202642F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":47574,"discussion_content":"è€å¸ˆä¹Ÿä¸å›å¤ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573369236,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38592,"user_name":"intuition","can_delete":false,"product_type":"c1","uid":1083657,"ip_address":"","ucode":"94D61C78277850","user_header":"https://static001.geekbang.org/account/avatar/00/10/89/09/d660509d.jpg","comment_is_top":false,"comment_ctime":1542078677,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"207700508885","product_id":100020201,"comment_content":"æè€å¸ˆçš„æ–‡ç« å·²ç»ä¸ä»…ä»…å±€é™äºæŠ€æœ¯æœ¬èº« æ›´å¤šçš„æ˜¯å¯¹äººç”Ÿçš„çš„æ€è€ƒ å¦‚ä½•å»æˆä¸ºä¸€ä¸ªæ€è€ƒè€…æ‰æ˜¯æˆ‘ä»¬æ‰€è¿½æ±‚çš„ç›®æ ‡","like_count":49},{"had_liked":false,"id":38576,"user_name":"å¤§æ•°æ®æŠ€æœ¯ä¸æ•°ä»“","can_delete":false,"product_type":"c1","uid":1113520,"ip_address":"","ucode":"7F4DD013061A5E","user_header":"https://static001.geekbang.org/account/avatar/00/10/fd/b0/30007f3c.jpg","comment_is_top":false,"comment_ctime":1542076282,"is_pvip":false,"replies":[{"id":"13864","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542112360,"ip_address":"","comment_id":38576,"utype":1}],"discussion_count":2,"race_medal":0,"score":"143275997050","product_id":100020201,"comment_content":"package com.company.sparkcore<br><br>import org.apache.log4j.{Level, Logger}<br>import org.apache.spark.{SparkConf, SparkContext}<br><br>object CountPVByGroup {<br>  def main(args: Array[String]): Unit = {<br>    val conf = new SparkConf()<br>      .setAppName(CountPVByGroup.getClass.getSimpleName)<br>      .setMaster(&quot;local&quot;)<br>    Logger.getLogger(&quot;org.apache.spark&quot;).setLevel(Level.OFF)<br>    Logger.getLogger(&quot;org.apache.hadoop&quot;).setLevel(Level.OFF)<br>    val sc = new SparkContext(conf)<br>    val lines = sc.textFile(&quot;file:&#47;&#47;&#47;e:&#47;pv_users.txt&quot;)<br>    &#47;&#47;æ‹¼æ¥æˆï¼ˆ1_25,1ï¼‰çš„å½¢å¼<br>    val newKeyValue =  lines.map(_.split(&quot;,&quot;)).map(pvdata =&gt; ((pvdata(0)+ &quot;_&quot; + pvdata(1)),1))<br>   &#47;&#47;å¯¹ä¸Šè¿°KVè¿›è¡Œç»Ÿè®¡<br>    val pvcount = newKeyValue.reduceByKey(_ + _)<br>    &#47;&#47;å°†æ‹¼æ¥ç¬¦å·å»æ‰ï¼Œç»„åˆæˆå½¢å¦‚(1,25,1)çš„å½¢å¼<br>    val pvid_age_count = pvcount.map(newkv =&gt; (newkv._1.split(&quot;_&quot;)(0),newkv._1.split(&quot;_&quot;)(1),newkv._2))<br>    &#47;&#47;ç»“æœè¾“å‡º<br>&#47;&#47;    (1,25,1)<br>&#47;&#47;    (2,25,2)<br>&#47;&#47;    (1,32,1)<br>    pvid_age_count.collect().foreach(println)<br>  }<br><br>}","like_count":34,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428751,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542112360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2518863,"avatar":"https://static001.geekbang.org/account/avatar/00/26/6f/4f/3cf1e9c4.jpg","nickname":"é’±é¹ Allen","note":"","ucode":"7E95E82C0717DA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392300,"discussion_content":"å‰å®³ï¼Œè¿è¡Œçš„æ—¶å€™å‘ç°è‡ªå·±æ•°ç»„ä¸­æ–­è¶Šç•Œï¼Œæ²¡æƒ³åˆ°æ˜¯å­˜å…¥çš„æ–‡ä»¶ä¸æ˜¯ä»¥é€—å·åˆ†å‰²å¼€æ¥çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630938202,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":40039,"user_name":"æœ±å›½ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1083343,"ip_address":"","ucode":"A8547956D9C372","user_header":"https://static001.geekbang.org/account/avatar/00/10/87/cf/7bec93d8.jpg","comment_is_top":false,"comment_ctime":1542450073,"is_pvip":true,"replies":[{"id":"14437","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542525229,"ip_address":"","comment_id":40039,"utype":1}],"discussion_count":1,"race_medal":0,"score":"117506567065","product_id":100020201,"comment_content":"å•æœºå®‰è£…ä¼ªhadoopé›†ç¾¤<br>è§ï¼šhttps:&#47;&#47;hadoop.apache.org&#47;docs&#47;stable&#47;hadoop-project-dist&#47;hadoop-common&#47;SingleCluster.html<br>æ³¨ï¼šåœ¨Macä¸­å®‰è£…é‡åˆ°äº†ä¸€äº›é—®é¢˜ ä½†æ˜¯googleä¸€ä¸‹å°±èƒ½è§£å†³ æ•ä¸ä¸€ä¸€é“æ¥<br><br>æ€è€ƒé¢˜è§£ç­”æ­¥éª¤<br>cat pv_users<br>1,25<br>2,25<br>1,32<br>2,25<br><br># å¯¼å…¥è¯¥æ–‡ä»¶åˆ°dfsä¸­<br>bin&#47;hdfs dfs -put pv_users pv_users<br><br># å› ä¸ºæ¯ä¸€è¡Œåªæœ‰pageid, ageå¹¶ä¸”ä¸­é—´æ²¡æœ‰ç©ºæ ¼ å¯ä»¥ç›´æ¥åˆ©ç”¨hadoopè‡ªå¸¦çš„wordcountç¨‹åº<br># è¯»å–dfsä¸­çš„pv_useræ–‡ä»¶ è¿›è¡Œç»Ÿè®¡ ç„¶åå°†ç»“æœè¾“å‡ºåˆ°pv_users_countä¸­<br>bin&#47;yarn jar share&#47;hadoop&#47;mapreduce&#47;hadoop-mapreduce-examples-2.9.1.jar wordcount pv_users pv_users_count<br># è¯»å–ç»Ÿè®¡ç»“æœ<br>bin&#47;hdfs dfs -cat pv_users_count&#47;part-r-00000<br>1,25\t1<br>1,32\t1<br>2,25\t2<br>","like_count":28,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429346,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542525229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38462,"user_name":"æ— å½¢","can_delete":false,"product_type":"c1","uid":1016889,"ip_address":"","ucode":"B740E2A68A17A5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/39/c8772466.jpg","comment_is_top":false,"comment_ctime":1542040271,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"83146418895","product_id":100020201,"comment_content":"æŠŠpageIDå’Œageå½“åškeyè®¡ç®—å‡ºç°çš„æ¬¡æ•°å¹¶åšæ±‡æ€»ï¼Œç„¶åå¯¹keyæ’åºï¼Œè¾“å‡ºæ’åºåçš„keyå’Œå…¶å¯¹åº”çš„æ€»æ¬¡æ•°","like_count":20},{"had_liked":false,"id":42446,"user_name":"å–œç¬‘å»¶å¼€","can_delete":false,"product_type":"c1","uid":1240321,"ip_address":"","ucode":"DBF645D2129460","user_header":"https://static001.geekbang.org/account/avatar/00/12/ed/01/997432f3.jpg","comment_is_top":false,"comment_ctime":1542956089,"is_pvip":false,"replies":[{"id":"15187","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542969055,"ip_address":"","comment_id":42446,"utype":1}],"discussion_count":1,"race_medal":0,"score":"78852367417","product_id":100020201,"comment_content":"ä¸èƒ½å…‰æƒ³ï¼Œå¿…é¡»åŠ¨æ‰‹å®è·µï¼š<br>## Mapper<br>public class PageMapper extends Mapper&lt;LongWritable,Text,Text,IntWritable&gt; {<br>    @Override<br>    protected void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {<br>        String data = value.toString();<br>        String[] words = data.split(&quot;\\n&quot;);<br>        for (String word : words) {<br>            context.write(new Text(word), new IntWritable(1));<br>        }<br>    }<br>}<br>## Reducer<br>public class PageReducer extends Reducer&lt;Text,IntWritable,Text,IntWritable&gt; {<br>    @Override<br>    protected void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {<br>        int total=0;<br>        for (IntWritable value : values) {<br>            total=total+value.get();<br>        }<br>        context.write(key, new IntWritable(total));<br>    }<br>}<br>##  Main<br>public class PageMain {<br>    public static void main(String[] args) throws IOException, ClassNotFoundException, InterruptedException {<br>        Job job = Job.getInstance();<br>        job.setJarByClass(PageMain.class);<br><br>        job.setMapperClass(PageMapper.class);<br>        job.setMapOutputKeyClass(Text.class);<br>        job.setMapOutputValueClass(IntWritable.class);<br><br>        job.setReducerClass(PageReducer.class);<br>        job.setOutputKeyClass(Text.class);<br>        job.setOutputValueClass(IntWritable.class);<br><br>        FileInputFormat.setInputPaths(job,new Path(args[0]));<br>        FileOutputFormat.setOutputPath(job, new Path(args[1]));<br><br>        job.waitForCompletion(true);<br><br><br>    }<br>}<br><br>## å‘½ä»¤è¡Œ<br>hadoop jar page-1.0-SNAPSHOT.jar PageMain &#47;input&#47;page  &#47;output5<br>psï¼šç¬¬ä¸€æ¬¡è¿è¡ŒæŠ¥é”™äº†~~ï¼ˆä¸ç»ƒä¸çŸ¥é“ï¼‰<br>é”™è¯¯ï¼šInitialization of all the collectors failed. Error in last collector was :interface javax.xml.soap.<br>åŸå› ï¼šç¼–å†™Mainçš„æ—¶å€™ï¼ŒTextçš„å¼•ç”¨importé”™äº†ï¼Œä¹ æƒ¯äº†å¼¹å‡ºæç¤ºç›´æ¥ç¡®å®š~åº”è¯¥å¯¼å…¥`import org.apache.hadoop.io.Text;`","like_count":19,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":430095,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542969055,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39396,"user_name":"æœ‰é“­","can_delete":false,"product_type":"c1","uid":1046302,"ip_address":"","ucode":"2C7CB36CA5C04C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/3XbCueYYVWTiclv8T5tFpwiblOxLphvSZxL4ujMdqVMibZnOiaFK2C5nKRGv407iaAsrI0CDICYVQJtiaITzkjfjbvrQ/132","comment_is_top":false,"comment_ctime":1542264448,"is_pvip":false,"replies":[{"id":"14138","content":"mapå‡½æ•°è¾“å…¥çš„keyï¼Œè¡¨ç¤ºè¿™è¡Œæ•°æ®åœ¨æ–‡ä»¶ä¸­çš„åç§»é‡ï¼Œé€šå¸¸å¿½ç•¥æ‰","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542293472,"ip_address":"","comment_id":39396,"utype":1}],"discussion_count":3,"race_medal":0,"score":"70261741184","product_id":100020201,"comment_content":"æˆ‘æƒ³é—®ä¸€ä¸‹é‚£ä¸ªè®¡ç®—è¿‡ç¨‹çš„ç¤ºæ„å›¾é‡Œmapè¾“å…¥éƒ¨åˆ†ï¼Œä¸Šé¢çš„æ˜¯0ï¼Œ12ï¼Œä¸‹é¢æ˜¯0ï¼Œ13ï¼Œæ˜¯å•¥æ„æ€ï¼Ÿ","like_count":17,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429047,"discussion_content":"mapå‡½æ•°è¾“å…¥çš„keyï¼Œè¡¨ç¤ºè¿™è¡Œæ•°æ®åœ¨æ–‡ä»¶ä¸­çš„åç§»é‡ï¼Œé€šå¸¸å¿½ç•¥æ‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542293472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1117889,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0e/c1/e2a9cbc1.jpg","nickname":"jinhaoqi","note":"","ucode":"767929B4AF93A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2464,"discussion_content":"åç§»é‡æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿ\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563675708,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1409705,"avatar":"https://static001.geekbang.org/account/avatar/00/15/82/a9/5c64c6b0.jpg","nickname":"è‹æœ¨æ˜¥å¤å†¬","note":"","ucode":"4D19AB2AEC9C2E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1117889,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0e/c1/e2a9cbc1.jpg","nickname":"jinhaoqi","note":"","ucode":"767929B4AF93A6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":234646,"discussion_content":"å½“å‰è¡ŒæŒªå‡ ä¸ªä½ç½®èƒ½è¯»åˆ°value","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586980805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2464,"ip_address":""},"score":234646,"extra":""}]}]},{"had_liked":false,"id":38504,"user_name":"ä¸€ç®­ä¸­çš„","can_delete":false,"product_type":"c1","uid":1025729,"ip_address":"","ucode":"9D18662C5CCF7A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a6/c1/d4e6147e.jpg","comment_is_top":false,"comment_ctime":1542069062,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"53081676614","product_id":100020201,"comment_content":"å°†pageidå’Œ ageæ‹¼æ¥æˆå­—ç¬¦ä¸²å½“åšä¸€ä¸ªkeyï¼Œç„¶åé€šè¿‡Mapå’ŒReduceè®¡ç®—å³å¯å¾—å‡ºå¯¹åº”çš„count","like_count":13},{"had_liked":false,"id":151041,"user_name":"Zend","can_delete":false,"product_type":"c1","uid":1053921,"ip_address":"","ucode":"80EBB0B6772E27","user_header":"https://static001.geekbang.org/account/avatar/00/10/14/e1/ee5705a2.jpg","comment_is_top":false,"comment_ctime":1573646560,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"44523319520","product_id":100020201,"comment_content":"--Mapè¾“å…¥--<br>1,25<br>2,25<br>1,32<br>2,25<br>--Mapè®¡ç®—åçš„ç»“æœä¸ºMapè¾“å‡º--<br>&lt;&lt;1,25&gt;,1&gt;<br>&lt;&lt;2,25&gt;,1&gt;<br>&lt;&lt;1,32&gt;,1&gt;<br>&lt;&lt;2,25&gt;,1&gt;<br>--MapReduceè®¡ç®—æ¡†æ¶å¤„ç†åçš„ç»“æœä¸ºReduceè¾“å…¥--<br>&lt;&lt;1,25&gt;,&lt;1&gt;&gt;<br>&lt;&lt;2,25&gt;,&lt;1,1&gt;&gt;<br>&lt;&lt;1,32&gt;,&lt;1&gt;&gt;<br>--Reduceè®¡ç®—åçš„ç»“æœä¸ºReduceè¾“å‡º--<br>&lt;&lt;1,25&gt;,1&gt;<br>&lt;&lt;2,25&gt;,2&gt;<br>&lt;&lt;1,32&gt;,1&gt;","like_count":11},{"had_liked":false,"id":38662,"user_name":"å°è¾‰è¾‰","can_delete":false,"product_type":"c1","uid":1189661,"ip_address":"","ucode":"9FF25E25C85350","user_header":"https://static001.geekbang.org/account/avatar/00/12/27/1d/1cb36854.jpg","comment_is_top":false,"comment_ctime":1542099768,"is_pvip":false,"replies":[{"id":"13858","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542111829,"ip_address":"","comment_id":38662,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44491772728","product_id":100020201,"comment_content":"java8ä¸­çš„æµå¼æ¡†æ¶ä¹Ÿç”¨çš„MapReduceï¼Œä¹‹å‰ä¸€ç›´æ²¡ç†è§£ç”¨MapReduceçš„æ„ä¹‰ä½•åœ¨ï¼Œä»Šå¤©çªç„¶é¡¿æ‚Ÿã€‚<br>è½¯ä»¶ä¸­å¾ˆå¤šæ€æƒ³å’Œè®¾è®¡éƒ½æ˜¯é€šç”¨çš„ï¼Œä»Šå¤©æ¥è§¦ä¸€ç§æ–°ä¸œè¥¿ï¼Œæ˜å¤©è¯´ä¸å®šåœ¨å…¶å®ƒåœ°æ–¹åˆèƒ½ç¢°åˆ°ï¼Œåˆèƒ½åŠ æ·±ä¸€éå°è±¡ã€‚æ‰€ä»¥è¯´å­¦å¾—å¤šäº†ï¼Œå¾ˆå¤šæ—¶é—´å°±å¯ä»¥èä¼šè´¯é€šäº†ã€‚","like_count":11,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428772,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542111829,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38616,"user_name":"Ahikaka","can_delete":false,"product_type":"c1","uid":1045146,"ip_address":"","ucode":"B3A678567E40A9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/vhOPEib27xAuTycN0eQekLzsCe9zwcTTcrOb98cIfpgibgcweZBDN38tIicABibuZBwah9jnGVr02H2Zjuue1fLfEQ/132","comment_is_top":false,"comment_ctime":1542084954,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"44491757914","product_id":100020201,"comment_content":"è€å¸ˆèƒ½ä¸èƒ½æ¨èäº›å­¦å¤§æ•°æ®çš„ä¹¦ç±ï¼Œåšå®¢ï¼Œç½‘ç«™ ã€‚","like_count":10,"discussions":[{"author":{"id":1339820,"avatar":"https://static001.geekbang.org/account/avatar/00/14/71/ac/8295e3e7.jpg","nickname":"ä¹¦å¿†æ±Ÿå—","note":"","ucode":"90776A7CE06D66","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":254032,"discussion_content":"ã€ŠHadoopæƒå¨æŒ‡å—ã€‹ï¼ˆç¬¬å››ç‰ˆï¼‰ã€ã€ŠSparkæƒå¨æŒ‡å—ã€‹\né€‚åˆåˆå­¦è€…å­¦ä¹ hadoopçš„ä¹¦ç±ï¼Ÿ - ä¹¦å¿†æ±Ÿå—çš„å›ç­” - çŸ¥ä¹\nhttps://www.zhihu.com/question/278070602/answer/878291281\næœ‰ä»€ä¹ˆå…³äº Spark çš„ä¹¦æ¨èï¼Ÿ - ä¹¦å¿†æ±Ÿå—çš„å›ç­” - çŸ¥ä¹\nhttps://www.zhihu.com/question/23655827/answer/1039397401","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588289088,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39503,"user_name":"ç³Šç³Š","can_delete":false,"product_type":"c1","uid":1067825,"ip_address":"","ucode":"74875CB3A84E18","user_header":"https://static001.geekbang.org/account/avatar/00/10/4b/31/c1ce2abc.jpg","comment_is_top":false,"comment_ctime":1542291972,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31607063044","product_id":100020201,"comment_content":"mapreduceæ ¸å¿ƒæ€æƒ³å°±è·Ÿä¼ ç»Ÿçš„SQLä¸­çš„group byä¸€æ ·","like_count":7},{"had_liked":false,"id":39487,"user_name":"å‘†çŒ«","can_delete":false,"product_type":"c1","uid":1228759,"ip_address":"","ucode":"69E256E6A19225","user_header":"https://static001.geekbang.org/account/avatar/00/12/bf/d7/9e2c8648.jpg","comment_is_top":false,"comment_ctime":1542288286,"is_pvip":false,"replies":[{"id":"14174","content":"è°¢è°¢","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542332078,"ip_address":"","comment_id":39487,"utype":1}],"discussion_count":1,"race_medal":0,"score":"27312092062","product_id":100020201,"comment_content":"æ–‡ç« çœŸçš„æ˜¯çœ‹çš„èµå¿ƒæ‚¦ç›®ï¼Œå°¤å…¶æ˜¯é‚£æ®µæè¿°æŠ½è±¡çš„æ–‡å­—ğŸ˜ƒ","like_count":6,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429081,"discussion_content":"è°¢è°¢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542332078,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38531,"user_name":"æäºŒæœ¨","can_delete":false,"product_type":"c1","uid":1103091,"ip_address":"","ucode":"30E03BB84ADB27","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg","comment_is_top":false,"comment_ctime":1542071612,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"27311875388","product_id":100020201,"comment_content":"çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘åœ¨æƒ³æˆ‘åœ¨æ€ä¹ˆæƒ³ï¼Ÿ","like_count":6},{"had_liked":false,"id":38630,"user_name":"è€ç”·å­©","can_delete":false,"product_type":"c1","uid":1134514,"ip_address":"","ucode":"CEC6D47412F620","user_header":"https://static001.geekbang.org/account/avatar/00/11/4f/b2/1e8b5616.jpg","comment_is_top":false,"comment_ctime":1542090418,"is_pvip":false,"replies":[{"id":"13859","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542111896,"ip_address":"","comment_id":38630,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23016926898","product_id":100020201,"comment_content":"è€å¸ˆå…³äºæŠ½è±¡æ˜¯æ´å¯Ÿäº‹ç‰©æœ¬è´¨çš„æ€»ç»“å¾ˆç²¾è¾Ÿã€‚å…³äºæ€è€ƒé¢˜ï¼Œæˆ‘çš„æ€è·¯æ˜¯æŠŠpageid+ageä½œä¸ºmapå‡½æ•°è®¡ç®—keyå€¼ï¼Œvalueåˆ†åˆ«æ˜¯1ã€‚ç„¶åreduceå†æ ¹æ®keyå¯¹valueçš„é›†åˆè¿›è¡Œsumã€‚å°±å¯ä»¥å¾—å‡ºsqlçš„ç»“æœã€‚","like_count":5,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428762,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542111896,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38694,"user_name":"æ˜å¤©æ›´ç¾å¥½","can_delete":false,"product_type":"c1","uid":1180696,"ip_address":"","ucode":"F036B8718938BE","user_header":"https://static001.geekbang.org/account/avatar/00/12/04/18/4b02510f.jpg","comment_is_top":false,"comment_ctime":1542108571,"is_pvip":false,"replies":[{"id":"14037","content":"ä½ å¯èƒ½éœ€è¦ä¸€ä¸ªå®Œæ•´çš„æŠ€æœ¯æ¶æ„æ–¹æ¡ˆï¼Œè€Œä¸åªæ˜¯HBASEèƒ½ä¸èƒ½æå®šçš„é—®é¢˜ï¼Œå»ºè®®ä½ çœ‹ä¸‹æˆ‘å†™å¦ä¸€æœ¬ä¹¦ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹ï¼Œä¸“æ åé¢ä¹Ÿä¼šå¯¹å¤§æ•°æ®æ¶æ„æœ‰å„ä¸ªè§’åº¦çš„æ¢è®¨ï¼Œæ¬¢è¿æŒç»­å…³æ³¨","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542244924,"ip_address":"","comment_id":38694,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18721977755","product_id":100020201,"comment_content":"å¯¹äºå¤§æ•°æ®æ¥è¯´æ˜¯ç›²åŒºï¼Œå¦‚æœåº”ç”¨ç›´æ¥å¾€hbaseä¸­å†™å¯ä»¥å—ï¼Ÿ2.5ä¸‡çš„å¹¶å‘ã€‚hbaseå¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„æŸ¥è¯¢éœ€æ±‚å—ï¼Ÿè¿˜æœ‰æ—¥å¿—åˆ†æ","like_count":4,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428778,"discussion_content":"ä½ å¯èƒ½éœ€è¦ä¸€ä¸ªå®Œæ•´çš„æŠ€æœ¯æ¶æ„æ–¹æ¡ˆï¼Œè€Œä¸åªæ˜¯HBASEèƒ½ä¸èƒ½æå®šçš„é—®é¢˜ï¼Œå»ºè®®ä½ çœ‹ä¸‹æˆ‘å†™å¦ä¸€æœ¬ä¹¦ã€Šå¤§å‹ç½‘ç«™æŠ€æœ¯æ¶æ„ï¼šæ ¸å¿ƒåŸç†ä¸æ¡ˆä¾‹åˆ†æã€‹ï¼Œä¸“æ åé¢ä¹Ÿä¼šå¯¹å¤§æ•°æ®æ¶æ„æœ‰å„ä¸ªè§’åº¦çš„æ¢è®¨ï¼Œæ¬¢è¿æŒç»­å…³æ³¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542244924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38572,"user_name":"Lambda","can_delete":false,"product_type":"c1","uid":1032807,"ip_address":"","ucode":"0B0CCFC0991B10","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eobHCkMA1WJgZZYRfHqXDeIwybVwSxNGFAWWSunYVNLiaKia6q3rVkG7P8tl4ZcNRI7iaxdZhVckroVA/132","comment_is_top":false,"comment_ctime":1542075729,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18721944913","product_id":100020201,"comment_content":"å¥½åƒä¸­é—´æ‹‰ä¸‹äº† shuffle ","like_count":4},{"had_liked":false,"id":55857,"user_name":"å°æˆ","can_delete":false,"product_type":"c1","uid":1350143,"ip_address":"","ucode":"1BC685767B0FBD","user_header":"https://static001.geekbang.org/account/avatar/00/14/99/ff/046495bb.jpg","comment_is_top":false,"comment_ctime":1546330268,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14431232156","product_id":100020201,"comment_content":"è€å¸ˆï¼Œæˆ‘æ˜¯å¤§æ•°æ®åˆå­¦è€…ï¼Œé™¤äº†ç¼–ç¨‹è¯­è¨€æœ¬èº«çš„ï¼Œå¯ä»¥æ¨èä¸€äº›ä¹¦ç±æˆ–è€…èµ„æ–™è¾…åŠ©è¿™ä¸ªä¸“æ çš„å­¦ä¹ å—ï¼Œåƒhadoopç›¸å…³ç±»çš„ï¼Œè¿™æœŸçš„ä»£ç çœ‹ä¸æ‡‚äº†ã€‚","like_count":3},{"had_liked":false,"id":41560,"user_name":"æ— å¤„ä¸åœ¨","can_delete":false,"product_type":"c1","uid":1157533,"ip_address":"","ucode":"BB535BC6F448F4","user_header":"https://static001.geekbang.org/account/avatar/00/11/a9/9d/bdfd9e58.jpg","comment_is_top":false,"comment_ctime":1542805941,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"14427707829","product_id":100020201,"comment_content":"è¿™ä¸ªå¦‚æœåœ¨å¤æ‚æˆ–è€…é«˜çº§ä¸€ç‚¹ï¼Œå°±éœ€è¦ç”¨mapreduceçš„åºåˆ—åŒ–å¯¹è±¡ä½œä¸ºkeyçš„åŠŸèƒ½å»å®ç°äº†ï¼Œæœ€è¿‘ä¹Ÿåœ¨å­¦ä¹ å¤§æ•°æ®ï¼Œå­¦çš„æ—¶å€™æ„Ÿè§‰æ‰¾åˆ°äº†sqlçš„æœ¬è´¨ï¼Œè®°å¾—å…¬å¸å‰å¹´çš„é¡¹ç›®å°±æ˜¯æ‰‹å†™äº†ä¸€å †jså‡½æ•°ï¼Œå®ç°äº†mongodbçš„ç±»ä¼¼sqlçš„åˆ†ç»„èšåˆæ“ä½œã€‚<br>åç»­å¯ä»¥å¼€è®¾è§†é¢‘çš„ä¸“æ å°±æ›´å¥½äº†","like_count":3},{"had_liked":false,"id":39132,"user_name":"æ›¾æµ·é£","can_delete":false,"product_type":"c1","uid":1137487,"ip_address":"","ucode":"5FACE924E0211B","user_header":"https://static001.geekbang.org/account/avatar/00/11/5b/4f/d4030e6b.jpg","comment_is_top":false,"comment_ctime":1542195192,"is_pvip":false,"replies":[{"id":"14016","content":"mapä»»åŠ¡æœ‰å¾ˆå¤šï¼Œæ‰€ä»¥mapä»»åŠ¡è¾“å‡ºçš„keyå…¨éƒ¨åˆå¹¶åœ¨ä¸€èµ·æ‰èƒ½reduceï¼Œè¯·çœ‹ä¸‹æœŸæ–‡ç« ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542239144,"ip_address":"","comment_id":39132,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14427097080","product_id":100020201,"comment_content":"ä¸ºä»€ä¹ˆç›¸åŒkeyçš„åˆå¹¶æ˜¯å½¢æˆ&lt;key, valueé›†åˆ&gt;è€Œä¸æ˜¯ç›´æ¥å½¢æˆä¸€ä¸ª&lt;key,  value reduceåçš„ç»“æœ&gt;å‘¢ï¼Ÿåè€…ä¸æ˜¯æ•ˆç‡æ›´é«˜å—ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428932,"discussion_content":"mapä»»åŠ¡æœ‰å¾ˆå¤šï¼Œæ‰€ä»¥mapä»»åŠ¡è¾“å‡ºçš„keyå…¨éƒ¨åˆå¹¶åœ¨ä¸€èµ·æ‰èƒ½reduceï¼Œè¯·çœ‹ä¸‹æœŸæ–‡ç« ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542239144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":41146,"user_name":"ç‰›æ²¹æœ","can_delete":false,"product_type":"c1","uid":1047154,"ip_address":"","ucode":"897D927418C609","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fa/72/5c801d71.jpg","comment_is_top":false,"comment_ctime":1542732439,"is_pvip":true,"replies":[{"id":"14780","content":"è°¢è°¢ï¼Œå…±å‹‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542763930,"ip_address":"","comment_id":41146,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10132667031","product_id":100020201,"comment_content":"åé¢ä¸€æ®µè¯ï¼Œä¸€çœ‹å°±æ˜¯å¥½äººï¼Œå¥½è€å¸ˆã€‚","like_count":3,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429712,"discussion_content":"è°¢è°¢ï¼Œå…±å‹‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542763930,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39173,"user_name":"ward-wolf","can_delete":false,"product_type":"c1","uid":1031845,"ip_address":"","ucode":"BC41D01301263A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/a5/df917d18.jpg","comment_is_top":false,"comment_ctime":1542202936,"is_pvip":false,"replies":[{"id":"14017","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542239184,"ip_address":"","comment_id":39173,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10132137528","product_id":100020201,"comment_content":"æˆ‘çš„æ€è·¯å’Œå‰é¢å‡ ä¸ªåŒå­¦çš„ç±»ä¼¼ï¼Œå°±æ˜¯æŠŠæ–‡æœ¬ç›´æ¥å½“åškeyï¼Œvalueä½¿ç”¨æ•°å­—ç»Ÿè®¡ï¼Œæœ€åå°±æ˜¯é€šè¿‡reduceç»Ÿè®¡å‡ºç°æ¬¡æ•°äº†","like_count":2,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428952,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542239184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":245888,"user_name":"ç é—ªé—ª","can_delete":false,"product_type":"c1","uid":1300447,"ip_address":"","ucode":"45BE0D586A3839","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eov38ZkwCyNoBdr5drgX0cp2eOGCv7ibkhUIqCvcnFk8FyUIS6K4gHXIXh0fu7TB67jaictdDlic4OwQ/132","comment_is_top":false,"comment_ctime":1599102594,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5894069890","product_id":100020201,"comment_content":"ä¸ºæ™ºæ…§è€å¸ˆçš„æ–‡å­—è€Œæ¿€åŠ¨ã€‚è®©æˆ‘å¯¹å·¥ä½œ å­¦ä¹ å’Œç”Ÿæ´»æœ‰äº†æ›´å¤šçš„æ€è€ƒã€‚<br><br>å…³æ³¨æ¨¡å‹ï¼Œé‡è§é—®é¢˜åŠªåŠ›å»æŠ½è±¡ã€‚<br><br>é‡è§äº‹æƒ…åœä¸‹æ¥æ€è€ƒä¸€ä¸‹ã€‚è¿™ä¸ªé—®é¢˜ä¸ºä»€ä¹ˆä¼šå‡ºç°ï¼ŒèƒŒåçš„è§„å¾‹æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<br><br>å½“æ¯ä»¶äº‹æƒ…åœä¸‹æ¥æƒ³ä¸€ä¸‹ï¼Œå°±ä¼šè®©è‡ªå·±å¯Ÿè§‰åˆ°ä»¥å‰ä¸æ›¾æ³¨æ„çš„ä¸€äº›æƒ…å†µï¼Œè¿›è€Œå‘ç°äº‹ç‰©æ·±å±‚çš„è§„å¾‹ï¼Œè¿™å°±æ˜¯æ´å¯ŸåŠ›<br><br>","like_count":2},{"had_liked":false,"id":72676,"user_name":"è½å¶é£é€çš„æ‹","can_delete":false,"product_type":"c1","uid":1046429,"ip_address":"","ucode":"F9A95DB28BCF1E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg","comment_is_top":false,"comment_ctime":1551691133,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5846658429","product_id":100020201,"comment_content":"å›è¿‡å¤´æ¥ç»§ç»­çœ‹æ–‡ç« ï¼Œç›®å‰ä½¿ç”¨çš„æ˜¯è¿™ä¸ªæ­å»ºçš„é˜¿é‡Œäº‘ä¼ªé›†ç¾¤<br>http:&#47;&#47;archive.cloudera.com&#47;cdh5&#47;cdh&#47;5&#47;hadoop-2.6.0-cdh5.7.0&#47;","like_count":1,"discussions":[{"author":{"id":1880782,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/b2/ce/5638be2b.jpg","nickname":"Flychen","note":"","ucode":"4029A8F1D3C361","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":390345,"discussion_content":"è¿™ä¸ªè¿˜éœ€è¦ç”¨æˆ·å¯†ç ç™»å½•ä¿¡æ¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629792779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":39032,"user_name":"ä¸‡ä¸œæµ·","can_delete":false,"product_type":"c1","uid":1192844,"ip_address":"","ucode":"1723F7BC82913C","user_header":"https://static001.geekbang.org/account/avatar/00/12/33/8c/7363897a.jpg","comment_is_top":false,"comment_ctime":1542175547,"is_pvip":false,"replies":[{"id":"14014","content":"å¯¹","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542238967,"ip_address":"","comment_id":39032,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837142843","product_id":100020201,"comment_content":"æ€è€ƒé¢˜çš„ç­”æ¡ˆå°±æ˜¯è€å¸ˆæ–‡ä¸­çš„å—? <br>æŠŠ <br>1,25<br>2,25<br>1,32<br>2,25<br>ç›´æ¥å½“æˆå•è¯ç†è§£","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428884,"discussion_content":"å¯¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542238967,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38611,"user_name":"æ— å½¢","can_delete":false,"product_type":"c1","uid":1016889,"ip_address":"","ucode":"B740E2A68A17A5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/39/c8772466.jpg","comment_is_top":false,"comment_ctime":1542084247,"is_pvip":true,"replies":[{"id":"13860","content":"å¯ä»¥è¿™æ ·ç†è§£","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542112004,"ip_address":"","comment_id":38611,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5837051543","product_id":100020201,"comment_content":"æ„Ÿè§‰å¤§æ•°æ®å¤„ç†å’Œéœ€è¦æ±‡æ€»å¤„ç†ç»“æœçš„å¤šçº¿ç¨‹æœ‰ç‚¹ç±»ä¼¼ï¼Œä»»åŠ¡åˆ†å‘åˆ°å¤šä¸ªçº¿ç¨‹ï¼Œå¹¶è¡Œå¤„ç†ï¼Œç­‰åˆ°æ‰€æœ‰çº¿ç¨‹å¤„ç†å®Œæ¯•æ±‡æ€»ç»“æœå†ç»Ÿä¸€å¤„ç†è¿”å›ï¼Œä¸çŸ¥é“ç†è§£çš„å¯¹ä¸å¯¹","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428757,"discussion_content":"å¯ä»¥è¿™æ ·ç†è§£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542112004,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338696,"user_name":"é•¿æœŸè§„åˆ’","can_delete":false,"product_type":"c1","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1647669899,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647669899","product_id":100020201,"comment_content":"ä¹‹å‰ä¹Ÿæ–­æ–­ç»­ç»­çœ‹è¿‡Hadoopï¼Œä½†ä¸€ç›´æ²¡ææ˜ç™½æ•´ä¸ªæµç¨‹ã€‚ä»Šå¤©ç»ˆäºæ˜ç™½äº†ï¼ŒMapå‡½æ•°æ˜ å°„åçš„æ•°æ®ï¼Œä¼šç”±MapReduceæ¡†æ¶èšåˆï¼Œèšåˆä¸ºåˆ—è¡¨ï¼Œç„¶åä¼ ç»™Reduceå‡½æ•°ï¼Œç”±å®ƒä½¿ç”¨èšåˆæ–¹æ³•èšåˆã€‚","like_count":0},{"had_liked":false,"id":327301,"user_name":"*å…¶","can_delete":false,"product_type":"c1","uid":2859880,"ip_address":"","ucode":"B1B0A47CEDECC3","user_header":"https://static001.geekbang.org/account/avatar/00/2b/a3/68/e913d823.jpg","comment_is_top":false,"comment_ctime":1640054302,"is_pvip":false,"replies":[{"id":"119473","content":"å¦‚æœåªæ˜¯å®‰è£…çš„è¯ï¼Œä¸é«˜ï¼Œä¸ªäººç”µè„‘å°±å¯ä»¥","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1007349","ctime":1640573214,"ip_address":"","comment_id":327301,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1640054302","product_id":100020201,"comment_content":"å®‰è£…Hadoopçš„å„ç§ç»„ä»¶å¯¹ç¡¬ä»¶é…ç½®è¦æ±‚å¾ˆé«˜å§","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541807,"discussion_content":"å¦‚æœåªæ˜¯å®‰è£…çš„è¯ï¼Œä¸é«˜ï¼Œä¸ªäººç”µè„‘å°±å¯ä»¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640573215,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":324329,"user_name":"Geek3607","can_delete":false,"product_type":"c1","uid":2811567,"ip_address":"","ucode":"E16DFE1A65119C","user_header":"","comment_is_top":false,"comment_ctime":1638372330,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638372330","product_id":100020201,"comment_content":"å‡è®¾è¿™å››ä¸ªæ•°æ®æ”¾åœ¨äº†å››ä¸ªæœåŠ¡å™¨ä¸Šï¼Œåˆ™æœ‰<br>mapè¿‡ç¨‹<br>1ã€<br>1 25ï¼Œ1<br>2 25ï¼Œ1<br>1 32ï¼Œ1<br>2 25ï¼Œ1<br>2ã€æ•´ç†å˜æˆ<br>1 25ï¼Œ1<br>2 25 ï¼Œ1ï¼Œ1<br>1 32ï¼Œ1<br><br>reduceå<br>1 25ï¼Œ1<br>2 25ï¼Œ2<br>1 32ï¼Œ1","like_count":0},{"had_liked":false,"id":324244,"user_name":"hujihu33","can_delete":false,"product_type":"c1","uid":1078729,"ip_address":"","ucode":"686860FE2DFABB","user_header":"https://static001.geekbang.org/account/avatar/00/10/75/c9/fb23007c.jpg","comment_is_top":false,"comment_ctime":1638347328,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638347328","product_id":100020201,"comment_content":"map: &lt;(1,25),&lt;1&gt;&gt;,&lt;(2,25),&lt;1,1&gt;&gt;,&lt;(1,32),&lt;1&gt;&gt;","like_count":0},{"had_liked":false,"id":323148,"user_name":"éª†é©¼ã€","can_delete":false,"product_type":"c1","uid":1443660,"ip_address":"","ucode":"252ECDB1524867","user_header":"https://static001.geekbang.org/account/avatar/00/16/07/4c/f9852f8f.jpg","comment_is_top":false,"comment_ctime":1637744070,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637744070","product_id":100020201,"comment_content":"public static class ReadMapper extends Mapper&lt;Object, Text, Text, Text&gt; {<br>        @Override<br>        protected void map(Object key, Text value, Context context) throws IOException, InterruptedException {<br>            context.write(value,new Text(&quot;1&quot;));<br>        }<br>    }<br><br>    public static class WriteReducer extends Reducer&lt;Text,Text,Text,Text&gt;{<br>        @Override<br>        protected void reduce(Text key, Iterable&lt;Text&gt; values, Context context) throws IOException, InterruptedException {<br>            int sum = 0;<br>            for (Text value : values) {<br>                sum+=Integer.valueOf(value.toString()).intValue();<br>            }<br>            String outKey = key.toString()+&quot;,&quot;+sum;<br>            context.write(new Text(outKey),new Text(&quot;&quot;));<br>        }<br>    }","like_count":1},{"had_liked":false,"id":281519,"user_name":"æå®¢äºº","can_delete":false,"product_type":"c1","uid":2445847,"ip_address":"","ucode":"D492AA710F6D4E","user_header":"","comment_is_top":false,"comment_ctime":1614772051,"is_pvip":false,"replies":[{"id":"102304","content":"å¤§éƒ¨åˆ†å¤§æ•°æ®è½¯ä»¶éƒ½æ˜¯Javaæˆ–è€…åŸºäºJVMçš„è¯­è¨€ç¼–å†™çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1614915532,"ip_address":"","comment_id":281519,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614772051","product_id":100020201,"comment_content":"è€å¸ˆï¼Œæ–‡ç« ä¸­çš„ä»£ç æ˜¯Javaè¯­è¨€å†™çš„å—ï¼Œå› ä¸ºæˆ‘æ˜¯0åŸºç¡€çš„ï¼Œçœ‹ä¸æ‡‚ä¸Šé¢çš„ä»£ç ï¼Œæ˜¯å¦éœ€è¦å»è¡¥å……åŸºæœ¬çš„è¯­è¨€ç¼–ç¨‹åŸºç¡€ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516428,"discussion_content":"å¤§éƒ¨åˆ†å¤§æ•°æ®è½¯ä»¶éƒ½æ˜¯Javaæˆ–è€…åŸºäºJVMçš„è¯­è¨€ç¼–å†™çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614915532,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":265365,"user_name":"Geek_964b0f","can_delete":false,"product_type":"c1","uid":2295031,"ip_address":"","ucode":"D6AEDAEF609020","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/sQV132p5s2Nicia1wJPiafJtMP5ic0kwpzntdkibInNScCeic0ZvDE7y90nCM7rGDaZ2DiaRlYjhoplOpJVGlbibkToAPg/132","comment_is_top":false,"comment_ctime":1606878593,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606878593","product_id":100020201,"comment_content":"https:&#47;&#47;hadoop.apache.org&#47;docs&#47;current&#47;hadoop-mapreduce-client&#47;hadoop-mapreduce-client-core&#47;MapReduceTutorial.html#Example:_WordCount_v1.0<br><br>è¯¾ç¨‹ä»£ç æ¥æºã€‚<br><br>åœ¨ä¸“æ ä¸Šå¤åˆ¶è€å¸ˆç»™çš„ä»£ç ï¼Œ0åŸºç¡€æçœŸçš„ä¸å¤ªè¡Œï¼Œä»æ‰¾å¯¹åº”çš„mavenä¾èµ–å†åˆ°æ‰¾åŒ…å¯¼å…¥ï¼Œæœ€åmainé‡Œé¢çš„æµ‹è¯•ä»£ç ä»ç„¶æ˜¯æ— ä»ä¸‹æ‰‹ã€‚","like_count":1},{"had_liked":false,"id":250355,"user_name":"Geek_1a0e29","can_delete":false,"product_type":"c1","uid":1478573,"ip_address":"","ucode":"DFFDEA3A9A23D5","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKBS8Xf2qLLpEe6eXkkTr7PPK0WeyHZe7NzP8S8pUGyyfO5SkSSx9E5S4qdtcINAmdfdSXUKWusvA/132","comment_is_top":false,"comment_ctime":1601036443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1601036443","product_id":100020201,"comment_content":"å’Œæˆ‘æƒ³çš„ä¸€æ ·ï¼Œä»»ä½•é«˜æ·±å¤æ‚çš„æŠ€æœ¯éƒ½æœ‰ä¸€ä¸ªæå…¶ç®€å•ä¼˜é›…çš„æ¨¡å‹ï¼å¤§é“è‡³ç®€çœŸçš„ä¸æ˜¯è¯´è¯´è€Œå·²ï¼","like_count":0},{"had_liked":false,"id":231437,"user_name":"Run_dream","can_delete":false,"product_type":"c1","uid":1373602,"ip_address":"","ucode":"1BD4AAFCE72B99","user_header":"https://static001.geekbang.org/account/avatar/00/14/f5/a2/8a470344.jpg","comment_is_top":false,"comment_ctime":1593676354,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1593676354","product_id":100020201,"comment_content":"æœ¬è´¨ä¸Šå’Œwordcountä¸€æ ·çš„<br>import java.io.IOException;<br>import java.util.StringTokenizer;<br><br>import org.apache.hadoop.conf.Configuration;<br>import org.apache.hadoop.fs.Path;<br>import org.apache.hadoop.io.IntWritable;<br>import org.apache.hadoop.io.Text;<br>import org.apache.hadoop.mapreduce.Job;<br>import org.apache.hadoop.mapreduce.Mapper;<br>import org.apache.hadoop.mapreduce.Reducer;<br>import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;<br>import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;<br><br>public class PageView {<br>\tpublic static class TokenizerMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt; {<br>\t\tprivate final static IntWritable one = new IntWritable(1);<br>\t\tprivate Text word = new Text();<br><br>\t\tpublic void map(Object key, Text value, Context context) throws IOException, InterruptedException {<br>\t\t\tStringTokenizer itr = new StringTokenizer(value.toString());<br>\t\t\twhile (itr.hasMoreTokens()) {<br>\t\t\t\tword.set(itr.nextToken());<br>\t\t\t\tcontext.write(word, one);<br>\t\t\t}<br>\t\t}<br>\t}<br><br>\tpublic static class IntSumReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {<br>\t\tprivate IntWritable result = new IntWritable();<br><br>\t\tpublic void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context)<br>\t\t\t\tthrows IOException, InterruptedException {<br>\t\t\tint sum = 0;<br>\t\t\tfor (IntWritable val : values) {<br>\t\t\t\tsum += val.get();<br>\t\t\t}<br>\t\t\tresult.set(sum);<br>\t\t\tcontext.write(key, result);<br>\t\t}<br>\t}<br><br>\tpublic static void main(String[] args) throws Exception {<br>\t\tConfiguration conf = new Configuration();<br>\t\tJob job = Job.getInstance(conf, &quot;page view&quot;);<br>\t\tjob.setJarByClass(PageView.class);<br>\t\tjob.setMapperClass(TokenizerMapper.class);<br>\t\tjob.setCombinerClass(IntSumReducer.class);<br>\t\tjob.setReducerClass(IntSumReducer.class);<br>\t\tjob.setOutputKeyClass(Text.class);<br>\t\tjob.setOutputValueClass(IntWritable.class);<br>\t\tFileInputFormat.addInputPath(job, new Path(args[0]));<br>\t\tFileOutputFormat.setOutputPath(job, new Path(args[1]));<br>\t\tSystem.exit(job.waitForCompletion(true) ? 0 : 1);<br>\t}<br>}<br>","like_count":0},{"had_liked":false,"id":189785,"user_name":"åšä½ çš„çº¿ç¨‹","can_delete":false,"product_type":"c1","uid":1920691,"ip_address":"","ucode":"8D8EA8927381BE","user_header":"https://static001.geekbang.org/account/avatar/00/1d/4e/b3/f5f24e3a.jpg","comment_is_top":false,"comment_ctime":1584549013,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584549013","product_id":100020201,"comment_content":"è€å¸ˆä½ å¥½ï¼Œå¦‚ä½•ç”¨pythonä»£æ›¿javaå®ä¹ åŠŸèƒ½å‘¢","like_count":0},{"had_liked":false,"id":171493,"user_name":"æ·¤ç™½","can_delete":false,"product_type":"c1","uid":1206503,"ip_address":"","ucode":"D1E65DC40DAF68","user_header":"https://static001.geekbang.org/account/avatar/00/12/68/e7/ee47d0e2.jpg","comment_is_top":false,"comment_ctime":1578930954,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1578930954","product_id":100020201,"comment_content":"å°† pageid, age æ‹¼æ¥æˆä¸€ä¸ª keyï¼Œç”¨äº map æ“ä½œè®¡ç®—å‡ºç°çš„æ¬¡æ•°ï¼Œç„¶åç”¨ reduce åšç»Ÿè®¡ã€‚","like_count":0},{"had_liked":false,"id":164801,"user_name":"InfoQ_e077cb303519","can_delete":false,"product_type":"c1","uid":1390669,"ip_address":"","ucode":"2CCA309DB2EF46","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLAK6F4BFT5ewhJEeZrjmRx5HxP8tvnNpJcpLlotHiadp0s6aL3d7LfMHEuQP6tibu80wUy8micVu4oQ/132","comment_is_top":false,"comment_ctime":1577093174,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1577093174","product_id":100020201,"comment_content":"æŠ½è±¡é—®é¢˜ï¼Œæ´æ‚‰æœ¬è´¨ï¼Œæ·±æœ‰åŒæ„Ÿ","like_count":0},{"had_liked":false,"id":156809,"user_name":"Codingå°å…ˆ","can_delete":false,"product_type":"c1","uid":1051563,"ip_address":"","ucode":"965B1CC757E026","user_header":"https://static001.geekbang.org/account/avatar/00/10/0b/ab/0e2857e5.jpg","comment_is_top":false,"comment_ctime":1574961368,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574961368","product_id":100020201,"comment_content":"å¼„äº†ä¸ªè¿™ä¸ªï¼Œå¯¹è¿™ä¸ªå¼€å‘æœ‰äº†å¤§æ¦‚çš„äº†è§£<br><br>    public static class TokenizerMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt; {<br>        private Text id = new Text();<br>        private IntWritable num = new IntWritable();<br><br>        public void map(Object key, Text value, Context context) throws IOException, InterruptedException {<br>            &#47;&#47; æŒ‰ç…§ å›è½¦ ç©ºæ ¼ åˆ¶è¡¨ç¬¦ ç­‰æˆªæ–­ ä¼ å…¥çš„ value<br>            StringTokenizer itr = new StringTokenizer(value.toString());<br>            while (itr.hasMoreTokens()) {<br>                &#47;&#47; å†æ ¹æ® , åˆ‡å‰²ä¸€è¡Œè®°å½•<br>                StringTokenizer str = new StringTokenizer(itr.nextToken().toString(), &quot;,&quot;);<br>                &#47;&#47; id çš„å€¼<br>                id.set(str.nextToken());<br>                &#47;&#47; é”€é‡çš„å€¼ è½¬æ¢ä¸ºæ•´å‹<br>                num.set(Integer.parseInt(str.nextToken().toString()));<br>                &#47;&#47; å†™å…¥ Map<br>                context.write(id, num);<br>            }<br>      ","like_count":0},{"had_liked":false,"id":138400,"user_name":"æˆ‘æ˜¯è°","can_delete":false,"product_type":"c1","uid":1168322,"ip_address":"","ucode":"0CEE16C25F4B23","user_header":"https://static001.geekbang.org/account/avatar/00/11/d3/c2/3f32b93b.jpg","comment_is_top":false,"comment_ctime":1570197864,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570197864","product_id":100020201,"comment_content":"è€å¸ˆ  å¤§æ•°æ®è¿è¡Œç¯å¢ƒèƒ½å¦ä»‹ç»ä¸‹å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":136705,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1569494123,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569494123","product_id":100020201,"comment_content":"1ã€æœ¬æ–‡æ ¸å¿ƒè§‚ç‚¹ï¼š<br>1-1ï¼šå¤§æ•°æ®è®¡ç®—çš„æ ¸å¿ƒæ€è·¯æ˜¯ç§»åŠ¨è®¡ç®—æ¯”ç§»åŠ¨æ•°æ®æ›´åˆ’ç®—ã€‚<br>1-2ï¼šMapReduce æ—¢æ˜¯ä¸€ä¸ªç¼–ç¨‹æ¨¡å‹ï¼Œåˆæ˜¯ä¸€ä¸ªè®¡ç®—æ¡†æ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¼€å‘äººå‘˜å¿…é¡»åŸºäº MapReduce ç¼–ç¨‹æ¨¡å‹è¿›è¡Œç¼–ç¨‹å¼€å‘ï¼Œç„¶åå°†ç¨‹åºé€šè¿‡ MapReduce è®¡ç®—æ¡†æ¶åˆ†å‘åˆ° Hadoop é›†ç¾¤ä¸­è¿è¡Œã€‚å½“æˆ‘ä»¬è¯´ MapReduce çš„æ—¶å€™ï¼Œå¯èƒ½æŒ‡ç¼–ç¨‹æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª MapReduce ç¨‹åºï¼›ä¹Ÿå¯èƒ½æ˜¯æŒ‡è®¡ç®—æ¡†æ¶ï¼Œè°ƒåº¦æ‰§è¡Œå¤§æ•°æ®çš„åˆ†å¸ƒå¼è®¡ç®—ã€‚<br>1-3ï¼šè¿™äº›å¹´ï¼Œæˆ‘è‡ªå·±è®¤è¯†äº†å¾ˆå¤šä¼˜ç§€çš„äººï¼Œä»–ä»¬å„æœ‰æ‰€é•¿ã€å„æœ‰ç‰¹ç‚¹ï¼Œä½†æ˜¯æ— ä¸€ä¾‹å¤–éƒ½æœ‰ä¸ªå…±åŒçš„ç‰¹å¾ï¼Œå°±æ˜¯å¯¹äº‹ç‰©çš„æ´å¯ŸåŠ›ã€‚ä»–ä»¬èƒ½å¤Ÿç©¿é€äº‹ç‰©çš„å±‚å±‚è¿·é›¾ï¼Œç›´æŒ‡é—®é¢˜çš„æ ¸å¿ƒå’Œè¦å®³ï¼Œä¸ä¼šçŠ¹è±«å’Œè¿·èŒ«ï¼Œè½»æ¾å‡ºæ‰‹å°±æå®šäº†å…¶ä»–äººçœ‹èµ·æ¥æ— æ¯”è‰°éš¾çš„äº‹æƒ…ã€‚æœ‰æ—¶å€™å…‰æ˜¯çœ‹ä»–ä»¬åšäº‹å°±èƒ½æ„Ÿå—åˆ°ä¸€ç§ç¾æ„Ÿï¼Œè®©äººæ„é†‰ç¥è¿·ã€‚<br>1-4ï¼šæˆ‘å¸Œæœ›ä½ ä¹Ÿèƒ½å¤Ÿä¸æ–­è®­ç»ƒè‡ªå·±ï¼Œé‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œåœä¸‹æ¥æ€è€ƒä¸€ä¸‹ï¼šè¿™äº›ç°è±¡èƒŒåçš„è§„å¾‹æ˜¯ä»€ä¹ˆã€‚æœ‰æ—¶å€™å¹¶ä¸éœ€è¦å¤šä¹ˆè‰°æ·±çš„æ€è€ƒï¼Œä»…ä»…å°±æ˜¯åœä¸€ä¸‹ï¼Œå°±ä¼šè®©ä½ å¯Ÿè§‰åˆ°ä»¥å‰ä¸æ›¾æ³¨æ„åˆ°çš„ä¸€äº›æƒ…å†µï¼Œè¿›è€Œå‘ç°äº‹ç‰©çš„æ·±å±‚è§„å¾‹ã€‚è¿™å°±æ˜¯æ´å¯ŸåŠ›ã€‚<br><br>è€å¸ˆå‘€ï¼ä½ è¯´çš„æŠ½è±¡èƒ½åŠ›æˆ–è€…æ´å¯ŸåŠ›ï¼Œä¹Ÿæ˜¯æˆ‘ç¼ºå°‘çš„ï¼Œæˆ‘å¤«äººå¸¸è¯´è®©æˆ‘å­¦ç¼–ç¨‹çœŸæ˜¯éš¾ä¸ºæˆ‘å•¦ï¼å› ä¸ºï¼Œæˆ‘å¾ˆåŠªåŠ›çš„çœ‹ä¹¦å­¦ä¹ ï¼Œä½†æˆ‘çš„æ°´å¹³å´ä¸å’‹æ»´ï¼æˆ‘è‡ªå·±ä¹Ÿèƒ½æ„è¯†åˆ°äº†è¿™ä¸€ç‚¹ï¼Œçœ‹çš„ä¹¦æ—¶é—´ä¸€é•¿å°±è®°ä¸å¾—äº†ï¼Œå¤§æ¦‚åªæœ‰ä¸€ä¸ªæ¨¡ç³Šçš„å°è±¡ï¼Œè€Œä¸”é€Ÿåº¦ä¹Ÿæ…¢ï¼Œçœ‹æè¿åŒ–è¯´ä»–ä¸€å¹´èƒ½çœ‹50æœ¬æŠ€æœ¯ä¹¦ï¼Œå¹³å‡æ¯å‘¨ä¸€æœ¬ä¹¦ï¼ŒåƒXXXæƒå¨æŒ‡å—æˆ‘ä¸€èˆ¬è‡³å°‘ä¸€ä¸¤ä¸ªæœˆæ‰èƒ½çœ‹å®Œä¸€æœ¬ã€‚æ„Ÿè§‰è‡ªå·±å¥½æ„šé’å•Šï¼<br><br>MapReduce è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¯·é—®è€å¸ˆå›¾ä¸­mapçš„è¾“å…¥0&#47;12&#47;0&#47;13æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ<br>å¦å¤–ï¼Œæ„Ÿè§‰MapReduceç¡®å®ç¥å¥‡ï¼Œç°åœ¨è¿˜æœªä½“ä¼šåˆ°å¥¹æ€ä¹ˆåšåˆ°ï¼Œä¸ç®¡æ˜¯å…³ç³»ä»£æ•°è¿ç®—ï¼ˆSQL è®¡ç®—ï¼‰ï¼Œè¿˜æ˜¯çŸ©é˜µè¿ç®—ï¼ˆå›¾è®¡ç®—ï¼‰ï¼Œå¤§æ•°æ®é¢†åŸŸå‡ ä¹æ‰€æœ‰çš„è®¡ç®—éœ€æ±‚éƒ½å¯ä»¥é€šè¿‡ MapReduce ç¼–ç¨‹æ¥å®ç°ï¼Ÿ","like_count":0},{"had_liked":false,"id":126223,"user_name":"é•¿æœŸè§„åˆ’","can_delete":false,"product_type":"c1","uid":1019332,"ip_address":"","ucode":"5EF65E9115834B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8d/c4/6f97daea.jpg","comment_is_top":false,"comment_ctime":1566351313,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566351313","product_id":100020201,"comment_content":"è¿™åº”è¯¥æ˜¯åˆ†æ²»çš„ç®—æ³•æ€æƒ³","like_count":0},{"had_liked":false,"id":108441,"user_name":"ä¹æ¯…","can_delete":false,"product_type":"c1","uid":1348052,"ip_address":"","ucode":"6361ADC9B0E8D5","user_header":"https://static001.geekbang.org/account/avatar/00/14/91/d4/3785c799.jpg","comment_is_top":false,"comment_ctime":1561773480,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561773480","product_id":100020201,"comment_content":"æè€å¸ˆçš„è¯¾è®²å¾—å¾ˆå¥½ï¼Œå¯¹äºå¾ˆå¤šåˆå­¦è€…å¯ä»¥å…ˆäº†è§£ç¼–ç¨‹è¯­è¨€å±‚é¢ä¸Šçš„map&#47;reduce ,æ¯”å¦‚ES6æˆ–Pythonä¸­çš„map&#47;reduceå‡½æ•°ï¼Œjavaä¸­çš„stream lambda, ç„¶åè‡ªå·±æ­å»ºå­¦ä¹ ç¯å¢ƒï¼Œè¿™å½“ç„¶éœ€è¦äº†è§£linuxå’Œè®¡ç®—æœºç½‘ç»œç­‰åŸºç¡€çŸ¥è¯†ï¼Œå†å»ç¼–ç¨‹å®ç°è€å¸ˆè®²çš„demo. æœ€é‡è¦çš„æ˜¯ä¸€éçœ‹ä¸æ‡‚ï¼Œå†çœ‹ç¬¬äºŒéç¬¬ä¸‰éç”šè‡³æ›´å¤šéã€‚","like_count":0},{"had_liked":false,"id":100399,"user_name":"æ·±è‰²è¦†ç›–æµ…è‰²","can_delete":false,"product_type":"c1","uid":1033502,"ip_address":"","ucode":"47695FE55D5DB5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c5/1e/eb8cad6e.jpg","comment_is_top":false,"comment_ctime":1559546413,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559546413","product_id":100020201,"comment_content":"åœ¨æ–‡ä¸­WordCountçš„åŸºç¡€ä¸Šï¼ŒæŠŠmapå‡½æ•°ç¬¬11è¡Œæ”¹æˆStringTokenizer itr = new StringTokenizer(key.toString() + â€œ,â€ + value.toString()); å°±å¯ä»¥å®ç°pageid+ageåˆ†ç»„äº†å§<br>","like_count":0},{"had_liked":false,"id":94869,"user_name":"KellyMi","can_delete":false,"product_type":"c1","uid":1205142,"ip_address":"","ucode":"A1577537B819E8","user_header":"https://static001.geekbang.org/account/avatar/00/12/63/96/a9f97631.jpg","comment_is_top":false,"comment_ctime":1557913641,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1557913641","product_id":100020201,"comment_content":"å­¦ä¹ æ€»ç»“ï¼š<br>mapå‡½æ•°æ˜¯å¯¹æ¯ä¸ªéœ€è¦è®¡ç®—çš„ä¸œè¥¿ï¼ˆä¾‹å­ä¸­çš„wordã€æ€è€ƒé¢˜ä¸­çš„ä¸€è¡Œsqlè®°å½•ï¼Œkeyå€¼ä¸€èˆ¬ä¸ç”¨ï¼‰å•ç‹¬ç»Ÿè®¡ï¼Œæ¯æ¬¡åªè®°ä¸€ä¸ªï¼›è€Œreduceå‡½æ•°æ˜¯å¯¹æ¯ä¸ªkeyï¼ˆä¾‹å­ä¸­çš„wordã€æ€è€ƒé¢˜ä¸­çš„ä¸€è¡Œsqlè®°å½•ï¼‰å¯¹åº”çš„valuesåˆ†åˆ«åšä¸ªæ•°ç»Ÿè®¡ã€‚å¯¹äºsqlæ€è€ƒé¢˜æ¥è¯´ï¼Œreduceä¸ç”¨æ”¹ï¼Œmapå‡½æ•°ä¸­çš„itræ”¹æˆå•ä¸ªæ•°æ®åº“æœåŠ¡å™¨ä¸Šsqlè¿”å›çš„ç»“æœé›†ï¼Œwordæ”¹ä¸ºå•è¡ŒStringç±»å‹çš„è®°å½•ï¼ˆå¦‚â€œ2,25â€ï¼‰å°±å¯ä»¥ã€‚","like_count":0},{"had_liked":false,"id":89330,"user_name":"gkb111","can_delete":false,"product_type":"c1","uid":1224217,"ip_address":"","ucode":"9B3154BCC9046B","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLLUic3XzxET3L3QXxcTbeg96GMx1HkiaiaZdudchmOmtPnuEPHK5vYEeMkvJR098XljMbXDialYib3z6w/132","comment_is_top":false,"comment_ctime":1556155151,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1556155151","product_id":100020201,"comment_content":"æ´å¯ŸåŠ›ï¼ŒæŠ½è±¡äº‹ç‰©ï¼Œå‘ç°åº•å±‚çš„è§„å¾‹","like_count":0},{"had_liked":false,"id":65391,"user_name":"æ°ä¹‹7","can_delete":false,"product_type":"c1","uid":1297232,"ip_address":"","ucode":"F7DA2E21085332","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg","comment_is_top":false,"comment_ctime":1549331672,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1549331672","product_id":100020201,"comment_content":"é€šè¿‡è¿™ä¸€èŠ‚çš„å¤ä¹ ï¼Œé‡æ–°ç†è§£äº†Mapreudeä½œä¸ºæ•°æ®ç¼–ç¨‹æ¨¡å‹å’Œè®¡ç®—æ¡†æ¶çš„ä½œç”¨ã€‚<br><br>Mapreduceåˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼ŒMapå’Œreduceä¸¤é˜¶æ®µï¼Œä¸¤é˜¶æ®µéƒ½æ˜¯é€šè¿‡&lt;keyï¼Œvalue&gt;çš„å½¢æˆè¾“å…¥è¦è®¡ç®—çš„å†…å®¹ï¼Œè®¡ç®—æ¡†æ¶è´Ÿè´£å°†æ•°æ®æºä¼ å…¥ç»™Mapå’ŒReduceé˜¶æ®µã€‚Mapé€šè¿‡è®¡ç®—ä¹‹åå°†key,value(é›†åˆ)é€šè¿‡è®¡ç®—æ¡†æ¶ä¼ å…¥ç»™reduce,reduceå°†value(sum)æ±‡æ€»å¾—åˆ°ç»“æœã€‚åœ¨å¤§æ•°æ®ä¸­ï¼Œå¯¹äºå¤šå—æ•°æ®ï¼Œç”¨HDFSåˆ†å—å¾—åˆ°ã€‚æœ€åï¼Œå¯ä»¥å°±MRå¤„ç†çš„ç»“ç®—ç»“æœç”¨SQLè¯­å¥è¿›è¡ŒæŸ¥è¯¢ç»Ÿè®¡è®¡ç®—ã€‚<br><br>è¿™å°±æ˜¯è¿™è®²æ€»ç»“çš„å†…å®¹ï¼Œå½“ç„¶ï¼Œä»£ç ä¸­è®¾è®¡åˆ°Pythonå’ŒJavaçš„ä¸€äº›å†…å®¹ï¼Œè¿™æ˜¯ä½œä¸ºè®¡ç®—æœºæ•°æ®æŠ€æœ¯çš„åŸºç¡€ï¼ŒåŒæ ·ä¹Ÿéœ€è¦æˆ‘ä»¬æœ‰å¥½çš„æŒæ¡ï¼Œå¯¹ä¹‹åé—®é¢˜çš„è§£å†³ä¼šéå¸¸æœ‰å¸®åŠ©ã€‚","like_count":0},{"had_liked":false,"id":51570,"user_name":"swift","can_delete":false,"product_type":"c1","uid":1156148,"ip_address":"","ucode":"B243DCD10B04F0","user_header":"https://static001.geekbang.org/account/avatar/00/11/a4/34/0ab08db6.jpg","comment_is_top":false,"comment_ctime":1545201372,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1545201372","product_id":100020201,"comment_content":"æ–‡ç« ä¾‹å­ä¸­çš„ç»Ÿè®¡è¯æ•°çš„mapå‡½æ•°ï¼Œvalueåªæ˜¯å•çº¯åœ°è®¡1ã€‚å¦‚æœå…ˆç”¨å•æœºç®—æ³•ï¼ˆæ¯”å¦‚å‰é¢çš„å“ˆå¸Œè¡¨ç®—æ³•ï¼‰ç»Ÿè®¡å‡ºå½“å‰è¾“å…¥æ–‡æœ¬ç‰‡æ®µçš„æ¯ä¸ªå­—çš„ä¸ªæ•°åå†è¿”å›ï¼Œè¿™æ ·åœ¨REDUCEæ­¥éª¤ç´¯åŠ ä¹Ÿå¯ä»¥å§ï¼Ÿ ä¼¼ä¹è¿˜èƒ½å‡è½»æ¡†æ¶åˆå¹¶KEYçš„è´Ÿæ‹…ï¼Ÿå“ªç§å†™æ³•æ›´åˆç†ï¼Ÿ","like_count":0},{"had_liked":false,"id":45907,"user_name":"å°æ¸","can_delete":false,"product_type":"c1","uid":1071554,"ip_address":"","ucode":"C9D17E29297417","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ZmIcra83qKic2ter9A5mn5aiaRx0dQ4WpZ40QPr1oGNQlzwNZVE6USo60xx69URkm9SpeO6ayH6SyQTyVX1JP0eg/132","comment_is_top":false,"comment_ctime":1543816451,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543816451","product_id":100020201,"comment_content":"å¦‚æœmapæ˜¯æ•°æ®çš„é¢„å¤„ç†ï¼Œç„¶åreduceæ˜¯å¯¹æ•°æ®é¢„å¤„ç†ä¹‹åçš„æ±‚å’Œã€‚é‚£ä¹ˆä¸¤ä¸ªmapå¤„ç†ä¹‹åçš„ç»“æœå¦‚æœè¦åšå»é‡åº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæ¯”å¦‚ä¸€ä¸ªmapé‡Œé¢ä¸€ä¸ªuid 1 ï¼Œå¦å¤–ä¸€ä¸ªmapä¹Ÿæ˜¯uid 1ï¼Œreduce æ±‚å’Œå‡ºæ¥uidæ˜¯2ã€‚ä½†æ˜¯å®é™…ä¸Šå»é‡åæ˜¯1å‘€ã€‚","like_count":0},{"had_liked":false,"id":45366,"user_name":"çŸ³å¤´","can_delete":false,"product_type":"c1","uid":1142419,"ip_address":"","ucode":"DC24472A35EA40","user_header":"https://static001.geekbang.org/account/avatar/00/11/6e/93/6fef7aaa.jpg","comment_is_top":false,"comment_ctime":1543619546,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543619546","product_id":100020201,"comment_content":"æŠ½è±¡èƒ½åŠ›çš„è®­ç»ƒ:è¿™ä¸ªé—®é¢˜ä¸ºä»€ä¹ˆä¼šå‡ºç°ï¼ŸèƒŒåçš„è§„å¾‹æ˜¯ä»€ä¹ˆï¼Ÿåº”è¯¥æ€ä¹ˆåšï¼Ÿ","like_count":0},{"had_liked":false,"id":44135,"user_name":"Aron","can_delete":false,"product_type":"c1","uid":1236669,"ip_address":"","ucode":"6C07E662DB77C5","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/bd/a2ea7801.jpg","comment_is_top":false,"comment_ctime":1543372294,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543372294","product_id":100020201,"comment_content":"mapè¾“å‡ºkey valueï¼Œreduceçš„è¾“å…¥æ˜¯keyï¼Œvalue list,è¿™ç§è½¬æ¢æ˜¯æ¡†æ¶å®Œæˆçš„å—","like_count":0},{"had_liked":false,"id":43884,"user_name":"allan","can_delete":false,"product_type":"c1","uid":1142819,"ip_address":"","ucode":"CA0BE868AA9FF5","user_header":"https://static001.geekbang.org/account/avatar/00/11/70/23/972dcd30.jpg","comment_is_top":false,"comment_ctime":1543318011,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543318011","product_id":100020201,"comment_content":"æˆ‘æ˜¯ä¸€ååº”å±Šç”Ÿï¼Œæ˜¯ Linux C&#47;C++ å¼€å‘ï¼Œæœ€è¿‘æ‰¾åˆ°çš„å·¥ä½œæ˜¯å¤§æ•°æ®ç›¸å…³çš„ï¼Œç»ç†å¯¹æˆ‘è¯´å¼€å‘ç”¨çš„è¯­è¨€è¿˜æ˜¯ C++ï¼Œä½†æˆ‘äº†è§£åˆ°åƒ Hadoop å°±æ˜¯ Java&#47;Pythonï¼Œæ‰€ä»¥æƒ³é—®ä¸‹ä¼ä¸šé‡Œé¢æœ‰è‡ªå·±çš„ä¸€å¥—å·¥å…·å—ï¼Ÿè¿˜æ˜¯ç›´æ¥å°±æ˜¯ç”¨çš„ Hadoopï¼Ÿè°¢è°¢ã€‚","like_count":0},{"had_liked":false,"id":41147,"user_name":"ç‰›æ²¹æœ","can_delete":false,"product_type":"c1","uid":1047154,"ip_address":"","ucode":"897D927418C609","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fa/72/5c801d71.jpg","comment_is_top":false,"comment_ctime":1542732722,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1542732722","product_id":100020201,"comment_content":"æˆ´è€å¸ˆã€æ½˜å¤§ä¾ æ˜¯å“ªä¸¤ä½ä¸Šä»™ï¼Œè¯´å‡ºæ¥è®©æˆ‘ä»¬ä¹Ÿå»å­¦ä¹ ä¸€ä¸‹å•Šã€‚","like_count":0},{"had_liked":false,"id":41010,"user_name":"æ¢ç´¢æ— æ­¢å¢ƒ","can_delete":false,"product_type":"c1","uid":1044178,"ip_address":"","ucode":"91D2A9907DFA79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ee/d2/7024431c.jpg","comment_is_top":false,"comment_ctime":1542712753,"is_pvip":false,"replies":[{"id":"14790","content":"Javaæ‰§è¡Œæ•ˆç‡æ›´é«˜","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542765130,"ip_address":"","comment_id":41010,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542712753","product_id":100020201,"comment_content":"è€å¸ˆï¼Œå¤§æ•°æ®python,javaéƒ½å¯ä»¥ï¼Œæœ‰æ²¡æœ‰è¯´å“ªä¸ªè¯­è¨€ä¼šæ›´å…·å¤‡ä¼˜åŠ¿ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":429671,"discussion_content":"Javaæ‰§è¡Œæ•ˆç‡æ›´é«˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542765130,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38850,"user_name":"å…­ä¸ƒå°‘å¹´","can_delete":false,"product_type":"c1","uid":1294566,"ip_address":"","ucode":"F7205BC7BDA645","user_header":"https://static001.geekbang.org/account/avatar/00/13/c0/e6/c6600e06.jpg","comment_is_top":false,"comment_ctime":1542154311,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542154311","product_id":100020201,"comment_content":"è®²å¸ˆçš„è¯¾ä»¶å¾ˆæ£’ï¼Œå°±æ˜¯æ›´æ–°æ…¢äº†äº›ï¼Œèƒ½ä¸èƒ½åŠ å¿«ç‚¹èŠ‚å¥ï¼Œç‰¹åˆ«æœŸå¾…åé¢çš„è¿›é˜¶ç« èŠ‚","like_count":0},{"had_liked":false,"id":38816,"user_name":"äº­äº­äº­","can_delete":false,"product_type":"c1","uid":1283931,"ip_address":"","ucode":"DFD135FDEA79EA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJF2gTFBleTUHJtpV4KeyMGdiaycVkrX1JgZJITFfmUa4xWyiapicRF7h0Ur4YI5IdDJ9N43Q6ey8vyA/132","comment_is_top":false,"comment_ctime":1542146199,"is_pvip":false,"replies":[{"id":"14013","content":"å¯å‚è€ƒåç»­hiveä¸€æœŸä¸“æ ","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542238912,"ip_address":"","comment_id":38816,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542146199","product_id":100020201,"comment_content":"å¦‚æœæ˜¯non additiveçš„ç»“æœï¼Œmap reduce æ€ä¹ˆè®¡ç®—å‘¢","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428821,"discussion_content":"å¯å‚è€ƒåç»­hiveä¸€æœŸä¸“æ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542238912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38686,"user_name":"æ˜å¤©æ›´ç¾å¥½","can_delete":false,"product_type":"c1","uid":1180696,"ip_address":"","ucode":"F036B8718938BE","user_header":"https://static001.geekbang.org/account/avatar/00/12/04/18/4b02510f.jpg","comment_is_top":false,"comment_ctime":1542106100,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542106100","product_id":100020201,"comment_content":"æè€å¸ˆï¼Œæˆ‘æ˜¯ä¸€ä¸ªå­¦å‘˜ï¼Œæœ€è¿‘å…¬å¸æœ‰ä¸ªéœ€æ±‚æçš„æˆ‘å¤´ç–¼ï¼Œæ‰€ä»¥è¯·æ•™æ‚¨ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ¥å£å¹¶å‘å¾ˆå¤§ï¼Œæ—¥å¿—ä¸€å¤©2Tï¼Œé¢†å¯¼è¦æ±‚ä¿ç•™æœ€è¿‘åŠå¹´çš„æ—¥å¿—ï¼Œè€Œä¸”å…¶ä»–åº”ç”¨è°ƒæˆ‘ä»¬ï¼Œä¸€æœˆæ€»æœ‰é‚£ä¹ˆå‡ æ¬¡é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®æ—¥å¿—å®šä½é—®é¢˜ï¼Œæ‰€ä»¥è¦ç»å¸¸æŸ¥è¯¢ã€‚å¯èƒ½è¿˜è¦åˆ†æï¼Œæ¯”å¦‚æœ€è¿‘ä¸‰ä¸ªæœˆè°‹çœä»½åº”ç”¨è°ƒæˆ‘ä»¬æŸä¸ªæ¥å£å¤šå°‘ï¼ŒæˆåŠŸç‡å¤šå¤§ç­‰ï¼Œæˆ‘ä»¬èµ„æºæœ‰16å°ç‰©ç†æœºï¼Œ16æ ¸128Gå†…å­˜50Tå­˜å‚¨  æˆ‘æƒ³ç”¨elkè¿™ä¸ªèƒ½æŠ—ä½å—ï¼ŸåŠå¹´ä¸‹æ¥å°†è¿‘400Täº†ã€‚ä½†æ˜¯ç”¨å¤§æ•°æ®èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚å—ï¼Ÿå¸Œæœ›æ‚¨èƒ½ç»™æˆ‘ä¸ªå»ºè®®","like_count":0},{"had_liked":false,"id":38632,"user_name":"Reiser","can_delete":false,"product_type":"c1","uid":1078669,"ip_address":"","ucode":"E5DBBBA2F86FCE","user_header":"https://static001.geekbang.org/account/avatar/00/10/75/8d/c6a2a048.jpg","comment_is_top":false,"comment_ctime":1542090796,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1542090796","product_id":100020201,"comment_content":"MapReduce çš„ç¼–ç¨‹æ¨¡å‹è®©æˆ‘æƒ³åˆ°äº†å¿«é€Ÿæ’åºçš„åˆ†æ²»æ€æƒ³","like_count":0},{"had_liked":false,"id":38627,"user_name":"è§‚å¼ˆé“äºº","can_delete":false,"product_type":"c1","uid":1016905,"ip_address":"","ucode":"F3BB619A33C605","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/49/47d48fd0.jpg","comment_is_top":false,"comment_ctime":1542088598,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542088598","product_id":100020201,"comment_content":"åé¢é‚£æ®µè¡¨è¿°å¾ˆæ£’","like_count":0},{"had_liked":false,"id":38622,"user_name":"lyshrine","can_delete":false,"product_type":"c1","uid":1058278,"ip_address":"","ucode":"497551F047A5C6","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/e6/a69cff76.jpg","comment_is_top":false,"comment_ctime":1542087288,"is_pvip":false,"replies":[{"id":"13863","content":"Hadoopæ”¯æŒJavaï¼Œä¹Ÿæ”¯æŒPythonï¼Œç¼–å†™MapReduceç¨‹åº","user_name":"ä½œè€…å›å¤","user_name_real":"ææ™ºæ…§","uid":"1007349","ctime":1542112224,"ip_address":"","comment_id":38622,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1542087288","product_id":100020201,"comment_content":"è€å¸ˆï¼Œçœ‹æ‚¨ç”¨çš„pythonä¸¾ä¾‹ï¼Œè¯·é—®mapduceçš„ç¼–ç¨‹è¯­è¨€æ˜¯ä»€ä¹ˆå‘¢ï¼Œå„ç§è¯­è¨€éƒ½è¡Œå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1007349,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5e/f5/018907ac.jpg","nickname":"ææ™ºæ…§","note":"","ucode":"8C9980C438AFD1","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":428760,"discussion_content":"Hadoopæ”¯æŒJavaï¼Œä¹Ÿæ”¯æŒPythonï¼Œç¼–å†™MapReduceç¨‹åº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1542112224,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":38483,"user_name":"shaker","can_delete":false,"product_type":"c1","uid":1271555,"ip_address":"","ucode":"D43FD1CDAFF9FA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTISicpsLbj7rPEkmcVKdExIw4ezlhIiaRpddTIptDJCQvmFCF0QCp6HNHuTyrJicJOdcR1bMebIG3kUg/132","comment_is_top":false,"comment_ctime":1542065767,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542065767","product_id":100020201,"comment_content":"å…·ä½“å®ç°è·ŸWordCountå·®ä¸å¤šï¼Œåªæ˜¯keyå˜ä¸ºpageId+age","like_count":0},{"had_liked":false,"id":38461,"user_name":"æ— å½¢","can_delete":false,"product_type":"c1","uid":1016889,"ip_address":"","ucode":"B740E2A68A17A5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/84/39/c8772466.jpg","comment_is_top":false,"comment_ctime":1542039980,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1542039980","product_id":100020201,"comment_content":"çœ‹è€å¸ˆçš„æ–‡å­—ä¹Ÿæ˜¯ä¸€ç§ç¾çš„äº«å—ğŸ˜œà½¼","like_count":0}]}