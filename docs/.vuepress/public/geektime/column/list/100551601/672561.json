{"id":672561,"title":"模拟面试（一）｜微服务架构面试思路一图懂","content":"<p>你好，我是大明。</p><p>恭喜你学完第一章的内容，终于到了要验收成果的时刻了。微服务这一章的内容很多，而且知识点之间盘根错节，记忆起来并不容易，所以为了帮助你更好地掌握这部分内容，我们在这里设置了面试题。</p><p>你在回答的时候，最好是能够写成一个文档，至少也要口头上说一遍。千万不要只在脑海里面回忆一遍。因为在真正面试的时候，脑海中的记忆到嘴里说出的话，还需要一个转换。</p><p>此外，在回答的时候你可以从以下几个角度来评估自己的回答：</p><ul>\n<li>在面试前有没有想好自己要打造什么人设？你的回答有没有围绕这个人设进行？</li>\n<li>当你看到一个问题的时候，你能不能瞬间想到可以怎么刷亮点？怎么引导面试官？</li>\n<li>有没有在回答中留下足够的引导话术？</li>\n<li>有没有在我准备的回答基础上，糅合自己的项目经历，打造独一无二的回答？</li>\n</ul><p>我希望你可以通过我给你列出的这些问题，回想起我教给你的那些方案，真正地掌握这部分内容，下面我们开始通关吧！</p><h2>整体性问题</h2><p>✨ 什么是微服务架构？</p><p>✨ 怎么保证微服务架构的高可用？</p><p>还有下面这些问题，横跨了多个主题，可以从不同的角度回答。</p><p>✨ 怎么判定服务是否已经健康？</p><p>✨ 如果服务不健康该怎么办？</p><p>✨ 怎么判定服务已经从不健康状态恢复过来了？</p><p>✨ 听你说你用到了 Redis 作为缓存，如果你的 Redis 崩溃了会怎么样？</p><!-- [[[read_end]]] --><p>✨ 听你说你用到了 Kafka 作为消息队列，如果你的 Kafka 崩溃了怎么办？</p><p>✨ 现在需要设计一个开放平台，即提供接口给合作伙伴用，你觉得需要考虑一些什么问题？</p><h3>01｜服务注册与发现：注册中心应该选 AP 还是 CP？</h3><p>🔍 什么是注册中心？</p><p>🔍 服务注册与发现机制的基本模型是怎样的？</p><p>🔍 服务上线与服务下线的步骤是什么？</p><p>🔍 注册中心选型需要考虑哪些因素？</p><p>🔍 你为什么使用 Zookeeper/Nacos/etcd 作为你的注册中心？</p><p>🔍 什么是CAP?</p><p>🔍 在服务注册与发现里面你觉得应该用 AP 还是 CP？</p><p>🔍 如何保证服务注册与发现的高可用？</p><p>🔍 服务器崩溃，如何检测？</p><p>🔍 客户端容错的措施有哪些？</p><p>🔍 注册中心崩溃了怎么办？</p><p>🔍 注册中心怎么判断服务端已经崩溃了？</p><h3>02｜负载均衡：调用结果、缓存机制怎么影响负载均衡的？</h3><p>⚖️ 你了解负载均衡算法吗？</p><p>⚖️ 静态负载均衡算法和动态负载均衡算法的核心区别是什么？</p><p>⚖️ 轮询与随机负载均衡算法有什么区别？</p><p>⚖️ 你了解平滑的加权轮询算法吗？</p><p>⚖️ 如何根据调用结果来调整负载均衡效果？</p><p>⚖️ 为什么有些算法要动态调整节点的权重？权重究竟代表了什么？</p><p>⚖️ 你们公司的算法有没有调整过权重？为什么？</p><p>⚖️ 最快响应时间负载均衡算法有什么缺点？</p><p>⚖️ 如果我现在有一个应用，对内存和 CPU 都非常敏感，你可以针对这个特性设计一个负载均衡算法吗？</p><p>⚖️ 为什么使用轮询、加权轮询、随机之类的负载均衡算法，系统始终会出现偶发性的流量不均衡，以至于某台服务器出故障的情况？怎么解决这一类问题？</p><h3>03｜熔断：熔断-恢复-熔断-恢复，抖来抖去怎么办？</h3><p>🔥 为什么说熔断可以提高系统的可用性？</p><p>🔥 如何判断节点的健康状态，需要看哪些指标？</p><p>🔥 触发熔断之后，该熔断多久？</p><p>🔥 响应时间超过多少应该触发熔断？</p><p>🔥 响应时间超过阈值就一定要触发熔断吗？</p><p>🔥 怎么避免偶发性超过阈值的情况？</p><p>🔥 服务熔断后如何恢复？</p><p>🔥 产生抖动的原因，以及如何解决抖动问题？</p><h3>04｜降级：为什么每次大促的时候总是要把退款之类的服务停掉？</h3><p>🤚 什么时候会用到降级，请举例说明？</p><p>🤚 降级有什么好处？</p><p>🤚 跨服务降级常见的做法是什么？</p><p>🤚 你怎么评估业务服务的重要性？或者说，你怎么知道 A 服务比 B 服务更加重要？</p><p>🤚 请说一说服务内部常见的降级思路。</p><p>🤚 怎么判断哪些服务需要降级？</p><p>🤚 触发降级之后，应该保持在降级状态多久？</p><p>🤚 服务降级之后如何恢复，如何保证恢复过程中不发生抖动？</p><p>🤚 你们公司的产品首页是如何保证高可用的？</p><h3>05｜限流：别说算法了，就问你阈值怎么算？限流的目的是什么？</h3><p>🏁 限流算法都包括哪些？</p><p>🏁 不同的限流算法怎么选？</p><p>🏁 限流的对象应该如何选择？</p><p>🏁 怎么确定流量的阈值？</p><p>🏁 如何应对突发流量？</p><p>🏁 被限流的请求会被怎么处理？</p><p>🏁 为什么使用了限流，系统还是有可能崩溃？</p><p>🏁 我们有一个功能，对于普通用户来说，一些接口需要限制在每分钟不超过 10 次，整天不能超过 1000 次；VIP 用户不限制。你怎么解决这个问题？</p><h3>06｜隔离：怎么保证尊贵的 VIP 用户体验不受损？</h3><p>🤝 什么是隔离，你用来解决什么问题？</p><p>🤝 你了解哪些隔离策略？你用过哪些？</p><p>🤝 当某个服务崩溃的时候，你有什么办法保证其它服务不受影响？</p><p>🤝 在使用线程池、连接池和协程池的时候，怎么避免业务之间相互影响？</p><h3>07｜超时控制：怎么保证用户一定能在1s内拿到响应？</h3><p>🕙 为什么要做超时控制？</p><p>🕙 为什么缺乏超时控制有可能引起连接泄露、线程泄露？</p><p>🕙 什么是链路超时控制？</p><p>🕙 如何确定超时时间？</p><p>🕙 怎么在链路中传递超时时间？</p><p>🕙 超时时间传递的是什么？</p><p>🕙 如何计算网络传输时间？</p><p>🕙 什么是时钟同步问题？</p><p>🕙 客户端和服务端谁来监听超时？</p><p>🕙 超时之后能不能中断业务？怎么中断？</p><h3>08｜调用第三方：下游的接口不稳定性能又差怎么办？</h3><p>🌊 如何保证调用第三方接口的可用性？</p><p>🌊 如果在出错的时候你会切换不同的第三方，但是如果全部第三方换一遍之后都崩溃了，怎么办？</p><p>🌊 调用第三方接口出错的时候，你是怎么重试的？重试次数和重试间隔你是怎么确定的？</p><p>🌊 你怎么判定第三方服务已经非常不可用，以至于要切换一个新的第三方服务了？</p><p>🌊 对时效性要求不高的接口，你可以怎么优化架构？</p><p>🌊 在压力测试一个接口的时候，如果这个接口依赖了一个第三方接口，你怎么解决？</p><p>🌊 公司业务依赖一个非常关键的第三方依赖，我要怎么保证我在调用第三方的时候不出错？</p><h2>一图懂</h2><h2><img src=\"https://static001.geekbang.org/resource/image/21/49/21dd6b903c7421505be505yy14a7a549.jpg?wh=8888x4002\" alt=\"图片\"></h2><p>最后我将这节课的内容整理成了一张图片，图片能够更好地展现知识点之间的联系，你可以参考，如果你觉得有用的话，可以把这节课的内容分享给身边的朋友，邀他一起学习，共同进步。好了，我们下一章再见吧！</p>","comments":[{"had_liked":false,"id":378604,"user_name":"浩仔是程序员","can_delete":false,"product_type":"c1","uid":1104601,"ip_address":"广东","ucode":"A7E5CF9E1571A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/d9/f051962f.jpg","comment_is_top":false,"comment_ctime":1690471335,"is_pvip":false,"replies":[{"id":137980,"content":"怕什么，这些面试官也知道你不是主要负责人。你在面试的时候强调自己考察调研过公司的各种基础设施，确认了各种高可用方案就可以了。大部分人出去面试是说不清楚的，你能说清楚就是优势了","user_name":"作者回复","user_name_real":"编辑","uid":1176655,"ctime":1690605545,"ip_address":"广东","comment_id":378604,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100551601,"comment_content":"作为业务同学，虽然有用到高可用的组件，但这都是依赖于公司维护的基础设施，心里还是有一些虚的","like_count":7,"discussions":[{"author":{"id":1176655,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f4/4f/aa916c8c.jpg","nickname":"邓小明","note":"","ucode":"02243D1F7492A6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":624479,"discussion_content":"怕什么，这些面试官也知道你不是主要负责人。你在面试的时候强调自己考察调研过公司的各种基础设施，确认了各种高可用方案就可以了。大部分人出去面试是说不清楚的，你能说清楚就是优势了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690605545,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":380327,"user_name":"Jason Ding","can_delete":false,"product_type":"c1","uid":1365944,"ip_address":"上海","ucode":"E62AB51E7F2D6E","user_header":"https://static001.geekbang.org/account/avatar/00/14/d7/b8/c42d2527.jpg","comment_is_top":false,"comment_ctime":1693381531,"is_pvip":false,"replies":[{"id":138536,"content":"比较简单的问题，这个专栏倒是没有。比如一些基本概念的题目，只是帮助大家梳理一下面试官可能出题的思路。","user_name":"作者回复","user_name_real":"编辑","uid":1176655,"ctime":1693488155,"ip_address":"广东","comment_id":380327,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100551601,"comment_content":"上面的问题有答案嘛？","like_count":0,"discussions":[{"author":{"id":1176655,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f4/4f/aa916c8c.jpg","nickname":"邓小明","note":"","ucode":"02243D1F7492A6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626917,"discussion_content":"比较简单的问题，这个专栏倒是没有。比如一些基本概念的题目，只是帮助大家梳理一下面试官可能出题的思路。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693488156,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2843479,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/63/57/cba4c68b.jpg","nickname":"小虎子🐯","note":"","ucode":"4C9530B3FB407B","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626800,"discussion_content":"答案都在课程里，如果你认真看了课程的话，应该可以自己回答上来的，这些问题就是为了检验学习效果的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693383265,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379246,"user_name":"手冢治熊","can_delete":false,"product_type":"c1","uid":2093706,"ip_address":"广东","ucode":"E9C83FFFCD5AE6","user_header":"https://static001.geekbang.org/account/avatar/00/1f/f2/8a/87ee84dd.jpg","comment_is_top":false,"comment_ctime":1691594363,"is_pvip":false,"replies":[{"id":138214,"content":"我咔嚓手写了之后，我再顺手手写一个 lua 版用于 Redis 的，再嘲讽一下开源的用 Redis 限流各种并发问题，然后收工回家，hhhh。\n字节的话，应该是 Go 语言写？Go 语言里面用 Channel 写令牌桶和漏桶特别简单。","user_name":"作者回复","user_name_real":"编辑","uid":1176655,"ctime":1691755107,"ip_address":"广东","comment_id":379246,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100551601,"comment_content":"在字节的面试上问到了限流算法的实现","like_count":0,"discussions":[{"author":{"id":1176655,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f4/4f/aa916c8c.jpg","nickname":"邓小明","note":"","ucode":"02243D1F7492A6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625497,"discussion_content":"我咔嚓手写了之后，我再顺手手写一个 lua 版用于 Redis 的，再嘲讽一下开源的用 Redis 限流各种并发问题，然后收工回家，hhhh。\n字节的话，应该是 Go 语言写？Go 语言里面用 Channel 写令牌桶和漏桶特别简单。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691755107,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377832,"user_name":"五号特派员","can_delete":false,"product_type":"c1","uid":3653946,"ip_address":"四川","ucode":"D92133F112A20D","user_header":"https://static001.geekbang.org/account/avatar/00/37/c1/3a/880a0932.jpg","comment_is_top":false,"comment_ctime":1689316644,"is_pvip":false,"replies":[{"id":137704,"content":"对于校招来说，一般的要求是你需要掌握它的基本理论，也就是从服务注册与发现到服务治理的整个东西。大厂还会额外要求由微服务架构衍生出来的微服务网关之类的话题。\n如果你想要赢得竞争优势，最好是有在微服务架构上工作的经验。\n当然，微服务架构本身就是分布式系统，所以你肯定得知道分布式系统的基本理论。校招主打的还是一个八股文背好，对你在实践上的要求不会很高。","user_name":"作者回复","user_name_real":"编辑","uid":1176655,"ctime":1689423507,"ip_address":"广东","comment_id":377832,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100551601,"comment_content":"请问老师，对校招来说，微服务这块的知识掌握到什么程度比较好呢","like_count":0,"discussions":[{"author":{"id":1176655,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f4/4f/aa916c8c.jpg","nickname":"邓小明","note":"","ucode":"02243D1F7492A6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623401,"discussion_content":"对于校招来说，一般的要求是你需要掌握它的基本理论，也就是从服务注册与发现到服务治理的整个东西。大厂还会额外要求由微服务架构衍生出来的微服务网关之类的话题。\n如果你想要赢得竞争优势，最好是有在微服务架构上工作的经验。\n当然，微服务架构本身就是分布式系统，所以你肯定得知道分布式系统的基本理论。校招主打的还是一个八股文背好，对你在实践上的要求不会很高。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1689423507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377546,"user_name":"奔跑的小黄牛","can_delete":false,"product_type":"c1","uid":1104869,"ip_address":"广东","ucode":"C4E014CA41CB66","user_header":"https://static001.geekbang.org/account/avatar/00/10/db/e5/26c2f7de.jpg","comment_is_top":false,"comment_ctime":1688691710,"is_pvip":false,"replies":[{"id":137597,"content":"加油加油！","user_name":"作者回复","user_name_real":"编辑","uid":1176655,"ctime":1688829423,"ip_address":"广东","comment_id":377546,"utype":1}],"discussion_count":1,"race_medal":1,"score":2,"product_id":100551601,"comment_content":"为我复习微服务知识指明了路。感谢老师！","like_count":0,"discussions":[{"author":{"id":1176655,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f4/4f/aa916c8c.jpg","nickname":"邓小明","note":"","ucode":"02243D1F7492A6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622930,"discussion_content":"加油加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688829423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393999,"user_name":"Oops.","can_delete":false,"product_type":"c1","uid":2417425,"ip_address":"广东","ucode":"CD09467A1FD407","user_header":"https://static001.geekbang.org/account/avatar/00/24/e3/11/ead4ce75.jpg","comment_is_top":false,"comment_ctime":1725519010,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100551601,"comment_content":"老师能不能提供一下你自己的一些想法回答给参考一下？很多时候没有自己的经验想要参考学习然后面试的时候代入进去来讲","like_count":0}]}