{"id":213273,"title":"05 | HTTPè°ƒç”¨ï¼šä½ è€ƒè™‘åˆ°è¶…æ—¶ã€é‡è¯•ã€å¹¶å‘äº†å—ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ™”ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸€èµ·èŠèŠè¿›è¡ŒHTTPè°ƒç”¨éœ€è¦æ³¨æ„çš„è¶…æ—¶ã€é‡è¯•ã€å¹¶å‘ç­‰é—®é¢˜ã€‚</p><p>ä¸æ‰§è¡Œæœ¬åœ°æ–¹æ³•ä¸åŒï¼Œè¿›è¡ŒHTTPè°ƒç”¨æœ¬è´¨ä¸Šæ˜¯é€šè¿‡HTTPåè®®è¿›è¡Œä¸€æ¬¡ç½‘ç»œè¯·æ±‚ã€‚ç½‘ç»œè¯·æ±‚å¿…ç„¶æœ‰è¶…æ—¶çš„å¯èƒ½æ€§ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»è€ƒè™‘åˆ°è¿™ä¸‰ç‚¹ï¼š</p><ul>\n<li>é¦–å…ˆï¼Œæ¡†æ¶è®¾ç½®çš„é»˜è®¤è¶…æ—¶æ˜¯å¦åˆç†ï¼›</li>\n<li>å…¶æ¬¡ï¼Œè€ƒè™‘åˆ°ç½‘ç»œçš„ä¸ç¨³å®šï¼Œè¶…æ—¶åçš„è¯·æ±‚é‡è¯•æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä½†éœ€è¦è€ƒè™‘æœåŠ¡ç«¯æ¥å£çš„å¹‚ç­‰æ€§è®¾è®¡æ˜¯å¦å…è®¸æˆ‘ä»¬é‡è¯•ï¼›</li>\n<li>æœ€åï¼Œéœ€è¦è€ƒè™‘æ¡†æ¶æ˜¯å¦ä¼šåƒæµè§ˆå™¨é‚£æ ·é™åˆ¶å¹¶å‘è¿æ¥æ•°ï¼Œä»¥å…åœ¨æœåŠ¡å¹¶å‘å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼ŒHTTPè°ƒç”¨çš„å¹¶å‘æ•°é™åˆ¶æˆä¸ºç“¶é¢ˆã€‚</li>\n</ul><p>Spring Cloudæ˜¯Javaå¾®æœåŠ¡æ¶æ„çš„ä»£è¡¨æ€§æ¡†æ¶ã€‚å¦‚æœä½¿ç”¨Spring Cloudè¿›è¡Œå¾®æœåŠ¡å¼€å‘ï¼Œå°±ä¼šä½¿ç”¨Feignè¿›è¡Œå£°æ˜å¼çš„æœåŠ¡è°ƒç”¨ã€‚å¦‚æœä¸ä½¿ç”¨Spring Cloudï¼Œè€Œç›´æ¥ä½¿ç”¨Spring Bootè¿›è¡Œå¾®æœåŠ¡å¼€å‘çš„è¯ï¼Œå¯èƒ½ä¼šç›´æ¥ä½¿ç”¨Javaä¸­æœ€å¸¸ç”¨çš„HTTPå®¢æˆ·ç«¯Apache HttpClientè¿›è¡ŒæœåŠ¡è°ƒç”¨ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±çœ‹çœ‹ä½¿ç”¨Feignå’ŒApache HttpClientè¿›è¡ŒHTTPæ¥å£è°ƒç”¨æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°çš„è¶…æ—¶ã€é‡è¯•å’Œå¹¶å‘æ–¹é¢çš„å‘ã€‚</p><h2>é…ç½®è¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶å‚æ•°çš„å­¦é—®</h2><p>å¯¹äºHTTPè°ƒç”¨ï¼Œè™½ç„¶åº”ç”¨å±‚èµ°çš„æ˜¯HTTPåè®®ï¼Œä½†ç½‘ç»œå±‚é¢å§‹ç»ˆæ˜¯TCP/IPåè®®ã€‚TCP/IPæ˜¯é¢å‘è¿æ¥çš„åè®®ï¼Œåœ¨ä¼ è¾“æ•°æ®ä¹‹å‰éœ€è¦å»ºç«‹è¿æ¥ã€‚å‡ ä¹æ‰€æœ‰çš„ç½‘ç»œæ¡†æ¶éƒ½ä¼šæä¾›è¿™ä¹ˆä¸¤ä¸ªè¶…æ—¶å‚æ•°ï¼š</p><!-- [[[read_end]]] --><ul>\n<li>è¿æ¥è¶…æ—¶å‚æ•°ConnectTimeoutï¼Œè®©ç”¨æˆ·é…ç½®å»ºè¿é˜¶æ®µçš„æœ€é•¿ç­‰å¾…æ—¶é—´ï¼›</li>\n<li>è¯»å–è¶…æ—¶å‚æ•°ReadTimeoutï¼Œç”¨æ¥æ§åˆ¶ä»Socketä¸Šè¯»å–æ•°æ®çš„æœ€é•¿ç­‰å¾…æ—¶é—´ã€‚</li>\n</ul><p>è¿™ä¸¤ä¸ªå‚æ•°çœ‹ä¼¼æ˜¯ç½‘ç»œå±‚ååº•å±‚çš„é…ç½®å‚æ•°ï¼Œä¸è¶³ä»¥å¼•èµ·å¼€å‘åŒå­¦çš„é‡è§†ã€‚ä½†ï¼Œæ­£ç¡®ç†è§£å’Œé…ç½®è¿™ä¸¤ä¸ªå‚æ•°ï¼Œå¯¹ä¸šåŠ¡åº”ç”¨ç‰¹åˆ«é‡è¦ï¼Œæ¯•ç«Ÿè¶…æ—¶ä¸æ˜¯å•æ–¹é¢çš„äº‹æƒ…ï¼Œéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯¹è¶…æ—¶æœ‰ä¸€è‡´çš„ä¼°è®¡ï¼ŒååŒé…åˆæ–¹èƒ½å¹³è¡¡ååé‡å’Œé”™è¯¯ç‡ã€‚</p><p><strong>è¿æ¥è¶…æ—¶å‚æ•°å’Œè¿æ¥è¶…æ—¶çš„è¯¯åŒºæœ‰è¿™ä¹ˆä¸¤ä¸ªï¼š</strong></p><ul>\n<li><strong>è¿æ¥è¶…æ—¶é…ç½®å¾—ç‰¹åˆ«é•¿ï¼Œæ¯”å¦‚60ç§’ã€‚</strong>ä¸€èˆ¬æ¥è¯´ï¼ŒTCPä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥éœ€è¦çš„æ—¶é—´éå¸¸çŸ­ï¼Œé€šå¸¸åœ¨æ¯«ç§’çº§æœ€å¤šåˆ°ç§’çº§ï¼Œä¸å¯èƒ½éœ€è¦åå‡ ç§’ç”šè‡³å‡ åç§’ã€‚å¦‚æœå¾ˆä¹…éƒ½æ— æ³•å»ºè¿ï¼Œå¾ˆå¯èƒ½æ˜¯ç½‘ç»œæˆ–é˜²ç«å¢™é…ç½®çš„é—®é¢˜ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœå‡ ç§’è¿æ¥ä¸ä¸Šï¼Œé‚£ä¹ˆå¯èƒ½æ°¸è¿œä¹Ÿè¿æ¥ä¸ä¸Šã€‚å› æ­¤ï¼Œè®¾ç½®ç‰¹åˆ«é•¿çš„è¿æ¥è¶…æ—¶æ„ä¹‰ä¸å¤§ï¼Œå°†å…¶é…ç½®å¾—çŸ­ä¸€äº›ï¼ˆæ¯”å¦‚1~5ç§’ï¼‰å³å¯ã€‚å¦‚æœæ˜¯çº¯å†…ç½‘è°ƒç”¨çš„è¯ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥è®¾ç½®å¾—æ›´çŸ­ï¼Œåœ¨ä¸‹æ¸¸æœåŠ¡ç¦»çº¿æ— æ³•è¿æ¥çš„æ—¶å€™ï¼Œå¯ä»¥å¿«é€Ÿå¤±è´¥ã€‚</li>\n<li><strong>æ’æŸ¥è¿æ¥è¶…æ—¶é—®é¢˜ï¼Œå´æ²¡ç†æ¸…è¿çš„æ˜¯å“ªé‡Œã€‚</strong>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„æœåŠ¡ä¼šæœ‰å¤šä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœåˆ«çš„å®¢æˆ·ç«¯é€šè¿‡å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡æŠ€æœ¯æ¥è¿æ¥æœåŠ¡ç«¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¼šç›´æ¥å»ºç«‹è¿æ¥ï¼Œæ­¤æ—¶å‡ºç°è¿æ¥è¶…æ—¶å¤§æ¦‚ç‡æ˜¯æœåŠ¡ç«¯çš„é—®é¢˜ï¼›è€Œå¦‚æœæœåŠ¡ç«¯é€šè¿‡ç±»ä¼¼Nginxçš„åå‘ä»£ç†æ¥è´Ÿè½½å‡è¡¡ï¼Œå®¢æˆ·ç«¯è¿æ¥çš„å…¶å®æ˜¯Nginxï¼Œè€Œä¸æ˜¯æœåŠ¡ç«¯ï¼Œæ­¤æ—¶å‡ºç°è¿æ¥è¶…æ—¶åº”è¯¥æ’æŸ¥Nginxã€‚</li>\n</ul><p><strong>è¯»å–è¶…æ—¶å‚æ•°å’Œè¯»å–è¶…æ—¶åˆ™ä¼šæœ‰æ›´å¤šçš„è¯¯åŒºï¼Œæˆ‘å°†å…¶å½’çº³ä¸ºå¦‚ä¸‹ä¸‰ä¸ªã€‚</strong></p><p><strong>ç¬¬ä¸€ä¸ªè¯¯åŒºï¼š</strong>è®¤ä¸ºå‡ºç°äº†è¯»å–è¶…æ—¶ï¼ŒæœåŠ¡ç«¯çš„æ‰§è¡Œå°±ä¼šä¸­æ–­ã€‚</p><p>æˆ‘ä»¬æ¥ç®€å•æµ‹è¯•ä¸‹ã€‚å®šä¹‰ä¸€ä¸ªclientæ¥å£ï¼Œå†…éƒ¨é€šè¿‡HttpClientè°ƒç”¨æœåŠ¡ç«¯æ¥å£serverï¼Œå®¢æˆ·ç«¯è¯»å–è¶…æ—¶2ç§’ï¼ŒæœåŠ¡ç«¯æ¥å£æ‰§è¡Œè€—æ—¶5ç§’ã€‚</p><pre><code>@RestController\n@RequestMapping(&quot;clientreadtimeout&quot;)\n@Slf4j\npublic class ClientReadTimeoutController {\n    private String getResponse(String url, int connectTimeout, int readTimeout) throws IOException {\n        return Request.Get(&quot;http://localhost:45678/clientreadtimeout&quot; + url)\n                .connectTimeout(connectTimeout)\n                .socketTimeout(readTimeout)\n                .execute()\n                .returnContent()\n                .asString();\n    }\n    \n    @GetMapping(&quot;client&quot;)\n    public String client() throws IOException {\n        log.info(&quot;client1 called&quot;);\n        //æœåŠ¡ç«¯5sè¶…æ—¶ï¼Œå®¢æˆ·ç«¯è¯»å–è¶…æ—¶2ç§’\n        return getResponse(&quot;/server?timeout=5000&quot;, 1000, 2000);\n    }\n\n    @GetMapping(&quot;server&quot;)\n    public void server(@RequestParam(&quot;timeout&quot;) int timeout) throws InterruptedException {\n        log.info(&quot;server called&quot;);\n        TimeUnit.MILLISECONDS.sleep(timeout);\n        log.info(&quot;Done&quot;);\n    }\n}\n</code></pre><p>è°ƒç”¨clientæ¥å£åï¼Œä»æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå®¢æˆ·ç«¯2ç§’åå‡ºç°äº†SocketTimeoutExceptionï¼ŒåŸå› æ˜¯è¯»å–è¶…æ—¶ï¼ŒæœåŠ¡ç«¯å´ä¸æ¯«æ²¡å—å½±å“åœ¨3ç§’åæ‰§è¡Œå®Œæˆã€‚</p><pre><code>[11:35:11.943] [http-nio-45678-exec-1] [INFO ] [.t.c.c.d.ClientReadTimeoutController:29  ] - client1 called\n[11:35:12.032] [http-nio-45678-exec-2] [INFO ] [.t.c.c.d.ClientReadTimeoutController:36  ] - server called\n[11:35:14.042] [http-nio-45678-exec-1] [ERROR] [.a.c.c.C.[.[.[/].[dispatcherServlet]:175 ] - Servlet.service() for servlet [dispatcherServlet] in context with path [] threw exception\njava.net.SocketTimeoutException: Read timed out\n\tat java.net.SocketInputStream.socketRead0(Native Method)\n\t...\n[11:35:17.036] [http-nio-45678-exec-2] [INFO ] [.t.c.c.d.ClientReadTimeoutController:38  ] - Done\n</code></pre><p>æˆ‘ä»¬çŸ¥é“ï¼Œç±»ä¼¼Tomcatçš„WebæœåŠ¡å™¨éƒ½æ˜¯æŠŠæœåŠ¡ç«¯è¯·æ±‚æäº¤åˆ°çº¿ç¨‹æ± å¤„ç†çš„ï¼Œåªè¦æœåŠ¡ç«¯æ”¶åˆ°äº†è¯·æ±‚ï¼Œç½‘ç»œå±‚é¢çš„è¶…æ—¶å’Œæ–­å¼€ä¾¿ä¸ä¼šå½±å“æœåŠ¡ç«¯çš„æ‰§è¡Œã€‚å› æ­¤ï¼Œå‡ºç°è¯»å–è¶…æ—¶ä¸èƒ½éšæ„å‡è®¾æœåŠ¡ç«¯çš„å¤„ç†æƒ…å†µï¼Œéœ€è¦æ ¹æ®ä¸šåŠ¡çŠ¶æ€è€ƒè™‘å¦‚ä½•è¿›è¡Œåç»­å¤„ç†ã€‚</p><p><strong>ç¬¬äºŒä¸ªè¯¯åŒºï¼š</strong>è®¤ä¸ºè¯»å–è¶…æ—¶åªæ˜¯Socketç½‘ç»œå±‚é¢çš„æ¦‚å¿µï¼Œæ˜¯æ•°æ®ä¼ è¾“çš„æœ€é•¿è€—æ—¶ï¼Œæ•…å°†å…¶é…ç½®å¾—éå¸¸çŸ­ï¼Œæ¯”å¦‚100æ¯«ç§’ã€‚</p><p>å…¶å®ï¼Œå‘ç”Ÿäº†è¯»å–è¶…æ—¶ï¼Œç½‘ç»œå±‚é¢æ— æ³•åŒºåˆ†æ˜¯æœåŠ¡ç«¯æ²¡æœ‰æŠŠæ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œè¿˜æ˜¯æ•°æ®åœ¨ç½‘ç»œä¸Šè€—æ—¶è¾ƒä¹…æˆ–ä¸¢åŒ…ã€‚</p><p>ä½†ï¼Œå› ä¸ºTCPæ˜¯å…ˆå»ºç«‹è¿æ¥åä¼ è¾“æ•°æ®ï¼Œå¯¹äºç½‘ç»œæƒ…å†µä¸æ˜¯ç‰¹åˆ«ç³Ÿç³•çš„æœåŠ¡è°ƒç”¨ï¼Œé€šå¸¸å¯ä»¥è®¤ä¸ºå‡ºç°è¿æ¥è¶…æ—¶æ˜¯ç½‘ç»œé—®é¢˜æˆ–æœåŠ¡ä¸åœ¨çº¿ï¼Œè€Œå‡ºç°è¯»å–è¶…æ—¶æ˜¯æœåŠ¡å¤„ç†è¶…æ—¶ã€‚ç¡®åˆ‡åœ°è¯´ï¼Œè¯»å–è¶…æ—¶æŒ‡çš„æ˜¯ï¼Œå‘Socketå†™å…¥æ•°æ®åï¼Œæˆ‘ä»¬ç­‰åˆ°Socketè¿”å›æ•°æ®çš„è¶…æ—¶æ—¶é—´ï¼Œå…¶ä¸­åŒ…å«çš„æ—¶é—´æˆ–è€…è¯´ç»å¤§éƒ¨åˆ†çš„æ—¶é—´ï¼Œæ˜¯æœåŠ¡ç«¯å¤„ç†ä¸šåŠ¡é€»è¾‘çš„æ—¶é—´ã€‚</p><p><strong>ç¬¬ä¸‰ä¸ªè¯¯åŒºï¼š</strong>è®¤ä¸ºè¶…æ—¶æ—¶é—´è¶Šé•¿ä»»åŠ¡æ¥å£æˆåŠŸç‡å°±è¶Šé«˜ï¼Œå°†è¯»å–è¶…æ—¶å‚æ•°é…ç½®å¾—å¤ªé•¿ã€‚</p><p>è¿›è¡ŒHTTPè¯·æ±‚ä¸€èˆ¬æ˜¯éœ€è¦è·å¾—ç»“æœçš„ï¼Œå±äºåŒæ­¥è°ƒç”¨ã€‚å¦‚æœè¶…æ—¶æ—¶é—´å¾ˆé•¿ï¼Œåœ¨ç­‰å¾…æœåŠ¡ç«¯è¿”å›æ•°æ®çš„åŒæ—¶ï¼Œå®¢æˆ·ç«¯çº¿ç¨‹ï¼ˆé€šå¸¸æ˜¯Tomcatçº¿ç¨‹ï¼‰ä¹Ÿåœ¨ç­‰å¾…ï¼Œå½“ä¸‹æ¸¸æœåŠ¡å‡ºç°å¤§é‡è¶…æ—¶çš„æ—¶å€™ï¼Œç¨‹åºå¯èƒ½ä¹Ÿä¼šå—åˆ°æ‹–ç´¯åˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œæœ€ç»ˆå´©æºƒã€‚</p><p>å¯¹å®šæ—¶ä»»åŠ¡æˆ–å¼‚æ­¥ä»»åŠ¡æ¥è¯´ï¼Œè¯»å–è¶…æ—¶é…ç½®å¾—é•¿äº›é—®é¢˜ä¸å¤§ã€‚ä½†é¢å‘ç”¨æˆ·å“åº”çš„è¯·æ±‚æˆ–æ˜¯å¾®æœåŠ¡çŸ­å¹³å¿«çš„åŒæ­¥æ¥å£è°ƒç”¨ï¼Œå¹¶å‘é‡ä¸€èˆ¬è¾ƒå¤§ï¼Œæˆ‘ä»¬åº”è¯¥è®¾ç½®ä¸€ä¸ªè¾ƒçŸ­çš„è¯»å–è¶…æ—¶æ—¶é—´ï¼Œä»¥é˜²æ­¢è¢«ä¸‹æ¸¸æœåŠ¡æ‹–æ…¢ï¼Œé€šå¸¸ä¸ä¼šè®¾ç½®è¶…è¿‡30ç§’çš„è¯»å–è¶…æ—¶ã€‚</p><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œå¦‚æœæŠŠè¯»å–è¶…æ—¶è®¾ç½®ä¸º2ç§’ï¼ŒæœåŠ¡ç«¯æ¥å£éœ€è¦3ç§’ï¼Œå²‚ä¸æ˜¯æ°¸è¿œéƒ½æ‹¿ä¸åˆ°æ‰§è¡Œç»“æœäº†ï¼Ÿçš„ç¡®æ˜¯è¿™æ ·ï¼Œå› æ­¤è®¾ç½®è¯»å–è¶…æ—¶ä¸€å®šè¦æ ¹æ®å®é™…æƒ…å†µï¼Œè¿‡é•¿å¯èƒ½ä¼šè®©ä¸‹æ¸¸æŠ–åŠ¨å½±å“åˆ°è‡ªå·±ï¼Œè¿‡çŸ­åˆå¯èƒ½å½±å“æˆåŠŸç‡ã€‚ç”šè‡³ï¼Œæœ‰äº›æ—¶å€™æˆ‘ä»¬è¿˜è¦æ ¹æ®ä¸‹æ¸¸æœåŠ¡çš„SLAï¼Œä¸ºä¸åŒçš„æœåŠ¡ç«¯æ¥å£è®¾ç½®ä¸åŒçš„å®¢æˆ·ç«¯è¯»å–è¶…æ—¶ã€‚</p><h2>Feignå’ŒRibboné…åˆä½¿ç”¨ï¼Œä½ çŸ¥é“æ€ä¹ˆé…ç½®è¶…æ—¶å—ï¼Ÿ</h2><p>åˆšæ‰æˆ‘å¼ºè°ƒäº†æ ¹æ®è‡ªå·±çš„éœ€æ±‚é…ç½®è¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶çš„é‡è¦æ€§ï¼Œä½ æ˜¯å¦å°è¯•è¿‡ä¸ºSpring Cloudçš„Feigné…ç½®è¶…æ—¶å‚æ•°å‘¢ï¼Œæœ‰æ²¡æœ‰è¢«ç½‘ä¸Šçš„å„ç§èµ„æ–™ç»•æ™•å‘¢ï¼Ÿ</p><p>åœ¨æˆ‘çœ‹æ¥ï¼Œä¸ºFeigné…ç½®è¶…æ—¶å‚æ•°çš„å¤æ‚ä¹‹å¤„åœ¨äºï¼ŒFeignè‡ªå·±æœ‰ä¸¤ä¸ªè¶…æ—¶å‚æ•°ï¼Œå®ƒä½¿ç”¨çš„è´Ÿè½½å‡è¡¡ç»„ä»¶Ribbonæœ¬èº«è¿˜æœ‰ç›¸å…³é…ç½®ã€‚é‚£ä¹ˆï¼Œè¿™äº›é…ç½®çš„ä¼˜å…ˆçº§æ˜¯æ€æ ·çš„ï¼Œåˆå“ªäº›ä»€ä¹ˆå‘å‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åšä¸€äº›å®éªŒå§ã€‚</p><p>ä¸ºæµ‹è¯•æœåŠ¡ç«¯çš„è¶…æ—¶ï¼Œå‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªæœåŠ¡ç«¯æ¥å£ï¼Œä»€ä¹ˆéƒ½ä¸å¹²åªä¼‘çœ 10åˆ†é’Ÿï¼š</p><pre><code>@PostMapping(&quot;/server&quot;)\npublic void server() throws InterruptedException {\n    TimeUnit.MINUTES.sleep(10);\n}\n</code></pre><p>é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªFeignæ¥è°ƒç”¨è¿™ä¸ªæ¥å£ï¼š</p><pre><code>@FeignClient(name = &quot;clientsdk&quot;)\npublic interface Client {\n    @PostMapping(&quot;/feignandribbon/server&quot;)\n    void server();\n}\n</code></pre><p>ç„¶åï¼Œé€šè¿‡Feign Clientè¿›è¡Œæ¥å£è°ƒç”¨ï¼š</p><pre><code>@GetMapping(&quot;client&quot;)\npublic void timeout() {\n    long begin=System.currentTimeMillis();\n    try{\n        client.server();\n    }catch (Exception ex){\n        log.warn(&quot;æ‰§è¡Œè€—æ—¶ï¼š{}ms é”™è¯¯ï¼š{}&quot;, System.currentTimeMillis() - begin, ex.getMessage());\n    }\n}\n</code></pre><p>åœ¨é…ç½®æ–‡ä»¶ä»…æŒ‡å®šæœåŠ¡ç«¯åœ°å€çš„æƒ…å†µä¸‹ï¼š</p><pre><code>clientsdk.ribbon.listOfServers=localhost:45678\n</code></pre><p>å¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p><pre><code>[15:40:16.094] [http-nio-45678-exec-3] [WARN ] [o.g.t.c.h.f.FeignAndRibbonController    :26  ] - æ‰§è¡Œè€—æ—¶ï¼š1007ms é”™è¯¯ï¼šRead timed out executing POST http://clientsdk/feignandribbon/server\n</code></pre><p>ä»è¿™ä¸ªè¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<strong>ç»“è®ºä¸€ï¼Œé»˜è®¤æƒ…å†µä¸‹Feignçš„è¯»å–è¶…æ—¶æ˜¯1ç§’ï¼Œå¦‚æ­¤çŸ­çš„è¯»å–è¶…æ—¶ç®—æ˜¯å‘ç‚¹ä¸€</strong>ã€‚</p><p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹æºç ã€‚æ‰“å¼€RibbonClientConfigurationç±»åï¼Œä¼šçœ‹åˆ°DefaultClientConfigImplè¢«åˆ›å»ºå‡ºæ¥ä¹‹åï¼ŒReadTimeoutå’ŒConnectTimeoutè¢«è®¾ç½®ä¸º1sï¼š</p><pre><code>/**\n * Ribbon client default connect timeout.\n */\npublic static final int DEFAULT_CONNECT_TIMEOUT = 1000;\n\n/**\n * Ribbon client default read timeout.\n */\npublic static final int DEFAULT_READ_TIMEOUT = 1000;\n\n@Bean\n@ConditionalOnMissingBean\npublic IClientConfig ribbonClientConfig() {\n   DefaultClientConfigImpl config = new DefaultClientConfigImpl();\n   config.loadProperties(this.name);\n   config.set(CommonClientConfigKey.ConnectTimeout, DEFAULT_CONNECT_TIMEOUT);\n   config.set(CommonClientConfigKey.ReadTimeout, DEFAULT_READ_TIMEOUT);\n   config.set(CommonClientConfigKey.GZipPayload, DEFAULT_GZIP_PAYLOAD);\n   return config;\n}\n</code></pre><p>å¦‚æœè¦ä¿®æ”¹Feignå®¢æˆ·ç«¯é»˜è®¤çš„ä¸¤ä¸ªå…¨å±€è¶…æ—¶æ—¶é—´ï¼Œä½ å¯ä»¥è®¾ç½®feign.client.config.default.readTimeoutå’Œfeign.client.config.default.connectTimeoutå‚æ•°ï¼š</p><pre><code>feign.client.config.default.readTimeout=3000\nfeign.client.config.default.connectTimeout=3000\n</code></pre><p>ä¿®æ”¹é…ç½®åé‡è¯•ï¼Œå¾—åˆ°å¦‚ä¸‹æ—¥å¿—ï¼š</p><pre><code>[15:43:39.955] [http-nio-45678-exec-3] [WARN ] [o.g.t.c.h.f.FeignAndRibbonController    :26  ] - æ‰§è¡Œè€—æ—¶ï¼š3006ms é”™è¯¯ï¼šRead timed out executing POST http://clientsdk/feignandribbon/server\n</code></pre><p>å¯è§ï¼Œ3ç§’è¯»å–è¶…æ—¶ç”Ÿæ•ˆäº†ã€‚æ³¨æ„ï¼šè¿™é‡Œæœ‰ä¸€ä¸ªå¤§å‘ï¼Œå¦‚æœä½ å¸Œæœ›åªä¿®æ”¹è¯»å–è¶…æ—¶ï¼Œå¯èƒ½ä¼šåªé…ç½®è¿™ä¹ˆä¸€è¡Œï¼š</p><pre><code>feign.client.config.default.readTimeout=3000\n</code></pre><p>æµ‹è¯•ä¸€ä¸‹ä½ å°±ä¼šå‘ç°ï¼Œè¿™æ ·çš„é…ç½®æ˜¯æ— æ³•ç”Ÿæ•ˆçš„ï¼</p><p><strong>ç»“è®ºäºŒï¼Œä¹Ÿæ˜¯å‘ç‚¹äºŒï¼Œå¦‚æœè¦é…ç½®Feignçš„è¯»å–è¶…æ—¶ï¼Œå°±å¿…é¡»åŒæ—¶é…ç½®è¿æ¥è¶…æ—¶ï¼Œæ‰èƒ½ç”Ÿæ•ˆ</strong>ã€‚</p><p>æ‰“å¼€FeignClientFactoryBeanå¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰åŒæ—¶è®¾ç½®ConnectTimeoutå’ŒReadTimeoutï¼ŒRequest.Optionsæ‰ä¼šè¢«è¦†ç›–ï¼š</p><pre><code>if (config.getConnectTimeout() != null &amp;&amp; config.getReadTimeout() != null) {\n   builder.options(new Request.Options(config.getConnectTimeout(),\n         config.getReadTimeout()));\n}\n</code></pre><p>æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœä½ å¸Œæœ›é’ˆå¯¹å•ç‹¬çš„Feign Clientè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥æŠŠdefaultæ›¿æ¢ä¸ºClientçš„nameï¼š</p><pre><code>feign.client.config.default.readTimeout=3000\nfeign.client.config.default.connectTimeout=3000\nfeign.client.config.clientsdk.readTimeout=2000\nfeign.client.config.clientsdk.connectTimeout=2000\n</code></pre><p>å¯ä»¥å¾—å‡º<strong>ç»“è®ºä¸‰ï¼Œå•ç‹¬çš„è¶…æ—¶å¯ä»¥è¦†ç›–å…¨å±€è¶…æ—¶ï¼Œè¿™ç¬¦åˆé¢„æœŸï¼Œä¸ç®—å‘</strong>ï¼š</p><pre><code>[15:45:51.708] [http-nio-45678-exec-3] [WARN ] [o.g.t.c.h.f.FeignAndRibbonController    :26  ] - æ‰§è¡Œè€—æ—¶ï¼š2006ms é”™è¯¯ï¼šRead timed out executing POST http://clientsdk/feignandribbon/server\n</code></pre><p><strong>ç»“è®ºå››ï¼Œé™¤äº†å¯ä»¥é…ç½®Feignï¼Œä¹Ÿå¯ä»¥é…ç½®Ribbonç»„ä»¶çš„å‚æ•°æ¥ä¿®æ”¹ä¸¤ä¸ªè¶…æ—¶æ—¶é—´ã€‚è¿™é‡Œçš„å‘ç‚¹ä¸‰æ˜¯ï¼Œå‚æ•°é¦–å­—æ¯è¦å¤§å†™ï¼Œå’ŒFeignçš„é…ç½®ä¸åŒ</strong>ã€‚</p><pre><code>ribbon.ReadTimeout=4000\nribbon.ConnectTimeout=4000\n</code></pre><p>å¯ä»¥é€šè¿‡æ—¥å¿—è¯æ˜å‚æ•°ç”Ÿæ•ˆï¼š</p><pre><code>[15:55:18.019] [http-nio-45678-exec-3] [WARN ] [o.g.t.c.h.f.FeignAndRibbonController    :26  ] - æ‰§è¡Œè€—æ—¶ï¼š4003ms é”™è¯¯ï¼šRead timed out executing POST http://clientsdk/feignandribbon/server\n</code></pre><p>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åŒæ—¶é…ç½®Feignå’ŒRibbonçš„å‚æ•°ï¼Œæœ€ç»ˆè°ä¼šç”Ÿæ•ˆï¼Ÿå¦‚ä¸‹ä»£ç çš„å‚æ•°é…ç½®ï¼š</p><pre><code>clientsdk.ribbon.listOfServers=localhost:45678\nfeign.client.config.default.readTimeout=3000\nfeign.client.config.default.connectTimeout=3000\nribbon.ReadTimeout=4000\nribbon.ConnectTimeout=4000\n</code></pre><p>æ—¥å¿—è¾“å‡ºè¯æ˜ï¼Œæœ€ç»ˆç”Ÿæ•ˆçš„æ˜¯Feignçš„è¶…æ—¶ï¼š</p><pre><code>[16:01:19.972] [http-nio-45678-exec-3] [WARN ] [o.g.t.c.h.f.FeignAndRibbonController    :26  ] - æ‰§è¡Œè€—æ—¶ï¼š3006ms é”™è¯¯ï¼šRead timed out executing POST http://clientsdk/feignandribbon/server\n</code></pre><p><strong>ç»“è®ºäº”ï¼ŒåŒæ—¶é…ç½®Feignå’ŒRibbonçš„è¶…æ—¶ï¼Œä»¥Feignä¸ºå‡†</strong>ã€‚è¿™æœ‰ç‚¹åç›´è§‰ï¼Œå› ä¸ºRibbonæ›´åº•å±‚æ‰€ä»¥ä½ ä¼šè§‰å¾—åè€…çš„é…ç½®ä¼šç”Ÿæ•ˆï¼Œä½†å…¶å®ä¸æ˜¯è¿™æ ·çš„ã€‚</p><p>åœ¨LoadBalancerFeignClientæºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœRequest.Optionsä¸æ˜¯é»˜è®¤å€¼ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªFeignOptionsClientConfigä»£æ›¿åŸæ¥Ribbonçš„DefaultClientConfigImplï¼Œå¯¼è‡´Ribbonçš„é…ç½®è¢«Feignè¦†ç›–ï¼š</p><pre><code>IClientConfig getClientConfig(Request.Options options, String clientName) {\n   IClientConfig requestConfig;\n   if (options == DEFAULT_OPTIONS) {\n      requestConfig = this.clientFactory.getClientConfig(clientName);\n   }\n   else {\n      requestConfig = new FeignOptionsClientConfig(options);\n   }\n   return requestConfig;\n}\n</code></pre><p>ä½†å¦‚æœè¿™ä¹ˆé…ç½®æœ€ç»ˆç”Ÿæ•ˆçš„è¿˜æ˜¯Ribbonçš„è¶…æ—¶ï¼ˆ4ç§’ï¼‰ï¼Œè¿™å®¹æ˜“è®©äººäº§ç”ŸRibbonè¦†ç›–äº†Feignçš„é”™è§‰ï¼Œå…¶å®è¿™è¿˜æ˜¯å› ä¸ºå‘äºŒæ‰€è‡´ï¼Œå•ç‹¬é…ç½®Feignçš„è¯»å–è¶…æ—¶å¹¶ä¸èƒ½ç”Ÿæ•ˆï¼š</p><pre><code>clientsdk.ribbon.listOfServers=localhost:45678\nfeign.client.config.default.readTimeout=3000\nfeign.client.config.clientsdk.readTimeout=2000\nribbon.ReadTimeout=4000\n</code></pre><h2>ä½ æ˜¯å¦çŸ¥é“Ribbonä¼šè‡ªåŠ¨é‡è¯•è¯·æ±‚å‘¢ï¼Ÿ</h2><p>ä¸€äº›HTTPå®¢æˆ·ç«¯å¾€å¾€ä¼šå†…ç½®ä¸€äº›é‡è¯•ç­–ç•¥ï¼Œå…¶åˆè¡·æ˜¯å¥½çš„ï¼Œæ¯•ç«Ÿå› ä¸ºç½‘ç»œé—®é¢˜å¯¼è‡´ä¸¢åŒ…è™½ç„¶é¢‘ç¹ä½†æŒç»­æ—¶é—´çŸ­ï¼Œå¾€å¾€é‡è¯•ä¸‹ç¬¬äºŒæ¬¡å°±èƒ½æˆåŠŸï¼Œä½†ä¸€å®šè¦å°å¿ƒè¿™ç§è‡ªä½œä¸»å¼ æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚</p><p>ä¹‹å‰é‡åˆ°è¿‡ä¸€ä¸ªçŸ­ä¿¡é‡å¤å‘é€çš„é—®é¢˜ï¼Œä½†çŸ­ä¿¡æœåŠ¡çš„è°ƒç”¨æ–¹ç”¨æˆ·æœåŠ¡ï¼Œåå¤ç¡®è®¤ä»£ç é‡Œæ²¡æœ‰é‡è¯•é€»è¾‘ã€‚é‚£é—®é¢˜ç©¶ç«Ÿå‡ºåœ¨å“ªé‡Œäº†ï¼Ÿæˆ‘ä»¬æ¥é‡ç°ä¸€ä¸‹è¿™ä¸ªæ¡ˆä¾‹ã€‚</p><p>é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªGetè¯·æ±‚çš„å‘é€çŸ­ä¿¡æ¥å£ï¼Œé‡Œé¢æ²¡æœ‰ä»»ä½•é€»è¾‘ï¼Œä¼‘çœ 2ç§’æ¨¡æ‹Ÿè€—æ—¶ï¼š</p><pre><code>@RestController\n@RequestMapping(&quot;ribbonretryissueserver&quot;)\n@Slf4j\npublic class RibbonRetryIssueServerController {\n    @GetMapping(&quot;sms&quot;)\n    public void sendSmsWrong(@RequestParam(&quot;mobile&quot;) String mobile, @RequestParam(&quot;message&quot;) String message, HttpServletRequest request) throws InterruptedException {\n        //è¾“å‡ºè°ƒç”¨å‚æ•°åä¼‘çœ 2ç§’\n        log.info(&quot;{} is called, {}=&gt;{}&quot;, request.getRequestURL().toString(), mobile, message);\n        TimeUnit.SECONDS.sleep(2);\n    }\n}\n</code></pre><p>é…ç½®ä¸€ä¸ªFeignä¾›å®¢æˆ·ç«¯è°ƒç”¨ï¼š</p><pre><code>@FeignClient(name = &quot;SmsClient&quot;)\npublic interface SmsClient {\n    @GetMapping(&quot;/ribbonretryissueserver/sms&quot;)\n    void sendSmsWrong(@RequestParam(&quot;mobile&quot;) String mobile, @RequestParam(&quot;message&quot;) String message);\n}\n</code></pre><p>Feignå†…éƒ¨æœ‰ä¸€ä¸ªRibbonç»„ä»¶è´Ÿè´£å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶è®¾ç½®å…¶è°ƒç”¨çš„æœåŠ¡ç«¯ä¸ºä¸¤ä¸ªèŠ‚ç‚¹ï¼š</p><pre><code>SmsClient.ribbon.listOfServers=localhost:45679,localhost:45678\n</code></pre><p>å†™ä¸€ä¸ªå®¢æˆ·ç«¯æ¥å£ï¼Œé€šè¿‡Feignè°ƒç”¨æœåŠ¡ç«¯ï¼š</p><pre><code>@RestController\n@RequestMapping(&quot;ribbonretryissueclient&quot;)\n@Slf4j\npublic class RibbonRetryIssueClientController {\n    @Autowired\n    private SmsClient smsClient;\n\n    @GetMapping(&quot;wrong&quot;)\n    public String wrong() {\n        log.info(&quot;client is called&quot;);\n        try{\n            //é€šè¿‡Feignè°ƒç”¨å‘é€çŸ­ä¿¡æ¥å£\n            smsClient.sendSmsWrong(&quot;13600000000&quot;, UUID.randomUUID().toString());\n        } catch (Exception ex) {\n            //æ•è·å¯èƒ½å‡ºç°çš„ç½‘ç»œé”™è¯¯\n            log.error(&quot;send sms failed : {}&quot;, ex.getMessage());\n        }\n        return &quot;done&quot;;\n    }\n}\n</code></pre><p>åœ¨45678å’Œ45679ä¸¤ä¸ªç«¯å£ä¸Šåˆ†åˆ«å¯åŠ¨æœåŠ¡ç«¯ï¼Œç„¶åè®¿é—®45678çš„å®¢æˆ·ç«¯æ¥å£è¿›è¡Œæµ‹è¯•ã€‚å› ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ§åˆ¶å™¨åœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œæ‰€ä»¥45678åŒæ—¶æ‰®æ¼”äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„è§’è‰²ã€‚</p><p>åœ¨45678æ—¥å¿—ä¸­å¯ä»¥çœ‹åˆ°ï¼Œ29ç§’æ—¶å®¢æˆ·ç«¯æ”¶åˆ°è¯·æ±‚å¼€å§‹è°ƒç”¨æœåŠ¡ç«¯æ¥å£å‘çŸ­ä¿¡ï¼ŒåŒæ—¶æœåŠ¡ç«¯æ”¶åˆ°äº†è¯·æ±‚ï¼Œ2ç§’åï¼ˆæ³¨æ„å¯¹æ¯”ç¬¬ä¸€æ¡æ—¥å¿—å’Œç¬¬ä¸‰æ¡æ—¥å¿—ï¼‰å®¢æˆ·ç«¯è¾“å‡ºäº†è¯»å–è¶…æ—¶çš„é”™è¯¯ä¿¡æ¯ï¼š</p><pre><code>[12:49:29.020] [http-nio-45678-exec-4] [INFO ] [c.d.RibbonRetryIssueClientController:23  ] - client is called\n[12:49:29.026] [http-nio-45678-exec-5] [INFO ] [c.d.RibbonRetryIssueServerController:16  ] - http://localhost:45678/ribbonretryissueserver/sms is called, 13600000000=&gt;a2aa1b32-a044-40e9-8950-7f0189582418\n[12:49:31.029] [http-nio-45678-exec-4] [ERROR] [c.d.RibbonRetryIssueClientController:27  ] - send sms failed : Read timed out executing GET http://SmsClient/ribbonretryissueserver/sms?mobile=13600000000&amp;message=a2aa1b32-a044-40e9-8950-7f0189582418\n</code></pre><p>è€Œåœ¨å¦ä¸€ä¸ªæœåŠ¡ç«¯45679çš„æ—¥å¿—ä¸­è¿˜å¯ä»¥çœ‹åˆ°ä¸€æ¡è¯·æ±‚ï¼Œ30ç§’æ—¶æ”¶åˆ°è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯æ¥å£è°ƒç”¨åçš„1ç§’ï¼š</p><pre><code>[12:49:30.029] [http-nio-45679-exec-2] [INFO ] [c.d.RibbonRetryIssueServerController:16  ] - http://localhost:45679/ribbonretryissueserver/sms is called, 13600000000=&gt;a2aa1b32-a044-40e9-8950-7f0189582418\n</code></pre><p>å®¢æˆ·ç«¯æ¥å£è¢«è°ƒç”¨çš„æ—¥å¿—åªè¾“å‡ºäº†ä¸€æ¬¡ï¼Œè€ŒæœåŠ¡ç«¯çš„æ—¥å¿—è¾“å‡ºäº†ä¸¤æ¬¡ã€‚è™½ç„¶Feignçš„é»˜è®¤è¯»å–è¶…æ—¶æ—¶é—´æ˜¯1ç§’ï¼Œä½†å®¢æˆ·ç«¯2ç§’åæ‰å‡ºç°è¶…æ—¶é”™è¯¯ã€‚<strong>æ˜¾ç„¶ï¼Œè¿™è¯´æ˜å®¢æˆ·ç«¯è‡ªä½œä¸»å¼ è¿›è¡Œäº†ä¸€æ¬¡é‡è¯•ï¼Œå¯¼è‡´çŸ­ä¿¡é‡å¤å‘é€ã€‚</strong></p><p>ç¿»çœ‹Ribbonçš„æºç å¯ä»¥å‘ç°ï¼ŒMaxAutoRetriesNextServerå‚æ•°é»˜è®¤ä¸º1ï¼Œä¹Ÿå°±æ˜¯Getè¯·æ±‚åœ¨æŸä¸ªæœåŠ¡ç«¯èŠ‚ç‚¹å‡ºç°é—®é¢˜ï¼ˆæ¯”å¦‚è¯»å–è¶…æ—¶ï¼‰æ—¶ï¼ŒRibbonä¼šè‡ªåŠ¨é‡è¯•ä¸€æ¬¡ï¼š</p><pre><code>// DefaultClientConfigImpl\npublic static final int DEFAULT_MAX_AUTO_RETRIES_NEXT_SERVER = 1;\npublic static final int DEFAULT_MAX_AUTO_RETRIES = 0;\n\n// RibbonLoadBalancedRetryPolicy\npublic boolean canRetry(LoadBalancedRetryContext context) {\n   HttpMethod method = context.getRequest().getMethod();\n   return HttpMethod.GET == method || lbContext.isOkToRetryOnAllOperations();\n}\n\n@Override\npublic boolean canRetrySameServer(LoadBalancedRetryContext context) {\n   return sameServerCount &lt; lbContext.getRetryHandler().getMaxRetriesOnSameServer()\n         &amp;&amp; canRetry(context);\n}\n\n@Override\npublic boolean canRetryNextServer(LoadBalancedRetryContext context) {\n   // this will be called after a failure occurs and we increment the counter\n   // so we check that the count is less than or equals to too make sure\n   // we try the next server the right number of times\n   return nextServerCount &lt;= lbContext.getRetryHandler().getMaxRetriesOnNextServer()\n         &amp;&amp; canRetry(context);\n}\n</code></pre><p>è§£å†³åŠæ³•æœ‰ä¸¤ä¸ªï¼š</p><ul>\n<li>ä¸€æ˜¯ï¼ŒæŠŠå‘çŸ­ä¿¡æ¥å£ä»Getæ”¹ä¸ºPostã€‚å…¶å®ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªAPIè®¾è®¡é—®é¢˜ï¼Œæœ‰çŠ¶æ€çš„APIæ¥å£ä¸åº”è¯¥å®šä¹‰ä¸ºGetã€‚æ ¹æ®HTTPåè®®çš„è§„èŒƒï¼ŒGetè¯·æ±‚ç”¨äºæ•°æ®æŸ¥è¯¢ï¼Œè€ŒPostæ‰æ˜¯æŠŠæ•°æ®æäº¤åˆ°æœåŠ¡ç«¯ç”¨äºä¿®æ”¹æˆ–æ–°å¢ã€‚é€‰æ‹©Getè¿˜æ˜¯Postçš„ä¾æ®ï¼Œåº”è¯¥æ˜¯APIçš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯å‚æ•°å¤§å°ã€‚<strong>è¿™é‡Œçš„ä¸€ä¸ªè¯¯åŒºæ˜¯ï¼ŒGetè¯·æ±‚çš„å‚æ•°åŒ…å«åœ¨Url QueryStringä¸­ï¼Œä¼šå—æµè§ˆå™¨é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥ä¸€äº›åŒå­¦ä¼šé€‰æ‹©ä½¿ç”¨JSONä»¥Postæäº¤å¤§å‚æ•°ï¼Œä½¿ç”¨Getæäº¤å°å‚æ•°ã€‚</strong></li>\n<li>äºŒæ˜¯ï¼Œå°†MaxAutoRetriesNextServerå‚æ•°é…ç½®ä¸º0ï¼Œç¦ç”¨æœåŠ¡è°ƒç”¨å¤±è´¥ååœ¨ä¸‹ä¸€ä¸ªæœåŠ¡ç«¯èŠ‚ç‚¹çš„è‡ªåŠ¨é‡è¯•ã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œå³å¯ï¼š</li>\n</ul><pre><code>ribbon.MaxAutoRetriesNextServer=0\n</code></pre><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ è§‰å¾—é—®é¢˜å‡ºåœ¨ç”¨æˆ·æœåŠ¡è¿˜æ˜¯çŸ­ä¿¡æœåŠ¡å‘¢ï¼Ÿ</p><p>åœ¨æˆ‘çœ‹æ¥ï¼ŒåŒæ–¹éƒ½æœ‰é—®é¢˜ã€‚å°±åƒä¹‹å‰è¯´çš„ï¼ŒGetè¯·æ±‚åº”è¯¥æ˜¯æ— çŠ¶æ€æˆ–è€…å¹‚ç­‰çš„ï¼ŒçŸ­ä¿¡æ¥å£å¯ä»¥è®¾è®¡ä¸ºæ”¯æŒå¹‚ç­‰è°ƒç”¨çš„ï¼›è€Œç”¨æˆ·æœåŠ¡çš„å¼€å‘åŒå­¦ï¼Œå¦‚æœå¯¹Ribbonçš„é‡è¯•æœºåˆ¶æœ‰æ‰€äº†è§£çš„è¯ï¼Œæˆ–è®¸å°±èƒ½åœ¨æ’æŸ¥é—®é¢˜ä¸Šå°‘èµ°äº›å¼¯è·¯ã€‚</p><h2>å¹¶å‘é™åˆ¶äº†çˆ¬è™«çš„æŠ“å–èƒ½åŠ›</h2><p>é™¤äº†è¶…æ—¶å’Œé‡è¯•çš„å‘ï¼Œè¿›è¡ŒHTTPè¯·æ±‚è°ƒç”¨è¿˜æœ‰ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯ï¼Œå¹¶å‘æ•°çš„é™åˆ¶å¯¼è‡´ç¨‹åºçš„å¤„ç†èƒ½åŠ›ä¸Šä¸å»ã€‚</p><p>æˆ‘ä¹‹å‰é‡åˆ°è¿‡ä¸€ä¸ªçˆ¬è™«é¡¹ç›®ï¼Œæ•´ä½“çˆ¬å–æ•°æ®çš„æ•ˆç‡å¾ˆä½ï¼Œå¢åŠ çº¿ç¨‹æ± æ•°é‡ä¹Ÿæ— æµäºäº‹ï¼Œåªèƒ½å †æ›´å¤šçš„æœºå™¨åšåˆ†å¸ƒå¼çš„çˆ¬è™«ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°±æ¥æ¨¡æ‹Ÿä¸‹è¿™ä¸ªåœºæ™¯ï¼Œçœ‹çœ‹é—®é¢˜å‡ºåœ¨äº†å“ªé‡Œã€‚</p><p>å‡è®¾è¦çˆ¬å–çš„æœåŠ¡ç«¯æ˜¯è¿™æ ·çš„ä¸€ä¸ªç®€å•å®ç°ï¼Œä¼‘çœ 1ç§’è¿”å›æ•°å­—1ï¼š</p><pre><code>@GetMapping(&quot;server&quot;)\npublic int server() throws InterruptedException {\n    TimeUnit.SECONDS.sleep(1);\n    return 1;\n}\n</code></pre><p>çˆ¬è™«éœ€è¦å¤šæ¬¡è°ƒç”¨è¿™ä¸ªæ¥å£è¿›è¡Œæ•°æ®æŠ“å–ï¼Œä¸ºäº†ç¡®ä¿çº¿ç¨‹æ± ä¸æ˜¯å¹¶å‘çš„ç“¶é¢ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ²¡æœ‰çº¿ç¨‹ä¸Šé™çš„newCachedThreadPoolä½œä¸ºçˆ¬å–ä»»åŠ¡çš„çº¿ç¨‹æ± ï¼ˆå†æ¬¡å¼ºè°ƒï¼Œé™¤éä½ éå¸¸æ¸…æ¥šè‡ªå·±çš„éœ€æ±‚ï¼Œå¦åˆ™ä¸€èˆ¬ä¸è¦ä½¿ç”¨æ²¡æœ‰çº¿ç¨‹æ•°é‡ä¸Šé™çš„çº¿ç¨‹æ± ï¼‰ï¼Œç„¶åä½¿ç”¨HttpClientå®ç°HTTPè¯·æ±‚ï¼ŒæŠŠè¯·æ±‚ä»»åŠ¡å¾ªç¯æäº¤åˆ°çº¿ç¨‹æ± å¤„ç†ï¼Œæœ€åç­‰å¾…æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæˆåè¾“å‡ºæ‰§è¡Œè€—æ—¶ï¼š</p><pre><code>private int sendRequest(int count, Supplier&lt;CloseableHttpClient&gt; client) throws InterruptedException {\n    //ç”¨äºè®¡æ•°å‘é€çš„è¯·æ±‚ä¸ªæ•°\n    AtomicInteger atomicInteger = new AtomicInteger();\n    //ä½¿ç”¨HttpClientä»serveræ¥å£æŸ¥è¯¢æ•°æ®çš„ä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± å¹¶è¡Œå¤„ç†\n    ExecutorService threadPool = Executors.newCachedThreadPool();\n    long begin = System.currentTimeMillis();\n    IntStream.rangeClosed(1, count).forEach(i -&gt; {\n        threadPool.execute(() -&gt; {\n            try (CloseableHttpResponse response = client.get().execute(new HttpGet(&quot;http://127.0.0.1:45678/routelimit/server&quot;))) {\n                atomicInteger.addAndGet(Integer.parseInt(EntityUtils.toString(response.getEntity())));\n            } catch (Exception ex) {\n                ex.printStackTrace();\n            }\n        });\n    });\n    //ç­‰åˆ°countä¸ªä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œæ¯•\n    threadPool.shutdown();\n    threadPool.awaitTermination(1, TimeUnit.HOURS);\n    log.info(&quot;å‘é€ {} æ¬¡è¯·æ±‚ï¼Œè€—æ—¶ {} ms&quot;, atomicInteger.get(), System.currentTimeMillis() - begin);\n    return atomicInteger.get();\n}\n</code></pre><p>é¦–å…ˆï¼Œä½¿ç”¨é»˜è®¤çš„PoolingHttpClientConnectionManageræ„é€ çš„CloseableHttpClientï¼Œæµ‹è¯•ä¸€ä¸‹çˆ¬å–10æ¬¡çš„è€—æ—¶ï¼š</p><pre><code>static CloseableHttpClient httpClient1;\n\nstatic {\n    httpClient1 = HttpClients.custom().setConnectionManager(new PoolingHttpClientConnectionManager()).build();\n}\n\n@GetMapping(&quot;wrong&quot;)\npublic int wrong(@RequestParam(value = &quot;count&quot;, defaultValue = &quot;10&quot;) int count) throws InterruptedException {\n    return sendRequest(count, () -&gt; httpClient1);\n}\n</code></pre><p>è™½ç„¶ä¸€ä¸ªè¯·æ±‚éœ€è¦1ç§’æ‰§è¡Œå®Œæˆï¼Œä½†æˆ‘ä»¬çš„çº¿ç¨‹æ± æ˜¯å¯ä»¥æ‰©å¼ ä½¿ç”¨ä»»æ„æ•°é‡çº¿ç¨‹çš„ã€‚æŒ‰é“ç†è¯´ï¼Œ10ä¸ªè¯·æ±‚å¹¶å‘å¤„ç†çš„æ—¶é—´åŸºæœ¬ç›¸å½“äº1ä¸ªè¯·æ±‚çš„å¤„ç†æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯1ç§’ï¼Œä½†æ—¥å¿—ä¸­æ˜¾ç¤ºå®é™…è€—æ—¶5ç§’ï¼š</p><pre><code>[12:48:48.122] [http-nio-45678-exec-1] [INFO ] [o.g.t.c.h.r.RouteLimitController        :54  ] - å‘é€ 10 æ¬¡è¯·æ±‚ï¼Œè€—æ—¶ 5265 ms\n</code></pre><p>æŸ¥çœ‹PoolingHttpClientConnectionManageræºç ï¼Œå¯ä»¥æ³¨æ„åˆ°æœ‰ä¸¤ä¸ªé‡è¦å‚æ•°ï¼š</p><ul>\n<li><strong>defaultMaxPerRoute=2ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ä¸ªä¸»æœº/åŸŸåçš„æœ€å¤§å¹¶å‘è¯·æ±‚æ•°ä¸º2ã€‚æˆ‘ä»¬çš„çˆ¬è™«éœ€è¦10ä¸ªå¹¶å‘ï¼Œæ˜¾ç„¶æ˜¯é»˜è®¤å€¼å¤ªå°é™åˆ¶äº†çˆ¬è™«çš„æ•ˆç‡ã€‚</strong></li>\n<li>maxTotal=20ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰ä¸»æœºæ•´ä½“æœ€å¤§å¹¶å‘ä¸º20ï¼Œè¿™ä¹Ÿæ˜¯HttpClientæ•´ä½“çš„å¹¶å‘åº¦ã€‚ç›®å‰ï¼Œæˆ‘ä»¬è¯·æ±‚æ•°æ˜¯10æœ€å¤§å¹¶å‘æ˜¯10ï¼Œ20ä¸ä¼šæˆä¸ºç“¶é¢ˆã€‚ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œä½¿ç”¨åŒä¸€ä¸ªHttpClientè®¿é—®10ä¸ªåŸŸåï¼ŒdefaultMaxPerRouteè®¾ç½®ä¸º10ï¼Œä¸ºç¡®ä¿æ¯ä¸€ä¸ªåŸŸåéƒ½èƒ½è¾¾åˆ°10å¹¶å‘ï¼Œéœ€è¦æŠŠmaxTotalè®¾ç½®ä¸º100ã€‚</li>\n</ul><pre><code>public PoolingHttpClientConnectionManager(\n    final HttpClientConnectionOperator httpClientConnectionOperator,\n    final HttpConnectionFactory&lt;HttpRoute, ManagedHttpClientConnection&gt; connFactory,\n    final long timeToLive, final TimeUnit timeUnit) {\n    ...    \n    this.pool = new CPool(new InternalConnectionFactory(\n            this.configData, connFactory), 2, 20, timeToLive, timeUnit);\n   ...\n} \n\npublic CPool(\n        final ConnFactory&lt;HttpRoute, ManagedHttpClientConnection&gt; connFactory,\n        final int defaultMaxPerRoute, final int maxTotal,\n        final long timeToLive, final TimeUnit timeUnit) {\n    ...\n}}\n</code></pre><p>HttpClientæ˜¯Javaéå¸¸å¸¸ç”¨çš„HTTPå®¢æˆ·ç«¯ï¼Œè¿™ä¸ªé—®é¢˜ç»å¸¸å‡ºç°ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆé»˜è®¤å€¼é™åˆ¶å¾—è¿™ä¹ˆå°ã€‚</p><p>å…¶å®ï¼Œè¿™ä¸èƒ½å®Œå…¨æ€ªHttpClientï¼Œå¾ˆå¤šæ—©æœŸçš„æµè§ˆå™¨ä¹Ÿé™åˆ¶äº†åŒä¸€ä¸ªåŸŸåä¸¤ä¸ªå¹¶å‘è¯·æ±‚ã€‚å¯¹äºåŒä¸€ä¸ªåŸŸåå¹¶å‘è¿æ¥çš„é™åˆ¶ï¼Œå…¶å®æ˜¯HTTP 1.1åè®®è¦æ±‚çš„ï¼Œ<a href=\"http://w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.1.4\">è¿™é‡Œ</a>æœ‰è¿™ä¹ˆä¸€æ®µè¯ï¼š</p><pre><code>Clients that use persistent connections SHOULD limit the number of simultaneous connections that they maintain to a given server. A single-user client SHOULD NOT maintain more than 2 connections with any server or proxy. A proxy SHOULD use up to 2*N connections to another server or proxy, where N is the number of simultaneously active users. These guidelines are intended to improve HTTP response times and avoid congestion.\n</code></pre><p>HTTP 1.1åè®®æ˜¯20å¹´å‰åˆ¶å®šçš„ï¼Œç°åœ¨HTTPæœåŠ¡å™¨çš„èƒ½åŠ›å¼ºå¾ˆå¤šäº†ï¼Œæ‰€ä»¥æœ‰äº›æ–°çš„æµè§ˆå™¨æ²¡æœ‰å®Œå…¨éµä»2å¹¶å‘è¿™ä¸ªé™åˆ¶ï¼Œæ”¾å¼€å¹¶å‘æ•°åˆ°äº†8ç”šè‡³æ›´å¤§ã€‚å¦‚æœéœ€è¦é€šè¿‡HTTPå®¢æˆ·ç«¯å‘èµ·å¤§é‡å¹¶å‘è¯·æ±‚ï¼Œä¸ç®¡ä½¿ç”¨ä»€ä¹ˆå®¢æˆ·ç«¯ï¼Œè¯·åŠ¡å¿…ç¡®è®¤å®¢æˆ·ç«¯çš„å®ç°é»˜è®¤çš„å¹¶å‘åº¦æ˜¯å¦æ»¡è¶³éœ€æ±‚ã€‚</p><p>æ—¢ç„¶çŸ¥é“äº†é—®é¢˜æ‰€åœ¨ï¼Œæˆ‘ä»¬å°±å°è¯•å£°æ˜ä¸€ä¸ªæ–°çš„HttpClientæ”¾å¼€ç›¸å…³é™åˆ¶ï¼Œè®¾ç½®maxPerRouteä¸º50ã€maxTotalä¸º100ï¼Œç„¶åä¿®æ”¹ä¸€ä¸‹åˆšæ‰çš„wrongæ–¹æ³•ï¼Œä½¿ç”¨æ–°çš„å®¢æˆ·ç«¯è¿›è¡Œæµ‹è¯•ï¼š</p><pre><code>httpClient2 = HttpClients.custom().setMaxConnPerRoute(10).setMaxConnTotal(20).build();\n</code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼Œ10æ¬¡è¯·æ±‚åœ¨1ç§’å·¦å³æ‰§è¡Œå®Œæˆã€‚å¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºæ”¾å¼€äº†ä¸€ä¸ªHost 2ä¸ªå¹¶å‘çš„é»˜è®¤é™åˆ¶ï¼Œçˆ¬è™«æ•ˆç‡å¾—åˆ°äº†å¤§å¹…æå‡ï¼š</p><pre><code>[12:58:11.333] [http-nio-45678-exec-3] [INFO ] [o.g.t.c.h.r.RouteLimitController        :54  ] - å‘é€ 10 æ¬¡è¯·æ±‚ï¼Œè€—æ—¶ 1023 ms\n</code></pre><h2>é‡ç‚¹å›é¡¾</h2><p>ä»Šå¤©ï¼Œæˆ‘å’Œä½ åˆ†äº«äº†HTTPè°ƒç”¨æœ€å¸¸é‡åˆ°çš„è¶…æ—¶ã€é‡è¯•å’Œå¹¶å‘é—®é¢˜ã€‚</p><p>è¿æ¥è¶…æ—¶ä»£è¡¨å»ºç«‹TCPè¿æ¥çš„æ—¶é—´ï¼Œè¯»å–è¶…æ—¶ä»£è¡¨äº†ç­‰å¾…è¿œç«¯è¿”å›æ•°æ®çš„æ—¶é—´ï¼Œä¹ŸåŒ…æ‹¬è¿œç«¯ç¨‹åºå¤„ç†çš„æ—¶é—´ã€‚åœ¨è§£å†³è¿æ¥è¶…æ—¶é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬è¦ææ¸…æ¥šè¿çš„æ˜¯è°ï¼›åœ¨é‡åˆ°è¯»å–è¶…æ—¶é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦ç»¼åˆè€ƒè™‘ä¸‹æ¸¸æœåŠ¡çš„æœåŠ¡æ ‡å‡†å’Œè‡ªå·±çš„æœåŠ¡æ ‡å‡†ï¼Œè®¾ç½®åˆé€‚çš„è¯»å–è¶…æ—¶æ—¶é—´ã€‚æ­¤å¤–ï¼Œåœ¨ä½¿ç”¨è¯¸å¦‚Spring Cloud Feignç­‰æ¡†æ¶æ—¶åŠ¡å¿…ç¡®è®¤ï¼Œè¿æ¥å’Œè¯»å–è¶…æ—¶å‚æ•°çš„é…ç½®æ˜¯å¦æ­£ç¡®ç”Ÿæ•ˆã€‚</p><p>å¯¹äºé‡è¯•ï¼Œå› ä¸ºHTTPåè®®è®¤ä¸ºGetè¯·æ±‚æ˜¯æ•°æ®æŸ¥è¯¢æ“ä½œï¼Œæ˜¯æ— çŠ¶æ€çš„ï¼Œåˆè€ƒè™‘åˆ°ç½‘ç»œå‡ºç°ä¸¢åŒ…æ˜¯æ¯”è¾ƒå¸¸è§çš„äº‹æƒ…ï¼Œæœ‰äº›HTTPå®¢æˆ·ç«¯æˆ–ä»£ç†æœåŠ¡å™¨ä¼šè‡ªåŠ¨é‡è¯•Get/Headè¯·æ±‚ã€‚å¦‚æœä½ çš„æ¥å£è®¾è®¡ä¸æ”¯æŒå¹‚ç­‰ï¼Œéœ€è¦å…³é—­è‡ªåŠ¨é‡è¯•ã€‚ä½†ï¼Œæ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œ<a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html\">éµä»HTTPåè®®</a>çš„å»ºè®®æ¥ä½¿ç”¨åˆé€‚çš„HTTPæ–¹æ³•ã€‚</p><p>æœ€åæˆ‘ä»¬çœ‹åˆ°ï¼ŒåŒ…æ‹¬HttpClientåœ¨å†…çš„HTTPå®¢æˆ·ç«¯ä»¥åŠæµè§ˆå™¨ï¼Œéƒ½ä¼šé™åˆ¶å®¢æˆ·ç«¯è°ƒç”¨çš„æœ€å¤§å¹¶å‘æ•°ã€‚å¦‚æœä½ çš„å®¢æˆ·ç«¯æœ‰æ¯”è¾ƒå¤§çš„è¯·æ±‚è°ƒç”¨å¹¶å‘ï¼Œæ¯”å¦‚åšçˆ¬è™«ï¼Œæˆ–æ˜¯æ‰®æ¼”ç±»ä¼¼ä»£ç†çš„è§’è‰²ï¼Œåˆæˆ–è€…æ˜¯ç¨‹åºæœ¬èº«å¹¶å‘è¾ƒé«˜ï¼Œå¦‚æ­¤å°çš„é»˜è®¤å€¼å¾ˆå®¹æ˜“æˆä¸ºååé‡çš„ç“¶é¢ˆï¼Œéœ€è¦åŠæ—¶è°ƒæ•´ã€‚</p><p>ä»Šå¤©ç”¨åˆ°çš„ä»£ç ï¼Œæˆ‘éƒ½æ”¾åœ¨äº†GitHubä¸Šï¼Œä½ å¯ä»¥ç‚¹å‡»<a href=\"https://github.com/JosephZhu1983/java-common-mistakes\">è¿™ä¸ªé“¾æ¥</a>æŸ¥çœ‹ã€‚</p><h2>æ€è€ƒä¸è®¨è®º</h2><ol>\n<li>ç¬¬ä¸€èŠ‚ä¸­æˆ‘ä»¬å¼ºè°ƒäº†è¦æ³¨æ„è¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶å‚æ•°çš„é…ç½®ï¼Œå¤§å¤šæ•°çš„HTTPå®¢æˆ·ç«¯ä¹Ÿéƒ½æœ‰è¿™ä¸¤ä¸ªå‚æ•°ã€‚æœ‰è¯»å°±æœ‰å†™ï¼Œä½†ä¸ºä»€ä¹ˆæˆ‘ä»¬å¾ˆå°‘çœ‹åˆ°â€œå†™å…¥è¶…æ—¶â€çš„æ¦‚å¿µå‘¢ï¼Ÿ</li>\n<li>é™¤äº†Ribbonçš„AutoRetriesNextServeré‡è¯•æœºåˆ¶ï¼ŒNginxä¹Ÿæœ‰ç±»ä¼¼çš„é‡è¯•åŠŸèƒ½ã€‚ä½ äº†è§£Nginxç›¸å…³çš„é…ç½®å—ï¼Ÿ</li>\n</ol><p>é’ˆå¯¹HTTPè°ƒç”¨ï¼Œä½ è¿˜é‡åˆ°è¿‡ä»€ä¹ˆå‘å—ï¼Ÿæˆ‘æ˜¯æœ±æ™”ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºä¸æˆ‘ç•™è¨€åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ï¼Œä¸€èµ·äº¤æµã€‚</p>","neighbors":{"left":{"article_title":"04 | è¿æ¥æ± ï¼šåˆ«è®©è¿æ¥æ± å¸®äº†å€’å¿™","id":211388},"right":{"article_title":"06 | 20%çš„ä¸šåŠ¡ä»£ç çš„Springå£°æ˜å¼äº‹åŠ¡ï¼Œå¯èƒ½éƒ½æ²¡å¤„ç†æ­£ç¡®","id":213295}},"comments":[{"had_liked":false,"id":189963,"user_name":"Darren","can_delete":false,"product_type":"c1","uid":1254968,"ip_address":"","ucode":"CCD2B2C492BE9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","comment_is_top":true,"comment_ctime":1584586341,"is_pvip":true,"replies":[{"id":"73077","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","comment_id":189963,"uid":"1001470","ip_address":"","utype":1,"ctime":1584588601,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"9.2233722746626007e+18","product_id":100047701,"comment_content":"è¯•ç€å›ç­”ä¸‹é—®é¢˜ï¼š<br>1ã€ä¸ºä»€ä¹ˆå¾ˆå°‘è§åˆ°å†™å…¥è¶…æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€æ•°æ®åˆ°æœåŠ¡ç«¯ï¼Œé¦–å…ˆæ¥åŠ›è¿æ¥ï¼ˆTCPï¼‰ï¼Œç„¶åå†™å…¥TCPç¼“å†²åŒºï¼ŒTCPç¼“å†²åŒºæ ¹æ®æ—¶é—´çª—å£ï¼Œå‘é€æ•°æ®åˆ°æœåŠ¡ç«¯ï¼Œå› æ­¤å†™å…¥æ“ä½œå¯ä»¥ä»»åŠ¡æ˜¯è‡ªå·±æœ¬åœ°çš„æ“ä½œï¼Œæœ¬åœ°æ“ä½œæ˜¯ä¸éœ€è¦ä»€ä¹ˆè¶…æ—¶æ—¶é—´çš„ï¼Œå¦‚æœçœŸçš„æœ‰ä»€ä¹ˆå¼‚å¸¸ï¼Œé‚£ä¹Ÿæ˜¯è¿æ¥ï¼ˆTCPï¼‰ä¸ä¸Šï¼Œæˆ–è€…è¶…æ—¶çš„é—®é¢˜ï¼Œè¿æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶å°±èƒ½è¦†ç›–è¿™ç§åœºæ™¯ã€‚<br>2ã€proxy_next_upstreamï¼šè¯­æ³•: proxy_next_upstream <br>      [error|timeout|invalid_header|http_500|http_503|http_404|off]<br>      é»˜è®¤å€¼: proxy_next_upstream error timeout<br>      å³ error timeoutä¼šè‡ªåŠ¨é‡è¯•<br>å¯ä»¥ä¿®æ”¹é»˜è®¤å€¼ï¼Œåœ¨å»æ‰errorå’Œtimeoutï¼Œè¿™æ ·åœ¨å‘ç”Ÿé”™è¯¯å’Œè¶…æ—¶æ—¶ï¼Œä¸ä¼šé‡è¯•<br>proxy_next_upstream_tries è¿™ä¸ªå‚æ•°å†³å®šé‡è¯•çš„æ¬¡æ•°ï¼Œ0è¡¨ç¤ºå…³é—­è¯¥å‚æ•°<br>Limits the number of possible tries for passing a request to the next server. The 0 value turns off this limitation.","like_count":55,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487843,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584588601,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207438,"user_name":"å¾å…¸é˜³âœ”ï¸","can_delete":false,"product_type":"c1","uid":1565569,"ip_address":"","ucode":"41DA01FBBD8D29","user_header":"https://static001.geekbang.org/account/avatar/00/17/e3/81/29dd8167.jpg","comment_is_top":true,"comment_ctime":1587086822,"is_pvip":false,"replies":[{"id":"77480","content":"å¯ä»¥ï¼Œè¡¥å……äº†ä¸€ä¸ªä¾‹å­ï¼š<br>https:&#47;&#47;github.com&#47;JosephZhu1983&#47;java-common-mistakes&#47;blob&#47;master&#47;src&#47;main&#47;java&#47;org&#47;geekbang&#47;time&#47;commonmistakes&#47;httpinvoke&#47;feignpermethodtimeout&#47;FeignPerMethodTimeoutController.java<br><br>Feignæ¯”è¾ƒæ–°çš„ç‰ˆæœ¬æ‰ä¼šæ”¯æŒï¼š<br>https:&#47;&#47;github.com&#47;OpenFeign&#47;feign&#47;pull&#47;970<br><br>ç›¸å…³æºç ï¼š<br>SynchronousMethodHandler<br><br>Options findOptions(Object[] argv) {<br>    if (argv == null || argv.length == 0) {<br>      return this.options;<br>    }<br>    return (Options) Stream.of(argv)<br>        .filter(o -&gt; o instanceof Options)<br>        .findFirst()<br>        .orElse(this.options);<br>  }","user_name":"ä½œè€…å›å¤","comment_id":207438,"uid":"1001470","ip_address":"","utype":1,"ctime":1587093283,"user_name_real":"æœ±æ™”"}],"discussion_count":2,"race_medal":0,"score":"9.2233721329311007e+18","product_id":100047701,"comment_content":"æœ±è€å¸ˆï¼Œè¯·é—®Feignå£°æ˜å¼HTTPæ¥å£è°ƒç”¨å¯ä»¥é’ˆå¯¹æŸæœåŠ¡å•ä¸ªæ¥å£é…ç½®è¯»å–è¶…æ—¶å‚æ•°å—ï¼Ÿæˆ‘ä»¬è¿™è¾¹ä¸€ä¸ªå¾®æœåŠ¡æœ‰nä¸ªæ¥å£ï¼Œæœ‰ä¸€äº›æ¥å£å¤„ç†è€—æ—¶é•¿æœ‰ä¸€äº›å¤„ç†è€—æ—¶çŸ­ï¼Œä½†è°ƒç”¨æ–¹åˆä¸æœŸæœ›é’ˆå¯¹åŒä¸€ä¸ªå¾®æœåŠ¡å£°æ˜å¤šä¸ªFeign clientã€‚æˆ‘ç®€å•ç¿»äº†æºç æ²¡æœ‰æ‰¾åˆ°ã€‚","like_count":22,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492125,"discussion_content":"å¯ä»¥ï¼Œè¡¥å……äº†ä¸€ä¸ªä¾‹å­ï¼š\nhttps://github.com/JosephZhu1983/java-common-mistakes/blob/master/src/main/java/org/geekbang/time/commonmistakes/httpinvoke/feignpermethodtimeout/FeignPerMethodTimeoutController.java\n\nFeignæ¯”è¾ƒæ–°çš„ç‰ˆæœ¬æ‰ä¼šæ”¯æŒï¼š\nhttps://github.com/OpenFeign/feign/pull/970\n\nç›¸å…³æºç ï¼š\nSynchronousMethodHandler\n\nOptions findOptions(Object[] argv) {\n    if (argv == null || argv.length == 0) {\n      return this.options;\n    }\n    return (Options) Stream.of(argv)\n        .filter(o -&amp;gt; o instanceof Options)\n        .findFirst()\n        .orElse(this.options);\n  }","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587093283,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1564465,"avatar":"https://static001.geekbang.org/account/avatar/00/17/df/31/fdb1fb09.jpg","nickname":"ä½™æ¾","note":"","ucode":"08E69DC444CF70","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":330818,"discussion_content":"ä½ å¥½ æˆ‘è¿™è¾¹çœ‹åˆ°åªæ˜¯GETè¯·æ±‚å¯ä»¥é‡‡ç”¨è¿™ç§æ¨¡å¼æ¥åš å¦‚æœè°ƒç”¨å¤–æ¸¸æ˜¯postè¯·æ±‚ æ”¹æ€ä¹ˆå¤„ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606715822,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190034,"user_name":"èš‚èšå†…æ¨+v","can_delete":false,"product_type":"c1","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":true,"comment_ctime":1584596346,"is_pvip":false,"replies":[{"id":"73133","content":"499æƒ…å†µæ¯”è¾ƒç‰¹æ®Šï¼Œè™½ç„¶è¡¨ç°ä¸ºæœåŠ¡ç«¯ï¼ˆä¸€èˆ¬ä¸ºä»£ç†ï¼Œæ¯”å¦‚nginxï¼‰è®°å½•å’Œè¿”å›499çŠ¶æ€ç ï¼Œä½†æ˜¯å…¶å®æ˜¯å› ä¸ºå¤„ç†æ—¶é—´å¤ªé•¿ï¼Œå®¢æˆ·ç«¯è¶…æ—¶ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œæ’æŸ¥ä¸¤ç‚¹ï¼š<br>1ã€å®¢æˆ·ç«¯è¯»å–è¶…æ—¶æ—¶é—´å¤šä¹…<br>2ã€æœåŠ¡ç«¯ä¸ºä»€ä¹ˆå¤„ç†è¿™ä¹ˆæ…¢è¶…è¿‡äº†å®¢æˆ·ç«¯çš„è¯»å–è¶…æ—¶<br><br>å¦‚æœå¸Œæœ›ä¸è¦499çš„è¯ï¼Œå¯¹äºnginxå¯ä»¥å¼€å¯<br>proxy_ignore_client_abortï¼Œè¿™æ ·å¯ä»¥è®©è¯·æ±‚åœ¨æœåŠ¡ç«¯æ‰§è¡Œå®Œæˆ","user_name":"ä½œè€…å›å¤","comment_id":190034,"uid":"1001470","ip_address":"","utype":1,"ctime":1584598946,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"9.2233721157488005e+18","product_id":100047701,"comment_content":"è€å¸ˆï¼Œæˆ‘è¿™è¾¹å·¥ä½œè¿‡ç¨‹ä¸­é‡åˆ°æœåŠ¡ç«¯ 499 è¿™å—è¦æ€ä¹ˆä»é“¾æ¥è¶…æ—¶å’Œè¯»å–è¶…æ—¶è®¾ç½®å»åˆ†æå‘¢ï¼Ÿ","like_count":19,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487861,"discussion_content":"499æƒ…å†µæ¯”è¾ƒç‰¹æ®Šï¼Œè™½ç„¶è¡¨ç°ä¸ºæœåŠ¡ç«¯ï¼ˆä¸€èˆ¬ä¸ºä»£ç†ï¼Œæ¯”å¦‚nginxï¼‰è®°å½•å’Œè¿”å›499çŠ¶æ€ç ï¼Œä½†æ˜¯å…¶å®æ˜¯å› ä¸ºå¤„ç†æ—¶é—´å¤ªé•¿ï¼Œå®¢æˆ·ç«¯è¶…æ—¶ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œæ’æŸ¥ä¸¤ç‚¹ï¼š\n1ã€å®¢æˆ·ç«¯è¯»å–è¶…æ—¶æ—¶é—´å¤šä¹…\n2ã€æœåŠ¡ç«¯ä¸ºä»€ä¹ˆå¤„ç†è¿™ä¹ˆæ…¢è¶…è¿‡äº†å®¢æˆ·ç«¯çš„è¯»å–è¶…æ—¶\n\nå¦‚æœå¸Œæœ›ä¸è¦499çš„è¯ï¼Œå¯¹äºnginxå¯ä»¥å¼€å¯\nproxy_ignore_client_abortï¼Œè¿™æ ·å¯ä»¥è®©è¯·æ±‚åœ¨æœåŠ¡ç«¯æ‰§è¡Œå®Œæˆ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1584598946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190923,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":true,"comment_ctime":1584709673,"is_pvip":false,"replies":[{"id":"73340","content":"1ã€å¯åŠ¨æ—¶ä¸è¿›æ–­ç‚¹ä¸ä»£è¡¨ä¸æ˜¯ï¼Œæ‰§è¡Œåä¼šè¿›æ–­ç‚¹ï¼ŒåŸå› æ˜¯LoadBalancerFeignClient.execute()ï¼Œè¿è¡Œæ—¶æ³¨å…¥ä¾èµ–çš„ï¼Œè¿™ä¸ªæ–¹æ³•ä¸€è·¯è¿½ä¸‹å»ï¼š<br><br>IClientConfig getClientConfig(Request.Options options, String clientName) {<br>\t\tIClientConfig requestConfig;<br>\t\tif (options == DEFAULT_OPTIONS) {<br>\t\t\trequestConfig = this.clientFactory.getClientConfig(clientName);<br>\t\t}<br>\t\telse {<br>\t\t\trequestConfig = new FeignOptionsClientConfig(options);<br>\t\t}<br>\t\treturn requestConfig;<br>\t}<br><br><br>2ã€ribbonæ˜¯netflixçš„ä¸‰æ–¹åº“ï¼Œä¸æ˜¯spring boot @ConfigurationPropertiesç©æ³•ï¼ŒKeyå®šä¹‰åœ¨ï¼š<br><br>com.netflix.client.config.CommonClientConfigKey","user_name":"ä½œè€…å›å¤","comment_id":190923,"uid":"1001470","ip_address":"","utype":1,"ctime":1584714385,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"9.2233720856840991e+18","product_id":100047701,"comment_content":"æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹æºç ã€‚æ‰“å¼€ RibbonClientConfiguration ç±»åï¼Œä¼šçœ‹åˆ° DefaultClientConfigImpl è¢«åˆ›å»ºå‡ºæ¥ä¹‹åï¼ŒReadTimeout å’Œ ConnectTimeout è¢«è®¾ç½®ä¸º 1sï¼š<br><br>&#47;**<br> * Ribbon client default connect timeout.<br> *&#47;<br>public static final int DEFAULT_CONNECT_TIMEOUT = 1000;<br><br>&#47;**<br> * Ribbon client default read timeout.<br> *&#47;<br>public static final int DEFAULT_READ_TIMEOUT = 1000;<br><br>@Bean<br>@ConditionalOnMissingBean<br>public IClientConfig ribbonClientConfig() {<br>   DefaultClientConfigImpl config = new DefaultClientConfigImpl();   &#47;&#47;æ­¤è¡Œæ‰“æ–­ç‚¹<br>   config.loadProperties(this.name);<br>   config.set(CommonClientConfigKey.ConnectTimeout, DEFAULT_CONNECT_TIMEOUT);<br>   config.set(CommonClientConfigKey.ReadTimeout, DEFAULT_READ_TIMEOUT);<br>   config.set(CommonClientConfigKey.GZipPayload, DEFAULT_GZIP_PAYLOAD);<br>   return config;<br>}<br><br>è¢«æ­»æ‰£çš„æ¯›ç—…æŠ˜è…¾ç€ï¼Œä»¥ä¸Šè¿™æ®µæè¿°å’Œä»£ç ä¸­ï¼Œæœ‰ä¸¤ä¸ªç–‘é—®ï¼Œçƒ¦è€å¸ˆè§£æƒ‘ï¼Œè°¢è°¢ã€‚<br>1ã€ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œæˆ‘åœ¨æ ‡æ³¨è¡Œæ‰“äº†æ–­ç‚¹ï¼Œdebugå¯åŠ¨æ—¶æœªè¿›æ–­ç‚¹ã€‚æ˜¯ä¸æ˜¯è¡¨æ˜é»˜è®¤å€¼ä¸æ˜¯åœ¨æ­¤æ®µä»£ç è®¾ç½®çš„ï¼Ÿ<br>2ã€æ‰¾åˆ°äº†feigné…ç½®çš„åŸå§‹ç±»FeignClientPropertiesï¼Œä½†æ˜¯æ²¡æ‰¾åˆ°ribbonçš„ã€‚","like_count":11,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488079,"discussion_content":"1ã€å¯åŠ¨æ—¶ä¸è¿›æ–­ç‚¹ä¸ä»£è¡¨ä¸æ˜¯ï¼Œæ‰§è¡Œåä¼šè¿›æ–­ç‚¹ï¼ŒåŸå› æ˜¯LoadBalancerFeignClient.execute()ï¼Œè¿è¡Œæ—¶æ³¨å…¥ä¾èµ–çš„ï¼Œè¿™ä¸ªæ–¹æ³•ä¸€è·¯è¿½ä¸‹å»ï¼š\n\nIClientConfig getClientConfig(Request.Options options, String clientName) {\n\t\tIClientConfig requestConfig;\n\t\tif (options == DEFAULT_OPTIONS) {\n\t\t\trequestConfig = this.clientFactory.getClientConfig(clientName);\n\t\t}\n\t\telse {\n\t\t\trequestConfig = new FeignOptionsClientConfig(options);\n\t\t}\n\t\treturn requestConfig;\n\t}\n\n\n2ã€ribbonæ˜¯netflixçš„ä¸‰æ–¹åº“ï¼Œä¸æ˜¯spring boot @ConfigurationPropertiesç©æ³•ï¼ŒKeyå®šä¹‰åœ¨ï¼š\n\ncom.netflix.client.config.CommonClientConfigKey","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584714385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189930,"user_name":"ğŸ‘½","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1584582936,"is_pvip":false,"replies":[{"id":"73081","content":"æ€»ç»“çš„ä¸é”™","user_name":"ä½œè€…å›å¤","comment_id":189930,"uid":"1001470","ip_address":"","utype":1,"ctime":1584589392,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"121843667224","product_id":100047701,"comment_content":"è¿™å·²ç»ä¸å•å•æ˜¯ä¸€ä¸ªå‘äº†ï¼Œè€Œæ˜¯Nä¸€ä¸ªåœºæ™¯ä¸‹ï¼Œå¤šç§å¤šæ ·çš„å‘ã€‚<br>Spring Boot å¸¦æ¥äº†ã€çº¦å®šå¤§äºé…ç½®ã€‘çš„è¯´æ³•ï¼Œä½†æ˜¯ï¼Œæœ¬æ–‡å‘Šè¯‰æˆ‘ä»¬ï¼Œè¶Šæ˜¯çº¦å®šå¤§äºé…ç½®ï¼Œè¶Šæ˜¯è¦å¯¹é‚£äº›â€œé»˜è®¤é…ç½®â€å¿ƒé‡Œæœ‰æ•°æ‰è¡Œã€‚<br>HTTPè¯·æ±‚ï¼Œè¯´åˆ°åº•ï¼Œè¿˜æ˜¯ç½‘ç»œè°ƒç”¨ã€‚æŸä¸ªè€å¸ˆæ›¾è¯´è¿‡ï¼Œç½‘ç»œï¼Œå°±æ˜¯ä¸é è°±çš„ã€‚å°±å­˜åœ¨æ‹¥å¡ï¼Œä¸¢åŒ…ç­‰å„ç§æƒ…å†µã€‚ä»è€Œä½¿å¾—æ’æŸ¥çš„éš¾åº¦æ›´å¤§ã€‚è¦è€ƒè™‘çš„è§’åº¦ï¼Œå®½åº¦ï¼Œéƒ½æ›´å¹¿ã€‚ä¸å•æ˜¯å®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ï¼Œç”šè‡³è¿˜è¦è€ƒè™‘ç½‘ç»œç¯å¢ƒã€‚è¿™å¯¹ç¨‹åºå‘˜å…·å¤‡çš„æŠ€æœ¯æ·±åº¦ï¼Œå¹¿åº¦éƒ½æœ‰äº†æ›´é«˜çš„è¦æ±‚ã€‚<br>ä»Šå¤©çš„æ”¶è´§ï¼š<br>é¦–å…ˆï¼Œå¢é•¿äº†ç»éªŒã€‚çŸ¥é“äº†æœ‰è¿™ä¹ˆäº›å‘ï¼Œè™½ç„¶ä¸ä¸€å®šèƒ½è®°å¾—ä½ï¼Œæœ€èµ·ç ç•™ä¸ªå°è±¡ã€‚ä»¥åç¢°åˆ°ç±»ä¼¼çš„é—®é¢˜äº†èƒ½æƒ³èµ·æ¥ã€‚<br>ç„¶åï¼Œä¸èƒ½ç›²ç›®ç›¸ä¿¡é»˜è®¤é…ç½®ã€‚æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯éœ€è¦äº†è§£å…³æ³¨é‚£äº›é»˜è®¤é…ç½®ä»¥åŠé»˜è®¤å®ç°ã€‚<br>æœ€åï¼Œå¯¹HTTPè°ƒç”¨ï¼Œçš„æµ‹è¯•æ–¹å¼ä¸æ¨¡æ‹Ÿæ–¹å¼ï¼Œä¹Ÿäº†è§£åˆ°äº†æµ‹è¯•æ–¹å¼ã€‚å¦‚ä½•åˆ†åˆ«è®¾ç½®è¶…æ—¶æ—¶é—´æ¥æ‰¾é—®é¢˜ã€‚<br><br>å…¶å®ï¼Œè¿˜å¸Œæœ›èƒ½å¬å¬è€å¸ˆè®²è®²HTTPè°ƒç”¨å‡ºé—®é¢˜çš„æ’æŸ¥æ€è·¯ä¸æ–¹æ¡ˆã€‚","like_count":28,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487831,"discussion_content":"æ€»ç»“çš„ä¸é”™","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584589392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200842,"user_name":"Geek_d7ede4","can_delete":false,"product_type":"c1","uid":1432741,"ip_address":"","ucode":"71915DDFEE1901","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIFgmmBXRltzTkfeajYGLptvvwEsMyiaCT5nJZNg4TZJWh02cgwxtrEIk6TWSbGpBibE7Bbvoicjciaiag/132","comment_is_top":false,"comment_ctime":1585659924,"is_pvip":false,"replies":[{"id":"75159","content":"å¾ˆå…¸å‹çš„é—®é¢˜ï¼š<br>1ã€å…ˆåˆ›å»ºæ”¯ä»˜è®¢å•ï¼Œå†æäº¤å¤–éƒ¨ï¼Œåˆ›å»ºè®¢å•çš„æ“ä½œç‹¬ç«‹äº‹åŠ¡ï¼Œä¸è¦å›æ»šï¼ˆå¦åˆ™å‡ºå¼‚å¸¸äº†ï¼Œè®¢å•éƒ½æ²¡äº†ï¼Œè¡¥å¿çš„ä¾æ®éƒ½æ²¡æœ‰ï¼‰<br>2ã€åªæœ‰å¤–éƒ¨æ¥å£å‘Šè¯‰ä½ æ˜ç¡®æˆåŠŸæˆ–å¤±è´¥äº†ï¼Œä½ æ‰èƒ½è®¤ä¸ºæ“ä½œæˆåŠŸæˆ–å¤±è´¥<br>3ã€å¦åˆ™ç”±å®šæ—¶ä»»åŠ¡è°ƒç”¨å¤–éƒ¨æŸ¥è¯¢æ¥å£æŸ¥è¯¢äº¤æ˜“ç»“æœï¼Œç„¶åæ ¹æ®æŸ¥åˆ°çš„ç»“æœè¡¥å¿æœ¬åœ°çŠ¶æ€<br>","user_name":"ä½œè€…å›å¤","comment_id":200842,"uid":"1001470","ip_address":"","utype":1,"ctime":1585662013,"user_name_real":"æœ±æ™”"}],"discussion_count":7,"race_medal":0,"score":"117549776916","product_id":100047701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘ä¹‹å‰å¯¹æ¥è¿‡ä¸€ä¸ªç¬¬ä¸‰æ–¹æ”¯ä»˜æ¥å£ï¼Œè°ƒç”¨æ”¯ä»˜æ¥å£aè´¦æˆ·å¯¹bè´¦æˆ·è¿›è¡Œäº†è½¬è´¦æ“ä½œï¼Œæˆ‘ä¸šåŠ¡æ•°æ®åº“ä¹Ÿè¦åšä¸€ä¸ªè®°è´¦æ“ä½œåœ¨æ•°æ®åº“ä¸­ï¼Œå¦‚ä½•ä¿è¯è°ƒç”¨ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¥å£å’Œæˆ‘æœ¬åœ°çš„ä¸šåŠ¡æ˜¯ä¸€è‡´æ€§çš„å‘¢ï¼Ÿå°±æ˜¯ç¬¬ä¸‰æ–¹æ”¯ä»˜æ¥å£æœ‰å¯èƒ½å·²ç»è½¬è´¦æˆåŠŸäº†ï¼Œä½†æ˜¯æˆ‘ä¸šåŠ¡ä»£ç å¯èƒ½æŠ›å¼‚å¸¸ï¼Œå¯¼è‡´å›æ»šäº†ã€‚","like_count":27,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490150,"discussion_content":"å¾ˆå…¸å‹çš„é—®é¢˜ï¼š\n1ã€å…ˆåˆ›å»ºæ”¯ä»˜è®¢å•ï¼Œå†æäº¤å¤–éƒ¨ï¼Œåˆ›å»ºè®¢å•çš„æ“ä½œç‹¬ç«‹äº‹åŠ¡ï¼Œä¸è¦å›æ»šï¼ˆå¦åˆ™å‡ºå¼‚å¸¸äº†ï¼Œè®¢å•éƒ½æ²¡äº†ï¼Œè¡¥å¿çš„ä¾æ®éƒ½æ²¡æœ‰ï¼‰\n2ã€åªæœ‰å¤–éƒ¨æ¥å£å‘Šè¯‰ä½ æ˜ç¡®æˆåŠŸæˆ–å¤±è´¥äº†ï¼Œä½ æ‰èƒ½è®¤ä¸ºæ“ä½œæˆåŠŸæˆ–å¤±è´¥\n3ã€å¦åˆ™ç”±å®šæ—¶ä»»åŠ¡è°ƒç”¨å¤–éƒ¨æŸ¥è¯¢æ¥å£æŸ¥è¯¢äº¤æ˜“ç»“æœï¼Œç„¶åæ ¹æ®æŸ¥åˆ°çš„ç»“æœè¡¥å¿æœ¬åœ°çŠ¶æ€\n","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1585662013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2370429,"avatar":"https://static001.geekbang.org/account/avatar/00/24/2b/7d/51ae3a79.jpg","nickname":"Old_Young","note":"","ucode":"5B6D69A7390D91","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":554453,"discussion_content":"è€å¸ˆæ‚¨å¥½ï¼Œæœ‰ä¸€ç§æé™åœºæ™¯æ˜¯æŸ¥è¯¢ä¸€ç›´ä¸è¿”å›ç»“æœï¼Œé‚£ä¹ˆè¡¥å¿å°±æ— æ³•å®ç°ï¼Œè¿™ç¬”è®¢å•è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646386056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":490150,"ip_address":""},"score":554453,"extra":""}]},{"author":{"id":1161352,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b8/88/5c5d854c.jpg","nickname":"kelly0524","note":"","ucode":"2D24B8974B8E58","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293228,"discussion_content":"åˆ›å»ºè®¢å•çš„æ“ä½œç‹¬ç«‹äº‹åŠ¡ï¼Œä¸è¦å›æ»šã€‚ã€‚ã€‚ è¿™æ®µè¯ä¸æ˜¯å¾ˆç†è§£ï¼Œè€å¸ˆæˆ–è€…åŒå­¦ä»¬å¯ä»¥è§£ç­”ä¸€ä¸‹å—ï¼Œè°¢è°¢ï¼","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1595487707,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1302360,"avatar":"https://static001.geekbang.org/account/avatar/00/13/df/58/5b73780a.jpg","nickname":"æ˜Ÿç©º","note":"","ucode":"0F6A556FC7B40F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1161352,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b8/88/5c5d854c.jpg","nickname":"kelly0524","note":"","ucode":"2D24B8974B8E58","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299076,"discussion_content":"æœ¬æ–¹å’Œç¬¬ä¸‰æ–¹å¯¹æ•°æ®çš„æ—¶å€™æœ‰ä¸ªä¾æ®ï¼Œä½ ä¸èƒ½ç”¨æ—¥å¿—å»å’Œå¯¹æ–¹å¯¹æ•°æ®å§ã€‚å‡å¦‚æ”¾åœ¨ä¸€ä¸ªäº‹ç‰©é‡Œé¢ï¼Œä»»ä½•ä¸€ä¸ªç¯èŠ‚å‡ºé—®é¢˜äº†ï¼Œåº“é‡Œéƒ½æ˜¯ç©ºçš„ã€‚æ”¾åœ¨ç‹¬ç«‹äº‹ç‰©é‡Œé¢ï¼Œç­‰ç‹¬ç«‹äº‹ç‰©æäº¤æˆåŠŸäº†ï¼Œä½ å†æ“ä½œæ¥ä¸‹æ¥çš„ä¸šåŠ¡ï¼Œåç»­åªæ˜¯æ”¹çŠ¶æ€çš„é—®é¢˜äº†","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1597555806,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":293228,"ip_address":""},"score":299076,"extra":""}]},{"author":{"id":1225974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b4/f6/e39d5af1.jpg","nickname":"é’±ç±³","note":"","ucode":"07AA44C6A40D34","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388643,"discussion_content":"åŠ ä¸­é—´æ€ï¼Œtccï¼Œç»“æœæ¶ˆæ¯å›è°ƒï¼Œç»“æœå¼‚æ­¥æŸ¥è¯¢å¤„ç†ï¼Œæ—¥è´¦å•æ ¸å¯¹ï¼Œæœ€ç»ˆä¸€è‡´æ€§ã€‚å¯ä»¥å‚è€ƒã€‚ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1628864791,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1350991,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/4f/273ffb51.jpg","nickname":"å°å“ªå’","note":"","ucode":"252087A733355C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392480,"discussion_content":"æ”¯ä»˜æ¥å£ç†è®ºä¸Šéƒ½æœ‰å›è°ƒçš„ï¼Œï¼Œå®šæ—¶è½®è¯¢è¡¥å¿+å›è°ƒï¼Œè¶³å¤Ÿäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631015988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1230912,"avatar":"https://static001.geekbang.org/account/avatar/00/12/c8/40/0342dca5.jpg","nickname":"åˆ˜å…‰è£•","note":"","ucode":"33091984F240E9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333180,"discussion_content":"æ‰‹åŠ¨ç‚¹èµï¼Œæˆ‘ä»¬ä¹Ÿç¢°åˆ°äº†è¿™ç§é—®é¢˜ï¼Œå¯ä»¥å‚è€ƒè€å¸ˆçš„æ–¹å¼æ¥å¤„ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607474793,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191003,"user_name":"æ–æ³¢é‚£å¥‘","can_delete":false,"product_type":"c1","uid":1464006,"ip_address":"","ucode":"85E2EBC01392B1","user_header":"https://static001.geekbang.org/account/avatar/00/16/56/c6/0b449bc6.jpg","comment_is_top":false,"comment_ctime":1584717099,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"57419291947","product_id":100047701,"comment_content":"é‡Œé¢è¯´çš„å‘ä¹Ÿè®¸è¿‡äº†ä¸€æ®µæ—¶é—´å°±å¿˜äº† å½“æ—¶æœ‰å››ä¸ªå­—æ˜¯æˆ‘å­¦åˆ°çš„ é‚£å°±æ˜¯â€œæŸ¥çœ‹æºç â€","like_count":13},{"had_liked":false,"id":195283,"user_name":"UnravelğŸ‘¾","can_delete":false,"product_type":"c1","uid":1078512,"ip_address":"","ucode":"9442FF23E783A9","user_header":"https://static001.geekbang.org/account/avatar/00/10/74/f0/708189aa.jpg","comment_is_top":false,"comment_ctime":1585153547,"is_pvip":false,"replies":[{"id":"74237","content":"æ—¢ç„¶ä½ æ˜¯é‡åˆ°å¶å°”å‡ºç°è¿æ¥å¤±è´¥ï¼Œè¯´æ˜å¯¹ç«¯ç«¯å£æ˜¯å¼€çš„ï¼Œè¿™ç§è¿æ¥è¶…æ—¶å¶å‘é—®é¢˜ä¸€èˆ¬æ˜¯ç½‘ç»œé—®é¢˜ï¼Œä¸¢åŒ…ã€é˜²ç«å¢™ã€å¸¦å®½æ‰“æ»¡ã€ç½‘å¡é…ç½®é—®é¢˜ï¼Œç”šè‡³æ˜¯ç¡¬ä»¶é—®é¢˜ï¼ˆç½‘çº¿ç½‘å£ï¼‰ç­‰å¼•èµ·çš„ï¼Œé“¾è·¯ä¸Šä»»ä½•ä¸€ä¸ªç¯èŠ‚çš„è½¯ä»¶å’Œç¡¬ä»¶éƒ½å¯èƒ½å¼•èµ·é—®é¢˜ï¼ŒæŠ“åŒ…åˆ†æå§ã€‚<br><br>å¦å¤–pingä¸€æ¬¡æ˜¯æˆåŠŸçš„ï¼Œé•¿pingä¸€ä¸‹çœ‹çœ‹ã€‚curlä¸€æ¬¡æ˜¯æˆåŠŸçš„ï¼Œåšä¸€ä¸ªç›‘æ§10sä¸€æ¬¡curlä¸€æ¬¡è¯•è¯•ã€‚","user_name":"ä½œè€…å›å¤","comment_id":195283,"uid":"1001470","ip_address":"","utype":1,"ctime":1585183468,"user_name_real":"æœ±æ™”"}],"discussion_count":2,"race_medal":0,"score":"35944891915","product_id":100047701,"comment_content":"è€å¸ˆæ‚¨å¥½<br>å‰æ®µæ—¶é—´é‡åˆ°è¿‡ä¸€ä¸ªè¿æ¥è¶…æ—¶çš„é—®é¢˜ï¼Œåœ¨springbootä¸­ä½¿ç”¨restTemplate(æ— è®ºæ˜¯ä¸é…ç½®è¿˜æ˜¯å¢å¤§è¶…æ—¶æ—¶é—´æˆ–æ˜¯åŠ å…¥apache http clientè¿æ¥æ± )åœ¨ä¸šåŠ¡ä¸­è¯·æ±‚å¦å¤–ä¸€ä¸ªæœåŠ¡çš„æ¥å£ç»å¸¸ä¼šå‡ºconnect timeout(ç»è¿‡nginxæˆ–æ˜¯ç›´æ¥è¿æ¥tomcatéƒ½ä¼šå‡ºç°)<br>æ­¤æ—¶pingã€telnetã€curléƒ½æ˜¯æˆåŠŸçš„<br>ä½†æ˜¯å¦‚æœå¦æœ‰ä¸€ä¸ªä»»åŠ¡å®šæ—¶ä¸€ç›´è¯·æ±‚æ¥å£ï¼Œé‚£ä¹ˆåœ¨ä¸šåŠ¡ä¸­å°±ä¸ä¼šå‡ºç°connect timeoutäº†ã€‚<br>ä¸€ç›´æ²¡æœ‰æˆåŠŸè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæƒ³é—®ä¸‹è€å¸ˆå¯ä»¥ä»å“ªæ–¹é¢å…¥æ‰‹ï¼Œè°¢è°¢è€å¸ˆ","like_count":8,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489014,"discussion_content":"æ—¢ç„¶ä½ æ˜¯é‡åˆ°å¶å°”å‡ºç°è¿æ¥å¤±è´¥ï¼Œè¯´æ˜å¯¹ç«¯ç«¯å£æ˜¯å¼€çš„ï¼Œè¿™ç§è¿æ¥è¶…æ—¶å¶å‘é—®é¢˜ä¸€èˆ¬æ˜¯ç½‘ç»œé—®é¢˜ï¼Œä¸¢åŒ…ã€é˜²ç«å¢™ã€å¸¦å®½æ‰“æ»¡ã€ç½‘å¡é…ç½®é—®é¢˜ï¼Œç”šè‡³æ˜¯ç¡¬ä»¶é—®é¢˜ï¼ˆç½‘çº¿ç½‘å£ï¼‰ç­‰å¼•èµ·çš„ï¼Œé“¾è·¯ä¸Šä»»ä½•ä¸€ä¸ªç¯èŠ‚çš„è½¯ä»¶å’Œç¡¬ä»¶éƒ½å¯èƒ½å¼•èµ·é—®é¢˜ï¼ŒæŠ“åŒ…åˆ†æå§ã€‚\n\nå¦å¤–pingä¸€æ¬¡æ˜¯æˆåŠŸçš„ï¼Œé•¿pingä¸€ä¸‹çœ‹çœ‹ã€‚curlä¸€æ¬¡æ˜¯æˆåŠŸçš„ï¼Œåšä¸€ä¸ªç›‘æ§10sä¸€æ¬¡curlä¸€æ¬¡è¯•è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585183468,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1074897,"avatar":"https://static001.geekbang.org/account/avatar/00/10/66/d1/8664c464.jpg","nickname":"flyCoder","note":"","ucode":"82FB7B60775978","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283574,"discussion_content":"è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä¹Ÿé‡åˆ°äº†ï¼Œæˆ‘è¿™è¾¹å¢åŠ å¸¦å®½å°±å¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592299390,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190998,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1584716905,"is_pvip":false,"replies":[{"id":"73358","content":"å¦‚æœè§‰å¾—æœ‰ç”¨å¯ä»¥å¤šè½¬å‘åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":190998,"uid":"1001470","ip_address":"","utype":1,"ctime":1584749513,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"23059553385","product_id":100047701,"comment_content":"èŠ±äº†ä¸¤ä¸ªæ™šä¸Šç»ˆäºè¿˜æ˜¯æŠŠè¿™èŠ‚å•ƒäº†ä¸‹æ¥ï¼Œå‡†å¤‡è¿è¡Œç¯å¢ƒï¼Œé‡ç°æ‰€æœ‰é—®é¢˜ï¼Œç¿»çœ‹ç›¸å…³æºç ã€‚<br>ç»ˆäºç­‰åˆ°ä½ ï¼Œè¿˜å¥½æˆ‘æ²¡æ”¾å¼ƒã€‚<br>ä¸ªäººæ„Ÿæ‚Ÿï¼Œè¿™äº›å‘å¯¹ä»¥åå¿«é€Ÿæ’æŸ¥é—®é¢˜ï¼Œè‚¯å®šæœ‰å¸®åŠ©ã€‚å°±ç®—ä»¥åæ·¡å¿˜äº†è¿™èŠ‚çš„å†…å®¹ï¼Œä½†è‡³å°‘è¿˜ä¼šæœ‰äº›è®¸è®°å¿†çš„ï¼Œå“ªä¸ªä¸“æ ï¼Œå“ªä¸ªè€å¸ˆï¼Œå“ªç¯‡æ–‡ç« ã€‚æ„Ÿè°¢è€å¸ˆï¼","like_count":5,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488097,"discussion_content":"å¦‚æœè§‰å¾—æœ‰ç”¨å¯ä»¥å¤šè½¬å‘åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584749513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190831,"user_name":"é™ˆå¤©æŸ±","can_delete":false,"product_type":"c1","uid":1696225,"ip_address":"","ucode":"917BFDC845760D","user_header":"https://static001.geekbang.org/account/avatar/00/19/e1/e1/441df85d.jpg","comment_is_top":false,"comment_ctime":1584696743,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23059533223","product_id":100047701,"comment_content":"ä¹‹å‰ç”¨Spring Cloudå°±é‡åˆ°è¿‡feignè°ƒç”¨è¶…æ—¶çš„å‘ï¼Œå§‹ç»ˆé…ç½®readTimeoutå€¼éƒ½ä¸ç”Ÿæ•ˆã€‚è™½ç„¶åé¢ç½‘ä¸ŠæŸ¥é˜…äº†èµ„æ–™æš‚æ—¶æ€§è§£å†³äº†ï¼Œä½†æ˜¯çœ‹äº†è€å¸ˆçš„è§£å†³é—®é¢˜æ€è·¯æ‰å‘ç°ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦å¸¦ç€é—®é¢˜å»é˜…è¯»æºç æ‰¾å¯»ç­”æ¡ˆï¼Œæé«˜è‡ªå·±é˜…è¯»æºç çš„èƒ½åŠ›ã€‚ ","like_count":5},{"had_liked":false,"id":190346,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1584631164,"is_pvip":false,"replies":[{"id":"73218","content":"æºç é‡Œé¢æœ‰ï¼Œåœ¨clientreadtimeouté‡Œ<br>Requestæ˜¯åœ¨è¿™é‡Œï¼š<br>&lt;dependency&gt;<br>            &lt;groupId&gt;org.apache.httpcomponents&lt;&#47;groupId&gt;<br>            &lt;artifactId&gt;fluent-hc&lt;&#47;artifactId&gt;<br>            &lt;version&gt;4.5.9&lt;&#47;version&gt;<br>        &lt;&#47;dependency&gt;","user_name":"ä½œè€…å›å¤","comment_id":190346,"uid":"1001470","ip_address":"","utype":1,"ctime":1584665096,"user_name_real":"æœ±æ™”"}],"discussion_count":3,"race_medal":0,"score":"14469533052","product_id":100047701,"comment_content":"public class ClientReadTimeoutController {<br>    private String getResponse(String url, int connectTimeout, int readTimeout) throws IOException {<br>        return Request.Get(&quot;http:&#47;&#47;localhost:45678&#47;clientreadtimeout&quot; + url)<br>                .connectTimeout(connectTimeout)<br>                .socketTimeout(readTimeout)<br>                .execute()<br>                .returnContent()<br>                .asString();<br>    }<br>....<br>}<br><br><br>è¿™ç¬¬ä¸€æ®µä»£ç ä¸­Requestè¿™ä¸ªç±»ï¼Œæ˜¯å¼•ç”¨å“ªä¸ªåŒ…ä¸‹çš„ï¼Ÿæ‰¾å¾—å¥½è¾›è‹¦ï¼Œè€å¸ˆç¬¬5èŠ‚çš„ä»£ç ä¹Ÿæ²¡ä¸Šä¼ åˆ°git","like_count":3,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487956,"discussion_content":"æºç é‡Œé¢æœ‰ï¼Œåœ¨clientreadtimeouté‡Œ\nRequestæ˜¯åœ¨è¿™é‡Œï¼š\n&amp;lt;dependency&amp;gt;\n            &amp;lt;groupId&amp;gt;org.apache.httpcomponents&amp;lt;/groupId&amp;gt;\n            &amp;lt;artifactId&amp;gt;fluent-hc&amp;lt;/artifactId&amp;gt;\n            &amp;lt;version&amp;gt;4.5.9&amp;lt;/version&amp;gt;\n        &amp;lt;/dependency&amp;gt;","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584665096,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","nickname":"è¡Œåˆ™å°†è‡³","note":"","ucode":"DB972F2DF059C4","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382878,"discussion_content":"è¿™ä¸ªå†™æ³•ï¼Œç”¨è€å¸ˆä¸Šä¸€èŠ‚çš„çŸ¥è¯†å‹æµ‹äº†ä¸€ä¸‹ã€‚æ¯å‘èµ·ä¸€æ¬¡è¯·æ±‚ï¼Œä¼šåˆ›å»ºä¸€ä¸ªTCPè¿æ¥ã€‚éšç€è¯·æ±‚æ•°å¢å¤§ï¼Œè¿æ¥æ•°ä¹Ÿä¼šå¢å¤§ï¼Œç”Ÿäº§è¿™ä¹ˆå†™ä¼šæœ‰é—®é¢˜çš„ã€‚è¿˜æ˜¯æé‚£ç§çº¿ç¨‹æ± å¤ç”¨çš„ï¼Œæ›´é è°±","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625752718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1250907,"avatar":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","nickname":"Monday","note":"","ucode":"77B9BACC783598","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":209554,"discussion_content":"ä»è€pom.xmlä¸­æ‰¾åˆ°äº†é‚£ä¸ªä¾èµ–åŒ…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584634547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190318,"user_name":"ç»ˆç»“è€…999å·","can_delete":false,"product_type":"c1","uid":1055854,"ip_address":"","ucode":"33ADE61580B6DD","user_header":"https://static001.geekbang.org/account/avatar/00/10/1c/6e/6c5f5734.jpg","comment_is_top":false,"comment_ctime":1584628684,"is_pvip":true,"replies":[{"id":"73278","content":"æˆ‘ä¸ªäººè§‰å¾—okhttpæ˜“ç”¨æ€§æ›´é«˜ä¸€ç‚¹ï¼Œä¸è¿‡okhttpåº”è¯¥åœ¨å®‰å“é¢†åŸŸæ›´ç«ä¸€ç‚¹ï¼Œåç«¯ä½¿ç”¨okhttpçš„åº”è¯¥ä¸å¤šã€‚ä¸‡å˜ä¸ç¦»å…¶å®—ï¼Œä½¿ç”¨ä»»ä½•httpclientéƒ½è¦è€ƒè™‘è¿æ¥æ± ã€è¶…æ—¶é…ç½®ã€è‡ªåŠ¨é‡è¯•å’Œå¹¶å‘é—®é¢˜","user_name":"ä½œè€…å›å¤","comment_id":190318,"uid":"1001470","ip_address":"","utype":1,"ctime":1584675783,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"14469530572","product_id":100047701,"comment_content":"è€å¸ˆï¼Œå¯¹äºHttp Clientå’ŒOk Httpç›¸æ¯”ï¼Œæ˜¯ä¸æ˜¯OkHttpæ”¯æŒå¾—æ›´å¥½ï¼Œè€Œä¸”HTTP2ç›¸æ¯”äºHTTP1.1çš„æ–°ç‰¹æ€§æ˜¯ä¸æ˜¯ä¹Ÿä½¿å¾—æˆ‘ä»¬ä¸ç”¨è¿‡å»çš„ä¸€äº›é…ç½®äº†å•Š","like_count":3,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487948,"discussion_content":"æˆ‘ä¸ªäººè§‰å¾—okhttpæ˜“ç”¨æ€§æ›´é«˜ä¸€ç‚¹ï¼Œä¸è¿‡okhttpåº”è¯¥åœ¨å®‰å“é¢†åŸŸæ›´ç«ä¸€ç‚¹ï¼Œåç«¯ä½¿ç”¨okhttpçš„åº”è¯¥ä¸å¤šã€‚ä¸‡å˜ä¸ç¦»å…¶å®—ï¼Œä½¿ç”¨ä»»ä½•httpclientéƒ½è¦è€ƒè™‘è¿æ¥æ± ã€è¶…æ—¶é…ç½®ã€è‡ªåŠ¨é‡è¯•å’Œå¹¶å‘é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584675783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189826,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1584573496,"is_pvip":false,"replies":[{"id":"73140","content":"å¦‚æœè§‰å¾—å¥½ï¼Œå¯ä»¥å¤šåˆ†äº«è½¬å‘","user_name":"ä½œè€…å›å¤","comment_id":189826,"uid":"1001470","ip_address":"","utype":1,"ctime":1584599889,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"14469475384","product_id":100047701,"comment_content":"å¥½æ–‡ç« ï¼Œå¥½â€œå‘â€ã€‚","like_count":3,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487806,"discussion_content":"å¦‚æœè§‰å¾—å¥½ï¼Œå¯ä»¥å¤šåˆ†äº«è½¬å‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584599889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232744,"user_name":"Whale","can_delete":false,"product_type":"c1","uid":1485161,"ip_address":"","ucode":"33DEA25F913C6B","user_header":"https://static001.geekbang.org/account/avatar/00/16/a9/69/7fe99f4e.jpg","comment_is_top":false,"comment_ctime":1594106798,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10184041390","product_id":100047701,"comment_content":"å­¦åˆ°äº† feignå’Œhttpclientéƒ½ç”¨è¿‡ï¼Œåªåœç•™åœ¨å…¶ä»–äººæ­å»ºå¥½æˆ‘ä½¿ç”¨çš„çŠ¶æ€ï¼Œä½†è¿™æ¬¡å¯¹feignå’Œhttpclientçš„ä¸€äº›é…ç½®éƒ½æœ‰äº†æ–°çš„è®¤è¯†ï¼Œæ¥ä¸‹æ¥æ‰“ç®—è‡ªå·±å»è¯•ç€æ­å»ºã€‚å¾ˆæœ‰æ”¶è·ï¼Œç»§ç»­å‰è¿›ï¼","like_count":2},{"had_liked":false,"id":198627,"user_name":"çœ‹ä¸åˆ°deé¢œè‰²","can_delete":false,"product_type":"c1","uid":1162714,"ip_address":"","ucode":"88348CCAE81931","user_header":"https://static001.geekbang.org/account/avatar/00/11/bd/da/3d76ea74.jpg","comment_is_top":false,"comment_ctime":1585460759,"is_pvip":false,"replies":[{"id":"74711","content":"æ˜¯çš„ é™¤ésend bufferæ»¡äº†","user_name":"ä½œè€…å›å¤","comment_id":198627,"uid":"1001470","ip_address":"","utype":1,"ctime":1585467617,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"10175395351","product_id":100047701,"comment_content":"å¤„ç†è¶…æ—¶ä¸€å®šè¦ææ¸…æ¥šè¶…æ—¶çš„é˜¶æ®µã€‚åˆ°åº•æ˜¯å»ºè¿è¶…æ—¶è¿˜æ˜¯ç­‰å¾…å“åº”è¶…æ—¶(è¯»å–è¶…æ—¶)ã€‚é’ˆå¯¹ä¸åŒçš„é—®é¢˜é’ˆå¯¹è§£å†³ã€‚å¯¹äºå†™è¶…æ—¶è¿™ä¸ªç›¸å½“äºå†™æœ¬åœ°TCPç¼“å†²åŒºï¼Œé€Ÿåº¦åº”è¯¥å¾ˆå¿«ï¼Œå¾ˆå°‘ä¼šå‡ºç°socketæ— æ³•å†™å…¥å¯¼è‡´çš„å†™è¶…æ—¶é—®é¢˜ã€‚<br>å¾ˆä¹…æ²¡ç”¨ç”¨è¿‡HttpClientäº†ã€‚å›å¿†äº†ä¸€ä¸‹ï¼Œä»¥å‰ç¡®å®æ²¡æœ‰ææ¸…æ¥šæ€»å¹¶å‘(maxTotal)å’Œå•åŸŸåå¹¶å‘(defaultMaxPerRoute)çš„åŒºåˆ«ã€‚é€šè¿‡è¿™ç¯‡æ–‡ç« æ€»ç®—ææ˜ç™½äº†ï¼Œæ”¶è´§é¢‡ä¸°ã€‚","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489730,"discussion_content":"æ˜¯çš„ é™¤ésend bufferæ»¡äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585467617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190978,"user_name":"ä¸€ä¸ªæƒ³å·æ‡’çš„ç¨‹åºå‘","can_delete":false,"product_type":"c1","uid":1013223,"ip_address":"","ucode":"C5F221A7065B74","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/e7/326d7515.jpg","comment_is_top":false,"comment_ctime":1584715580,"is_pvip":false,"replies":[{"id":"73359","content":"å¦‚æœè§‰å¾—æœ‰ç”¨å¯ä»¥å¤šè½¬å‘åˆ†äº«","user_name":"ä½œè€…å›å¤","comment_id":190978,"uid":"1001470","ip_address":"","utype":1,"ctime":1584749518,"user_name_real":"æœ±æ™”"}],"discussion_count":1,"race_medal":0,"score":"10174650172","product_id":100047701,"comment_content":"è™½ç„¶æ²¡å¤„ç†è¿‡è¿™å—å„¿çš„ä¸œè¥¿ï¼Œä½†çœ‹å®Œäº†è§£äº†è®¸å¤šçŸ¥è¯†ï¼Œèµï¼","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488092,"discussion_content":"å¦‚æœè§‰å¾—æœ‰ç”¨å¯ä»¥å¤šè½¬å‘åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584749518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190393,"user_name":"Alpha","can_delete":false,"product_type":"c1","uid":1001861,"ip_address":"","ucode":"60CA15A25EC796","user_header":"https://static001.geekbang.org/account/avatar/00/0f/49/85/3f161d95.jpg","comment_is_top":false,"comment_ctime":1584636565,"is_pvip":false,"replies":[{"id":"73216","content":"è¿™ä¹ˆé•¿çš„å‚æ•°çœ‹çœ‹æ˜¯å¦åˆç†ï¼Œå¯¹äºæœ‰ä¸€äº›æ•°æ®å®ƒå¯èƒ½å¹¶ä¸æ˜¯æŸ¥è¯¢å‚æ•°å¯ä»¥æ”¾å¤´é‡Œä¼ ","user_name":"ä½œè€…å›å¤","comment_id":190393,"uid":"1001470","ip_address":"","utype":1,"ctime":1584664783,"user_name_real":"æœ±æ™”"}],"discussion_count":3,"race_medal":0,"score":"10174571157","product_id":100047701,"comment_content":"éå¸¸åŒæ„é€‰æ‹©Getè¿˜æ˜¯Poståº”è¯¥ä¾æ®APIçš„è¡Œä¸ºã€‚<br>ä½†æ˜¯æœ‰æ—¶æ•°æ®æŸ¥è¯¢çš„APIå‚æ•°ç¡®å®ä¸å¾—å·²å¾ˆé•¿ï¼Œä¼šå¯¼è‡´æµè§ˆå™¨çš„é•¿åº¦é™åˆ¶ï¼Œè€å¸ˆæœ‰å¥½çš„åŠæ³•å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487969,"discussion_content":"è¿™ä¹ˆé•¿çš„å‚æ•°çœ‹çœ‹æ˜¯å¦åˆç†ï¼Œå¯¹äºæœ‰ä¸€äº›æ•°æ®å®ƒå¯èƒ½å¹¶ä¸æ˜¯æŸ¥è¯¢å‚æ•°å¯ä»¥æ”¾å¤´é‡Œä¼ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584664783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b4/f6/e39d5af1.jpg","nickname":"é’±ç±³","note":"","ucode":"07AA44C6A40D34","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388647,"discussion_content":"è™½ç„¶ä¸å¤ªåˆé€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628865194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1225974,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b4/f6/e39d5af1.jpg","nickname":"é’±ç±³","note":"","ucode":"07AA44C6A40D34","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388646,"discussion_content":"çŠ¹è±«ä¸å†³é€‰POSTï¼Œæœ‰çš„å…¬å¸ä¸ºäº†ç»Ÿä¸€é¿å‘ç­‰ï¼Œæ‰€æœ‰æ¥å£ç”¨POST","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1628865171,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190241,"user_name":"Monday","can_delete":false,"product_type":"c1","uid":1250907,"ip_address":"","ucode":"77B9BACC783598","user_header":"https://static001.geekbang.org/account/avatar/00/13/16/5b/83a35681.jpg","comment_is_top":false,"comment_ctime":1584621301,"is_pvip":false,"replies":[{"id":"73187","content":"è¿™å°±ä¸æ¸…æ¥šäº†","user_name":"ä½œè€…å›å¤","comment_id":190241,"uid":"1001470","ip_address":"","utype":1,"ctime":1584625134,"user_name_real":"æœ±æ™”"}],"discussion_count":3,"race_medal":0,"score":"10174555893","product_id":100047701,"comment_content":"ribbon.ReadTimeout=4000<br>ribbon.ConnectTimeout=4000<br><br>è¿™ä¸ªå‚æ•°çš„keyå‘½åä¸è§„èŒƒï¼Œæ˜¯æœ‰æ•…äº‹ï¼Œè¿˜æ˜¯å¼€å‘äººå‘˜ä¸å¤Ÿä¸“ä¸šï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487924,"discussion_content":"è¿™å°±ä¸æ¸…æ¥šäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584625134,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1213078,"avatar":"https://static001.geekbang.org/account/avatar/00/12/82/96/aa795685.jpg","nickname":"mghio","note":"","ucode":"74883EDE4FD0DC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":356958,"discussion_content":"å®ä¹ ç”Ÿå†™çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615713741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1139455,"avatar":"https://static001.geekbang.org/account/avatar/00/11/62/ff/f71034e9.jpg","nickname":"æ‚Ÿç©ºWuKong","note":"","ucode":"49AFD2B048C1BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":298367,"discussion_content":"æ–°æ‰‹å†™çš„å§ï¼Œå“ˆå“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597281664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233960,"user_name":"James","can_delete":false,"product_type":"c1","uid":1134861,"ip_address":"","ucode":"48B0F2A334D1C1","user_header":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","comment_is_top":false,"comment_ctime":1594535956,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5889503252","product_id":100047701,"comment_content":"å·²è§£å†³,æ˜¯pom.xmlæ–‡ä»¶æ²¡æœ‰å°†é…ç½®æ–‡ä»¶åŒ…å«åˆ°classç›®å½•ä¸‹.","like_count":1},{"had_liked":false,"id":218783,"user_name":"å§œ æŸæŸ","can_delete":false,"product_type":"c1","uid":1525637,"ip_address":"","ucode":"20BF62290A9B4A","user_header":"https://static001.geekbang.org/account/avatar/00/17/47/85/5ee73eb1.jpg","comment_is_top":false,"comment_ctime":1589874893,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5884842189","product_id":100047701,"comment_content":"demoç¨‹åº æ€ä¹ˆè·‘èµ·æ¥ ï¼Ÿ","like_count":1},{"had_liked":false,"id":217679,"user_name":"æ˜Ÿè¾°å¤§æµ·","can_delete":false,"product_type":"c1","uid":1265881,"ip_address":"","ucode":"6A1134533337FA","user_header":"https://static001.geekbang.org/account/avatar/00/13/50/d9/18acc2ee.jpg","comment_is_top":false,"comment_ctime":1589583638,"is_pvip":false,"replies":[{"id":"80504","content":"è™½ç„¶éƒ½åŒ…è£…ä¸ºäº†ResourceAccessExceptionï¼Œä½†æ˜¯å…·ä½“çš„causeéƒ½æ˜¯ä¸åŒçš„","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1589592804,"ip_address":"","comment_id":217679,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5884550934","product_id":100047701,"comment_content":"è€å¸ˆä½ å¥½ æƒ³é—®ä¸‹resttemplateå¯ä»¥å•ç‹¬é’ˆå¯¹sockettimeout exceptionè¿›è¡Œå¤„ç†å— æœ€è¿‘çš„ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨resttemplateæ–¹å¼è°ƒç”¨ä¸‹æ¸¸ é’ˆå¯¹è¯»å–è¶…æ—¶çš„æƒ…å†µä¸å†è¿›è¡Œé‡è¯• ä½†resttemplateå¯¹å¼‚å¸¸è¿›è¡Œäº†é‡æ–°å°è£… æ— æ³•è¿›è¡Œå•ç‹¬è¯†åˆ« ","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495217,"discussion_content":"è™½ç„¶éƒ½åŒ…è£…ä¸ºäº†ResourceAccessExceptionï¼Œä½†æ˜¯å…·ä½“çš„causeéƒ½æ˜¯ä¸åŒçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589592804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199235,"user_name":"è¿è¾¹","can_delete":false,"product_type":"c1","uid":1391748,"ip_address":"","ucode":"54B5DA38449728","user_header":"https://static001.geekbang.org/account/avatar/00/15/3c/84/608f679b.jpg","comment_is_top":false,"comment_ctime":1585483387,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880450683","product_id":100047701,"comment_content":"åªè€ƒè™‘è¿‡è¶…æ—¶ã€‚","like_count":1},{"had_liked":false,"id":191929,"user_name":"justinzhong","can_delete":false,"product_type":"c1","uid":1903397,"ip_address":"","ucode":"54E0F38FDE713F","user_header":"https://static001.geekbang.org/account/avatar/00/1d/0b/25/bee12452.jpg","comment_is_top":false,"comment_ctime":1584804078,"is_pvip":false,"replies":[{"id":"73490","content":"1. ç¡®å®šæ²¡çœ‹é”™ï¼Œä¹Ÿå°±æ˜¯RibbonRetryIssueServerControlleråªçœ‹åˆ°ä¸€æ¬¡è¾“å‡º<br>2. ç¡®å®šå‚æ•°ribbon.OkToRetryOnAllOperationsæ²¡æœ‰è®¾ç½®ä¸ºtrue","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584836631,"ip_address":"","comment_id":191929,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879771374","product_id":100047701,"comment_content":"è€å¸ˆï¼Œé’ˆå¯¹å‘é€çŸ­ä¿¡çš„é‚£ä¸ªä¾‹å­ï¼Œè§£å†³é‡è¯•é—®é¢˜çš„æ–¹æ³•ä¸€ï¼šå°±æ˜¯getè¯·æ±‚æ¢æˆpostè¯·æ±‚ï¼Œæˆ‘è¯•äº†å‡ æ¬¡éƒ½æ˜¯ä¸è¡Œçš„ï¼Œè¿˜æ˜¯ä¼šé‡è¯•ä¸€æ¬¡ï¼Œä½†æ˜¯æ–¹æ³•äºŒæ˜¯å®Œå…¨å¯ä»¥çš„ã€‚å¯ä»¥é’ˆå¯¹æ–¹æ³•ä¸€çš„è§£å†³é‡è¯•é—®é¢˜çš„æ€è·¯å†æè¿°çš„æ¸…æ¥šä¸€äº›å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488288,"discussion_content":"1. ç¡®å®šæ²¡çœ‹é”™ï¼Œä¹Ÿå°±æ˜¯RibbonRetryIssueServerControlleråªçœ‹åˆ°ä¸€æ¬¡è¾“å‡º\n2. ç¡®å®šå‚æ•°ribbon.OkToRetryOnAllOperationsæ²¡æœ‰è®¾ç½®ä¸ºtrue","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584836631,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190800,"user_name":"æ±æ—å¤–å²","can_delete":false,"product_type":"c1","uid":1188906,"ip_address":"","ucode":"3C66C0F0537A99","user_header":"https://static001.geekbang.org/account/avatar/00/12/24/2a/33441e2b.jpg","comment_is_top":false,"comment_ctime":1584693249,"is_pvip":false,"replies":[{"id":"73319","content":"è¿™é‡Œæ˜¯å¯ä»¥ç›´æ¥ä¼ CloseableHttpClientçš„","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584696927,"ip_address":"","comment_id":190800,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879660545","product_id":100047701,"comment_content":"sendRequest(int count, Supplier&lt;CloseableHttpClient&gt; client) è¿™ä¸ªæ–¹æ³•ä¸­ç¬¬äºŒä¸ªå‚æ•°ä¸ºä»€ä¹ˆè¦ç”¨ä¸€ä¸ªå‡½æ•°æ¥å£è€Œä¸æ˜¯ç›´æ¥ç”¨CloseableHttpClientç±»å‹å‘¢ï¼Ÿ æˆ‘çœ‹ä¹Ÿæ²¡ç”¨åˆ°ä»€ä¹ˆç‰¹æ€§ï¼Œåªæ˜¯è°ƒç”¨äº†executeæ–¹æ³•è€Œå·²ï¼Ÿ<br>è¯¾åé—®é¢˜ï¼š1. æ„Ÿè§‰å†™å…¥è¶…æ—¶å·²ç»åŒ…å«åœ¨è¯»å–è¶…æ—¶è¿™ä¸ªé‡Œé¢ï¼Œæ²¡å¿…è¦å•ç‹¬å®šä¹‰è¿™ä¹ˆç»†çš„è¶…æ—¶ã€‚<br>2. nginxçœŸä¸æ˜¯å¾ˆäº†è§£ï¼Œè€å¸ˆæƒ³åŠ é¤äº†å—ï¼Ÿå“ˆå“ˆ","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488057,"discussion_content":"è¿™é‡Œæ˜¯å¯ä»¥ç›´æ¥ä¼ CloseableHttpClientçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584696927,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190243,"user_name":"å¤§å°¾å·´è€çŒ«","can_delete":false,"product_type":"c1","uid":1260089,"ip_address":"","ucode":"246AB375244773","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/39/72d81605.jpg","comment_is_top":false,"comment_ctime":1584621439,"is_pvip":true,"replies":[{"id":"73183","content":"å°±æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªæœåŠ¡ç«¯æ¥å£","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584624567,"ip_address":"","comment_id":190243,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879588735","product_id":100047701,"comment_content":"void server();<br>è¿™ä¸€å¥ä»€ä¹ˆæ„æ€ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487925,"discussion_content":"å°±æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªæœåŠ¡ç«¯æ¥å£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584624567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190035,"user_name":"èš‚èšå†…æ¨+v","can_delete":false,"product_type":"c1","uid":1050508,"ip_address":"","ucode":"24B10AEE54B3FD","user_header":"https://static001.geekbang.org/account/avatar/00/10/07/8c/0d886dcc.jpg","comment_is_top":false,"comment_ctime":1584596382,"is_pvip":false,"replies":[{"id":"73132","content":"å…¶å®ä¹Ÿå°±æ˜¯åˆ°socket sendbufferçš„è¶…æ—¶ï¼ˆæ»¡çš„è¯ç­‰å¾…ç©ºé—´é‡Šæ”¾çš„è¶…æ—¶ï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584598816,"ip_address":"","comment_id":190035,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879563678","product_id":100047701,"comment_content":"è€å¸ˆæˆ‘æ˜¯åšå®¢æˆ·ç«¯çš„ ï¼Œæˆ‘ä»¬è¿™è¾¹è¿˜æœ‰ä¸ªå†™è¶…æ—¶æ¦‚å¿µè¿™å—è€å¸ˆæ–¹ä¾¿åˆ†äº«ä¸‹ä¸","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487862,"discussion_content":"å…¶å®ä¹Ÿå°±æ˜¯åˆ°socket sendbufferçš„è¶…æ—¶ï¼ˆæ»¡çš„è¯ç­‰å¾…ç©ºé—´é‡Šæ”¾çš„è¶…æ—¶ï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584598816,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189859,"user_name":"å…¬å·-æŠ€æœ¯å¤œæœªçœ ","can_delete":false,"product_type":"c1","uid":1013683,"ip_address":"","ucode":"83825B57CBD952","user_header":"https://static001.geekbang.org/account/avatar/00/0f/77/b3/991f3f9b.jpg","comment_is_top":false,"comment_ctime":1584577914,"is_pvip":true,"replies":[{"id":"73139","content":"å¦‚æœè§‰å¾—å¥½ï¼Œå¯ä»¥å¤šåˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584599878,"ip_address":"","comment_id":189859,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879545210","product_id":100047701,"comment_content":"è€å¸ˆæ€»ç»“çš„å¾ˆæœ‰æ·±åº¦ã€å¾ˆå…¨é¢ã€å¾ˆæœ‰ä¸šåŠ¡å®æˆ˜","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487815,"discussion_content":"å¦‚æœè§‰å¾—å¥½ï¼Œå¯ä»¥å¤šåˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584599878,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189838,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1584575426,"is_pvip":false,"replies":[{"id":"73070","content":"å—¯å¤§æ¦‚æ„æ€å¯¹ å¯ä»¥å†æœä¸€ä¸‹ç›¸å…³èµ„æ–™ç»§ç»­ç ”ç©¶ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584580540,"ip_address":"","comment_id":189838,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5879542722","product_id":100047701,"comment_content":"å¯¹äºæ•°æ®å†™å…¥ï¼Œå¼€å‘è€…éƒ½å¯ä»¥ç›´æ¥æ§åˆ¶ï¼Œè¦ä¹ˆå…ˆwriteç„¶åå†ä¸€æ¬¡æ€§flushï¼Œè¦ä¹ˆè¾¹writeè¾¹flushï¼Œè‡³äºæœ€åsocketç¼“å†²åŒºä¸­çš„æ•°æ®å¦‚ä½•å‘é€ï¼Œéƒ½äº¤ç»™äº†tcpã€‚","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487808,"discussion_content":"å—¯å¤§æ¦‚æ„æ€å¯¹ å¯ä»¥å†æœä¸€ä¸‹ç›¸å…³èµ„æ–™ç»§ç»­ç ”ç©¶ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584580540,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189817,"user_name":"æ¢¦å€šæ æ†","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1584570368,"is_pvip":false,"replies":[{"id":"73069","content":"å—¯å¤§æ¦‚æ„æ€å¯¹ å¯ä»¥å†æœä¸€ä¸‹ç›¸å…³èµ„æ–™ç»§ç»­ç ”ç©¶ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584580534,"ip_address":"","comment_id":189817,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5879537664","product_id":100047701,"comment_content":"æŒ‰ç…§è€å¸ˆè§£é‡Šçš„è¯»å–è¶…æ—¶çš„æ¦‚å¿µï¼šå­—èŠ‚æµæ”¾å…¥socket---&gt;æœåŠ¡ç«¯å¤„ç†-------&gt;æœåŠ¡ç«¯è¿”å›---&gt;å–å‡ºå­—èŠ‚æµã€‚<br>é‚£å†™å…¥è¶…æ—¶ä¼°è®¡å°±æ˜¯å­—èŠ‚æµæ”¾å…¥socketçš„æ—¶é—´ï¼Œè¿™ä¸ªå±äºè‡ªå·±ä¸»åŠ¨æ§åˆ¶çš„å¯èƒ½æ²¡æœ‰å¿…è¦å§ï¼Œå…·ä½“å¯èƒ½è¿˜éœ€è¦äº†è§£ä¸€ä¸‹ç½‘ç»œç¼–ç¨‹æ‰èƒ½çŸ¥é“ã€‚","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487804,"discussion_content":"å—¯å¤§æ¦‚æ„æ€å¯¹ å¯ä»¥å†æœä¸€ä¸‹ç›¸å…³èµ„æ–™ç»§ç»­ç ”ç©¶ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584580534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1623626,"avatar":"https://static001.geekbang.org/account/avatar/00/18/c6/4a/3bd896fc.jpg","nickname":"Heiky","note":"","ucode":"03AA79E1BC4AE4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258727,"discussion_content":"æˆ‘æ€ä¹ˆæ„Ÿè§‰è¿™æ ·ç†è§£ä¸å¯¹ï¼Œè€å¸ˆè¯´çš„æ˜¯è¯»å–è¶…æ—¶ï¼Œåº”è¯¥æ˜¯æœåŠ¡ç«¯å¤„ç†â€”â€”>æœåŠ¡ç«¯å†™å›socketâ€”â€”>å®¢æˆ·ç«¯è¯»å–ï¼Œè¿™æ ·çš„ä¸€ä¸ªæµç¨‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588725544,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":356824,"user_name":"katalya","can_delete":false,"product_type":"c1","uid":1367464,"ip_address":"å¹¿ä¸œ","ucode":"CCD1FE6C4F8C1E","user_header":"https://static001.geekbang.org/account/avatar/00/14/dd/a8/a2c910b6.jpg","comment_is_top":false,"comment_ctime":1662619406,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1662619406","product_id":100047701,"comment_content":"ç‰›é€¼","like_count":0},{"had_liked":false,"id":347426,"user_name":"æ”¾å­¦åçš„å°æ—åŒå­¦","can_delete":false,"product_type":"c1","uid":2271534,"ip_address":"","ucode":"D8D6D8292ED816","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/3cm60SpHkFkZwoUIGguZl3mm3YyObVs8Rl0J4ibJ4ExhBaJUluGVxTfE0RdKSiaWLx5eFkos2BDA8aQQ8xuTOy3Q/132","comment_is_top":false,"comment_ctime":1654006524,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1654006524","product_id":100047701,"comment_content":"çœŸçš„æ˜¯è®©æˆ‘è¶Šå‘æ„Ÿè§‰åˆ°åº•å±‚å­¦ä¹ çš„é‡è¦æ€§","like_count":0},{"had_liked":false,"id":342163,"user_name":"èŠ±èŠ±å¤§è„¸çŒ«","can_delete":false,"product_type":"c1","uid":1117318,"ip_address":"","ucode":"8ABDB3F7F4FB0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","comment_is_top":false,"comment_ctime":1650077487,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1650077487","product_id":100047701,"comment_content":"ä¹‹å‰æœ‰é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œä¸Šä¼ è¥ä¸šæ‰§ç…§çš„ä¸€ä¸ªæ¥å£ï¼Œæ¯æ¬¡éƒ½ä¼šè¶…æ—¶ï¼Œä½†æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¤„ç†çš„æ—¶é—´éƒ½ä¸é•¿ï¼Œæœ€åå‘ç°æ˜¯å¸¦å®½å¤ªå°ï¼Œç›¸å½“å¤§ä¸€éƒ¨åˆ†æ—¶é—´æµªè´¹åœ¨æ•°æ®ä¼ è¾“ä¸Šäº†ã€‚ã€‚ã€‚","like_count":0},{"had_liked":false,"id":324517,"user_name":"è€åœ°å¹³çº¿","can_delete":false,"product_type":"c1","uid":1116077,"ip_address":"","ucode":"C0308B3AA50BF0","user_header":"https://static001.geekbang.org/account/avatar/00/11/07/ad/d8ca4249.jpg","comment_is_top":false,"comment_ctime":1638486588,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1638486588","product_id":100047701,"comment_content":"è€å¸ˆå¥½ï¼Œæƒ³è¯·æ•™ä¸€ä¸‹ï¼Œå¦‚æœæ˜¯æ¯æ¬¡è°ƒç”¨æ–¹æ³•éƒ½è¦åˆ›å»ºä¸€ä¸ªHttpClientsï¼Œé‚£æ˜¯ä¸æ˜¯å¯ä»¥ç†è§£å¹¶æ²¡æœ‰ç”¨ä¸ŠhttpClientè¿æ¥æ± ã€‚<br><br>public static String sendRawJSON(String url, String JSON) {<br>        .....<br>        CloseableHttpClient httpClient = null;<br>        HttpPost httpPost = null;<br>        String result = null;<br>        try {<br>            httpClient = HttpClients.createDefault();<br>            httpPost = new HttpPost(url);<br>            &#47;&#47;è®¾ç½®å‚æ•°<br>             .... <br>            HttpResponse response = httpClient.execute(httpPost); <br>            ....<br>        } catch (Exception ex) { <br>            ex.printStackTrace();<br>        }<br>      <br>        return result;<br>    }","like_count":0},{"had_liked":false,"id":315183,"user_name":"çºµä¸æœ½","can_delete":false,"product_type":"c1","uid":1877862,"ip_address":"","ucode":"DB2CA2C46B2EF1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLu3MgZBAyyiavX2CMF2KRib791j3bBGiaQDzuQwBF2k6AKHANV2uTAAss2vVaeC7xcSYYD8vjmibRpTQ/132","comment_is_top":false,"comment_ctime":1633744713,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1633744713","product_id":100047701,"comment_content":"è€å¸ˆè¯´çš„éƒ½ç†è§£äº†ï¼Œä½†æ˜¯çœ‹æºç è¿™ä¸ªæŠ€èƒ½æ€ä¹ˆå­¦ä¼šğŸ˜­ã€‚ç»å¸¸è‡ªå·±çœ‹ç€ç½‘ä¸Šçš„æ•™ç¨‹å¤§æ¦‚çŸ¥é“è¿™ä¸ªæ¡†æ¶çš„é…ç½®å’Œå¤§è‡´é€»è¾‘åœ¨å“ªé‡Œäº†ï¼Œ ç„¶åç‰ˆæœ¬ä¸€æ›´æ–°æºç å˜åŠ¨äº†ï¼Œå°±ä¸çŸ¥é“æ€ä¹ˆç‚¹è¿›å»äº†","like_count":0},{"had_liked":false,"id":312386,"user_name":"æ’æ˜Ÿ","can_delete":false,"product_type":"c1","uid":2715095,"ip_address":"","ucode":"C17DD00239780D","user_header":"","comment_is_top":false,"comment_ctime":1631782661,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631782661","product_id":100047701,"comment_content":"è€å¸ˆï¼Œæœ‰ä¸ªç–‘æƒ‘ï¼Œribboné»˜è®¤çš„é‡è¯•å¯¹è¶…æ—¶æ—¶é—´æ²¡æœ‰è¦æ±‚å—ï¼Œæ¡ˆä¾‹ä¸­ribboné»˜è®¤é‡è¯•äº†ä¸€æ¬¡ï¼Œè¶…æ—¶æ—¶é—´æ˜¯1sï¼Œä½†æ˜¯æœåŠ¡è°ƒç”¨è¦2sï¼Œå¦‚æœè¶…æ—¶æ—¶é—´å¯¹é‡è¯•æœ‰å½±å“ï¼Œé‚£å°±ä¸ä¼šè°ƒç”¨æˆåŠŸäº†","like_count":0},{"had_liked":false,"id":302697,"user_name":"é˜²è…åŸº","can_delete":false,"product_type":"c1","uid":2696605,"ip_address":"","ucode":"0FF3BF30631995","user_header":"https://static001.geekbang.org/account/avatar/00/29/25/9d/d612cbf8.jpg","comment_is_top":false,"comment_ctime":1626338394,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1626338394","product_id":100047701,"comment_content":"é‚£ä¸ªHTTPå®¢æˆ·ç«¯å·¥å…·è°ƒç”¨æ—¶è®¾ç½®çš„å¹¶å‘æ•°ï¼Œæœ‰ä»€ä¹ˆè®¡ç®—å…¬å¼å—ï¼Œæˆ‘æ²¡çœ‹æ˜ç™½å®é™…å·¥ä½œä¸­å¦‚ä½•è®¾ç½®çš„æ–¹æ³•ã€‚","like_count":0},{"had_liked":false,"id":300129,"user_name":"walleæ–Œ","can_delete":false,"product_type":"c1","uid":1062848,"ip_address":"","ucode":"0DB3243004951F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","comment_is_top":false,"comment_ctime":1625017817,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625017817","product_id":100047701,"comment_content":"openfeign ä¼˜åŒ–äº†ä¸å°‘ã€‚å…¶å®è¶…æ—¶æ—¶é—´å·²ç»ä¿®æ”¹ä¸ºé»˜è®¤60ç§’ï¼Œä½†æ˜¯å¡«å†™é…ç½®æœ‰ä¸€äº›ä¸å¤ªåˆç†çš„åœ°æ–¹ã€‚è€Œä¸”å»ºè®®feignè¦åŠ ä¸Š ribbon hystrix ä¸€å—ç©ã€‚ã€‚ã€‚é…ç½®ä¹Ÿæ˜¯ç±»ä¼¼ã€‚<br>å‚è€ƒå¦‚ä¸‹ï¼š<br>https:&#47;&#47;www.cnblogs.com&#47;kancy&#47;p&#47;13033021.html<br>https:&#47;&#47;www.cnblogs.com&#47;qingmuchuanqi48&#47;p&#47;13138428.html<br>","like_count":0},{"had_liked":false,"id":300018,"user_name":"Z. w","can_delete":false,"product_type":"c1","uid":2671015,"ip_address":"","ucode":"E3066ADE516B6A","user_header":"https://static001.geekbang.org/account/avatar/00/28/c1/a7/67c8530d.jpg","comment_is_top":false,"comment_ctime":1624956774,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1624956774","product_id":100047701,"comment_content":"httpclienté»˜è®¤çš„retryä¹Ÿæ˜¯å¾ˆçƒ¦äººï¼Œä¹‹å‰ç¢°åˆ°ç›¸å…³é—®é¢˜ï¼Œæ—¥å¿—æ‰¾äº†åŠå¤©æ‰å‘ç°ã€‚","like_count":0},{"had_liked":false,"id":295775,"user_name":"å¬é›¨","can_delete":false,"product_type":"c1","uid":1254493,"ip_address":"","ucode":"252754F9FCFF0C","user_header":"https://static001.geekbang.org/account/avatar/00/13/24/5d/65e61dcb.jpg","comment_is_top":false,"comment_ctime":1622597033,"is_pvip":false,"replies":[{"id":"107450","content":"å“¦ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1622717385,"ip_address":"","comment_id":295775,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1622597033","product_id":100047701,"comment_content":"å…³äºFeignè¯»å–è¶…æ—¶å¿…é¡»åŒæ—¶é…ç½®è¿æ¥è¶…æ—¶æ‰èƒ½ç”Ÿæ•ˆçš„é—®é¢˜ï¼Œè²Œä¼¼åœ¨spring-cloud-openfeign:2.2.4.RELEASEç‰ˆæœ¬ä¿®å¤äº†ï¼Œå¯¹åº”çš„springcloudç‰ˆæœ¬Hoxton.SR7","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521211,"discussion_content":"å“¦ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622717385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","nickname":"è¡Œåˆ™å°†è‡³","note":"","ucode":"DB972F2DF059C4","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":382882,"discussion_content":"äº²æµ‹ï¼Œè€å“¥è¯´çš„æ²¡é”™ï¼Œæˆ‘è¯•äº†ä¸€ä¸‹Hoxton.SR7æ˜¯å¯ä»¥çš„ï¼Œå…¶ä»–ç‰ˆæœ¬æ²¡è¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625753489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283377,"user_name":"mghio","can_delete":false,"product_type":"c1","uid":1213078,"ip_address":"","ucode":"74883EDE4FD0DC","user_header":"https://static001.geekbang.org/account/avatar/00/12/82/96/aa795685.jpg","comment_is_top":false,"comment_ctime":1615733903,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1615733903","product_id":100047701,"comment_content":"spring-cloud-starter-openfeign:3.0.1 ç‰ˆæœ¬çš„ connectTimeout å’Œ readTimeout æ˜¯åˆ†å¼€é…ç½®çš„ï¼Œå…·ä½“æºç å¯ä»¥çœ‹ FeignClientFactoryBean#configureUsingProperties æ–¹æ³•ã€‚","like_count":0},{"had_liked":false,"id":253746,"user_name":"I","can_delete":false,"product_type":"c1","uid":1028272,"ip_address":"","ucode":"6F6367210ED44A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b0/b0/9335798e.jpg","comment_is_top":false,"comment_ctime":1602851729,"is_pvip":true,"replies":[{"id":"92797","content":"æ²¡æœ‰å¤ªçœ‹æ‡‚å•¥æ„æ€","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1603076106,"ip_address":"","comment_id":253746,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1602851729","product_id":100047701,"comment_content":"æƒ³æä¸€ä¸ªribbonçš„é—®é¢˜<br>æ–‡ç« ä¸­ æœ‰ä¸ªé…ç½® SmsClient.ribbon.listOfServers=localhost:45679,localhost:45678<br>æ˜¯æŒ‡å®šæœåŠ¡è°ƒç”¨åœ°å€ï¼Œä¸è¿‡è¿™ä¸ªé…ç½®åœ¨ä½¿ç”¨eurekaåšæœåŠ¡å‘ç°çš„æ—¶å€™å°±ä¸ç”Ÿæ•ˆäº†ï¼Œæœ‰æ²¡æœ‰åŠæ³•ï¼Œåœ¨ä½¿ç”¨eurekaçš„æ—¶å€™ä¹Ÿå¯ä»¥æŒ‡å®šæœåŠ¡è°ƒç”¨åœ°å€å‘¢ï¼Œè¿™ä¸ªé—®é¢˜æœ‰ç‚¹å¥‡è‘©ï¼Œä¸è¿‡è¿˜æ˜¯æƒ³çŸ¥é“æœ‰åŠæ³•å—","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507164,"discussion_content":"æ²¡æœ‰å¤ªçœ‹æ‡‚å•¥æ„æ€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603076106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1014665,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/89/34f2cbcc.jpg","nickname":"æ¨å®‡","note":"","ucode":"EB74DF6E269F03","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377939,"discussion_content":"Ribbonæ—¢å¯ä»¥é…åˆEurekaä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥è„±ç¦»Eurekaä½¿ç”¨ã€‚\nå½“Eurekaä¸Ribbonä¸€èµ·ä½¿ç”¨æ—¶(ä¸¤è€…éƒ½å­˜åœ¨äºClassPath)ï¼ŒribbonServerListå°†è¢«DiscoveryEnabledNIWSServerListçš„æ‰©å±•è¦†ç›–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622973000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249768,"user_name":"Evan","can_delete":false,"product_type":"c1","uid":1140967,"ip_address":"","ucode":"E4C9A417653A3F","user_header":"https://static001.geekbang.org/account/avatar/00/11/68/e7/b29afd20.jpg","comment_is_top":false,"comment_ctime":1600784893,"is_pvip":false,"replies":[{"id":"91565","content":"æœ€ç®€å•çš„æ–¹å¼ä½¿ç”¨å¤šä¸ª resttemplate beanï¼Œä¸€èˆ¬ä½ çš„è¶…æ—¶ä¹Ÿå°±å‡ ç§ä¸å¯èƒ½ç²¾ç¡®åˆ°æ¯«ç§’çš„<br><br>æˆ–è€…å¯ä»¥ç›´æ¥ä½¿ç”¨ HttpClientï¼Œé€šè¿‡RequestConfigå®ç°æ¯ä¸€ä¸ªè¯·æ±‚ç‹¬ç«‹çš„è¶…æ—¶æ—¶é—´é…ç½®","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1600825687,"ip_address":"","comment_id":249768,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1600784893","product_id":100047701,"comment_content":"è¯·æ•™è€å¸ˆspring resttemplateå¦‚ä½•è®¾ç½®å•æ¬¡è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ã€‚æ¯”å¦‚ä¸åŒçš„æ¥å£éœ€è¦è®¾ç½®ä¸åŒçš„è¯»å–è¶…æ—¶æ—¶é—´ã€‚","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506009,"discussion_content":"æœ€ç®€å•çš„æ–¹å¼ä½¿ç”¨å¤šä¸ª resttemplate beanï¼Œä¸€èˆ¬ä½ çš„è¶…æ—¶ä¹Ÿå°±å‡ ç§ä¸å¯èƒ½ç²¾ç¡®åˆ°æ¯«ç§’çš„\n\næˆ–è€…å¯ä»¥ç›´æ¥ä½¿ç”¨ HttpClientï¼Œé€šè¿‡RequestConfigå®ç°æ¯ä¸€ä¸ªè¯·æ±‚ç‹¬ç«‹çš„è¶…æ—¶æ—¶é—´é…ç½®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600825687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242317,"user_name":"Geek_9d0e04","can_delete":false,"product_type":"c1","uid":1902220,"ip_address":"","ucode":"F5560CE5BDB125","user_header":"","comment_is_top":false,"comment_ctime":1597668567,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597668567","product_id":100047701,"comment_content":"Httpclientæœ€å¤§å¹¶å‘æ•°çš„é™åˆ¶ï¼Œæœ€å¤§å¹¶å‘æ•°æ˜¯æŒ‡ç­‰å¾…åº”ç­”çš„è¯·æ±‚æ•°å—ï¼Ÿå¦‚æœé‡‡ç”¨å¼‚æ­¥å‘é€çš„æ–¹å¼ï¼Œä¹Ÿæ˜¯ç»•ä¸è¿‡è¿™ä¸ªé™åˆ¶å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":240405,"user_name":"2019","can_delete":false,"product_type":"c1","uid":1025580,"ip_address":"","ucode":"6514258263FC00","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a6/2c/b73b9dfe.jpg","comment_is_top":false,"comment_ctime":1596891559,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596891559","product_id":100047701,"comment_content":"æ‰“å¡","like_count":0},{"had_liked":false,"id":233959,"user_name":"James","can_delete":false,"product_type":"c1","uid":1134861,"ip_address":"","ucode":"48B0F2A334D1C1","user_header":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","comment_is_top":false,"comment_ctime":1594535785,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1594535785","product_id":100047701,"comment_content":"ä¸ºäº†ä¸è®©redisç­‰æ— å…³ä»£ç å½±å“;<br>æˆ‘å•ç‹¬åˆ›å»ºé¡¹ç›®æ¥è·‘è¿™èŠ‚çš„ä»£ç .<br>ä¸ºå•¥Utils.loadPropertySource(FeignAndRibbonController.class, &quot;default.properties&quot;);ä¼šæŠ¥ç©ºæŒ‡é’ˆ","like_count":0},{"had_liked":false,"id":232182,"user_name":"VIC","can_delete":false,"product_type":"c1","uid":1114064,"ip_address":"","ucode":"3B3E6D344488B2","user_header":"https://static001.geekbang.org/account/avatar/00/10/ff/d0/402be1e9.jpg","comment_is_top":false,"comment_ctime":1593907898,"is_pvip":false,"replies":[{"id":"85734","content":"urlconnectioné»˜è®¤å¼€å¯keepaliveå¹¶ä¸”é€šè¿‡http.maxConnectionsæ§åˆ¶æ¯ä¸ªç›®æ ‡hostç¼“å­˜socketè¿æ¥çš„æœ€å¤§æ•°ï¼Œä¹Ÿå°±æ˜¯5ä¸ªï¼Œæˆ‘æ²¡æœ‰æµ‹è¯•è¿‡è¿™ä¸ªå‚æ•°æ˜¯å¦å°±ä¼šçœŸæ­£é™åˆ¶å¹¶å‘è¿æ¥æ•°ï¼Œè¿™ä¸ªä½ å¯ä»¥è‡ªå·±æµ‹ä¸€ä¸‹","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1593955924,"ip_address":"","comment_id":232182,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1593907898","product_id":100047701,"comment_content":"feigné»˜è®¤ç”¨çš„urlconnectionï¼Œæœ‰å¹¶å‘é™åˆ¶å—","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500549,"discussion_content":"urlconnectioné»˜è®¤å¼€å¯keepaliveå¹¶ä¸”é€šè¿‡http.maxConnectionsæ§åˆ¶æ¯ä¸ªç›®æ ‡hostç¼“å­˜socketè¿æ¥çš„æœ€å¤§æ•°ï¼Œä¹Ÿå°±æ˜¯5ä¸ªï¼Œæˆ‘æ²¡æœ‰æµ‹è¯•è¿‡è¿™ä¸ªå‚æ•°æ˜¯å¦å°±ä¼šçœŸæ­£é™åˆ¶å¹¶å‘è¿æ¥æ•°ï¼Œè¿™ä¸ªä½ å¯ä»¥è‡ªå·±æµ‹ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593955924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1542987,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","nickname":"è¡Œåˆ™å°†è‡³","note":"","ucode":"DB972F2DF059C4","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383014,"discussion_content":"æŠŠçˆ¬è™«çš„ä¾‹å­æ”¹é€ æˆFeignè°ƒç”¨ã€‚æˆ‘æµ‹è¯•äº†100å¹¶å‘è°ƒç”¨ï¼Œæ€»ç”¨æ—¶1ç§’ã€‚æ‰€ä»¥,Feignæ²¡æœ‰å•åŸŸåå¹¶å‘é™åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625822779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230331,"user_name":"æ˜Ÿå¤œ","can_delete":false,"product_type":"c1","uid":1128491,"ip_address":"","ucode":"3B46C09D994CEB","user_header":"https://static001.geekbang.org/account/avatar/00/11/38/2b/9db9406b.jpg","comment_is_top":false,"comment_ctime":1593349191,"is_pvip":false,"replies":[{"id":"85048","content":"æˆ‘çš„ç†è§£ï¼Œä¸Šæ¸¸æœåŠ¡å¯¹äºå½“å‰æœåŠ¡æ˜¯è°ƒç”¨è€…ï¼Œä¸‹æ¸¸æœåŠ¡å¯¹äºå½“å‰æœåŠ¡æ˜¯è¢«è°ƒç”¨è€…","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1593397033,"ip_address":"","comment_id":230331,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1593349191","product_id":100047701,"comment_content":"è€å¸ˆæ˜¯æ€ä¹ˆç†è§£ä¸Šä¸‹æ¸¸æœåŠ¡çš„ï¼Œæˆ‘ä¸€èˆ¬å°†è¢«è°ƒç”¨æ–¹ç§°ä¸ºä¸Šæ¸¸æœåŠ¡ï¼ŒæŸ¥èµ„æ–™ä¸€èˆ¬è¯´ä¸¤ç§å«æ³•éƒ½æ˜¯æ­£ç¡®çš„ï¼Œç†è§£æ–¹å¼ä¸åŒã€‚","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499842,"discussion_content":"æˆ‘çš„ç†è§£ï¼Œä¸Šæ¸¸æœåŠ¡å¯¹äºå½“å‰æœåŠ¡æ˜¯è°ƒç”¨è€…ï¼Œä¸‹æ¸¸æœåŠ¡å¯¹äºå½“å‰æœåŠ¡æ˜¯è¢«è°ƒç”¨è€…","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593397033,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1012843,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/74/6b/a98162a1.jpg","nickname":"winner_0715","note":"","ucode":"A033A30539181F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291030,"discussion_content":"æä¾›æœåŠ¡çš„å«ä¸Šæ¸¸","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594687249,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":225504,"user_name":"hwnly","can_delete":false,"product_type":"c1","uid":1890341,"ip_address":"","ucode":"BBD94DF2B6BCE5","user_header":"","comment_is_top":false,"comment_ctime":1591772246,"is_pvip":false,"replies":[{"id":"83057","content":"è¦çœ‹RibbonClientConfigurationç±»","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1591782654,"ip_address":"","comment_id":225504,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591772246","product_id":100047701,"comment_content":"\tæˆ‘çœ‹äº†ä¸‹æˆ‘ä»¬è¿™è¾¹çš„é¡¹ç›®æºç spring-cloud-netflix-core-1.3.5.RELEASE  jarç‰ˆæœ¬æ˜¯è¿™æ ·å†™çš„<br>        @Bean<br>\t@ConditionalOnMissingBean<br>\tpublic IClientConfig ribbonClientConfig() {<br>\t\tDefaultClientConfigImpl config = new DefaultClientConfigImpl();<br>\t\tconfig.loadProperties(this.name);<br>\t\treturn config;<br>\t}<br><br>DefaultClientConfigImplä¸­è®¾ç½®çš„<br>public static final int DEFAULT_CONNECT_TIMEOUT = 2000;<br>public static final int DEFAULT_READ_TIMEOUT = 5000;<br>ä¸çŸ¥é“ä½œè€…ç”¨çš„ä»€ä¹ˆç‰ˆæœ¬å‘¢","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497871,"discussion_content":"è¦çœ‹RibbonClientConfigurationç±»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591782654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":203310,"user_name":"just code it","can_delete":false,"product_type":"c1","uid":1140836,"ip_address":"","ucode":"9953DAD398F33D","user_header":"https://static001.geekbang.org/account/avatar/00/11/68/64/756ba667.jpg","comment_is_top":false,"comment_ctime":1586169493,"is_pvip":false,"replies":[{"id":"75964","content":"ä¸ºäº†é˜²æ­¢å‚æ•°åœ¨æ–¹æ³•å†…é‡æ–°èµ‹å€¼ï¼Œæˆ–è€…è¯´ä¸å°å¿ƒè¢«é‡æ–°èµ‹å€¼ï¼Œæ¯”å¦‚æ²¡æœ‰åŠ finalçš„æ—¶å€™å¸Œæœ›ç»™å­—æ®µèµ‹å€¼å¯èƒ½è¯¯æ”¹äº†å‚æ•°æ²¡å‘ç°ï¼ŒåŠ äº†finalåé‡æ–°èµ‹å€¼ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼Œé‚£ä¹ˆå°±æé†’æˆ‘ä»¬åº”è¯¥åŠ ä¸Šthisã€‚ã€‚ã€‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1586179516,"ip_address":"","comment_id":203310,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1586169493","product_id":100047701,"comment_content":"è€å¸ˆæˆ‘æœ‰ç‚¹ç–‘æƒ‘ï¼Œä¸ºä½•å¾ˆå¤šjdkæºç ,æ¯”å¦‚httpclienté‡Œè¾¹çš„æ–¹æ³•å‚æ•°ä¸ºå•¥å¤§å¤šæ•°éƒ½è¦å£°æ˜ä¸ºfinal ï¼Ÿè¿™æ ·åšåˆä»€ä¹ˆå¥½å¤„å—ï¼Ÿ<br> private E getPoolEntryBlocking(  <br>            final T route, final Object state,<br>            final long timeout, final TimeUnit tunit,<br>            final Future&lt;E&gt; future) throws IOException, InterruptedException, TimeoutException {.....}<br>ä»è¿æ¥æ± ä¸­å–è¿æ¥","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490827,"discussion_content":"ä¸ºäº†é˜²æ­¢å‚æ•°åœ¨æ–¹æ³•å†…é‡æ–°èµ‹å€¼ï¼Œæˆ–è€…è¯´ä¸å°å¿ƒè¢«é‡æ–°èµ‹å€¼ï¼Œæ¯”å¦‚æ²¡æœ‰åŠ finalçš„æ—¶å€™å¸Œæœ›ç»™å­—æ®µèµ‹å€¼å¯èƒ½è¯¯æ”¹äº†å‚æ•°æ²¡å‘ç°ï¼ŒåŠ äº†finalåé‡æ–°èµ‹å€¼ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼Œé‚£ä¹ˆå°±æé†’æˆ‘ä»¬åº”è¯¥åŠ ä¸Šthisã€‚ã€‚ã€‚ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586179516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1140836,"avatar":"https://static001.geekbang.org/account/avatar/00/11/68/64/756ba667.jpg","nickname":"just code it","note":"","ucode":"9953DAD398F33D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":223354,"discussion_content":"æˆ‘ä¹‹å‰ä¹Ÿæ˜¯è¿™ä¹ˆç†è§£çš„ï¼Œå°±æ˜¯ä¸å¤ªç¡®å®šï¼Œè°¢è°¢å“ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586218895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198640,"user_name":"å¤§å¯","can_delete":false,"product_type":"c1","uid":1020927,"ip_address":"","ucode":"D0D7F9D670FF07","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/ff/42432276.jpg","comment_is_top":false,"comment_ctime":1585461287,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585461287","product_id":100047701,"comment_content":"å¥½æ–‡ç«  æ­£å¥½æœ€è¿‘å…¥å‘äº†","like_count":0},{"had_liked":false,"id":196295,"user_name":"hellojd","can_delete":false,"product_type":"c1","uid":1341697,"ip_address":"","ucode":"4E51807AE7E472","user_header":"https://static001.geekbang.org/account/avatar/00/14/79/01/e71510dc.jpg","comment_is_top":false,"comment_ctime":1585270542,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585270542","product_id":100047701,"comment_content":"è¿™èŠ‚è¯¾ï¼Œå¾—å¤šè¯»å‡ éã€‚å°¤å…¶ä½¿ç”¨spring  cloudæŠ€æœ¯æ ˆçš„åŒå­¦ã€‚è€å¸ˆæ€»ç»“çš„å‡ ç‚¹éƒ½å¾ˆå®åœ¨ï¼Œç”±äºéƒ½ç”±äºspringboot é»˜è®¤é…ç½®çš„å…³ç³»ï¼Œä¸è¿½æ±‚ç»†èŠ‚ï¼Œå®¹æ˜“è¸©å‘","like_count":0},{"had_liked":false,"id":196001,"user_name":"æ¢“åŸ","can_delete":false,"product_type":"c1","uid":1632679,"ip_address":"","ucode":"0838935461FD57","user_header":"https://static001.geekbang.org/account/avatar/00/18/e9/a7/c1a26a36.jpg","comment_is_top":false,"comment_ctime":1585229224,"is_pvip":false,"replies":[{"id":"74356","content":"è¿æ¥æ± ï¼Ÿå…·ä½“æ˜¯æŒ‡ä»€ä¹ˆè¿æ¥æ± ï¼Œä¹‹å‰æœ‰ä¸€ç¯‡æ–‡ç« ä¸æ˜¯ä»‹ç»äº†è¿æ¥æ± å—ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585232437,"ip_address":"","comment_id":196001,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1585229224","product_id":100047701,"comment_content":"è€å¸ˆèƒ½ä¸èƒ½é¡ºä¾¿è®²è®²è¿æ¥æ± ï¼Œæˆ‘é¡¹ç›®å°±è¦ç”¨åˆ°äº†ï¼Œæºç é‡Œä¿®æ”¹å‚æ•°åï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ç”¨å—ï¼Ÿ    <br><br>private static CloseableHttpClient httpClient = null;<br><br>    static {<br>        httpClient = HttpClients.custom().setMaxConnPerRoute(1).setMaxConnTotal(1).evictIdleConnections(60, TimeUnit.SECONDS).build();<br><br>        Runtime.getRuntime().addShutdownHook(new Thread(() -&gt; {<br>            try {<br>                httpClient.close();<br>            } catch (IOException ignored) {<br>            }<br>        }));<br>    }","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489197,"discussion_content":"è¿æ¥æ± ï¼Ÿå…·ä½“æ˜¯æŒ‡ä»€ä¹ˆè¿æ¥æ± ï¼Œä¹‹å‰æœ‰ä¸€ç¯‡æ–‡ç« ä¸æ˜¯ä»‹ç»äº†è¿æ¥æ± å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585232437,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":236760,"discussion_content":"ä¸èƒ½ éœ€è¦æ ¹æ®éœ€æ±‚è°ƒæ•´å¹¶å‘é™åˆ¶","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1587121389,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1632679,"avatar":"https://static001.geekbang.org/account/avatar/00/18/e9/a7/c1a26a36.jpg","nickname":"æ¢“åŸ","note":"","ucode":"0838935461FD57","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":215459,"discussion_content":"æˆ‘è¯´çš„æ˜¯httpè¿æ¥æ± ï¼Œå¯ä»¥æ‹·è´è¿™æ®µä»£ç ç›´æ¥ç”¨å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585323752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195682,"user_name":"é›…ç„¶é£æ‡¿","can_delete":false,"product_type":"c1","uid":1007242,"ip_address":"","ucode":"32ED4550305D0F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/8a/0c1f9635.jpg","comment_is_top":false,"comment_ctime":1585211727,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585211727","product_id":100047701,"comment_content":"å¥½æ–‡ç« ï¼Œåˆå¤šè¸©äº†å‡ ä¸ªå‘","like_count":0},{"had_liked":false,"id":192377,"user_name":"å¤§æ©˜ä¸ºé‡","can_delete":false,"product_type":"c1","uid":1106152,"ip_address":"","ucode":"96479F205B8384","user_header":"https://static001.geekbang.org/account/avatar/00/10/e0/e8/66439469.jpg","comment_is_top":false,"comment_ctime":1584848119,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1584848119","product_id":100047701,"comment_content":"å­¦ä¹ æ‰“å¡~","like_count":0},{"had_liked":false,"id":192029,"user_name":"Geek_3b1096","can_delete":false,"product_type":"c1","uid":1549364,"ip_address":"","ucode":"A6BD92B79B3632","user_header":"","comment_is_top":false,"comment_ctime":1584818475,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584818475","product_id":100047701,"comment_content":"ä¹‹å‰æ²¡æœ‰è€ƒè™‘åˆ°è¶…æ—¶é‡è¯•å¹¶å‘è°¢è°¢è€å¸ˆ","like_count":0},{"had_liked":false,"id":190245,"user_name":"Husiun","can_delete":false,"product_type":"c1","uid":1448664,"ip_address":"","ucode":"F783484743BFE4","user_header":"https://static001.geekbang.org/account/avatar/00/16/1a/d8/9ae1bdb9.jpg","comment_is_top":false,"comment_ctime":1584621932,"is_pvip":false,"replies":[{"id":"73184","content":"æ²¡çœ‹æ˜ç™½é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1584624606,"ip_address":"","comment_id":190245,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1584621932","product_id":100047701,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œåœ¨spring cloudå¾®æœåŠ¡Aè°ƒç”¨å¾®æœåŠ¡Bçš„è¿‡ç¨‹ï¼Œå¾®æœåŠ¡Açš„è¶…æ—¶timeoutA å’Œå¾®æœåŠ¡Bçš„è¶…æ—¶timeoutBä¸¤è€…æ•°å€¼å¤§å°äº§ç”Ÿçš„å·®å¼‚ï¼Œ","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487926,"discussion_content":"æ²¡çœ‹æ˜ç™½é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584624606,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190220,"user_name":"æ¨æ¨æ¨æ¨ã€","can_delete":false,"product_type":"c1","uid":1461885,"ip_address":"","ucode":"A736A9BB3FD506","user_header":"https://static001.geekbang.org/account/avatar/00/16/4e/7d/b34f5251.jpg","comment_is_top":false,"comment_ctime":1584617888,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1584617888","product_id":100047701,"comment_content":"ReadTimeout æ˜¯ä¸æ˜¯å¯ä»¥ç¿»è¯‘æˆè¯·æ±‚è¶…æ—¶ã€‚å†™å…¥æ“ä½œæœåŠ¡å™¨ä¹Ÿæ˜¯ä¼šæœ‰ä¸ªåé¦ˆçš„ï¼Œå®¢æˆ·ç«¯ä¹Ÿè¯»å–è¿™ä¸ªåé¦ˆ","like_count":0,"discussions":[{"author":{"id":1341697,"avatar":"https://static001.geekbang.org/account/avatar/00/14/79/01/e71510dc.jpg","nickname":"hellojd","note":"","ucode":"4E51807AE7E472","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214987,"discussion_content":"ä¸å¯ä»¥ã€‚readtimeout æ˜¯ä»tcpä¸‰æ¬¡æ¡æ‰‹æˆåŠŸåï¼Œå®¢æˆ·ç«¯ç­‰å¾…æ¥å—æ•°æ®åŒ…çš„æ—¶é—´ã€‚è¿‡äº†è¿™ä¸ªæ—¶é—´ï¼Œæ•°æ®åŒ…å³ä½¿åˆ°äº†ï¼Œä¹Ÿè¢«ä¸¢å¼ƒäº†ã€‚å°¤å…¶æ˜¯æŠ¥æ–‡æ¯”è¾ƒå¤§çš„æ—¶å€™è¿™ä¸ªå‚æ•°æœ‰ç”¨äº†ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1585270780,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":189975,"user_name":"mgs2002","can_delete":false,"product_type":"c1","uid":1812970,"ip_address":"","ucode":"F5931108BD509B","user_header":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","comment_is_top":false,"comment_ctime":1584587606,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584587606","product_id":100047701,"comment_content":"æŸ¥è¯¢äº†ä¸€ä¸‹èµ„æ–™,nginxè¶…æ—¶é‡è¯•è¯­æ³•æ˜¯è¿™æ ·çš„ï¼š<br>proxy_next_upstream http_500 error timeout invalid_header;<br>æ„æ€å‘èµ·è¯·æ±‚åˆ°æœåŠ¡ç«¯åå¦‚æœå‡ºè¯»å–åº”ç­”é”™è¯¯(error),500é”™è¯¯(http_500),è¶…æ—¶(timeout),è¿”å›ç©ºçš„æˆ–è€…é”™è¯¯çš„åº”ç­”ï¼ˆinvalid_headerï¼‰è¿™å‡ ç§æƒ…å†µä¸‹nginxä¼šæŠŠè¯·æ±‚è½¬å‘åˆ°ä¸‹ä¸€å°æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥å…³é—­é‡è¯•æœºåˆ¶ï¼Œ<br>ä½¿ç”¨çš„è¯è¿˜æ˜¯è¦å°å¿ƒç‚¹æ³¨æ„æ¥å£çš„å¹‚ç­‰æ€§","like_count":0}]}