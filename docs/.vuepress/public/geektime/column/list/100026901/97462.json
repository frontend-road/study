{"id":97462,"title":"08 | 异常处理：如何提高程序的稳定性？","content":"<p>你好，我是景霄。</p><p>今天这节课，我想和你聊聊Python的异常处理。和其他语言一样，异常处理是Python中一种很常见，并且很重要的机制与代码规范。</p><p>我在实际工作中，见过很多次这样的情况：一位工程师提交了代码，不过代码某处忘记了异常处理。碰巧这种异常发生的频率不低，所以在代码push到线上后没多久，就会收到紧急通知——服务器崩溃了。</p><p>如果事情严重，对用户的影响也很大，这位工程师还得去专门的会议上做自我检讨，可以说是很惨了。这类事件层出不穷，也告诉我们，正确理解和处理程序中的异常尤为关键。</p><h2><strong>错误与异常</strong></h2><p>首先要了解，Python中的错误和异常是什么？两者之间又有什么联系和区别呢？</p><p>通常来说，程序中的错误至少包括两种，一种是语法错误，另一种则是异常。</p><p>所谓语法错误，你应该很清楚，也就是你写的代码不符合编程规范，无法被识别与执行，比如下面这个例子：</p><pre><code>if name is not None\n    print(name)\n</code></pre><p>If语句漏掉了冒号，不符合Python的语法规范，所以程序就会报错<code>invalid syntax</code>。</p><p>而异常则是指程序的语法正确，也可以被执行，但在执行过程中遇到了错误，抛出了异常，比如下面的3个例子：</p><pre><code>10 / 0\nTraceback (most recent call last):\n  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;\nZeroDivisionError: integer division or modulo by zero\n\norder * 2\nTraceback (most recent call last):\n  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;\nNameError: name 'order' is not defined\n\n1 + [1, 2]\nTraceback (most recent call last):\n  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;\nTypeError: unsupported operand type(s) for +: 'int' and 'list'\n</code></pre><p>它们语法完全正确，但显然，我们不能做除法时让分母为0；也不能使用未定义的变量做运算；而让一个整型和一个列表相加也是不可取的。</p><!-- [[[read_end]]] --><p>于是，当程序运行到这些地方时，就抛出了异常，并且终止运行。例子中的<code>ZeroDivisionError</code> <code>NameError</code>和<code>TypeError</code>，就是三种常见的异常类型。</p><p>当然，Python中还有很多其他异常类型，比如<code>KeyError</code>是指字典中的键找不到；<code>FileNotFoundError</code>是指发送了读取文件的请求，但相应的文件不存在等等，我在此不一一赘述，你可以自行参考<a href=\"https://docs.python.org/3/library/exceptions.html#bltin-exceptions\">相应文档</a>。</p><h2><strong>如何处理异常</strong></h2><p>刚刚讲到，如果执行到程序中某处抛出了异常，程序就会被终止并退出。你可能会问，那有没有什么办法可以不终止程序，让其照样运行下去呢？答案当然是肯定的，这也就是我们所说的异常处理，通常使用try和except来解决，比如：</p><pre><code>try:\n    s = input('please enter two numbers separated by comma: ')\n    num1 = int(s.split(',')[0].strip())\n    num2 = int(s.split(',')[1].strip())\n    ... \nexcept ValueError as err:\n    print('Value Error: {}'.format(err))\n\nprint('continue')\n...\n</code></pre><p>这里默认用户输入以逗号相隔的两个整形数字，将其提取后，做后续的操作（注意input函数会将输入转换为字符串类型）。如果我们输入<code>a,b</code>，程序便会抛出异常<code>invalid literal for int() with base 10: 'a'</code>，然后跳出try这个block。</p><p>由于程序抛出的异常类型是ValueError，和except block所catch的异常类型相匹配，所以except block便会被执行，最终输出<code>Value Error: invalid literal for int() with base 10: 'a'</code>，并打印出<code>continue</code>。</p><pre><code>please enter two numbers separated by comma: a,b\nValue Error: invalid literal for int() with base 10: 'a'\ncontinue\n</code></pre><p>我们知道，except block只接受与它相匹配的异常类型并执行，如果程序抛出的异常并不匹配，那么程序照样会终止并退出。</p><p>所以，还是刚刚这个例子，如果我们只输入<code>1</code>，程序抛出的异常就是<code>IndexError: list index out of range</code>，与ValueError不匹配，那么except block就不会被执行，程序便会终止并退出（continue不会被打印）。</p><pre><code>please enter two numbers separated by comma: 1\nIndexError Traceback (most recent call last)\nIndexError: list index out of range\n</code></pre><p>不过，很显然，这样强调一种类型的写法有很大的局限性。那么，该怎么解决这个问题呢？</p><p>其中一种解决方案，是在except block中加入多种异常的类型，比如下面这样的写法：</p><pre><code>try:\n    s = input('please enter two numbers separated by comma: ')\n    num1 = int(s.split(',')[0].strip())\n    num2 = int(s.split(',')[1].strip())\n    ...\nexcept (ValueError, IndexError) as err:\n    print('Error: {}'.format(err))\n    \nprint('continue')\n...\n</code></pre><p>或者第二种写法：</p><pre><code>try:\n    s = input('please enter two numbers separated by comma: ')\n    num1 = int(s.split(',')[0].strip())\n    num2 = int(s.split(',')[1].strip())\n    ...\nexcept ValueError as err:\n    print('Value Error: {}'.format(err))\nexcept IndexError as err:\n    print('Index Error: {}'.format(err))\n\nprint('continue')\n...\n</code></pre><p>这样，每次程序执行时，except block中只要有一个exception类型与实际匹配即可。</p><p>不过，很多时候，我们很难保证程序覆盖所有的异常类型，所以，更通常的做法，是在最后一个except block，声明其处理的异常类型是Exception。Exception是其他所有非系统异常的基类，能够匹配任意非系统异常。那么这段代码就可以写成下面这样：</p><pre><code>try:\n    s = input('please enter two numbers separated by comma: ')\n    num1 = int(s.split(',')[0].strip())\n    num2 = int(s.split(',')[1].strip())\n    ...\nexcept ValueError as err:\n    print('Value Error: {}'.format(err))\nexcept IndexError as err:\n    print('Index Error: {}'.format(err))\nexcept Exception as err:\n    print('Other error: {}'.format(err))\n\nprint('continue')\n...\n</code></pre><p>或者，你也可以在except后面省略异常类型，这表示与任意异常相匹配（包括系统异常等）：</p><pre><code>try:\n    s = input('please enter two numbers separated by comma: ')\n    num1 = int(s.split(',')[0].strip())\n    num2 = int(s.split(',')[1].strip())\n    ...\nexcept ValueError as err:\n    print('Value Error: {}'.format(err))\nexcept IndexError as err:\n    print('Index Error: {}'.format(err))\nexcept:\n    print('Other error')\n\nprint('continue')\n...\n</code></pre><p>需要注意，当程序中存在多个except block时，最多只有一个except block会被执行。换句话说，如果多个except声明的异常类型都与实际相匹配，那么只有最前面的except block会被执行，其他则被忽略。</p><p>异常处理中，还有一个很常见的用法是finally，经常和try、except放在一起来用。无论发生什么情况，finally block中的语句都会被执行，哪怕前面的try和excep block中使用了return语句。</p><p>一个常见的应用场景，便是文件的读取：</p><pre><code>import sys\ntry:\n    f = open('file.txt', 'r')\n    .... # some data processing\nexcept OSError as err:\n    print('OS error: {}'.format(err))\nexcept:\n    print('Unexpected error:', sys.exc_info()[0])\nfinally:\n    f.close()\n</code></pre><p>这段代码中，try block尝试读取file.txt这个文件，并对其中的数据进行一系列的处理，到最后，无论是读取成功还是读取失败，程序都会执行finally中的语句——关闭这个文件流，确保文件的完整性。因此，在finally中，我们通常会放一些<strong>无论如何都要执行</strong>的语句。</p><p>值得一提的是，对于文件的读取，我们也常常使用with open，你也许在前面的例子中已经看到过，with open会在最后自动关闭文件，让语句更加简洁。</p><h2><strong>用户自定义异常</strong></h2><p>前面的例子里充斥了很多Python内置的异常类型，你可能会问，我可以创建自己的异常类型吗？</p><p>答案是肯定是，Python当然允许我们这么做。下面这个例子，我们创建了自定义的异常类型MyInputError，定义并实现了初始化函数和str函数（直接print时调用）：</p><pre><code>class MyInputError(Exception):\n    &quot;&quot;&quot;Exception raised when there're errors in input&quot;&quot;&quot;\n    def __init__(self, value): # 自定义异常类型的初始化\n        self.value = value\n    def __str__(self): # 自定义异常类型的string表达形式\n        return (&quot;{} is invalid input&quot;.format(repr(self.value)))\n    \ntry:\n    raise MyInputError(1) # 抛出MyInputError这个异常\nexcept MyInputError as err:\n    print('error: {}'.format(err))\n</code></pre><p>如果你执行上述代码块并输出，便会得到下面的结果：</p><pre><code>error: 1 is invalid input\n</code></pre><p>实际工作中，如果内置的异常类型无法满足我们的需求，或者为了让异常更加详细、可读，想增加一些异常类型的其他功能，我们可以自定义所需异常类型。不过，大多数情况下，Python内置的异常类型就足够好了。</p><h2><strong>异常的使用场景与注意点</strong></h2><p>学完了前面的基础知识，接下来我们着重谈一下，异常的使用场景与注意点。</p><p>通常来说，在程序中，如果我们不确定某段代码能否成功执行，往往这个地方就需要使用异常处理。除了上述文件读取的例子，我可以再举一个例子来说明。</p><p>大型社交网站的后台，需要针对用户发送的请求返回相应记录。用户记录往往储存在key-value结构的数据库中，每次有请求过来后，我们拿到用户的ID，并用ID查询数据库中此人的记录，就能返回相应的结果。</p><p>而数据库返回的原始数据，往往是json string的形式，这就需要我们首先对json string进行decode（解码），你可能很容易想到下面的方法：</p><pre><code>import json\nraw_data = queryDB(uid) # 根据用户的id，返回相应的信息\ndata = json.loads(raw_data)\n</code></pre><p>这样的代码是不是就足够了呢？</p><p>要知道，在json.loads()函数中，输入的字符串如果不符合其规范，那么便无法解码，就会抛出异常，因此加上异常处理十分必要。</p><pre><code>try:\n    data = json.loads(raw_data)\n    ....\nexcept JSONDecodeError as err:\n    print('JSONDecodeError: {}'.format(err))\n</code></pre><p>不过，有一点切记，我们不能走向另一个极端——滥用异常处理。</p><p>比如，当你想要查找字典中某个键对应的值时，绝不能写成下面这种形式：</p><pre><code>d = {'name': 'jason', 'age': 20}\ntry:\n    value = d['dob']\n    ...\nexcept KeyError as err:\n    print('KeyError: {}'.format(err))\n</code></pre><p>诚然，这样的代码并没有bug，但是让人看了摸不着头脑，也显得很冗余。如果你的代码中充斥着这种写法，无疑对阅读、协作来说都是障碍。因此，对于flow-control（流程控制）的代码逻辑，我们一般不用异常处理。</p><p>字典这个例子，写成下面这样就很好。</p><pre><code>if 'dob' in d:\n    value = d['dob']\n    ...\n</code></pre><h2><strong>总结</strong></h2><p>这节课， 我们一起学习了Python的异常处理及其使用场景，你需要重点掌握下面几点。</p><ul>\n<li>\n<p>异常，通常是指程序运行的过程中遇到了错误，终止并退出。我们通常使用try except语句去处理异常，这样程序就不会被终止，仍能继续执行。</p>\n</li>\n<li>\n<p>处理异常时，如果有必须执行的语句，比如文件打开后必须关闭等等，则可以放在finally  block中。</p>\n</li>\n<li>\n<p>异常处理，通常用在你不确定某段代码能否成功执行，也无法轻易判断的情况下，比如数据库的连接、读取等等。正常的flow-control逻辑，不要使用异常处理，直接用条件语句解决就可以了。</p>\n</li>\n</ul><h2><strong>思考题</strong></h2><p>最后，给你留一个思考题。在异常处理时，如果try block中有多处抛出异常，需要我们使用多个try except block吗？以数据库的连接、读取为例，下面两种写法，你觉得哪种更好呢？</p><p>第一种：</p><pre><code>try:\n    db = DB.connect('&lt;db path&gt;') # 可能会抛出异常\n    raw_data = DB.queryData('&lt;viewer_id&gt;') # 可能会抛出异常\nexcept (DBConnectionError, DBQueryDataError) err:\n    print('Error: {}'.format(err))\n</code></pre><p>第二种：</p><pre><code>try:\n    db = DB.connect('&lt;db path&gt;') # 可能会抛出异常\n    try:\n        raw_data = DB.queryData('&lt;viewer_id&gt;')\n    except DBQueryDataError as err:\n         print('DB query data error: {}'.format(err))\nexcept DBConnectionError as err:\n     print('DB connection error: {}'.format(err))\n</code></pre><p>欢迎在留言区写下你的答案，还有你今天学习的心得和疑惑，也欢迎你把这篇文章分享给你的同事、朋友。</p><p></p>","comments":[{"had_liked":false,"id":98186,"user_name":"不瘦到140不改名","can_delete":false,"product_type":"c1","uid":1528298,"ip_address":"","ucode":"31DA063A17FC27","user_header":"https://static001.geekbang.org/account/avatar/00/17/51/ea/2ce84d5a.jpg","comment_is_top":false,"comment_ctime":1558927363,"is_pvip":false,"replies":[{"id":"35166","content":"你可以阅读官方文档：https:&#47;&#47;docs.python.org&#47;3&#47;reference&#47;compound_stmts.html#the-try-statement<br><br>&quot;When an exception has been assigned using as target, it is cleared at the end of the except clause.&quot;<br><br>比如下面这个code block：<br>except E as N:<br>    foo<br><br>就等于<br>except E as N:<br>    try:<br>        foo<br>    finally:<br>        del N<br><br>因此你例子中的e最后被delete了，所以会抛出NameError<br>","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1558944440,"ip_address":"","comment_id":98186,"utype":1}],"discussion_count":6,"race_medal":0,"score":"641509054467","product_id":100026901,"comment_content":"老师，看到异常这一讲，忽然想起了一个问题，一直困扰着我<br>e = 1<br>try:<br>    1 &#47; 0<br>except ZeroDivisionError as e:<br>    pass<br><br>print(e)  # NameError: name &#39;e&#39; is not defined<br>这里为什么会显示e没有被定义呢？","like_count":150,"discussions":[{"author":{"id":1148368,"avatar":"https://static001.geekbang.org/account/avatar/00/11/85/d0/8adf3b26.jpg","nickname":"Yang","note":"","ucode":"E4B3FB8B4581D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":18665,"discussion_content":"1. 如果没有异常发生， try中有return 语句， 这个时候else块中的代码是没有办法执行到的， 但是finally语句中如果有return 语句会修改最终的返回值， 我个人理解的是try中return 语句先将要返回的值放在某个 CPU寄存器，然后运行finally语句的时候修改了这个寄存器的值，最后在返回到try中的return语句返回修改后的值。\n\n2. 如果没有异常发生， try中没有return语句，那么else块的代码是执行的，但是如果else中有return， 那么也要先执行finally的代码， 返回值的修改与上面一条一致。\n\n3. 如果有异常发生，try中的return语句肯定是执行不到， 在捕获异常的 except语句中，如果存在return语句，那么也要先执行finally的代码，finally里面的代码会修改最终的返回值，然后在从 except 块的retrun 语句返回最终修改的返回值， 和第一条一致。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1569076415,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451593,"discussion_content":"你可以阅读官方文档：https://docs.python.org/3/reference/compound_stmts.html#the-try-statement\n\n&amp;quot;When an exception has been assigned using as target, it is cleared at the end of the except clause.&amp;quot;\n\n比如下面这个code block：\nexcept E as N:\n    foo\n\n就等于\nexcept E as N:\n    try:\n        foo\n    finally:\n        del N\n\n因此你例子中的e最后被delete了，所以会抛出NameError\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1558944440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1191529,"avatar":"","nickname":"karofsky","note":"","ucode":"4AFBEDE22F9652","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":329707,"discussion_content":"3.8测试是会报错的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1606448417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1527044,"avatar":"https://static001.geekbang.org/account/avatar/00/17/4d/04/eca1a8f3.jpg","nickname":"hhhhhhhhh","note":"","ucode":"EFDB27C12380E5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4039,"discussion_content":"print(e)没有缩进\n\nf = 1\ntry:\n    1/0\nexcept ZeroDivisionError as f:\n    pass\n    print(f)","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565075640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1122308,"avatar":"https://static001.geekbang.org/account/avatar/00/11/20/04/72cc2057.jpg","nickname":"Sunny","note":"","ucode":"90CA0ABBB683FA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2181,"discussion_content":"3.5版本测试也没有报错 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563332373,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1581705,"avatar":"https://static001.geekbang.org/account/avatar/00/18/22/89/73397ccb.jpg","nickname":"响雨","note":"","ucode":"C5FB3A3BC68F92","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383,"discussion_content":"python2.7好像没有删除e\ne = 1\ntry:\n    1/0\nexcept Exception as e:\n    pass\n\nprint e\n\ninteger division or modulo by zero","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561518047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98130,"user_name":"Hoo-Ah","can_delete":false,"product_type":"c1","uid":1306913,"ip_address":"","ucode":"823093A6C7DEE7","user_header":"https://static001.geekbang.org/account/avatar/00/13/f1/21/52e8267b.jpg","comment_is_top":false,"comment_ctime":1558918752,"is_pvip":false,"replies":[{"id":"35100","content":"正解","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1558921161,"ip_address":"","comment_id":98130,"utype":1}],"discussion_count":2,"race_medal":0,"score":"366631138912","product_id":100026901,"comment_content":"第一种写法更加简洁，易于阅读。而且except后面的错误类型先抛出数据库连接错误，之后才抛出查询错误，实现的异常处理和第二种一样。","like_count":86,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451571,"discussion_content":"正解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558921161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1590953,"avatar":"https://static001.geekbang.org/account/avatar/00/18/46/a9/70fa676f.jpg","nickname":"Luke","note":"","ucode":"2C8A1FAB8B6301","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321967,"discussion_content":"不能同意，这是因为你这两处抛出的异常是不同的，如果两处抛出的异常是同一类，方法2显然可以让异常点更明确","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1604655917,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98347,"user_name":"Geek_b6f316","can_delete":false,"product_type":"c1","uid":1541334,"ip_address":"","ucode":"FC429A301139C1","user_header":"","comment_is_top":false,"comment_ctime":1558964736,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"147587852800","product_id":100026901,"comment_content":"第一种方法简单明了，是不是少了一个as","like_count":35,"discussions":[{"author":{"id":1009002,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/65/6a/be36c108.jpg","nickname":"ikel","note":"","ucode":"1D5CE7803C1C2B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":316769,"discussion_content":"第一种应该是少as","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603452462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98385,"user_name":"Fergus","can_delete":false,"product_type":"c1","uid":1277066,"ip_address":"","ucode":"3A8AC741C49CEB","user_header":"https://static001.geekbang.org/account/avatar/00/13/7c/8a/bdeb76ac.jpg","comment_is_top":false,"comment_ctime":1558973869,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"91753287085","product_id":100026901,"comment_content":"选择1，原因有2：<br>1. 从开始学就如①这么写的；<br>2. ②读起来太难受，太不pythonic；<br><br>读了留言后意识到：<br>3. ①与②的运行逻辑一致，①可以看作②的简化版；<br>4. ②的写法，如出现异常，多次调用异常处理，降低程序运行效率；<br><br>多谢小伙伴们👍","like_count":22},{"had_liked":false,"id":98135,"user_name":"liput","can_delete":false,"product_type":"c1","uid":1057683,"ip_address":"","ucode":"CCCF7D7D17C870","user_header":"https://static001.geekbang.org/account/avatar/00/10/23/93/d6cd8897.jpg","comment_is_top":false,"comment_ctime":1558919184,"is_pvip":false,"replies":[{"id":"35099","content":"我会在最后一章里对大公司开发的规范，流程做一个详细的介绍。通常来说，异常能用内置的exception就用，如果需要自定义就自定义，看实际的需求。一般来说异常抛出，我们都会对其进行Log（一般每1000次log一次），输出到real time的table和dashboard里，这样有利于之后的分析和改进。","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1558921122,"ip_address":"","comment_id":98135,"utype":1}],"discussion_count":3,"race_medal":0,"score":"61688461328","product_id":100026901,"comment_content":"想请问老师，在facebook里面开发，对于异常处理有什么规范需要遵循吗？自定义异常、抛异常、捕获异常，粒度一般怎么把控呢？<br>与此相应的，我对日志输出也有同样的疑问，希望老师能结合您在大公司里的实战经验多讲讲。","like_count":15,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451574,"discussion_content":"我会在最后一章里对大公司开发的规范，流程做一个详细的介绍。通常来说，异常能用内置的exception就用，如果需要自定义就自定义，看实际的需求。一般来说异常抛出，我们都会对其进行Log（一般每1000次log一次），输出到real time的table和dashboard里，这样有利于之后的分析和改进。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558921122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1659261,"avatar":"https://static001.geekbang.org/account/avatar/00/19/51/7d/2772ec9a.jpg","nickname":"风过留痕","note":"","ucode":"F13405AD8511B1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":15755,"discussion_content":"怎么实现1000次记录一次那？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568849161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1593681,"avatar":"https://static001.geekbang.org/account/avatar/00/18/51/51/381876ab.jpg","nickname":"文康","note":"","ucode":"E1952B9DFB5DF4","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1659261,"avatar":"https://static001.geekbang.org/account/avatar/00/19/51/7d/2772ec9a.jpg","nickname":"风过留痕","note":"","ucode":"F13405AD8511B1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590370,"discussion_content":"概率","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665710988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":15755,"ip_address":"上海"},"score":590370,"extra":""}]}]},{"had_liked":false,"id":144367,"user_name":"Howard","can_delete":false,"product_type":"c1","uid":1321620,"ip_address":"","ucode":"3634F77FF76746","user_header":"https://static001.geekbang.org/account/avatar/00/14/2a/94/8c128d36.jpg","comment_is_top":false,"comment_ctime":1571904577,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31636675649","product_id":100026901,"comment_content":"1, 2我还是有点纠结，虽然明显第1优于2，但是2有一个好处就是可以根据错误定义自己的异常信息。所以个人觉得第3种更好。<br><br>try:<br>    db = DB.connect(&#39;&lt;db path&gt;&#39;)<br>    raw_data = DB.queryData(&#39;&lt;viewer_id&gt;&#39;)<br>except DBConnectionError as err:<br>    print(&#39;DB connection failed {}&#39;.format(err))<br>except DBQueryDataError as err:<br>    print(&#39;DB query failed {}&#39;.format(err))","like_count":8},{"had_liked":false,"id":99783,"user_name":"太平湖-燃气（DUYANG）18356257898","can_delete":false,"product_type":"c1","uid":1524400,"ip_address":"","ucode":"A5E6A8909EC29A","user_header":"https://static001.geekbang.org/account/avatar/00/17/42/b0/687e13d0.jpg","comment_is_top":false,"comment_ctime":1559298533,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"23034135013","product_id":100026901,"comment_content":"什么是flow-control。。","like_count":5,"discussions":[{"author":{"id":1163590,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c1/46/a81f7402.jpg","nickname":"王大华","note":"","ucode":"7AD5C4B8E93B0F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":57118,"discussion_content":"流程控制","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574571005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1661704,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5b/08/b0b0db05.jpg","nickname":"丁丁历险记","note":"","ucode":"A43829E454C067","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":24542,"discussion_content":"业务流程控制","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570172883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98180,"user_name":"alan","can_delete":false,"product_type":"c1","uid":1083425,"ip_address":"","ucode":"2CA8D0B6B7D5A9","user_header":"https://static001.geekbang.org/account/avatar/00/10/88/21/50b2418a.jpg","comment_is_top":false,"comment_ctime":1558925962,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18738795146","product_id":100026901,"comment_content":"老师好，相比try-catch的错误处理模式，您觉得Golang那样的返回error的错误处理方式怎么样？您更喜欢哪种错误处理方式？","like_count":4,"discussions":[{"author":{"id":1195204,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3c/c4/4ee2968a.jpg","nickname":"艾利特-G","note":"","ucode":"8C4DA0ABE77CDC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287626,"discussion_content":"这个是个好问题！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593496296,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":112747,"user_name":"大飞守角","can_delete":false,"product_type":"c1","uid":1199825,"ip_address":"","ucode":"5A5BFF885986A3","user_header":"https://static001.geekbang.org/account/avatar/00/12/4e/d1/ded6b849.jpg","comment_is_top":false,"comment_ctime":1562814495,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14447716383","product_id":100026901,"comment_content":"思考题： 第一种比较好，第二种多层嵌套<br><br>还有，文章中举的例子，字典我一般获取使用 d.get(&quot;bob&quot;, None)这种方式，不会报异常，没有直接返回None","like_count":4},{"had_liked":false,"id":98097,"user_name":"John Si","can_delete":false,"product_type":"c1","uid":1526611,"ip_address":"","ucode":"705B90724A4BD4","user_header":"https://static001.geekbang.org/account/avatar/00/17/4b/53/67c08006.jpg","comment_is_top":false,"comment_ctime":1558915499,"is_pvip":false,"replies":[{"id":"35102","content":"正解","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1558921233,"ip_address":"","comment_id":98097,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14443817387","product_id":100026901,"comment_content":"1. 第一種寫法比第二種寫法簡潔<br>2. 因我對try語法執行流程不太清楚，還是老師跟熟悉該同學多講解一下。但我自己想法是第二種寫法跟巢狀迴圈寫法很像，假設是第二句語法發生錯誤，第二種寫法會多執行一次try 語句，從而增加了程序運行時間。<br><br>綜上所述，我認為第一種寫法較第二種好","like_count":4,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451553,"discussion_content":"正解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558921233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":100298,"user_name":"yllopy","can_delete":false,"product_type":"c1","uid":1544775,"ip_address":"","ucode":"33BFAB30E0079A","user_header":"https://static001.geekbang.org/account/avatar/00/17/92/47/ce146561.jpg","comment_is_top":false,"comment_ctime":1559524572,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10149459164","product_id":100026901,"comment_content":"在用finally中用f.close()前建议加上一条判断：if ‘f’ in locals() 用以避免在f被赋值前发生异常而没有被定义导致的二次异常。","like_count":2},{"had_liked":false,"id":98409,"user_name":"汤尼房","can_delete":false,"product_type":"c1","uid":1100996,"ip_address":"","ucode":"A4D961DD9C2F74","user_header":"https://static001.geekbang.org/account/avatar/00/10/cc/c4/5ac16f31.jpg","comment_is_top":false,"comment_ctime":1558998861,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10148933453","product_id":100026901,"comment_content":"第一种方式会更好，try代码段中的代码按顺序执行，若db = DB...这行代码抛出异常，则except语句将会捕获该异常，代码将直接跳转到except代码段中，而raw_data = DB...则不会被执行。若db = DB...没抛出异常，而raw_data抛出异常，except语句依然会将抛出的异常捕获。所以当try block中有多处抛出异常时，第二种方式并不会一次执行均会将所有存在的异常都抛出来，而是和第一种方式一样的线性执行，遇到异常，except便会将其捕获，出现异常语句后面的语句则不会再执行。因此，两者效果是一样的，且第一种方式显得更加有条理，更加简洁，清晰，所以觉得第一种方式会更好一些。","like_count":3,"discussions":[{"author":{"id":2639517,"avatar":"","nickname":"Geek_95f962","note":"","ucode":"E4F5E807FF5BB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376799,"discussion_content":"性能上无差异，风格上一更好？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622349460,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98193,"user_name":"third","can_delete":false,"product_type":"c1","uid":1025114,"ip_address":"","ucode":"9A37408A834F0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg","comment_is_top":false,"comment_ctime":1558928580,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10148863172","product_id":100026901,"comment_content":"小白提问<br>针对06思考的第一问，分次读取文件<br>读取完成一个很大的文件之后，这些文件存放在哪里？<br>如果这个文件大到了无法一次读取内存，那么他是否应该存储在磁盘中？在需要用的时候，又从磁盘中调取呢？<br>希望老师解释一下","like_count":2},{"had_liked":false,"id":98161,"user_name":"小豹子","can_delete":false,"product_type":"c1","uid":1346267,"ip_address":"","ucode":"972F3E6BF0FDEA","user_header":"https://static001.geekbang.org/account/avatar/00/14/8a/db/76ab84c6.jpg","comment_is_top":false,"comment_ctime":1558923115,"is_pvip":false,"replies":[{"id":"35167","content":"系统异常比如说keyboardInterrupt","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1558944534,"ip_address":"","comment_id":98161,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10148857707","product_id":100026901,"comment_content":"老师，系统异常，非系统异常能举个例子说明下吗？","like_count":2,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451585,"discussion_content":"系统异常比如说keyboardInterrupt","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558944534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98142,"user_name":"Python高效编程","can_delete":false,"product_type":"c1","uid":1325271,"ip_address":"","ucode":"B12B5F43B4335E","user_header":"https://static001.geekbang.org/account/avatar/00/14/38/d7/de6832df.jpg","comment_is_top":false,"comment_ctime":1558920093,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10148854685","product_id":100026901,"comment_content":"第一种方式清晰一点","like_count":2},{"had_liked":false,"id":98935,"user_name":"helloworld","can_delete":false,"product_type":"c1","uid":1105161,"ip_address":"","ucode":"1EECCA0F43E278","user_header":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","comment_is_top":false,"comment_ctime":1559116781,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5854084077","product_id":100026901,"comment_content":"老师，对文中的自定义异常不太理解，为什么要主动去raise自定义异常，有啥意义吗","like_count":1,"discussions":[{"author":{"id":1187210,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epc6ic3WuwDyZGjz1sy6bKIbhgucQfA4WdicickOuiadJmOH5ibHdlTibpibevvCxyc2gptARQuUjthOV8WQ/132","nickname":"学习使我快乐","note":"","ucode":"51FA2F21AE3F4A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2689,"discussion_content":"自定义异常一般前面都有判断条件的，即知道了明确有这种错误发生了，才抛除自定义异常。","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1563861115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1186115,"avatar":"https://static001.geekbang.org/account/avatar/00/12/19/43/226ca347.jpg","nickname":"Michael 🛡YZY","note":"","ucode":"F1D2BF8489A7D2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3530,"discussion_content":"几乎等于Java中的 throw new MyException()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564555619,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98516,"user_name":"无才不肖生","can_delete":false,"product_type":"c1","uid":1065687,"ip_address":"","ucode":"A2F83FC7405792","user_header":"https://static001.geekbang.org/account/avatar/00/10/42/d7/1f1634af.jpg","comment_is_top":false,"comment_ctime":1559015077,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5853982373","product_id":100026901,"comment_content":"老师，想问个题外题<br>对象的属性是个字典，django中要根据属性里字典的某个键值查询该怎么做呢，如下面的，我想直接根据companyType来查询过滤记录<br>person<br>{<br>    IDCard:12345678901,<br>    name:emily<br>    companys：<br>        companyName:&#39;阿里&#39;,<br>        companyType:&#39;电商&#39;<br>}","like_count":1},{"had_liked":false,"id":98486,"user_name":"Geek_41743c","can_delete":false,"product_type":"c1","uid":1545724,"ip_address":"","ucode":"CE1C34F6640668","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJDFSUdfgwWZf7fRxTfmyx3TsKL7ZjegELDoXjmZCvLrVLgUp1goR3RVfhH2chjwLb22wpXSsfRWQ/132","comment_is_top":false,"comment_ctime":1559009795,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5853977091","product_id":100026901,"comment_content":"dict取值是不是用get()比较好。","like_count":1},{"had_liked":false,"id":98277,"user_name":"SCAR","can_delete":false,"product_type":"c1","uid":1031209,"ip_address":"","ucode":"38C0927FA3C5FC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bc/29/022905e6.jpg","comment_is_top":false,"comment_ctime":1558947114,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5853914410","product_id":100026901,"comment_content":"应该是第一种情况更优：<br>1. 从实现的功能来看第一种和第二种都能达到，不过程序里两种异常是线性依次的，所以完全可以并行写在一个except里，再者python里的标准异常都__str__处理过，是完全可以区分哪个异常发生的。<br>2. 但就像the zen of python里强调的那样，简单和清晰是 python代码应该遵从的，显然第一种更优。","like_count":1},{"had_liked":false,"id":98136,"user_name":"leixin","can_delete":false,"product_type":"c1","uid":1318291,"ip_address":"","ucode":"9885DF5FB2E136","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/szNEybCR1Al4p6eDyT8atNjen7ZY9cBJSXOQl1EnrTM2efiaHlPtL7X44JeibXs9qEFLWv6HJWBwq5tVlNahGDGQ/132","comment_is_top":false,"comment_ctime":1558919323,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5853886619","product_id":100026901,"comment_content":"期待更进阶的。","like_count":1},{"had_liked":false,"id":98081,"user_name":"王校","can_delete":false,"product_type":"c1","uid":1486868,"ip_address":"","ucode":"BBE375D730B021","user_header":"https://static001.geekbang.org/account/avatar/00/16/b0/14/e5c445ba.jpg","comment_is_top":false,"comment_ctime":1558905732,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5853873028","product_id":100026901,"comment_content":"第一种对阅读程序的人更友好。","like_count":1},{"had_liked":false,"id":337986,"user_name":"Geek_fc975d","can_delete":false,"product_type":"c1","uid":2459939,"ip_address":"","ucode":"05B6507FE4349B","user_header":"https://static001.geekbang.org/account/avatar/00/25/89/23/e71f180b.jpg","comment_is_top":false,"comment_ctime":1647221882,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1647221882","product_id":100026901,"comment_content":"第一种写法更好<br>","like_count":0},{"had_liked":false,"id":327048,"user_name":"qiu123456","can_delete":false,"product_type":"c1","uid":1333387,"ip_address":"","ucode":"71DC61AF12E8A5","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/SXhZVacJlNR0lBbPib7peJbVlhsX8iaiaw2AdkfO8RTn0V7zoBvm5dWy4uvBehqTuOzlRFTG1r46Wz9GIiaMAHMvfA/132","comment_is_top":false,"comment_ctime":1639885302,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1639885302","product_id":100026901,"comment_content":"第一种写法更好，同样的功能，第二种嵌套了，看起来复杂，而第一种简洁明了","like_count":0},{"had_liked":false,"id":325898,"user_name":"Geek_44798f","can_delete":false,"product_type":"c1","uid":2851448,"ip_address":"","ucode":"4EB2BD9FBDDE7F","user_header":"","comment_is_top":false,"comment_ctime":1639218617,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1639218617","product_id":100026901,"comment_content":"光从提示上来看，觉得第二种方式更好，对于问题排查更加友好。但是不知道程序运行层面是什么样子了","like_count":0},{"had_liked":false,"id":325224,"user_name":"二师兄","can_delete":false,"product_type":"c1","uid":1396137,"ip_address":"","ucode":"292931329F2150","user_header":"","comment_is_top":false,"comment_ctime":1638869162,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1638869162","product_id":100026901,"comment_content":"import sys<br><br>try:<br>\tf = open(&#39;1.txt&#39;, &#39;r&#39;)<br>except OSError as err:<br>\tprint(&#39;OS error: {}&#39;.format(err))<br>except:<br>\tprint(&#39;unkonw error&#39;, sys.exc_info()[0])<br>finally:<br>\tf.close()<br><br><br># NameError: name &#39;f&#39; is not defined<br>文件不存在的情况下，关闭文件会报错 f不存在，请问这种情况怎么处理？","like_count":0},{"had_liked":false,"id":320722,"user_name":"海盗船长","can_delete":false,"product_type":"c1","uid":1363634,"ip_address":"","ucode":"ECB28BA21A4113","user_header":"https://static001.geekbang.org/account/avatar/00/14/ce/b2/1f914527.jpg","comment_is_top":false,"comment_ctime":1636468902,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636468902","product_id":100026901,"comment_content":"要多看官方文档了，这篇跟官方文档60%-70%重合","like_count":0},{"had_liked":false,"id":307039,"user_name":"小匚","can_delete":false,"product_type":"c1","uid":1611663,"ip_address":"","ucode":"78E800B23C457A","user_header":"https://static001.geekbang.org/account/avatar/00/18/97/8f/ccce7df1.jpg","comment_is_top":false,"comment_ctime":1628838302,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628838302","product_id":100026901,"comment_content":"反思到自己在初步掌握异常处理的时候，也写过2的代码：理由是取决于更关注哪一块。2 会分步的去报错，我会直接知道链接有没有成功。<br>如果关心问题的颗粒度是略粗的，把整个一块，都看成是数据源的获取，那 1 在可读性、运行效率上会更佳。","like_count":0},{"had_liked":false,"id":290659,"user_name":"lcqbug","can_delete":false,"product_type":"c1","uid":1268609,"ip_address":"","ucode":"08FA17F21BCEC5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbyHPGNLu9sDQOs1V6brMcDwia55pyIlP9n62oO6IYS6kIFDnOSON4ugSeBSy6WhDUnYyJC6vtnHQ/132","comment_is_top":false,"comment_ctime":1619679496,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619679496","product_id":100026901,"comment_content":"<br>import sys<br>try:<br>    f = open(&#39;file.txt&#39;, &#39;r&#39;)<br>    .... # some data processing<br>except OSError as err:<br>    print(&#39;OS error: {}&#39;.format(err))<br>except:<br>    print(&#39;Unexpected error:&#39;, sys.exc_info()[0])<br>finally:<br>    f.close()<br><br>finally这里也会报错,NameError: name &#39;f&#39; is not defined","like_count":0},{"had_liked":false,"id":272039,"user_name":"Geek_Crystal","can_delete":false,"product_type":"c1","uid":1953741,"ip_address":"","ucode":"EC86F75319EE8E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/6rGMZEbo2qLpUa1Ou37lrGyd5ToKjPeZIDS6gnRxTdXRBpAVia7nxddzsTqSUqCFW1LafdFcVKOSicjJbJdFPxtA/132","comment_is_top":false,"comment_ctime":1609916448,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1609916448","product_id":100026901,"comment_content":"有个疑问，如果把这些异常捕获了，程序还会继续执行后面的代码，我认为这样不太对。比如：<br>import sys<br>try: <br>    f = open(&#39;file.txt&#39;, &#39;r&#39;) .... # some data processing<br>except OSError as err: <br>    print(&#39;OS error: {}&#39;.format(err))<br>出现了OSError，显然程序应该停下来了，而不是继续执行。<br>请各位赐教～～～","like_count":0,"discussions":[{"author":{"id":2639517,"avatar":"","nickname":"Geek_95f962","note":"","ucode":"E4F5E807FF5BB9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376789,"discussion_content":"捕获异常的目的应该就是为了让程序继续运行吧，按你的意思希望程序停止的话，应该在except后面的语句中让程序处理，而你这边只是print一下，相当于一个log信息","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622345240,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263491,"user_name":"Geek_ledger","can_delete":false,"product_type":"c1","uid":2316109,"ip_address":"","ucode":"11A76B50028BD5","user_header":"","comment_is_top":false,"comment_ctime":1606142717,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606142717","product_id":100026901,"comment_content":"我滴天，一直没搞懂exception用法，这一篇令我茅塞顿开啊","like_count":0},{"had_liked":false,"id":254213,"user_name":"学废了","can_delete":false,"product_type":"c1","uid":1144768,"ip_address":"","ucode":"2418B1D501B6B6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Y5U2ADUvruWhziaB4tSyiaAIfHJ6sZ7kuwgkVUORPqEzFzX4TvWgoOiby4VaghfLHBY7zR6wOgtSXpTOpu40CXJVg/132","comment_is_top":false,"comment_ctime":1603083964,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603083964","product_id":100026901,"comment_content":"学到了","like_count":0},{"had_liked":false,"id":239951,"user_name":"〰","can_delete":false,"product_type":"c1","uid":1164565,"ip_address":"","ucode":"5ECF54B48BB29B","user_header":"https://static001.geekbang.org/account/avatar/00/11/c5/15/cf00ae4f.jpg","comment_is_top":false,"comment_ctime":1596700071,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596700071","product_id":100026901,"comment_content":"<br>import sys<br>try:<br>    f = open(&#39;file.txt&#39;, &#39;r&#39;)<br>    .... # some data processing<br>except OSError as err:<br>    print(&#39;OS error: {}&#39;.format(err))<br>except:<br>    print(&#39;Unexpected error:&#39;, sys.exc_info()[0])<br>finally:<br>    f.close()<br><br>这里，如果打开文件出错，f还没被定义，在finally的时候会出现NameError: name &#39;f&#39; is not defined，该怎么处理比较好","like_count":0},{"had_liked":false,"id":239577,"user_name":"Geek_aa780e","can_delete":false,"product_type":"c1","uid":1671394,"ip_address":"","ucode":"20C49732158424","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/8KpWhCMxgVgqKMxNT9zuJuVnz1gNBzYlWrZCO4hlF4OQibhawvn0hpHhHgHr4kSXfVNjeuE4StuvTR54NGcE4Zg/132","comment_is_top":false,"comment_ctime":1596591227,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1596591227","product_id":100026901,"comment_content":"在web项目中，异常在哪层进行捕获比较好呢？ 比如说handler-&gt;service -&gt;model， 日志在哪里打印比较好 ？","like_count":0},{"had_liked":false,"id":227401,"user_name":"Kevin","can_delete":false,"product_type":"c1","uid":1923859,"ip_address":"","ucode":"89EA5FCF036C42","user_header":"https://static001.geekbang.org/account/avatar/00/1d/5b/13/6db9ba58.jpg","comment_is_top":false,"comment_ctime":1592373192,"is_pvip":true,"replies":[{"id":"84142","content":"正解","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1592592236,"ip_address":"","comment_id":227401,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592373192","product_id":100026901,"comment_content":"从代码行数看第一种更简洁，第一种中，使用了一个try..expect将异常统一处理，代码简洁，<br>第二种，代码中有嵌套，","like_count":0,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498621,"discussion_content":"正解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592592236,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":220380,"user_name":"Geek_871a6a","can_delete":false,"product_type":"c1","uid":1600007,"ip_address":"","ucode":"4D0917BFD6B441","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEI4pmhZGWGlmpLbxrZk2b6JXfzc7aoXvczZf3xpC09nzmDEyGlTGCIw1h6vq3zF9YDG8Lv7raMdKQ/132","comment_is_top":false,"comment_ctime":1590229967,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590229967","product_id":100026901,"comment_content":"<br>class MyInputError(Exception):<br>    &quot;&quot;&quot;Exception raised when there&#39;re errors in input&quot;&quot;&quot;<br>    def __init__(self, value): # 自定义异常类型的初始化<br>        self.value = value<br>    def __str__(self): # 自定义异常类型的string表达形式<br>        return (&quot;{} is invalid input&quot;.format(repr(self.value)))<br>    <br>try:<br>    raise MyInputError(1) # 抛出MyInputError这个异常<br>except MyInputError as err:<br>    print(&#39;error: {}&#39;.format(err))<br>这里自定义异常后，自己去抛出异常，这个例子有点云里雾里，但是像之前的写法在一个真实的例子中去定义自己的异常类，然后如果真的碰到异常才抛出，这样可能就好理解自定义异常的作用了","like_count":0},{"had_liked":false,"id":220048,"user_name":"1006510","can_delete":false,"product_type":"c1","uid":1999745,"ip_address":"","ucode":"0068FD2DD5DEC6","user_header":"","comment_is_top":false,"comment_ctime":1590143945,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1590143945","product_id":100026901,"comment_content":"第一种方法明显更好，代码量少，可阅读性也高，而第二种方法多加了一层不必要的异常处理，难免会给服务器带来更大负担","like_count":0},{"had_liked":false,"id":211060,"user_name":"高志强","can_delete":false,"product_type":"c1","uid":1276563,"ip_address":"","ucode":"68737002043752","user_header":"https://static001.geekbang.org/account/avatar/00/13/7a/93/c9302518.jpg","comment_is_top":false,"comment_ctime":1587889543,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1587889543","product_id":100026901,"comment_content":"if &#39;dob&#39; in d:  这句看起来很像php的 isset() 函数","like_count":0},{"had_liked":false,"id":203739,"user_name":"Allen003","can_delete":false,"product_type":"c1","uid":1703709,"ip_address":"","ucode":"F7F0F433DE6A46","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI9WGvMacyAQZl3Iibnm610zFVjiancRjXLkOhQMrdDIIwicmtKDYlmZ3hn4l1KpcIicPG1Enoh5SbPVw/132","comment_is_top":false,"comment_ctime":1586261344,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586261344","product_id":100026901,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":199345,"user_name":"Geek_David","can_delete":false,"product_type":"c1","uid":1897719,"ip_address":"","ucode":"9B9F30BB2F2C68","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f4/f7/871ff71d.jpg","comment_is_top":false,"comment_ctime":1585487341,"is_pvip":false,"replies":[{"id":"76077","content":"书的话内容太过冗余了，这个课就是提炼一些精华了","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1586235920,"ip_address":"","comment_id":199345,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585487341","product_id":100026901,"comment_content":"个人觉得这个课还要加上一本python的书，那就天衣无缝了","like_count":0,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489823,"discussion_content":"书的话内容太过冗余了，这个课就是提炼一些精华了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586235920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198512,"user_name":"单色","can_delete":false,"product_type":"c1","uid":1907486,"ip_address":"","ucode":"A1DA6E497FD74C","user_header":"https://static001.geekbang.org/account/avatar/00/1d/1b/1e/f5c16f7e.jpg","comment_is_top":false,"comment_ctime":1585454465,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585454465","product_id":100026901,"comment_content":"思考题：<br>第一种更好，简洁明了。<br><br><br>异常，通常是指程序运行的过程中遇到了错误，终止并退出。我们通常使用 try except 语句去处理异常，这样程序就不会被终止，仍能继续执行。<br>处理异常时，如果有必须执行的语句，比如文件打开后必须关闭等等，则可以放在 finally  block 中。<br>异常处理，通常用在你不确定某段代码能否成功执行，也无法轻易判断的情况下，比如数据库的连接、读取等等。正常的 flow-control 逻辑，不要使用异常处理，直接用条件语句解决就可以了。","like_count":0},{"had_liked":false,"id":197357,"user_name":"Geek_David","can_delete":false,"product_type":"c1","uid":1897719,"ip_address":"","ucode":"9B9F30BB2F2C68","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f4/f7/871ff71d.jpg","comment_is_top":false,"comment_ctime":1585371079,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585371079","product_id":100026901,"comment_content":"有个疑问，如果connect已经抛出异常了，那后面的queryData还有什么意义吗，是不是有问题？<br><br>个人对数据库不太了解，请见谅","like_count":0},{"had_liked":false,"id":193238,"user_name":"Geek_27","can_delete":false,"product_type":"c1","uid":1925957,"ip_address":"","ucode":"908A4172A219BA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL7ZOCns481Zl7VeRk9IdHrAYF8ZpKBJ9LLUaRn7qGoibdZpwzhRmRlGRQBbFVx914qg2p5jZPozDg/132","comment_is_top":false,"comment_ctime":1584886629,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584886629","product_id":100026901,"comment_content":"还是要多练习，多思考","like_count":0},{"had_liked":false,"id":181226,"user_name":"本来是亚","can_delete":false,"product_type":"c1","uid":1073592,"ip_address":"","ucode":"14527E5BC3C2A8","user_header":"https://static001.geekbang.org/account/avatar/00/10/61/b8/7b23f8cb.jpg","comment_is_top":false,"comment_ctime":1582521879,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1582521879","product_id":100026901,"comment_content":"第一种更简洁，而且和第二种效果一样","like_count":0},{"had_liked":false,"id":175319,"user_name":"王大华","can_delete":false,"product_type":"c1","uid":1163590,"ip_address":"","ucode":"7AD5C4B8E93B0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/c1/46/a81f7402.jpg","comment_is_top":false,"comment_ctime":1580653722,"is_pvip":false,"replies":[{"id":"68226","content":"回答的很对","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1580765307,"ip_address":"","comment_id":175319,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1580653722","product_id":100026901,"comment_content":"第一种和第二种效果类似，<br>都是先检查数据库连接异常，再检查query执行的异常。<br><br>更喜欢这种写法：<br>try:<br>    db = DB.connect(&#39;&lt;db path&gt;&#39;) # 可能会抛出异常<br>    raw_data = DB.queryData(&#39;&lt;viewer_id&gt;&#39;) # 可能会抛出异常<br>except DBConnectionError as err:<br>    print(&#39;ConnectionError: {}&#39;.format(err))<br>except DBQueryDataError as err:<br>    print(&#39;QueryDataError: {}&#39;.format(err))","like_count":0,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482690,"discussion_content":"回答的很对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580765307,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1671394,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/8KpWhCMxgVgqKMxNT9zuJuVnz1gNBzYlWrZCO4hlF4OQibhawvn0hpHhHgHr4kSXfVNjeuE4StuvTR54NGcE4Zg/132","nickname":"Geek_aa780e","note":"","ucode":"20C49732158424","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296569,"discussion_content":"在web项目中，异常在哪层进行捕获比较好呢？ 比如说handler->service ->model， 日志在哪里打印比较好 ？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596591188,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":167867,"user_name":"一粒","can_delete":false,"product_type":"c1","uid":1582813,"ip_address":"","ucode":"FB5F583CC6AE3C","user_header":"https://static001.geekbang.org/account/avatar/00/18/26/dd/d58156b1.jpg","comment_is_top":false,"comment_ctime":1577954427,"is_pvip":true,"replies":[{"id":"66788","content":"比如条件语句 if，循环语句for，while等等","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1579135693,"ip_address":"","comment_id":167867,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1577954427","product_id":100026901,"comment_content":"老师，什么样的代码才是您说的“flow-control”","like_count":0,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":480031,"discussion_content":"比如条件语句 if，循环语句for，while等等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579135693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":167866,"user_name":"一粒","can_delete":false,"product_type":"c1","uid":1582813,"ip_address":"","ucode":"FB5F583CC6AE3C","user_header":"https://static001.geekbang.org/account/avatar/00/18/26/dd/d58156b1.jpg","comment_is_top":false,"comment_ctime":1577954345,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1577954345","product_id":100026901,"comment_content":"执行效果相同，但第一种代码更简洁","like_count":0},{"had_liked":false,"id":160801,"user_name":"Basic Φ","can_delete":false,"product_type":"c1","uid":1076709,"ip_address":"","ucode":"40336B74405B69","user_header":"https://static001.geekbang.org/account/avatar/00/10/6d/e5/dabe4ee4.jpg","comment_is_top":false,"comment_ctime":1576034056,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576034056","product_id":100026901,"comment_content":"景老师，json的异常都有哪些，可以从哪里查到？","like_count":0},{"had_liked":false,"id":160698,"user_name":"峰","can_delete":false,"product_type":"c1","uid":1056019,"ip_address":"","ucode":"C53CB64E8E7D19","user_header":"https://static001.geekbang.org/account/avatar/00/10/1d/13/31ea1b0b.jpg","comment_is_top":false,"comment_ctime":1576023709,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1576023709","product_id":100026901,"comment_content":"第一种，功能一样，第一种更简洁。","like_count":0},{"had_liked":false,"id":156326,"user_name":"Nemo","can_delete":false,"product_type":"c1","uid":1657039,"ip_address":"","ucode":"2B11D18D6FA2AE","user_header":"https://static001.geekbang.org/account/avatar/00/19/48/cf/8c88e6c0.jpg","comment_is_top":false,"comment_ctime":1574856917,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1574856917","product_id":100026901,"comment_content":"第一次竟然会认为第二种更安全点，哈哈哈","like_count":0},{"had_liked":false,"id":151213,"user_name":"Paul Shan","can_delete":false,"product_type":"c1","uid":1593140,"ip_address":"","ucode":"32D99989028284","user_header":"","comment_is_top":false,"comment_ctime":1573677708,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573677708","product_id":100026901,"comment_content":"异常是正常的反面，是程序代码非常规路径的跳转，是我初学编程时避之不及的类型。随着编程经验的增加，这种多处跳转，一处处理的模式有其价值。<br>我个人觉得静态语言处理简单的错误状态更为高效简洁。例如kotlin语言引入了nullable类型以后，对于创建型的函数可以用null来代表错误状态，这样可以在编译阶段强制处理主要的错误状态。","like_count":1},{"had_liked":false,"id":150994,"user_name":"Paul Shan","can_delete":false,"product_type":"c1","uid":1593140,"ip_address":"","ucode":"32D99989028284","user_header":"","comment_is_top":false,"comment_ctime":1573639391,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1573639391","product_id":100026901,"comment_content":"思考题：<br>第一种写法更简单，层次少，而且异常本来就是跳出原有的流程，没有必要分那么多层（这和错误处理不一样）。所以，我认为应该选第一种。","like_count":0},{"had_liked":false,"id":135572,"user_name":"自由民","can_delete":false,"product_type":"c1","uid":1346236,"ip_address":"","ucode":"435C67531697F1","user_header":"https://static001.geekbang.org/account/avatar/00/14/8a/bc/cb39ed38.jpg","comment_is_top":false,"comment_ctime":1569217532,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1569217532","product_id":100026901,"comment_content":"总结:<br>异常指程序运行时的过程遇到的错误，通常使用try expect语句处理。处理异常时必须要执行的操作放finally里。异常处理通常用在不确定某段代码能否执行成功时，也无法轻易判断的情况下。正常流程控制逻辑不用使用。<br>思考题<br>第二种更好，能明确定位异常到底是从哪里发生的。第一种只能知道发生了异常。<br>课程的练习代码: https:&#47;&#47;github.com&#47;zwdnet&#47;PythonPractice","like_count":0},{"had_liked":false,"id":133237,"user_name":"技术修行者","can_delete":false,"product_type":"c1","uid":1013147,"ip_address":"","ucode":"28CA41A1214D6B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/9b/611e74ab.jpg","comment_is_top":false,"comment_ctime":1568457289,"is_pvip":true,"discussion_count":0,"race_medal":5,"score":"1568457289","product_id":100026901,"comment_content":"第一种更清晰一些。","like_count":0},{"had_liked":false,"id":130740,"user_name":"Geek_siskin","can_delete":false,"product_type":"c1","uid":1138986,"ip_address":"","ucode":"333EA30F8FB6DB","user_header":"https://static001.geekbang.org/account/avatar/00/11/61/2a/71aeffe6.jpg","comment_is_top":false,"comment_ctime":1567522215,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1567522215","product_id":100026901,"comment_content":"finally block中如果有exception抛出呢？","like_count":0},{"had_liked":false,"id":118803,"user_name":"Super~琪琪","can_delete":false,"product_type":"c1","uid":1039225,"ip_address":"","ucode":"5A0FCD19B24EAF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/db/79/9426c6ce.jpg","comment_is_top":false,"comment_ctime":1564448694,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1564448694","product_id":100026901,"comment_content":"那有没有全局异常处理这一说？Java中可以通过注解实现的。😂","like_count":0},{"had_liked":false,"id":110826,"user_name":"gugu","can_delete":false,"product_type":"c1","uid":1346069,"ip_address":"","ucode":"A87EFB95B43CE7","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/QEqicKQS1lCunSfI7tIcfhTOb0GjIRRIiav2PBc4ZUvstNXhP2LISfhwwRqSJjwbpupMeaqclUGKc78lfS7JVmUQ/132","comment_is_top":false,"comment_ctime":1562360359,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562360359","product_id":100026901,"comment_content":"下面的代码，如果在多线程环境中，还是有可能异常：<br>if &#39;dob&#39; in d:<br>    value = d[&#39;dob&#39;]<br>    ...<br>这种情况是不是应该首先解决race condition，如果race condition不能彻底解决好，就再用异常处理？","like_count":0},{"had_liked":false,"id":110403,"user_name":"Z_ying","can_delete":false,"product_type":"c1","uid":1307689,"ip_address":"","ucode":"B4FDE000A012B5","user_header":"","comment_is_top":false,"comment_ctime":1562249330,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562249330","product_id":100026901,"comment_content":"except (DBConnectionError, DBQueryDataError)  err<br>是不是漏了 as ","like_count":0},{"had_liked":false,"id":110327,"user_name":"郭杰","can_delete":false,"product_type":"c1","uid":1139077,"ip_address":"","ucode":"8A14FC047A679B","user_header":"https://static001.geekbang.org/account/avatar/00/11/61/85/6accd013.jpg","comment_is_top":false,"comment_ctime":1562230767,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1562230767","product_id":100026901,"comment_content":"从表面上看第二种最合适，但是一般我只会搞第一种，链接错误了没法继续下面的代码逻辑循环，但是其他报错可以忽略","like_count":0},{"had_liked":false,"id":108608,"user_name":"zn","can_delete":false,"product_type":"c1","uid":1121952,"ip_address":"","ucode":"10605E6EA6752D","user_header":"https://static001.geekbang.org/account/avatar/00/11/1e/a0/52e12101.jpg","comment_is_top":false,"comment_ctime":1561814868,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561814868","product_id":100026901,"comment_content":"文件读取的那个例子，如果open的文件不存在，抛出OSError，那么 f 这个file对象是否创建成功了。如果没有创建成功的话，finally里进行close()操作，应该也会报错吧","like_count":0},{"had_liked":false,"id":108491,"user_name":"建强","can_delete":false,"product_type":"c1","uid":1397126,"ip_address":"","ucode":"62B03D0E0C64EC","user_header":"https://static001.geekbang.org/account/avatar/00/15/51/86/b5fd8dd8.jpg","comment_is_top":false,"comment_ctime":1561783269,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561783269","product_id":100026901,"comment_content":"第一种写法更简洁，但无法针对不同的错误做出不同的处理；第二种写法虽然繁琐，但可以对不同错误，采取不同的措施，因此，如果对不同错误，只用一种措施，采用第一种写法，如果要分别处理，采用第二种写法。","like_count":0},{"had_liked":false,"id":107460,"user_name":"magician","can_delete":false,"product_type":"c1","uid":1483968,"ip_address":"","ucode":"1BD1125C7C907A","user_header":"https://static001.geekbang.org/account/avatar/00/16/a4/c0/c6880c07.jpg","comment_is_top":false,"comment_ctime":1561539340,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561539340","product_id":100026901,"comment_content":"第一种，清晰易读，捕捉多种异常，无需嵌套try catch","like_count":0},{"had_liked":false,"id":107057,"user_name":"赵鹏举","can_delete":false,"product_type":"c1","uid":1260182,"ip_address":"","ucode":"B3785788D6176C","user_header":"https://static001.geekbang.org/account/avatar/00/13/3a/96/9fddfb4a.jpg","comment_is_top":false,"comment_ctime":1561449234,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561449234","product_id":100026901,"comment_content":"基础语法糖讲得太多，到这一讲依然没有看到干货……","like_count":0},{"had_liked":false,"id":105851,"user_name":"某彬","can_delete":false,"product_type":"c1","uid":1355849,"ip_address":"","ucode":"BB137DFE52250A","user_header":"https://static001.geekbang.org/account/avatar/00/14/b0/49/39238538.jpg","comment_is_top":false,"comment_ctime":1561093762,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561093762","product_id":100026901,"comment_content":"关于字典的flow-control部分，官方有个文档提到了EFEP的原则，作者的建议是否跟这个原则相违背了？我有点费解...","like_count":0},{"had_liked":false,"id":104871,"user_name":"小武","can_delete":false,"product_type":"c1","uid":1031888,"ip_address":"","ucode":"F47B5D220161E7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/d0/7f37f35f.jpg","comment_is_top":false,"comment_ctime":1560860938,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560860938","product_id":100026901,"comment_content":"第一种更好一些，如果写太多的try except不易于理解，代码看起来也很乱，两个效果是一样的","like_count":0},{"had_liked":false,"id":104117,"user_name":"enjoylearning","can_delete":false,"product_type":"c1","uid":1000237,"ip_address":"","ucode":"DCAF8538DEA277","user_header":"https://static001.geekbang.org/account/avatar/00/0f/43/2d/af86d73f.jpg","comment_is_top":false,"comment_ctime":1560656160,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560656160","product_id":100026901,"comment_content":"最近做项目回来看异常处理，写了一些公共类，自定义了异常，如一些校验error ，直接raise出来，但又犹豫这样处理是否合适，我认为异常就是要抛出来给调用方，而不是直接放到日志里继续走下面的语句","like_count":0},{"had_liked":false,"id":103710,"user_name":"🎈大力.","can_delete":false,"product_type":"c1","uid":1408992,"ip_address":"","ucode":"762887D13A53D5","user_header":"https://static001.geekbang.org/account/avatar/00/15/7f/e0/4ba323bc.jpg","comment_is_top":false,"comment_ctime":1560496365,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1560496365","product_id":100026901,"comment_content":"两种使用方法含义相同, 但第二种代码存在冗余现象, 嵌套多层不易阅读","like_count":0},{"had_liked":false,"id":101788,"user_name":"游戏","can_delete":false,"product_type":"c1","uid":1526457,"ip_address":"","ucode":"2DAF963DADEE76","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/rp4leprLrAVpeibk9n6KHaYZeasBG4faU2JnHsBMqxE1o4BALjCTmBZV2g4dkuPGhu13kmRwSOgXpoPky3qc4Zw/132","comment_is_top":false,"comment_ctime":1559972472,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559972472","product_id":100026901,"comment_content":"个人觉得第一种比较好，第二种写起来冗余，看起来也不是很清晰的感觉。<br>关于异常处理方面的问题，我最近就遇到一个，就是使用多线程发送网页请求的时候，经常会遇到请求超时的情况，我的解决方法是加了一个异常处理，如果超时就尝试发送一次，这样子一般就没有问题了，但是我有一个疑问就是，我这样子的处理方法合适嘛？还有就是，如何比较优雅的做到一旦遇到请求超时就重复的发送请求呢，不管失败多少次的那种？","like_count":0},{"had_liked":false,"id":100378,"user_name":"小侠龙旋风","can_delete":false,"product_type":"c1","uid":1126441,"ip_address":"","ucode":"073F3924A99835","user_header":"https://static001.geekbang.org/account/avatar/00/11/30/29/d6816ebf.jpg","comment_is_top":false,"comment_ctime":1559541335,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559541335","product_id":100026901,"comment_content":"用with open打开文件就不需要手动close了。<br>第一种异常处理较好。<br>调用json.loads时要考虑异常处理，新技能get。","like_count":0},{"had_liked":false,"id":100349,"user_name":"夹心面包","can_delete":false,"product_type":"c1","uid":1301957,"ip_address":"","ucode":"002BBA49D83D17","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJCscgdVibmoPyRLRaicvk6rjTJxePZ6VFHvGjUQvtfhCS6kO4OZ1AVibbhNGKlWZmpEFf2yA6ptsqHw/132","comment_is_top":false,"comment_ctime":1559533149,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559533149","product_id":100026901,"comment_content":"第一种吧,数据库如果无法建立链接只需要第一个错误即可","like_count":0},{"had_liked":false,"id":100161,"user_name":"hlz-123","can_delete":false,"product_type":"c1","uid":1433586,"ip_address":"","ucode":"B7E5EF0C260BD2","user_header":"","comment_is_top":false,"comment_ctime":1559464555,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559464555","product_id":100026901,"comment_content":"第一种写法简洁易懂，但实际编程中，数据库经常只连接一次，读数据往往重复多次，可能分开来写更好一些。","like_count":0},{"had_liked":false,"id":99415,"user_name":"春之绿野","can_delete":false,"product_type":"c1","uid":1057216,"ip_address":"","ucode":"296003F7D2B086","user_header":"https://static001.geekbang.org/account/avatar/00/10/21/c0/38816c31.jpg","comment_is_top":false,"comment_ctime":1559210001,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1559210001","product_id":100026901,"comment_content":"第一种代码更简洁，第二种可读性更好吧。","like_count":0},{"had_liked":false,"id":98981,"user_name":"百年","can_delete":false,"product_type":"c1","uid":1526311,"ip_address":"","ucode":"6D41E3D3282255","user_header":"https://static001.geekbang.org/account/avatar/00/17/4a/27/2702206d.jpg","comment_is_top":false,"comment_ctime":1559123603,"is_pvip":true,"replies":[{"id":"35594","content":"谢谢支持，也请多多分享给你的朋友","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1559150951,"ip_address":"","comment_id":98981,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1559123603","product_id":100026901,"comment_content":"老师的课收获比较大，Python基础课也学过，Python核心机制也学过一点，但是一写代码，特别是实时读写文件，总是报一大堆错误，这结课真的是运用上了。","like_count":0,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451917,"discussion_content":"谢谢支持，也请多多分享给你的朋友","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1559150951,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98681,"user_name":"周平","can_delete":false,"product_type":"c1","uid":1047936,"ip_address":"","ucode":"CA1869B139A4F6","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fd/80/52763d62.jpg","comment_is_top":false,"comment_ctime":1559056536,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559056536","product_id":100026901,"comment_content":"第一看感觉第二种代码逻辑更容易让人懂，细看发现第一种更简洁","like_count":0},{"had_liked":false,"id":98650,"user_name":"小武","can_delete":false,"product_type":"c1","uid":1031888,"ip_address":"","ucode":"F47B5D220161E7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/be/d0/7f37f35f.jpg","comment_is_top":false,"comment_ctime":1559049788,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559049788","product_id":100026901,"comment_content":"第一种方式更好，没有必要一行抛一个异常","like_count":0},{"had_liked":false,"id":98547,"user_name":"........","can_delete":false,"product_type":"c1","uid":1236198,"ip_address":"","ucode":"D54E7F428E7F49","user_header":"https://static001.geekbang.org/account/avatar/00/12/dc/e6/ea4b2c10.jpg","comment_is_top":false,"comment_ctime":1559024636,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559024636","product_id":100026901,"comment_content":"第一种好：<br> 代码更加简洁，根据错误信息完全可以定位异常位置，无需像第二种方式那样，过于繁琐。<br>","like_count":0},{"had_liked":false,"id":98512,"user_name":"水木刀","can_delete":false,"product_type":"c1","uid":1500427,"ip_address":"","ucode":"942093B000C41E","user_header":"https://static001.geekbang.org/account/avatar/00/16/e5/0b/e4e2c0b1.jpg","comment_is_top":false,"comment_ctime":1559014530,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559014530","product_id":100026901,"comment_content":"第一种简洁","like_count":0},{"had_liked":false,"id":98333,"user_name":"Steven","can_delete":false,"product_type":"c1","uid":1495454,"ip_address":"","ucode":"BC5B33911FEC46","user_header":"https://static001.geekbang.org/account/avatar/00/16/d1/9e/fe7bc8df.jpg","comment_is_top":false,"comment_ctime":1558961487,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558961487","product_id":100026901,"comment_content":"打卡","like_count":0},{"had_liked":false,"id":98251,"user_name":"rogerr","can_delete":false,"product_type":"c1","uid":1538280,"ip_address":"","ucode":"735EE845D4560F","user_header":"https://static001.geekbang.org/account/avatar/00/17/78/e8/b79240e8.jpg","comment_is_top":false,"comment_ctime":1558942201,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558942201","product_id":100026901,"comment_content":"第一次看到嵌套的try，感觉还是不嵌套好","like_count":0},{"had_liked":false,"id":98247,"user_name":"somenzz","can_delete":false,"product_type":"c1","uid":1187197,"ip_address":"","ucode":"EA59A170DF8910","user_header":"https://static001.geekbang.org/account/avatar/00/12/1d/7d/368df396.jpg","comment_is_top":false,"comment_ctime":1558941733,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558941733","product_id":100026901,"comment_content":"个人觉得第一种好，只要出现了 try 就表明这里的代码可能发生异常，使用一层 try except 更易读。","like_count":0},{"had_liked":false,"id":98208,"user_name":"程序员人生","can_delete":false,"product_type":"c1","uid":1113668,"ip_address":"","ucode":"C5C5073D89AAA2","user_header":"https://static001.geekbang.org/account/avatar/00/10/fe/44/3e3040ac.jpg","comment_is_top":false,"comment_ctime":1558930480,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558930480","product_id":100026901,"comment_content":"个人觉得第一种写法比较清晰，第二种写法在代码逻辑比较多的情况下，可能会阅读起来比较不方便","like_count":0},{"had_liked":false,"id":98195,"user_name":"Wing·三金","can_delete":false,"product_type":"c1","uid":1341402,"ip_address":"","ucode":"6B9F5822C3717F","user_header":"https://static001.geekbang.org/account/avatar/00/14/77/da/54c663f3.jpg","comment_is_top":false,"comment_ctime":1558928755,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558928755","product_id":100026901,"comment_content":"第一种更佳。原因不仅是因为更加简洁，还因为其中的异常属于不同类型，只要触发其中任何一个异常都会跳到 Except 模块，而且可根据输出的信息判断是哪里出了问题。","like_count":0},{"had_liked":false,"id":98187,"user_name":"mykgzy","can_delete":false,"product_type":"c1","uid":1543823,"ip_address":"","ucode":"4E47A0546987FA","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKCNH9kd9GibX3vibX9osjtWBvP5ibe8iciacMREk4bcDEgfrDQ9EKs8bQlHoVVhW9CXO8WHM5Ag26S9cA/132","comment_is_top":false,"comment_ctime":1558927460,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558927460","product_id":100026901,"comment_content":"方法 1 和 2 均能达到目的，但第一种更优，重复代码量少；不过假如多个错误，且错误类型是同一种，方法 2 我觉得能精确定位到底是哪个出错了。","like_count":0},{"had_liked":false,"id":98162,"user_name":"yshan","can_delete":false,"product_type":"c1","uid":1136788,"ip_address":"","ucode":"A2ECDCDA52B8EE","user_header":"https://static001.geekbang.org/account/avatar/00/11/58/94/c8bc2b59.jpg","comment_is_top":false,"comment_ctime":1558923403,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558923403","product_id":100026901,"comment_content":"从优雅性，可读性来说，第一种好。<br>","like_count":0},{"had_liked":false,"id":98158,"user_name":"kevinsu","can_delete":false,"product_type":"c1","uid":1078506,"ip_address":"","ucode":"BAD46B815D6A5C","user_header":"https://static001.geekbang.org/account/avatar/00/10/74/ea/10661bdc.jpg","comment_is_top":false,"comment_ctime":1558922371,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558922371","product_id":100026901,"comment_content":"第一种更好，简单清晰，代码量少，😄","like_count":0},{"had_liked":false,"id":98151,"user_name":"马星","can_delete":false,"product_type":"c1","uid":1247867,"ip_address":"","ucode":"83D9460D21CEF3","user_header":"https://static001.geekbang.org/account/avatar/00/13/0a/7b/eb3323eb.jpg","comment_is_top":false,"comment_ctime":1558921323,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558921323","product_id":100026901,"comment_content":"异常处理就是为了避免程序崩溃，让程序更稳定的运行。","like_count":0},{"had_liked":false,"id":98146,"user_name":"Blackwang","can_delete":false,"product_type":"c1","uid":1087646,"ip_address":"","ucode":"7F23C9B83FCC34","user_header":"https://static001.geekbang.org/account/avatar/00/10/98/9e/6185004a.jpg","comment_is_top":false,"comment_ctime":1558920871,"is_pvip":false,"replies":[{"id":"35108","content":"输入输出那章的答案我已经置顶了","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1558921797,"ip_address":"","comment_id":98146,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1558920871","product_id":100026901,"comment_content":"第一种更好，不过理由说不上来……<br>另外老师，请问前几天思考题的答案有吗？之前说周末放 github 的？","like_count":0,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451577,"discussion_content":"输入输出那章的答案我已经置顶了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558921797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1283617,"avatar":"https://static001.geekbang.org/account/avatar/00/13/96/21/26034eda.jpg","nickname":"ML","note":"","ucode":"D4ABD32C3C9718","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":246,"discussion_content":"在那里啊，没有看到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561356891,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98129,"user_name":"Robert小七","can_delete":false,"product_type":"c1","uid":1165254,"ip_address":"","ucode":"6BBF4674673AF5","user_header":"https://static001.geekbang.org/account/avatar/00/11/c7/c6/35cc7c7c.jpg","comment_is_top":false,"comment_ctime":1558918488,"is_pvip":false,"replies":[{"id":"35105","content":"有些时候会对特定的异常做一些特定的操作","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1558921403,"ip_address":"","comment_id":98129,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558918488","product_id":100026901,"comment_content":"为什么不直接用except Exception as err?","like_count":0,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451570,"discussion_content":"有些时候会对特定的异常做一些特定的操作","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558921403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98128,"user_name":"羽球码农","can_delete":false,"product_type":"c1","uid":1546687,"ip_address":"","ucode":"63D4290291A2A3","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erPWSp3arBicQmlYFsPxOTImLDOQk5RYgianH1C4jf3zrxYI8ggwcXq50LQy45x3D87lYGE4EJfa43Q/132","comment_is_top":false,"comment_ctime":1558918467,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558918467","product_id":100026901,"comment_content":"第一种更简单清晰","like_count":0},{"had_liked":false,"id":98126,"user_name":"小胖","can_delete":false,"product_type":"c1","uid":1022958,"ip_address":"","ucode":"1B8D884D254070","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/ee/8950c240.jpg","comment_is_top":false,"comment_ctime":1558918267,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558918267","product_id":100026901,"comment_content":"第一种更好，代码优雅 简洁","like_count":0},{"had_liked":false,"id":98106,"user_name":"栾~龟虽寿！","can_delete":false,"product_type":"c1","uid":1504671,"ip_address":"","ucode":"219B38C08979FE","user_header":"https://static001.geekbang.org/account/avatar/00/16/f5/9f/1509d389.jpg","comment_is_top":false,"comment_ctime":1558916387,"is_pvip":false,"replies":[{"id":"35101","content":"感谢你的支持。","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1558921224,"ip_address":"","comment_id":98106,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1558916387","product_id":100026901,"comment_content":"老师，课越听越觉得值，可是大家如何在手机上写代码的？不会是电脑上写好，利用微信，转发给自己手机上，再复制粘贴到留言吧？还有我有些着急，是否能一天播放两课，哈哈，我有基础。","like_count":0,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451558,"discussion_content":"感谢你的支持。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558921224,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1346236,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8a/bc/cb39ed38.jpg","nickname":"自由民","note":"","ucode":"435C67531697F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":19706,"discussion_content":"安卓手机上可以用pydroid3。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569218015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1504671,"avatar":"https://static001.geekbang.org/account/avatar/00/16/f5/9f/1509d389.jpg","nickname":"栾~龟虽寿！","note":"","ucode":"219B38C08979FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1346236,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8a/bc/cb39ed38.jpg","nickname":"自由民","note":"","ucode":"435C67531697F1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25251,"discussion_content":"感谢🙏了，好人。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570487865,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":19706,"ip_address":""},"score":25251,"extra":""}]}]},{"had_liked":false,"id":98086,"user_name":"mickle","can_delete":false,"product_type":"c1","uid":1201493,"ip_address":"","ucode":"1F89608B5E06C7","user_header":"https://static001.geekbang.org/account/avatar/00/12/55/55/19ec7b0e.jpg","comment_is_top":false,"comment_ctime":1558911729,"is_pvip":false,"replies":[{"id":"35103","content":"对的","user_name":"作者回复","user_name_real":"Jingxiao","uid":"1259521","ctime":1558921239,"ip_address":"","comment_id":98086,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1558911729","product_id":100026901,"comment_content":"我在开发中用第一种吧，第二种代码冗余，看着难受","like_count":0,"discussions":[{"author":{"id":1259521,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJOlibibPFEWOib8ib7RtfAtxND5FUqCxxoeTuLAbBI9ic23xuwdXT4IyiaWq3Fic9RgEAYI0lBTbEp2rcg/132","nickname":"Jingxiao","note":"","ucode":"EB966BB87132F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451549,"discussion_content":"对的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1558921239,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98079,"user_name":"farFlight","can_delete":false,"product_type":"c1","uid":1245211,"ip_address":"","ucode":"B0872D3ECBEC38","user_header":"https://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83epbRibsic15KXfGEN3SSjnLhXGyhK2Uyrj5ibBJsKAjicNqtafDaQOLH4xpSJRZD1vmibFPJER1ySmwP9A/132","comment_is_top":false,"comment_ctime":1558898705,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1558898705","product_id":100026901,"comment_content":"应该是第一种更好。否则代码就显得非常繁琐了。<br>而且except (DBConnectionError, DBQueryDataError) 也能反馈到具体的错误<br>","like_count":0}]}