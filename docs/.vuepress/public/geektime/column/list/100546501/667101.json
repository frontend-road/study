{"id":667101,"title":"23ï½œæ•°æ®åº“åº”ç”¨ï¼ˆä¸‰ï¼‰ï¼šé¡¹ç›®æ•°æ®åº“é…ç½®å®æˆ˜","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯Barryã€‚</p><p>åœ¨ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘ä»¬å®ç°äº†æ•°æ®åº“è¡¨çš„åˆ›å»ºï¼Œä¹Ÿå®ç°äº†é¡¹ç›®å’Œæ•°æ®åº“çš„è”åŠ¨ï¼Œè¿™å°±ç›¸å½“äºæ¶è®¾å¥½äº†é¡¹ç›®å’Œæ•°æ®åº“çš„æ¡¥æ¢ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å‰é¢éƒ½åšçš„éƒ½æ˜¯å•ç‚¹åŠŸèƒ½çš„å®è·µã€‚</p><p>ä¸ºäº†è®©ä½ åŠ æ·±ç†è§£ï¼Œä»Šåè½»æ¾åº”ç”¨æ•°æ®åº“æ¥å®Œæˆé¡¹ç›®çš„æ•°æ®ç®¡ç†å’Œä¸šåŠ¡å¤„ç†ï¼Œæ¥ä¸‹æ¥çš„ä¸¤èŠ‚è¯¾æˆ‘ä¼šå¸¦ä½ å®Œæˆæ•°æ®åº“é…ç½®ï¼Œå¹¶ç»“åˆé¡¹ç›®ç»¼åˆåº”ç”¨æ•°æ®åº“ã€‚</p><p>åœ¨å­¦ä¹ æ•°æ®åº“é…ç½®å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ¥äº†è§£ä¸€ä¸‹é¡¹ç›®å±‚çº§å…³ç³»ã€‚åªæœ‰æ˜ç¡®é¡¹ç›®çš„å±‚çº§å…³ç³»ï¼Œæ•°æ®åº“é…ç½®çš„è„‰ç»œæ‰ä¼šæ›´åŠ æ¸…æ™°ï¼Œä¹Ÿèƒ½ä¸ºæˆ‘ä»¬ä¹‹åçš„é¡¹ç›®å®æˆ˜åšå¥½é“ºå«ã€‚</p><h2>é¡¹ç›®å±‚çº§æ¡†æ¶</h2><p>æˆ‘ä»¬å…ˆä»é¡¹ç›®å±‚çº§æ¡†æ¶å¼€å§‹è¯´èµ·ã€‚Flask é¡¹ç›®é€šå¸¸åˆ†ä¸ºä¸‰å±‚ï¼Œæˆ‘ä»¬åˆ†åˆ«æ¥çœ‹çœ‹ã€‚</p><ul>\n<li>ç¬¬ä¸€å±‚æ˜¯<strong>å‰ç«¯å±•ç¤ºå±‚</strong>ï¼ŒåŒ…æ‹¬ HTMLã€CSSã€JS ç­‰æ–‡ä»¶ï¼Œç”¨äºå±•ç¤ºç”¨æˆ·ç•Œé¢å’Œä¸ç”¨æˆ·äº¤äº’ã€‚è¿™ä¹Ÿæ˜¯ç›´æ¥ä¸ç”¨æˆ·æ¥è§¦çš„å†…å®¹ã€‚</li>\n<li>ç¬¬äºŒå±‚æ˜¯<strong>åç«¯ä¸šåŠ¡é€»è¾‘å±‚</strong>ï¼Œç”¨æ¥è·å–æ•°æ®åº“çš„æ•°æ®å¹¶è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œæœ€åæŠŠå¤„ç†å¥½çš„æ•°æ®äº¤ç»™å‰ç«¯å»æ¸²æŸ“å±•ç¤ºã€‚è¿™å±‚é€šå¸¸ä¼šæ¶‰åŠåˆ° ORM å¯¹è±¡å…³ç³»æ˜ å°„å±‚ï¼Œç”¨æ¥å’Œæ•°æ®åº“äº¤äº’ã€‚</li>\n<li>ç¬¬ä¸‰å±‚å°±æ˜¯<strong>æ•°æ®åº“å±‚</strong>ï¼Œä½œç”¨æ˜¯å­˜å‚¨å’Œç®¡ç†æ•°æ®ï¼Œé€šå¸¸ä¼šç”¨åˆ°MySQLè¿™æ ·çš„å…³ç³»å‹æ•°æ®åº“ã€‚</li>\n</ul><p>å½“ç„¶ï¼Œä½ ä¹Ÿè¦æ˜ç¡®ä¸€ä¸ª Flask é¡¹ç›®å¹¶ä¸æ˜¯éƒ½éœ€è¦åˆ†ä¸ºä¸‰å±‚ã€‚å…·ä½“çš„å±‚çº§åˆ†å¸ƒå–å†³äºé¡¹ç›®çš„å¤æ‚åº¦å’Œéœ€æ±‚ã€‚æœ‰äº›é¡¹ç›®å¯èƒ½åªéœ€è¦ä¸€ä¸ªç®€å•çš„å±•ç¤ºå±‚å’Œä¸šåŠ¡é€»è¾‘å±‚ï¼Œè€Œæœ‰äº›é¡¹ç›®å¯èƒ½éœ€è¦æ›´å¤šçš„å±‚æ¬¡ï¼Œæ‰èƒ½æ”¯æŒæ›´å¤æ‚çš„ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®ç®¡ç†ã€‚</p><!-- [[[read_end]]] --><p>éšç€é¡¹ç›®å˜å¾—è¶Šæ¥è¶Šåºå¤§ï¼Œç»„ç»‡ç®¡ç†å„ä¸ªæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå›°éš¾ã€‚ä¸ºäº†æ›´å¥½åœ°ç»„ç»‡ä»£ç ï¼Œæˆ‘ä»¬ä¼šç»™æ¯ä¸ªé¡¹ç›®è®¾ç½®è®¸å¤šæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾ä¸åŒçš„å†…å®¹ã€‚</p><p>åœ¨æˆ‘ä»¬çš„åœ¨çº¿ç›´æ’­è§†é¢‘å¹³å°é¡¹ç›®ä¸­ï¼Œè¿™ä¸‰ä¸ªå±‚çº§çš„ä»£ç éƒ½è¦æ”¾åœ¨apiæ–‡ä»¶å¤¹ä¸‹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ˜ç¡®ä¸€ä¸‹æ–‡ä»¶æ¨¡å—å…·ä½“å¦‚ä½•ç®¡ç†ã€‚å‰ç«¯èµ„æºæ”¾åœ¨templatesæ–‡ä»¶å¤¹ä¸‹ï¼ŒORMæ”¾åœ¨modelsæ–‡ä»¶å¤¹ä¸‹ï¼Œåç«¯ä¸šåŠ¡é€»è¾‘å±‚æ”¾åœ¨modulesæ–‡ä»¶å¤¹ä¸‹ï¼Œè€Œæ•°æ®åº“çš„åŸºæœ¬ä¿¡æ¯é…ç½®å°±æ”¾åœ¨configæ–‡ä»¶ä¸­ã€‚</p><h2>æ•°æ®åº“çš„é…ç½®</h2><p>æ¢³ç†å¥½äº†å±‚çº§å…³ç³»ï¼Œæˆ‘ä»¬è¿™å°±ä¸€èµ·æ¥çœ‹çœ‹åœ¨é¡¹ç›®ä¸­å¦‚ä½•å®ç°å¯¹æ•°æ®åº“çš„åº”ç”¨ã€‚</p><h3>æ•°æ®åº“æ ¸å¿ƒé…ç½®é¡¹</h3><p>å‰é¢è¯´äº†ï¼Œæ•°æ®åº“çš„é…ç½®æˆ‘ä»¬è¦å¯¹åº”æ”¾åœ¨configæ–‡ä»¶ä¸‹ã€‚æ‰€ä»¥æˆ‘ä»¬ç¬¬ä¸€æ­¥è¦åšçš„ï¼Œå°±æ˜¯ç›´æ¥åœ¨configæ–‡ä»¶ä¸‹æ–°å»ºconfig.pyã€‚</p><p>ç¬¬äºŒæ­¥å°±æ˜¯é…ç½®æ•°æ®åº“çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ã€‚å…¶ä¸­åŒ…å«æˆ‘ä»¬çš„æ•°æ®åº“IPåœ°å€ã€ç«¯å£ä»¥åŠç”¨æˆ·åå’Œå¯†ç ç­‰ç›¸å…³ä¿¡æ¯ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code class=\"language-python\">connection = pymysql.connect(\n        host='127.0.0.1',  # æ•°æ®åº“IPåœ°å€\n        port=3306,  # ç«¯å£\n        user='root',  # æ•°æ®åº“ç”¨æˆ·å\n        password='flask_project',  # æ•°æ®åº“å¯†ç \n        database='my_project'  # æ•°æ®åº“åç§°\n    )\n</code></pre><p>è¿™é‡Œæˆ‘ä»¬å°†é…ç½®ä¿¡æ¯å°è£…åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯è®©ä»£ç æ›´æ˜“ç»´æŠ¤å’Œåˆ†ç¦»ï¼Œè€Œä¸”è¿™æ ·åšè¿˜èƒ½æ–¹ä¾¿æˆ‘ä»¬é…ç½®ä¸åŒç¯å¢ƒï¼Œæ¯”å¦‚å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒã€‚æ­¤å¤–ä¸ºäº†ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ï¼Œç±»ä¸­è¿˜å¯ä»¥å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚æ•°æ®åº“ç”¨æˆ·åå’Œå¯†ç è¿™äº›ä¿¡æ¯ã€‚</p><p>åé¢æ˜¯å…·ä½“çš„é…ç½®ä»£ç ï¼Œä¾›ä½ å‚è€ƒã€‚</p><pre><code class=\"language-python\">class Config:\n&nbsp; &nbsp; SQL_HOST = '127.0.0.1'\n&nbsp; &nbsp; SQL_USERNAME = 'root'\n&nbsp; &nbsp; SQL_PASSWORD = 'flask_project'\n&nbsp; &nbsp; SQL_PORT = 3306\n&nbsp; &nbsp; SQL_DB = 'my_project'\n&nbsp; &nbsp; JSON_AS_ASCII = False\n&nbsp; &nbsp; # æ•°æ®åº“çš„é…ç½®\n&nbsp; &nbsp; SQLALCHEMY_DATABASE_URI = f\"mysql+pymysql://{SQL_USERNAME}:{SQL_PASSWORD}@{SQL_HOST}:{SQL_PORT}/{SQL_DB}\"\n&nbsp; &nbsp; SQLALCHEMY_TRACK_MODIFICATIONS = False\n</code></pre><p>å¯¹ç…§å‰é¢çš„ä»£ç ï¼Œæˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹è¿™äº›é…ç½®é¡¹çš„å…·ä½“å«ä¹‰ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/bb/af/bb57f167ca2b43373e138831f5da2faf.jpg?wh=3805x2260\" alt=\"\"><br>\næŒæ¡äº†å‰é¢è¿™äº›æ•°æ®åº“æ ¸å¿ƒé…ç½®é¡¹ä¹‹åï¼Œä½ å°±èƒ½è½»æ¾åœ°å®ç°è¿æ¥é…ç½®äº†ã€‚å¸¸è§„çš„å¼€å‘æµç¨‹é‡Œï¼Œé¡¹ç›®åŒ…æ‹¬å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§è¿™ä¸‰ä¸ªé˜¶æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ºäº†é…ç½®çš„æ–¹ä¾¿ï¼Œå¯ä»¥äº‹å…ˆå®šä¹‰å¥½è¿™ä¸‰ä¸ªç±»ã€‚</p><pre><code class=\"language-python\"># å¼€å‘ç¯å¢ƒçš„config\nclass DevConfig(Config):\n    pass\n# ç”Ÿäº§ç¯å¢ƒçš„config\nclass ProConfig(Config):\n    DEBUG = False\n    SQLALCHEMY_DATABASE_URI = \"mysql+pymysql://root:my_project@127.0.0.1:3306/aaa\"\n# æµ‹è¯•ç¯å¢ƒçš„config\nclass TestConfig(Config):\n    pass\nconfig_dict = {\n    'dev': DevConfig,\n    'pro': ProConfig,\n    'test': TestConfig,\n}\n</code></pre><p>è¿™ä¸‰ä¸ªç±»å‡ç»§æ‰¿äº†Configç±»ã€‚åŒæ—¶ï¼Œä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬çš„è½¬æ¢ï¼Œæˆ‘ä»¬è¿˜è¦å®šä¹‰ä¸€ä¸ªå­—å…¸config_dictï¼Œç”¨å®ƒæ¥è®¾ç½®è¿™ä¸‰ä¸ªå­—æ®µã€‚<strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé’ˆå¯¹é¡¹ç›®çš„ä¸åŒé˜¶æ®µï¼Œæ•°æ®åº“ä¸­çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„ï¼Œåªæœ‰è¿™æ ·æˆ‘ä»¬æ‰èƒ½å®ç°å¯¹ä¸åŒé˜¶æ®µä»£ç çš„çµæ´»è°ƒè¯•ã€‚</strong></p><h3>é€šè¿‡SQLAlchemyå®ç°ORMåº”ç”¨</h3><p>æå®šäº†æ•°æ®åº“é…ç½®é¡¹ä¹‹åï¼Œæˆ‘ä»¬ä¸‹é¢å°±é€šè¿‡SQLAlchemyæ¥å®ç°ORMçš„åº”ç”¨ã€‚<a href=\"https://time.geekbang.org/column/article/666523\">ä¸ŠèŠ‚è¯¾</a>è®²è¿‡ï¼ŒQLAlchemyæ˜¯ä¸€ä¸ªPythonç¼–ç¨‹è¯­è¨€ä¸‹çš„SQLå·¥å…·åŒ…å’ŒORMåº“ï¼Œå®ƒæä¾›äº†SQLè¡¨è¾¾å¼æ“ä½œå’ŒORMæ˜ å°„æ“ä½œçš„å·¥å…·ã€‚</p><p>åŒç†ï¼Œåœ¨æˆ‘ä»¬é¡¹ç›®å¼€å‘ä¸­ä¹Ÿæ˜¯ä¸€æ ·çš„æµç¨‹ã€‚æˆ‘ä»¬å…ˆæ¥å®‰è£…SQLAlchemyï¼Œå…·ä½“çš„æ‰§è¡Œå‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code class=\"language-plain\">pip install flask-sqlalchemy\n</code></pre><p>å®‰è£…æˆåŠŸä¹‹åæˆ‘ä»¬è¿˜éœ€è¦å®Œæˆå®ä¾‹åŒ–ï¼Œå®ä¾‹åŒ–ä¹‹åæ‰èƒ½å°†ä¸€äº›å…¨å±€é…ç½®åº”ç”¨åˆ°å…·ä½“çš„æ•°æ®åº“æ“ä½œä¸­ã€‚</p><pre><code class=\"language-python\">from flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\napp = Flask(__name__)\ndb = SQLAlchemy(app)\n</code></pre><p>åœ¨é¡¹ç›®å½“ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬æŠŠdbå’Œappçš„å®ä¾‹åŒ–ï¼Œæ”¾åœ¨apiæ–‡ä»¶å¤¹ä¸‹çš„__init__.pyæ–‡ä»¶ä¸­ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c7/9a/c732e49472f05cb1378e4ac3ddeb509a.jpg?wh=2993x918\" alt=\"\"></p><p>å…·ä½“ä»£ç æ˜¯åé¢è¿™æ ·ï¼Œä½ å¯ä»¥è¾¹çœ‹ä»£ç ï¼Œè¾¹å¬æˆ‘ä¸ºä½ æ¢³ç†è¿™æ®µä»£ç çš„ç”¨é€”ã€‚</p><pre><code class=\"language-python\">from flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\nfrom config.config import config_dict\ndb = SQLAlchemy()\ndef create_app(config_name):\n    app = Flask(__name__)\n    config = config_dict.get(config_name)\n    app.config.from_object(config)\n    db.init_app(app)\n    return app\n</code></pre><p>è¿™æ®µä»£ç æˆ‘ä»¬é‡ç‚¹è¦å…³æ³¨create_appå‡½æ•°ã€‚æˆ‘ä»¬ä¸€èˆ¬æŠŠcreate_appå‡½æ•°ç§°ä¸ºå·¥å‚å‡½æ•°ã€‚åœ¨create_appå‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ªconfig_nameå‚æ•°ï¼Œæ–¹ä¾¿æˆ‘ä»¬åˆ‡æ¢å¼€å‘ã€æµ‹è¯•çš„æ•°æ®åº“é…ç½®ã€‚</p><p>å…¶ä¸­app.config.from_object(config)çš„ä½œç”¨æ˜¯å°†configå¯¹è±¡ä¸­å®šä¹‰çš„é…ç½®å‚æ•°åº”ç”¨åˆ°Flaskåº”ç”¨ç¨‹åºä¸­ï¼ŒåŒ…æ‹¬æ•°æ®åº“è¿æ¥ä¿¡æ¯ã€å¯†é’¥ã€è°ƒè¯•æ¨¡å¼ç­‰ç­‰ã€‚</p><p>db.init_app(app)åˆ™æ˜¯å°†Flaskåº”ç”¨ç¨‹åºå¯¹è±¡ä¼ é€’ç»™SQLAlchemyçš„dbå¯¹è±¡ï¼Œå¹¶ä¸”ç»‘å®šè¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œè¿™æ ·å°±èƒ½é€šè¿‡SQLAlchemyçš„dbå¯¹è±¡æ¥å¤„ç†ä¸æ•°æ®åº“æœ‰å…³çš„æ“ä½œï¼ˆå¦‚åˆ›å»ºæ¨¡å‹ã€æŸ¥è¯¢æ•°æ®ã€æ‰§è¡Œäº‹åŠ¡ç­‰ç­‰ï¼‰äº†ã€‚</p><h2>å»ºç«‹æ•°æ®åº“è¡¨</h2><p>å®Œæˆäº†å‰é¢çš„å„ç§é…ç½®ï¼Œæˆ‘ä»¬è¿™å°±æ¥å»ºç«‹æ•°æ®åº“è¡¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨modelsæ–‡ä»¶å¤¹ä¸­æ–°å»ºä¸€ä¸ªbase.pyæ–‡ä»¶ï¼Œè¿™é‡Œä¸»è¦ç”¨æ¥å­˜æ”¾æˆ‘ä»¬çš„æ¨¡å‹åŸºç±»ã€‚</p><h3></h3><h3>ç±»çš„åˆ›å»º</h3><p>æ¨¡å‹åŸºç±»å¯ä»¥ç”¨äºå®šä¹‰æ•°æ®åº“è¡¨çš„ç»“æ„å’Œå…³ç³»ã€‚åœ¨æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰è¡¨çš„åˆ—ã€ä¸»é”®ã€å¤–é”®ç­‰ï¼Œå¹¶ä½¿ç”¨å…¶æä¾›çš„æ–¹æ³•æ‰§è¡Œæ•°æ®åº“æ“ä½œã€‚è¿™æ ·æ¨¡å‹åŸºç±»å°±å¯ä»¥é€šè¿‡å¯¼å…¥çš„æ–¹å¼ï¼Œè¢«å…¶ä»–æ–‡ä»¶å¼•ç”¨ã€‚å…·ä½“çš„ä»£ç å®ç°æ˜¯åé¢è¿™æ ·ã€‚</p><pre><code class=\"language-python\">from datetime import datetime\nfrom api import db\nclass BaseModels:\n    \"\"\"æ¨¡å‹åŸºç±»\"\"\"\n    create_time = db.Column(db.DateTime, default=datetime.now)  # åˆ›å»ºæ—¶é—´\n    update_time = db.Column(db.DateTime, default=datetime.now, onupdate=datetime.now)  # è®°å½•ä½ çš„æ›´æ–°æ—¶é—´\n    status = db.Column(db.SmallInteger, default=1)  # è®°å½•å­˜æ´»çŠ¶æ€\n</code></pre><p>ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨modelsæ–‡ä»¶ä¸‹æ–°å»ºuser.pyæ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ç”¨æˆ·ä¿¡æ¯è¡¨ã€‚</p><pre><code class=\"language-python\">from api import db\nfrom api.models.base import BaseModels\nclass UserInfo(BaseModels, db.Model):\n    \"\"\"ç”¨æˆ·ä¿¡æ¯è¡¨\"\"\"\n    __tablename__ = \"user_info\"\n    id = db.Column(db.Integer, primary_key=True, autoincrement=True)  # ç”¨æˆ·id\n    nickname = db.Column(db.String(64), nullable=False)  # ç”¨æˆ·æ˜µç§°\n    mobile = db.Column(db.String(16))  # æ‰‹æœºå·\n    avatar_url = db.Column(db.String(256))  # ç”¨æˆ·å¤´åƒè·¯å¾„\n    signature = db.Column(db.String(256))  # ç­¾å\n    sex = db.Column(db.Enum('0', '1', '2'), default='0')  # 1ç”·  2 å¥³ 0 æš‚ä¸å¡«å†™\n    birth_date = db.Column(db.DateTime)  # å‡ºç”Ÿæ—¥æœŸ\n    role_id = db.Column(db.Integer)  # è§’è‰²id\n    last_message_read_time = db.Column(db.DateTime)\n    def to_dict(self):\n        return {\n            'id': self.id,\n            'nickname': self.nickname,\n            'mobile': self.mobile,\n            'avatar_url': self.avatar_url,\n            'sex': self.sex,\n        }\n</code></pre><p>è¿™é‡Œçš„to_dictå‡½æ•°å¯ä»¥å°† UserInfo å¯¹è±¡åºåˆ—åŒ–ä¸º JSON æ•°æ®ï¼Œè¿™æ ·å°±èƒ½åœ¨æŸ¥è¯¢æ—¶å°†æŸ¥è¯¢åˆ°çš„æ•°æ®æ”¾åœ¨ Flask çš„å“åº”ä¸­ã€‚è¿™é‡Œçš„å­¦ä¹ é‡ç‚¹å°±æ˜¯æŒæ¡åˆ›å»ºæ–¹æ³•ï¼Œåé¢éšç€é¡¹ç›®çš„æ·±å…¥ï¼Œæˆ‘ä»¬è¿˜ä¼šæ ¹æ®é¡¹ç›®è§„æ¨¡åœ¨modelsæ–‡ä»¶ä¸‹çµæ´»æ·»åŠ å…¶ä»–çš„æ–‡ä»¶ã€‚</p><h3>ç”Ÿæˆæ•°æ®åº“è¡¨</h3><p>åœ¨åˆ›å»ºæ•°æ®åº“è¡¨ç±»ä¹‹åï¼Œæ•°æ®åº“è¡¨çš„åˆ›å»ºè¿˜å·®æœ€åä¸€ä¸ªç¯èŠ‚â€”â€”æ‰§è¡Œä»£ç ç”Ÿæˆæ•°æ®åº“è¡¨ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ–°å»ºapp.pyæ–‡ä»¶ã€‚app.pyæ–‡ä»¶èƒ½å°†å¤šä¸ªFlaskè„šæœ¬æ•´åˆåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œç®€åŒ–Flaskåº”ç”¨ç¨‹åºçš„ç®¡ç†å’Œéƒ¨ç½²ã€‚</p><p>æˆ‘ä»¬åªè¦åœ¨app.pyæ–‡ä»¶ä¸‹åšå¥½ç›¸å…³å‡½æ•°çš„å¯¼å…¥å’Œåˆå§‹åŒ–å·¥ä½œï¼Œå°±å¯ä»¥æŠŠapp.pyä½œä¸ºFlaskçš„å‘½ä»¤è¡Œæ¥å£ï¼Œé€šè¿‡å®ƒè¿è¡Œä¸åŒçš„Flaskå‘½ä»¤ï¼Œé«˜æ•ˆå®Œæˆæ•°æ®åº“è¿ç§»ã€åˆ›å»ºè¶…çº§ç”¨æˆ·ã€å¯¼å‡ºæ•°æ®ç­‰æ“ä½œã€‚</p><p>ç´§æ¥ç€ï¼Œæˆ‘ä»¬éœ€è¦åœ¨apiæ–‡ä»¶ä¸­å¯¼å…¥dbå’Œcreate_appå·¥å‚å‡½æ•°ã€‚</p><pre><code class=\"language-python\">from api import db, create_app\nfrom flask_script import Manager\nfrom flask_migrate import Migrate\napp = create_app('dev')\n# ç®¡ç†å™¨å¯¹è±¡å¯ä»¥ç”¨æ¥æä¾›å„ç§ç®¡ç†å‘½ä»¤ï¼Œä¾‹å¦‚å¯åŠ¨åº”ç”¨ç¨‹åºã€åˆ›å»ºæ•°æ®åº“è¡¨ã€å¯¼å…¥æ•°æ®ç­‰ç­‰\nmanager = Manager(app)\nMigrate(app, db)\ndef create_db():\n&nbsp; &nbsp; db.create_all()\nif __name__ == '__main__':\n    manager.run()\n</code></pre><p>å¯¹ç…§å‰é¢çš„ä»£ç ï¼Œæˆ‘æ¥è®²è§£ä¸€ä¸‹é‡ç‚¹ã€‚æˆ‘ä»¬å¯¼å…¥äº†æ‰€éœ€çš„åº“å’Œæ¨¡å—ã€‚api&nbsp;æ¨¡å—ä¸­åŒ…å«äº† Flask åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“è¿æ¥ï¼Œcreate_app&nbsp;å‡½æ•°ç”¨æ¥åˆ›å»ºåº”ç”¨ç¨‹åºå®ä¾‹ï¼ŒManager&nbsp;ç±»ç”¨äºåˆ›å»ºç®¡ç†å‘½ä»¤çš„å¯¹è±¡ï¼ŒMigrate&nbsp;ç±»ç”¨äºå¤„ç†æ•°æ®åº“è¿ç§»ã€‚</p><p>ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨&nbsp;create_app&nbsp;å‡½æ•°åˆ›å»ºä¸€ä¸ªåä¸º&nbsp;dev&nbsp;çš„å¼€å‘ç¯å¢ƒåº”ç”¨ç¨‹åºå®ä¾‹ã€‚åŒæ—¶ä½¿ç”¨&nbsp;Manager&nbsp;ç±»åˆ›å»ºä¸€ä¸ªåä¸º&nbsp;manager&nbsp;çš„ç®¡ç†å‘½ä»¤å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥ç”¨æ¥æä¾›å„ç§ç®¡ç†å‘½ä»¤ï¼Œä¾‹å¦‚å¯åŠ¨åº”ç”¨ç¨‹åºã€åˆ›å»ºæ•°æ®åº“è¡¨ã€å¯¼å…¥æ•°æ®ç­‰ç­‰ã€‚</p><p>ç¬¬ä¸ƒè¡Œä»£ç è¡¨ç¤ºæˆ‘ä»¬ç”¨Migrate&nbsp;ç±»æ¥åˆå§‹åŒ– Flask-Migrateï¼Œç›®çš„æ˜¯æ–¹ä¾¿å¤„ç†æ•°æ®åº“è¿ç§»ã€‚</p><p>ä¹‹åç¬¬å…«è¡Œä»£ç ç”¨åˆ°äº†create_db&nbsp;å‡½æ•°ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ä½¿ç”¨&nbsp;db.create_all()&nbsp;æ–¹æ³•åˆ›å»ºæ‰€æœ‰å®šä¹‰çš„æ•°æ®åº“è¡¨ã€‚</p><p>æœ€åæ˜¯ç¬¬åä¸€è¡Œä»£ç ï¼Œæˆ‘ä»¬åœ¨ä¸»ç¨‹åºä¸­ï¼Œä½¿ç”¨&nbsp;manager.run()&nbsp;æ–¹æ³•è¿è¡Œç®¡ç†å‘½ä»¤å¯¹è±¡ï¼Œç›®çš„æ˜¯å¯åŠ¨åº”ç”¨ç¨‹åºå¹¶ç›‘å¬ç®¡ç†å‘½ä»¤ã€‚</p><p>ç†è§£äº†å‰é¢è¿™äº›æ‰§è¡Œä»£ç åï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç”Ÿæˆmigrations æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿åé¢å˜æ›´å’Œç®¡ç†æ•°æ®åº“ç»“æ„ï¼Œé˜²æ­¢å‡ºç°è¯¯æ“ä½œæˆ–å¼‚å¸¸æ“ä½œã€‚æ‰§è¡Œå‘½ä»¤å’Œå¯¹åº”çš„æ‰§è¡Œæ•ˆæœå›¾æ˜¯åé¢è¿™æ ·ã€‚æ‰§è¡Œåé¢çš„è¯­å¥åï¼Œå°±ä¼šè‡ªåŠ¨ç”Ÿæˆmigrationsæ–‡ä»¶å¤¹ã€‚</p><pre><code class=\"language-python\">flask db init\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/97/a9/97a445668b832e2945eae6f4f58f75a9.jpg?wh=2993x551\" alt=\"\"></p><p>æ–‡ä»¶å¤¹ä¸­åŒ…å«æ–‡ä»¶versionsï¼Œæœªæ¥æ¯æ¬¡ä¿®æ”¹æ•°æ®åº“è¡¨ç»“æ„æ—¶ï¼Œè¿™ä¸ªæ–‡ä»¶éƒ½ä¼šç”Ÿæˆä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œç”¨æ¥è®°å½•æ¯æ¬¡æ•°æ®åº“è¡¨çš„å˜åŒ–ã€‚å…¶ä»–çš„æ–‡ä»¶éƒ½æ˜¯ä¸€äº›é…ç½®æ–‡ä»¶ï¼Œä½ æš‚æ—¶ä¸éœ€è¦å…³å¿ƒã€‚</p><p>è‡ªåŠ¨ç”Ÿæˆmigrationsæ–‡ä»¶å¤¹åï¼Œæˆ‘ä»¬è¿˜è¦åœ¨ç»ˆç«¯ä¸­è¾“å…¥åé¢çš„å‘½ä»¤ï¼Œå‘½ä»¤çš„ä½œç”¨ä½ å¯ä»¥å‚è€ƒä»£ç æ³¨é‡Šã€‚</p><pre><code class=\"language-python\">flask db migrate&nbsp; # â½£æˆè¿ç§»ç‰ˆæœ¬, ä¿å­˜åˆ°è¿ç§»æ–‡ä»¶å¤¹ä¸­\nflask db upgrade&nbsp; # æ‰§ï¨ˆè¿ç§»\n</code></pre><p>å‘½ä»¤è¾“å…¥åï¼Œæˆ‘ä»¬æ‰“å¼€Navicatï¼Œå°±ä¼šå‘ç°my_projectæ•°æ®åº“ä¸­å¤šå‡ºäº†ä¸€ä¸ªalembic_versionæ•°æ®åº“è¡¨ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/8c/99/8cc8b5e4469b7531d8885c73920f0799.jpg?wh=2900x667\" alt=\"\"></p><p>è¿™ä¸ªè¡¨ä¸­åªæœ‰ä¸€ä¸ªå­—æ®µï¼Œæ˜¯ç”¨æ¥å­˜å‚¨ç‰ˆæœ¬å·ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥è¯¢alembic_versionè¡¨çš„ç‰ˆæœ¬å·æ¥ç¡®å®šå½“å‰æ•°æ®åº“æ‰€å¤„çš„çŠ¶æ€ã€‚æ­¤å¤–ï¼Œalembic_versionè¡¨è¿˜å¯ä»¥ç”¨äºåœ¨ä¸åŒç‰ˆæœ¬ä¹‹é—´å®ç°æ•°æ®åº“è¿ç§»æ“ä½œã€‚</p><p>å®Œæˆå‰é¢è¿™äº›åˆæ­¥æ“ä½œä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦åˆ›å»ºuser_infoæ•°æ®åº“è¡¨ã€‚å…·ä½“æ“ä½œå°±æ˜¯åœ¨pycharmçš„Terminalç»ˆç«¯ï¼Œè¾“å…¥åé¢çš„å‘½ä»¤ã€‚</p><pre><code class=\"language-python\">flask shell\ndb.create_all()\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/2d/f4/2d9109cc36f0ef3a1d03a2c812a740f4.png?wh=1870x293\" alt=\"å›¾ç‰‡\"></p><p>è¿™é‡Œæˆ‘ä»¬è¾“å…¥Flask Shellï¼Œå°±ä¼šè¿›å…¥ä¸€ä¸ªäº¤äº’å¼çš„Pythonç¼–ç¨‹ï¼Œè‡ªç”±ä½¿ç”¨æ‰€æœ‰çš„Flaskåº”ç”¨ç¨‹åºä¸­å®šä¹‰çš„å˜é‡ã€å‡½æ•°å’Œå¯¹è±¡ä»¥åŠæ•°æ®åº“æ¨¡å‹ã€è·¯ç”±å’Œè§†å›¾å‡½æ•°ç­‰ç­‰ã€‚è¿™ä¸ªç¯èŠ‚ä¸€èˆ¬ç”¨æ¥æµ‹è¯•å’Œè°ƒè¯•åº”ç”¨ç¨‹åºã€‚</p><p>è¿›å…¥äº¤äº’å¼å‘½ä»¤åï¼Œè¿˜éœ€è¦è¾“å…¥db.create_all()æ¥åˆ›å»ºæ‰€æœ‰çš„æ•°æ®åº“è¡¨ã€‚æ‰§è¡Œå®Œæˆåï¼Œåªéœ€è¦Ctrl+Zé€€å‡ºæ‰§è¡Œå³å¯ã€‚æ­¤æ—¶æˆ‘ä»¬å†æ¬¡æ‰“å¼€Navicatï¼Œå°±ä¼šçœ‹åˆ°æ•°æ®åº“è¡¨user_infoå·²ç»åˆ›å»ºå¥½äº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/86/c3/865250224909a327b081e3992a2053c3.jpg?wh=2313x1221\" alt=\"\"></p><p>ä¸è¿‡ä»”ç»†çœ‹ä¸€ä¸‹å°±ä¼šå‘ç°ï¼Œæ­¤æ—¶user_infoä¸­è¿˜æ²¡æœ‰ä»»ä½•ä¿¡æ¯ï¼Œå› ä¸ºæˆ‘ä»¬ç›®å‰åªå®Œæˆäº†è¡¨çš„åˆ›å»ºï¼Œè¿˜æ²¡æœ‰æ–°å¢æ•°æ®ï¼Œè¿™éƒ¨åˆ†å†…å®¹ä¸‹èŠ‚è¯¾æˆ‘ä»¬å†ç»§ç»­æ¢ç´¢ã€‚</p><h2>æ€»ç»“</h2><p>åˆåˆ°äº†è¯¾ç¨‹çš„å°¾å£°ï¼Œæˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ä»Šå¤©çš„å­¦ä¹ é‡ç‚¹ã€‚</p><p>æƒ³è¦åœ¨é¡¹ç›®ä¸­çµæ´»åº”ç”¨æ•°æ®åº“ï¼Œç†Ÿæ‚‰é¡¹ç›®å±‚çº§æ¡†æ¶å¹¶åšå¥½æ¯ä¸ªæ¨¡å—çš„é…ç½®ç®¡ç†è¿™äº›å‡†å¤‡æ­¥éª¤éå¸¸é‡è¦ã€‚é€šå¸¸ä¸€ä¸ª Flask&nbsp;é¡¹ç›®ä¼šåˆ†æˆä¸‰å±‚ï¼šå‰ç«¯å±•ç¤ºå±‚ã€åç«¯ä¸šåŠ¡é€»è¾‘å±‚å’Œæ•°æ®åº“å±‚ï¼Œæ˜ç¡®äº†å®ƒä»¬çš„ä½œç”¨ï¼Œæˆ‘ä»¬æ‰èƒ½æ›´å¥½åœ°ç®¡ç†é¡¹ç›®ã€‚</p><p>å¯¹æ¯”å‰é¢è¯¾ç¨‹çš„å•ç‚¹å®è·µï¼Œä½ ä¼šå‘ç°ä»Šå¤©åœ¨æ•°æ®åº“é…ç½®é˜¶æ®µï¼Œæœ‰äº›é…ç½®å­˜åœ¨ä¸€äº›ç»†å¾®å˜åŠ¨ï¼Œè¿™äº›åªæœ‰è½åœ°é¡¹ç›®çš„æ—¶å€™æ‰èƒ½æ„Ÿå—åˆ°ã€‚è¿™ä¸ªè¿‡ç¨‹ä½ éœ€è¦é‡ç‚¹å…³æ³¨create_appå‡½æ•°çš„ç”¨æ³•ï¼Œå°¤å…¶æ˜¯å…¶ä¸­å„ä¸ªå‚æ•°çš„ä½œç”¨ï¼Œè¿™æ ·æ‰èƒ½é«˜æ•ˆé…ç½®æ•°æ®åº“ã€‚</p><p>å¦ä¸€ä¸ªå­¦ä¹ é‡ç‚¹å°±æ˜¯æ•°æ®åº“è¡¨å»ºç«‹ã€‚ç»“åˆuser.pyæ–‡ä»¶çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•é€šè¿‡db.Modelæ¨¡å‹åŸºç±»ä¸­çš„db.Columnç±»åˆ›å»ºæ•°æ®åº“ã€‚ä½ éœ€è¦æ˜ç¡®app.pyæ–‡ä»¶åœ¨é¡¹ç›®ä¸­çš„å®šä½å’Œä½œç”¨ï¼Œå¹¶ä¸”ç‰¢ç‰¢æŒæ¡æ•°æ®åº“è¡¨åˆ›å»ºçš„å®ç°ä»£ç ï¼ŒæŠŠæ¡å…¶æ€è·¯ï¼Œè¿™æ ·æ‰èƒ½ä»å®¹åº”å¯¹ç±»ä¼¼çš„å»ºè¡¨éœ€æ±‚ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>Flaské¡¹ç›®å¼€å‘åŒ…æ‹¬å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§è¿™ä¸‰ä¸ªé˜¶æ®µï¼Œä½ è§‰å¾—æ˜¯å¦éœ€è¦å¯¹åº”æœ‰ä¸‰ä¸ªæ•°æ®åº“æ¥æ”¯æ’‘å¼€å‘ï¼Ÿè¿˜æ˜¯è¯´å•ä¸ªæ•°æ®åº“å°±å¯ä»¥æ»¡è¶³ï¼Ÿ</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€åŒºå’Œæˆ‘äº¤æµäº’åŠ¨ï¼Œå¦‚æœè¿™èŠ‚è¯¾çš„å†…å®¹å¯¹ä½ æœ‰å¸®åŠ©ï¼Œåˆ«å¿˜äº†åˆ†äº«ç»™èº«è¾¹æ›´å¤šæœ‹å‹ã€‚</p>","neighbors":{"left":{"article_title":"22ï½œæ•°æ®åº“åº”ç”¨ï¼ˆäºŒï¼‰ï¼šæ•°æ®åº“ORMå¯¹è±¡å…³ç³»æ˜ å°„","id":666523},"right":{"article_title":"24ï½œæ•°æ®åº“åº”ç”¨ï¼ˆå››ï¼‰ï¼šå¦‚ä½•åœ¨é¡¹ç›®ä¸­çµæ´»åº”ç”¨æ•°æ®åº“æ“ä½œ","id":667908}},"comments":[{"had_liked":false,"id":376685,"user_name":"é•¿æ—å•Š","can_delete":false,"product_type":"c1","uid":1707743,"ip_address":"å››å·","ucode":"B75CB4919FF25A","user_header":"https://static001.geekbang.org/account/avatar/00/1a/0e/df/a64b3146.jpg","comment_is_top":false,"comment_ctime":1687222022,"is_pvip":false,"replies":[{"id":137315,"content":"æ€»ç»“çš„éå¸¸å‡†ç¡®ï¼Œæ„Ÿè°¢åˆ†äº«ï¼Œä¸ºä½ ç‚¹èµï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1687238251,"ip_address":"åŒ—äº¬","comment_id":376685,"utype":1}],"discussion_count":1,"race_medal":1,"score":2,"product_id":100546501,"comment_content":"åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œç”Ÿäº§ç¯å¢ƒçš„æ•°æ®åº“è‚¯å®šæ˜¯ç‹¬ç«‹çš„ï¼Œå¼€å‘å’Œæµ‹è¯•å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªæ•°æ®åº“ï¼›åœ¨å¼€å‘å’Œæµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œä¼šæ·»åŠ å¾ˆå¤šæµ‹è¯•æ•°æ®ï¼Œå¯¹äºç”Ÿäº§ç¯å¢ƒè€Œè¨€ï¼Œè¿™éƒ¨åˆ†æ˜¯è„æ•°æ®ä¸”æ²¡æœ‰ä»»ä½•å®é™…æ„ä¹‰","like_count":1,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621442,"discussion_content":"æ€»ç»“çš„éå¸¸å‡†ç¡®ï¼Œæ„Ÿè°¢åˆ†äº«ï¼Œä¸ºä½ ç‚¹èµï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687238252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":390546,"user_name":"Geek_7e5830","can_delete":false,"product_type":"c1","uid":3622505,"ip_address":"ç¦å»º","ucode":"73249AF61A0D16","user_header":"","comment_is_top":false,"comment_ctime":1715610488,"is_pvip":false,"replies":[{"id":142621,"content":"ä½ é‡åˆ°çš„é”™è¯¯ç¡®å®æ˜¯å› ä¸ºåœ¨ Python 3.8 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œtime æ¨¡å—ä¸­çš„ time.clock() æ–¹æ³•å·²ç»è¢«ç§»é™¤ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥æµ‹é‡ CPU æ—¶é—´çš„ï¼Œä½†åœ¨ Python 3.3 åå°±è¢«æ ‡è®°ä¸ºå·²å¼ƒç”¨ï¼ˆdeprecatedï¼‰ï¼Œå¹¶åœ¨ Python 3.8 ä¸­å®Œå…¨ç§»é™¤ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ä½œè€…","uid":3050845,"ctime":1720771936,"ip_address":"åŒ—äº¬","comment_id":390546,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100546501,"comment_content":"å¥½åƒpython3.8ä»¥ä¸Šä¼šæŠ¥  from flask_sqlalchemy import SQLAlchemy\n  File &quot;C:\\PythonEnv\\VideoPlateform\\.venv\\Lib\\site-packages\\flask_sqlalchemy\\__init__.py&quot;, line 39, in &lt;module&gt;\n    _timer = time.clock\n             ^^^^^^^^^^\nAttributeError: module &#39;time&#39; has no attribute &#39;clock&#39;é”™è¯¯ã€‚ Python 3.8 ç‰ˆæœ¬ä¸­ç§»é™¤äº† time æ¨¡å—ä¸­çš„ time.clock() æ–¹æ³•ã€‚","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647914,"discussion_content":"ä½ é‡åˆ°çš„é”™è¯¯ç¡®å®æ˜¯å› ä¸ºåœ¨ Python 3.8 åŠä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œtime æ¨¡å—ä¸­çš„ time.clock() æ–¹æ³•å·²ç»è¢«ç§»é™¤ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯ç”¨æ¥æµ‹é‡ CPU æ—¶é—´çš„ï¼Œä½†åœ¨ Python 3.3 åå°±è¢«æ ‡è®°ä¸ºå·²å¼ƒç”¨ï¼ˆdeprecatedï¼‰ï¼Œå¹¶åœ¨ Python 3.8 ä¸­å®Œå…¨ç§»é™¤ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1720771936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386769,"user_name":"lightwolf","can_delete":false,"product_type":"c1","uid":3229927,"ip_address":"å®‰å¾½","ucode":"9F4E0F742C174D","user_header":"https://static001.geekbang.org/account/avatar/00/31/48/e7/958b7e6c.jpg","comment_is_top":false,"comment_ctime":1705505833,"is_pvip":false,"replies":[{"id":141136,"content":"è¿™ä¸ªéœ€è¦æ£€æŸ¥ä¸€ä¸‹ï¼Œç¡®ä¿ä½ ä½¿ç”¨çš„æ•°æ®åº“å¼•æ“æ”¯æŒ Flask-SQLAlchemyã€‚ä¾‹å¦‚ï¼ŒSQLite æ•°æ®åº“åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¸ä¼šç«‹å³æ˜¾ç¤ºæ–°åˆ›å»ºçš„è¡¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1707041416,"ip_address":"åŒ—äº¬","comment_id":386769,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100546501,"comment_content":"è€å¸ˆéƒ½æ­£å¸¸æ‰§è¡Œäº†, ä½†æ˜¯æ‰§è¡Œå®Œæˆdb.create_all()ä¹‹å, æ•°æ®åº“ä¸­ä¸ºä»€ä¹ˆæ²¡æœ‰è¡¨","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636801,"discussion_content":"è¿™ä¸ªéœ€è¦æ£€æŸ¥ä¸€ä¸‹ï¼Œç¡®ä¿ä½ ä½¿ç”¨çš„æ•°æ®åº“å¼•æ“æ”¯æŒ Flask-SQLAlchemyã€‚ä¾‹å¦‚ï¼ŒSQLite æ•°æ®åº“åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¸ä¼šç«‹å³æ˜¾ç¤ºæ–°åˆ›å»ºçš„è¡¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1707041416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3229927,"avatar":"https://static001.geekbang.org/account/avatar/00/31/48/e7/958b7e6c.jpg","nickname":"lightwolf","note":"","ucode":"9F4E0F742C174D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636041,"discussion_content":"å·²ç»æ‰¾åˆ°åŸå› : https://blog.csdn.net/weixin_40283460/article/details/115029103ï¼Œæ˜¯å› ä¸ºå°†modelså•ç‹¬æ”¾åœ¨äº†ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢, å¦‚æœä½¿ç”¨create_allï¼Œ éœ€è¦åœ¨ä½¿ç”¨dbçš„æ–‡ä»¶ä¸­å¯¼å…¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705506200,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å®‰å¾½","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386611,"user_name":"Geek_d26f93","can_delete":false,"product_type":"c1","uid":3738959,"ip_address":"å†…è’™å¤","ucode":"D5C89ADCA3E877","user_header":"","comment_is_top":false,"comment_ctime":1705212647,"is_pvip":false,"replies":[{"id":141137,"content":"ä½ çš„ Flask-SQLAlchemy é…ç½®ä¸­ï¼Œå¿…é¡»è®¾ç½® SQLALCHEMY_DATABASE_URI æˆ– SQLALCHEMY_BINDS ä¸­çš„ä¸€ä¸ªã€‚å¦‚æœä½ æƒ³ä½¿ç”¨ SQLALCHEMY_BINDSï¼Œä½ å¯ä»¥åƒè¿™æ ·è®¾ç½®ï¼š\nfrom flask import Flask  \nfrom flask_sqlalchemy import SQLAlchemy  \n  \napp = Flask(__name__)  \napp.config[&#39;SQLALCHEMY_BINDS&#39;] = {&#39;other&#39;: &#39;sqlite:&#47;&#47;&#47;&#47;tmp&#47;other.db&#39;}  # è¯·æ›¿æ¢ä¸ºä½ çš„æ•°æ®åº“ URI  \ndb = SQLAlchemy(app)\nother æ˜¯æ•°æ®åº“çš„åˆ«åï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªåˆ«åæ¥è®¿é—®è¿™ä¸ªæ•°æ®åº“ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1707041547,"ip_address":"åŒ—äº¬","comment_id":386611,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100546501,"comment_content":"   raise RuntimeError(\nRuntimeError: Either &#39;SQLALCHEMY_DATABASE_URI&#39; or &#39;SQLALCHEMY_BINDS&#39; must be set.è¿™ä¸ªé”™è¯¯æ€ä¹ˆåŠ\n","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636802,"discussion_content":"ä½ çš„ Flask-SQLAlchemy é…ç½®ä¸­ï¼Œå¿…é¡»è®¾ç½® SQLALCHEMY_DATABASE_URI æˆ– SQLALCHEMY_BINDS ä¸­çš„ä¸€ä¸ªã€‚å¦‚æœä½ æƒ³ä½¿ç”¨ SQLALCHEMY_BINDSï¼Œä½ å¯ä»¥åƒè¿™æ ·è®¾ç½®ï¼š\nfrom flask import Flask  \nfrom flask_sqlalchemy import SQLAlchemy  \n  \napp = Flask(__name__)  \napp.config[&#39;SQLALCHEMY_BINDS&#39;] = {&#39;other&#39;: &#39;sqlite:////tmp/other.db&#39;}  # è¯·æ›¿æ¢ä¸ºä½ çš„æ•°æ®åº“ URI  \ndb = SQLAlchemy(app)\nother æ˜¯æ•°æ®åº“çš„åˆ«åï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªåˆ«åæ¥è®¿é—®è¿™ä¸ªæ•°æ®åº“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1707041547,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":386584,"user_name":"Geek_d26f93","can_delete":false,"product_type":"c1","uid":3738959,"ip_address":"å†…è’™å¤","ucode":"D5C89ADCA3E877","user_header":"","comment_is_top":false,"comment_ctime":1705146615,"is_pvip":false,"replies":[{"id":141138,"content":"ä»ä½ ç»™å‡ºçš„é”™è¯¯ä¿¡æ¯æ¥çœ‹ï¼Œé—®é¢˜å‡ºç°åœ¨ä½ å°è¯•ä»flask_scriptæ¨¡å—å¯¼å…¥Manageræ—¶ã€‚é”™è¯¯ä¿¡æ¯æ˜¾ç¤ºï¼ŒPythonæ— æ³•æ‰¾åˆ°åä¸ºflask._compatçš„æ¨¡å—ã€‚\n\nè¿™ä¸ªé—®é¢˜å¯èƒ½æ˜¯ç”±äºä½ ä½¿ç”¨çš„Flaskç‰ˆæœ¬ä¸Flask-Scriptç‰ˆæœ¬ä¸å…¼å®¹å¯¼è‡´çš„ã€‚flask._compatæ˜¯åœ¨Flask 1.0ä¹‹åè¢«ç§»é™¤çš„ï¼Œè€ŒFlask-Script 2.0åŠæ›´é«˜ç‰ˆæœ¬éœ€è¦Flask 1.0æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1707041623,"ip_address":"åŒ—äº¬","comment_id":386584,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100546501,"comment_content":"Traceback (most recent call last):\n  File &quot;D:\\environment\\Python\\Miniconda3\\envs\\venv2\\lib\\site-packages\\flask\\cli.py&quot;, line 219, in locate_app\n    __import__(module_name)\n  File &quot;D:\\environment\\Python\\pythonProject\\First_Flask\\app.py&quot;, line 2, in &lt;module&gt;\n    from flask_script import Manager\n  File &quot;D:\\environment\\Python\\Miniconda3\\envs\\venv2\\lib\\site-packages\\flask_script\\__init__.py&quot;, line 15, in &lt;module&gt;\n    from flask._compat import text_type\nModuleNotFoundError: No module named &#39;flask._compat&#39; è¯·é—®æˆ‘ä»£ç é—æ¼äº†å“ªéƒ¨åˆ†ä¼šå‡ºç°è¿™ä¸ªé”™è¯¯\n","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636803,"discussion_content":"ä»ä½ ç»™å‡ºçš„é”™è¯¯ä¿¡æ¯æ¥çœ‹ï¼Œé—®é¢˜å‡ºç°åœ¨ä½ å°è¯•ä»flask_scriptæ¨¡å—å¯¼å…¥Manageræ—¶ã€‚é”™è¯¯ä¿¡æ¯æ˜¾ç¤ºï¼ŒPythonæ— æ³•æ‰¾åˆ°åä¸ºflask._compatçš„æ¨¡å—ã€‚\n\nè¿™ä¸ªé—®é¢˜å¯èƒ½æ˜¯ç”±äºä½ ä½¿ç”¨çš„Flaskç‰ˆæœ¬ä¸Flask-Scriptç‰ˆæœ¬ä¸å…¼å®¹å¯¼è‡´çš„ã€‚flask._compatæ˜¯åœ¨Flask 1.0ä¹‹åè¢«ç§»é™¤çš„ï¼Œè€ŒFlask-Script 2.0åŠæ›´é«˜ç‰ˆæœ¬éœ€è¦Flask 1.0æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1707041623,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383108,"user_name":"Aegean Sea","can_delete":false,"product_type":"c1","uid":3688848,"ip_address":"å¹¿ä¸œ","ucode":"0C6F23AEAC6E07","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELrxUK36wj3AesBNLK4tPibu7URiaI48cMWho2t8bfZOyfYDnQwQu2TTXibIbGVZ8DkPhNXDGr7VTfOJv1R1ccw1KBv5qfbq1bYvDhL1MtAVjISA/132","comment_is_top":false,"comment_ctime":1698431345,"is_pvip":false,"replies":[{"id":139595,"content":"è¿™ä¸ªæ˜¯ä½ ç¼ºå¤±db,ä½ çš„ä»£ç æœ‰é—æ¼ï¼Œæ‰¾ä¸åˆ°å°±ä¼šæŠ¥é”™ï¼š\nå®‰è£…æˆåŠŸä¹‹åæˆ‘ä»¬è¿˜éœ€è¦å®Œæˆå®ä¾‹åŒ–ï¼Œå®ä¾‹åŒ–ä¹‹åæ‰èƒ½å°†ä¸€äº›å…¨å±€é…ç½®åº”ç”¨åˆ°å…·ä½“çš„æ•°æ®åº“æ“ä½œä¸­ã€‚:\nfrom flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\napp = Flask(__name__)\ndb = SQLAlchemy(app)\n\nä»è¿™ä¸€éƒ¨åˆ†å¾€ä¸‹é¡ºã€‚\n","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1698734298,"ip_address":"åŒ—äº¬","comment_id":383108,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100546501,"comment_content":"(venv2) PS D:\\environment\\Python\\pythonProject\\First_Flask&gt; flask db init\nError: While importing &#39;app&#39;, an ImportError was raised:\n\nTraceback (most recent call last):\n  File &quot;D:\\environment\\Python\\Miniconda3\\envs\\venv2\\lib\\site-packages\\flask\\cli.py&quot;, line 219, in locate_app\n    __import__(module_name)\n  File &quot;D:\\environment\\Python\\pythonProject\\First_Flask\\app.py&quot;, line 2, in &lt;module&gt;\n    from flask_script import Manager\n  File &quot;D:\\environment\\Python\\Miniconda3\\envs\\venv2\\lib\\site-packages\\flask_script\\__init__.py&quot;, line 15, in &lt;module&gt;\n    from flask._compat import text_type\nModuleNotFoundError: No module named &#39;flask._compat&#39;\n\n\nUsage: flask [OPTIONS] COMMAND [ARGS]...\nTry &#39;flask --help&#39; for help.\n\nError: No such command &#39;db&#39;.\nè€å¸ˆæ±‚è§£ï¼Œè¯•äº†å¾ˆå¤šæ–¹æ³•éƒ½è¡Œä¸é€š","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630612,"discussion_content":"è¿™ä¸ªæ˜¯ä½ ç¼ºå¤±db,ä½ çš„ä»£ç æœ‰é—æ¼ï¼Œæ‰¾ä¸åˆ°å°±ä¼šæŠ¥é”™ï¼š\nå®‰è£…æˆåŠŸä¹‹åæˆ‘ä»¬è¿˜éœ€è¦å®Œæˆå®ä¾‹åŒ–ï¼Œå®ä¾‹åŒ–ä¹‹åæ‰èƒ½å°†ä¸€äº›å…¨å±€é…ç½®åº”ç”¨åˆ°å…·ä½“çš„æ•°æ®åº“æ“ä½œä¸­ã€‚:\nfrom flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\napp = Flask(__name__)\ndb = SQLAlchemy(app)\n\nä»è¿™ä¸€éƒ¨åˆ†å¾€ä¸‹é¡ºã€‚\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698734299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383107,"user_name":"Aegean Sea","can_delete":false,"product_type":"c1","uid":3688848,"ip_address":"å¹¿ä¸œ","ucode":"0C6F23AEAC6E07","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELrxUK36wj3AesBNLK4tPibu7URiaI48cMWho2t8bfZOyfYDnQwQu2TTXibIbGVZ8DkPhNXDGr7VTfOJv1R1ccw1KBv5qfbq1bYvDhL1MtAVjISA/132","comment_is_top":false,"comment_ctime":1698431200,"is_pvip":false,"replies":[{"id":139593,"content":"ä½ çš„ä»£ç å†™çš„ä¸å…¨ï¼Œdbæ‰¾ä¸åˆ°ï¼Œä½ ä¼šå‘ç°æˆ‘åœ¨åœ°ä¸‹å†™çš„ä»£ç ä¸­æœ‰ï¼š\nfrom flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\napp = Flask(__name__)\ndb = SQLAlchemy(app)ã€‚ &#47;&#47;è¿™ä¸ªéœ€è¦æœ‰\nä½ ç¼ºå¤±è¿™éƒ¨åˆ†ï¼Œéœ€è¦è¡¥å……ä¸Š","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1698733861,"ip_address":"åŒ—äº¬","comment_id":383107,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100546501,"comment_content":"ModuleNotFoundError: No module named &#39;flask._compat&#39;\nUsage: flask [OPTIONS] COMMAND [ARGS]...\nTry &#39;flask --help&#39; for help.\n\nError: No such command &#39;db&#39;.\nè€å¸ˆæ±‚è§£ã€‚è¯•äº†å¾ˆå¤šæ–¹æ³•è¡Œä¸é€š\n","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630610,"discussion_content":"ä½ çš„ä»£ç å†™çš„ä¸å…¨ï¼Œdbæ‰¾ä¸åˆ°ï¼Œä½ ä¼šå‘ç°æˆ‘åœ¨åœ°ä¸‹å†™çš„ä»£ç ä¸­æœ‰ï¼š\nfrom flask import Flask\nfrom flask_sqlalchemy import SQLAlchemy\napp = Flask(__name__)\ndb = SQLAlchemy(app)ã€‚ //è¿™ä¸ªéœ€è¦æœ‰\nä½ ç¼ºå¤±è¿™éƒ¨åˆ†ï¼Œéœ€è¦è¡¥å……ä¸Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698733861,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382632,"user_name":"Geek_00c9c4","can_delete":false,"product_type":"c1","uid":2290434,"ip_address":"ä¸Šæµ·","ucode":"249ACAE2F5F381","user_header":"https://static001.geekbang.org/account/avatar/00/22/f3/02/cbad4037.jpg","comment_is_top":false,"comment_ctime":1697696987,"is_pvip":false,"replies":[{"id":139394,"content":"åœ¨è¯¾ç¨‹ä»‹ç»ä¸­çš„ æ¡†æ¶ç‰ˆæœ¬ä¸­æœ‰è¯¦ç»†çš„ä»‹ç»ã€‚å¯ç›´æ¥å‚è€ƒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1698033461,"ip_address":"åŒ—äº¬","comment_id":382632,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100546501,"comment_content":"ä½ å¥½ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨çš„æ¯ä¸ªåŒ…çš„ç‰ˆæœ¬æ˜¯å¤šå°‘å‘€ï¼ˆèƒ½å¦å‘ä¸€ä¸‹ä½ ç”¨çš„ç‰ˆæœ¬ï¼‰ï¼Ÿæ‰§è¡Œflask db init ï¼ŒæŠ¥è¿™ä¸ªé”™è¯¯ï¼Œ\nTraceback (most recent call last):\n  File &quot;&#47;Users&#47;kevin&#47;.pyenv&#47;versions&#47;3.12.0&#47;bin&#47;flask&quot;, line 5, in &lt;module&gt;\n    from flask.cli import main\n  File &quot;&#47;Users&#47;kevin&#47;.pyenv&#47;versions&#47;3.12.0&#47;lib&#47;python3.12&#47;site-packages&#47;flask&#47;__init__.py&quot;, line 19, in &lt;module&gt;\n    from jinja2 import Markup, escape\nImportError: cannot import name &#39;Markup&#39; from &#39;jinja2&#39; (&#47;Users&#47;kevin&#47;.pyenv&#47;versions&#47;3.12.0&#47;lib&#47;python3.12&#47;site-packages&#47;jinja2&#47;__init__.py)","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630029,"discussion_content":"åœ¨è¯¾ç¨‹ä»‹ç»ä¸­çš„ æ¡†æ¶ç‰ˆæœ¬ä¸­æœ‰è¯¦ç»†çš„ä»‹ç»ã€‚å¯ç›´æ¥å‚è€ƒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698033461,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":380270,"user_name":"Geek_5cb928","can_delete":false,"product_type":"c1","uid":3630475,"ip_address":"å¹¿ä¸œ","ucode":"2768F6F5F99D8E","user_header":"","comment_is_top":false,"comment_ctime":1693293752,"is_pvip":false,"replies":[{"id":138526,"content":"æ„Ÿè°¢åŒå­¦åˆ†äº«ï¼Œä¸ºä½ ç‚¹èµï¼Œåç«¯å¼€å‘è¿‡ç¨‹ä¸­è¿˜æ˜¯å»ºè®®å¤§å®¶ä½¿ç”¨PyCharmæ›´æ–¹ä¾¿ä¸€äº›ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1693464975,"ip_address":"åŒ—äº¬","comment_id":380270,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100546501,"comment_content":"åœ¨æ‰§è¡Œflask shellåé¢çš„dbç›¸å…³å‘½ä»¤æ—¶æŠ¥é”™ï¼Œname &#39;db&#39; is not defined\nå‘ç°é€ æˆçš„åŸå› æ˜¯æ•™ç¨‹é‡Œé¢ç”¨åˆ°çš„pycharmä¼šè‡ªåŠ¨é…ç½®contextï¼Œç”¨vscodeæ‰€ä»¥é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ã€‚\nä¿®å¤å¦‚ä¸‹\nåœ¨app.py ï¼ˆmanager.pyï¼‰ä¸‹é¢å®šä¹‰context\n@app.shell_context_processor\ndef make_shell_context():\n    return {&#39;db&#39;: db}\nä¾›å¤§å®¶å‚è€ƒ","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626882,"discussion_content":"æ„Ÿè°¢åŒå­¦åˆ†äº«ï¼Œä¸ºä½ ç‚¹èµï¼Œåç«¯å¼€å‘è¿‡ç¨‹ä¸­è¿˜æ˜¯å»ºè®®å¤§å®¶ä½¿ç”¨PyCharmæ›´æ–¹ä¾¿ä¸€äº›ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693464975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":379676,"user_name":"èœ¡ç¬”å°æ–°çˆ±çœ‹ä¹¦","can_delete":false,"product_type":"c1","uid":1224437,"ip_address":"å¹¿ä¸œ","ucode":"3E597682ADB0C8","user_header":"https://static001.geekbang.org/account/avatar/00/12/ae/f5/a17bbcc9.jpg","comment_is_top":false,"comment_ctime":1692265759,"is_pvip":false,"replies":[{"id":138332,"content":"å¯¹äºä»£ç æç¤ºè®¾ç½®é—®é¢˜ï¼Œä½ ç¡®ä¿ &quot;SQLAlchemy&quot; åº“è¢«æ­£ç¡®è¯†åˆ«å¹¶åœ¨ä»£ç æç¤ºåˆ—è¡¨ä¸­å¯ç”¨ã€‚å¦‚æœå®ƒæ²¡æœ‰è¢«åˆ—å‡ºï¼Œä½ å¯ä»¥ç‚¹å‡» &quot;+&quot; å·æ·»åŠ å®ƒã€‚å¦‚æœ &quot;SQLAlchemy&quot; å·²ç»åœ¨åˆ—è¡¨ä¸­ï¼Œè¯·ç¡®ä¿å®ƒçš„ç‰ˆæœ¬ä¸ä½ çš„é¡¹ç›®å…¼å®¹ã€‚\nä½ å¯ä»¥å°è¯•ä¸€ä¸‹ï¼Œå¦‚æœæœ‰é—®é¢˜å¯ä»¥ç»§ç»­è¿½è¯„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1692453505,"ip_address":"åŒ—äº¬","comment_id":379676,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100546501,"comment_content":"db.Columnï¼Œè¾“å…¥.pycharmå¸¦ä¸å‡ºæ¥Columnçš„æç¤ºï¼Œæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626029,"discussion_content":"å¯¹äºä»£ç æç¤ºè®¾ç½®é—®é¢˜ï¼Œä½ ç¡®ä¿ &#34;SQLAlchemy&#34; åº“è¢«æ­£ç¡®è¯†åˆ«å¹¶åœ¨ä»£ç æç¤ºåˆ—è¡¨ä¸­å¯ç”¨ã€‚å¦‚æœå®ƒæ²¡æœ‰è¢«åˆ—å‡ºï¼Œä½ å¯ä»¥ç‚¹å‡» &#34;+&#34; å·æ·»åŠ å®ƒã€‚å¦‚æœ &#34;SQLAlchemy&#34; å·²ç»åœ¨åˆ—è¡¨ä¸­ï¼Œè¯·ç¡®ä¿å®ƒçš„ç‰ˆæœ¬ä¸ä½ çš„é¡¹ç›®å…¼å®¹ã€‚\nä½ å¯ä»¥å°è¯•ä¸€ä¸‹ï¼Œå¦‚æœæœ‰é—®é¢˜å¯ä»¥ç»§ç»­è¿½è¯„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692453505,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1224437,"avatar":"https://static001.geekbang.org/account/avatar/00/12/ae/f5/a17bbcc9.jpg","nickname":"èœ¡ç¬”å°æ–°çˆ±çœ‹ä¹¦","note":"","ucode":"3E597682ADB0C8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":626758,"discussion_content":"SQLAlchemyæ˜¯å¯ç”¨çš„ï¼Œä¸æ¸…æ¥šç‰ˆæœ¬å’Œé¡¹ç›®ä¹‹é—´çš„éœ€è¦æ€ä¹ˆå…¼å®¹ï¼Œç½‘ä¸Šæ‰¾äº†å¾ˆå¤šèµ„æ–™ä¹Ÿæ²¡æŸ¥åˆ°è§£å†³åŠæ³•ï¼Œè€å¸ˆå¯ä»¥å¸®å¿™åˆ—ä¸€ä¸‹å¯ä»¥å¸¦å‡ºdb.Columnè‡ªåŠ¨æç¤ºçš„å„ä¸ªä¾èµ–åº“ç‰ˆæœ¬å—ï¼ŒåŒ…æ‹¬pythonç”¨3.å‡ ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693369672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":626029,"ip_address":"å¹¿ä¸œ","group_id":0},"score":626758,"extra":""}]}]},{"had_liked":false,"id":377895,"user_name":"Geek_7cc417","can_delete":false,"product_type":"c1","uid":2610557,"ip_address":"å¹¿ä¸œ","ucode":"89DD57A32188B4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJQYnrTXgWggD3KV8scrKpdupicFibhFzIAenfrBHaMwxibksHzFVaJU3VPTsmiaXfXWZ84FIQYbjCZA/132","comment_is_top":false,"comment_ctime":1689494210,"is_pvip":false,"replies":[{"id":137727,"content":"å¦‚æœæ˜¯æ¯•ä¸šè®¾è®¡çš„è¯å•ç‚¹åŠŸèƒ½æ˜¯ä¸å¤Ÿçš„ï¼Œå¦‚æœåªæœ‰ç”¨æˆ·çº¬åº¦æ˜¯ä¸å¯ä»¥çš„ï¼Œæˆ‘ä»¬è¯¾ç¨‹ä¸­çš„é¡¹ç›®å®ç°æ˜¯å®Œæ•´çš„ï¼Œä¸å•å•åªæœ‰ç”¨æˆ·è¡¨ä¸€ä¸ªæ¨¡å—ã€‚æˆ‘ä¹‹åä¼šä¸Šä¼ å®Œæ•´çš„ä»£ç ä½ å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼Œæ•´ä½“å®ç°èµ·æ¥åŠŸèƒ½è¿˜æ˜¯éå¸¸å¤šçš„ï¼Œä½ çš„æ¯•ä¸šè®¾è®¡åº”è¯¥ä¸éœ€è¦è¿™ä¹ˆå¤šåŠŸèƒ½ï¼Œæ»¡è¶³å¢åˆ æ”¹æŸ¥å°±è¡Œåº”è¯¥ã€‚æœ‰é—®é¢˜å¯ä»¥å†å›è¯„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1689519910,"ip_address":"åŒ—äº¬","comment_id":377895,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100546501,"comment_content":"æˆ‘æƒ³é—®ä¸€ä¸‹è€å¸ˆï¼Œåœ¨æœ¬æ¬¡é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬æ•°æ®åº“è®¾è®¡åªæœ‰ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯è¡¨å°±å¤Ÿäº†å—ï¼Ÿæˆ‘æƒ³å­¦ä¹ ä¸€ä¸‹æ•°æ®åº“æ€ä¹ˆè®¾è®¡çš„ï¼Œæ¥ä¿®æ”¹å¢åŠ å»åšä¸ªæ¯•ä¸šè®¾è®¡ä¸çŸ¥é“èƒ½ä¸èƒ½è¡Œ","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623470,"discussion_content":"å¦‚æœæ˜¯æ¯•ä¸šè®¾è®¡çš„è¯å•ç‚¹åŠŸèƒ½æ˜¯ä¸å¤Ÿçš„ï¼Œå¦‚æœåªæœ‰ç”¨æˆ·çº¬åº¦æ˜¯ä¸å¯ä»¥çš„ï¼Œæˆ‘ä»¬è¯¾ç¨‹ä¸­çš„é¡¹ç›®å®ç°æ˜¯å®Œæ•´çš„ï¼Œä¸å•å•åªæœ‰ç”¨æˆ·è¡¨ä¸€ä¸ªæ¨¡å—ã€‚æˆ‘ä¹‹åä¼šä¸Šä¼ å®Œæ•´çš„ä»£ç ä½ å¯ä»¥å‚è€ƒä¸€ä¸‹ï¼Œæ•´ä½“å®ç°èµ·æ¥åŠŸèƒ½è¿˜æ˜¯éå¸¸å¤šçš„ï¼Œä½ çš„æ¯•ä¸šè®¾è®¡åº”è¯¥ä¸éœ€è¦è¿™ä¹ˆå¤šåŠŸèƒ½ï¼Œæ»¡è¶³å¢åˆ æ”¹æŸ¥å°±è¡Œåº”è¯¥ã€‚æœ‰é—®é¢˜å¯ä»¥å†å›è¯„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1689519910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377465,"user_name":"ğŸŒ€Pick Monster ğŸŒ€","can_delete":false,"product_type":"c1","uid":1141196,"ip_address":"é™•è¥¿","ucode":"EE67F41B360460","user_header":"https://static001.geekbang.org/account/avatar/00/11/69/cc/747c7629.jpg","comment_is_top":false,"comment_ctime":1688540891,"is_pvip":true,"replies":[{"id":137566,"content":"ä½ å¥½åŒå­¦ï¼Œdb å’Œ app çš„å®ä¾‹åŒ–è¦åœ¨ api æ–‡ä»¶å¤¹ä¸‹çš„ __init__.py æ–‡ä»¶ä¸­ï¼Œåœ¨æ­¤ä¹‹å‰è¦å®‰è£…SQLAlchemyï¼Œå‡ºç°è¿™ä¸ªé—®é¢˜æ˜¯å› ä¸ºæ²¡æœ‰æ­£ç¡®å¯¼å…¥æ¨¡å—ï¼Œåœ¨__init__å‡½æ•°ä¸­ä½¿ç”¨äº†æœªå®šä¹‰çš„æ•°æ®åº“å‘½ä»¤ã€‚è¯·æ£€æŸ¥ä»£ç ä¸­æ˜¯å¦å­˜åœ¨è¯­æ³•é”™è¯¯ï¼Œç‰¹åˆ«æ˜¯ä¸æ•°æ®åº“ç›¸å…³çš„è¯­å¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1688700548,"ip_address":"åŒ—äº¬","comment_id":377465,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100546501,"comment_content":"flask db init\næŠ¥é”™Error: No such command &#39;db&#39;.\næç¤ºåœ¨api __init__ä¸­æ²¡æœ‰dbï¼Œè¿™ä¸ªä¸ºä»€ä¹ˆ","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622825,"discussion_content":"ä½ å¥½åŒå­¦ï¼Œdb å’Œ app çš„å®ä¾‹åŒ–è¦åœ¨ api æ–‡ä»¶å¤¹ä¸‹çš„ __init__.py æ–‡ä»¶ä¸­ï¼Œåœ¨æ­¤ä¹‹å‰è¦å®‰è£…SQLAlchemyï¼Œå‡ºç°è¿™ä¸ªé—®é¢˜æ˜¯å› ä¸ºæ²¡æœ‰æ­£ç¡®å¯¼å…¥æ¨¡å—ï¼Œåœ¨__init__å‡½æ•°ä¸­ä½¿ç”¨äº†æœªå®šä¹‰çš„æ•°æ®åº“å‘½ä»¤ã€‚è¯·æ£€æŸ¥ä»£ç ä¸­æ˜¯å¦å­˜åœ¨è¯­æ³•é”™è¯¯ï¼Œç‰¹åˆ«æ˜¯ä¸æ•°æ®åº“ç›¸å…³çš„è¯­å¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688700549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377154,"user_name":"æœªæ¥å·²æ¥","can_delete":false,"product_type":"c1","uid":1187130,"ip_address":"å¹¿ä¸œ","ucode":"3A21ACFD53CB9C","user_header":"https://static001.geekbang.org/account/avatar/00/12/1d/3a/cdf9c55f.jpg","comment_is_top":false,"comment_ctime":1688005510,"is_pvip":false,"replies":[{"id":137511,"content":"ä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æ­£ç¡®é…ç½®äº†æ•°æ®åº“è¿æ¥ï¼Œç¡®ä¿ä½ æ­£ç¡®è®¾ç½®äº†æ•°æ®åº“è¿æ¥æ•°æ®åº“åœ°å€ä»¥åŠç”¨æˆ·åå’Œå¯†ç ã€‚å…¶æ¬¡ï¼Œå¦‚æœæ•°æ®åº“ä¸­å·²ç»å­˜åœ¨å…¶ä»–è¡¨æˆ–çº¦æŸï¼Œä¾‹å¦‚å¤–é”®çº¦æŸã€å”¯ä¸€çº¦æŸç­‰ï¼Œå¯èƒ½å½±å“æ–°è¡¨çš„åˆ›å»ºã€‚ä½ å¯ä»¥å°è¯•åœ¨åˆ›å»ºæ–°è¡¨ä¹‹å‰åˆ é™¤æˆ–ä¿®æ”¹è¿™äº›çº¦æŸï¼Œæˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“è¿›è¡Œæµ‹è¯•ã€‚å¦‚æœ‰é—®é¢˜å¯ä»¥è¿½è¯„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1688397882,"ip_address":"åŒ—äº¬","comment_id":377154,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100546501,"comment_content":"ä¸çŸ¥é“ä¸ºå•¥ï¼Œæ‰§è¡Œå®Œ `flask shellï½€ åŠ ï½€db.create_all()ï½€ä¹‹åï¼Œæ²¡æœ‰æ­£å¸¸å»ºè¡¨","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622553,"discussion_content":"ä½ å¯ä»¥æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æ­£ç¡®é…ç½®äº†æ•°æ®åº“è¿æ¥ï¼Œç¡®ä¿ä½ æ­£ç¡®è®¾ç½®äº†æ•°æ®åº“è¿æ¥æ•°æ®åº“åœ°å€ä»¥åŠç”¨æˆ·åå’Œå¯†ç ã€‚å…¶æ¬¡ï¼Œå¦‚æœæ•°æ®åº“ä¸­å·²ç»å­˜åœ¨å…¶ä»–è¡¨æˆ–çº¦æŸï¼Œä¾‹å¦‚å¤–é”®çº¦æŸã€å”¯ä¸€çº¦æŸç­‰ï¼Œå¯èƒ½å½±å“æ–°è¡¨çš„åˆ›å»ºã€‚ä½ å¯ä»¥å°è¯•åœ¨åˆ›å»ºæ–°è¡¨ä¹‹å‰åˆ é™¤æˆ–ä¿®æ”¹è¿™äº›çº¦æŸï¼Œæˆ–è€…åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“è¿›è¡Œæµ‹è¯•ã€‚å¦‚æœ‰é—®é¢˜å¯ä»¥è¿½è¯„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688397882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1768759,"avatar":"","nickname":"é—»é“","note":"","ucode":"90BCB38325EADF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622950,"discussion_content":"å‘ç°è¦åœ¨app.py åŠ ä¸Šfrom api.models import user å°±å¯ä»¥åˆ›å»ºæˆåŠŸã€‚çœ‹åˆ°çš„è§£é‡Šæ˜¯è®²æ¨¡å‹ç±»å®šä¹‰åœ¨å•ç‹¬çš„æ¨¡å—ä¸­ï¼Œå¿…é¡»åœ¨è°ƒç”¨create_allå‰å¯¼å…¥ç›¸åº”çš„æ¨¡å—ï¼Œè®©SQLAlchemyè·å–æ¨¡å‹ç±»è¢«åˆ›å»ºæ—¶ç”Ÿæˆçš„è¡¨ä¿¡æ¯\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1688867074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376753,"user_name":"Geek_840593","can_delete":false,"product_type":"c1","uid":3605821,"ip_address":"é‡åº†","ucode":"F92256CD230166","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI7Bm7xdbwqoWPaDwqn6WESYL5QY8X8r3Q1P7UEIeDWictxJWEIJLluhIDHF7b0wFpbiav3gYToBBYg/132","comment_is_top":false,"comment_ctime":1687319895,"is_pvip":false,"replies":[{"id":137376,"content":"æ˜¯è¿™æ ·çš„ï¼Œåœ¨ app.py æ–‡ä»¶ä¸­ï¼Œç¡®å®æœ‰create_db()æ–¹æ³•ï¼Œå®ƒç”¨äºåˆ›å»ºæ•°æ®åº“è¡¨ï¼Œé€šè¿‡ db.create_all() æ–¹æ³•æ¥åˆ›å»ºæ‰€æœ‰å®šä¹‰çš„æ¨¡å‹ç±»çš„è¡¨ã€‚ç„¶è€Œï¼Œå½“ä½ è¿è¡Œ Flask åº”ç”¨ç¨‹åºæ—¶ï¼Œcreate_db() å‡½æ•°å¹¶ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚ä½ éœ€è¦åœ¨ Terminal ä¸­æ‰‹åŠ¨è¾“å…¥ flask shell å‘½ä»¤ï¼Œç„¶ååœ¨ Python shell ä¸­æ‰§è¡Œ db.create_all() è¯­å¥æ¥åˆ›å»ºæ•°æ®åº“è¡¨ã€‚æ‰‹åŠ¨æ‰§è¡Œ db.create_all() çš„åŸå› æ˜¯åœ¨ Flask åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œå®ƒéœ€è¦åŠ è½½æ•´ä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬æ•°æ®åº“æ¨¡å‹å’Œç›¸å…³çš„è¡¨ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒFlask ä¼šè‡ªåŠ¨æ£€æµ‹æ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨ç›¸å…³çš„è¡¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚å› æ­¤ï¼Œä¸ºäº†ç¡®ä¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿæ­£ç¡®å¯åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ db.create_all() æ¥åˆ›å»ºæ•°æ®åº“è¡¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1687682827,"ip_address":"åŒ—äº¬","comment_id":376753,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100546501,"comment_content":"è€å¸ˆï¼šapp.pyè¿™é‡Œä¸æ˜¯æœ‰æ®µä»£ç åˆ›å»ºæ•°æ®åº“è¡¨\nã€‚ã€‚ã€‚ã€‚ã€‚ã€‚\ndef create_db():\n    db.create_all()\nif __name__ == &#39;__main__&#39;:\n    manager.run()\nä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜æ˜¯è¦æ‰‹åŠ¨åœ¨Terminalè¾“å…¥ä¸€æ¬¡ï¼š\nflask shell\ndb.create_all()","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621830,"discussion_content":"æ˜¯è¿™æ ·çš„ï¼Œåœ¨ app.py æ–‡ä»¶ä¸­ï¼Œç¡®å®æœ‰create_db()æ–¹æ³•ï¼Œå®ƒç”¨äºåˆ›å»ºæ•°æ®åº“è¡¨ï¼Œé€šè¿‡ db.create_all() æ–¹æ³•æ¥åˆ›å»ºæ‰€æœ‰å®šä¹‰çš„æ¨¡å‹ç±»çš„è¡¨ã€‚ç„¶è€Œï¼Œå½“ä½ è¿è¡Œ Flask åº”ç”¨ç¨‹åºæ—¶ï¼Œcreate_db() å‡½æ•°å¹¶ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚ä½ éœ€è¦åœ¨ Terminal ä¸­æ‰‹åŠ¨è¾“å…¥ flask shell å‘½ä»¤ï¼Œç„¶ååœ¨ Python shell ä¸­æ‰§è¡Œ db.create_all() è¯­å¥æ¥åˆ›å»ºæ•°æ®åº“è¡¨ã€‚æ‰‹åŠ¨æ‰§è¡Œ db.create_all() çš„åŸå› æ˜¯åœ¨ Flask åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œå®ƒéœ€è¦åŠ è½½æ•´ä¸ªåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬æ•°æ®åº“æ¨¡å‹å’Œç›¸å…³çš„è¡¨ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒFlask ä¼šè‡ªåŠ¨æ£€æµ‹æ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨ç›¸å…³çš„è¡¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚å› æ­¤ï¼Œä¸ºäº†ç¡®ä¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿæ­£ç¡®å¯åŠ¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ‰§è¡Œ db.create_all() æ¥åˆ›å»ºæ•°æ®åº“è¡¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687682828,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2667280,"avatar":"https://static001.geekbang.org/account/avatar/00/28/b3/10/6544c1c3.jpg","nickname":"Steven","note":"","ucode":"7CAA60036BDF5A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":628211,"discussion_content":"å¬æ˜¯å¬æ‡‚äº†ï¼Œä½†æ˜¯è¿™ä¸ªåœ¨æˆ‘ä»¬é¡¹ç›®ä¸­é…ç½®é¡¹åº”è¯¥æ›´å®¹æ˜“è®¾ç½®å§ï¼Œæœ€æ„Ÿè§‰è¿™æ­¥æœ‰ç‚¹é‡å¤ï¼Œä¸ªäººå¦‚æœæŠ›å‡ºç±»ä¼¼çš„æ–¹æ³•ï¼Œä¼šè¯´è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•åˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„ï¼Œç¬¬ä¸€ç§ä»£ç ä¸­é…ç½®ï¼Œé€šè¿‡å‘½ä»¤è¿è¡Œï¼›ç¬¬äºŒç§ç›´æ¥è¿›å…¥shellä¸­ï¼Œè¿è¡Œcreate_all()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1695087225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376394,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"åŒ—äº¬","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1686789942,"is_pvip":false,"replies":[{"id":137306,"content":"1ã€f å‰ç¼€æ˜¯ä¸€ç§å­—ç¬¦ä¸²æ ¼å¼åŒ–è¯­æ³•ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶å°†å˜é‡æ’å…¥åˆ°å­—ç¬¦ä¸²ä¸­ã€‚\n2ã€passæ˜¯ä¸€ä¸ªç©ºè¯­å¥ï¼Œå®ƒä»€ä¹ˆä¹Ÿä¸åšï¼Œåªæ˜¯å æ®ä¸€ä¸ªè¯­å¥ä½ç½®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":3050845,"ctime":1687167542,"ip_address":"åŒ—äº¬","comment_id":376394,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100546501,"comment_content":"Q1ï¼šå‰ç¼€fæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ\nSQLALCHEMY_DATABASE_URI = f&quot;mysql+pymysql:&#47;&#47;{SQL_USERNAME}:{SQL_PASSWORD}@{SQL_HOST}:{SQL_PORT}&#47;{SQL_DB}&quot;ï¼Œ å­—ç¬¦ä¸²å‰é¢çš„å‰ç¼€fè¡¨ç¤ºä»€ä¹ˆï¼Ÿ\nQ2ï¼špassæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ\n# å¼€å‘ç¯å¢ƒçš„configclass DevConfig(Config):    pass\nå‡½æ•°ä½“çš„passæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿçœç•¥å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621375,"discussion_content":"1ã€f å‰ç¼€æ˜¯ä¸€ç§å­—ç¬¦ä¸²æ ¼å¼åŒ–è¯­æ³•ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶å°†å˜é‡æ’å…¥åˆ°å­—ç¬¦ä¸²ä¸­ã€‚\n2ã€passæ˜¯ä¸€ä¸ªç©ºè¯­å¥ï¼Œå®ƒä»€ä¹ˆä¹Ÿä¸åšï¼Œåªæ˜¯å æ®ä¸€ä¸ªè¯­å¥ä½ç½®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687167542,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1104601,"avatar":"https://static001.geekbang.org/account/avatar/00/10/da/d9/f051962f.jpg","nickname":"æµ©ä»”æ˜¯ç¨‹åºå‘˜","note":"","ucode":"A7E5CF9E1571A2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":621151,"discussion_content":"passæ˜¯ä¸ªç©ºè¯­å¥ï¼Œå…¶ä»–è¯­è¨€å°±æ˜¯{}","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1686843232,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377576,"user_name":"é—»é“","can_delete":false,"product_type":"c1","uid":1768759,"ip_address":"å¹¿ä¸œ","ucode":"90BCB38325EADF","user_header":"","comment_is_top":false,"comment_ctime":1688735295,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100546501,"comment_content":"é‡åˆ°æ˜¯è¿™ä¸ªæŠ¥é”™ModuleNotFoundError: No module named &#39;flask._compat&#39;ï¼Œçœ‹ç€æ˜¯Flaskç‰ˆæœ¬é—®é¢˜ï¼Œé€šè¿‡è¿™é‡Œé¢çš„æ–¹æ³•è§£å†³https:&#47;&#47;stackoverflow.com&#47;questions&#47;67538056&#47;flask-script-from-flask-compat-import-text-type-modulenotfounderror-no-module\n","like_count":1,"discussions":[{"author":{"id":3050845,"avatar":"https://static001.geekbang.org/account/avatar/00/2e/8d/5d/9a86007c.jpg","nickname":"Barry","note":"","ucode":"82175C78B4CAED","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626028,"discussion_content":"éå¸¸ä¸é”™çš„å­¦ä¹ è®°å½•åˆ†äº«ï¼Œéå¸¸æ£’ï¼Œæ„Ÿè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692453177,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":382633,"user_name":"Geek_00c9c4","can_delete":false,"product_type":"c1","uid":2290434,"ip_address":"ä¸Šæµ·","ucode":"249ACAE2F5F381","user_header":"https://static001.geekbang.org/account/avatar/00/22/f3/02/cbad4037.jpg","comment_is_top":false,"comment_ctime":1697700721,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100546501,"comment_content":"ç›®å‰å­¦ä¹ åˆ°è¿™å„¿ä½¿ç”¨çš„package version\nPackage           Version\n----------------- -------\nalembic           1.12.0\nblinker           1.6.3\nclick             7.1.2\nFlask             1.1.4\nFlask-Migrate     4.0.5\nFlask-Script      2.0.6\nFlask-SQLAlchemy  2.2\nitsdangerous      1.1.0\nJinja2            2.11.3\nMako              1.2.4\nMarkupSafe        2.0.1\npip               23.2.1\nsetuptools        68.2.2\nSQLAlchemy        1.3.0\ntyping_extensions 4.8.0\nWerkzeug          1.0.1","like_count":0}]}