{"id":252705,"title":"02 |  æŒ‡ä»¤å¼ç»˜å›¾ç³»ç»Ÿï¼šå¦‚ä½•ç”¨Canvasç»˜åˆ¶å±‚æ¬¡å…³ç³»å›¾ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æœˆå½±ã€‚</p><p>Canvasæ˜¯å¯è§†åŒ–é¢†åŸŸé‡Œéå¸¸é‡è¦ä¸”å¸¸ç”¨çš„å›¾å½¢ç³»ç»Ÿï¼Œåœ¨å¯è§†åŒ–é¡¹ç›®ä¸­ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å°†æ•°æ®å†…å®¹ä»¥å‡ ä½•å›¾å½¢çš„å½¢å¼ï¼Œéå¸¸æ–¹ä¾¿åœ°å‘ˆç°å‡ºæ¥ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±åœ¨ä¸Šä¸€èŠ‚è¯¾çš„åŸºç¡€ä¸Šå¯¹Canvasè¿›è¡Œç¨å¾®æ·±å…¥ä¸€äº›çš„ä»‹ç»ï¼Œæ¥å­¦ä¹ ä¸€ä¸‹Canvasç»˜åˆ¶åŸºæœ¬å‡ ä½•å›¾å½¢çš„æ–¹æ³•ã€‚</p><p>æˆ‘ä¸»è¦ä¼šè®²è§£å¦‚ä½•ç”¨å®ƒçš„2Dä¸Šä¸‹æ–‡æ¥å®Œæˆç»˜å›¾ï¼Œä¸è¿‡ï¼Œæˆ‘ä¸ä¼šå»è®²å’Œå®ƒæœ‰å…³çš„æ‰€æœ‰Apiï¼Œé‡ç‚¹åªæ˜¯å¸Œæœ›é€šè¿‡è°ƒç”¨ä¸€äº›å¸¸ç”¨çš„APIèƒ½ç»™ä½ è®²æ¸…æ¥šï¼ŒCanvas2Dèƒ½åšä»€ä¹ˆã€è¦æ€ä¹ˆä½¿ç”¨ï¼Œä»¥åŠå®ƒçš„å±€é™æ€§æ˜¯ä»€ä¹ˆã€‚æœ€åï¼Œæˆ‘è¿˜ä¼šå¸¦ä½ ç”¨Canvasç»˜åˆ¶ä¸€ä¸ªè¡¨ç¤ºçœå¸‚å…³ç³»çš„å±‚æ¬¡å…³ç³»å›¾ï¼ˆHierarchy Graphï¼‰ã€‚å¸Œæœ›é€šè¿‡è¿™ä¸ªå¯è§†åŒ–çš„ä¾‹å­ï¼Œèƒ½å¸®ä½ å®è·µå¹¶æŒæ¡Canvasçš„ç”¨æ³•ã€‚</p><p>åœ¨æˆ‘ä»¬åé¢çš„è¯¾ç¨‹ä¸­ï¼ŒåŸºæœ¬ä¸Š70~80%çš„å›¾éƒ½å¯ä»¥ç”¨Canvasæ¥ç»˜åˆ¶ï¼Œæ‰€ä»¥å…¶é‡è¦æ€§ä¸è¨€è€Œå–»ã€‚è¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬æ­£å¼å¼€å§‹ä»Šå¤©çš„å†…å®¹å§ï¼</p><h2>å¦‚ä½•ç”¨Canvasç»˜åˆ¶å‡ ä½•å›¾å½¢ï¼Ÿ</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç»˜åˆ¶çº¢è‰²æ­£æ–¹å½¢çš„ç®€å•ä¾‹å­ï¼Œæ¥è®²ä¸€è®²Canvasçš„åŸºæœ¬ç”¨æ³•ã€‚</p><h3>1. Canvaså…ƒç´ å’Œ2Dä¸Šä¸‹æ–‡</h3><p>å¯¹æµè§ˆå™¨æ¥è¯´ï¼ŒCanvasä¹Ÿæ˜¯HTMLå…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨canvasæ ‡ç­¾å°†å®ƒæ’å…¥åˆ°HTMLå†…å®¹ä¸­ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨bodyé‡Œæ’å…¥ä¸€ä¸ªå®½ã€é«˜åˆ†åˆ«ä¸º512çš„canvaså…ƒç´ ã€‚</p><!-- [[[read_end]]] --><pre><code>&lt;body&gt;\n  &lt;canvas width=&quot;512&quot; height=&quot;512&quot;&gt;&lt;/canvas&gt;\n&lt;/body&gt;\n</code></pre><p>è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼ŒCanvaså…ƒç´ ä¸Šçš„widthå’Œheightå±æ€§ä¸ç­‰åŒäºCanvaså…ƒç´ çš„CSSæ ·å¼çš„å±æ€§ã€‚è¿™æ˜¯å› ä¸ºï¼ŒCSSå±æ€§ä¸­çš„å®½é«˜å½±å“Canvasåœ¨é¡µé¢ä¸Šå‘ˆç°çš„å¤§å°ï¼Œè€ŒHTMLå±æ€§ä¸­çš„å®½é«˜åˆ™å†³å®šäº†Canvasçš„åæ ‡ç³»ã€‚ä¸ºäº†åŒºåˆ†å®ƒä»¬ï¼Œæˆ‘ä»¬ç§°Canvasçš„HTMLå±æ€§å®½é«˜ä¸º<strong>ç”»å¸ƒå®½é«˜</strong>ï¼ŒCSSæ ·å¼å®½é«˜ä¸º<strong>æ ·å¼å®½é«˜</strong>ã€‚</p><p>åœ¨å®é™…ç»˜åˆ¶çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬ä¸è®¾ç½®Canvaså…ƒç´ çš„æ ·å¼ï¼Œé‚£ä¹ˆCanvaså…ƒç´ çš„ç”»å¸ƒå®½é«˜å°±ä¼šç­‰äºå®ƒçš„æ ·å¼å®½é«˜çš„åƒç´ å€¼ï¼Œä¹Ÿå°±æ˜¯512pxã€‚</p><p>è€Œå¦‚æœè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡CSSè®¾ç½®å…¶ä»–çš„å€¼æŒ‡å®šäº†å®ƒçš„æ ·å¼å®½é«˜ã€‚æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å°†æ ·å¼å®½é«˜è®¾ç½®æˆ256pxï¼Œé‚£ä¹ˆå®ƒå®é™…çš„ç”»å¸ƒå®½é«˜å°±æ˜¯æ ·å¼å®½é«˜çš„ä¸¤å€äº†ã€‚ä»£ç å’Œæ•ˆæœå¦‚ä¸‹ï¼š</p><pre><code>canvas {\n  width: 256px;\n  height: 256px;\n}\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/01/f1/01b8b4f686e776b379a2d8141ac13ff1.jpg?wh=1920*1080\" alt=\"\" title=\"å°†canvasçš„æ ·å¼å®½é«˜è®¾ä¸º256pxï¼Œç”»å¸ƒå®½é«˜è®¾ä¸º512px\"></p><p>å› ä¸ºç”»å¸ƒå®½é«˜å†³å®šäº†å¯è§†åŒºåŸŸçš„åæ ‡èŒƒå›´ï¼Œæ‰€ä»¥Canvaså°†ç”»å¸ƒå®½é«˜å’Œæ ·å¼å®½é«˜åˆ†å¼€çš„åšæ³•ï¼Œèƒ½æ›´æ–¹ä¾¿åœ°é€‚é…ä¸åŒçš„æ˜¾ç¤ºè®¾å¤‡ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦åœ¨ç”»å¸ƒå®½é«˜ä¸º500<code>*</code>500çš„Canvasç”»å¸ƒä¸Šï¼Œç»˜åˆ¶ä¸€ä¸ªå±…ä¸­æ˜¾ç¤ºçš„100<code>*</code>100å®½é«˜çš„æ­£æ–¹å½¢ã€‚æˆ‘ä»¬åªè¦å°†å®ƒçš„åæ ‡è®¾ç½®åœ¨  x = 200, y = 200 å¤„å³å¯ã€‚è¿™æ ·ï¼Œä¸è®ºè¿™ä¸ªCanvasä»¥å¤šå¤§çš„å°ºå¯¸æ˜¾ç¤ºåœ¨å„ç§è®¾å¤‡ä¸Šï¼Œæˆ‘ä»¬çš„ä»£ç éƒ½ä¸éœ€è¦ä¿®æ”¹ã€‚å¦åˆ™ï¼Œå¦‚æœCanvasçš„åæ ‡èŒƒå›´ï¼ˆç”»å¸ƒå®½é«˜ï¼‰è·Ÿç€æ ·å¼å®½é«˜å˜åŒ–ï¼Œé‚£ä¹ˆå½“å±å¹•å°ºå¯¸æ”¹å˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±è¦é‡æ–°è®¡ç®—éœ€è¦ç»˜åˆ¶çš„å›¾å½¢çš„æ‰€æœ‰åæ ‡ï¼Œè¿™å¯¹äºæˆ‘ä»¬æ¥è¯´å°†ä¼šæ˜¯ä¸€åœºâ€œç¾éš¾â€ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/5e/45/5e5d78e4fd8c42948b6ae68e79e69e45.jpg?wh=1920*1080\" alt=\"\" title=\"åœ¨ç”»å¸ƒå®½é«˜ä¸º500*500çš„Canvasä¸Šå±…ä¸­ç»˜åˆ¶ä¸€ä¸ª100*100çš„æ­£æ–¹å½¢\"></p><h3>2. Canvas çš„åæ ‡ç³»</h3><p>å¥½äº†ï¼ŒCanvasç”»å¸ƒå·²ç»è®¾ç½®å¥½äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹Canvasçš„åæ ‡ç³»ã€‚</p><p>Canvasçš„åæ ‡ç³»å’Œæµè§ˆå™¨çª—å£çš„åæ ‡ç³»ç±»ä¼¼ï¼Œå®ƒä»¬éƒ½é»˜è®¤å·¦ä¸Šè§’ä¸ºåæ ‡åŸç‚¹ï¼Œxè½´æ°´å¹³å‘å³ï¼Œyè½´å‚ç›´å‘ä¸‹ã€‚é‚£åœ¨æˆ‘ä»¬è®¾ç½®å¥½çš„ç”»å¸ƒå®½é«˜ä¸º512<code>*</code>512çš„Canvasç”»å¸ƒä¸­ï¼Œå®ƒçš„å·¦ä¸Šè§’åæ ‡å€¼ä¸ºï¼ˆ0,0ï¼‰ï¼Œå³ä¸‹è§’åæ ‡å€¼ä¸ºï¼ˆ512,512ï¼‰ ã€‚è¿™æ„å‘³ç€ï¼Œåæ ‡ï¼ˆ0,0ï¼‰åˆ°ï¼ˆ512,512ï¼‰ä¹‹é—´çš„æ‰€æœ‰å›¾å½¢ï¼Œéƒ½ä¼šè¢«æµè§ˆå™¨æ¸²æŸ“åˆ°ç”»å¸ƒä¸Šã€‚</p><p><a href=\"https://www.jianshu.com/p/ef8244cb7ec4\"><img src=\"https://static001.geekbang.org/resource/image/6c/f1/6cb9eca4e9c8c64a5e07694f7f6428f1.jpg?wh=1920*1080\" alt=\"\" title=\"canvasåæ ‡ç³»\"></a></p><p>æ³¨æ„ï¼Œä¸Šå›¾ä¸­è¿™ä¸ªåæ ‡ç³»çš„yè½´å‘ä¸‹ï¼Œæ„å‘³ç€è¿™ä¸ªåæ ‡ç³»å’Œç¬›å¡å°”åæ ‡ç³»ä¸åŒï¼Œå®ƒä»¬çš„yè½´æ˜¯ç›¸åçš„ã€‚é‚£åœ¨å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ç»˜åˆ¶ä¸€ä¸ªå‘å³ä¸Šå¹³æŠ›å°çƒçš„åŠ¨ç”»ï¼Œå®ƒçš„æŠ›ç‰©çº¿è½¨è¿¹ï¼Œåœ¨Canvasä¸Šç»˜åˆ¶å‡ºæ¥çš„æ–¹å‘å°±æ˜¯å‘ä¸‹å‡¹çš„ã€‚</p><p><a href=\"https://www.jianshu.com/p/ef8244cb7ec4\"><img src=\"https://static001.geekbang.org/resource/image/f0/2e/f025b55279ea553387a058ab9184012e.jpeg?wh=1920*1080\" alt=\"\" title=\"Canvasåæ ‡ç³»\"></a></p><p>å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬å†è€ƒè™‘æ—‹è½¬æˆ–è€…ä¸‰ç»´è¿åŠ¨ï¼Œè¿™ä¸ªåæ ‡ç³»å°±ä¼šå˜æˆâ€œå·¦æ‰‹ç³»â€ã€‚è€Œå·¦æ‰‹ç³»çš„å¹³é¢æ³•å‘é‡çš„æ–¹å‘å’Œæ—‹è½¬æ–¹å‘ï¼Œå’Œæˆ‘ä»¬ç†Ÿæ‚‰çš„å³æ‰‹ç³»ç›¸åã€‚å¦‚æœä½ ç°åœ¨è¿˜ä¸èƒ½å®Œå…¨ç†è§£å®ƒä»¬çš„åŒºåˆ«ï¼Œé‚£ä¹Ÿæ²¡å…³ç³»ï¼Œåœ¨å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä¼šå†è®²çš„ï¼Œè¿™é‡Œä½ åªéœ€è¦æœ‰ä¸€ä¸ªå¤§ä½“å°è±¡å°±å¯ä»¥äº†ã€‚</p><p><a href=\"https://zhuanlan.zhihu.com/p/64707259\"><img src=\"https://static001.geekbang.org/resource/image/2c/0d/2c01d99b4a3c9a46ba446cc208a6560d.jpeg?wh=1920*1080\" alt=\"\" title=\"å·¦æ‰‹ç³»å’Œå³æ‰‹ç³»\"></a></p><h3>3. åˆ©ç”¨ Canvas ç»˜åˆ¶å‡ ä½•å›¾å½¢</h3><p>æœ‰äº†åæ ‡ç³»ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å‡ ä½•å›¾å½¢ç»˜åˆ¶åˆ°Canvasä¸Šäº†ã€‚å…·ä½“çš„æ­¥éª¤å¯ä»¥åˆ†ä¸ºä¸¤æ­¥ï¼Œåˆ†åˆ«æ˜¯è·å–Canvasä¸Šä¸‹æ–‡å’Œåˆ©ç”¨Canvas ä¸Šä¸‹æ–‡ç»˜åˆ¶å›¾å½¢ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬ä¸€ä¸€æ¥çœ‹ã€‚</p><p><strong>ç¬¬ä¸€æ­¥ï¼Œè·å–Canvasä¸Šä¸‹æ–‡ã€‚</strong></p><p>é‚£åœ¨JavaScriptä¸­ï¼Œæˆ‘ä»¬è¦è·å–Canvasä¸Šä¸‹æ–‡ä¹Ÿéœ€è¦ä¸¤ä¸ªæ­¥éª¤ã€‚é¦–å…ˆæ˜¯è·å–Canvaså…ƒç´ ã€‚å› ä¸ºCanvaså…ƒç´ å°±æ˜¯HTMLæ–‡æ¡£ä¸­çš„canvasæ ‡ç­¾ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡DOM APIè·å–å®ƒï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>const canvas = document.querySelector('canvas');\n</code></pre><p>è·å–äº†canvaså…ƒç´ åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡getContextæ–¹æ³•æ‹¿åˆ°å®ƒçš„ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚å…·ä½“çš„æ“ä½œå°±æ˜¯ï¼Œæˆ‘ä»¬è°ƒç”¨canvas.getContextä¼ å…¥å‚æ•°2dã€‚</p><pre><code>const context = canvas.getContext('2d');\n</code></pre><p>æœ‰äº†2dä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç»˜åˆ¶å›¾å½¢äº†ã€‚</p><p><strong>ç¬¬äºŒæ­¥ï¼Œç”¨ Canvas ä¸Šä¸‹æ–‡ç»˜åˆ¶å›¾å½¢ã€‚</strong></p><p>æˆ‘ä»¬æ‹¿åˆ°çš„contextå¯¹è±¡ä¸Šä¼šæœ‰è®¸å¤šAPIï¼Œå®ƒä»¬å¤§ä½“ä¸Šå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šä¸€ç±»æ˜¯è®¾ç½®çŠ¶æ€çš„APIï¼Œå¯ä»¥è®¾ç½®æˆ–æ”¹å˜å½“å‰çš„ç»˜å›¾çŠ¶æ€ï¼Œæ¯”å¦‚ï¼Œæ”¹å˜è¦ç»˜åˆ¶å›¾å½¢çš„é¢œè‰²ã€çº¿å®½ã€åæ ‡å˜æ¢ç­‰ç­‰ï¼›å¦ä¸€ç±»æ˜¯ç»˜åˆ¶æŒ‡ä»¤APIï¼Œç”¨æ¥ç»˜åˆ¶ä¸åŒå½¢çŠ¶çš„å‡ ä½•å›¾å½¢ã€‚</p><p>å¦‚ä½•ä½¿ç”¨è¿™äº›APIå‘¢ï¼Ÿæˆ‘æ¥ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬è¦åœ¨ç”»å¸ƒçš„ä¸­å¿ƒä½ç½®ç»˜åˆ¶ä¸€ä¸ª100<code>*</code>100çš„çº¢è‰²æ­£æ–¹å½¢ã€‚é‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦é€šè¿‡è®¡ç®—å¾—åˆ°Canvasç”»å¸ƒçš„ä¸­å¿ƒç‚¹ã€‚å‰é¢æˆ‘ä»¬å·²ç»è¯´è¿‡ï¼ŒCanvasåæ ‡ç³»çš„å·¦ä¸Šè§’åæ ‡æ˜¯(0,0)ï¼Œå³ä¸‹è§’æ˜¯Canvasçš„ç”»å¸ƒåæ ‡ï¼Œå³ ï¼ˆcanvas.width,canvas.heightï¼‰ï¼Œæ‰€ä»¥ç”»å¸ƒçš„ä¸­å¿ƒç‚¹åæ ‡æ˜¯ï¼ˆ0.5 <code>*</code>canvas.width, 0.5 <code>*</code> canvas.heightï¼‰ã€‚</p><p>å¦‚æœæˆ‘ä»¬è¦åœ¨ä¸­å¿ƒç‚¹ç»˜åˆ¶ä¸€ä¸ª100 <code>*</code> 100çš„æ­£æ–¹å½¢ï¼Œé‚£å¯¹åº”çš„ CanvasæŒ‡ä»¤æ˜¯ï¼š</p><pre><code>context.rect(0.5 * canvas.width, 0.5 * canvas.height, 100, 100);\n</code></pre><p>å…¶ä¸­ï¼Œcontext.rectæ˜¯ç»˜åˆ¶çŸ©å½¢çš„CanvasæŒ‡ä»¤ï¼Œå®ƒçš„å››ä¸ªå‚æ•°åˆ†åˆ«è¡¨ç¤ºè¦ç»˜åˆ¶çš„çŸ©å½¢çš„xã€yåæ ‡å’Œå®½é«˜ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬è¦ç»˜åˆ¶çš„æ­£æ–¹å½¢å®½é«˜éƒ½æ˜¯100ï¼Œæ‰€ä»¥åä¸¤ä¸ªå‚æ•°æ˜¯100å’Œ100ã€‚</p><p>é‚£åœ¨å®é™…ç»˜åˆ¶ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€äº›å·¥ä½œè¦åšã€‚æˆ‘è¦å°†æ­£æ–¹å½¢å¡«å……æˆçº¢è‰²ï¼Œè¿™ä¸€æ­¥é€šè¿‡è°ƒç”¨context.fillStyleæŒ‡ä»¤å°±å¯ä»¥å®Œæˆã€‚ç„¶åï¼Œæˆ‘ä»¬è¦è°ƒç”¨ä¸€ä¸ªbeginPathçš„æŒ‡ä»¤ï¼Œå‘Šè¯‰Canvasæˆ‘ä»¬ç°åœ¨ç»˜åˆ¶çš„è·¯å¾„ã€‚æ¥ç€ï¼Œæ‰æ˜¯è°ƒç”¨ rect æŒ‡ä»¤å®Œæˆç»˜å›¾ã€‚æœ€åï¼Œæˆ‘ä»¬è¿˜è¦è°ƒç”¨ fill æŒ‡ä»¤ï¼Œå°†ç»˜åˆ¶çš„å†…å®¹çœŸæ­£è¾“å‡ºåˆ°ç”»å¸ƒä¸­ã€‚è¿™æ ·æˆ‘ä»¬å°±å®Œæ•´äº†ç»˜åˆ¶ï¼Œç»˜åˆ¶çš„æ•ˆæœå’Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>const rectSize = [100, 100];\ncontext.fillStyle = 'red';\ncontext.beginPath();\ncontext.rect(0.5 * canvas.width, 0.5 * canvas.height, ...rectSize);\ncontext.fill();\n</code></pre><p><img src=\"https://static001.geekbang.org/resource/image/1c/44/1c13a4yyd5f8284edb29038178eb9144.jpeg?wh=1920*1080\" alt=\"\"></p><p>ä½†æ˜¯ï¼Œçœ‹åˆ°ä¸Šé¢è¿™å¼ å›¾ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼šæ­£æ–¹å½¢å¹¶æ²¡æœ‰å±…äºç”»å¸ƒçš„æ­£ä¸­å¿ƒã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ä½ å¯ä»¥å›æƒ³ä¸€ä¸‹æˆ‘ä»¬åˆšæ‰çš„æ“ä½œï¼Œåœ¨ç»˜åˆ¶æ­£æ–¹å½¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†rectæŒ‡ä»¤çš„å‚æ•°xã€yè®¾ä¸ºç”»å¸ƒå®½é«˜çš„ä¸€åŠã€‚è€ŒrectæŒ‡ä»¤çš„xã€yçš„å€¼è¡¨ç¤ºçš„æ˜¯ï¼Œæˆ‘ä»¬è¦ç»˜åˆ¶å‡ºçš„çŸ©å½¢çš„å·¦ä¸Šè§’åæ ‡è€Œä¸æ˜¯ä¸­å¿ƒç‚¹åæ ‡ï¼Œæ‰€ä»¥ç»˜åˆ¶å‡ºæ¥çš„æ­£æ–¹å½¢è‡ªç„¶å°±ä¸åœ¨æ­£ä¸­å¿ƒäº†ã€‚</p><p>é‚£æˆ‘ä»¬è¯¥å¦‚ä½•å°†æ­£æ–¹å½¢çš„ä¸­å¿ƒç‚¹æ”¾åœ¨ç”»å¸ƒçš„ä¸­å¿ƒå‘¢ï¼Ÿè¿™å°±éœ€è¦æˆ‘ä»¬ç§»åŠ¨ä¸€ä¸‹å›¾å½¢ä¸­å¿ƒçš„åæ ‡äº†ã€‚å…·ä½“çš„å®ç°æ–¹æ³•æœ‰ä¸¤ç§ã€‚</p><p><strong>ç¬¬ä¸€ç§åšæ³•</strong>æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è®©rectæŒ‡ä»¤çš„xã€yå‚æ•°ï¼Œç­‰äºç”»å¸ƒå®½é«˜çš„ä¸€åŠåˆ†åˆ«å‡å»çŸ©å½¢è‡ªèº«å®½é«˜çš„ä¸€åŠã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±æŠŠæ­£æ–¹å½¢çš„ä¸­å¿ƒç‚¹çœŸæ­£åœ°ç§»åŠ¨åˆ°ç”»å¸ƒä¸­å¿ƒäº†ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>context.rect(0.5 * (canvas.width - rectSize[0]), 0.5 * (canvas.height - rectSize[1]), ...rectSize);\n</code></pre><p><strong>ç¬¬äºŒç§åšæ³•</strong>æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç»™ç”»å¸ƒè®¾ç½®ä¸€ä¸ªå¹³ç§»å˜æ¢ï¼ˆTranslateï¼‰ï¼Œç„¶åå†è¿›è¡Œç»˜åˆ¶ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>context.translate(-0.5 * rectSize[0], -0.5 * rectSize[1]);\n\n</code></pre><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç»™ç”»å¸ƒè®¾ç½®äº†ä¸€ä¸ªå¹³ç§»ï¼Œå¹³ç§»è·ç¦»ä¸ºçŸ©å½¢å®½é«˜çš„ä¸€åŠï¼Œè¿™æ ·å®ƒçš„ä¸­å¿ƒç‚¹å°±æ˜¯ç”»å¸ƒçš„ä¸­å¿ƒäº†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/3a/56/3ab2306311ba2382301ae9b654e62856.jpeg?wh=1920*1080\" alt=\"\"></p><p>æ—¢ç„¶è¿™ä¸¤ç§æ–¹æ³•éƒ½èƒ½å°†å›¾å½¢ç»˜åˆ¶åˆ°ç”»å¸ƒçš„ä¸­å¿ƒï¼Œé‚£æˆ‘ä»¬è¯¥æ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿå…¶å®ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¿™ä¸¤ç§æ–¹å¼å„è‡ªçš„ä¼˜ç¼ºç‚¹å…¥æ‰‹ï¼Œä¸‹é¢æˆ‘å°±å…·ä½“æ¥è¯´ä¸€è¯´ã€‚</p><p>ç¬¬ä¸€ç§æ–¹å¼å¾ˆç®€å•ï¼Œå®ƒç›´æ¥æ”¹å˜äº†æˆ‘ä»¬è¦ç»˜åˆ¶çš„å›¾å½¢é¡¶ç‚¹çš„åæ ‡ä½ç½®ï¼Œä½†å¦‚æœæˆ‘ä»¬ç»˜åˆ¶çš„ä¸æ˜¯çŸ©å½¢ï¼Œè€Œæ˜¯å¾ˆå¤šé¡¶ç‚¹çš„å¤šè¾¹å½¢ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨ç»˜å›¾å‰é‡æ–°è®¡ç®—å‡ºæ¯ä¸ªé¡¶ç‚¹çš„ä½ç½®ï¼Œè¿™ä¼šéå¸¸éº»çƒ¦ã€‚</p><p>ç¬¬äºŒç§æ–¹å¼æ˜¯å¯¹Canvasç”»å¸ƒçš„æ•´ä½“åšä¸€ä¸ªå¹³ç§»æ“ä½œï¼Œè¿™æ ·æˆ‘ä»¬åªéœ€è¦è·å–ä¸­å¿ƒç‚¹ä¸å·¦ä¸Šè§’çš„åç§»ï¼Œç„¶åå¯¹ç”»å¸ƒè®¾ç½®translateå˜æ¢å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦å†å»æ”¹å˜å›¾å½¢çš„é¡¶ç‚¹ä½ç½®ã€‚ä¸è¿‡ï¼Œè¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±æ”¹å˜äº†ç”»å¸ƒçš„çŠ¶æ€ã€‚å¦‚æœåç»­è¿˜æœ‰å…¶ä»–çš„å›¾å½¢éœ€è¦ç»˜åˆ¶ï¼Œæˆ‘ä»¬ä¸€å®šè¦è®°å¾—æŠŠç”»å¸ƒçŠ¶æ€ç»™æ¢å¤å›æ¥ã€‚å¥½åœ¨ï¼Œè¿™ä¹Ÿä¸ä¼šå½±å“åˆ°æˆ‘ä»¬å·²ç»ç”»å¥½çš„å›¾å½¢ã€‚</p><p>é‚£æ€ä¹ˆæŠŠç”»å¸ƒçŠ¶æ€æ¢å¤å›æ¥å‘¢ï¼Ÿæ¢å¤ç”»å¸ƒçŠ¶æ€çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œ<strong>ç¬¬ä¸€ç§æ˜¯åå‘å¹³ç§»ã€‚</strong>åå‘å¹³ç§»çš„åŸç†ä¹Ÿå¾ˆç®€å•ï¼Œä½ å¯ä»¥ç›´æ¥çœ‹ä¸‹é¢çš„ä»£ç ã€‚</p><pre><code>// å¹³ç§»\ncontext.translate(-0.5 * rectSize[0], -0.5 * rectSize[1]);\n\n... æ‰§è¡Œç»˜åˆ¶\n\n// æ¢å¤\ncontext.translate(0.5 * rectSize[0], 0.5 * rectSize[1]);\n</code></pre><p>é™¤äº†ä½¿ç”¨åå‘å¹³ç§»çš„æ¢å¤æ–¹å¼ä»¥å¤–ï¼ŒCanvasä¸Šä¸‹æ–‡è¿˜æä¾›äº†<strong>saveå’Œrestore</strong>æ–¹æ³•ï¼Œå¯ä»¥æš‚å­˜å’Œæ¢å¤ç”»å¸ƒæŸä¸ªæ—¶åˆ»çš„çŠ¶æ€ã€‚å…¶ä¸­ï¼ŒsaveæŒ‡ä»¤ä¸ä»…å¯ä»¥ä¿å­˜å½“å‰çš„translateçŠ¶æ€ï¼Œè¿˜å¯ä»¥ä¿å­˜å…¶ä»–çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼ŒfillStyleç­‰é¢œè‰²ä¿¡æ¯ã€‚ è€ŒrestoreæŒ‡ä»¤åˆ™å¯ä»¥å°†çŠ¶æ€æŒ‡ä»¤æ¢å¤æˆsaveæŒ‡ä»¤å‰çš„è®¾ç½®ã€‚æ“ä½œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>context.save(); // æš‚å­˜çŠ¶æ€\n// å¹³ç§»\ncontext.translate(-0.5 * rectSize[0], -0.5 * rectSize[1]);\n\n... æ‰§è¡Œç»˜åˆ¶\n\ncontext.restore(); // æ¢å¤çŠ¶æ€\n</code></pre><p>å¥½äº†ï¼ŒæŠŠä¸€ä¸ªç®€å•çŸ©å½¢ç»˜åˆ¶åˆ°ç”»å¸ƒä¸­å¿ƒçš„å®Œæ•´æ–¹æ³•ï¼Œæˆ‘ä»¬å·²ç»è¯´å®Œäº†ã€‚é‚£æˆ‘ä»¬å†æ¥å›é¡¾ä¸€ä¸‹åˆ©ç”¨Canvasç»˜åˆ¶çŸ©å½¢çš„è¿‡ç¨‹ã€‚æˆ‘æŠŠè¿™ä¸ªè¿‡ç¨‹æ€»ç»“ä¸ºäº†5ä¸ªæ­¥éª¤ï¼š</p><ol>\n<li>è·å–Canvaså¯¹è±¡ï¼Œé€šè¿‡getContext(â€˜2dâ€™)å¾—åˆ°2Dä¸Šä¸‹æ–‡ï¼›</li>\n<li>è®¾ç½®ç»˜å›¾çŠ¶æ€ï¼Œæ¯”å¦‚å¡«å……é¢œè‰²fillStyleï¼Œå¹³ç§»å˜æ¢translateç­‰ç­‰ï¼›</li>\n<li>è°ƒç”¨ beginPath æŒ‡ä»¤å¼€å§‹ç»˜åˆ¶å›¾å½¢ï¼›</li>\n<li>è°ƒç”¨ç»˜å›¾æŒ‡ä»¤ï¼Œæ¯”å¦‚rectï¼Œè¡¨ç¤ºç»˜åˆ¶çŸ©å½¢ï¼›</li>\n<li>è°ƒç”¨fillæŒ‡ä»¤ï¼Œå°†ç»˜åˆ¶å†…å®¹çœŸæ­£è¾“å‡ºåˆ°ç”»å¸ƒä¸Šã€‚</li>\n</ol><p>é™¤æ­¤ä¹‹å¤–ï¼ŒCanvasä¸Šä¸‹æ–‡è¿˜æä¾›äº†æ›´å¤šä¸°å¯Œçš„APIï¼Œå¯ä»¥ç”¨æ¥ç»˜åˆ¶ç›´çº¿ã€å¤šè¾¹å½¢ã€å¼§çº¿ã€åœ†ã€æ¤­åœ†ã€æ‰‡å½¢å’Œè´å¡å°”æ›²çº¿ç­‰ç­‰ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ä¸€ä¸€ä»‹ç»äº†ã€‚åœ¨ä¹‹åçš„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šè¯¦ç»†è®²è§£å¦‚ä½•åˆ©ç”¨è¿™äº›APIæ¥ç»˜åˆ¶å¤æ‚çš„å‡ ä½•å›¾å½¢ã€‚å¦‚æœä½ è¿˜æƒ³äº†è§£æ›´å¤šå…³äºCanvasçš„APIç›¸å…³çš„çŸ¥è¯†ï¼Œè¿˜å¯ä»¥å»é˜…è¯»<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial\">MDNæ–‡æ¡£</a>ã€‚</p><h2>å¦‚ä½•ç”¨Canvas ç»˜åˆ¶å±‚æ¬¡å…³ç³»å›¾ï¼Ÿ</h2><p>çŸ¥é“äº†Canvasçš„åŸºæœ¬ç”¨æ³•ä¹‹åï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨Canvasç»™ä¸€ç»„åŸå¸‚æ•°æ®ç»˜åˆ¶ä¸€ä¸ªå±‚æ¬¡å…³ç³»å›¾äº†ã€‚ä¹Ÿå°±æ˜¯åœ¨ä¸€ç»„ç»™å‡ºçš„å±‚æ¬¡ç»“æ„æ•°æ®ä¸­ï¼Œä½“ç°å‡ºåŒå±äºä¸€ä¸ªçœçš„åŸå¸‚ã€‚</p><p>åœ¨æ“ä½œä¹‹å‰å‘¢ï¼Œæˆ‘ä»¬å…ˆå¼•å…¥ä¸€ä¸ªæ¦‚å¿µå±‚æ¬¡ç»“æ„æ•°æ® ï¼ˆHierarchy Dataï¼‰ï¼Œå®ƒæ˜¯å¯è§†åŒ–é¢†åŸŸçš„ä¸“ä¸šæœ¯è¯­ï¼Œç”¨æ¥è¡¨ç¤ºèƒ½å¤Ÿä½“ç°å±‚æ¬¡ç»“æ„çš„ä¿¡æ¯ï¼Œä¾‹å¦‚åŸå¸‚ä¸çœä¸å›½å®¶ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå±‚æ¬¡ç»“æ„æ•°æ®ç”¨å±‚æ¬¡å…³ç³»å›¾è¡¨æ¥å‘ˆç°ã€‚</p><p>å…¶ä¸­ï¼ŒåŸå¸‚æ•°æ®æ˜¯ä¸€ç»„JSONæ ¼å¼çš„æ•°æ®ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre><code>{\n  &quot;name&quot;:&quot;ä¸­å›½&quot;,\n  &quot;children&quot;:\n  [\n    { \n      &quot;name&quot;:&quot;æµ™æ±Ÿ&quot; , \n        &quot;children&quot;:\n        [\n            {&quot;name&quot;:&quot;æ­å·&quot; },\n            {&quot;name&quot;:&quot;å®æ³¢&quot; },\n            {&quot;name&quot;:&quot;æ¸©å·&quot; },\n            {&quot;name&quot;:&quot;ç»å…´&quot; }\n        ] \n      },\n    { \n      &quot;name&quot;:&quot;å¹¿è¥¿&quot; , \n      &quot;children&quot;:\n      [\n        {&quot;name&quot;:&quot;æ¡‚æ—&quot;},\n        {&quot;name&quot;:&quot;å—å®&quot;},\n        ...\n    }\n  ]\n}\n</code></pre><p>æˆ‘ä»¬è¦ç»˜åˆ¶çš„å±‚æ¬¡å…³ç³»å›¾æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/07/bf/072dbcd9607dd7feafa47e34f97784bf.jpeg?wh=1920*1080\" alt=\"\"></p><p>çŸ¥é“äº†è¦æ±‚ä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿé¦–å…ˆï¼Œæˆ‘ä»¬è¦ä»æ•°æ®æºè·å–JSONæ•°æ®ã€‚</p><pre><code>const dataSource = 'https://s5.ssl.qhres.com/static/b0695e2dd30daa64.json';\n(async function () {\n  const data = await (await fetch(dataSource)).json();\n\n}());\n</code></pre><p>è¿™ä»½JSONæ•°æ®ä¸­åªæœ‰â€œåŸå¸‚&gt;çœä»½&gt;ä¸­å›½â€è¿™æ ·çš„å±‚çº§æ•°æ®ï¼Œæˆ‘ä»¬è¦å°†å®ƒä¸ç»˜å›¾æŒ‡ä»¤å»ºç«‹è”ç³»ã€‚å»ºç«‹è”ç³»æŒ‡çš„æ˜¯ï¼Œæˆ‘ä»¬è¦æŠŠæ•°æ®çš„å±‚çº§ã€ä½ç½®å’Œè¦ç»˜åˆ¶çš„åœ†çš„åŠå¾„ã€ä½ç½®ä¸€ä¸€å¯¹åº”èµ·æ¥ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬è¦æŠŠæ•°æ®è½¬æ¢æˆå›¾å½¢ä¿¡æ¯ï¼Œè¿™ä¸ªæ­¥éª¤éœ€è¦æ•°å­¦è®¡ç®—ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨d3-hierarchy<a href=\"https://github.com/d3/d3-hierarchy\">d3-hierarchy</a>è¿™ä¸ªå·¥å…·åº“è½¬æ¢æ•°æ®ã€‚</p><pre><code>(async function () {\n  const data = await (await fetch(dataSource)).json();\n\n  const regions = d3.hierarchy(data)\n    .sum(d =&gt; 1)\n    .sort((a, b) =&gt; b.value - a.value);\n\n  const pack = d3.pack()\n    .size([1600, 1600])\n    .padding(3);\n\n  const root = pack(regions);\n}());\n</code></pre><p>æ•°å­¦è®¡ç®—çš„å†…å®¹ï¼Œæˆ‘ä¼šåœ¨æ•°æ®ç¯‡ä¸­è¯¦ç»†æ¥è®²ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬å°±å…ˆä¸ä»‹ç»d3çš„å…·ä½“è½¬æ¢å®ç°äº†ï¼Œä½ åªéœ€è¦çŸ¥é“ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨d3.hierarchy(data).sum(â€¦).sort(â€¦)å°†çœä»½æ•°æ®æŒ‰ç…§åŒ…å«åŸå¸‚çš„æ•°é‡ï¼Œä»å¤šåˆ°å°‘æ’åºå°±å¯ä»¥äº†ã€‚</p><p>å‡è®¾ï¼Œæˆ‘ä»¬è¦å°†å®ƒä»¬å±•ç°åœ¨ä¸€ä¸ªç”»å¸ƒå®½é«˜ä¸º1600 * 1600çš„Canvasä¸­ï¼Œé‚£æˆ‘ä»¬å¯ä»¥é€šè¿‡d3.pack()å°†æ•°æ®æ˜ å°„ä¸ºä¸€ç»„1600å®½é«˜èŒƒå›´å†…çš„åœ†å½¢ã€‚ä¸è¿‡ï¼Œä¸ºäº†å±•ç¤ºå¾—ç¾è§‚ä¸€äº›ï¼Œåœ¨æ¯ä¸ªç›¸é‚»çš„åœ†ä¹‹é—´æˆ‘ä»¬è¿˜ä¿ç•™3ä¸ªåƒç´ çš„paddingï¼ˆæŒ‰ç…§ç»éªŒï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ä¿ç•™3ä¸ªåƒç´ paddingçš„ï¼Œä½†è¿™ä¹Ÿè¦æ ¹æ®å®é™…çš„è®¾è®¡éœ€æ±‚æ¥æ›´æ”¹ï¼‰ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±è·å¾—äº†åŒ…å«å‡ ä½•å›¾å½¢ä¿¡æ¯çš„æ•°æ®å¯¹è±¡ã€‚æ­¤æ—¶å®ƒçš„å†…éƒ¨ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>{\n  data: {name: 'ä¸­å›½', children: [...]},\n  children: [\n    {\n      data: {name: 'æ±Ÿè‹', children: [...]},\n      value: 7,\n      r: 186.00172579386546,\n      x: 586.5048250548921,\n      y: 748.2441892254667,\n    }\n    ...\n  ],\n  value: 69,\n  x: 800,\n  y: 800,\n  r: 800,\n}\n</code></pre><p>æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯æ˜¯æ•°æ®ä¸­çš„xã€yã€rï¼Œè¿™äº›æ•°å€¼æ˜¯å‰é¢è°ƒç”¨d3.hierarchyå¸®æˆ‘ä»¬ç®—å‡ºæ¥çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦ç”¨Canvaså°†å®ƒä»¬ç»˜åˆ¶å‡ºæ¥å°±å¯ä»¥äº†ã€‚å…·ä½“ç»˜åˆ¶è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œ<strong>åªéœ€è¦éå†æ•°æ®å¹¶ä¸”æ ¹æ®æ•°æ®å†…å®¹ç»˜åˆ¶åœ†å¼§</strong>ï¼Œæˆ‘ä¹ŸæŠŠå®ƒæ€»ç»“æˆäº†ä¸¤æ­¥ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šæˆ‘ä»¬åœ¨å½“å‰æ•°æ®èŠ‚ç‚¹ç»˜åˆ¶ä¸€ä¸ªåœ†ï¼Œåœ†å¯ä»¥ä½¿ç”¨arcæŒ‡ä»¤æ¥ç»˜åˆ¶ã€‚arcæ–¹æ³•çš„äº”ä¸ªå‚æ•°åˆ†åˆ«æ˜¯åœ†å¿ƒçš„xã€yåæ ‡ã€åŠå¾„rã€èµ·å§‹è§’åº¦å’Œç»“æŸè§’åº¦ï¼Œå‰ä¸‰ä¸ªå‚æ•°å°±æ˜¯æ•°æ®ä¸­çš„xã€yå’Œrã€‚å› ä¸ºæˆ‘ä»¬è¦ç»˜åˆ¶çš„æ˜¯æ•´åœ†ï¼Œæ‰€ä»¥åé¢çš„ä¸¤ä¸ªå‚æ•°ä¸­èµ·å§‹è§’æ˜¯0ï¼Œç»“æŸè§’æ˜¯2Ï€ã€‚</p><p>ç¬¬äºŒæ­¥ï¼Œç»˜åˆ¶å›¾æˆåï¼Œå¦‚æœè¿™ä¸ªæ•°æ®èŠ‚ç‚¹æœ‰ä¸‹ä¸€çº§æ•°æ®ï¼Œæˆ‘ä»¬éå†å®ƒçš„ä¸‹ä¸€çº§æ•°æ®ï¼Œç„¶åé€’å½’åœ°å¯¹è¿™äº›æ•°æ®è°ƒç”¨ç»˜å›¾è¿‡ç¨‹ã€‚å¦‚æœæ²¡æœ‰ä¸‹ä¸€çº§æ•°æ®ï¼Œè¯´æ˜å½“å‰æ•°æ®ä¸ºåŸå¸‚æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç›´æ¥ç»™å‡ºåŸå¸‚çš„åå­—ï¼Œè¿™ä¸€æ­¥å¯ä»¥é€šè¿‡fillTextæŒ‡ä»¤æ¥å®Œæˆã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code>const TAU = 2 * Math.PI;\n\nfunction draw(ctx, node, {fillStyle = 'rgba(0, 0, 0, 0.2)', textColor = 'white'} = {}) {\n  const children = node.children;\n  const {x, y, r} = node;\n  ctx.fillStyle = fillStyle;\n  ctx.beginPath();\n  ctx.arc(x, y, r, 0, TAU);\n  ctx.fill();\n  if(children) {\n    for(let i = 0; i &lt; children.length; i++) {\n      draw(ctx, children[i]);\n    }\n  } else {\n    const name = node.data.name;\n    ctx.fillStyle = textColor;\n    ctx.font = '1.5rem Arial';\n    ctx.textAlign = 'center';\n    ctx.fillText(name, x, y);\n  }\n}\n\ndraw(context, root);\n</code></pre><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±ç”¨Canvasç»˜å›¾ç®€å•åœ°å®ç°äº†ä¸€ä¸ªå±‚æ¬¡å…³ç³»å›¾ï¼Œå®ƒçš„ä»£ç ä¸å¤šä¹Ÿä¸å¤æ‚ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“ç†è§£ï¼Œæ‰€ä»¥æˆ‘å°±ä¸åšè¿‡å¤šçš„è§£é‡Šå•¦ã€‚</p><h2>Canvasæœ‰å“ªäº›ä¼˜ç¼ºç‚¹ï¼Ÿ</h2><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œç›¸ä¿¡ä½ å·²ç»ç†Ÿæ‚‰äº†Canvasçš„åŸºç¡€ç”¨æ³•ã€‚ä½†æ˜¯ï¼Œæµè§ˆå™¨æ˜¯ä¸€ä¸ªå¤æ‚çš„å›¾å½¢ç¯å¢ƒï¼Œè¦æƒ³çµæ´»ä½¿ç”¨Canvasï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä»å®è§‚å±‚é¢æ¥çŸ¥é“ï¼Œå®ƒèƒ½åšä»€ä¹ˆï¼Œä¸èƒ½åšä»€ä¹ˆã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¦äº†è§£Canvas çš„ä¼˜ç¼ºç‚¹ã€‚</p><p>é¦–å…ˆï¼ŒCanvasæ˜¯ä¸€ä¸ªéå¸¸ç®€å•æ˜“ç”¨çš„å›¾å½¢ç³»ç»Ÿã€‚ç»“åˆåˆšæ‰çš„ä¾‹å­ä½ ä¹Ÿèƒ½æ„Ÿå—åˆ°ï¼ŒCanvasé€šè¿‡ä¸€ç»„ç®€å•çš„ç»˜å›¾æŒ‡ä»¤ï¼Œå°±èƒ½å¤Ÿæ–¹ä¾¿å¿«æ·åœ°ç»˜åˆ¶å‡ºå„ç§å¤æ‚çš„å‡ ä½•å›¾å½¢ã€‚</p><p>å¦å¤–ï¼ŒCanvasæ¸²æŸ“èµ·æ¥ç›¸å½“é«˜æ•ˆã€‚å³ä½¿æ˜¯ç»˜åˆ¶å¤§é‡è½®å»“éå¸¸å¤æ‚çš„å‡ ä½•å›¾å½¢ï¼ŒCanvasä¹Ÿåªéœ€è¦è°ƒç”¨ä¸€ç»„ç®€å•çš„ç»˜å›¾æŒ‡ä»¤å°±èƒ½é«˜æ€§èƒ½åœ°å®Œæˆæ¸²æŸ“ã€‚è¿™ä¸ªå‘€ï¼Œå…¶å®å’ŒCanvasæ›´åå‘äºæ¸²æŸ“å±‚ï¼Œèƒ½å¤Ÿæä¾›åº•å±‚çš„å›¾å½¢æ¸²æŸ“APIæœ‰å…³ã€‚é‚£åœ¨å®é™…å®ç°å¯è§†åŒ–ä¸šåŠ¡çš„æ—¶å€™ï¼ŒCanvaså‡ºè‰²çš„æ¸²æŸ“èƒ½åŠ›æ­£æ˜¯å®ƒçš„ä¼˜åŠ¿æ‰€åœ¨ã€‚</p><p>ä¸è¿‡Canvasä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå› ä¸ºCanvasåœ¨HTMLå±‚é¢ä¸Šæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç”»å¸ƒå…ƒç´ ï¼Œæ‰€ä»¥æ‰€æœ‰çš„ç»˜åˆ¶å†…å®¹éƒ½æ˜¯åœ¨å†…éƒ¨é€šè¿‡ç»˜å›¾æŒ‡ä»¤æ¥å®Œæˆçš„ï¼Œç»˜åˆ¶å‡ºçš„å›¾å½¢å¯¹äºæµè§ˆå™¨æ¥è¯´ï¼Œåªæ˜¯Canvasä¸­çš„ä¸€ä¸ªä¸ªåƒç´ ç‚¹ï¼Œæˆ‘ä»¬å¾ˆéš¾ç›´æ¥æŠ½å–å…¶ä¸­çš„å›¾å½¢å¯¹è±¡è¿›è¡Œæ“ä½œã€‚</p><p>æ¯”å¦‚è¯´ï¼Œåœ¨HTMLæˆ–SVGä¸­ç»˜åˆ¶ä¸€ç³»åˆ—å›¾å½¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€ä¸€è·å–è¿™äº›å›¾å½¢çš„å…ƒç´ å¯¹è±¡ï¼Œç„¶åç»™å®ƒä»¬ç»‘å®šç”¨æˆ·äº‹ä»¶ã€‚ä½†åŒæ ·çš„æ“ä½œåœ¨Canvasä¸­æ²¡æœ‰å¯ä»¥å®ç°çš„ç®€å•æ–¹æ³•ï¼ˆä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¯ä»¥å’ŒCanvaså›¾å½¢äº¤äº’ï¼Œåœ¨åç»­è¯¾ç¨‹ä¸­æˆ‘ä»¬ä¼šæœ‰ä¸“é—¨è®¨è®ºï¼‰ã€‚ä¸‹ä¸€èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬ä¼šè¯¦ç»†è®²è§£SVGå›¾å½¢ç³»ç»Ÿï¼Œåˆ°æ—¶ä½ å°±ä¼šæ›´åŠ æ˜ç™½å®ƒä»¬çš„å·®å¼‚å…·ä½“æ˜¯ä»€ä¹ˆäº†ã€‚</p><h2>è¦ç‚¹æ€»ç»“</h2><p>å¥½äº†ï¼ŒCanvasçš„ä½¿ç”¨è®²å®Œäº†ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ä½ è¦æŒæ¡çš„é‡ç‚¹å†…å®¹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è®²äº†åˆ©ç”¨Canvasç»˜åˆ¶å‡ ä½•å›¾å½¢ï¼Œè¿™ä¸ªè¿‡ç¨‹å¾ˆç®€å•ï¼Œä¸è¿‡ä¾ç„¶æœ‰3ç‚¹éœ€è¦æˆ‘ä»¬æ³¨æ„ï¼š</p><ol>\n<li>åœ¨HTMLä¸­å»ºç«‹ç”»å¸ƒæ—¶ï¼Œæˆ‘ä»¬è¦åˆ†åˆ«è®¾ç½®ç”»å¸ƒå®½é«˜å’Œæ ·å¼å®½é«˜ï¼›</li>\n<li>åœ¨å»ºç«‹åæ ‡ç³»æ—¶ï¼Œæˆ‘ä»¬è¦æ³¨æ„canvasçš„åæ ‡ç³»å’Œç¬›å¡å°”åæ ‡ç³»åœ¨yè½´ä¸Šæ˜¯ç›¸åçš„ï¼›</li>\n<li>å¦‚æœè¦æŠŠå›¾å½¢ç»˜åˆ¶åœ¨ç”»å¸ƒä¸­å¿ƒï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥è®©xã€yçš„åæ ‡ç­‰äºç”»å¸ƒä¸­å¿ƒåæ ‡ï¼Œè€Œæ˜¯è¦è®©å›¾å½¢ä¸­å¿ƒå’Œç”»å¸ƒä¸­å¿ƒçš„ä½ç½®é‡å ã€‚è¿™ä¸ªæ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—é¡¶ç‚¹åæ ‡æˆ–è€… å¹³ç§»å˜æ¢æ¥å®ç°ã€‚</li>\n</ol><p>æ¥ç€ï¼Œæˆ‘ä»¬è®²äº†åˆ©ç”¨Canvaså±•ç¤ºæ•°æ®çš„å±‚çº§å…³ç³»ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬åº”å½“å…ˆå¤„ç†æ•°æ®ï¼Œå°†æ•°æ®å†…å®¹ä¸ç»˜å›¾æŒ‡ä»¤å»ºç«‹æ˜ å°„å…³ç³»ï¼Œç„¶åéå†æ•°æ®ï¼Œé€šè¿‡æ˜ å°„å…³ç³»å°†ä»£è¡¨æ•°æ®å†…å®¹çš„å‚æ•°ä¼ ç»™ç»˜å›¾æŒ‡ä»¤ï¼Œæœ€åå°†å›¾å½¢ç»˜åˆ¶åˆ°Canvasä¸Šã€‚</p><p>å¦å¤–ï¼Œæˆ‘ä»¬è¿˜è®²äº†Canvasçš„ä¼˜ç¼ºç‚¹ã€‚åœ¨å®é™…å®ç°å¯è§†åŒ–ä¸šåŠ¡çš„æ—¶å€™ï¼ŒCanvasçš„ç®€å•æ˜“æ“ä½œå’Œé«˜æ•ˆçš„æ¸²æŸ“èƒ½åŠ›æ˜¯å®ƒçš„ä¼˜åŠ¿ï¼Œä½†æ˜¯å®ƒçš„ç¼ºç‚¹æ˜¯ä¸èƒ½æ–¹ä¾¿åœ°æ§åˆ¶å®ƒå†…éƒ¨çš„å›¾å½¢å…ƒç´ ã€‚</p><p>æœ€åï¼Œæˆ‘è¿˜æœ‰ä¸€ç‚¹æƒ³è¦è¡¥å……ä¸€ä¸‹ã€‚æˆ‘ä»¬ä»Šå¤©ç»˜åˆ¶çš„å›¾å½¢éƒ½æ˜¯é™æ€çš„ï¼Œå¦‚æœè¦ä½¿ç”¨Canvasç»˜åˆ¶åŠ¨æ€çš„å›¾å½¢ä¹Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡clearRectæŒ‡ä»¤ï¼Œå°†ä¹‹å‰çš„å›¾å½¢æ“¦é™¤ï¼Œå†æŠŠæ–°çš„å›¾å½¢ç»˜åˆ¶ä¸Šå»å³å¯ã€‚åœ¨åç»­è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸“é—¨çš„ç« èŠ‚æ¥ä»‹ç»åŠ¨ç”»ã€‚</p><h2>å°è¯•ç‰›åˆ€</h2><p>æœ€åå‘¢ï¼Œæˆ‘ä¸ºä½ å‡†å¤‡äº†ä¸¤é“è¯¾åé¢˜ï¼Œè¯•ç€åŠ¨æ‰‹æ“ä½œä¸€ä¸‹å§ï¼</p><ol>\n<li>è¿™èŠ‚è¯¾æˆ‘ä»¬ä»‹ç»äº†ç”¨Canvasç»˜åˆ¶çŸ©å½¢å’Œåœ†å¼§ï¼Œå®é™…ä¸ŠCanvasè¿˜æœ‰æ›´å¤šçš„ç»˜å›¾æŒ‡ä»¤æ¥ç»˜åˆ¶ä¸åŒç±»å‹çš„å‡ ä½•å›¾å½¢ã€‚ä½ å¯ä»¥è¯•ç€ä¿®æ”¹ä¸€ä¸‹å‰é¢æ˜¾ç¤ºæ­£æ–¹å½¢çš„ä¾‹å­ï¼Œåœ¨ç”»å¸ƒçš„ä¸­å¿ƒä½ç½®æ˜¾ç¤ºä¸€ä¸ªä¸‰è§’å½¢ã€æ¤­åœ†æˆ–äº”è§’æ˜Ÿã€‚</li>\n<li>Canvasçš„ç¼ºç‚¹æ˜¯ä¸èƒ½æ–¹ä¾¿åœ°æ§åˆ¶å®ƒå†…éƒ¨çš„å›¾å½¢å…ƒç´ ï¼Œä½†è¿™ä¸ä»£è¡¨å®ƒå®Œå…¨ä¸èƒ½æ§åˆ¶ã€‚ä½ å¯ä»¥å°è¯•ç»™æˆ‘ä»¬å‰é¢ç»˜åˆ¶çš„å±‚æ¬¡å…³ç³»å›¾å¢åŠ é¼ æ ‡çš„äº¤äº’ï¼Œè®©é¼ æ ‡æŒ‡é’ˆåœ¨ç§»åŠ¨åˆ°æŸä¸ªåŸå¸‚æ‰€å±çš„åœ†çš„æ—¶å€™ï¼Œè¿™ä¸ªåœ†æ˜¾ç¤ºä¸åŒçš„é¢œè‰²ï¼ˆæç¤ºï¼šä½ å¯ä»¥è·å–é¼ æ ‡åæ ‡ï¼Œç„¶åç”¨è¿™ä¸ªåæ ‡åˆ°åœ†å¿ƒçš„è·ç¦»æ¥åˆ¤æ–­ï¼‰ã€‚</li>\n</ol><p>æ¬¢è¿åœ¨ç•™è¨€åŒºå’Œæˆ‘è®¨è®ºï¼Œåˆ†äº«ä½ çš„ç­”æ¡ˆå’Œæ€è€ƒï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ï¼</p><hr><h2><span class=\"reference\">æºç </span></h2><p><span class=\"reference\"><a href=\"https://github.com/akira-cn/graphics/tree/master/canvas/hierarchy\">ç”¨Canvasç»˜åˆ¶å±‚æ¬¡å…³ç³»å›¾çš„å®Œæ•´ä»£ç .</a></span></p><h2><span class=\"reference\">æ¨èé˜…è¯»</span></h2><p><span class=\"reference\">[1] <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial\">MDNå®˜æ–¹æ–‡æ¡£.</a></span></p>","neighbors":{"left":{"article_title":"01 | æµè§ˆå™¨ä¸­å®ç°å¯è§†åŒ–çš„å››ç§æ–¹å¼","id":252076},"right":{"article_title":"03 | å£°æ˜å¼å›¾å½¢ç³»ç»Ÿï¼šå¦‚ä½•ç”¨SVGå›¾å½¢å…ƒç´ ç»˜åˆ¶å¯è§†åŒ–å›¾è¡¨ï¼Ÿ","id":252710}},"comments":[{"had_liked":false,"id":229395,"user_name":"Spring","can_delete":false,"product_type":"c1","uid":1007267,"ip_address":"","ucode":"80594B4B056A53","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/a3/9670d4b4.jpg","comment_is_top":false,"comment_ctime":1592984510,"is_pvip":false,"replies":[{"id":"84646","content":"å¹³ç§»çš„æ˜¯åæ ‡ç³»ï¼Œä½ å¯ä»¥ç†è§£ä¸ºå°†åæ ‡åŸç‚¹ç§»åŠ¨äº†ï¼Œä¾‹å¦‚æœ¬æ¥ç”»å¸ƒå·¦ä¸Šè§’åæ ‡æ˜¯0,0ï¼Œç°åœ¨translate(100,100)ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è·ç¦»ç”»å¸ƒå·¦ä¸Šè§’(100,100)å¤„çš„åæ ‡æ˜¯0,0ï¼Œç›¸åº”å·¦ä¸Šè§’åæ ‡å°±æ˜¯-100,-100äº†ã€‚ç›¸å½“äºæ­¤æ—¶å¼€å§‹å†ç»˜åˆ¶ä»»ä½•å›¾å½¢ï¼Œæ¯ä¸ªé¡¶ç‚¹çš„åæ ‡å’ŒåŸæ¥ç›¸æ¯”éƒ½åç§»äº†100,100","user_name":"ä½œè€…å›å¤","comment_id":229395,"uid":"1159792","ip_address":"","utype":1,"ctime":1592985070,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"134736970686","product_id":100053801,"comment_content":"è€å¸ˆï¼Œæœ‰ç‚¹ä¸å¤ªç†è§£translateçš„å¹³ç§»æ“ä½œï¼Œå¹³ç§»åç”»å¸ƒçš„åæ ‡ç³»æ˜¯æ€ä¹ˆå‘ç”Ÿå˜åŒ–çš„å‘¢?<br>å¹³ç§»çš„æ˜¯ç”»å¸ƒè¿˜æ˜¯åæ ‡ç³»ã€‚","like_count":32,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499467,"discussion_content":"å¹³ç§»çš„æ˜¯åæ ‡ç³»ï¼Œä½ å¯ä»¥ç†è§£ä¸ºå°†åæ ‡åŸç‚¹ç§»åŠ¨äº†ï¼Œä¾‹å¦‚æœ¬æ¥ç”»å¸ƒå·¦ä¸Šè§’åæ ‡æ˜¯0,0ï¼Œç°åœ¨translate(100,100)ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è·ç¦»ç”»å¸ƒå·¦ä¸Šè§’(100,100)å¤„çš„åæ ‡æ˜¯0,0ï¼Œç›¸åº”å·¦ä¸Šè§’åæ ‡å°±æ˜¯-100,-100äº†ã€‚ç›¸å½“äºæ­¤æ—¶å¼€å§‹å†ç»˜åˆ¶ä»»ä½•å›¾å½¢ï¼Œæ¯ä¸ªé¡¶ç‚¹çš„åæ ‡å’ŒåŸæ¥ç›¸æ¯”éƒ½åç§»äº†100,100","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592985070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229626,"user_name":"ç‰¹å¼‚å‹å¤§å…‰å¤´","can_delete":false,"product_type":"c1","uid":2047839,"ip_address":"","ucode":"44CC71886FB121","user_header":"https://static001.geekbang.org/account/avatar/00/1f/3f/5f/053bc2da.jpg","comment_is_top":false,"comment_ctime":1593076609,"is_pvip":false,"replies":[{"id":"84860","content":"è¿™ä¸¤ç§å†™æ³•æ˜¯å‚æ•°ç­¾åä¸åŒï¼Œæˆ‘ä¸Šé¢è¿™ç§å†™æ³•è°ƒç”¨èµ·æ¥è™½ç„¶éº»çƒ¦ä¸€ç‚¹ï¼Œä½†æ˜¯èƒ½è®©ä»£ç å¯è¯»æ€§æ›´å¥½ã€‚<br><br>å› ä¸ºåŒæ ·è°ƒç”¨ï¼š<br>draw(context, el, {fillStyle: &#39;red&#39;, textColor: &#39;black&#39;})<br><br>æ¯” draw(context, el, &#39;red&#39;, &#39;black&#39;) å¯è¯»æ€§è¦å¥½<br><br>å‡è®¾ä½ æ˜¯ä»£ç ç»´æŠ¤è€…ï¼Œå‰è€…ä½ ä¸€çœ‹å°±çŸ¥é“åé¢ä¸¤ä¸ªé¢œè‰²å‚æ•°å“ªä¸ªæ˜¯fillStyleï¼Œå“ªä¸ªæ˜¯textColorï¼›åè€…ä½ ä¸çœ‹å‡½æ•°å®šä¹‰ï¼Œä¸çŸ¥é“redå’Œblackåˆ†åˆ«å“ªä¸ªæ˜¯fillStyleï¼Œå“ªä¸ªæ˜¯textColorã€‚<br><br>ä»£ç æ˜¯ç»™äººé˜…è¯»çš„ï¼Œæ‰€ä»¥è®¾è®¡APIçš„æ—¶å€™éœ€è¦è€ƒè™‘è¿™æ ·çš„ç»†èŠ‚ã€‚<br><br>æ‰“ç –å—å¾ˆèµ~~","user_name":"ä½œè€…å›å¤","comment_id":229626,"uid":"1159792","ip_address":"","utype":1,"ctime":1593230847,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"87492422529","product_id":100053801,"comment_content":"åŸç†å¤§è‡´å¬æ‡‚äº†,å­¦ç€åšä¸ªæ‰“ç –å—ç»ƒä¹ <br>https:&#47;&#47;codepen.io&#47;ysosu&#47;pen&#47;MWKorYj<br>é—®é¢˜:<br>function draw(ctx, node, {fillStyle = &#39;rgba(0, 0, 0, 0.2)&#39;, textColor = &#39;white&#39;} = {}) {};<br>é‡Œé¢è¿™ä¸ª{fillStyle = &#39;rgba(0, 0, 0, 0.2)&#39;, textColor = &#39;white&#39;} = {}æ²¡çœ‹æ‡‚<br>è·Ÿè¿™æ ·å†™çš„å·®åˆ«æ˜¯å•¥function draw(ctx, node, fillStyle = &#39;rgba(0, 0, 0, 0.2)&#39;, textColor = &#39;white&#39; ) {};","like_count":21,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499569,"discussion_content":"è¿™ä¸¤ç§å†™æ³•æ˜¯å‚æ•°ç­¾åä¸åŒï¼Œæˆ‘ä¸Šé¢è¿™ç§å†™æ³•è°ƒç”¨èµ·æ¥è™½ç„¶éº»çƒ¦ä¸€ç‚¹ï¼Œä½†æ˜¯èƒ½è®©ä»£ç å¯è¯»æ€§æ›´å¥½ã€‚\n\nå› ä¸ºåŒæ ·è°ƒç”¨ï¼š\ndraw(context, el, {fillStyle: &amp;#39;red&amp;#39;, textColor: &amp;#39;black&amp;#39;})\n\næ¯” draw(context, el, &amp;#39;red&amp;#39;, &amp;#39;black&amp;#39;) å¯è¯»æ€§è¦å¥½\n\nå‡è®¾ä½ æ˜¯ä»£ç ç»´æŠ¤è€…ï¼Œå‰è€…ä½ ä¸€çœ‹å°±çŸ¥é“åé¢ä¸¤ä¸ªé¢œè‰²å‚æ•°å“ªä¸ªæ˜¯fillStyleï¼Œå“ªä¸ªæ˜¯textColorï¼›åè€…ä½ ä¸çœ‹å‡½æ•°å®šä¹‰ï¼Œä¸çŸ¥é“redå’Œblackåˆ†åˆ«å“ªä¸ªæ˜¯fillStyleï¼Œå“ªä¸ªæ˜¯textColorã€‚\n\nä»£ç æ˜¯ç»™äººé˜…è¯»çš„ï¼Œæ‰€ä»¥è®¾è®¡APIçš„æ—¶å€™éœ€è¦è€ƒè™‘è¿™æ ·çš„ç»†èŠ‚ã€‚\n\næ‰“ç –å—å¾ˆèµ~~","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1593230847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1468864,"avatar":"https://static001.geekbang.org/account/avatar/00/16/69/c0/5558436f.jpg","nickname":"I have a dream","note":"","ucode":"9BBB3B6AE87568","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347440,"discussion_content":"å¤§ä½¬å¤ªå‰å®³äº†ï¼Œå°±å­¦äº†è¿™ä¸€ç‚¹å°±èƒ½åšå‡ºæ¥è¿™æ ·çš„å°æ¸¸æˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612232364,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229739,"user_name":"å®åº·","can_delete":false,"product_type":"c1","uid":1044760,"ip_address":"","ucode":"B7FB9DDFFF3F69","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f1/18/63b9bd3c.jpg","comment_is_top":false,"comment_ctime":1593135448,"is_pvip":false,"replies":[{"id":"84857","content":"èµ~è¿™ä¸ªäº”å­æ£‹ä¸é”™ã€‚åŒæ ·å®½åº¦è¦†ç›–ï¼Œå› ä¸ºCanvasæœ‰åé”¯é½¿ç­‰å¤„ç†ï¼Œå¦å¤–è¿˜æœ‰å…‰æ …åŒ–çš„ç²¾åº¦é—®é¢˜ï¼Œæ‰€ä»¥è¾¹ç¼˜çš„åƒç´ ä¼šè¦†ç›–ä¸äº†çš„ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯éœ€è¦å¢åŠ çº¿å®½ï¼Œè¿™ä¸ªæ˜¯æ­£å¸¸çš„ã€‚","user_name":"ä½œè€…å›å¤","comment_id":229739,"uid":"1159792","ip_address":"","utype":1,"ctime":1593230485,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"74607579480","product_id":100053801,"comment_content":"å€Ÿé‰´äº†ä¹‹å‰ç•™è¨€çš„æœ‹å‹çš„éƒ¨åˆ†é€»è¾‘é‡æ–°å¼€å‘äº†ä¸€ä¸ªäº”å­æ£‹ç¨‹åºï¼Œä¸»è¦ä¿®æ”¹äº†å‡ ä¸ªåœ°æ–¹ï¼š<br>- ä½¿ç”¨äºŒç»´æ•°ç»„è®°å½•è½å­æƒ…å†µï¼Œæ–¹ä¾¿åç»­åˆ¤æ–­èƒœè´Ÿ<br>- é‡æ–°è·å–å…‰æ ‡åä¸è¿›è¡Œæ•´ä¸ªæ£‹ç›˜çš„æ¸²æŸ“ï¼Œè€Œæ˜¯å°†ä¸Šä¸€ä¸ªå…‰æ ‡å¤„å±€éƒ¨ä¿®å¤<br>- æ ¹æ®å½“å‰è½å­å‘¨å›´å…«ä¸ªæ–¹å‘4ä¸ªå•ä½è·ç¦»çš„æ£‹ç›˜ä¸­æ˜¯å¦èµ¢äº†<br><br>é‡åˆ°çš„é—®é¢˜ï¼š<br>- å…‰æ ‡æ˜¯ç”¨1ä¸ªå•ä½çº¿å®½ç»˜åˆ¶å‡ºæ¥çš„ï¼Œæˆ‘ç”¨åŒæ ·ä¸€ä¸ªå•ä½çº¿å®½å»è¦†ç›–ï¼Œå‘ç°è¦†ç›–ä¸å…¨ï¼Œè¿˜ä¼šæ®‹ç•™çº¿æ®µï¼Œæœ€ååªèƒ½åŠ å¤§çº¿å®½å»è¦†ç›–ï¼Œè¯·é—®è€å¸ˆè¿™ä¸ªæ˜¯ä»€ä¹ˆé—®é¢˜ï¼Ÿ<br><br>äº”å­æ£‹åœ¨çº¿é¢„è§ˆï¼šhttps:&#47;&#47;codesandbox.io&#47;s&#47;chess-demo-d2qgt","like_count":18,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499618,"discussion_content":"èµ~è¿™ä¸ªäº”å­æ£‹ä¸é”™ã€‚åŒæ ·å®½åº¦è¦†ç›–ï¼Œå› ä¸ºCanvasæœ‰åé”¯é½¿ç­‰å¤„ç†ï¼Œå¦å¤–è¿˜æœ‰å…‰æ …åŒ–çš„ç²¾åº¦é—®é¢˜ï¼Œæ‰€ä»¥è¾¹ç¼˜çš„åƒç´ ä¼šè¦†ç›–ä¸äº†çš„ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯éœ€è¦å¢åŠ çº¿å®½ï¼Œè¿™ä¸ªæ˜¯æ­£å¸¸çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593230485,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2046753,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/3b/21/69b8cebe.jpg","nickname":"undefined","note":"","ucode":"0CDDEFC591E3AF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383144,"discussion_content":"æ€»ä½“å¾ˆä¸é”™ï¼Œæœ€åèµ¢çš„æ—¶å€™æŠ¥é”™äº†\nReferenceError\nsetImmediate is not defined\nVueComponent.judgeWin\n/src/App.vue:397:10","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625926563,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313600,"user_name":"é˜¿è¾‰","can_delete":false,"product_type":"c1","uid":1202750,"ip_address":"","ucode":"152F586FF94755","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/OCfic4TOUJjGfeVe7I7hKNYsibiazsrGyRxoRbqVPkpl5j4y8vkKjqeApPh2akhriazOiaWWEwlXeSDGas1kQ4RLRPg/132","comment_is_top":false,"comment_ctime":1632550837,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"44582223797","product_id":100053801,"comment_content":"å°±çœ‹è¿™ä¸€èŠ‚è¯¾ï¼Œå°±èƒ½å†™å‡ºä¸€ä¸ªäº”å­æ£‹ï¼Ÿè¿™äº›ç•™è¨€è¿˜æŒºè®©åˆå­¦è€…æœ‰æ²®ä¸§æ„Ÿçš„","like_count":11,"discussions":[{"author":{"id":1017863,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/88/07/7804f4cc.jpg","nickname":"é€—é€¼å¸ˆçˆ¶","note":"","ucode":"ECC2D82F83CBE6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":560930,"discussion_content":"ç‚«æŠ€å•Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1649493086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1625453,"avatar":"https://static001.geekbang.org/account/avatar/00/18/cd/6d/928b0ffd.jpg","nickname":"ã€è½»","note":"","ucode":"30713196ED1AA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555033,"discussion_content":"è¿™å°±æ˜¯å·å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646724910,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2497664,"avatar":"","nickname":"Geek_dbf9da","note":"","ucode":"5F48CEDA7E964C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553025,"discussion_content":"æ˜¯çš„ æƒŠå‘†äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645693902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2054910,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/5a/fe/3fada2bb.jpg","nickname":"permit","note":"","ucode":"081DE5CA35C98A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530711,"discussion_content":"å¤§å®¶åŸºç¡€ä¸ä¸€æ ·ã€‚å­¦å®Œäº†ï¼Œä½ ä¹Ÿå¯ä»¥ï¼ŒåŠ æ²¹å‘€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637132456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229491,"user_name":"Geek_3469f6","can_delete":false,"product_type":"c1","uid":2047009,"ip_address":"","ucode":"AE8CA3C7A8EF86","user_header":"https://static001.geekbang.org/account/avatar/00/1f/3c/21/58f3740d.jpg","comment_is_top":false,"comment_ctime":1593014752,"is_pvip":false,"replies":[{"id":"84723","content":"èµğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":229491,"uid":"1159792","ip_address":"","utype":1,"ctime":1593047261,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"40247720416","product_id":100053801,"comment_content":"è€å¸ˆç°åœ¨è®²çš„è¿˜å¯ä»¥å®Œå…¨å¬æ‡‚ï¼Œå­¦ä¹ äº†ä¹‹åç«‹åˆ»å®è·µäº†ä»¥ä¸‹ã€‚å¹¶ä¸”ï¼Œå­¦ç»ƒç»“åˆï¼ŒæŠŠä»¥å‰çš„æƒ³æ³•å®ç°äº†ä¸‹ã€‚è¿™æ¬¡æ²¡æœ‰å·æ‡’ã€‚ç”»äº†ä¸ªäº”å­æ£‹ç›˜+æ£‹å­ï¼Œè¾“èµ¢åˆ¤å®šé€»è¾‘è¿˜æ²¡å†™ã€‚<br>https:&#47;&#47;codepen.io&#47;maslke&#47;pen&#47;MWKoKKp","like_count":10,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499504,"discussion_content":"èµğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593047261,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308710,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f8/26/e0bd8d24.jpg","nickname":"Crystal","note":"","ucode":"1481B20843D690","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333723,"discussion_content":"ä¸ºä»€ä¹ˆéƒ½åœ¨å†™äº”å­æ£‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607604231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229325,"user_name":"éšé‡è€Œå®‰","can_delete":false,"product_type":"c1","uid":1940389,"ip_address":"","ucode":"03F1F3CA355232","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9b/a5/90a5c106.jpg","comment_is_top":false,"comment_ctime":1592965439,"is_pvip":false,"replies":[{"id":"84679","content":"æ£’ï½","user_name":"ä½œè€…å›å¤","comment_id":229325,"uid":"1159792","ip_address":"","utype":1,"ctime":1592988324,"user_name_real":"æœˆå½±"}],"discussion_count":4,"race_medal":0,"score":"40247671103","product_id":100053801,"comment_content":"æˆ‘å°è¯•äº†ç”¨canvasç»˜åˆ¶ä¸è§„åˆ™å¤šè¾¹å½¢ï¼Œå¦‚æœæƒ³è¦æ·»åŠ é¼ æ ‡äº¤äº’äº‹ä»¶ï¼Œè·å–åˆ°é¼ æ ‡çš„åæ ‡ä¹‹åï¼Œå¯ä»¥åˆ©ç”¨å‡¸åŒ…ç®—æ³•åˆ¤æ–­ç‚¹æ˜¯å¦åœ¨ä¸è§„åˆ™å¤šè¾¹å½¢å†…ã€‚","like_count":9,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499441,"discussion_content":"æ£’ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592988324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1381864,"avatar":"https://static001.geekbang.org/account/avatar/00/15/15/e8/519df449.jpg","nickname":"1973","note":"","ucode":"0C34E2372985BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289169,"discussion_content":"è¯·é—®ï¼Œå‡¸åŒ…ç®—æ³•æ˜¯å•¥ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594013938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1374421,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f8/d5/fd04fcbc.jpg","nickname":"Kite","note":"","ucode":"9DACE8E0EC84A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1381864,"avatar":"https://static001.geekbang.org/account/avatar/00/15/15/e8/519df449.jpg","nickname":"1973","note":"","ucode":"0C34E2372985BF","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":300045,"discussion_content":"çœ‹çœ‹è¿™ä¸ªï¼šhttps://www.cnblogs.com/cglongge/p/9408417.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597917908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":289169,"ip_address":""},"score":300045,"extra":""}]},{"author":{"id":1473187,"avatar":"","nickname":"è™šç«¹","note":"","ucode":"96617FB3A417E2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":286296,"discussion_content":"ä¸€èˆ¬éƒ½ç”¨isPointInPathå’ŒåŒ…å›´ç›’æ¥åšæ‹¾å–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593108346,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297272,"user_name":"è‰¯è¾°ç¾æ™¯å²‚è™šè®¾","can_delete":false,"product_type":"c1","uid":1376778,"ip_address":"","ucode":"69654CD67EE1AB","user_header":"https://static001.geekbang.org/account/avatar/00/15/02/0a/5d81243a.jpg","comment_is_top":false,"comment_ctime":1623400695,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"31688171767","product_id":100053801,"comment_content":"å±‚æ¬¡ç»“æ„æ•°æ®æ¥å£https:&#47;&#47;s5.ssl.qhres.com&#47;static&#47;b0695e2dd30daa64.json ä¸èƒ½ç”¨äº†","like_count":8,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":401864,"discussion_content":"è¦æ¢æˆqhres2","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633752809,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229813,"user_name":"ç­‘æ¢¦å¸ˆåˆ˜æ¸Š","can_delete":false,"product_type":"c1","uid":1026867,"ip_address":"","ucode":"35C309A266AC02","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ab/33/75b1f724.jpg","comment_is_top":false,"comment_ctime":1593153911,"is_pvip":false,"replies":[{"id":"84855","content":"å¾ˆæ£’~","user_name":"ä½œè€…å›å¤","comment_id":229813,"uid":"1159792","ip_address":"","utype":1,"ctime":1593229820,"user_name_real":"æœˆå½±"}],"discussion_count":5,"race_medal":0,"score":"14478055799","product_id":100053801,"comment_content":"ä½œä¸š2:<br><br>1. å…ˆå°è£…ä¸€ä¸ªæ¸…é™¤åœ†å½¢æ–¹æ³•ï¼š           <br> CanvasRenderingContext2D.prototype.clearCircle = function (x, y,r) {<br>                context.save();<br>                context.fillStyle = &quot;rgba(255,255,255,255)&quot;;<br>                context.beginPath();<br>                context.arc(x, y, r, 0, TAU);<br>                context.fill();<br>                context.restore();<br>            };<br>2. æ£€æµ‹é¼ æ ‡æ˜¯å¦åœ¨åœ†å†…(åœ¨åœ†å†…å°±å…ˆæ¸…é™¤åœ†å†ç»˜åˆ¶åç§°å’Œæ–°é¢œè‰²):<br>            &#47;&#47; é¼ æ ‡æ£€æµ‹ç§»åŠ¨åˆ°å°åœ†å°±å˜è‰²<br>            function isInCircle(ctx, mx, my, node) {<br>                const children = node.children;<br>                if (children) {<br>                    for (let i = 0; i &lt; children.length; i++) {<br>                        isInCircle(ctx, mx, my, children[i]);<br>                    }<br>                } else {<br>                    const { x, y, r } = node;<br>                    if ((my - y) * (my - y) + (mx - x) * (mx - x) &lt; r * r) {<br>                        console.log(x, y);<br>                        ctx.clearCircle(x, y, r);<br>                        ctx.fillStyle = &quot;rgba(255,0,0,0.2)&quot;;<br>                        ctx.beginPath();<br>                        ctx.arc(x, y, r, 0, TAU);<br>                        ctx.fill();<br>                        const name = node.data.name;<br>                        ctx.fillStyle = &quot;white&quot;;<br>                        ctx.font = &quot;1.5rem Arial&quot;;<br>                        ctx.textAlign = &quot;center&quot;;<br>                        ctx.fillText(name, x, y);<br>                    }<br>                }<br>            }<br>3. ç›‘å¬é¼ æ ‡mousemoveäº‹ä»¶(å˜æ¢é¡µé¢é¼ æ ‡ä½ç½®ä¸canvaså†…åæ ‡çš„å…³ç³»)ï¼š<br>                canvas.addEventListener(&quot;mousemove&quot;, (e) =&gt; {<br>                    const x = e.clientX * 2;<br>                    const y = e.clientY * 2;<br>                    isInCircle(context, x, y, root);<br>                });","like_count":3,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499652,"discussion_content":"å¾ˆæ£’~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593229820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1130862,"avatar":"https://static001.geekbang.org/account/avatar/00/11/41/6e/e04ab385.jpg","nickname":"null","note":"","ucode":"3C97A82395E95C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":414998,"discussion_content":"clearCircleçš„æƒ³æ³•å¾ˆæ£’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636959432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2518919,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ9d89ymlVge9vQMDFURgib37hho3nkbFlccyL6cLj5WpIWQib8JcV0TYnqRekeKREvcKiaGEdbzq0dw/132","nickname":"fourthree","note":"","ucode":"1A5AC64F6E9CED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383827,"discussion_content":"å½“å‰é¢å‘ç”Ÿscrollçš„æƒ…å†µï¼Œéœ€é‡æ–°è®¡ç®—åœ†çš„ä¸­å¿ƒåæ ‡ï¼Œ[canvas.getBoundingClientRect().left+,canvas.getBoundingClientRect().top + y]","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626248424,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1381864,"avatar":"https://static001.geekbang.org/account/avatar/00/15/15/e8/519df449.jpg","nickname":"1973","note":"","ucode":"0C34E2372985BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289218,"discussion_content":"æ£’","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594029090,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1490128,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJwHLLQK3AicN8XqichEbfqSACpRB5kry8bIMBcuB3bSiaeic9hABrmn7TZgqaWJ8Xc1gWh6icasZCt3Fg/132","nickname":"l_j_dota_1111","note":"","ucode":"4CA8A41F5107C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288011,"discussion_content":"è¿™ç§æ–¹å¼æ˜¯ä¸€ç›´åœ¨ä¸Šé¢é‡æ–°ç”»å—ï¼Œå…¶å®åªæ˜¯æ›´æ”¹èƒŒæ™¯è‰²ï¼Œå´è¦ä¸æ–­çš„é‡å¤ç”»åœ†å’Œå­—ï¼Œæ€§èƒ½ä¸å—å½±å“å—ï¼Œæˆ‘ä¸€ç›´å¾ˆå¥½å¥‡ï¼Œè™½ç„¶èƒ½æ£€æµ‹åœ¨åœ†å†…ï¼Œä½†æ˜¯å¦‚ä½•å¾ˆå¥½çš„å˜æ¢ï¼Œå› ä¸ºç¡®å®æ— æ³•è·å¾—è¿™ä¸ªåœ†ï¼Œæ›´åˆ«è¯´æ›´æ”¹å…¶é¢œè‰²äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593612715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229358,"user_name":"gltjk","can_delete":false,"product_type":"c1","uid":1341515,"ip_address":"","ucode":"A2ACFE7D8A32C5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ7hqBj1WIXVJgRwxVEg7fREAwI04BKRM8ibzVA8DIOaLSLqIrjw8UYr9GDUFFZW7mhBLC4hSp5r9g/132","comment_is_top":false,"comment_ctime":1592973599,"is_pvip":false,"replies":[{"id":"84745","content":"å¯ä»¥ï¼Œè¿™ä¸ªæ€è·¯æŒºå¥½çš„ï¼Œå½“ç„¶è¿™ä¸ªé—®é¢˜ä¹Ÿå¯ä»¥åªç”¨ä¸€ä¸ªcanvasï¼Œä¸è¿‡ç”¨ä¸¤ä¸ªçš„å¥½å¤„ä¹Ÿæ˜¯æœ‰çš„ï¼Œè¿™æ ·åªéœ€è¦æ›´æ–°å±€éƒ¨çš„å›¾å½¢äº†ã€‚","user_name":"ä½œè€…å›å¤","comment_id":229358,"uid":"1159792","ip_address":"","utype":1,"ctime":1593070661,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"14477875487","product_id":100053801,"comment_content":"æäº¤ä¸€ä¸‹ç¬¬äºŒä¸ªä½œä¸šã€‚ä¹‹å‰çº ç»“äº†ä¸€ä¸‹æ€ä¹ˆåœ¨é¼ æ ‡ç§»å‡ºåŸå¸‚æ—¶æ¢å¤å°åœ†çš„é¢œè‰²ï¼Œæœ€åå†³å®šä¸“é—¨åšä¸€ä¸ªæ–°çš„ canvas å åœ¨ä¸Šé¢ã€‚å¦å¤–é¼ æ ‡ç§»åŠ¨çš„äº‹ä»¶æ˜¯ä¸æ˜¯è¦åšä¸ªèŠ‚æµæ¯”è¾ƒå¥½ï¼Ÿæˆ‘è¯•äº†ä¸€ä¸‹æ„Ÿè§‰åˆä¸å¤Ÿæµç•…ï¼Œå°±å»æ‰äº†â€¦â€¦ https:&#47;&#47;codepen.io&#47;gltjk&#47;pen&#47;GRomzQE","like_count":3,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499453,"discussion_content":"å¯ä»¥ï¼Œè¿™ä¸ªæ€è·¯æŒºå¥½çš„ï¼Œå½“ç„¶è¿™ä¸ªé—®é¢˜ä¹Ÿå¯ä»¥åªç”¨ä¸€ä¸ªcanvasï¼Œä¸è¿‡ç”¨ä¸¤ä¸ªçš„å¥½å¤„ä¹Ÿæ˜¯æœ‰çš„ï¼Œè¿™æ ·åªéœ€è¦æ›´æ–°å±€éƒ¨çš„å›¾å½¢äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593070661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1543460,"avatar":"https://static001.geekbang.org/account/avatar/00/17/8d/24/a2f886d3.jpg","nickname":"Rexxar","note":"","ucode":"86D0238F0F0C55","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293494,"discussion_content":"å‰ç«¯å°ç™½æ±‚é—®,è¿™ä½åŒå­¦çš„ä»£ç é‡Œä¸ºä»€ä¹ˆå¿…é¡»è¦æœ‰position: absoluteçš„æ ·å¼æ‰èƒ½ä½¿é¼ æ ‡äº‹ä»¶æ˜¾ç¤ºå‡ºæ•ˆæœ?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595559417,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":301371,"user_name":"1830","can_delete":false,"product_type":"c1","uid":1374337,"ip_address":"","ucode":"246FEF7C97F39C","user_header":"https://static001.geekbang.org/account/avatar/00/14/f8/81/bff52f91.jpg","comment_is_top":false,"comment_ctime":1625648700,"is_pvip":false,"replies":[{"id":"114137","content":"å› ä¸ºä¹‹å‰ç”¨äº†360çš„CDNæœåŠ¡ï¼Œé‚£ä¸ªåŸŸåè¿‡æœŸäº†ï¼ŒæŠŠä»£ç é‡Œé¢çš„qhreså…¨éƒ½æ¢æˆqhres2å°±å¯ä»¥äº†","user_name":"ä½œè€…å›å¤","comment_id":301371,"uid":"1159792","ip_address":"","utype":1,"ctime":1633750774,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"10215583292","product_id":100053801,"comment_content":"è€å¸ˆï¼ŒJSONæ•°æ®ä¸èƒ½ç”¨äº†å¯ä»¥è§£å†³ä¸€ä¸‹ä¸ï¼Œæˆ–è€…æŠŠæ•°æ®ç»“æ„è¦æ±‚è´´ä¸€ä¸‹æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹","like_count":2,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522982,"discussion_content":"å› ä¸ºä¹‹å‰ç”¨äº†360çš„CDNæœåŠ¡ï¼Œé‚£ä¸ªåŸŸåè¿‡æœŸäº†ï¼ŒæŠŠä»£ç é‡Œé¢çš„qhreså…¨éƒ½æ¢æˆqhres2å°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633750774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300992,"user_name":"æ˜¥é¥¼sama","can_delete":false,"product_type":"c1","uid":1843380,"ip_address":"","ucode":"B01C2B0DD7A9C0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/OGMflcxuxblzCaAAZ9uXn0ak6rgrlxp9N8tt7sd1L8n3CRrfiblmLG3yJsSepwdc2DnLG9ibDqGdH8cnAQuIQlCg/132","comment_is_top":false,"comment_ctime":1625478309,"is_pvip":false,"replies":[{"id":"114138","content":"æŠŠä»£ç é‡Œçš„qhreså…¨éƒ½æ›¿æ¢æˆqhres2å°±å¯ä»¥äº†","user_name":"ä½œè€…å›å¤","comment_id":300992,"uid":"1159792","ip_address":"","utype":1,"ctime":1633750794,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"10215412901","product_id":100053801,"comment_content":"è€å¸ˆï¼Œè·å–jsonçš„éƒ½æŒ‚äº†","like_count":2,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522869,"discussion_content":"æŠŠä»£ç é‡Œçš„qhreså…¨éƒ½æ›¿æ¢æˆqhres2å°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633750794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":232885,"user_name":"sheeeeep","can_delete":false,"product_type":"c1","uid":1340246,"ip_address":"","ucode":"218AA77BAA73C8","user_header":"https://static001.geekbang.org/account/avatar/00/14/73/56/9cfb1e43.jpg","comment_is_top":false,"comment_ctime":1594139193,"is_pvip":false,"replies":[{"id":"86029","content":"æ£’~","user_name":"ä½œè€…å›å¤","comment_id":232885,"uid":"1159792","ip_address":"","utype":1,"ctime":1594261511,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"10184073785","product_id":100053801,"comment_content":"äº¤ä½œä¸šï¼šhttps:&#47;&#47;output.jsbin.com&#47;rirahomï¼Œæ€è·¯åŸºæœ¬å’Œå¤§å®¶ä¸€è‡´ã€‚<br>çœ‹å®Œè¯„è®ºæœ‰ä¸¤ä¸ªä¸»è¦çš„ä¼˜åŒ–æ–¹æ³•ï¼š<br>1. å‡å°‘é‡ç»˜æ¬¡æ•°ï¼šåˆ¤æ–­æ˜¯å¦åœ¨ã€Œåœ†ã€å†… æˆ– åˆ¤æ–­ç»“æœå’Œä¸Šæ¬¡ä¸åŒï¼Œæ‰è¿›è¡Œé‡ç»˜<br>2. ç¼©å°é‡ç»˜åŒºåŸŸï¼šè¿›è¡Œå±€éƒ¨æ¸…é™¤å’Œå±€éƒ¨é‡ç»˜","like_count":2,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500795,"discussion_content":"æ£’~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594261511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1500459,"avatar":"https://static001.geekbang.org/account/avatar/00/16/e5/2b/47a48b9b.jpg","nickname":"æŸ³æ—åšå¼ˆ","note":"","ucode":"51354296B07BAF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294550,"discussion_content":"æ„Ÿè°¢åˆ†äº«ï¼Œåœ¨æ‚¨çš„ä»£ç åŸºç¡€ä¸Šï¼Œä¿®å¤äº†é¡µé¢æ»šåŠ¨åï¼Œé¼ æ ‡ç§»åŠ¨åˆ°å¯¹åº”åŸå¸‚ä½ç½®æ—¶ï¼Œé«˜äº®å¤±æ•ˆçš„é—®é¢˜ï¼šhttps://blog.heyliubo.top/Visualization-of-learning-front-end/city","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595924743,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231047,"user_name":"River","can_delete":false,"product_type":"c1","uid":1420598,"ip_address":"","ucode":"71CB419202A354","user_header":"https://static001.geekbang.org/account/avatar/00/15/ad/36/fc989053.jpg","comment_is_top":false,"comment_ctime":1593571622,"is_pvip":false,"replies":[{"id":"85611","content":"èµ","user_name":"ä½œè€…å›å¤","comment_id":231047,"uid":"1159792","ip_address":"","utype":1,"ctime":1593823273,"user_name_real":"æœˆå½±"}],"discussion_count":2,"race_medal":0,"score":"10183506214","product_id":100053801,"comment_content":"ifInCircle(pos, node) {<br>        if (pos[0] &lt; node.x + node.r &amp;&amp; pos[1] &lt; node.y + node.r) {<br>          let result = Math.pow((node.x - pos[0]), 2) + Math.pow((node.y - pos[1]), 2) &lt; Math.pow(node.r, 2)<br>          if (result) {<br>            if (node.children) {<br>              for (let childNode of node.children) {<br>                let has = this.ifInCircle(pos, childNode)<br>                if (has) {<br>                  break<br>                }<br>              }<br>            } else {<br>              if (!node.colorful) {<br>                if (this.chooseNode &amp;&amp; node !== this.chooseNode) {<br>                  this.chooseNode.colorful = false<br>                  this.clearAll()<br>                  this.draw(this.context, this.root)<br>                }<br>                this.draw(this.context, node, {fillStyle: &#39;rgba(90, 35, 35, 0.2)&#39;})<br>                this.chooseNode = node<br>                node.colorful = true<br>                return true<br>              }<br>            }<br>          }<br>        }<br>      },<br>å¥½æ­¹æ˜¯å®ç°äº†ã€‚ã€‚ã€‚ä¸å¡","like_count":2,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500134,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593823273,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2667591,"avatar":"https://static001.geekbang.org/account/avatar/00/28/b4/47/8cdd9ee6.jpg","nickname":"åŸå—èŠ±å·²å¼€","note":"","ucode":"07BD0F0D51A512","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538559,"discussion_content":"çœ‹åˆ°äº†ä¸€ä¸ªåŒæ€è·¯åˆ¤æ–­è·ç¦»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639446652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279035,"user_name":"æˆ‘å«å¼ å°å’©Â²â°Â¹â¹","can_delete":false,"product_type":"c1","uid":1374463,"ip_address":"","ucode":"68A8C87EB09D26","user_header":"https://static001.geekbang.org/account/avatar/00/14/f8/ff/ae800f6b.jpg","comment_is_top":false,"comment_ctime":1613560100,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5908527396","product_id":100053801,"comment_content":"å…¨éƒ½åˆ©ç”¨è€å¸ˆå°è£…å¥½çš„`draw`æ–¹æ³•ç»˜åˆ¶å°±å¥½äº†  <br>```js<br>const redraw = () =&gt; {<br>    context.clearRect(0, 0, 1600, 1600)<br>    draw(context, root)<br>  }<br><br>  function isInCircle(node, mx, my) {<br>    const { children, data, x, y, r } = node<br>    if (children) {<br>      children.find((v) =&gt; isInCircle(v, mx, my))<br>    } else if ((mx - x) * (mx - x) + (my - y) * (my - y) &lt; r * r) {<br>      redraw()<br>      draw(context, node, { fillStyle: &#39;rgba(255,0,0,0.2)&#39; })<br>      return data<br>    }<br>  }<br><br>  function bindMouseEvent() {<br>    canvas.onmousemove = (e) =&gt; {<br>      let { x, y } = e<br>      &#47;&#47;! æ³¨æ„ç”»å¸ƒå®½é«˜ã€æ ·å¼å®½é«˜çš„æ¯”ä¾‹<br>      x = x * 2<br>      y = y * 2<br>      const current = isInCircle(root, x, y)<br>      if (current) {<br>        console.log(&#39;In Circle&#39;, current)<br>      }<br>    }<br>  }<br><br>  draw(context, root)<br>  bindMouseEvent()<br>```","like_count":1},{"had_liked":false,"id":230646,"user_name":"æµ©æ˜å•¦","can_delete":false,"product_type":"c1","uid":1377422,"ip_address":"","ucode":"120ED8FC45B992","user_header":"https://static001.geekbang.org/account/avatar/00/15/04/8e/e75ecc5e.jpg","comment_is_top":false,"comment_ctime":1593439929,"is_pvip":true,"replies":[{"id":"85197","content":"ä½ å…ˆä¿å­˜ä¸Šä¸€æ¬¡hoverçš„ä¿¡æ¯ï¼Œä¸¤æ¬¡æ£€æŸ¥æ¯”è¾ƒï¼Œå¦‚æœåœ†æ˜¯åŒæ ·çš„æ²¡æœ‰å˜åŒ–ï¼Œå°±ä¸ç”¨é‡æ–°ç»˜åˆ¶","user_name":"ä½œè€…å›å¤","comment_id":230646,"uid":"1159792","ip_address":"","utype":1,"ctime":1593484360,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"5888407225","product_id":100053801,"comment_content":"è€å¸ˆï¼Œé¼ æ ‡ç§»åŠ¨åœ†å‘ç”Ÿå˜åŒ–çš„å‰ææ˜¯éœ€è¦éå†æ•´ä¸ªæ•°æ®ç»“æ„ï¼Œå½“æ‰¾åˆ°å¯¹åº”å˜åŒ–çš„ç‚¹ä¹‹åå†é‡ç»˜ï¼Œä½†æ˜¯è¿™æ ·æˆ‘è¿˜æ˜¯éœ€è¦æ¸²æŸ“å¤šæ¬¡ï¼Œå¯¹äºè¿™ä¸ªä¼˜åŒ–åº”è¯¥æ€ä¹ˆå†™å‘¢ï¼Œå®åœ¨æ²¡ä»€ä¹ˆå¤´ç»ªäº†","like_count":2,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499973,"discussion_content":"ä½ å…ˆä¿å­˜ä¸Šä¸€æ¬¡hoverçš„ä¿¡æ¯ï¼Œä¸¤æ¬¡æ£€æŸ¥æ¯”è¾ƒï¼Œå¦‚æœåœ†æ˜¯åŒæ ·çš„æ²¡æœ‰å˜åŒ–ï¼Œå°±ä¸ç”¨é‡æ–°ç»˜åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593484360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229542,"user_name":"ç‹å­æ™¨","can_delete":false,"product_type":"c1","uid":1390005,"ip_address":"","ucode":"4A207E2AB34253","user_header":"https://static001.geekbang.org/account/avatar/00/15/35/b5/a139a821.jpg","comment_is_top":false,"comment_ctime":1593054505,"is_pvip":false,"replies":[{"id":"84743","content":"canvaså¯¹csså­—ä½“å•ä½éƒ½æ”¯æŒï¼Œä¸è¿‡æ˜¯ç›¸å¯¹äºç”»å¸ƒåæ ‡çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ç”»å¸ƒåæ ‡å’Œæ ·å¼åæ ‡ç›¸åŒçš„æ—¶å€™ï¼Œ1remå’Œhtmlçš„1remæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œå¦‚æœç”»å¸ƒåæ ‡æ˜¯æ ·å¼åæ ‡çš„2å€ï¼Œé‚£ä¹ˆcanvaså­—ä½“1remçœ‹èµ·æ¥å°±åªæœ‰htmlçš„ä¸€åŠå¤§å°ã€‚ä½¿ç”¨æ—¶æ ¹æ®å…·ä½“æƒ…å†µæ¥ä½¿ç”¨å§ï¼Œåœ¨éœ€è¦è‡ªé€‚åº”è®¾å¤‡çš„æ—¶å€™ä½¿ç”¨ç›¸å¯¹å•ä½è‚¯å®šæ˜¯ä¼šæ–¹ä¾¿ä¸€äº›çš„ã€‚","user_name":"ä½œè€…å›å¤","comment_id":229542,"uid":"1159792","ip_address":"","utype":1,"ctime":1593067667,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"5888021801","product_id":100053801,"comment_content":"è€å¸ˆæˆ‘çœ‹ä½ æœ¬èŠ‚è¯¾æ¡ˆä¾‹ï¼Œé‡Œé¢çš„åŸå¸‚åå­—å­—ä½“å•ä½æ˜¯remï¼Œcanvaså¯¹remå’Œviewè¿™äº›å•ä½ï¼Œæ”¯æŒçš„ç¨‹åº¦æ˜¯æ€æ ·çš„ï¼Ÿå¦‚æœéƒ½æ”¯æŒï¼Œé‚£ä¿©ä¸ªå•ä½åœ¨ä½¿ç”¨æ—¶æ›´å€¾å‘äºä½¿ç”¨å“ªç§ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499532,"discussion_content":"canvaså¯¹csså­—ä½“å•ä½éƒ½æ”¯æŒï¼Œä¸è¿‡æ˜¯ç›¸å¯¹äºç”»å¸ƒåæ ‡çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ç”»å¸ƒåæ ‡å’Œæ ·å¼åæ ‡ç›¸åŒçš„æ—¶å€™ï¼Œ1remå’Œhtmlçš„1remæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œå¦‚æœç”»å¸ƒåæ ‡æ˜¯æ ·å¼åæ ‡çš„2å€ï¼Œé‚£ä¹ˆcanvaså­—ä½“1remçœ‹èµ·æ¥å°±åªæœ‰htmlçš„ä¸€åŠå¤§å°ã€‚ä½¿ç”¨æ—¶æ ¹æ®å…·ä½“æƒ…å†µæ¥ä½¿ç”¨å§ï¼Œåœ¨éœ€è¦è‡ªé€‚åº”è®¾å¤‡çš„æ—¶å€™ä½¿ç”¨ç›¸å¯¹å•ä½è‚¯å®šæ˜¯ä¼šæ–¹ä¾¿ä¸€äº›çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593067667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229434,"user_name":"AlexğŸ¦","can_delete":false,"product_type":"c1","uid":1996935,"ip_address":"","ucode":"9EE0DE584B55B4","user_header":"https://static001.geekbang.org/account/avatar/00/1e/78/87/a70878a5.jpg","comment_is_top":false,"comment_ctime":1592993621,"is_pvip":false,"replies":[{"id":"84730","content":"ä¸ç”¨æ¯æ¬¡mousemoveéƒ½é‡ç»˜canvasï¼Œåªæœ‰é¼ æ ‡ç§»åŠ¨åˆ°çš„åœ†å‘ç”Ÿäº†å˜åŒ–æ—¶æ‰éœ€è¦é‡ç»˜ã€‚ä½ å¯ä»¥è¯•ç€è¿™æ ·ä¼˜åŒ–ä¸€ä¸‹ï½","user_name":"ä½œè€…å›å¤","comment_id":229434,"uid":"1159792","ip_address":"","utype":1,"ctime":1593049782,"user_name_real":"æœˆå½±"}],"discussion_count":1,"race_medal":0,"score":"5887960917","product_id":100053801,"comment_content":"2çš„äº¤ä½œä¸š æ„Ÿè§‰ æœ‰ç‚¹å¡é¡¿ã€‚ã€‚ã€‚    <br>         function caculate(dx, dy, node) {<br>            let children = node.children;<br>            const { x, y, r } = node;<br>            if ((dx - x) * (dx - x) + (dy - y) * (dy - y) &lt; r * r) {<br>                node.color = 1;<br>                node.parent?node.parent.color = 0:&#39;&#39;;<br>            } else {<br>                node.color = 0;<br>            }<br>            if (children) {<br>                for (let i = 0; i &lt; children.length; i++) {<br>                    caculate(dx, dy, children[i]);<br>                }<br>            }<br>        }<br>        dom.onmousemove = (e) =&gt; {<br>            let x = e.pageX, y = e.pageY;<br>            caculate(x, y, root);<br>            context.clearRect(0,0,800,800)<br>            draw(context, root);<br>        }","like_count":1,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499480,"discussion_content":"ä¸ç”¨æ¯æ¬¡mousemoveéƒ½é‡ç»˜canvasï¼Œåªæœ‰é¼ æ ‡ç§»åŠ¨åˆ°çš„åœ†å‘ç”Ÿäº†å˜åŒ–æ—¶æ‰éœ€è¦é‡ç»˜ã€‚ä½ å¯ä»¥è¯•ç€è¿™æ ·ä¼˜åŒ–ä¸€ä¸‹ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593049782,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":332493,"user_name":"è‚é¹","can_delete":false,"product_type":"c1","uid":1005479,"ip_address":"","ucode":"98AA4D9E9BF9F1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJQLfPbnibuQwaXIgyr3hxUdVAuaZfsn4pjic3lDvUmlpfPqvMJ2aSfetI18lKpRyzLuIbYeY2K15ibg/132","comment_is_top":false,"comment_ctime":1643274953,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1643274953","product_id":100053801,"comment_content":"è¯´åˆ°åº•è¿˜æ˜¯å¾—æœ‰æ•°å­¦åŸºç¡€ï¼Œä¸€ä¸ªç®€å•çš„é¡¹ç›®è¿˜å¾—å¼•ä¸ªD3ï¼Œå¼€é”€æœ‰ç‚¹å¤§","like_count":0},{"had_liked":false,"id":329740,"user_name":"Kennydaidai","can_delete":false,"product_type":"c1","uid":1254027,"ip_address":"","ucode":"2AC2D7D41DE0B7","user_header":"https://static001.geekbang.org/account/avatar/00/13/22/8b/9685ae63.jpg","comment_is_top":false,"comment_ctime":1641521823,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641521823","product_id":100053801,"comment_content":"è€å¸ˆä½ å¥½ï¼š<br>äº”å­æ£‹ç»ƒä¹ ï¼šhttps:&#47;&#47;codepen.io&#47;xiaodaidai&#47;pen&#47;rNGKPRq <br>é—®é¢˜ï¼šcanvas å¦‚ä½•æ¸…é™¤æŒ‡å®šçš„å›¾å½¢ï¼Œæˆ‘ä½¿ç”¨äº†é‡æ–°è®¾ç½® canvas çš„å®½é«˜æ¥é‡ç½®æ•´ä¸ªç”»å¸ƒäº†ï¼Œè¿™æ˜¯ä¸æ˜¯ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚<br>è°¢è°¢è€å¸ˆ","like_count":0},{"had_liked":false,"id":320617,"user_name":"log","can_delete":false,"product_type":"c1","uid":2414585,"ip_address":"","ucode":"DBDD9F4A289BB7","user_header":"https://static001.geekbang.org/account/avatar/00/24/d7/f9/3cc65e57.jpg","comment_is_top":false,"comment_ctime":1636423926,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636423926","product_id":100053801,"comment_content":"è€å¸ˆï¼Œè¯·é—®ä¸€ä¸‹ï¼Œå›½å®¶-ã€‹çœä»½-ã€‹åŸå¸‚çš„åœ†åœˆçš„é¢œè‰²æ·±æµ…æ˜¯é€šè¿‡å•¥æ§åˆ¶çš„å‘€ï¼Ÿçœ‹äº†ä¸€åœˆå°±å‘ç°äº†fillStyleï¼Œä½†æ˜¯ä»–å°±æ˜¯rgbs(0,0,0,0.2)ï¼Œè¯·é—®æ€ä¹ˆæ”¹å˜çš„å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":303747,"user_name":"HY","can_delete":false,"product_type":"c1","uid":1622759,"ip_address":"","ucode":"6D96EF4D2DB6A0","user_header":"https://static001.geekbang.org/account/avatar/00/18/c2/e7/72208894.jpg","comment_is_top":false,"comment_ctime":1626960464,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626960464","product_id":100053801,"comment_content":"è€å¸ˆè¿™ä¸ªï¼Œcanvaså›¾å±‚é—®é¢˜æ²¡çœ‹æ‡‚ï¼Œæ˜¯é€šè¿‡ç»˜å›¾çš„å…ˆåå…³ç³»å—ï¼Ÿåç»˜åˆ¶çš„åœ¨åé¢ã€‚å¦‚æœ å¹¶è¡Œç»˜åˆ¶å¤šä¸ªå…ƒç´ å‘¢ï¼Œæˆ‘åº”è¯¥å¦‚ä½•æ§åˆ¶ä¸Šä¸‹é‡Œçº§å…³ç³»å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":290192,"user_name":"è®¸æ°¸å¹³","can_delete":false,"product_type":"c1","uid":2452820,"ip_address":"","ucode":"E784E0F328545E","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLI6ibAJRoCG6gib0NOmBOM80iaibLx8Wz7kUXqRkxZGIWqDyOMyAaSypOV7zjRq6GNia8icbKnCm4oOXhQ/132","comment_is_top":false,"comment_ctime":1619425365,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1619425365","product_id":100053801,"comment_content":"<br>&#47;&#47; å¹³ç§»<br>context.translate(-0.5 * rectSize[0], -0.5 * rectSize[1]);<br><br>... æ‰§è¡Œç»˜åˆ¶<br><br>&#47;&#47; æ¢å¤<br>context.translate(0.5 * rectSize[0], 0.5 * rectSize[1]);<br><br>æŒ‰ç…§è¿™ä¸ªæ‰§è¡Œä»£ç ï¼Œæ— æ³•å¤ä½â€¦â€¦æ˜¯ä¸æ˜¯æˆ‘è¯¯è§£è¿™ä¸ªæ„æ€äº†","like_count":0,"discussions":[{"author":{"id":1547073,"avatar":"https://static001.geekbang.org/account/avatar/00/17/9b/41/0c62ae9a.jpg","nickname":"aä»Aä»é˜¿ä»å•Šä»","note":"","ucode":"0A52AE9396B8F6","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":564800,"discussion_content":"ç»˜åˆ¶å®Œä¹‹åå¥½åƒä¸èƒ½translateäº†ï¼Œä¸çŸ¥é“è€å¸ˆæ€ä¹ˆæ“ä½œçš„ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1650331548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288117,"user_name":"å‡¹å‡¸ğŸ”¥","can_delete":false,"product_type":"c1","uid":1378466,"ip_address":"","ucode":"96F9C8B901F41C","user_header":"https://static001.geekbang.org/account/avatar/00/15/08/a2/8b703b6c.jpg","comment_is_top":false,"comment_ctime":1618307578,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618307578","product_id":100053801,"comment_content":"let isInside = false;<br>  function isInCircle(context, mx, my, node) {<br>    const children = node.children;<br>    const { x, y, r, data } = node;<br>    if (children) {<br>      for (let i = 0; i &lt; children.length; i++) {<br>        if (isInside) {<br>          break;<br>        } else {<br>          isInCircle(context, mx, my, children[i])<br>        }<br>      }<br>    } else {<br>      if ((my - y) * (my - y) + (mx - x) * (mx - x) &lt; r * r) {<br>        if (hightItemName &amp;&amp; hightItemName === data.name) {<br>          console.log(&#39;å·²ç»å­˜åœ¨æ¸²æŸ“&#39;)<br>        } else {<br>          hightItemName = data.name<br>          isInside = true<br>        }<br>      }<br>    }<br>    if (isInside) {<br>      context.clearRect(0, 0, 1600, 1600);<br>      draw(context, root);<br>      isInside = false<br>    }<br>  }<br><br>çœ‹äº†å¤§éƒ¨åˆ†ç•™è¨€çš„ä»£ç  æ„Ÿè§‰éƒ½ä¸å¤ªæ¸…æ™°ï¼Œåœ°åŒºçš„åå­—å¯ä»¥ä½œä¸ºä¸€ä¸ªID ï¼ŒIDåªè¦ä¸å˜å¯ä»¥ä¼˜åŒ–æ¸²æŸ“é‡å¤æ•°ï¼Œç„¶åæ ¹æ®IDï¼Œå»å•ç‹¬æ¸²æŸ“å¯¹äºçš„èŠ‚ç‚¹èƒŒæ™¯æ ·å¼","like_count":0},{"had_liked":false,"id":287954,"user_name":"åˆ˜æ´ªæ—","can_delete":false,"product_type":"c1","uid":1535242,"ip_address":"","ucode":"1FDBB425191CA8","user_header":"https://static001.geekbang.org/account/avatar/00/17/6d/0a/8e7f0f04.jpg","comment_is_top":false,"comment_ctime":1618233724,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618233724","product_id":100053801,"comment_content":"    let point;<br>    let lastIn = null;<br>    let isIn = null;<br>    canvas.addEventListener(&#39;mousemove&#39;, (event) =&gt; {<br>        isIn = null;<br>        point= {x: event.offsetX, y: event.offsetY};<br>        redraw(context, root);<br>        if ((isIn &amp;&amp; isIn !== lastIn) || (!isIn &amp;&amp; lastIn)) {<br>            lastIn = isIn;<br>            context.clearRect(0, 0, canvas.width, canvas.height);<br>            draw(context, root);<br>        }<br>    });<br>    function redraw(ctx, node) {<br>        if (node.children) {<br>            for(let i = 0; i &lt; node.children.length; i++) {<br>                redraw(ctx, node.children[i]);<br>            }<br>        } else {<br>            if (isInCircle(node, point)) {<br>                &#47;&#47; æ ‡å¿—é¼ æ ‡åœ¨èŠ‚ç‚¹å†…<br>                isIn = node;<br>            }<br>        }<br>    }<br>    function isInCircle(node, point) {<br>        &#47;&#47; å¿½ç•¥çˆ¶çº§åœ†<br>        if (!!node.children || !point) {<br>            return false;<br>        }<br>        const {x, y, r} = node;<br>        &#47;&#47; åˆ¤æ–­é¼ æ ‡è½ç‚¹æ˜¯å¦åœ¨åœ†å†…<br>        &#47;&#47; é¼ æ ‡è½ç‚¹å’Œåœ†å¿ƒçš„è·ç¦»å°äºåŠå¾„<br>        return Math.sqrt(<br>            Math.abs(point.y - y) ** 2 + Math.abs(point.x - x) ** 2) &lt; r;<br>    }<br>&#47;&#47; é€šè¿‡ä¸€ä¸ªå˜é‡æ ‡è®°ä¸Šä¸€æ¬¡é¼ æ ‡è¿›å…¥çš„èŠ‚ç‚¹å’Œå½“å‰é¼ æ ‡è¿›å…¥çš„èŠ‚ç‚¹é¿å…é¼ æ ‡åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šç§»åŠ¨æ—¶çš„é‡å¤ç»˜åˆ¶","like_count":0},{"had_liked":false,"id":286646,"user_name":"james","can_delete":false,"product_type":"c1","uid":1232771,"ip_address":"","ucode":"AC42035106E5B9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/yyibGRYCArsUNBfCAEAibua09Yb9D5AdO8TkCmXymhAepibqmlz0hzg06ggBLxyvXicnjqFVGr7zYF0rQoZ0aXCBAg/132","comment_is_top":false,"comment_ctime":1617446504,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617446504","product_id":100053801,"comment_content":" const TAU = 2 * Math.PI;<br>        const canvas = document.getElementById(&#39;canvas&#39;);<br>        &#47;&#47; è·å–ç”»å¸ƒ2dä¸Šä¸‹æ–‡<br>        const context = canvas.getContext(&#39;2d&#39;);<br>        &#47;&#47; 1ã€æ¸…é™¤åœ†å½¢çš„æ–¹æ³•<br>        const clearCircle = (ctx, x, y, r) =&gt; {<br>            &#47;&#47; ä¿å­˜çŠ¶æ€<br>            ctx.save();<br>            &#47;&#47; ç”»å¸ƒå¡«å……åº•è‰²<br>            ctx.fillStyle = &#39;#fff&#39;;<br>            &#47;&#47; å¼€å§‹ç»˜åˆ¶<br>            ctx.beginPath();<br>            &#47;&#47; åœ†çš„åæ ‡ã€åœ†çš„åŠå¾„ã€ç”»çš„åŒºåŸŸ<br>            ctx.arc(x, y, r, 0, TAU);<br>            &#47;&#47; ç»˜åˆ¶å®Œå¡«å……åˆ°ç”»å¸ƒä¸Š<br>            ctx.fill();<br>            &#47;&#47; å›åˆ°ä¿å­˜é’±çš„çŠ¶æ€<br>            ctx.restore();<br>        };<br><br>        &#47;&#47; 2ã€æ£€æµ‹é¼ æ ‡æ˜¯å¦åœ¨åœ†å†…ï¼ˆå¦‚æœåœ¨åœ†å†…å°±å…ˆæ¸…é™¤åœ†å†ç»˜åˆ¶åç§°å’Œæ–°é¢œè‰²ï¼‰<br>        const isInCircle = (ctx, my, my, node) =&gt; {<br>            const children = node.children;<br>            if (Array.isArray(children)) {<br>                for (let i = 0; i &lt; children.length; i++) {<br>                    isInCircle(ctx, my, my, children[i]);<br>                }<br>            } else {<br>                const { x, y, r } = node;<br>                const area = Math.pow((my - y), 2) + Math.pow((mx - x), 2);<br>                const inCircle = area &lt; Math.pow(r, 2);<br>                if (inCircle) {<br>                    &#47;&#47; æ¸…é™¤åœ†å½¢<br>                    ctx.clearCircle(x, y, r);<br>                    ctx.fillStyle = &#39;#000&#39;;<br>                    &#47;&#47; å¼€å§‹ç»˜åˆ¶<br>                    ctx.beginPath();<br>                    &#47;&#47; ç»˜åˆ¶åœ†å½¢<br>                    ctx.arc(x, y, r, 0, TAU);<br>                    &#47;&#47; ç»˜åˆ¶åˆ°ç”»å¸ƒä¸Š<br>                    ctx.fill();<br>                    const name = node.data.name;<br>                    ctx.fillStyle = &#39;#fff&#39;;<br>                    ctx.beginPath();<br>                    ctx.font = &#39;1.5rem Arial&#39;;<br>                    ctx.textAlign = &#39;center&#39;;<br>                    ctx.fillText(name, x, y);<br>                }<br>            }<br>        };<br><br>        &#47;&#47; 3ã€ç›‘å¬é¼ æ ‡mousemoveäº‹ä»¶(åˆ¤æ–­é¼ æ ‡ä½ç½®å’Œcanvasä¸­å¿ƒåæ ‡çš„å…³ç³»)<br>        canvas.addEventListener(&#39;mousemove&#39;, (e) =&gt; {<br>            &#47;&#47; æ³¨æ„ç”»å¸ƒå®½é«˜ã€æ ·å¼å®½é«˜çš„æ¯”ä¾‹<br>            const x = e.clientX * 2;<br>            const y = e.clientY * 2;<br>            isInCircle(context, x, y, root);<br>        });","like_count":0},{"had_liked":false,"id":285304,"user_name":"æƒœä½™","can_delete":false,"product_type":"c1","uid":1327374,"ip_address":"","ucode":"52417DC17CDB7A","user_header":"https://static001.geekbang.org/account/avatar/00/14/41/0e/162bd1eb.jpg","comment_is_top":false,"comment_ctime":1616729762,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616729762","product_id":100053801,"comment_content":"æ„Ÿè°¢ã€‚","like_count":0},{"had_liked":false,"id":279982,"user_name":"2oops","can_delete":false,"product_type":"c1","uid":1910332,"ip_address":"","ucode":"E8896273BBB202","user_header":"https://static001.geekbang.org/account/avatar/00/1d/26/3c/5d6f3508.jpg","comment_is_top":false,"comment_ctime":1614046409,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614046409","product_id":100053801,"comment_content":"å¦‚æœç”¨äº†d3.hierarchyçš„è¯ï¼Œé‚£ç›´æ¥ç”¨d3çš„æ‰“åŒ…å›¾ä¹Ÿå¯ä»¥å®ç°å±‚æ¬¡å…³ç³»å›¾å–”","like_count":0},{"had_liked":false,"id":276409,"user_name":"é”é”çˆ±å—çƒ","can_delete":false,"product_type":"c1","uid":1158621,"ip_address":"","ucode":"7AA4CA355B9D69","user_header":"https://static001.geekbang.org/account/avatar/00/11/ad/dd/970e7b4a.jpg","comment_is_top":false,"comment_ctime":1611912088,"is_pvip":true,"replies":[{"id":"101085","content":"æ˜¯çš„ï¼Œå¹³ç§»åæ ‡åªä¼šå½±å“åç»­ç»˜åˆ¶","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1612875130,"ip_address":"","comment_id":276409,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1611912088","product_id":100053801,"comment_content":"è€å¸ˆï¼Œå¹³ç§»å’Œæ¢å¤é‚£å—æœ‰ä¸ªå°é—®é¢˜ã€‚å°±æ˜¯ç¬¬ä¸€æ¬¡ç”»å›¾çš„æ—¶å€™ï¼Œåæ ‡ç³»å¹³ç§»äº†ï¼Œç„¶åå›æ’¤ï¼Œæˆ–è€…å†å¹³ç§»å›å»ä¸ä¼šå¯¹åŸæ¥çš„å›¾å½¢é€ æˆå½±å“å—ï¼Ÿæ˜¯ä¸æ˜¯å¯ä»¥è¿™æ ·è¯´ï¼Œæˆ‘ç”»Aå›¾å½¢çš„æ—¶å€™ï¼Œæˆ‘çš„æŒ‡ä»¤æ€ä¹ˆæ“ä½œï¼Œéƒ½æ˜¯é’ˆå¯¹Aï¼Œè€Œå½“è°ƒç”¨canvas.fill()çš„æ—¶å€™ï¼ŒAå›¾å½¢å°±å·²ç»è¢«å®šæ ¼äº†ï¼Œåé¢çš„å˜åŒ–æ˜¯é’ˆå¯¹åé¢çš„å›¾å½¢äº†ï¼Œæ‰€ä»¥æˆ‘å›æ’¤ä¹‹åï¼Œå†ç”»å›¾å½¢Bï¼Œä½†æ˜¯å› ä¸ºAè¢«å®šæ ¼è¾“å‡ºåœ¨canvasä¸Šäº†ï¼Œæ‰€ä»¥åç»­çš„ä»»ä½•æ“ä½œéƒ½ä¸ä¼šå¯¹Aé€ æˆå½±å“ï¼Œè¯·é—®è€å¸ˆï¼Œå¯ä»¥è¿™æ ·ç†è§£å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514692,"discussion_content":"æ˜¯çš„ï¼Œå¹³ç§»åæ ‡åªä¼šå½±å“åç»­ç»˜åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612875130,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":273036,"user_name":"ç™¾é¦™æœèœœ","can_delete":false,"product_type":"c1","uid":2044424,"ip_address":"","ucode":"72A84DB17CBB48","user_header":"","comment_is_top":false,"comment_ctime":1610418336,"is_pvip":false,"replies":[{"id":"101088","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1612875678,"ip_address":"","comment_id":273036,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610418336","product_id":100053801,"comment_content":"çœ‹äº†è¯„è®ºï¼Œæ”¶è·å¥½å¤šï¼Œäº¤æ‹“å±•ä¸€äºŒçš„ä½œä¸šï¼š<br>https:&#47;&#47;github.com&#47;xsometimes&#47;visual-practices&#47;blob&#47;main&#47;src&#47;view&#47;demo1&#47;index.js","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513468,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612875678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":259982,"user_name":"RRRRRRRR","can_delete":false,"product_type":"c1","uid":1075692,"ip_address":"","ucode":"3EF53DF1ACE2D8","user_header":"https://static001.geekbang.org/account/avatar/00/10/69/ec/ba28c292.jpg","comment_is_top":false,"comment_ctime":1604903106,"is_pvip":false,"replies":[{"id":"94952","content":"èµ","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1605492463,"ip_address":"","comment_id":259982,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1604903106","product_id":100053801,"comment_content":"æ¥äº¤ä½œä¸šäº†ï¼Œè®²ä¸€ä¸‹å¤§è‡´æ€è·¯å’Œåšçš„ä¼˜åŒ–ç‚¹ã€‚<br>ä½œä¸šä¸€ https:&#47;&#47;output.jsbin.com&#47;qehuxuqï¼Œç”¨ä¸‰è§’å‡½æ•°ç”»åœ†çš„æ–¹å¼æ¥ç”»æ¤­åœ†ï¼Œåœ†æ¯•ç«Ÿå¯ä»¥çœ‹ä½œæ˜¯é•¿è½´çŸ­è½´ç›¸ç­‰çš„æ¤­åœ†ã€‚<br>ä½œä¸šäºŒ https:&#47;&#47;output.jsbin.com&#47;rafigodï¼Œç”¨ Map ä¿å­˜æ‰€æœ‰çš„åŸå¸‚ä½ç½®å’ŒåŠå¾„ï¼Œåˆ¤æ–­é¼ æ ‡ä½ç½®ä¸æ‰€æœ‰åŸå¸‚é—´çš„è·ç¦»ï¼ŒåŒæ—¶ç”¨ throttle å‡½æ•°ï¼Œå‡å°‘ä¸å¿…è¦çš„é‡ç»˜ã€‚<br>","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509078,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605492463,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":248658,"user_name":"å›½æ——","can_delete":false,"product_type":"c1","uid":1346964,"ip_address":"","ucode":"09BA50A445F81D","user_header":"https://static001.geekbang.org/account/avatar/00/14/8d/94/a04cf407.jpg","comment_is_top":false,"comment_ctime":1600255115,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1600255115","product_id":100053801,"comment_content":"æ„Ÿè§‰å¾ˆç®€å•ï¼Œä¸Šæ‰‹ä¹Ÿæ˜¯å°‘ä¸äº†è¸©å‘å•Š <br>https:&#47;&#47;codepen.io&#47;AAI&#47;pen&#47;bGpjQJg","like_count":0},{"had_liked":false,"id":243006,"user_name":"Kite","can_delete":false,"product_type":"c1","uid":1374421,"ip_address":"","ucode":"9DACE8E0EC84A6","user_header":"https://static001.geekbang.org/account/avatar/00/14/f8/d5/fd04fcbc.jpg","comment_is_top":false,"comment_ctime":1597917874,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597917874","product_id":100053801,"comment_content":"äº†è§£äº†ä¸€ä¸‹å‡¸åŒ…ç®—æ³•ï¼Œè®°å½•åœ¨æ­¤ï¼šhttps:&#47;&#47;www.cnblogs.com&#47;cglongge&#47;p&#47;9408417.html","like_count":0},{"had_liked":false,"id":239079,"user_name":"Geek_cd63d9","can_delete":false,"product_type":"c1","uid":2015085,"ip_address":"","ucode":"1EF4B98DF1E171","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL1H2TOJnNTblhmzJ2p88sTjvb86PuXP7A8HpCNKrfobuOc6Cxgy1UogZMIPTmD3VDGXZfTXIaWNw/132","comment_is_top":false,"comment_ctime":1596428661,"is_pvip":false,"replies":[{"id":"88833","content":"è¿™ä¸ªæ¶‰åŠåˆ°è®¾å¤‡åƒç´ æ¯”ï¼Œä½ å¯ä»¥æŸ¥ä¸€ä¸‹device pixel ratioç†è§£ä¸€ä¸‹è¿™å—çš„çŸ¥è¯†","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1597022800,"ip_address":"","comment_id":239079,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1596428661","product_id":100053801,"comment_content":"æˆ‘ä¹‹å‰ç”¨canvaså®Œæˆçš„é¥¼çŠ¶å›¾ï¼Œæ ·å¼å°ºå¯¸å’Œåæ ‡å°ºå¯¸ä¸ä¸€è‡´ï¼Œåœ¨ç§»åŠ¨è®¾å¤‡ä¸Šå›¾å¾ˆæ¨¡ç³Šï¼Œè€å¸ˆå¯ä»¥è§£ç­”ä¸€ä¸‹å—ï¼Œçœ‹è¿‡åˆ«äººçš„å›ç­”ï¼Œä½†è¿˜ä¸æ˜¯å¾ˆæ¸…æ™°ã€‚","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502969,"discussion_content":"è¿™ä¸ªæ¶‰åŠåˆ°è®¾å¤‡åƒç´ æ¯”ï¼Œä½ å¯ä»¥æŸ¥ä¸€ä¸‹device pixel ratioç†è§£ä¸€ä¸‹è¿™å—çš„çŸ¥è¯†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597022800,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":233298,"user_name":"ä¸‰ç¬ è€¶æ ¼å°”","can_delete":false,"product_type":"c1","uid":2053901,"ip_address":"","ucode":"96EE00C1D11F6C","user_header":"https://static001.geekbang.org/account/avatar/00/1f/57/0d/57eed3a3.jpg","comment_is_top":false,"comment_ctime":1594282512,"is_pvip":false,"replies":[{"id":"86182","content":"å¯ä»¥ç”¨åæ ‡æ˜ å°„ï¼Œæ–¹å¼å°±æ˜¯å…ˆè®¡ç®—ç›¸å¯¹äºcanvasçš„åƒç´ åæ ‡ï¼Œç„¶åå†æ¢ç®—æˆç”»å¸ƒåæ ‡å°±è¡Œäº†","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1594346975,"ip_address":"","comment_id":233298,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1594282512","product_id":100053801,"comment_content":"è¯·é—®è€å¸ˆï¼Œcanvaså¤§å°æ˜¯è‡ªåŠ¨é€‚åº”å±å¹•çš„å¤§å°ï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰èƒ½è®©ç›‘å¬çš„é¼ æ ‡ä½ç½®ä¿¡æ¯å’Œcanvasä¸­çš„ç‚¹ä¸€ä¸€å¯¹åº”å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500975,"discussion_content":"å¯ä»¥ç”¨åæ ‡æ˜ å°„ï¼Œæ–¹å¼å°±æ˜¯å…ˆè®¡ç®—ç›¸å¯¹äºcanvasçš„åƒç´ åæ ‡ï¼Œç„¶åå†æ¢ç®—æˆç”»å¸ƒåæ ‡å°±è¡Œäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594346975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231478,"user_name":"l_j_dota_1111","can_delete":false,"product_type":"c1","uid":1490128,"ip_address":"","ucode":"4CA8A41F5107C7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJwHLLQK3AicN8XqichEbfqSACpRB5kry8bIMBcuB3bSiaeic9hABrmn7TZgqaWJ8Xc1gWh6icasZCt3Fg/132","comment_is_top":false,"comment_ctime":1593683378,"is_pvip":false,"replies":[{"id":"85608","content":"è¿™ä¸ªåç»­æˆ‘ä¼šæŠŠç­”æ¡ˆæ”¾åœ¨åŠ é¤é‡Œç»™å¤§å®¶","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1593823169,"ip_address":"","comment_id":231478,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593683378","product_id":100053801,"comment_content":"è€å¸ˆèƒ½æŠŠè§¦å‘åŸå¸‚å˜è‰²çš„ä»£ç å‘å‡ºæ¥å—ï¼Œæ„Ÿè§‰å¥½å¤šåœ°æ–¹æ²¡æœ‰ä¼˜åŒ–å¥½","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500313,"discussion_content":"è¿™ä¸ªåç»­æˆ‘ä¼šæŠŠç­”æ¡ˆæ”¾åœ¨åŠ é¤é‡Œç»™å¤§å®¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593823169,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":231241,"user_name":"l_j_dota_1111","can_delete":false,"product_type":"c1","uid":1490128,"ip_address":"","ucode":"4CA8A41F5107C7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJwHLLQK3AicN8XqichEbfqSACpRB5kry8bIMBcuB3bSiaeic9hABrmn7TZgqaWJ8Xc1gWh6icasZCt3Fg/132","comment_is_top":false,"comment_ctime":1593612756,"is_pvip":false,"replies":[{"id":"85406","content":"æ”¹é¢œè‰²åªèƒ½é‡ç»˜ï¼Œä¸è¿‡canvaså¯ä»¥å±€éƒ¨æ¸…é™¤å’Œå±€éƒ¨é‡ç»˜ã€‚ä¸è¿‡å³ä½¿æ˜¯å…¨éƒ¨é‡ç»˜åœ¨ç°åœ¨çš„æµè§ˆå™¨ä¸Šä¹Ÿä¸ä¼šæœ‰å¤ªå¤§é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1593653312,"ip_address":"","comment_id":231241,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1593612756","product_id":100053801,"comment_content":"canvasæ”¹å˜èƒŒæ™¯è‰²ï¼Œæ˜¯åªèƒ½ä¸€ç›´åœ¨ä¸Šé¢é‡æ–°ç”»å—ï¼Œåªæ˜¯æ›´æ”¹èƒŒæ™¯è‰²ï¼Œå´è¦ä¸æ–­çš„é‡å¤ç”»åœ†å’Œå­—ï¼Œæ€§èƒ½ä¸å—å½±å“å—ï¼Œæˆ‘ä¸€ç›´å¾ˆå¥½å¥‡ï¼Œè™½ç„¶èƒ½æ£€æµ‹åœ¨åœ†å†…ï¼Œä½†æ˜¯å¦‚ä½•å¾ˆå¥½çš„å˜æ¢ï¼Œå› ä¸ºç¡®å®æ— æ³•è·å¾—è¿™ä¸ªåœ†ï¼Œæ›´åˆ«è¯´æ›´æ”¹å…¶é¢œè‰²äº†","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500213,"discussion_content":"æ”¹é¢œè‰²åªèƒ½é‡ç»˜ï¼Œä¸è¿‡canvaså¯ä»¥å±€éƒ¨æ¸…é™¤å’Œå±€éƒ¨é‡ç»˜ã€‚ä¸è¿‡å³ä½¿æ˜¯å…¨éƒ¨é‡ç»˜åœ¨ç°åœ¨çš„æµè§ˆå™¨ä¸Šä¹Ÿä¸ä¼šæœ‰å¤ªå¤§é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593653312,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1490128,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJwHLLQK3AicN8XqichEbfqSACpRB5kry8bIMBcuB3bSiaeic9hABrmn7TZgqaWJ8Xc1gWh6icasZCt3Fg/132","nickname":"l_j_dota_1111","note":"","ucode":"4CA8A41F5107C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288196,"discussion_content":"å±€éƒ¨æ¸…é™¤ï¼Œé‚£åƒä½œä¸šé¢˜ï¼Œå°åœ†éƒ¨åˆ†æ¸…é™¤ï¼Œä¼šå½±åƒåº•å±‚çš„ä¸­åœ†å’Œæœ€åº•å±‚çš„å¤§åœ†å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593676027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230566,"user_name":"Geek_frank","can_delete":false,"product_type":"c1","uid":2049021,"ip_address":"","ucode":"CF973E61ED2E59","user_header":"https://static001.geekbang.org/account/avatar/00/1f/43/fd/cf190699.jpg","comment_is_top":false,"comment_ctime":1593420409,"is_pvip":true,"replies":[{"id":"85201","content":"å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œç”¨d3çš„scaleï¼Œdomainï¼Œrangeç­‰å·¥å…·æ¥å¤„ç†æ•°æ®ï¼Œåå­—é‚£ä¸ªä½ å¯ä»¥ç¼©æ”¾æ–‡å­—","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1593484795,"ip_address":"","comment_id":230566,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593420409","product_id":100053801,"comment_content":"æ¡ˆä¾‹æ•°æ®ä¸­æ¯ä¸ªåŸå¸‚çš„åå­—é•¿åº¦æœ€å¤§ä¸º4ï¼Œå¦‚æœè¶…è¿‡4ä¸ªå­—ï¼Œå°±ä¼šæº¢å‡ºã€‚è¿™è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿå¯ä»¥è®©åœ†çš„å¤§å°é€‚åº”åå­—çš„é•¿åº¦å—ï¼Ÿ<br>ç”šè‡³å¯ä»¥è®©ç”»å¸ƒå¤§å°é€‚åº”æ•´ä¸ªå›¾çš„å®½é«˜ï¼Œè€Œä¸æ˜¯å›ºå®šçš„å€¼ã€1600,1600ã€‘ï¼Ÿ<br>","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499938,"discussion_content":"å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œç”¨d3çš„scaleï¼Œdomainï¼Œrangeç­‰å·¥å…·æ¥å¤„ç†æ•°æ®ï¼Œåå­—é‚£ä¸ªä½ å¯ä»¥ç¼©æ”¾æ–‡å­—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593484795,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":230220,"user_name":"Sam","can_delete":false,"product_type":"c1","uid":1314195,"ip_address":"","ucode":"C6454F1D848055","user_header":"","comment_is_top":false,"comment_ctime":1593315974,"is_pvip":false,"replies":[{"id":"85417","content":"åˆ¤æ–­ç‚¹åœ¨æŸä¸ªåœ†å†…ç„¶åç”¨ä¸åŒçš„fillStyleæ¥ç»˜åˆ¶","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1593654936,"ip_address":"","comment_id":230220,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593315974","product_id":100053801,"comment_content":"åœ¨åšè€å¸ˆç¤ºä¾‹çš„æ—¶å€™ï¼Œæƒ³åšç±»ä¼¼svgçš„hoveræ•ˆæœï¼Œä¸çŸ¥é“æ€ä¹ˆåšï¼Œå¸Œæœ›è€å¸ˆæŒ‡ç‚¹ä¸‹ã€‚","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499803,"discussion_content":"åˆ¤æ–­ç‚¹åœ¨æŸä¸ªåœ†å†…ç„¶åç”¨ä¸åŒçš„fillStyleæ¥ç»˜åˆ¶","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593654936,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229732,"user_name":"Maker","can_delete":false,"product_type":"c1","uid":1385569,"ip_address":"","ucode":"1193AA6126A596","user_header":"https://static001.geekbang.org/account/avatar/00/15/24/61/ab88f481.jpg","comment_is_top":false,"comment_ctime":1593132946,"is_pvip":false,"replies":[{"id":"84858","content":"å“ˆå“ˆï¼Œä½ å¯ä»¥è¯•ç€å†é‡æ–°å®ç°ä¸€ä¸‹ï¼Œæˆ–è€…è¯•è¯•æ”¹ç”¨webglæ¥å®ç°","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1593230526,"ip_address":"","comment_id":229732,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1593132946","product_id":100053801,"comment_content":"å‡ å¹´å‰ä½¿ç”¨canvaså†™è¿‡ä¸€äº›å°æ¸¸æˆ ä¿„ç½—æ–¯æ–¹å—ã€å¦å…‹å¤§æˆ˜ğŸ¤£ç°åœ¨éƒ½å¿˜äº†","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499616,"discussion_content":"å“ˆå“ˆï¼Œä½ å¯ä»¥è¯•ç€å†é‡æ–°å®ç°ä¸€ä¸‹ï¼Œæˆ–è€…è¯•è¯•æ”¹ç”¨webglæ¥å®ç°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593230526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":229619,"user_name":"ç‰¹å¼‚å‹å¤§å…‰å¤´","can_delete":false,"product_type":"c1","uid":2047839,"ip_address":"","ucode":"44CC71886FB121","user_header":"https://static001.geekbang.org/account/avatar/00/1f/3f/5f/053bc2da.jpg","comment_is_top":false,"comment_ctime":1593075806,"is_pvip":false,"replies":[{"id":"84861","content":"å‡½æ•°çš„å‚æ•°è§£æ„ï¼Œä½ å¯ä»¥çœ‹çœ‹ES6æ–‡æ¡£ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"æœˆå½±","uid":"1159792","ctime":1593230909,"ip_address":"","comment_id":229619,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1593075806","product_id":100053801,"comment_content":"åˆå­¦å‰ç«¯,è¯·é—®ä¸‹ draw() æ–¹æ³•è¿™ä¸ªå‚æ•°æ˜¯ä»€ä¹ˆæ„æ€{fillStyle = &#39;rgba(0, 0, 0, 0.2)&#39;, textColor = &#39;white&#39;} = {}","like_count":0,"discussions":[{"author":{"id":1159792,"avatar":"https://static001.geekbang.org/account/avatar/00/11/b2/70/ba9cecc6.jpg","nickname":"æœˆå½±","note":"","ucode":"298582FA7DBF27","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499566,"discussion_content":"å‡½æ•°çš„å‚æ•°è§£æ„ï¼Œä½ å¯ä»¥çœ‹çœ‹ES6æ–‡æ¡£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593230909,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2053893,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/57/05/4f27774e.jpg","nickname":"ï¹£7","note":"","ucode":"47DEA61FC2FC4C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291794,"discussion_content":"function draw({fillStyle , textColor}) {console.log(fillStyle,textColor)}\ndraw({ fillStyle:1, textColor:2 })   //  es6 å‚æ•°çš„ç»“æ„èµ‹å€¼\n\nfunction draw({ fillStyle=1, textColor=2 }) {console.log(fillStyle,textColor)}\ndraw({})  //  es6 å‚æ•°çš„ç»“æ„èµ‹å€¼,å¹¶ä¸”æ·»åŠ é»˜è®¤å€¼\n\nfunction draw({ fillStyle=1, textColor=2 } = {}) {console.log(fillStyle,textColor)}\ndraw()  // es6 å‚æ•°çš„ç»“æ„èµ‹å€¼,å¹¶ä¸”æ·»åŠ é»˜è®¤å€¼,å†ç»™å¯¹è±¡åŠ ä¸€ä¸ªé»˜è®¤å€¼\n\næˆ‘ç¬¬ä¸€çœ¼ä¹Ÿçœ‹æ‡µäº†...   å­¦åˆ°äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594954706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}