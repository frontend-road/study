{"id":623427,"title":"92｜小试牛刀：如何将数据进行图形化展示？","content":"<p><strong>本讲相关链接</strong><br>\n图表样式参考：<a href=\"https://matplotlib.org/stable/gallery/index\">https://matplotlib.org/stable/gallery/index</a></p><p><strong>课后习题</strong><br>\n请你编写程序，利用 Matplotlib 展示北京、上海两个城市一周内的气温变化曲线。</p><p><strong>课程代码、课件及其他相关资料地址</strong><br>\n<a href=\"https://gitee.com/wilsonyin/zero-basics-python\">https://gitee.com/wilsonyin/zero-basics-python</a></p>","comments":[{"had_liked":false,"id":367343,"user_name":"Cy23","can_delete":false,"product_type":"c3","uid":1591293,"ip_address":"辽宁","ucode":"8DC561C5151758","user_header":"https://static001.geekbang.org/account/avatar/00/18/47/fd/895f0c27.jpg","comment_is_top":false,"comment_ctime":1675149915,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import requests\nfrom bs4 import BeautifulSoup\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nurl1 = &#39;https:&#47;&#47;www.tianqi.com&#47;beijing&#47;7&#47;&#39;\nurl2 = &#39;https:&#47;&#47;www.tianqi.com&#47;shanghai&#47;7&#47;&#39;\n\ndef getHTMLtext(url):   \n  &quot;&quot;&quot;请求获得网页内容&quot;&quot;&quot;\n  headers = {&quot;User-Agent&quot;: &quot;Mozilla&#47;5.0 (Windows NT 10.0; WOW64) AppleWebKit&#47;537.36 (KHTML, like Gecko) Chrome&#47;86.0.4240.198 Safari&#47;537.36&quot;}\n  try:        \n   r = requests.get(url, timeout = 30, headers = headers)    \n   r.raise_for_status()        \n   r.encoding = r.apparent_encoding     \n   print(&quot;成功访问&quot;)        \n   return r.text    \n  except:        \n   print(&quot;访问错误&quot;)       \n   return&quot; &quot;\ndef get_content(city, html):\n  &quot;&quot;&quot;处理得到有用信息保存数据文件&quot;&quot;&quot;\n  final = []\n  bs = BeautifulSoup(html, &quot;html.parser&quot;)\n  body = bs.body\n  ul = body.find(&#39;ul&#39;, {&#39;class&#39;: &#39;weaul&#39;})\n  li = ul.find_all(&#39;li&#39;)\n  for day in li:\n    temp = [city]\n    date = day.find(attrs={&#39;class&#39;:&#39;fl&#39;}).string\n    temp.append(date)   \n\n    inf = day.find_all(attrs={&#39;class&#39;:&#39;weaul_z&#39;})\n    tem = inf[1].find_all(&#39;span&#39;)   \n    tem_low = int(tem[0].string)\n    temp.append(tem_low) \n    final.append(temp)\n  return final\n\nif __name__ == &#39;__main__&#39;:\n  # 北京\n  html_text1 = getHTMLtext(url1)\n  data1 = get_content(&#39;北京&#39;, html_text1)\n  # 上海\n  html_text2 = getHTMLtext(url2)\n  data2 = get_content(&#39;上海&#39;,html_text2)\n\n  df_list = data1+data2\n  df = pd.DataFrame(df_list)\n  header = [&#39;地区&#39;, &#39;日期&#39;, &#39;温度&#39;]\n  df.columns = header\n\n  x = df[df[&quot;地区&quot;] ==&#39;北京&#39;][&quot;日期&quot;]\n  \n  y1 = df[df[&quot;地区&quot;] ==&#39;北京&#39;][&quot;温度&quot;]\n  y2 = df[df[&quot;地区&quot;] ==&#39;上海&#39;][&quot;温度&quot;]\n\n  # 中文乱码\n  plt.rcParams[&#39;font.sans-serif&#39;]=[&#39;SimHei&#39;]\n  plt.rcParams[&#39;axes.unicode_minus&#39;]=False\n  # 绘制折线图\n  plt.plot(x, y1, label=&quot;北京&quot;)\n  plt.plot(x, y2, label=&quot;上海&quot;)\n  plt.legend(loc=&quot;upper left&quot;) \n  \n  plt.title(&quot;北京与上海近7天温度情况&quot;)\n  plt.ylabel(&quot;温度&quot;)\n  plt.xlabel(&quot;日期&quot;)\n  plt.show()","like_count":2},{"had_liked":false,"id":385225,"user_name":"Geek_631607","can_delete":false,"product_type":"c3","uid":3789991,"ip_address":"广东","ucode":"EAF874838F0BE4","user_header":"","comment_is_top":false,"comment_ctime":1702291135,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import matplotlib.pyplot as plt\n\n# 假设的北京和上海一周内的气温数据\nbeijing_temps = [22, 24, 25, 23, 22, 23, 24]\nshanghai_temps = [26, 27, 28, 29, 28, 27, 26]\n\n# 日期\ndates = [&#39;周一&#39;, &#39;周二&#39;, &#39;周三&#39;, &#39;周四&#39;, &#39;周五&#39;, &#39;周六&#39;, &#39;周日&#39;]\n\n# 创建一个新的图形\nplt.figure()\n\n# 绘制北京的气温变化曲线\nplt.plot(dates, beijing_temps, label=&#39;北京&#39;)\n\n# 绘制上海的气温变化曲线\nplt.plot(dates, shanghai_temps, label=&#39;上海&#39;)\n\n# 添加图例\nplt.legend()\nplt.rcParams[&#39;font.sans-serif&#39;] = [&#39;Arial Unicode MS&#39;]# 添加标题和轴标签\nplt.title(&#39;北京和上海一周内的气温变化&#39;)\nplt.xlabel(&#39;日期&#39;)\nplt.ylabel(&#39;气温&#39;)\n\n# 显示图形\nplt.show()","like_count":1},{"had_liked":false,"id":382686,"user_name":"Geek_Mike","can_delete":false,"product_type":"c3","uid":3196376,"ip_address":"云南","ucode":"CFA942192C3B74","user_header":"https://static001.geekbang.org/account/avatar/00/30/c5/d8/c5509b9c.jpg","comment_is_top":false,"comment_ctime":1697806892,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import csv\nfrom matplotlib import pyplot\nfrom datetime import datetime\n\nfilename = &#39;&#47;Users&#47;mike&#47;Desktop&#47;zero-basics-python&#47;0&#47;sitka_weather_07-2014.csv&#39;\nwith open(filename) as f:\n    reader = csv.reader(f)\n    header_row = next(reader)\n\n    # print(header_row)\n    # for index, column_header in enumerate(header_row):\n    #     print(index, column_header)\n\n    dates, highs = [],[]\n    for row in reader:\n        current_date = datetime.strptime(row[0], &quot;%Y-%m-%d&quot;)\n        dates.append(current_date)\n\n        high = int(row[1])\n        highs.append(high)\n    # print(highs)\n    # print(dates)\n\nfigure = pyplot.figure(dpi=128, figsize=(10, 6))\npyplot.plot(dates, highs, c=&#39;red&#39;)\n\npyplot.title(&#39;Daily high temperature, July 2014&#39;, fontsize=24)\npyplot.xlabel(&#39;&#39;, fontsize=16)\nfigure.autofmt_xdate()\npyplot.ylabel(&#39;Temperature (F)&#39;, fontsize=16)\npyplot.tick_params(axis=&#39;both&#39;, which=&#39;major&#39;, labelsize=16)\n\npyplot.show()","like_count":0}]}