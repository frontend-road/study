{"id":97658,"title":"18 | Word Countï¼šä»é›¶å¼€å§‹è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ªSparkåº”ç”¨","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯è”¡å…ƒæ¥ ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬æ¥ä»é›¶å¼€å§‹è¿è¡Œä½ çš„ç¬¬ä¸€ä¸ªSparkåº”ç”¨ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸€ä¸‹æ¨¡å—ä¸‰çš„å­¦ä¹ è·¯å¾„ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç”±æµ…å…¥æ·±åœ°å­¦ä¹ äº†Sparkçš„åŸºæœ¬æ•°æ®ç»“æ„RDDï¼Œäº†è§£äº†å®ƒè¿™æ ·è®¾è®¡çš„åŸå› ï¼Œä»¥åŠå®ƒæ‰€æ”¯æŒçš„APIã€‚</p><p>ä¹‹åï¼Œæˆ‘ä»¬åˆå­¦ä¹ äº†Spark SQLçš„DataSet/DataFrame APIï¼Œäº†è§£åˆ°å®ƒä¸ä»…æä¾›ç±»ä¼¼äºSQL queryçš„æ¥å£ï¼Œå¤§å¤§æé«˜äº†å¼€å‘è€…çš„å·¥ä½œæ•ˆç‡ï¼Œè¿˜é›†æˆäº†Catalystä¼˜åŒ–å™¨ï¼Œå¯ä»¥æå‡ç¨‹åºçš„æ€§èƒ½ã€‚</p><p>è¿™äº›APIåº”å¯¹çš„éƒ½æ˜¯æ‰¹å¤„ç†çš„åœºæ™¯ã€‚</p><p>å†ä¹‹åï¼Œæˆ‘ä»¬å­¦ä¹ äº†Sparkçš„æµå¤„ç†æ¨¡å—ï¼šSpark Streamingå’ŒStructured Streamingã€‚ä¸¤è€…éƒ½æ˜¯åŸºäºå¾®æ‰¹å¤„ç†ï¼ˆMicro batch processingï¼‰çš„æ€æƒ³ï¼Œå°†æµæ•°æ®æŒ‰æ—¶é—´é—´éš”åˆ†å‰²æˆå°çš„æ•°æ®å—è¿›è¡Œæ‰¹å¤„ç†ï¼Œå®æ—¶æ›´æ–°è®¡ç®—ç»“æœã€‚</p><p>å…¶ä¸­Structured Streamingä¹Ÿæ˜¯ä½¿ç”¨DataSet/DataFrame APIï¼Œè¿™å¥—APIåœ¨æŸç§ç¨‹åº¦ä¸Šç»Ÿä¸€äº†æ‰¹å¤„ç†å’Œæµå¤„ç†ï¼Œæ˜¯å½“å‰Sparkæœ€æµè¡Œçš„å·¥å…·ï¼Œæˆ‘ä»¬å¿…éœ€è¦å¥½å¥½æŒæ¡ã€‚</p><p>è™½ç„¶å­¦ä¹ äº†è¿™ä¹ˆå¤šAPIä»¥åŠå®ƒä»¬çš„åº”ç”¨ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†åŒå­¦è¿˜æ²¡æœ‰ä»é›¶å¼€å§‹å†™ä¸€ä¸ªå®Œæ•´çš„Sparkç¨‹åºï¼Œå¯èƒ½æ›´æ²¡æœ‰è¿è¡ŒSparkç¨‹åºçš„ç»å†ã€‚çº¸ä¸Šè°ˆå…µå¹¶ä¸èƒ½å¸®åŠ©æˆ‘ä»¬åœ¨å·¥ä½œç”Ÿæ´»ä¸­ç”¨Sparkè§£å†³å®é™…é—®é¢˜ã€‚æ‰€ä»¥ï¼Œä»Šå¤©æˆ‘å°±å’Œä½ ä¸€èµ·åšä¸ªå°ç»ƒä¹ ï¼Œä»åœ¨æœ¬åœ°å®‰è£…Sparkã€é…ç½®ç¯å¢ƒå¼€å§‹ï¼Œä¸ºä½ ç¤ºèŒƒæ€æ ·ä¸€æ­¥æ­¥è§£å†³ä¹‹å‰æåˆ°æ•°æ¬¡çš„ç»Ÿè®¡è¯é¢‘ï¼ˆWord Countï¼‰çš„é—®é¢˜ã€‚</p><!-- [[[read_end]]] --><p>é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œä½ å¯ä»¥æ”¶è·ï¼š</p><ul>\n<li>æ€æ ·å®‰è£…Sparkä»¥åŠå…¶ä»–ç›¸å…³çš„æ¨¡å—ï¼›</li>\n<li>çŸ¥é“ä»€ä¹ˆæ˜¯SparkContextã€SparkSessionï¼›</li>\n<li>ä¸€ä¸ªå®Œæ•´çš„Sparkç¨‹åºåº”è¯¥åŒ…å«å“ªäº›ä¸œè¥¿ï¼›</li>\n<li>ç”¨RDDã€DataFrameã€Spark Streamingå¦‚ä½•å®ç°ç»Ÿè®¡è¯é¢‘ã€‚</li>\n</ul><p>è¿™ä¸€è®²ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€æ˜¯Pythonï¼Œæ“ä½œç³»ç»Ÿæ˜¯Mac OS Xã€‚</p><p>åœ¨è¿™ä¸€è®²ä»¥åŠä¹‹å‰æ–‡ç« çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éƒ½æ˜¯ç”¨Pythonä½œä¸ºå¼€å‘è¯­è¨€ã€‚è™½ç„¶åŸç”Ÿçš„Sparkæ˜¯ç”¨Scalaå®ç°ï¼Œä½†æ˜¯åœ¨å¤§æ•°æ®å¤„ç†é¢†åŸŸä¸­ï¼Œæˆ‘ä¸ªäººæœ€å–œæ¬¢çš„è¯­è¨€æ˜¯Pythonã€‚å› ä¸ºå®ƒéå¸¸ç®€å•æ˜“ç”¨ï¼Œåº”ç”¨éå¸¸å¹¿æ³›ï¼Œæœ‰å¾ˆå¤šçš„åº“å¯ä»¥æ–¹ä¾¿æˆ‘ä»¬å¼€å‘ã€‚</p><p>å½“ç„¶Scalaä¹Ÿå¾ˆæ£’ï¼Œä½œä¸ºä¸€ä¸ªå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒå¾ˆå®¹æ˜“ç”¨é“¾å¼è¡¨è¾¾å¯¹æ•°æ®é›†è¿›è¡Œå„ç§å¤„ç†ï¼Œè€Œä¸”å®ƒçš„è¿è¡Œé€Ÿåº¦æ˜¯æœ€å¿«çš„ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦å¯ä»¥å»å­¦ä¹ ä¸€ä¸‹ã€‚</p><p>è™½ç„¶Sparkè¿˜æ”¯æŒJavaå’ŒRï¼Œä½†æ˜¯æˆ‘ä¸ªäººä¸æ¨èä½ ä½¿ç”¨ã€‚ç”¨Javaå†™ç¨‹åºå®åœ¨æœ‰äº›å†—é•¿ï¼Œè€Œä¸”é€Ÿåº¦ä¸Šæ²¡æœ‰ä¼˜åŠ¿ã€‚</p><p>æ“ä½œç³»ç»Ÿé€‰Mac OS Xæ˜¯å› ä¸ºæˆ‘ä¸ªäººå–œæ¬¢ä½¿ç”¨Macbookï¼Œå½“ç„¶Linux/Ubuntuä¹Ÿå¾ˆæ£’ã€‚</p><h2>å®‰è£…Spark</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥ç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•åœ¨æœ¬åœ°å®‰è£…Sparkï¼Œä»¥åŠç”¨Pythonå®ç°çš„Sparkåº“â€”â€”PySparkã€‚</p><p>åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬äº†è§£è¿‡ï¼ŒSparkçš„jobéƒ½æ˜¯JVMï¼ˆJava Virtual Machineï¼‰çš„è¿›ç¨‹ï¼Œæ‰€ä»¥åœ¨å®‰è£…è¿è¡ŒSparkä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿å·²ç»å®‰è£…Java Developer Kitï¼ˆJDKï¼‰ã€‚åœ¨å‘½ä»¤è¡Œç»ˆç«¯ä¸­è¾“å…¥ï¼š</p><pre><code>java -version\n</code></pre><p>å¦‚æœå‘½ä»¤è¡Œè¾“å‡ºäº†æŸä¸ªJavaçš„ç‰ˆæœ¬ï¼Œé‚£ä¹ˆè¯´æ˜ä½ å·²ç»æœ‰JDKæˆ–è€…JREåœ¨æœ¬åœ°ã€‚å¦‚æœæ˜¾ç¤ºæ— æ³•è¯†åˆ«è¿™ä¸ªå‘½ä»¤ï¼Œé‚£ä¹ˆè¯´æ˜ä½ è¿˜æ²¡æœ‰å®‰è£…JDKã€‚è¿™æ—¶ï¼Œä½ å¯ä»¥å»<a href=\"https://www.oracle.com/technetwork/java/javase/downloads/index.html\">Oracleçš„å®˜ç½‘</a>å»ä¸‹è½½å®‰è£…JDKï¼Œç„¶åé…ç½®å¥½ç¯å¢ƒå˜é‡ã€‚</p><p>åŒæ ·ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿Pythonä¹Ÿå·²ç»è¢«å®‰è£…åœ¨æœ¬åœ°äº†ã€‚åœ¨å‘½ä»¤è¡Œè¾“å…¥â€œPythonâ€æˆ–è€…â€œPython3â€ï¼Œå¦‚æœå¯ä»¥æˆåŠŸè¿›å…¥äº¤äº’å¼çš„Python Shellï¼Œå°±è¯´æ˜å·²ç»å®‰è£…äº†Pythonã€‚å¦åˆ™ï¼Œéœ€è¦å»<a href=\"https://www.python.org/downloads/\">Pythonå®˜ç½‘</a>ä¸‹è½½å®‰è£…Pythonã€‚è¿™é‡Œï¼Œæˆ‘æ¨èä½ ä½¿ç”¨Python3è€Œä¸æ˜¯Python2ã€‚</p><p>æˆ‘ä»¬åŒæ ·å¯ä»¥åœ¨æœ¬åœ°é¢„è£…å¥½Hadoopã€‚Sparkå¯ä»¥è„±ç¦»Hadoopè¿è¡Œï¼Œä¸è¿‡æœ‰æ—¶æˆ‘ä»¬ä¹Ÿéœ€è¦ä¾èµ–äºHDFSå’ŒYARNã€‚æ‰€ä»¥ï¼Œè¿™ä¸€æ­¥å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä½ å¯ä»¥è‡ªè¡Œé€‰æ‹©ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å®‰è£…Sparkã€‚é¦–å…ˆå»<a href=\"https://spark.apache.org/downloads.html\">Sparkå®˜ç½‘</a>çš„ä¸‹è½½ç•Œé¢ã€‚åœ¨ç¬¬ä¸€ä¸ªä¸‹æ‹‰èœå•é‡Œé€‰æ‹©æœ€æ–°çš„å‘å¸ƒï¼Œç¬¬äºŒä¸ªèœå•æœ€å¥½é€‰æ‹©ä¸Hadoop 2.7å…¼å®¹çš„ç‰ˆæœ¬ã€‚å› ä¸ºæœ‰æ—¶æˆ‘ä»¬çš„Sparkç¨‹åºä¼šä¾èµ–äºHDFSå’ŒYARNï¼Œæ‰€ä»¥é€‰æ‹©æœ€æ–°çš„Hadoopç‰ˆæœ¬æ¯”è¾ƒå¥½ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/e9/28/e934ae8f6f3f2394e1d14153953f4328.png?wh=1600*895\" alt=\"\"></p><p>ä¸‹è½½å¥½ä¹‹åï¼Œè§£å‹ç¼©Sparkå®‰è£…åŒ…ï¼Œå¹¶ä¸”æŠŠå®ƒç§»åŠ¨åˆ°/usr/localç›®å½•ä¸‹ï¼Œåœ¨ç»ˆç«¯ä¸­è¾“å…¥ä¸‹é¢çš„ä»£ç ã€‚</p><pre><code>$ tar -xzf ~/Dowmloads/spark-2.4.3-bin-hadoop2.7.tg\n$ mv spark-2.4.3-bin-hadoop2.7.tgz /usr/local/spark\n</code></pre><p>ç»è¿‡ä¸Šè¿°æ­¥éª¤ï¼Œä»å®˜ç½‘ä¸‹è½½å¹¶å®‰è£…Sparkçš„æ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬ä¾¿å®Œæˆäº†Sparkçš„å®‰è£…ã€‚ä½†æ˜¯ï¼ŒSparkä¹Ÿæ˜¯è¦è¿›è¡Œç›¸åº”çš„ç¯å¢ƒå˜é‡é…ç½®çš„ã€‚ä½ éœ€è¦æ‰“å¼€ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ã€‚</p><pre><code>vim ~/.bash_profile\n</code></pre><p>å¹¶åœ¨æœ€åæ·»åŠ ä¸€æ®µä»£ç ã€‚</p><pre><code>export SPARK_HOME=/usr/local/spark\nexport PATH=$PATH:$SPARK_HOME/bin\n</code></pre><p>è¿™æ ·ï¼Œæ‰€éœ€çš„æ­¥éª¤éƒ½åšå®Œä¹‹åï¼Œæˆ‘ä»¬åœ¨å‘½ä»¤è¡Œæ§åˆ¶å°è¾“å…¥PySparkï¼ŒæŸ¥çœ‹å®‰è£…æƒ…å†µã€‚å¦‚æœå‡ºç°ä¸‹é¢çš„æ¬¢è¿æ ‡å¿—ï¼Œå°±è¯´æ˜å®‰è£…å®Œæ¯•äº†ã€‚</p><pre><code>Welcome to\n      ____              __\n     / __/__  ___ _____/ /__\n    _\\ \\/ _ \\/ _ `/ __/  '_/\n   /__ / .__/\\_,_/_/ /_/\\_\\   version 2.4.3\n      /_/\n\nUsing Python version 2.7.10 (default, Oct  6 2017 22:29:07)\nSparkSession available as 'spark'.\n&gt;&gt;&gt;\n</code></pre><h2>åŸºäºRDD APIçš„Word Countç¨‹åº</h2><p>é…ç½®å¥½æ‰€éœ€çš„å¼€å‘ç¯å¢ƒä¹‹åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å†™ä¸€ä¸ªPythonç¨‹åºå»ç»Ÿè®¡è¯è¯­é¢‘ç‡ã€‚æˆ‘ä»¬éƒ½çŸ¥é“è¿™ä¸ªç¨‹åºçš„é€»è¾‘åº”è¯¥æ˜¯å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b0/2e/b0b16243323bb871959e9a86b803992e.jpg?wh=1768*506\" alt=\"\"></p><p>å¯¹äºä¸­é—´çš„å…ˆmapå†reduceçš„å¤„ç†ï¼Œæˆ‘ç›¸ä¿¡é€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæ‰€æœ‰åŒå­¦éƒ½å¯ä»¥ç”¨RDDæˆ–è€…DataFrameå®ç°ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯¹äºSparkç¨‹åºçš„å…¥å£æ˜¯ä»€ä¹ˆã€å¦‚ä½•ç”¨å®ƒè¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼Œå¯èƒ½å¹¶æ²¡æœ‰äº†è§£å¤ªå¤šã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬å…ˆæ¥è§¦ä¸€ä¸‹Sparkç¨‹åºçš„å…¥å£ã€‚</p><p>åœ¨Spark 2.0ä¹‹å‰ï¼Œ<strong>SparkContext</strong>æ˜¯æ‰€æœ‰Sparkä»»åŠ¡çš„å…¥å£ï¼Œå®ƒåŒ…å«äº†Sparkç¨‹åºçš„åŸºæœ¬è®¾ç½®ï¼Œæ¯”å¦‚ç¨‹åºçš„åå­—ã€å†…å­˜å¤§å°ã€å¹¶è¡Œå¤„ç†çš„ç²’åº¦ç­‰ï¼ŒSparkçš„é©±åŠ¨ç¨‹åºéœ€è¦åˆ©ç”¨å®ƒæ¥è¿æ¥åˆ°é›†ç¾¤ã€‚</p><p>æ— è®ºSparké›†ç¾¤æœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹åšå¹¶è¡Œå¤„ç†ï¼Œæ¯ä¸ªç¨‹åºåªå¯ä»¥æœ‰å”¯ä¸€çš„SparkContextï¼Œå®ƒå¯ä»¥è¢«SparkConfå¯¹è±¡åˆå§‹åŒ–ã€‚</p><pre><code>conf = SparkConf().setAppName(appName).setMaster(master)\nsc = SparkContext(conf=conf)\n</code></pre><p>è¿™ä¸ªappNameå‚æ•°æ˜¯ä¸€ä¸ªåœ¨é›†ç¾¤UIä¸Šå±•ç¤ºåº”ç”¨ç¨‹åºçš„åç§°ï¼Œmasterå‚æ•°æ˜¯ä¸€ä¸ªSparkã€Mesos æˆ–YARNçš„é›†ç¾¤URLï¼Œå¯¹äºæœ¬åœ°è¿è¡Œï¼Œå®ƒå¯ä»¥è¢«æŒ‡å®šä¸ºâ€œlocalâ€ã€‚</p><p>åœ¨ç»Ÿè®¡è¯é¢‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡SparkContextå¯¹è±¡æ¥è¯»å–è¾“å…¥æ–‡ä»¶ï¼Œåˆ›å»ºä¸€ä¸ªRDDï¼Œå¦‚ä¸‹é¢çš„ä»£ç æ‰€ç¤ºã€‚</p><pre><code>text_file = sc.textFile(&quot;file://â€¦...&quot;) //æ›¿æ¢æˆå®é™…çš„æœ¬åœ°æ–‡ä»¶è·¯å¾„ã€‚\n</code></pre><p>è¿™é‡Œçš„text_fileæ˜¯ä¸€ä¸ªRDDï¼Œå®ƒé‡Œé¢çš„æ¯ä¸€ä¸ªæ•°æ®ä»£è¡¨åŸæ–‡æœ¬æ–‡ä»¶ä¸­çš„ä¸€è¡Œã€‚</p><p>åœ¨è¿™äº›ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœè¦ä½¿ç”¨Sparkæä¾›çš„å…¶ä»–åº“ï¼Œæ¯”å¦‚SQLæˆ–Streamingï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸ºå®ƒä»¬åˆ†åˆ«åˆ›å»ºç›¸åº”çš„contextå¯¹è±¡ï¼Œæ‰èƒ½è°ƒç”¨ç›¸åº”çš„APIï¼Œæ¯”å¦‚çš„DataFrameå’ŒDStreamã€‚</p><pre><code>hc = HiveContext(sc)\nssc = StreamingContext(sc)\n</code></pre><p>åœ¨Spark 2.0ä¹‹åï¼Œéšç€æ–°çš„DataFrame/DataSet APIçš„æ™®åŠåŒ–ï¼ŒSparkå¼•å…¥äº†æ–°çš„<strong>SparkSession</strong>å¯¹è±¡ä½œä¸ºæ‰€æœ‰Sparkä»»åŠ¡çš„å…¥å£ã€‚</p><p>SparkSessionä¸ä»…æœ‰SparkContextçš„æ‰€æœ‰åŠŸèƒ½ï¼Œå®ƒè¿˜é›†æˆäº†æ‰€æœ‰Sparkæä¾›çš„APIï¼Œæ¯”å¦‚DataFrameã€Spark Streamingå’ŒStructured Streamingï¼Œæˆ‘ä»¬å†ä¹Ÿä¸ç”¨ä¸ºä¸åŒçš„åŠŸèƒ½åˆ†åˆ«å®šä¹‰Contextã€‚</p><p>åœ¨ç»Ÿè®¡è¯é¢‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·åˆå§‹åŒ–SparkSessionä»¥åŠåˆ›å»ºåˆå§‹RDDã€‚</p><pre><code>spark = SparkSession\n       .builder\n       .appName(appName)\n       .getOrCreate()\ntext_file = spark.read.text(&quot;file://â€¦.&quot;).rdd.map(lambda r: r[0])\n</code></pre><p>ç”±äºSparkSessionçš„æ™®é€‚æ€§ï¼Œæˆ‘æ¨èä½ å°½é‡ä½¿ç”¨å®ƒä½œä¸ºä½ ä»¬Sparkç¨‹åºçš„å…¥å£ã€‚éšåçš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä¼šé€æ¸äº†è§£æ€æ ·é€šè¿‡å®ƒè°ƒç”¨DataFrameå’ŒStreaming APIã€‚</p><p>è®©æˆ‘ä»¬å›åˆ°ç»Ÿè®¡è¯é¢‘çš„ä¾‹å­ã€‚åœ¨åˆ›å»ºå¥½ä»£è¡¨æ¯ä¸€è¡Œæ–‡æœ¬çš„RDDä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¾¿éœ€è¦ä¸¤ä¸ªæ­¥éª¤ã€‚</p><ol>\n<li>æŠŠæ¯è¡Œçš„æ–‡æœ¬æ‹†åˆ†æˆä¸€ä¸ªä¸ªè¯è¯­ï¼›</li>\n<li>ç»Ÿè®¡æ¯ä¸ªè¯è¯­çš„é¢‘ç‡ã€‚</li>\n</ol><p>å¯¹äºç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨flatMapå»æŠŠè¡Œè½¬æ¢æˆè¯è¯­ã€‚å¯¹äºç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠŠæ¯ä¸ªè¯è¯­è½¬æ¢æˆï¼ˆword, 1ï¼‰çš„å½¢å¼ï¼Œç„¶åç”¨reduceByKeyå»æŠŠç›¸åŒè¯è¯­çš„æ¬¡æ•°ç›¸åŠ èµ·æ¥ã€‚è¿™æ ·ï¼Œå°±å¾ˆå®¹æ˜“å†™å‡ºä¸‹é¢çš„ä»£ç äº†ã€‚</p><pre><code>counts = lines.flatMap(lambda x: x.split(' '))\n                  .map(lambda x: (x, 1))\n                  .reduceByKey(add)\n</code></pre><p>è¿™é‡Œcountså°±æ˜¯ä¸€ä¸ªåŒ…å«æ¯ä¸ªè¯è¯­çš„ï¼ˆwordï¼Œcountï¼‰pairçš„RDDã€‚</p><p>ç›¸ä¿¡ä½ è¿˜è®°å¾—ï¼Œåªæœ‰å½“ç¢°åˆ°actionæ“ä½œåï¼Œè¿™äº›è½¬æ¢åŠ¨ä½œæ‰ä¼šè¢«æ‰§è¡Œã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥ç”¨collectæ“ä½œæŠŠç»“æœæŒ‰æ•°ç»„çš„å½¢å¼è¿”å›å¹¶è¾“å‡ºã€‚</p><pre><code>output = counts.collect()\nfor (word, count) in output:\n    print(&quot;%s: %i&quot; % (word, count))\nspark.stop() // åœæ­¢SparkSession\n</code></pre><h2>åŸºäºDataFrame APIçš„Word Countç¨‹åº</h2><p>è®²å®ŒåŸºäºRDD APIçš„Word Countç¨‹åºï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬å­¦ä¹ ä¸‹æ€æ ·ç”¨DataFrame APIæ¥å®ç°ç›¸åŒçš„æ•ˆæœã€‚</p><p>åœ¨DataFrameçš„ä¸–ç•Œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰çš„è¯è¯­æ”¾å…¥ä¸€å¼ è¡¨ï¼Œè¡¨ä¸­çš„æ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªè¯è¯­ï¼Œå½“ç„¶è¿™ä¸ªè¡¨åªæœ‰ä¸€åˆ—ã€‚æˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªè¡¨ç”¨ä¸€ä¸ªgroupBy()æ“ä½œæŠŠæ‰€æœ‰ç›¸åŒçš„è¯è¯­èšåˆèµ·æ¥ï¼Œç„¶åç”¨count()æ¥ç»Ÿè®¡å‡ºæ¯ä¸ªgroupçš„æ•°é‡ã€‚</p><p>ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œè™½ç„¶Scalaå’ŒJavaæ”¯æŒå¯¹DataFrameè¿›è¡ŒflatMapæ“ä½œï¼Œä½†æ˜¯Pythonå¹¶ä¸æ”¯æŒã€‚é‚£ä¹ˆè¦æ€æ ·æŠŠåŒ…å«å¤šä¸ªè¯è¯­çš„å¥å­è¿›è¡Œåˆ†å‰²å’Œæ‹†åˆ†å‘¢ï¼Ÿè¿™å°±è¦ç”¨åˆ°ä¸¤ä¸ªæ–°çš„æ“ä½œâ€”â€”explodeå’Œsplitã€‚splitæ˜¯pyspark.sql.functionsåº“æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä½œç”¨äºDataFrameçš„æŸä¸€åˆ—ï¼Œå¯ä»¥æŠŠåˆ—ä¸­çš„å­—ç¬¦ä¸²æŒ‰æŸä¸ªåˆ†éš”ç¬¦åˆ†å‰²æˆä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚</p><p>explodeåŒæ ·æ˜¯pyspark.sql.functionsåº“æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œé€šä¿—ç‚¹çš„ç¿»è¯‘æ˜¯â€œçˆ†ç‚¸â€ï¼Œå®ƒä¹Ÿä½œç”¨äºDataFrameçš„æŸä¸€åˆ—ï¼Œå¯ä»¥ä¸ºåˆ—ä¸­çš„æ•°ç»„æˆ–è€…mapä¸­æ¯ä¸€ä¸ªå…ƒç´ åˆ›å»ºä¸€ä¸ªæ–°çš„Rowã€‚</p><p>ç”±äºä¹‹å‰ä»£ç ä¸­åˆ›å»ºçš„df_linesè¿™ä¸ªDataFrameä¸­ï¼Œæ¯ä¸€è¡Œåªæœ‰ä¸€åˆ—ï¼Œæ¯ä¸€åˆ—éƒ½æ˜¯ä¸€ä¸ªåŒ…å«å¾ˆå¤šè¯è¯­çš„å¥å­ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¯¹è¿™ä¸€åˆ—åšsplitï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„åˆ—ï¼Œåˆ—ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªè¯è¯­çš„æ•°ç»„ï¼›å†å¯¹è¿™ä¸ªåˆ—åšexplodeï¼Œå¯ä»¥æŠŠæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ç”Ÿæˆä¸€ä¸ªæ–°çš„Rowã€‚è¿™æ ·ï¼Œå°±å®ç°äº†ç±»ä¼¼çš„flatMapåŠŸèƒ½ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç”¨ä¸‹é¢çš„ä¸‰ä¸ªè¡¨æ ¼è¯´æ˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c9/55/c9ebf1f324a73539a2a57ce8151e4455.png?wh=3410*3180\" alt=\"\"></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦å¯¹Wordè¿™ä¸€åˆ—åšgroupByï¼Œå°±å¯ä»¥ç»Ÿè®¡å‡ºæ¯ä¸ªè¯è¯­å‡ºç°çš„é¢‘ç‡ï¼Œä»£ç å¦‚ä¸‹ã€‚</p><pre><code>from pyspark.sql import SparkSession\nfrom pyspark.sql.functions import *\n\nif __name__ == &quot;__main__&quot;:\n   spark = SparkSession\n       .builder\n       .appName(â€˜WordCountâ€™)\n       .getOrCreate()\n   lines = spark.read.text(&quot;sample.txt&quot;)\n   wordCounts = lines\n       .select(explode(split(lines.value, &quot; &quot;))\n       .alias(&quot;word&quot;))\n       .groupBy(&quot;word&quot;)\n       .count()\n   wordCounts.show()\n   \n   spark.stop()\n</code></pre><p>ä»è¿™ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“çœ‹å‡ºä½¿ç”¨DataSet/DataFrame APIçš„ä¾¿åˆ©æ€§â€”â€”æˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºï¼ˆword, countï¼‰çš„pairæ¥ä½œä¸ºä¸­é—´å€¼ï¼Œå¯ä»¥ç›´æ¥å¯¹æ•°æ®åšç±»ä¼¼SQLçš„æŸ¥è¯¢ã€‚</p><h2>å°ç»“</h2><p>é€šè¿‡ä»Šå¤©çš„å­¦ä¹ ï¼Œæˆ‘ä»¬æŒæ¡äº†å¦‚ä½•ä»é›¶å¼€å§‹åˆ›å»ºä¸€ä¸ªç®€å•çš„Sparkçš„åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å¦‚ä½•å®‰è£…Sparkã€å¦‚ä½•é…ç½®ç¯å¢ƒã€Sparkç¨‹åºçš„åŸºæœ¬ç»“æ„ç­‰ç­‰ã€‚</p><h2>å®è·µé¢˜</h2><p>å¸Œæœ›ä½ å¯ä»¥è‡ªå·±åŠ¨æ‰‹æ“ä½œä¸€ä¸‹ï¼Œè¿™æ•´ä¸ªè¿‡ç¨‹åªéœ€è¦è·‘é€šä¸€æ¬¡ï¼Œä»¥åå°±å¯ä»¥è„±ç¦»çº¸ä¸Šè°ˆå…µï¼ŒçœŸæ­£å»è§£å†³å®é™…é—®é¢˜ã€‚</p><p>æ¬¢è¿ä½ åœ¨ç•™è¨€ä¸­åé¦ˆè‡ªå·±åŠ¨æ‰‹æ“ä½œçš„æ•ˆæœã€‚</p><p>å¦‚æœä½ è·‘é€šäº†ï¼Œå¯ä»¥åœ¨ç•™è¨€ä¸­æ‰“ä¸ªå¡ã€‚å¦‚æœé‡åˆ°äº†é—®é¢˜ï¼Œä¹Ÿè¯·ä½ åœ¨æ–‡ç« ä¸­ç•™è¨€ï¼Œä¸æˆ‘å’Œå…¶ä»–åŒå­¦ä¸€èµ·è®¨è®ºã€‚</p><p></p>","neighbors":{"left":{"article_title":"17 | Structured Streamingï¼šå¦‚ä½•ç”¨DataFrame APIè¿›è¡Œå®æ—¶æ•°æ®åˆ†æ?","id":97121},"right":{"article_title":"19 | ç»¼åˆæ¡ˆä¾‹å®æˆ˜ï¼šå¤„ç†åŠ å·æˆ¿å±‹ä¿¡æ¯ï¼Œæ„å»ºçº¿æ€§å›å½’æ¨¡å‹","id":98374}},"comments":[{"had_liked":false,"id":98741,"user_name":"æœ±åŒå­¦","can_delete":false,"product_type":"c1","uid":1514233,"ip_address":"","ucode":"2EF7D5A051712C","user_header":"https://static001.geekbang.org/account/avatar/00/17/1a/f9/180f347a.jpg","comment_is_top":false,"comment_ctime":1559089212,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"83163467836","product_id":100025301,"comment_content":"javaä¸‡é‡‘æ²¹ï¼Œä»€ä¹ˆéƒ½å¯ä»¥å¹²ï¼Œäººå¥½æ‹›ï¼Œç‰¹åˆ«æ˜¯æˆ‘ä»¬è¿™ç§åè¿œåœ°åŒºï¼Œscalaï¼Œè™½ç„¶å¼€å‘æ•ˆç‡é«˜ï¼Œä½†æ˜¯äººå°‘ï¼Œéš¾æ‹›ï¼Œæ‰€ä»¥æˆ‘ä»¬å¤§æ•°æ®å›¢é˜Ÿé€‰æ‹©äº†javaã€‚è‡³äºè¿è¡Œæ•ˆç‡ï¼Œpyæ˜¯æœ€æ…¢çš„ï¼Œjavaå’Œscalaåº”è¯¥åŠæ–¤å…«ä¿©å§","like_count":20},{"had_liked":false,"id":105523,"user_name":"ç§‘å­¦Jia","can_delete":false,"product_type":"c1","uid":1080409,"ip_address":"","ucode":"95430413F82A69","user_header":"https://static001.geekbang.org/account/avatar/00/10/7c/59/26b1e65a.jpg","comment_is_top":false,"comment_ctime":1561020806,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40215726470","product_id":100025301,"comment_content":"å¥³åŒå­¦çœ‹å®Œ2015å¹´å‡ºçš„sparkå¿«é€Ÿå¤§æ•°æ®åˆ†æè¿™æœ¬ä¹¦ä»¥åï¼Œå†æ¥çœ‹è€å¸ˆå†™çš„è¿™äº›æ–‡å­—ï¼Œè§‰å¾—è¨€ç®€æ„èµ…ï¼Œå°è±¡æ·±åˆ»ï¼Œè‡³äºç”¨ä»€ä¹ˆè¯­è¨€å€’æ— æ‰€è°“äº†ï¼Œä¸»è¦æ˜¯æ€è·¯ã€‚åæœŸå¸Œæœ›è€å¸ˆèƒ½å¤šè¯´ä¸€äº›æ¡ˆä¾‹å’Œå¤„ç†ä¸­éœ€è¦æ³¨æ„çš„æŠ€å·§ã€‚","like_count":9},{"had_liked":false,"id":98864,"user_name":"ä¸€","can_delete":false,"product_type":"c1","uid":1220750,"ip_address":"","ucode":"28E0605EA1AE88","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/8e/6e4c7509.jpg","comment_is_top":false,"comment_ctime":1559109597,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31623880669","product_id":100025301,"comment_content":"çœ‹äº†è¿™ä¸€è®²æ„è¯†åˆ°ä¹‹å‰å¯¹Pythonæ¬ ç¼ºäº†é‡è§†ï¼Œç°åœ¨æ˜ç™½Pythonåœ¨å¤§æ•°æ®å¤„ç†é¢†åŸŸæ˜¯å¾ˆæœ‰ç«äº‰åŠ›çš„ï¼Œå› ä¸ºSparkå’Œä¼—å¤šçš„åº“çš„åŸå› ï¼Œç”šè‡³è¶…è¶ŠJavaï¼Œæ‰€ä»¥ç°åœ¨è¦é‡æ–°é‡è§†èµ·æ¥Pythonçš„å­¦ä¹ äº†","like_count":7},{"had_liked":false,"id":101814,"user_name":"hallo128","can_delete":false,"product_type":"c1","uid":1212044,"ip_address":"","ucode":"3921D6E11CFCB1","user_header":"https://static001.geekbang.org/account/avatar/00/12/7e/8c/f029535a.jpg","comment_is_top":false,"comment_ctime":1559981251,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27329785027","product_id":100025301,"comment_content":"ã€ä»¥ä¸‹ä»£ç å¯ä»¥è¿è¡Œï¼Œä½†å¯¹dfæ ¼å¼çš„æ“ä½œæ˜¯å€ŸåŠ©äºŒæ¥¼çš„ç½‘å€å»æ‰¾çš„ï¼Œå…·ä½“å«ä¹‰ä¹Ÿä¸å¤ªæ¸…æ¥šï¼Œåªæ˜¯å¯ä»¥è¿è¡Œå‡ºæ¥ã€‘<br><br>#pythonå‰è¿è¡Œè°ƒç”¨åŒ…<br>from pyspark.sql import SparkSession<br>from pyspark.sql.functions import explode<br>from pyspark.sql.functions import split<br><br>#åˆå§‹åŒ–SparkSessionç¨‹åºå…¥å£<br>spark = SparkSession.builder.appName(&quot;WordCount&quot;).getOrCreate()<br>#è¯»å…¥æ–‡æ¡£<br>ds_lines = spark.read.text(&quot;&#47;Users&#47;apple&#47;code_tool&#47;spark&#47;WordCount&#47;demo.md&quot;)<br>#é’ˆå¯¹dfç‰¹å®šçš„è®¡ç®—æ ¼å¼<br>words = ds_lines.select(<br>   explode(<br>       split(ds_lines.value, &quot; &quot;)<br>   ).alias(&quot;word&quot;)<br>)<br>#è¿”å›çš„RDDè¿›è¡Œè®¡æ•°<br>wordCounts = words.groupBy(&quot;word&quot;).count()<br>#å±•ç¤º<br>wordCounts.show()<br>#å…³é—­spark<br>spark.stop()","like_count":6},{"had_liked":false,"id":98815,"user_name":"9527","can_delete":false,"product_type":"c1","uid":1032735,"ip_address":"","ucode":"04B51C09E3C7B8","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c2/1f/343f2dec.jpg","comment_is_top":false,"comment_ctime":1559099645,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"27328903421","product_id":100025301,"comment_content":"spark_session = SparkSession.builder.appName(&quot;PySparkShell&quot;).getOrCreate()<br>ds_lines = spark_session.read.textFile(&quot;README.md&quot;)<br>ds = ds_lines.flatMap(lambda x: x.split(&#39; &#39;)).groupBy(&quot;Value&quot;).count()<br>ds.show()<br><br>æˆ‘æ‰§è¡Œè¿™æ®µçš„æ—¶å€™æŠ¥é”™äº†<br>AttributeError: &#39;DataFrameReader&#39; object has no attribute &#39;textFile&#39;<br>å¦‚æœæŠŠtextFile()æ”¹æˆtext()å°±å¯¹äº†<br>å†æ‰§è¡ŒflatMapé‚£æ®µï¼Œä¹ŸæŠ¥é”™äº†<br>AttributeError: &#39;DataFrame&#39; object has no attribute &#39;flatMap&#39;<br>æ˜¯ä¸æ˜¯APIå˜åŠ¨äº†ï¼Œæˆ‘ç”¨çš„æ˜¯2.4.3ç‰ˆæœ¬å•æœºæ‰§è¡Œçš„","like_count":6,"discussions":[{"author":{"id":1231677,"avatar":"https://static001.geekbang.org/account/avatar/00/12/cb/3d/1c582da8.jpg","nickname":"å¿ƒæœ‰åŒæœ¨","note":"","ucode":"7A625AB9F03C9F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":9849,"discussion_content":"ä½œè€…éƒ½è¯´äº†ï¼ŒPythonä¸æ”¯æŒflatMap","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568218855,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":101786,"user_name":"hallo128","can_delete":false,"product_type":"c1","uid":1212044,"ip_address":"","ucode":"3921D6E11CFCB1","user_header":"https://static001.geekbang.org/account/avatar/00/12/7e/8c/f029535a.jpg","comment_is_top":false,"comment_ctime":1559971315,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"18739840499","product_id":100025301,"comment_content":"â€œè™½ç„¶ Spark è¿˜æ”¯æŒ Java å’Œ Rï¼Œä½†æ˜¯æˆ‘ä¸ªäººä¸æ¨èä½ ä½¿ç”¨ã€‚ç”¨ Java å†™ç¨‹åºå®åœ¨æœ‰äº›å†—é•¿ï¼Œè€Œä¸”é€Ÿåº¦ä¸Šæ²¡æœ‰ä¼˜åŠ¿ã€‚â€<br>æ¨èä½¿ç”¨ï¼Œè¿˜æ˜¯åº”è¯¥è¯¦ç»†è¯´æ˜å¯¹æ¯”ä¸‹ï¼Œä¸èƒ½åªå› ä¸ºè‡ªå·±åå¥½æŸç§å·¥å…·ç»™å‡ºå»ºè®®ã€‚å¯¹äºsparkåŸç”Ÿæ¥è¯´ï¼Œé€Ÿåº¦å’Œåº“åŒæ­¥æ›´æ–°æ›´å¿«çš„æ˜¯Scalaï¼Œå¦‚æœä½ æƒ³éšæ—¶ç”¨åˆ°sparkæœ€æ–°åŠŸèƒ½åº“çš„è¯ï¼Œå°±åº”è¯¥é€‰æ‹©Scalaï¼ŒåŒæ—¶é€Ÿåº¦ä¹Ÿæ˜¯æœ€å¿«çš„ã€‚<br>è‡³äºPythonï¼ŒRï¼ŒJavaï¼Œä¸€æ–¹é¢å’Œä½ çš„ç†Ÿæ‚‰ç¨‹åº¦æœ‰å…³ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¸ä½ åˆ°åº•å‡†å¤‡ç”¨sparkæ¥åšä»€ä¹ˆçš„ç›®çš„æœ‰å…³ã€‚æ˜¯é›†ç¾¤æ§åˆ¶ï¼Œè¿˜æ˜¯æ•°æ®åˆ†æï¼Œè¿˜æ˜¯å»ºæ¨¡ï¼Œæ¥é€‰æ‹©åˆé€‚çš„ç¼–ç¨‹è¯­è¨€ä¸sparkè¿›è¡Œè¿æ¥ç¼–å†™ã€‚","like_count":4,"discussions":[{"author":{"id":1110662,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f2/86/d689f77e.jpg","nickname":"Hank_Yan","note":"","ucode":"86899B561C502B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289633,"discussion_content":"æœ‰é“ç†ï¼Œåƒæˆ‘ä¸»è¦åšæ•°æ®åˆ†æçš„å·¥ä½œï¼Œscalaç›¸å…³çš„åº“æ¯”è¾ƒå°‘ã€‚è¿˜æ˜¯å€¾å‘äºpythonï¼Œå› ä¸ºæœ‰ä¸€äº›åœ¨mræ—¶ä»£çš„ç§¯ç´¯ã€‚ä¸è¿‡scalaè‚¯å®šæ˜¯æ›´æ–°æœ€åŠæ—¶çš„ï¼Œåº”è¯¥ä¹Ÿå¾—æŒæ¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594169467,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":103342,"user_name":"Quincy","can_delete":false,"product_type":"c1","uid":1194412,"ip_address":"","ucode":"FFFBB9FFCB98A4","user_header":"https://static001.geekbang.org/account/avatar/00/12/39/ac/76beadf1.jpg","comment_is_top":false,"comment_ctime":1560417539,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14445319427","product_id":100025301,"comment_content":"Spark ä¸åº”è¯¥æ˜¯é¦–é€‰Scala ä¹ˆ","like_count":3},{"had_liked":false,"id":99628,"user_name":"é’çŸ³","can_delete":false,"product_type":"c1","uid":1215531,"ip_address":"","ucode":"B0056AD6453322","user_header":"https://static001.geekbang.org/account/avatar/00/12/8c/2b/3ab96998.jpg","comment_is_top":false,"comment_ctime":1559269522,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14444171410","product_id":100025301,"comment_content":"#!&#47;usr&#47;bin&#47;python3<br><br>import os<br>from pyspark import SparkContext, SparkConf<br><br><br>os.environ[&#39;SPARK_HOME&#39;] = &#39;&#47;usr&#47;local&#47;spark&#39;<br>os.environ[&#39;HADOOP_HOME&#39;] = &#39;&#47;usr&#47;local&#47;hadoop-2.7.7&#39;<br><br>conf = SparkConf().setAppName(&#39;WordCount&#39;).setMaster(&#39;local&#39;)<br>sc = SparkContext(&#39;local&#39;, &#39;pyspark&#39;, conf=conf)<br><br>text_file = sc.textFile(&#39;file:&#47;&#47;&#47;Users&#47;albert.ming.xu&#47;Downloads&#47;text.txt&#39;)<br><br>counts = text_file.filter(lambda x: len(x.strip()) &gt; 0).flatMap(lambda x: x.split(&#39; &#39;)).map(lambda x: (x, 1)).reduceByKey(lambda x, y: x + y).sortBy(lambda x: x[1], ascending=False)<br><br>print(&#39;|{0: ^20}|{1: ^20}|&#39;.format(&#39;Word&#39;, &#39;Count&#39;))<br>for (word, num) in counts.take(10):<br>    print(&#39;|{0: ^20}|{1: ^20}|&#39;.format(word, num))<br><br>","like_count":3},{"had_liked":false,"id":99105,"user_name":"J Zhang","can_delete":false,"product_type":"c1","uid":1049115,"ip_address":"","ucode":"A64B2E61A8B6A8","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/1b/e1e89267.jpg","comment_is_top":false,"comment_ctime":1559143233,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14444045121","product_id":100025301,"comment_content":"ç”¨javaå†™ æœ‰ç‚¹å†—é•¿  æˆ‘ä¸æ•¢è‹ŸåŒï¼Œå› ä¸ºjava8 å·²ç»æ˜¯å‡½æ•°ç¼–ç¨‹äº†ï¼è€Œä¸”sparkå¼€å‘æˆ‘è§‰å¾—å¤§éƒ¨åˆ†è¿˜æ˜¯spark  sqlå¤šç‚¹ï¼è¿™æ ·åŸºæœ¬æ²¡å•¥åŒºåˆ«  ","like_count":3},{"had_liked":false,"id":98909,"user_name":"è¿™ä¸ªåå­—å±…ç„¶éƒ½æœ‰","can_delete":false,"product_type":"c1","uid":1476984,"ip_address":"","ucode":"8972F5BF888261","user_header":"https://static001.geekbang.org/account/avatar/00/16/89/78/311dbb8b.jpg","comment_is_top":false,"comment_ctime":1559115214,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"14444017102","product_id":100025301,"comment_content":"è€å¸ˆï¼Œä½ ç»™ä¸€ä¸ªå®Œæ•´çš„æ¡ˆä¾‹å§ï¼Œ","like_count":3,"discussions":[{"author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2913,"discussion_content":"https://github.com/xiumuzjq/spark-exercise/tree/master/18/python3","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564037119,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99075,"user_name":"æ–¯ç›–ä¸¸","can_delete":false,"product_type":"c1","uid":1168504,"ip_address":"","ucode":"B881D14B028F14","user_header":"https://static001.geekbang.org/account/avatar/00/11/d4/78/66b3f2a2.jpg","comment_is_top":false,"comment_ctime":1559139605,"is_pvip":false,"replies":[{"id":"42764","content":"SparkSession.read.text()è¯»å–æ–‡ä»¶åç”Ÿæˆçš„DataFrameåªæœ‰ä¸€åˆ—ï¼Œå®ƒçš„é»˜è®¤åå­—å°±æ˜¯â€œvalueâ€ã€‚æˆ‘ä»¬ç”¨lines.valueå»è¯»å–è¿™ä¸€åˆ—ï¼Œæ˜¯åŒæ ·çš„é“ç†ã€‚ä¹‹åæˆ‘ä»¬ç»™æ–°çš„åˆ—é‡å‘½åä¸ºâ€wordâ€ï¼Œæ‰€ä»¥groupByçš„å‚æ•°å˜æˆäº†â€wordâ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"å»¿ä¸ƒ","uid":"1386753","ctime":1563948298,"ip_address":"","comment_id":99075,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10149074197","product_id":100025301,"comment_content":".groupBy(&quot;Value&quot;)è¿™ä¸ªvalueæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1386753,"avatar":"https://static001.geekbang.org/account/avatar/00/15/29/01/20caec2f.jpg","nickname":"Yeon","note":"","ucode":"ED3549F94EB36E","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":451963,"discussion_content":"SparkSession.read.text()è¯»å–æ–‡ä»¶åç”Ÿæˆçš„DataFrameåªæœ‰ä¸€åˆ—ï¼Œå®ƒçš„é»˜è®¤åå­—å°±æ˜¯â€œvalueâ€ã€‚æˆ‘ä»¬ç”¨lines.valueå»è¯»å–è¿™ä¸€åˆ—ï¼Œæ˜¯åŒæ ·çš„é“ç†ã€‚ä¹‹åæˆ‘ä»¬ç»™æ–°çš„åˆ—é‡å‘½åä¸ºâ€wordâ€ï¼Œæ‰€ä»¥groupByçš„å‚æ•°å˜æˆäº†â€wordâ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563948298,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98831,"user_name":"å¤§å¿—","can_delete":false,"product_type":"c1","uid":1039047,"ip_address":"","ucode":"648335930C2E55","user_header":"https://static001.geekbang.org/account/avatar/00/0f/da/c7/66f5fcea.jpg","comment_is_top":false,"comment_ctime":1559101795,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10149036387","product_id":100025301,"comment_content":"è€å¸ˆï¼Œæœ¬åœ°å·²ç»å®‰è£…äº†Sparkï¼Œæœ‰Demoå—ï¼Œåªçœ‹ä»£ç ç‰‡æ®µçš„è¯è¿˜æ˜¯æ— ä»ä¸‹æ‰‹å•Š","like_count":2,"discussions":[{"author":{"id":1058818,"avatar":"https://static001.geekbang.org/account/avatar/00/10/28/02/a6d7ece6.jpg","nickname":"refactor","note":"","ucode":"EC8FF55FE6EC8E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2914,"discussion_content":"https://github.com/xiumuzjq/spark-exercise/tree/master/18/python3","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1564037131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129966,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1567341418,"is_pvip":false,"replies":[{"id":"48471","content":"å—¯ï¼Œè¿™ä½åŒå­¦è¯´çš„å¾ˆå¥½ï¼Œç”¨pip installå®‰è£…pysparkç¡®å®æ–¹ä¾¿ã€‚æˆ‘ä»‹ç»çš„æ–¹æ³•æ¯”è¾ƒæ™®éè¯•ç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567372157,"ip_address":"","comment_id":129966,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5862308714","product_id":100025301,"comment_content":"python ç›´æ¥å®‰è£…<br>pip install pyspark<br>pipå¸®ä½ æå®šä¸€åˆ‡å®‰è£…é…ç½®é—®é¢˜ã€‚<br>å‚è€ƒèµ„æ–™ï¼š<br>https:&#47;&#47;pypi.org&#47;project&#47;pyspark&#47;","like_count":1,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465740,"discussion_content":"å—¯ï¼Œè¿™ä½åŒå­¦è¯´çš„å¾ˆå¥½ï¼Œç”¨pip installå®‰è£…pysparkç¡®å®æ–¹ä¾¿ã€‚æˆ‘ä»‹ç»çš„æ–¹æ³•æ¯”è¾ƒæ™®éè¯•ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567372157,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1127175,"avatar":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","nickname":"JustDoDT","note":"","ucode":"6AF0B80F00EAEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7135,"discussion_content":"pip install pyspark\nLooking in indexes: http://mirrors.aliyun.com/pypi/simple/\nCollecting pyspark\n  Downloading http://mirrors.aliyun.com/pypi/packages/87/21/f05c186f4ddb01d15d0ddc36ef4b7e3cedbeb6412274a41f26b55a650ee5/pyspark-2.4.4.tar.gz (215.7MB)\n     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 215.7MB 959kB/s \nCollecting py4j==0.10.7 (from pyspark)\n  Downloading http://mirrors.aliyun.com/pypi/packages/e3/53/c737818eb9a7dc32a7cd4f1396e787bd94200c3997c72c1dbe028587bd76/py4j-0.10.7-py2.py3-none-any.whl (197kB)\n     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 204kB 1.1MB/s \nBuilding wheels for collected packages: pyspark\n  Building wheel for pyspark (setup.py) ... done\n  Created wheel for pyspark: filename=pyspark-2.4.4-py2.py3-none-any.whl size=216130426 sha256=858f78c54ac8dfed77b01d6670cf5f70e091c173dd39b5684bded524986f6cf9\n  Stored in directory: /Users/cool/Library/Caches/pip/wheels/ed/4f/a4/4d0a0b5d12fcd76fee6b8f572ce005b55ee0f489e2cb898855\nSuccessfully built pyspark\nInstalling collected packages: py4j, pyspark\nSuccessfully installed py4j-0.10.7 pyspark-2.4.4\nåŒ…ä¸å°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567397895,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":98916,"user_name":"Bing","can_delete":false,"product_type":"c1","uid":1059579,"ip_address":"","ucode":"1A9745BBF0CDDB","user_header":"https://static001.geekbang.org/account/avatar/00/10/2a/fb/e2b29825.jpg","comment_is_top":false,"comment_ctime":1559116002,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5854083298","product_id":100025301,"comment_content":"flatMapæ˜¯rddçš„ç®—å­ï¼Œdfä¸èƒ½ç›´æ¥ç”¨ï¼Œå¯ä»¥explodeè¡Œè½¬åˆ—","like_count":1},{"had_liked":false,"id":328328,"user_name":"xxx","can_delete":false,"product_type":"c1","uid":1096652,"ip_address":"","ucode":"E79CEA70430449","user_header":"https://static001.geekbang.org/account/avatar/00/10/bb/cc/fac12364.jpg","comment_is_top":false,"comment_ctime":1640671185,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1640671185","product_id":100025301,"comment_content":"æ–‡ä¸­çš„ç¤ºä¾‹æ˜¯å¯ä»¥è¿è¡Œçš„ï¼Œç¨å¾®æ”¹æ”¹ï¼š<br><br>from pyspark.sql import SparkSession<br>from pyspark.sql.functions import *<br><br>if __name__ == &quot;__main__&quot;:<br>    spark = SparkSession.builder.appName(&#39;WordCount&#39;).getOrCreate()<br>    lines = spark.read.text(&quot;wikiOfSpark.txt&quot;)<br>    wordCounts = lines.select(explode(split(lines.value, &quot; &quot;)).alias(&quot;word&quot;)).groupBy(&quot;word&quot;).count().sort(desc(&quot;count&quot;))<br>    wordCounts.show()<br><br>    spark.stop()","like_count":1},{"had_liked":false,"id":285562,"user_name":"stars","can_delete":false,"product_type":"c1","uid":1055100,"ip_address":"","ucode":"8A75D9E1909729","user_header":"https://static001.geekbang.org/account/avatar/00/10/19/7c/25abe455.jpg","comment_is_top":false,"comment_ctime":1616899202,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1616899202","product_id":100025301,"comment_content":"å‰é¢è¿˜å¥½ï¼Œåˆ°è¿™é‡Œçœ‹ä¸æ‡‚äº†ï¼Œç¯å¢ƒæ­å»ºå®Œæˆï¼Œä»£ç æ€ä¹ˆæ‰§è¡Œï¼Œå®Œå…¨èµ°ä¸ä¸‹å»ï¼Œæ˜¯ä¸æ˜¯ç®€å•è¯´ä¸€ä¸‹","like_count":0},{"had_liked":false,"id":278294,"user_name":"é»‘é»‘ç™½","can_delete":false,"product_type":"c1","uid":1177260,"ip_address":"","ucode":"42DC6725B03F53","user_header":"https://static001.geekbang.org/account/avatar/00/11/f6/ac/a7da8788.jpg","comment_is_top":false,"comment_ctime":1612859728,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612859728","product_id":100025301,"comment_content":"from operator import add<br><br>from pyspark.sql import SparkSession<br><br>if __name__ == &quot;__main__&quot;:<br>    spark = SparkSession.builder.appName(&quot;rdd&quot;)\\<br>        .config(&quot;spark.driver.bindAddress&quot;, &quot;127.0.0.1&quot;)\\<br>        .getOrCreate()<br>    lines = spark.read.text(&quot;file:&#47;&#47;&#47;mnt&#47;d&#47;playground&#47;bigdata&#47;spark001&#47;sample.txt&quot;)\\<br>        .rdd.map(lambda r: r[0])<br>    counts = lines.flatMap(lambda x: x.split(&#39; &#39;)).map(lambda x: (x, 1)).reduceByKey(add)<br>    output = counts.collect()<br><br>    for (word, count) in output:<br>        print(&quot;%s: %i&quot; % (word, count))<br>    spark.stop()","like_count":0},{"had_liked":false,"id":265112,"user_name":"whatever","can_delete":false,"product_type":"c1","uid":2271248,"ip_address":"","ucode":"D6A8BB06AB6731","user_header":"https://static001.geekbang.org/account/avatar/00/22/a8/10/ee8b8c0b.jpg","comment_is_top":false,"comment_ctime":1606785127,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1606785127","product_id":100025301,"comment_content":"ç»™æ‰€æœ‰å°ç™½åˆ°æˆ‘è¿™ä¸ªç¨‹åº¦è¸©äº†åˆçº§å‘çš„äººï¼š<br><br>å¦‚æœè¿è¡ŒpysparkæŠ¥é”™ ERROR SparkContext: Error initializing SparkContextï¼Œè¯´æ˜éœ€è¦ä¿®æ”¹ä¸»æœºå<br>vim ~&#47;.bash_profile<br>æ·»åŠ <br>export SPARK_LOCAL_HOSTNAME=localhost<br>ç¼–è¾‘å®Œåé‡æ–°åŠ è½½ï¼Œæ‰§è¡Œ<br>source ~&#47;.bash_profile<br>å†è¿è¡Œpysparkè¯•è¯•","like_count":0},{"had_liked":false,"id":193680,"user_name":"å¨„æ±Ÿå›½","can_delete":false,"product_type":"c1","uid":1018479,"ip_address":"","ucode":"6C2AAE4E409286","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8a/6f/3d4f7e31.jpg","comment_is_top":false,"comment_ctime":1584947933,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584947933","product_id":100025301,"comment_content":"åœ¨pysparkä¸­æ‰§è¡Œçš„ç¨‹åºï¼Œä¸ºä»€ä¹ˆåœ¨sparkçš„ç®¡æ§å°ä¸Šï¼Œçœ‹ä¸åˆ°å¯¹åº”çš„Applicationå‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":187339,"user_name":"åˆ˜æ¶¦æ£®","can_delete":false,"product_type":"c1","uid":1236556,"ip_address":"","ucode":"84101C670A6747","user_header":"https://static001.geekbang.org/account/avatar/00/12/de/4c/a51ece16.jpg","comment_is_top":false,"comment_ctime":1584087613,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584087613","product_id":100025301,"comment_content":"æˆ‘åœ¨centosæ­å»ºSparké›†ç¾¤ï¼Œæ€ä¹ˆç”¨Pysparkåœ¨windowè¿æ¥sparké›†ç¾¤","like_count":0},{"had_liked":false,"id":130185,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1567398773,"is_pvip":false,"replies":[{"id":"48577","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"Xinyue Li","uid":"1502409","ctime":1567411628,"ip_address":"","comment_id":130185,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567398773","product_id":100025301,"comment_content":"å®è·µæˆåŠŸ<br>demo.txt:<br>I hava a dog<br>He has a Dog<br>RDDå†™æ³•ï¼š<br>[(&#39;I&#39;, 1), (&#39;hava&#39;, 1), (&#39;a&#39;, 2), (&#39;dog&#39;, 1), (&#39;He&#39;, 1), (&#39;has&#39;, 1), (&#39;Dog&#39;, 1)]<br>[(&#39;a&#39;, 2), (&#39;I&#39;, 1), (&#39;hava&#39;, 1), (&#39;dog&#39;, 1), (&#39;He&#39;, 1), (&#39;has&#39;, 1), (&#39;Dog&#39;, 1)]<br>DFå†™æ³•ï¼š<br>[Row(word=&#39;dog&#39;, count=1), Row(word=&#39;He&#39;, count=1), Row(word=&#39;Dog&#39;, count=1), Row(word=&#39;I&#39;, count=1), Row(word=&#39;a&#39;, count=2), Row(word=&#39;hava&#39;, count=1), Row(word=&#39;has&#39;, count=1)]<br>[Row(word=&#39;a&#39;, count=2), Row(word=&#39;I&#39;, count=1), Row(word=&#39;Dog&#39;, count=1), Row(word=&#39;hava&#39;, count=1), Row(word=&#39;dog&#39;, count=1), Row(word=&#39;has&#39;, count=1), Row(word=&#39;He&#39;, count=1)]<br><br>ä»å¯åŠ¨åˆ°å‡ºç»“æœï¼ŒDFå†™æ³•é€Ÿåº¦è¦æ¯”rddæ…¢ã€‚","like_count":0,"discussions":[{"author":{"id":1502409,"avatar":"https://static001.geekbang.org/account/avatar/00/16/ec/c9/45bfcba3.jpg","nickname":"Xinyue Li","note":"","ucode":"0CB92610C8B9FC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465847,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567411628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":1}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119533,"user_name":"è¥¿åŒ—ååŒ—","can_delete":false,"product_type":"c1","uid":1043160,"ip_address":"","ucode":"64BD69C84EE6A1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erdpKbFgRLnicjsr6qkrPVKZcFrG3aS2V51HhjFP6Mh2CYcjWric9ud1Qiclo8A49ia3eZ1NhibDib0AOCg/132","comment_is_top":false,"comment_ctime":1564623070,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564623070","product_id":100025301,"comment_content":"å¯¹äºè¯é¢‘ç»Ÿè®¡çš„åœºæ™¯ï¼Œé™¤äº†ç”¨map reduceçš„æ–¹å¼ï¼Œå¯¹åº”åˆ°sqlå°±æ˜¯group byï¼ŒåŸºäºæ¯ä¸ªå•è¯åˆ†ç»„ç„¶åç»Ÿè®¡æ¯ä¸ªåˆ†ç»„çš„å¤§å°","like_count":0},{"had_liked":false,"id":108504,"user_name":"Qi Liu åˆ˜ç¥º","can_delete":false,"product_type":"c1","uid":1235615,"ip_address":"","ucode":"F93B7A8CAB2DCE","user_header":"https://static001.geekbang.org/account/avatar/00/12/da/9f/460284b9.jpg","comment_is_top":false,"comment_ctime":1561788048,"is_pvip":false,"replies":[{"id":"40733","content":"åŠ æ²¹â›½ï¸","user_name":"ä½œè€…å›å¤","user_name_real":"å”±å”±","uid":"1386753","ctime":1562670180,"ip_address":"","comment_id":108504,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1561788048","product_id":100025301,"comment_content":"ç»§ç»­å­¦ä¹ ~","like_count":0,"discussions":[{"author":{"id":1386753,"avatar":"https://static001.geekbang.org/account/avatar/00/15/29/01/20caec2f.jpg","nickname":"Yeon","note":"","ucode":"ED3549F94EB36E","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":456012,"discussion_content":"åŠ æ²¹â›½ï¸","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562670180,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":99127,"user_name":"hua168","can_delete":false,"product_type":"c1","uid":1065255,"ip_address":"","ucode":"CFF9A7E86EBA48","user_header":"https://static001.geekbang.org/account/avatar/00/10/41/27/3ff1a1d6.jpg","comment_is_top":false,"comment_ctime":1559147454,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559147454","product_id":100025301,"comment_content":"è€å¸ˆæˆ‘æƒ³é—®ä¸€ä¸‹ï¼Œå¦‚æœå¤§æ•°æ®å­¦ä¹ ç”¨pythonã€javaã€è¿˜æ˜¯Scalaï¼Ÿ<br>pythonè™½ç„¶ä»£ç å°‘ï¼Œä½†ä¸æ˜¯è¯´æ€§èƒ½ä¸Šï¼Œè¿è¡Œé€Ÿåº¦ä¸Šä¸åŠjavaå’Œgoå—ï¼Ÿ","like_count":0},{"had_liked":false,"id":98917,"user_name":"fresh","can_delete":false,"product_type":"c1","uid":1075101,"ip_address":"","ucode":"9FA6DCFC44DBE1","user_header":"https://static001.geekbang.org/account/avatar/00/10/67/9d/25650474.jpg","comment_is_top":false,"comment_ctime":1559116057,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1559116057","product_id":100025301,"comment_content":"èƒ½ç”¨java å†™ä»£ç å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":98900,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1559114508,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1559114508","product_id":100025301,"comment_content":"ç¯å¢ƒæ­å¥½äº†ï¼Œä¸‹ä¸€æ­¥ä¸çŸ¥é“æ€ä¹ˆæ“ä½œäº†ã€‚","like_count":0,"discussions":[{"author":{"id":1524861,"avatar":"https://static001.geekbang.org/account/avatar/00/17/44/7d/0ad53639.jpg","nickname":"stone","note":"","ucode":"B8A268EB1CD5CA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445,"discussion_content":"me 2, ä¸è¿‡ä½œä¸ºä¸€ä¸ªæå‰ç«¯çš„ï¼Œæœ¬æ¥ä¹Ÿæ˜¯æ¥ç†Ÿæ‚‰ä¸‹æ¦‚å¿µçš„ ï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1561560758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}