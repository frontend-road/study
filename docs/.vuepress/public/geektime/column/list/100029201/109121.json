{"id":109121,"title":"21 | Java æ¶ˆè´¹è€…æ˜¯å¦‚ä½•ç®¡ç†TCPè¿æ¥çš„?","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯èƒ¡å¤•ã€‚ä»Šå¤©æˆ‘è¦å’Œä½ åˆ†äº«çš„ä¸»é¢˜æ˜¯ï¼šKafkaçš„Javaæ¶ˆè´¹è€…æ˜¯å¦‚ä½•ç®¡ç†TCPè¿æ¥çš„ã€‚</p><p>åœ¨ä¸“æ <a href=\"https://time.geekbang.org/column/article/103844\">ç¬¬13è®²</a>ä¸­ï¼Œæˆ‘ä»¬ä¸“é—¨èŠè¿‡â€œJava<strong>ç”Ÿäº§è€…</strong>æ˜¯å¦‚ä½•ç®¡ç†TCPè¿æ¥èµ„æºçš„â€è¿™ä¸ªè¯é¢˜ï¼Œä½ åº”è¯¥è¿˜æœ‰å°è±¡å§ï¼Ÿä»Šå¤©ç®—æ˜¯å®ƒçš„å§Šå¦¹ç¯‡ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥ç ”ç©¶ä¸‹Kafkaçš„Java<strong>æ¶ˆè´¹è€…</strong>ç®¡ç†TCPæˆ–Socketèµ„æºçš„æœºåˆ¶ã€‚åªæœ‰å®Œæˆäº†ä»Šå¤©çš„è®¨è®ºï¼Œæˆ‘ä»¬æ‰ç®—æ˜¯å¯¹Kafkaå®¢æˆ·ç«¯çš„TCPè¿æ¥ç®¡ç†æœºåˆ¶æœ‰äº†å…¨é¢çš„äº†è§£ã€‚</p><p>å’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»Šå¤©ä¼šæ— å·®åˆ«åœ°æ··ç”¨TCPå’ŒSocketä¸¤ä¸ªæœ¯è¯­ã€‚æ¯•ç«Ÿï¼Œåœ¨Kafkaçš„ä¸–ç•Œä¸­ï¼Œæ— è®ºæ˜¯ServerSocketï¼Œè¿˜æ˜¯SocketChannelï¼Œå®ƒä»¬å®ç°çš„éƒ½æ˜¯TCPåè®®ã€‚æˆ–è€…è¿™ä¹ˆè¯´ï¼ŒKafkaçš„ç½‘ç»œä¼ è¾“æ˜¯åŸºäºTCPåè®®çš„ï¼Œè€Œä¸æ˜¯åŸºäºUDPåè®®ï¼Œå› æ­¤ï¼Œå½“æˆ‘ä»Šå¤©è¯´åˆ°TCPè¿æ¥æˆ–Socketèµ„æºæ—¶ï¼Œæˆ‘æŒ‡çš„æ˜¯åŒä¸€ä¸ªä¸œè¥¿ã€‚</p><h2>ä½•æ—¶åˆ›å»ºTCPè¿æ¥ï¼Ÿ</h2><p>æˆ‘ä»¬å…ˆä»æ¶ˆè´¹è€…åˆ›å»ºTCPè¿æ¥å¼€å§‹è®¨è®ºã€‚æ¶ˆè´¹è€…ç«¯ä¸»è¦çš„ç¨‹åºå…¥å£æ˜¯KafkaConsumerç±»ã€‚<strong>å’Œç”Ÿäº§è€…ä¸åŒçš„æ˜¯ï¼Œæ„å»ºKafkaConsumerå®ä¾‹æ—¶æ˜¯ä¸ä¼šåˆ›å»ºä»»ä½•TCPè¿æ¥çš„</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä½ æ‰§è¡Œå®Œnew KafkaConsumer(properties)è¯­å¥åï¼Œä½ ä¼šå‘ç°ï¼Œæ²¡æœ‰Socketè¿æ¥è¢«åˆ›å»ºå‡ºæ¥ã€‚è¿™ä¸€ç‚¹å’ŒJavaç”Ÿäº§è€…æ˜¯æœ‰åŒºåˆ«çš„ï¼Œä¸»è¦åŸå› å°±æ˜¯ç”Ÿäº§è€…å…¥å£ç±»KafkaProduceråœ¨æ„å»ºå®ä¾‹çš„æ—¶å€™ï¼Œä¼šåœ¨åå°é»˜é»˜åœ°å¯åŠ¨ä¸€ä¸ªSenderçº¿ç¨‹ï¼Œè¿™ä¸ªSenderçº¿ç¨‹è´Ÿè´£Socketè¿æ¥çš„åˆ›å»ºã€‚</p><!-- [[[read_end]]] --><p>ä»è¿™ä¸€ç‚¹ä¸Šæ¥çœ‹ï¼Œæˆ‘ä¸ªäººè®¤ä¸ºKafkaConsumerçš„è®¾è®¡æ¯”KafkaProducerè¦å¥½ã€‚å°±åƒæˆ‘åœ¨ç¬¬13è®²ä¸­æ‰€è¯´çš„ï¼Œåœ¨Javaæ„é€ å‡½æ•°ä¸­å¯åŠ¨çº¿ç¨‹ï¼Œä¼šé€ æˆthisæŒ‡é’ˆçš„é€ƒé€¸ï¼Œè¿™å§‹ç»ˆæ˜¯ä¸€ä¸ªéšæ‚£ã€‚</p><p>å¦‚æœSocketä¸æ˜¯åœ¨æ„é€ å‡½æ•°ä¸­åˆ›å»ºçš„ï¼Œé‚£ä¹ˆæ˜¯åœ¨KafkaConsumer.subscribeæˆ–KafkaConsumer.assignæ–¹æ³•ä¸­åˆ›å»ºçš„å—ï¼Ÿä¸¥æ ¼æ¥è¯´ä¹Ÿä¸æ˜¯ã€‚æˆ‘è¿˜æ˜¯ç›´æ¥ç»™å‡ºç­”æ¡ˆå§ï¼š<strong>TCPè¿æ¥æ˜¯åœ¨è°ƒç”¨KafkaConsumer.pollæ–¹æ³•æ—¶è¢«åˆ›å»ºçš„</strong>ã€‚å†ç»†ç²’åº¦åœ°è¯´ï¼Œåœ¨pollæ–¹æ³•å†…éƒ¨æœ‰3ä¸ªæ—¶æœºå¯ä»¥åˆ›å»ºTCPè¿æ¥ã€‚</p><p>1.<strong>å‘èµ·FindCoordinatorè¯·æ±‚æ—¶</strong>ã€‚</p><p>è¿˜è®°å¾—æ¶ˆè´¹è€…ç«¯æœ‰ä¸ªç»„ä»¶å«åè°ƒè€…ï¼ˆCoordinatorï¼‰å—ï¼Ÿå®ƒé©»ç•™åœ¨Brokerç«¯çš„å†…å­˜ä¸­ï¼Œè´Ÿè´£æ¶ˆè´¹è€…ç»„çš„ç»„æˆå‘˜ç®¡ç†å’Œå„ä¸ªæ¶ˆè´¹è€…çš„ä½ç§»æäº¤ç®¡ç†ã€‚å½“æ¶ˆè´¹è€…ç¨‹åºé¦–æ¬¡å¯åŠ¨è°ƒç”¨pollæ–¹æ³•æ—¶ï¼Œå®ƒéœ€è¦å‘Kafkaé›†ç¾¤å‘é€ä¸€ä¸ªåä¸ºFindCoordinatorçš„è¯·æ±‚ï¼Œå¸Œæœ›Kafkaé›†ç¾¤å‘Šè¯‰å®ƒå“ªä¸ªBrokeræ˜¯ç®¡ç†å®ƒçš„åè°ƒè€…ã€‚</p><p>ä¸è¿‡ï¼Œæ¶ˆè´¹è€…åº”è¯¥å‘å“ªä¸ªBrokerå‘é€è¿™ç±»è¯·æ±‚å‘¢ï¼Ÿç†è®ºä¸Šä»»ä½•ä¸€ä¸ªBrokeréƒ½èƒ½å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´æ¶ˆè´¹è€…å¯ä»¥å‘é€FindCoordinatorè¯·æ±‚ç»™é›†ç¾¤ä¸­çš„ä»»æ„æœåŠ¡å™¨ã€‚åœ¨è¿™ä¸ªé—®é¢˜ä¸Šï¼Œç¤¾åŒºåšäº†ä¸€ç‚¹ç‚¹ä¼˜åŒ–ï¼šæ¶ˆè´¹è€…ç¨‹åºä¼šå‘é›†ç¾¤ä¸­å½“å‰è´Ÿè½½æœ€å°çš„é‚£å°Brokerå‘é€è¯·æ±‚ã€‚è´Ÿè½½æ˜¯å¦‚ä½•è¯„ä¼°çš„å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯çœ‹æ¶ˆè´¹è€…è¿æ¥çš„æ‰€æœ‰Brokerä¸­ï¼Œè°çš„å¾…å‘é€è¯·æ±‚æœ€å°‘ã€‚å½“ç„¶äº†ï¼Œè¿™ç§è¯„ä¼°æ˜¾ç„¶æ˜¯æ¶ˆè´¹è€…ç«¯çš„å•å‘è¯„ä¼°ï¼Œå¹¶éæ˜¯ç«™åœ¨å…¨å±€è§’åº¦ï¼Œå› æ­¤æœ‰çš„æ—¶å€™ä¹Ÿä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£ã€‚ä¸è¿‡è¿™ä¸å¹¶å½±å“æˆ‘ä»¬çš„è®¨è®ºã€‚æ€»ä¹‹ï¼Œåœ¨è¿™ä¸€æ­¥ï¼Œæ¶ˆè´¹è€…ä¼šåˆ›å»ºä¸€ä¸ªSocketè¿æ¥ã€‚</p><p>2.<strong>è¿æ¥åè°ƒè€…æ—¶ã€‚</strong></p><p>Brokerå¤„ç†å®Œä¸Šä¸€æ­¥å‘é€çš„FindCoordinatorè¯·æ±‚ä¹‹åï¼Œä¼šè¿”è¿˜å¯¹åº”çš„å“åº”ç»“æœï¼ˆResponseï¼‰ï¼Œæ˜¾å¼åœ°å‘Šè¯‰æ¶ˆè´¹è€…å“ªä¸ªBrokeræ˜¯çœŸæ­£çš„åè°ƒè€…ï¼Œå› æ­¤åœ¨è¿™ä¸€æ­¥ï¼Œæ¶ˆè´¹è€…çŸ¥æ™“äº†çœŸæ­£çš„åè°ƒè€…åï¼Œä¼šåˆ›å»ºè¿å‘è¯¥Brokerçš„Socketè¿æ¥ã€‚åªæœ‰æˆåŠŸè¿å…¥åè°ƒè€…ï¼Œåè°ƒè€…æ‰èƒ½å¼€å¯æ­£å¸¸çš„ç»„åè°ƒæ“ä½œï¼Œæ¯”å¦‚åŠ å…¥ç»„ã€ç­‰å¾…ç»„åˆ†é…æ–¹æ¡ˆã€å¿ƒè·³è¯·æ±‚å¤„ç†ã€ä½ç§»è·å–ã€ä½ç§»æäº¤ç­‰ã€‚</p><p>3.<strong>æ¶ˆè´¹æ•°æ®æ—¶ã€‚</strong></p><p>æ¶ˆè´¹è€…ä¼šä¸ºæ¯ä¸ªè¦æ¶ˆè´¹çš„åˆ†åŒºåˆ›å»ºä¸è¯¥åˆ†åŒºé¢†å¯¼è€…å‰¯æœ¬æ‰€åœ¨Brokerè¿æ¥çš„TCPã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æ¶ˆè´¹è€…è¦æ¶ˆè´¹5ä¸ªåˆ†åŒºçš„æ•°æ®ï¼Œè¿™5ä¸ªåˆ†åŒºå„è‡ªçš„é¢†å¯¼è€…å‰¯æœ¬åˆ†å¸ƒåœ¨4å°Brokerä¸Šï¼Œé‚£ä¹ˆè¯¥æ¶ˆè´¹è€…åœ¨æ¶ˆè´¹æ—¶ä¼šåˆ›å»ºä¸è¿™4å°Brokerçš„Socketè¿æ¥ã€‚</p><h2>åˆ›å»ºå¤šå°‘ä¸ªTCPè¿æ¥ï¼Ÿ</h2><p>ä¸‹é¢æˆ‘ä»¬æ¥è¯´è¯´æ¶ˆè´¹è€…åˆ›å»ºTCPè¿æ¥çš„æ•°é‡ã€‚ä½ å¯ä»¥å…ˆæ€è€ƒä¸€ä¸‹å¤§è‡´éœ€è¦çš„è¿æ¥æ•°é‡ï¼Œç„¶åæˆ‘ä»¬ç»“åˆå…·ä½“çš„Kafkaæ—¥å¿—ï¼Œæ¥éªŒè¯ä¸‹ç»“æœæ˜¯å¦å’Œä½ æƒ³çš„ä¸€è‡´ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹è¿™æ®µæ—¥å¿—ã€‚</p><blockquote>\n<p><em>[2019-05-27 10:00:54,142] DEBUG [Consumer clientId=consumer-1, groupId=test] Initiating connection to node <span class=\"orange\">localhost:9092</span> (id: -1 rack: null) using address localhost/127.0.0.1 (org.apache.kafka.clients.NetworkClient:944)</em></p>\n</blockquote><blockquote>\n<p><em>......</em></p>\n</blockquote><blockquote>\n<p><em>[2019-05-27 10:00:54,188] DEBUG [Consumer clientId=consumer-1, groupId=test] <span class=\"orange\">Sending metadata request</span>  MetadataRequestData(topics=[MetadataRequestTopic(name='t4')], allowAutoTopicCreation=true, includeClusterAuthorizedOperations=false, includeTopicAuthorizedOperations=false) to node <span class=\"orange\">localhost:9092</span> (id: -1 rack: null) (org.apache.kafka.clients.NetworkClient:1097)</em></p>\n</blockquote><blockquote>\n<p><em>......</em></p>\n</blockquote><blockquote>\n<p><em>[2019-05-27 10:00:54,188] TRACE [Consumer clientId=consumer-1, groupId=test] <span class=\"orange\">Sending FIND_COORDINATOR</span> {key=test,key_type=0} with correlation id 0 to node -1 (org.apache.kafka.clients.NetworkClient:496)</em></p>\n</blockquote><blockquote>\n<p><em>[2019-05-27 10:00:54,203] TRACE [Consumer clientId=consumer-1, groupId=test] Completed receive from node -1 for FIND_COORDINATOR with correlation id 0, received {throttle_time_ms=0,error_code=0,error_message=null, <span class=\"orange\">node_id=2,host=localhost,port=9094</span>} (org.apache.kafka.clients.NetworkClient:837)</em></p>\n</blockquote><blockquote>\n<p><em>......</em></p>\n</blockquote><blockquote>\n<p><em>[2019-05-27 10:00:54,204] DEBUG [Consumer clientId=consumer-1, groupId=test] Initiating connection to node <span class=\"orange\">localhost:9094</span> (id: 2147483645 rack: null) using address localhost/127.0.0.1 (org.apache.kafka.clients.NetworkClient:944)</em></p>\n</blockquote><blockquote>\n<p><em>......</em></p>\n</blockquote><blockquote>\n<p><em>[2019-05-27 10:00:54,237] DEBUG [Consumer clientId=consumer-1, groupId=test] Initiating connection to node <span class=\"orange\">localhost:9094</span> (id: 2 rack: null) using address localhost/127.0.0.1 (org.apache.kafka.clients.NetworkClient:944)</em></p>\n</blockquote><blockquote>\n<p><em>[2019-05-27 10:00:54,237] DEBUG [Consumer clientId=consumer-1, groupId=test] Initiating connection to node<span class=\"orange\"> localhost:9092</span> (id: 0 rack: null) using address localhost/127.0.0.1 (org.apache.kafka.clients.NetworkClient:944)</em></p>\n</blockquote><blockquote>\n<p><em>[2019-05-27 10:00:54,238] DEBUG [Consumer clientId=consumer-1, groupId=test] Initiating connection to node <span class=\"orange\">localhost:9093</span> (id: 1 rack: null) using address localhost/127.0.0.1 (org.apache.kafka.clients.NetworkClient:944)</em></p>\n</blockquote><p>è¿™é‡Œæˆ‘ç¨å¾®è§£é‡Šä¸€ä¸‹ï¼Œæ—¥å¿—çš„ç¬¬ä¸€è¡Œæ˜¯æ¶ˆè´¹è€…ç¨‹åºåˆ›å»ºçš„ç¬¬ä¸€ä¸ªTCPè¿æ¥ï¼Œå°±åƒæˆ‘ä»¬å‰é¢è¯´çš„ï¼Œè¿™ä¸ªSocketç”¨äºå‘é€FindCoordinatorè¯·æ±‚ã€‚ç”±äºè¿™æ˜¯æ¶ˆè´¹è€…ç¨‹åºåˆ›å»ºçš„ç¬¬ä¸€ä¸ªè¿æ¥ï¼Œæ­¤æ—¶æ¶ˆè´¹è€…å¯¹äºè¦è¿æ¥çš„Kafkaé›†ç¾¤ä¸€æ— æ‰€çŸ¥ï¼Œå› æ­¤å®ƒè¿æ¥çš„BrokerèŠ‚ç‚¹çš„IDæ˜¯-1ï¼Œè¡¨ç¤ºæ¶ˆè´¹è€…æ ¹æœ¬ä¸çŸ¥é“è¦è¿æ¥çš„Kafka Brokerçš„ä»»ä½•ä¿¡æ¯ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯æ—¥å¿—çš„ç¬¬äºŒè¡Œï¼Œæ¶ˆè´¹è€…å¤ç”¨äº†åˆšæ‰åˆ›å»ºçš„é‚£ä¸ªSocketè¿æ¥ï¼Œå‘Kafkaé›†ç¾¤å‘é€å…ƒæ•°æ®è¯·æ±‚ä»¥è·å–æ•´ä¸ªé›†ç¾¤çš„ä¿¡æ¯ã€‚</p><p>æ—¥å¿—çš„ç¬¬ä¸‰è¡Œè¡¨æ˜ï¼Œæ¶ˆè´¹è€…ç¨‹åºå¼€å§‹å‘é€FindCoordinatorè¯·æ±‚ç»™ç¬¬ä¸€æ­¥ä¸­è¿æ¥çš„Brokerï¼Œå³localhost:9092ï¼Œä¹Ÿå°±æ˜¯nodeIdç­‰äº-1çš„é‚£ä¸ªã€‚åœ¨åå‡ æ¯«ç§’ä¹‹åï¼Œæ¶ˆè´¹è€…ç¨‹åºæˆåŠŸåœ°è·æ‚‰åè°ƒè€…æ‰€åœ¨çš„Brokerä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ç¬¬å››è¡Œæ ‡ä¸ºæ©™è‰²çš„â€œnode_id = 2â€ã€‚</p><p>å®Œæˆè¿™äº›ä¹‹åï¼Œæ¶ˆè´¹è€…å°±å·²ç»çŸ¥é“åè°ƒè€…Brokerçš„è¿æ¥ä¿¡æ¯äº†ï¼Œå› æ­¤åœ¨æ—¥å¿—çš„ç¬¬äº”è¡Œå‘èµ·äº†ç¬¬äºŒä¸ªSocketè¿æ¥ï¼Œåˆ›å»ºäº†è¿å‘localhost:9094çš„TCPã€‚åªæœ‰è¿æ¥äº†åè°ƒè€…ï¼Œæ¶ˆè´¹è€…è¿›ç¨‹æ‰èƒ½æ­£å¸¸åœ°å¼€å¯æ¶ˆè´¹è€…ç»„çš„å„ç§åŠŸèƒ½ä»¥åŠåç»­çš„æ¶ˆæ¯æ¶ˆè´¹ã€‚</p><p>åœ¨æ—¥å¿—çš„æœ€åä¸‰è¡Œä¸­ï¼Œæ¶ˆè´¹è€…åˆåˆ†åˆ«åˆ›å»ºäº†æ–°çš„TCPè¿æ¥ï¼Œä¸»è¦ç”¨äºå®é™…çš„æ¶ˆæ¯è·å–ã€‚è¿˜è®°å¾—æˆ‘åˆšæ‰è¯´çš„å—ï¼Ÿè¦æ¶ˆè´¹çš„åˆ†åŒºçš„é¢†å¯¼è€…å‰¯æœ¬åœ¨å“ªå°Brokerä¸Šï¼Œæ¶ˆè´¹è€…å°±è¦åˆ›å»ºè¿å‘å“ªå°Brokerçš„TCPã€‚åœ¨æˆ‘ä¸¾çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œlocalhost:9092ï¼Œlocalhost:9093å’Œlocalhost:9094è¿™3å°Brokerä¸Šéƒ½æœ‰è¦æ¶ˆè´¹çš„åˆ†åŒºï¼Œå› æ­¤æ¶ˆè´¹è€…åˆ›å»ºäº†3ä¸ªTCPè¿æ¥ã€‚</p><p>çœ‹å®Œè¿™æ®µæ—¥å¿—ï¼Œä½ åº”è¯¥ä¼šå‘ç°æ—¥å¿—ä¸­çš„è¿™äº›BrokerèŠ‚ç‚¹çš„IDåœ¨ä¸æ–­å˜åŒ–ã€‚æœ‰æ—¶å€™æ˜¯-1ï¼Œæœ‰æ—¶å€™æ˜¯2147483645ï¼Œåªæœ‰åœ¨æœ€åçš„æ—¶å€™æ‰å›å½’æ­£å¸¸å€¼0ã€1å’Œ2ã€‚è¿™åˆæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>å‰é¢æˆ‘ä»¬è¯´è¿‡äº†-1çš„æ¥ç”±ï¼Œå³æ¶ˆè´¹è€…ç¨‹åºï¼ˆå…¶å®ä¹Ÿä¸å…‰æ˜¯æ¶ˆè´¹è€…ï¼Œç”Ÿäº§è€…ä¹Ÿæ˜¯è¿™æ ·çš„æœºåˆ¶ï¼‰é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œå¯¹Kafkaé›†ç¾¤ä¸€æ— æ‰€çŸ¥ï¼Œå› æ­¤ç”¨-1æ¥è¡¨ç¤ºå°šæœªè·å–åˆ°Brokeræ•°æ®ã€‚</p><p>é‚£ä¹ˆ2147483645æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿå®ƒæ˜¯<strong>ç”±Integer.MAX_VALUEå‡å»åè°ƒè€…æ‰€åœ¨Brokerçš„çœŸå®IDè®¡ç®—å¾—æ¥çš„</strong>ã€‚çœ‹ç¬¬å››è¡Œæ ‡ä¸ºæ©™è‰²çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“åè°ƒè€…IDæ˜¯2ï¼Œå› æ­¤è¿™ä¸ªSocketè¿æ¥çš„èŠ‚ç‚¹IDå°±æ˜¯Integer.MAX_VALUEå‡å»2ï¼Œå³2147483647å‡å»2ï¼Œä¹Ÿå°±æ˜¯2147483645ã€‚è¿™ç§èŠ‚ç‚¹IDçš„æ ‡è®°æ–¹å¼æ˜¯Kafkaç¤¾åŒºç‰¹æ„ä¸ºä¹‹çš„ç»“æœï¼Œç›®çš„å°±æ˜¯è¦è®©ç»„åè°ƒè¯·æ±‚å’ŒçœŸæ­£çš„æ•°æ®è·å–è¯·æ±‚ä½¿ç”¨ä¸åŒçš„Socketè¿æ¥ã€‚</p><p>è‡³äºåé¢çš„0ã€1ã€2ï¼Œé‚£å°±å¾ˆå¥½è§£é‡Šäº†ã€‚å®ƒä»¬è¡¨å¾äº†çœŸå®çš„Broker IDï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨server.propertiesä¸­é…ç½®çš„broker.idå€¼ã€‚</p><p>æˆ‘ä»¬æ¥ç®€å•æ€»ç»“ä¸€ä¸‹ä¸Šé¢çš„å†…å®¹ã€‚é€šå¸¸æ¥è¯´ï¼Œæ¶ˆè´¹è€…ç¨‹åºä¼šåˆ›å»º3ç±»TCPè¿æ¥ï¼š</p><ol>\n<li>ç¡®å®šåè°ƒè€…å’Œè·å–é›†ç¾¤å…ƒæ•°æ®ã€‚</li>\n<li>è¿æ¥åè°ƒè€…ï¼Œä»¤å…¶æ‰§è¡Œç»„æˆå‘˜ç®¡ç†æ“ä½œã€‚</li>\n<li>æ‰§è¡Œå®é™…çš„æ¶ˆæ¯è·å–ã€‚</li>\n</ol><p>é‚£ä¹ˆï¼Œè¿™ä¸‰ç±»TCPè¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸéƒ½æ˜¯ç›¸åŒçš„å—ï¼Ÿæ¢å¥è¯è¯´ï¼Œè¿™äº›TCPè¿æ¥æ˜¯ä½•æ—¶è¢«å…³é—­çš„å‘¢ï¼Ÿ</p><h2>ä½•æ—¶å…³é—­TCPè¿æ¥ï¼Ÿ</h2><p>å’Œç”Ÿäº§è€…ç±»ä¼¼ï¼Œæ¶ˆè´¹è€…å…³é—­Socketä¹Ÿåˆ†ä¸ºä¸»åŠ¨å…³é—­å’ŒKafkaè‡ªåŠ¨å…³é—­ã€‚ä¸»åŠ¨å…³é—­æ˜¯æŒ‡ä½ æ˜¾å¼åœ°è°ƒç”¨æ¶ˆè´¹è€…APIçš„æ–¹æ³•å»å…³é—­æ¶ˆè´¹è€…ï¼Œå…·ä½“æ–¹å¼å°±æ˜¯<strong>æ‰‹åŠ¨è°ƒç”¨KafkaConsumer.close()æ–¹æ³•ï¼Œæˆ–è€…æ˜¯æ‰§è¡ŒKillå‘½ä»¤</strong>ï¼Œä¸è®ºæ˜¯Kill -2è¿˜æ˜¯Kill -9ï¼›è€ŒKafkaè‡ªåŠ¨å…³é—­æ˜¯ç”±<strong>æ¶ˆè´¹è€…ç«¯å‚æ•°connection.max.idle.ms</strong>æ§åˆ¶çš„ï¼Œè¯¥å‚æ•°ç°åœ¨çš„é»˜è®¤å€¼æ˜¯9åˆ†é’Ÿï¼Œå³å¦‚æœæŸä¸ªSocketè¿æ¥ä¸Šè¿ç»­9åˆ†é’Ÿéƒ½æ²¡æœ‰ä»»ä½•è¯·æ±‚â€œè¿‡å¢ƒâ€çš„è¯ï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…ä¼šå¼ºè¡Œâ€œæ€æ‰â€è¿™ä¸ªSocketè¿æ¥ã€‚</p><p>ä¸è¿‡ï¼Œå’Œç”Ÿäº§è€…æœ‰äº›ä¸åŒçš„æ˜¯ï¼Œå¦‚æœåœ¨ç¼–å†™æ¶ˆè´¹è€…ç¨‹åºæ—¶ï¼Œä½ ä½¿ç”¨äº†å¾ªç¯çš„æ–¹å¼æ¥è°ƒç”¨pollæ–¹æ³•æ¶ˆè´¹æ¶ˆæ¯ï¼Œé‚£ä¹ˆä¸Šé¢æåˆ°çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«å®šæœŸå‘é€åˆ°Brokerï¼Œå› æ­¤è¿™äº›Socketè¿æ¥ä¸Šæ€»æ˜¯èƒ½ä¿è¯æœ‰è¯·æ±‚åœ¨å‘é€ï¼Œä»è€Œä¹Ÿå°±å®ç°äº†â€œé•¿è¿æ¥â€çš„æ•ˆæœã€‚</p><p>é’ˆå¯¹ä¸Šé¢æåˆ°çš„ä¸‰ç±»TCPè¿æ¥ï¼Œä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>å½“ç¬¬ä¸‰ç±»TCPè¿æ¥æˆåŠŸåˆ›å»ºåï¼Œæ¶ˆè´¹è€…ç¨‹åºå°±ä¼šåºŸå¼ƒç¬¬ä¸€ç±»TCPè¿æ¥</strong>ï¼Œä¹‹ååœ¨å®šæœŸè¯·æ±‚å…ƒæ•°æ®æ—¶ï¼Œå®ƒä¼šæ”¹ä¸ºä½¿ç”¨ç¬¬ä¸‰ç±»TCPè¿æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ€ç»ˆä½ ä¼šå‘ç°ï¼Œç¬¬ä¸€ç±»TCPè¿æ¥ä¼šåœ¨åå°è¢«é»˜é»˜åœ°å…³é—­æ‰ã€‚å¯¹ä¸€ä¸ªè¿è¡Œäº†ä¸€æ®µæ—¶é—´çš„æ¶ˆè´¹è€…ç¨‹åºæ¥è¯´ï¼Œåªä¼šæœ‰åé¢ä¸¤ç±»TCPè¿æ¥å­˜åœ¨ã€‚</p><h2>å¯èƒ½çš„é—®é¢˜</h2><p>ä»ç†è®ºä¸Šè¯´ï¼ŒKafka Javaæ¶ˆè´¹è€…ç®¡ç†TCPèµ„æºçš„æœºåˆ¶æˆ‘å·²ç»è¯´æ¸…æ¥šäº†ï¼Œä½†å¦‚æœä»”ç»†æ¨æ•²è¿™é‡Œé¢çš„è®¾è®¡åŸç†ï¼Œè¿˜æ˜¯ä¼šå‘ç°ä¸€äº›é—®é¢˜ã€‚</p><p>æˆ‘ä»¬åˆšåˆšè®²è¿‡ï¼Œç¬¬ä¸€ç±»TCPè¿æ¥ä»…ä»…æ˜¯ä¸ºäº†é¦–æ¬¡è·å–å…ƒæ•°æ®è€Œåˆ›å»ºçš„ï¼Œåé¢å°±ä¼šè¢«åºŸå¼ƒæ‰ã€‚æœ€æ ¹æœ¬çš„åŸå› æ˜¯ï¼Œæ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶è¿˜ä¸çŸ¥é“Kafkaé›†ç¾¤çš„ä¿¡æ¯ï¼Œåªèƒ½ä½¿ç”¨ä¸€ä¸ªâ€œå‡â€çš„IDå»æ³¨å†Œï¼Œå³ä½¿æ¶ˆè´¹è€…è·å–äº†çœŸå®çš„Broker IDï¼Œå®ƒä¾æ—§æ— æ³•åŒºåˆ†è¿™ä¸ªâ€œå‡â€IDå¯¹åº”çš„æ˜¯å“ªå°Brokerï¼Œå› æ­¤ä¹Ÿå°±æ— æ³•é‡ç”¨è¿™ä¸ªSocketè¿æ¥ï¼Œåªèƒ½å†é‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ç§æƒ…å†µå‘¢ï¼Ÿä¸»è¦æ˜¯å› ä¸ºç›®å‰Kafkaä»…ä»…ä½¿ç”¨IDè¿™ä¸€ä¸ªç»´åº¦çš„æ•°æ®æ¥è¡¨å¾Socketè¿æ¥ä¿¡æ¯ã€‚è¿™ç‚¹ä¿¡æ¯æ˜æ˜¾ä¸è¶³ä»¥ç¡®å®šè¿æ¥çš„æ˜¯å“ªå°Brokerï¼Œä¹Ÿè®¸åœ¨æœªæ¥ï¼Œç¤¾åŒºåº”è¯¥è€ƒè™‘ä½¿ç”¨<strong>&lt;ä¸»æœºåã€ç«¯å£ã€ID&gt;</strong>ä¸‰å…ƒç»„çš„æ–¹å¼æ¥å®šä½Socketèµ„æºï¼Œè¿™æ ·æˆ–è®¸èƒ½å¤Ÿè®©æ¶ˆè´¹è€…ç¨‹åºå°‘åˆ›å»ºä¸€äº›TCPè¿æ¥ã€‚</p><p>ä¹Ÿè®¸ä½ ä¼šé—®ï¼Œåæ­£Kafkaæœ‰å®šæ—¶å…³é—­æœºåˆ¶ï¼Œè¿™ç®—å¤šå¤§ç‚¹äº‹å‘¢ï¼Ÿå…¶å®ï¼Œåœ¨å®é™…åœºæ™¯ä¸­ï¼Œæˆ‘è§è¿‡å¾ˆå¤šå°†connection.max.idle.msè®¾ç½®æˆ-1ï¼Œå³ç¦ç”¨å®šæ—¶å…³é—­çš„æ¡ˆä¾‹ï¼Œå¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œè¿™äº›TCPè¿æ¥å°†ä¸ä¼šè¢«å®šæœŸæ¸…é™¤ï¼Œåªä¼šæˆä¸ºæ°¸ä¹…çš„â€œåƒµå°¸â€è¿æ¥ã€‚åŸºäºè¿™ä¸ªåŸå› ï¼Œç¤¾åŒºåº”è¯¥è€ƒè™‘æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</p><h2>å°ç»“</h2><p>å¥½äº†ï¼Œä»Šå¤©æˆ‘ä»¬è¡¥é½äº†Kafka Javaå®¢æˆ·ç«¯ç®¡ç†TCPè¿æ¥çš„â€œæ‹¼å›¾â€ã€‚æˆ‘ä»¬ä¸ä»…è¯¦ç»†æè¿°äº†Javaæ¶ˆè´¹è€…æ˜¯æ€ä¹ˆåˆ›å»ºå’Œå…³é—­TCPè¿æ¥çš„ï¼Œè¿˜å¯¹ç›®å‰çš„è®¾è®¡æ–¹æ¡ˆæå‡ºäº†ä¸€äº›è‡ªå·±çš„æ€è€ƒã€‚å¸Œæœ›ä»Šåä½ èƒ½å°†è¿™äº›çŸ¥è¯†åº”ç”¨åˆ°è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¹¶å¯¹å®é™…ç”Ÿäº§ç¯å¢ƒä¸­çš„Socketç®¡ç†åšåˆ°å¿ƒä¸­æœ‰æ•°ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f1/04/f13d7008d7b251df0e6e6a89077d7604.jpg?wh=2069*2535\" alt=\"\"></p><h2>å¼€æ”¾è®¨è®º</h2><p>å‡è®¾æœ‰ä¸ªKafkaé›†ç¾¤ç”±2å°Brokerç»„æˆï¼Œæœ‰ä¸ªä¸»é¢˜æœ‰5ä¸ªåˆ†åŒºï¼Œå½“ä¸€ä¸ªæ¶ˆè´¹è¯¥ä¸»é¢˜çš„æ¶ˆè´¹è€…ç¨‹åºå¯åŠ¨æ—¶ï¼Œä½ è®¤ä¸ºè¯¥ç¨‹åºä¼šåˆ›å»ºå¤šå°‘ä¸ªSocketè¿æ¥ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>æ¬¢è¿å†™ä¸‹ä½ çš„æ€è€ƒå’Œç­”æ¡ˆï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºã€‚å¦‚æœä½ è§‰å¾—æœ‰æ‰€æ”¶è·ï¼Œä¹Ÿæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ã€‚</p>","neighbors":{"left":{"article_title":"20 | å¤šçº¿ç¨‹å¼€å‘æ¶ˆè´¹è€…å®ä¾‹","id":108512},"right":{"article_title":"22 | æ¶ˆè´¹è€…ç»„æ¶ˆè´¹è¿›åº¦ç›‘æ§éƒ½æ€ä¹ˆå®ç°ï¼Ÿ","id":109238}},"comments":[{"had_liked":false,"id":115400,"user_name":"å¸¸è¶…","can_delete":false,"product_type":"c1","uid":1138665,"ip_address":"","ucode":"4AE7743B4ADF20","user_header":"https://static001.geekbang.org/account/avatar/00/11/5f/e9/95ef44f3.jpg","comment_is_top":false,"comment_ctime":1563576131,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"177657235267","product_id":100029201,"comment_content":"æ•´ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œä¼šå»ºç«‹4ä¸ªè¿æ¥ï¼Œè¿›å…¥ç¨³å®šçš„æ¶ˆè´¹è¿‡ç¨‹åï¼ŒåŒæ—¶ä¿æŒ3ä¸ªè¿æ¥ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†ã€‚<br>ç¬¬ä¸€ç±»è¿æ¥ï¼šç¡®å®šåè°ƒè€…å’Œè·å–é›†ç¾¤å…ƒæ•°æ®ã€‚ <br> ä¸€ä¸ªï¼ŒåˆæœŸçš„æ—¶å€™å»ºç«‹ï¼Œå½“ç¬¬ä¸‰ç±»è¿æ¥å»ºç«‹èµ·æ¥ä¹‹åï¼Œè¿™ä¸ªè¿æ¥ä¼šè¢«å…³é—­ã€‚<br><br>ç¬¬äºŒç±»è¿æ¥ï¼šè¿æ¥åè°ƒè€…ï¼Œä»¤å…¶æ‰§è¡Œç»„æˆå‘˜ç®¡ç†æ“ä½œã€‚<br> ä¸€ä¸ª<br><br>ç¬¬ä¸‰ç±»è¿æ¥ï¼šæ‰§è¡Œå®é™…çš„æ¶ˆæ¯è·å–ã€‚<br>ä¸¤ä¸ªåˆ†åˆ«ä¼šè·Ÿä¸¤å°brokeræœºå™¨å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œæ€»å…±ä¸¤ä¸ªTCPè¿æ¥ï¼ŒåŒä¸€ä¸ªbrokeræœºå™¨çš„ä¸åŒåˆ†åŒºå¯ä»¥å¤ç”¨ä¸€ä¸ªsocketã€‚","like_count":42,"discussions":[{"author":{"id":1522220,"avatar":"https://static001.geekbang.org/account/avatar/00/17/3a/2c/683ae4af.jpg","nickname":"è±†èŠ±ç¾¹","note":"","ucode":"57D8F64988C305","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7261,"discussion_content":"æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¹Ÿæœ‰å¯èƒ½æ˜¯å»ºç«‹3ä¸ªè¿æ¥ã€‚\nå½“é¢†å¯¼è€…å‰¯æœ¬éƒ½ä½äºåŒä¸€ä¸ªbrokerä¸Šæ—¶ï¼Œç¬¬ä¸‰ç±»è¿æ¥åªä¼šå»ºç«‹ä¸€ä¸ªã€‚","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1567437682,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1096984,"avatar":"https://static001.geekbang.org/account/avatar/00/10/bd/18/2af6bf4b.jpg","nickname":"å…”2ğŸ°ğŸƒ","note":"","ucode":"1FEDA044BB6CBD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8601,"discussion_content":"åªæœ‰2ä¸ª Brokerï¼Œ5ä¸ªåˆ†åŒºçš„é¢†å¯¼è€…å‰¯æœ¬ï¼Œç”±zookeeperåˆ†é…Leaderï¼Œæ‰€ä»¥é»˜è®¤æ˜¯å‡åŒ€çš„ï¼Œæ•…æœ‰4ä¸ªTCPè¿æ¥ã€‚","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1568023920,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148378,"user_name":"æ³¨å®šéå‡¡","can_delete":false,"product_type":"c1","uid":1113597,"ip_address":"","ucode":"80673056E131B7","user_header":"https://static001.geekbang.org/account/avatar/00/10/fd/fd/326be9bb.jpg","comment_is_top":false,"comment_ctime":1573000411,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"96062280923","product_id":100029201,"comment_content":"1ï¼Œä½•æ—¶åˆ›å»º<br>\tA ï¼šæ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ä¸åŒï¼Œåœ¨åˆ›å»ºKafkaConsumerå®ä¾‹æ—¶ä¸ä¼šåˆ›å»ºä»»ä½•TCPè¿æ¥ã€‚<br>\t\tåŸå› ï¼šæ˜¯å› ä¸ºç”Ÿäº§è€…å…¥å£ç±»KafkaProduceråœ¨æ„å»ºå®ä¾‹æ—¶ï¼Œä¼šåœ¨åå°å¯åŠ¨ä¸€ä¸ªSenderçº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹æ˜¯è´Ÿè´£Socketè¿æ¥åˆ›å»ºçš„ã€‚<br><br>\tB ï¼šTCPè¿æ¥æ˜¯åœ¨è°ƒç”¨KafkaConsumer.pollæ–¹æ³•æ—¶è¢«åˆ›å»ºã€‚åœ¨pollæ–¹æ³•å†…éƒ¨æœ‰3ä¸ªæ—¶æœºåˆ›å»ºTCPè¿æ¥<br>\tï¼ˆ1ï¼‰å‘èµ·findCoordinatorè¯·æ±‚æ—¶åˆ›å»º<br>\t\tCoordinatorï¼ˆåè°ƒè€…ï¼‰æ¶ˆè´¹è€…ç«¯ä¸»é”®ï¼Œé©»ç•™åœ¨Brokerç«¯çš„å†…å­˜ä¸­ï¼Œè´Ÿè´£æ¶ˆè´¹è€…ç»„çš„ç»„æˆå‘˜ç®¡ç†å’Œå„ä¸ªæ¶ˆè´¹è€…çš„ä½ç§»æäº¤ç®¡ç†ã€‚<br>\t\tå½“æ¶ˆè´¹è€…ç¨‹åºé¦–æ¬¡å¯åŠ¨è°ƒç”¨pollæ–¹æ³•æ—¶ï¼Œå®ƒéœ€è¦å‘Kafkaé›†ç¾¤å‘é€ä¸€ä¸ªåä¸ºFindCoordinatorçš„è¯·æ±‚ï¼Œç¡®è®¤å“ªä¸ªBrokeræ˜¯ç®¡ç†å®ƒçš„åè°ƒè€…ã€‚<br><br>\tï¼ˆ2ï¼‰è¿æ¥åè°ƒè€…æ—¶<br>\t\tBrokerå¤„ç†äº†æ¶ˆè´¹è€…å‘æ¥çš„FindCoordinatorè¯·æ±‚åï¼Œè¿”å›å“åº”æ˜¾å¼çš„å‘Šè¯‰æ¶ˆè´¹è€…å“ªä¸ªBrokeræ˜¯çœŸæ­£çš„åè°ƒè€…ã€‚<br>\t\tå½“æ¶ˆè´¹è€…çŸ¥æ™“çœŸæ­£çš„åè°ƒè€…åï¼Œä¼šåˆ›å»ºè¿å‘è¯¥Brokerçš„socketè¿æ¥ã€‚<br>\t\tåªæœ‰æˆåŠŸè¿å…¥åè°ƒè€…ï¼Œåè°ƒè€…æ‰èƒ½å¼€å¯æ­£å¸¸çš„ç»„åè°ƒæ“ä½œã€‚<br><br>\tï¼ˆ3ï¼‰æ¶ˆè´¹æ•°æ®æ—¶<br>\t\tæ¶ˆè´¹è€…ä¼šä¸ºæ¯ä¸ªè¦æ¶ˆè´¹çš„åˆ†åŒºåˆ›å»ºä¸è¯¥åˆ†åŒºé¢†å¯¼è€…å‰¯æœ¬æ‰€åœ¨çš„Brokerè¿æ¥çš„TCP.<br><br>2 åˆ›å»ºå¤šå°‘<br>\tæ¶ˆè´¹è€…ç¨‹åºä¼šåˆ›å»º3ç±»TCPè¿æ¥ï¼š<br>\tï¼ˆ1ï¼‰ ï¼šç¡®å®šåè°ƒè€…å’Œè·å–é›†ç¾¤å…ƒæ•°æ®<br>\tï¼ˆ2ï¼‰ï¼šè¿æ¥åè°ƒè€…ï¼Œä»¤å…¶æ‰§è¡Œç»„æˆå‘˜ç®¡ç†æ“ä½œ<br>\tï¼ˆ3ï¼‰ ï¼šæ‰§è¡Œå®é™…çš„æ¶ˆæ¯è·å–<br><br>3 ä½•æ—¶å…³é—­TCPè¿æ¥<br>\tA ï¼šå’Œç”Ÿäº§è€…ç›¸ä¼¼ï¼Œæ¶ˆè´¹è€…å…³é—­Socketä¹Ÿåˆ†ä¸ºä¸»åŠ¨å…³é—­å’ŒKafkaè‡ªåŠ¨å…³é—­ã€‚<br>\tB ï¼šä¸»åŠ¨å…³é—­æŒ‡é€šè¿‡KafkaConsumer.close()æ–¹æ³•ï¼Œæˆ–è€…æ‰§è¡Œkillå‘½ä»¤ï¼Œæ˜¾ç¤ºåœ°è°ƒç”¨æ¶ˆè´¹è€…APIçš„æ–¹æ³•å»å…³é—­æ¶ˆè´¹è€…ã€‚<br>\tC ï¼šè‡ªåŠ¨å…³é—­æŒ‡æ¶ˆè´¹è€…ç«¯å‚æ•°connection.max.idle.msæ§åˆ¶çš„ï¼Œé»˜è®¤ä¸º9åˆ†é’Ÿï¼Œå³å¦‚æœæŸä¸ªsocketè¿æ¥ä¸Šè¿ç»­9åˆ†é’Ÿéƒ½æ²¡æœ‰ä»»ä½•è¯·æ±‚é€šè¿‡ï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…ä¼šå¼ºè¡Œæ€æ­»è¿™ä¸ªè¿æ¥ã€‚<br>\tD ï¼šè‹¥æ¶ˆè´¹è€…ç¨‹åºä¸­ä½¿ç”¨äº†å¾ªç¯çš„æ–¹å¼æ¥è°ƒç”¨pollæ–¹æ³•æ¶ˆæ¯æ¶ˆæ¯ï¼Œä»¥ä¸Šçš„è¯·æ±‚éƒ½ä¼šè¢«å®šæœŸçš„å‘é€åˆ°Brokerï¼Œæ‰€ä»¥è¿™äº›socketè¿æ¥ä¸Šæ€»æ˜¯èƒ½ä¿è¯æœ‰è¯·æ±‚åœ¨å‘é€ï¼Œä»è€Œå®ç°â€œé•¿è¿æ¥â€çš„æ•ˆæœã€‚<br>\tE ï¼šå½“ç¬¬ä¸‰ç±»TCPè¿æ¥æˆåŠŸåˆ›å»ºåï¼Œæ¶ˆè´¹è€…ç¨‹åºå°±ä¼šåºŸå¼ƒç¬¬ä¸€ç±»TCPè¿æ¥ï¼Œä¹‹ååœ¨å®šæœŸè¯·æ±‚å…ƒæ•°æ®æ—¶ï¼Œä¼šæ”¹ä¸ºä½¿ç”¨ç¬¬ä¸‰ç±»TCPè¿æ¥ã€‚å¯¹äºä¸€ä¸ªè¿è¡Œäº†ä¸€æ®µæ—¶é—´çš„æ¶ˆè´¹è€…ç¨‹åºæ¥è®²ï¼Œåªä¼šæœ‰åé¢ä¸¤ç§çš„TCPè¿æ¥ã€‚<br>","like_count":22},{"had_liked":false,"id":163005,"user_name":"AAA_å¶å­","can_delete":false,"product_type":"c1","uid":1325994,"ip_address":"","ucode":"1E93617D308EE0","user_header":"https://static001.geekbang.org/account/avatar/00/14/3b/aa/e8dfcd7e.jpg","comment_is_top":false,"comment_ctime":1576639203,"is_pvip":false,"replies":[{"id":"62105","content":"å—¯ï¼Œå¦‚æœå°±æ˜¯è¦é•¿æ—¶é—´çš„æ¶ˆè´¹ï¼Œç»´æŒä¸€ä¸ªé•¿è¿æ¥æ˜¯ä¸é”™çš„é€‰æ‹©","user_name":"ä½œè€…å›å¤","comment_id":163005,"uid":"1288090","ip_address":"","utype":1,"ctime":1576717360,"user_name_real":"huxi_2b"}],"discussion_count":3,"race_medal":0,"score":"91770952419","product_id":100029201,"comment_content":"æ¶ˆè´¹è€…tcpè¿æ¥ä¸€æ—¦æ–­å¼€ï¼Œå°±ä¼šå¯¼è‡´rebalanceï¼Œå®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ˜¯ä¸æ˜¯éœ€è¦å°½é‡ä¿è¯é•¿è¿æ¥çš„æ¨¡å¼ï¼Ÿ","like_count":21,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478211,"discussion_content":"å—¯ï¼Œå¦‚æœå°±æ˜¯è¦é•¿æ—¶é—´çš„æ¶ˆè´¹ï¼Œç»´æŒä¸€ä¸ªé•¿è¿æ¥æ˜¯ä¸é”™çš„é€‰æ‹©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576717360,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1339409,"avatar":"https://static001.geekbang.org/account/avatar/00/14/70/11/42cf8f9d.jpg","nickname":"chenjia","note":"","ucode":"61983C29FF4987","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367245,"discussion_content":"ç»´æŒ2ä¸ªï¼Œå¹¶äº¤æ›¿ä½¿ç”¨ï¼Œå²‚ä¸ç¾å“‰ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618305030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1339409,"avatar":"https://static001.geekbang.org/account/avatar/00/14/70/11/42cf8f9d.jpg","nickname":"chenjia","note":"","ucode":"61983C29FF4987","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367244,"discussion_content":"ç»´æŒå¤šä¸ªå²‚ä¸æ˜¯æ›´åŠ å®‰å…¨ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618305008,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116200,"user_name":"taj3991","can_delete":false,"product_type":"c1","uid":1161307,"ip_address":"","ucode":"0CC37B928EB49E","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/5b/dbe74486.jpg","comment_is_top":false,"comment_ctime":1563801238,"is_pvip":false,"replies":[{"id":"42576","content":"æ˜¯çš„ã€‚æ¯ä¸ªgroupéƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„coordinator","user_name":"ä½œè€…å›å¤","comment_id":116200,"uid":"1288090","ip_address":"","utype":1,"ctime":1563849643,"user_name_real":"huxi_2b"}],"discussion_count":1,"race_medal":0,"score":"70283277974","product_id":100029201,"comment_content":"è€å¸ˆåŒä¸€ä¸ªæ¶ˆè´¹ç»„çš„å®¢æˆ·ç«¯éƒ½åªä¼šè¿æ¥åˆ°ä¸€ä¸ªåè°ƒè€…å—ï¼Ÿ","like_count":16,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459430,"discussion_content":"æ˜¯çš„ã€‚æ¯ä¸ªgroupéƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„coordinator","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563849643,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115849,"user_name":"Williamzhang","can_delete":false,"product_type":"c1","uid":1148759,"ip_address":"","ucode":"C016AE5DE39F4E","user_header":"https://static001.geekbang.org/account/avatar/00/11/87/57/e28ba87b.jpg","comment_is_top":false,"comment_ctime":1563757543,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"48808397799","product_id":100029201,"comment_content":"æˆ‘è§‰å¾—ä½œè€…å¯ä»¥è·Ÿå­¦å‘˜çš„ç•™è¨€äº’åŠ¨ï¼Œç„¶åæ¯æœŸè¯¾åæ€è€ƒå¯ä»¥åœ¨ä¸‹æœŸä¸­è´´å‡ºç­”æ¡ˆåŠåˆ†æï¼Œå…¶å®ç•™è¨€è®¨è®ºä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸è®©äººæœ‰æ”¶è·çš„åœ°æ–¹","like_count":12,"discussions":[{"author":{"id":1339409,"avatar":"https://static001.geekbang.org/account/avatar/00/14/70/11/42cf8f9d.jpg","nickname":"chenjia","note":"","ucode":"61983C29FF4987","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367246,"discussion_content":"ç•™è¨€æ›´å¤šçš„æ˜¯æ²Ÿé€šï¼Œæ²Ÿé€šæ˜¯æœ€æœ‰æ•ˆçš„å­¦ä¹ æ–¹å¼ï¼Œå¯ä»¥æŸ¥æ¼è¡¥ç¼º","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1618305106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1488243,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b5/73/15a8006a.jpg","nickname":"goxdev","note":"","ucode":"7374587CD08BEE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393962,"discussion_content":"ç•™è¨€åŒºæ›´åƒæ˜¯å®è—åŒº å­¦åˆ°æ›´å¤šğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631672586,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188802,"user_name":"Geek_ab3d9a","can_delete":false,"product_type":"c1","uid":1550553,"ip_address":"","ucode":"1AFEE5FA59D470","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eol8MiawYVfCtkaFL9DFGoWpuajsKicwyt7IWm07JfrLMDuksEZJqia4Rbicw0biayokhgvSK0rUXIAngQ/132","comment_is_top":false,"comment_ctime":1584417843,"is_pvip":false,"replies":[{"id":"72974","content":"æ¯ä¸ªå®¢æˆ·ç«¯è‡³å°‘ä¸»æœºåå’Œç«¯å£æ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘æ˜¯æŒ‡åœ¨TCPè¿æ¥è¿™ä¸ªå±‚é¢ã€‚å¦å¤–å¯¹äºproducerè€Œè¨€ï¼Œå…¶å®Kafkaä¹Ÿä¸ç”¨åŒºåˆ†å®ƒä»¬ï¼Œåæ­£çŸ¥é“å®ƒä»¬éƒ½å†å‘é›†ç¾¤å‘é€æ¶ˆæ¯å°±è¡Œäº†ã€‚å¯¹äºconsumerè€Œè¨€ï¼Œä¸»è¦è¿˜æ˜¯çœ‹group.idçš„è®¾ç½®ä»¥ç¡®å®šå®ƒä»¬æ˜¯å¦åœ¨åŒä¸€ä¸ªgroupã€‚æœ€åå¦‚æœæ˜¯ä½ æƒ³åŒºåˆ†å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½®ä¸åŒçš„client.id","user_name":"ä½œè€…å›å¤","comment_id":188802,"uid":"1288090","ip_address":"","utype":1,"ctime":1584491610,"user_name_real":"huxi_2b"}],"discussion_count":1,"race_medal":0,"score":"31649188915","product_id":100029201,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®k8sè¿™æ ·çš„å®¹å™¨å¹³å°ï¼Œé€‚åˆéƒ¨ç½²kafkaçš„æ¶ˆè´¹è€…å—ï¼Ÿå¦‚æœå®¹å™¨å¹³å°èµ·äº†äºŒä¸ªä¸€æ¨¡ä¸€æ ·çš„æ¶ˆè´¹è€…ï¼Œå¯¹kafkaæ¥è¯´ä¼šä¸ä¼šä¸çŸ¥é“è‡ªå·±é€šä¿¡çš„å“ªä¸€ä¸ªæ¶ˆè´¹è€…?  kafkaé€šè¿‡ä»€ä¹ˆæ¥åˆ¤æ–­ä¸åŒçš„å®¢æˆ·ç«¯?","like_count":7,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487532,"discussion_content":"æ¯ä¸ªå®¢æˆ·ç«¯è‡³å°‘ä¸»æœºåå’Œç«¯å£æ˜¯ä¸ä¸€æ ·çš„ï¼Œæˆ‘æ˜¯æŒ‡åœ¨TCPè¿æ¥è¿™ä¸ªå±‚é¢ã€‚å¦å¤–å¯¹äºproducerè€Œè¨€ï¼Œå…¶å®Kafkaä¹Ÿä¸ç”¨åŒºåˆ†å®ƒä»¬ï¼Œåæ­£çŸ¥é“å®ƒä»¬éƒ½å†å‘é›†ç¾¤å‘é€æ¶ˆæ¯å°±è¡Œäº†ã€‚å¯¹äºconsumerè€Œè¨€ï¼Œä¸»è¦è¿˜æ˜¯çœ‹group.idçš„è®¾ç½®ä»¥ç¡®å®šå®ƒä»¬æ˜¯å¦åœ¨åŒä¸€ä¸ªgroupã€‚æœ€åå¦‚æœæ˜¯ä½ æƒ³åŒºåˆ†å®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½®ä¸åŒçš„client.id","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584491610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":134501,"user_name":"å¤©å¤©å‘ä¸Š","can_delete":false,"product_type":"c1","uid":1031113,"ip_address":"","ucode":"5948D359734193","user_header":"https://static001.geekbang.org/account/avatar/00/0f/bb/c9/37924ad4.jpg","comment_is_top":false,"comment_ctime":1568856390,"is_pvip":false,"replies":[{"id":"51670","content":"ä¸åŒ…æ‹¬ï¼Œå› ä¸ºä½ è¯·æ±‚å…ƒæ•°æ®çš„brokerå¯èƒ½ä¸æ˜¯Coordinatorï¼Œæ²¡æœ‰Coordinatorçš„ä¿¡æ¯","user_name":"ä½œè€…å›å¤","comment_id":134501,"uid":"1288090","ip_address":"","utype":1,"ctime":1568901429,"user_name_real":"huxi_2b"}],"discussion_count":1,"race_medal":0,"score":"27338660166","product_id":100029201,"comment_content":"å…ƒæ•°æ®ä¸åŒ…å«åè°ƒè€…ä¿¡æ¯å—ï¼Ÿä¸ºå•¥è¿˜è¦å†è¯·æ±‚ä¸€æ¬¡åè°ƒè€…ä¿¡æ¯ ä»€ä¹ˆè®¾è®¡æ€è·¯ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467776,"discussion_content":"ä¸åŒ…æ‹¬ï¼Œå› ä¸ºä½ è¯·æ±‚å…ƒæ•°æ®çš„brokerå¯èƒ½ä¸æ˜¯Coordinatorï¼Œæ²¡æœ‰Coordinatorçš„ä¿¡æ¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568901429,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116746,"user_name":"ä¿¡ä¿¡","can_delete":false,"product_type":"c1","uid":1303865,"ip_address":"","ucode":"8DF0EC045579FD","user_header":"https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg","comment_is_top":false,"comment_ctime":1563900443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27333704219","product_id":100029201,"comment_content":"ä¸€å…±å»ºè¿‡å››æ¬¡è¿æ¥ã€‚è‹¥connection.max.idle.ms ä¸ä¸º-1ï¼Œæœ€ç»ˆä¼šæ–­å¼€ç¬¬ä¸€æ¬¡è¿çš„IDä¸º-1çš„è¿æ¥ã€‚","like_count":6},{"had_liked":false,"id":115626,"user_name":"October","can_delete":false,"product_type":"c1","uid":1137879,"ip_address":"","ucode":"CEDA78F4A5F8B1","user_header":"https://static001.geekbang.org/account/avatar/00/11/5c/d7/e4673fde.jpg","comment_is_top":false,"comment_ctime":1563677848,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"27333481624","product_id":100029201,"comment_content":"æ€»å…±åˆ›å»º4ä¸ªè¿æ¥ï¼Œæœ€ç»ˆä¿æŒ3ä¸ªè¿æ¥ï¼š<br>        ç¡®å®šæ¶ˆè´¹è€…æ‰€å±çš„æ¶ˆè´¹ç»„å¯¹åº”çš„GroupCoordinatorå’Œè·å–é›†ç¾¤çš„metadataæ—¶åˆ›å»ºä¸€ä¸ªTCPè¿æ¥ï¼Œç”±äºæ­¤æ—¶çš„node id = -1ï¼Œæ‰€ä»¥è¯¥è¿æ¥æ— æ³•é‡ç”¨ã€‚<br>        è¿æ¥GroupCoordinatoræ—¶ï¼Œåˆ›å»ºç¬¬äºŒä¸ªTCPè¿æ¥ï¼Œnode idå€¼ä¸ºInteger.MAX_VALUE-id<br>        æ¶ˆè´¹è€…ä¼šä¸æ¯ä¸ªåˆ†åŒºçš„leaderåˆ›å»ºä¸€ä¸ªTCPè¿æ¥æ¥æ¶ˆè´¹æ•°æ®ï¼Œnode idä¸ºbroker.idï¼Œç”±äºkafkaåªæ˜¯ç”¨idè¿™ä¸€ç»´åº¦æ¥è¡¨å¾Socketè¿æ¥ä¿¡æ¯ï¼Œå› æ­¤å¦‚æœå¤šä¸ªåˆ†åŒºçš„leaderåœ¨åŒä¸€ä¸ªbrokerä¸Šæ—¶ï¼Œä¼šå…±ç”¨ä¸€ä¸ªTCPè¿æ¥ï¼Œç”±äºåˆ†åŒºæ•°å¤§äºbrokerçš„æ•°é‡ï¼Œæ‰€ä»¥ä¼šåˆ›å»ºä¸¤ä¸ªTCPè¿æ¥æ¶ˆè´¹æ•°æ®ã€‚","like_count":6},{"had_liked":false,"id":210791,"user_name":"çœŸé”…","can_delete":false,"product_type":"c1","uid":1141547,"ip_address":"","ucode":"D36634359B0BD6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqxnw92EOgZbyHDGMZ1d1OFDjjJKnBdmpiac8J7kBEN5h3AvvzU85mo5Chj8pkIHQc390dL1mu0neQ/132","comment_is_top":false,"comment_ctime":1587825812,"is_pvip":false,"replies":[{"id":"78457","content":"è¿™ä¸ªæ•°å­—ä¸æ˜¯å›ºå®šçš„ï¼Œè€Œæ˜¯ç”¨MAX - broker IDç®—å‡ºæ¥çš„ã€‚å¯¹Coordinatorçš„è¿æ¥æ¥è¯´ï¼Œæ˜¯çš„ï¼ å®ƒçš„IDå°±æ˜¯è¿™ä¸ªç®—æ³•","user_name":"ä½œè€…å›å¤","comment_id":210791,"uid":"1288090","ip_address":"","utype":1,"ctime":1587865652,"user_name_real":"èƒ¡å¤•"}],"discussion_count":1,"race_medal":0,"score":"18767694996","product_id":100029201,"comment_content":"æ„æ€æ˜¯å³ä¾¿çŸ¥é“äº†åè°ƒè€…åœ¨node 2ä¸Šï¼Œè¿˜æ˜¯ä¼šä¾ç„¶ç”¨2147483645è¿™ä¸ªidçš„TCPè¿æ¥å»è·Ÿåè°ƒè€…é€šä¿¡å—ã€‚","like_count":4,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493109,"discussion_content":"è¿™ä¸ªæ•°å­—ä¸æ˜¯å›ºå®šçš„ï¼Œè€Œæ˜¯ç”¨MAX - broker IDç®—å‡ºæ¥çš„ã€‚å¯¹Coordinatorçš„è¿æ¥æ¥è¯´ï¼Œæ˜¯çš„ï¼ å®ƒçš„IDå°±æ˜¯è¿™ä¸ªç®—æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587865652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173179,"user_name":"Eco","can_delete":false,"product_type":"c1","uid":1373230,"ip_address":"","ucode":"5459B494753183","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/x86UN2kFbJGGwiaw7yeVtyaf05y5eZmdOciaAF09WEBRVicbPGsej1b62UAH3icjeJqvibVc6aqB0EuFwDicicKKcF47w/132","comment_is_top":false,"comment_ctime":1579448135,"is_pvip":false,"replies":[{"id":"67156","content":"ç›®å‰ä¸Coordinatorå’Œæ™®é€šæ•°æ®äº¤äº’çš„TCPè¿æ¥çš„ç¡®æ˜¯åˆ†å¼€çš„ï¼Œä½ è¦è¯´æ˜¯å¦èƒ½å¤ç”¨ï¼Œæˆ‘è§‰å¾—å½“ç„¶å¯ä»¥å¤ç”¨ï¼Œåªä¸è¿‡ç°åœ¨æ²¡æœ‰è¿™ä¹ˆè®¾è®¡ï¼šï¼‰","user_name":"ä½œè€…å›å¤","comment_id":173179,"uid":"1288090","ip_address":"","utype":1,"ctime":1579481854,"user_name_real":"huxi_2b"}],"discussion_count":2,"race_medal":0,"score":"18759317319","product_id":100029201,"comment_content":"åº”è¯¥æ˜¯3ä¸ªtcpè¿æ¥ï¼Œç¬¬ä¸€ä¸ªid=-1çš„æ²¡ä»€ä¹ˆäº‰è®®ï¼Œç„¶åæ˜¯è¿æ¥åè°ƒè€…çš„ï¼Œä½†æ˜¯brokerï¼Œ5ä¸ªåˆ†åŒºçš„leaderè‚¯å®šä¼šåˆ†å¸ƒåˆ°è¿™ä¸¤å°brokerä¸Šï¼Œé‚£ä¹ˆç¬¬ä¸‰ç±»tcpå°±æ˜¯2ä¸ªtcpè¿æ¥ï¼Œä½†æ˜¯è¿™2ä¸ªä¸­å®Œå…¨å¯ä»¥æœ‰ä¸€ä¸ªæ˜¯ç›´æ¥ä½¿ç”¨è¿æ¥åè°ƒè€…çš„é‚£ä¸ªtcpè¿æ¥å§ï¼Œä½†è€å¸ˆå¥½åƒè¯´è¿‡è¿æ¥åè°ƒè€…çš„è¿æ¥ä¼šå’Œä¼ è¾“æ•°æ®çš„åˆ†å¼€ï¼Œidçš„è®¡ç®—éƒ½ä¸ç›¸åŒï¼Œå¥½å§ï¼Œé‚£å°±4ä¸ªtcpè¿æ¥å§ã€‚å¯è¿™é‡ŒçœŸçš„ä¸èƒ½å¤ç”¨å—ï¼Ÿæˆ‘è§‰å¾—å¯ä»¥ã€‚","like_count":4,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":481990,"discussion_content":"ç›®å‰ä¸Coordinatorå’Œæ™®é€šæ•°æ®äº¤äº’çš„TCPè¿æ¥çš„ç¡®æ˜¯åˆ†å¼€çš„ï¼Œä½ è¦è¯´æ˜¯å¦èƒ½å¤ç”¨ï¼Œæˆ‘è§‰å¾—å½“ç„¶å¯ä»¥å¤ç”¨ï¼Œåªä¸è¿‡ç°åœ¨æ²¡æœ‰è¿™ä¹ˆè®¾è®¡ï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579481854,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1373230,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/x86UN2kFbJGGwiaw7yeVtyaf05y5eZmdOciaAF09WEBRVicbPGsej1b62UAH3icjeJqvibVc6aqB0EuFwDicicKKcF47w/132","nickname":"Eco","note":"","ucode":"5459B494753183","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":142709,"discussion_content":"å¥½å§~_~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579481994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115805,"user_name":"å°æœ¨åŒ ","can_delete":false,"product_type":"c1","uid":1055610,"ip_address":"","ucode":"222F861CF9129C","user_header":"https://static001.geekbang.org/account/avatar/00/10/1b/7a/390a8530.jpg","comment_is_top":false,"comment_ctime":1563752631,"is_pvip":false,"replies":[{"id":"42575","content":"åˆšå¼€å§‹çš„æ—¶å€™å½“ç„¶å°±ç±»ä¼¼äºéšæœºé€‰brokeräº†ï¼Œä½†åé¢æ…¢æ…¢ç§¯ç´¯äº†ä¸€äº›æ•°æ®ä¹‹åè¿™ä¸ªå°ä¼˜åŒ–è¿˜æ˜¯ä¼šèµ·ä¸€äº›ä½œç”¨çš„","user_name":"ä½œè€…å›å¤","comment_id":115805,"uid":"1288090","ip_address":"","utype":1,"ctime":1563849596,"user_name_real":"huxi_2b"}],"discussion_count":1,"race_medal":0,"score":"18743621815","product_id":100029201,"comment_content":"â€œè´Ÿè½½æ˜¯å¦‚ä½•è¯„ä¼°çš„å‘¢ï¼Ÿå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯çœ‹æ¶ˆè´¹è€…è¿æ¥çš„æ‰€æœ‰ Broker ä¸­ï¼Œè°çš„å¾…å‘é€è¯·æ±‚æœ€å°‘ã€‚â€  <br>è€å¸ˆè¿™ä¸ªæ²¡å¤ªæ˜ç™½ï¼Œè¿™æ—¶å€™æ¶ˆè´¹è€…ä¸æ˜¯è¿˜æ²¡è¿æ¥ä¹ˆï¼Ÿé‚£è¿™éƒ¨åˆ†ä¿¡æ¯æ˜¯ä»å“ªè·å–åˆ°çš„å‘¢ï¼Ÿæ¶ˆè´¹è€…æœ¬åœ°å—ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459295,"discussion_content":"åˆšå¼€å§‹çš„æ—¶å€™å½“ç„¶å°±ç±»ä¼¼äºéšæœºé€‰brokeräº†ï¼Œä½†åé¢æ…¢æ…¢ç§¯ç´¯äº†ä¸€äº›æ•°æ®ä¹‹åè¿™ä¸ªå°ä¼˜åŒ–è¿˜æ˜¯ä¼šèµ·ä¸€äº›ä½œç”¨çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563849596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228361,"user_name":"yes","can_delete":false,"product_type":"c1","uid":1386201,"ip_address":"","ucode":"612BF6884ED6CC","user_header":"https://static001.geekbang.org/account/avatar/00/15/26/d9/f7e96590.jpg","comment_is_top":false,"comment_ctime":1592648167,"is_pvip":false,"replies":[{"id":"84194","content":"å®ƒé¦–å…ˆå€¾å‘äºä½¿ç”¨å·²å»ºç«‹è¿æ¥çš„èŠ‚ç‚¹ã€‚å¦‚æœå·²å»ºç«‹è¿æ¥çš„èŠ‚ç‚¹éƒ½åœ¨ä½¿ç”¨ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–°çš„TCPè¿æ¥","user_name":"ä½œè€…å›å¤","comment_id":228361,"uid":"1288090","ip_address":"","utype":1,"ctime":1592662804,"user_name_real":"èƒ¡å¤•"}],"discussion_count":2,"race_medal":0,"score":"14477550055","product_id":100029201,"comment_content":"è€å¸ˆæˆ‘æœ‰ä¸ªç–‘é—®ï¼Œconsumeråœ¨FindCoordinatorçš„æ—¶å€™ä¼šé€‰æ‹©è´Ÿè½½æœ€å°çš„brokerè¿›è¡Œè¿æ¥ï¼Œæ–‡ç« è¯´çœ‹æ¶ˆè´¹è€…è¿æ¥çš„æ‰€æœ‰ Broker ä¸­ï¼Œè°çš„å¾…å‘é€è¯·æ±‚æœ€å°‘ã€‚è¯·é—®consumerå¦‚ä½•å¾—çŸ¥è¿™ä¸ªæ¶ˆæ¯ï¼Ÿå¦‚æœå®ƒæƒ³çŸ¥é“è¿™ä¸ªæ¶ˆæ¯ï¼Œä¸å°±å¾—å…ˆå’Œâ€œæŸä¸ªä¸œè¥¿â€å»ºç«‹è¿æ¥äº†ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":499008,"discussion_content":"å®ƒé¦–å…ˆå€¾å‘äºä½¿ç”¨å·²å»ºç«‹è¿æ¥çš„èŠ‚ç‚¹ã€‚å¦‚æœå·²å»ºç«‹è¿æ¥çš„èŠ‚ç‚¹éƒ½åœ¨ä½¿ç”¨ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–°çš„TCPè¿æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592662804,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1141254,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6a/06/66831563.jpg","nickname":"é˜¡é™Œ","note":"","ucode":"58634836C8E03F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295307,"discussion_content":"éš¾é“è¯´å·²å»ºç«‹çš„è¿æ¥ä¸­å­˜åœ¨æœªä½¿ç”¨çš„è¿æ¥çš„è¯ï¼Œé¦–å…ˆé€‰æ‹©çš„æ˜¯æœªä½¿ç”¨çš„è¿æ¥ä¸­è´Ÿè½½æœ€å°çš„ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596161432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218792,"user_name":"Treagzhao","can_delete":false,"product_type":"c1","uid":1109643,"ip_address":"","ucode":"906C3A7F33040C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqKurYDna034zK0ibDIWicybibQhiaM6afgla2zVFqBrAemLgCh3WoibjACnic5ibiaYMd29tMB26cjaGaPoA/132","comment_is_top":false,"comment_ctime":1589876107,"is_pvip":false,"replies":[{"id":"80947","content":"æ˜¯è¿™æ ·åˆ¤æ–­çš„ï¼Œå°±æ˜¯çœ‹æ¶ˆè´¹è€…ä¸brokerçš„TCPè¿æ¥ä¸Šçš„å¾…å¤„ç†è¯·æ±‚çš„ä¸ªæ•°","user_name":"ä½œè€…å›å¤","comment_id":218792,"uid":"1288090","ip_address":"","utype":1,"ctime":1589942860,"user_name_real":"èƒ¡å¤•"}],"discussion_count":1,"race_medal":0,"score":"10179810699","product_id":100029201,"comment_content":"è€å¸ˆï¼Œâ€œæ¶ˆè´¹è€…ç¨‹åºä¼šå‘é›†ç¾¤ä¸­å½“å‰è´Ÿè½½æœ€å°çš„é‚£å° Broker å‘é€è¯·æ±‚â€ï¼Œæ¶ˆè´¹è€…æ€ä¹ˆå•æ–¹é¢çŸ¥é“æœåŠ¡å™¨å¾…å‘é€çš„æ¶ˆæ¯æ•°é‡å‘¢ï¼Ÿè€Œä¸”åº”è¯¥åªæœ‰leaderæ‰ä¼šå®é™…å‘é€æ¶ˆæ¯å§ï¼Œfollowerå¾…å‘é€çš„éƒ½æ˜¯0,æ¶ˆè´¹è€…æ€ä¹ˆåœ¨å»ºç«‹è¿æ¥ä¹‹å‰å°±çŸ¥é“æœåŠ¡å™¨çš„è§’è‰²å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495575,"discussion_content":"æ˜¯è¿™æ ·åˆ¤æ–­çš„ï¼Œå°±æ˜¯çœ‹æ¶ˆè´¹è€…ä¸brokerçš„TCPè¿æ¥ä¸Šçš„å¾…å¤„ç†è¯·æ±‚çš„ä¸ªæ•°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589942860,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129265,"user_name":"è‡§èŒ","can_delete":false,"product_type":"c1","uid":1008692,"ip_address":"","ucode":"5505C1516EDFD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/64/34/03335c4a.jpg","comment_is_top":false,"comment_ctime":1567073830,"is_pvip":false,"replies":[{"id":"48162","content":"å’Œå®ƒè¦è®¢é˜…çš„topicåˆ†åŒºæ•°ä»¥åŠè¿™äº›åˆ†åŒºåœ¨brokerä¸Šçš„æ•£åˆ—æƒ…å†µæœ‰å…³ã€‚æ¯”å¦‚ä½ è®¢é˜…äº†100ä¸ªåˆ†åŒºï¼Œä½†è¿™ä¸ª100ä¸ªåˆ†åŒºçš„leaderå‰¯æœ¬éƒ½åœ¨ä¸€ä¸ªbrokerä¸Šï¼Œé‚£ä¹ˆé•¿æœŸæ¥çœ‹consumerä¹Ÿå°±åªå’Œè¿™1ä¸ªbrokerå»ºç«‹è¿æ¥ï¼›ç›¸åå¦‚æœè¿™100åˆ†åŒºæ•£åˆ—åœ¨100ä¸ªbrokerä¸Šï¼Œé‚£ä¹ˆé•¿æœŸæ¥çœ‹consumerä¼šå’Œ100ä¸ªbrokerç»´æŒé•¿è¿æ¥","user_name":"ä½œè€…å›å¤","comment_id":129265,"uid":"1288090","ip_address":"","utype":1,"ctime":1567125672,"user_name_real":"huxi_2b"}],"discussion_count":2,"race_medal":0,"score":"10157008422","product_id":100029201,"comment_content":"æˆ‘ä»¬è¦è®¾è®¡ä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿã€‚æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œæ›´å¥½çš„ä¸€ç§æ˜¯æ¯ç§ä¸åŒschemaçš„æ¶ˆæ¯å‘ä¸€ä¸ªtopicã€‚ä½†æ˜¯æœ‰ä¸€ç§æ‹…å¿ƒæ˜¯consumerä¼šä¸ºæ¯ä¸ªtopicå»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œé€ æˆè¿æ¥æ•°å¤ªå¤šã€‚è¯·é—®èƒ¡è€å¸ˆï¼Œkafka clientçš„consumeræ˜¯æ¯ä¸ªé›†ç¾¤å›ºå®šæ•°ç›®çš„tcpè¿æ¥ï¼Œè¿˜æ˜¯å’Œtopicæ•°ç›®ç›¸å…³ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465370,"discussion_content":"å’Œå®ƒè¦è®¢é˜…çš„topicåˆ†åŒºæ•°ä»¥åŠè¿™äº›åˆ†åŒºåœ¨brokerä¸Šçš„æ•£åˆ—æƒ…å†µæœ‰å…³ã€‚æ¯”å¦‚ä½ è®¢é˜…äº†100ä¸ªåˆ†åŒºï¼Œä½†è¿™ä¸ª100ä¸ªåˆ†åŒºçš„leaderå‰¯æœ¬éƒ½åœ¨ä¸€ä¸ªbrokerä¸Šï¼Œé‚£ä¹ˆé•¿æœŸæ¥çœ‹consumerä¹Ÿå°±åªå’Œè¿™1ä¸ªbrokerå»ºç«‹è¿æ¥ï¼›ç›¸åå¦‚æœè¿™100åˆ†åŒºæ•£åˆ—åœ¨100ä¸ªbrokerä¸Šï¼Œé‚£ä¹ˆé•¿æœŸæ¥çœ‹consumerä¼šå’Œ100ä¸ªbrokerç»´æŒé•¿è¿æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567125672,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008692,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/64/34/03335c4a.jpg","nickname":"è‡§èŒ","note":"","ucode":"5505C1516EDFD5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6804,"discussion_content":"ç›¸åŒçš„partitionåˆ†å¸ƒï¼Œtcpè¿æ¥æ•°ä¼šå’Œè¿™äº›partitionå±äºå¤šå°‘ä¸ªtopicæœ‰å…³å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567127076,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115696,"user_name":"rm -rf ğŸ˜Šà½²","can_delete":false,"product_type":"c1","uid":1070908,"ip_address":"","ucode":"BC448EC4206D95","user_header":"https://static001.geekbang.org/account/avatar/00/10/57/3c/081b89ec.jpg","comment_is_top":false,"comment_ctime":1563700099,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10153634691","product_id":100029201,"comment_content":"æˆ‘è®¤ä¸ºä¹Ÿæ˜¯3ä¸ªè¿æ¥ï¼Œç¬¬ä¸€ä¸ªæ˜¯æŸ¥æ‰¾Coordinatorçš„ï¼Œè¿™ä¸ªä¼šåœ¨åé¢æ–­å¼€ã€‚ç„¶å5ä¸ªpartitionä¼šåˆ†å¸ƒåœ¨2ä¸ªbrokerä¸Šï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯æœ€å¤šä¹Ÿå°±è¿æ¥2æ¬¡å°±èƒ½æ¶ˆè´¹æ‰€æœ‰partitionäº†ï¼Œå› æ­¤æ˜¯è¿æ¥3ä¸ªï¼Œæœ€åä¿æŒ2ä¸ªã€‚","like_count":2},{"had_liked":false,"id":237867,"user_name":"è‰ºè¶…(é²é¸£)","can_delete":false,"product_type":"c1","uid":1029436,"ip_address":"","ucode":"7F749FA543E0F1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg","comment_is_top":false,"comment_ctime":1595989429,"is_pvip":false,"replies":[{"id":"87879","content":"å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆç®¡ç†ã€‚å¦‚æœä¸€å®šè¦è¯´ç®¡ç†ï¼Œé€šè¿‡KafkaChannelå¯¹è±¡æ¥ç®¡ç†ã€‚","user_name":"ä½œè€…å›å¤","comment_id":237867,"uid":"1288090","ip_address":"","utype":1,"ctime":1596005105,"user_name_real":"èƒ¡å¤•"}],"discussion_count":2,"race_medal":0,"score":"5890956725","product_id":100029201,"comment_content":"è€å¸ˆå¥½ï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œç°åœ¨å¯¹äºproducerå’Œconsumeréƒ½ä»‹ç»äº†ç»´æŒtcpè¿æ¥çš„æƒ…å†µï¼Œé‚£ä¹ˆå¯¹äºkafkaé›†ç¾¤ brokeræ¥è¯´ï¼Œè¿™ä¹ˆå¤šçš„tcpè¿æ¥ï¼Œæ˜¯å¦‚ä½•ç®¡ç†çš„å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502571,"discussion_content":"å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆç®¡ç†ã€‚å¦‚æœä¸€å®šè¦è¯´ç®¡ç†ï¼Œé€šè¿‡KafkaChannelå¯¹è±¡æ¥ç®¡ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596005105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1029436,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b5/3c/967d7291.jpg","nickname":"è‰ºè¶…(é²é¸£)","note":"","ucode":"7F749FA543E0F1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294956,"discussion_content":"è°¢è°¢è€å¸ˆï¼Œé‚£ä¹ˆå•å’ŒèŠ‚ç‚¹ç®¡ç†é‚£ä¹ˆå¤šçš„é“¾æ¥ï¼Œä¼šæœ‰æ€§èƒ½çš„é—®é¢˜å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596036777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138063,"user_name":"ä¸¾ä¸ªè”æ","can_delete":false,"product_type":"c1","uid":1168195,"ip_address":"","ucode":"7F6B8EC3A3E0E1","user_header":"https://static001.geekbang.org/account/avatar/00/11/d3/43/f22b39c3.jpg","comment_is_top":false,"comment_ctime":1570004896,"is_pvip":false,"replies":[{"id":"53468","content":"å—¯å—¯ï¼Œå…¶å®è¿™é‡Œçš„æ¶ˆè´¹è€…ç«¯æŒ‡çš„æ˜¯å¹¿ä¹‰çš„æ¶ˆè´¹è€…ï¼Œæˆ‘æ˜¯æƒ³è¯´åœ¨Kafkaæ¶ˆè´¹è€…çš„æ¦‚å¿µä¸­æœ‰Coordinatorã€‚å½“ç„¶å¦‚ä½ æ‰€è¯´Coordinatoræ˜¯Brokerç«¯çš„ç»„ä»¶æ²¡é”™ã€‚è¿™é‡Œçš„ç¡®æœ‰ä¸ä¸¥è°¨çš„åœ°æ–¹ï¼Œå¤šè°¢æŒ‡å‡ºï¼šï¼‰","user_name":"ä½œè€…å›å¤","comment_id":138063,"uid":"1288090","ip_address":"","utype":1,"ctime":1570495568,"user_name_real":"huxi_2b"}],"discussion_count":1,"race_medal":0,"score":"5864972192","product_id":100029201,"comment_content":"è€å¸ˆï¼Œæƒ³é—®ä¸‹è¿™é‡Œæ˜¯ä¸æ˜¯ç¬”è¯¯ã€‚<br>è¿˜è®°å¾—æ¶ˆè´¹è€…ç«¯æœ‰ä¸ªç»„ä»¶å«Coordinatorå—ï¼Ÿåè°ƒè€…åº”è¯¥æ˜¯ä½äºBrokerç«¯çš„å§ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469369,"discussion_content":"å—¯å—¯ï¼Œå…¶å®è¿™é‡Œçš„æ¶ˆè´¹è€…ç«¯æŒ‡çš„æ˜¯å¹¿ä¹‰çš„æ¶ˆè´¹è€…ï¼Œæˆ‘æ˜¯æƒ³è¯´åœ¨Kafkaæ¶ˆè´¹è€…çš„æ¦‚å¿µä¸­æœ‰Coordinatorã€‚å½“ç„¶å¦‚ä½ æ‰€è¯´Coordinatoræ˜¯Brokerç«¯çš„ç»„ä»¶æ²¡é”™ã€‚è¿™é‡Œçš„ç¡®æœ‰ä¸ä¸¥è°¨çš„åœ°æ–¹ï¼Œå¤šè°¢æŒ‡å‡ºï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570495568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115888,"user_name":"å´å®‡æ™¨","can_delete":false,"product_type":"c1","uid":1199968,"ip_address":"","ucode":"F8F45B7067DF6D","user_header":"https://static001.geekbang.org/account/avatar/00/12/4f/60/049a20e9.jpg","comment_is_top":false,"comment_ctime":1563762187,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5858729483","product_id":100029201,"comment_content":"ä¸€ä¸ªè·å–å…ƒæ•°æ®çš„è¿æ¥ï¼ˆä¹‹åä¼šæ–­å¼€ï¼‰+ä¸¤ä¸ªè¿æ¥åˆ†åŒºleaderçš„è¿æ¥+ä¸€ä¸ªè¿æ¥åè°ƒè€…çš„è¿æ¥","like_count":1},{"had_liked":false,"id":115421,"user_name":"æ˜ç¿¼","can_delete":false,"product_type":"c1","uid":1068361,"ip_address":"","ucode":"E77F86BEB3D5C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/4d/49/28e73b9c.jpg","comment_is_top":false,"comment_ctime":1563586144,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5858553440","product_id":100029201,"comment_content":"è¿æ¥æœ‰ä¸‰ä¸ªé˜¶æ®µï¼šé¦–å…ˆè·å–åè°ƒè€…è¿æ¥åŒæ—¶ä¹Ÿè·å–å…ƒæ•°æ®ä¿¡æ¯ï¼Œè¿™ä¸ªè¿æ¥åé¢ä¼šå…³é—­ï¼›è¿æ¥åè°ƒè€…æ‰§è¡Œï¼Œç­‰å¾…åˆ†é…åˆ†åŒºï¼Œç»„åè°ƒç­‰ï¼Œè¿™éœ€è¦ä¸€ä¸ªè¿æ¥ï¼›åé¢çœŸæ­£æ¶ˆè´¹äº”ä¸ªåˆ†åŒºä¸¤ä¸ªbrokeræœ€å¤šå°±ä¸¤ä¸ªè¿æ¥ï¼Œåˆ†åŒºå¤§äºbrokeræ‰€ä»¥ä¸€å®šæ˜¯ä¸¤ä¸ªï¼Œå› ä¸ºç¬¬ä¸€ç±»è¿æ¥æ²¡æœ‰idï¼Œæ‰€ä»¥æ— æ³•é‡ç”¨ï¼Œä¼šåœ¨ç¬¬ä¸‰ç±»å¼€å¯è¿æ¥åå…³é—­ï¼Œæ‰€ä»¥å¼€å§‹å››ä¸ªè¿æ¥æœ€ç»ˆä¿æŒä¸‰ä¸ªè¿æ¥","like_count":1},{"had_liked":false,"id":115393,"user_name":"nightmare","can_delete":false,"product_type":"c1","uid":1056314,"ip_address":"","ucode":"EF2E51C2122A86","user_header":"https://static001.geekbang.org/account/avatar/00/10/1e/3a/5b21c01c.jpg","comment_is_top":false,"comment_ctime":1563555218,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5858522514","product_id":100029201,"comment_content":"3ä¸ªtcpè¿æ¥  ä¸€ä¸ªæŸ¥è¯¢åè°ƒç€å’Œè·å–å…ƒæ•°æ®çš„tcpè¿æ¥    ä¸€ä¸ªè¿æ¥åè°ƒå†™ ç®¡ç†ç»„æˆå‘˜çš„tcpè¿æ¥    ä¸»é¢˜5ä¸ªåˆ†åŒºåªæœ‰è¿æ¥leaderå‰¯æœ¬çš„brokeréœ€è¦åˆ›å»ºè¿æ¥","like_count":1},{"had_liked":false,"id":351162,"user_name":"ppd0705","can_delete":false,"product_type":"c1","uid":1155646,"ip_address":"","ucode":"EB63D4E3FD1E9A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKotsBr2icbYNYlRSlicGUD1H7lulSTQUAiclsEz9gnG5kCW9qeDwdYtlRMXic3V6sj9UrfKLPJnQojag/132","comment_is_top":false,"comment_ctime":1657584985,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1657584985","product_id":100029201,"comment_content":"è¯·é—®ä¸€ä¸‹å¦‚æœæ¶ˆè´¹å¤šä¸ªä¸»é¢˜ï¼Œé‚£ä¹ˆåŒä¸€ä¸ªBrokerä¸åŒä¸»é¢˜çš„åˆ†åŒºæ¶ˆæ¯æ˜¯å…±ç”¨è¿æ¥è¿˜æ˜¯å•ç‹¬çš„ï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œç¬¬ä¸‰ç±»è¿æ¥æ˜¯brokerçº§åˆ«è¿˜æ˜¯ä¸»é¢˜çº§åˆ«çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":330032,"user_name":"çˆ±å­¦ä¹ çš„å°å­¦ç”Ÿ","can_delete":false,"product_type":"c1","uid":1413556,"ip_address":"","ucode":"040AB71F0394F2","user_header":"https://static001.geekbang.org/account/avatar/00/15/91/b4/d5d9e4fb.jpg","comment_is_top":false,"comment_ctime":1641740467,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1641740467","product_id":100029201,"comment_content":"kafkaçš„close waitè¿‡å¤šå¯¼è‡´brokerè¶…æ—¶è¿™ä¸ªæœ‰å•¥ä¼˜åŒ–ä¹ˆ","like_count":0},{"had_liked":false,"id":314071,"user_name":"å‡¯æ–‡å°çŒª","can_delete":false,"product_type":"c1","uid":1980201,"ip_address":"","ucode":"36D8AD0229547F","user_header":"https://static001.geekbang.org/account/avatar/00/1e/37/29/b3af57a7.jpg","comment_is_top":false,"comment_ctime":1632824140,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632824140","product_id":100029201,"comment_content":"consumerçš„pollå…¶å®å°±æ˜¯ä¸ªlong pollingè¿™æ ·ç†è§£æˆ‘æ„Ÿè§‰å°±æ¸…æ¥šäº†","like_count":0},{"had_liked":false,"id":285565,"user_name":"Allan","can_delete":false,"product_type":"c1","uid":1310388,"ip_address":"","ucode":"8DA4DBECC2C45C","user_header":"https://static001.geekbang.org/account/avatar/00/13/fe/b4/295338e7.jpg","comment_is_top":false,"comment_ctime":1616900561,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616900561","product_id":100029201,"comment_content":"ç¬¬ä¸€ä¸ªé“¾æ¥å¯»æ‰¾åè°ƒå™¨ï¼Œç¬¬äºŒä¸ªé“¾æ¥é“¾æ¥åè°ƒå™¨è¿›è¡Œç®¡ç†ï¼Œå› ä¸ºæœ‰ä¸¤å°brokerç´¢å¼•éœ€è¦åˆ›å»ºä¸¤ä¸ªå®é™…æ¶ˆè´¹æ•°æ®ç”¨çš„é“¾æ¥ã€‚æ€»å…±å››ä¸ªé“¾æ¥ã€‚","like_count":0},{"had_liked":false,"id":268257,"user_name":"hpfish","can_delete":false,"product_type":"c1","uid":1217377,"ip_address":"","ucode":"86DB066E5B6D89","user_header":"https://static001.geekbang.org/account/avatar/00/12/93/61/3e4607c7.jpg","comment_is_top":false,"comment_ctime":1608115106,"is_pvip":false,"replies":[{"id":"97588","content":"æœ‰åŠæ³•é€šè¿‡åŸŸåè®¿é—®å—?","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1608516445,"ip_address":"","comment_id":268257,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1608115106","product_id":100029201,"comment_content":"è€å¸ˆï¼Œæˆ‘çš„kafkaéƒ¨åœ¨k8sä¸Šï¼Œç‰ˆæœ¬æ˜¯2.1.1ï¼Œæ¶ˆè´¹è€…é€šè¿‡serviceName+portçš„æ–¹å¼å»è®¿é—®ï¼Œä½†æ˜¯kafkaé‡å¯åPodçš„IPå˜äº†ï¼Œæ¶ˆè´¹è€…è¿å¾—è¿˜æ˜¯åŸæ¥çš„IPæœ‰ä»€ä¹ˆåŠæ³•å—","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511888,"discussion_content":"æœ‰åŠæ³•é€šè¿‡åŸŸåè®¿é—®å—?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608516445,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":261795,"user_name":"crud~boy","can_delete":false,"product_type":"c1","uid":2083659,"ip_address":"","ucode":"4DD62B9BA480D3","user_header":"","comment_is_top":false,"comment_ctime":1605526866,"is_pvip":false,"replies":[{"id":"95344","content":"é€šè¿‡ç›‘æµ‹è¿›ç¨‹å’Œç«¯å£å·ä¹Ÿå¯ä»¥åˆ¤æ–­å§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1605838655,"ip_address":"","comment_id":261795,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1605526866","product_id":100029201,"comment_content":"è€å¸ˆæˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦ç›‘æµ‹kafkaæ˜¯å¦å­˜æ´»ï¼Œç„¶åæœ‰ä¸€ä¸ªç¨‹åºæ²¡éš”1så°±é€šè¿‡tcpè¿æ¥kafkaï¼Œç„¶åæ–­å¼€ï¼è¿™æ ·ä¼šä¸ä¼šæŠŠkakfaè¿æ¥èµ„æºè€—å°½äº†å•Š","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509612,"discussion_content":"é€šè¿‡ç›‘æµ‹è¿›ç¨‹å’Œç«¯å£å·ä¹Ÿå¯ä»¥åˆ¤æ–­å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605838655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2083659,"avatar":"","nickname":"crud~boy","note":"","ucode":"4DD62B9BA480D3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":326140,"discussion_content":"ç°åœ¨çœ‹æ—¥å¿—æŠ¥é”™ï¼Œopen too many filesï¼Œæ¯éš”å‡ å¤©kafkaå°±æŠ¥é”™äº†ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605530770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":214184,"user_name":"çŸ³æ –","can_delete":false,"product_type":"c1","uid":1496443,"ip_address":"","ucode":"35600F645A479F","user_header":"https://static001.geekbang.org/account/avatar/00/16/d5/7b/c512da6a.jpg","comment_is_top":false,"comment_ctime":1588672051,"is_pvip":false,"replies":[{"id":"79343","content":"çœ‹ç€å¾ˆçœ¼ç†Ÿï¼Œåº”è¯¥æ˜¯2.3å·²ç»ä¿®å¤çš„bugã€‚ä½ çš„å®¢æˆ·ç«¯ä¹Ÿå‡çº§åˆ°2.3ç‰ˆæœ¬äº†å—ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1588725462,"ip_address":"","comment_id":214184,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1588672051","product_id":100029201,"comment_content":"èƒ¡è€å¸ˆï¼Œæ‚¨å¥½ã€‚æˆ‘è¿™è¾¹ç”¨çš„kafka 2.3 ã€‚Consumerä¸€ç›´å‡ºç°è¿™ä¸ªé”™è¯¯ä¿¡æ¯åœ¨æ—¥å¿—é‡Œé¢ï¼š2020-05-05 07:31:06.428  INFO 6 --- [ntainer#1-0-C-1] o.a.kafka.clients.FetchSessionHandler    : [Consumer clientId=consumer-4, groupId=test-collections] Node 1 was unable to process the fetch request with (sessionId=2065156504, epoch=1204): FETCH_SESSION_ID_NOT_FOUND. ä½†æ˜¯æˆ‘çœ‹logæ˜¯INFOçº§åˆ«çš„ï¼Œè¯·é—®æ˜¯ä¸æ˜¯å¯ä»¥å¿½ç•¥æ‰ï¼Ÿç½‘ä¸Šè¯´éœ€è¦ä¿®æ”¹brokerçš„max.incremental.fetch.session.cache.slotsï¼Œæœ‰å…¶ä»–åŠæ³•å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493977,"discussion_content":"çœ‹ç€å¾ˆçœ¼ç†Ÿï¼Œåº”è¯¥æ˜¯2.3å·²ç»ä¿®å¤çš„bugã€‚ä½ çš„å®¢æˆ·ç«¯ä¹Ÿå‡çº§åˆ°2.3ç‰ˆæœ¬äº†å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588725462,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1496443,"avatar":"https://static001.geekbang.org/account/avatar/00/16/d5/7b/c512da6a.jpg","nickname":"çŸ³æ –","note":"","ucode":"35600F645A479F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258991,"discussion_content":"æˆ‘ç”¨çš„æ˜¯Spring-kafka 2.2.3ï¼Œç„¶åkafka-clients 2.3.1","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588748863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172952,"user_name":"æˆç«‹-Charlie","can_delete":false,"product_type":"c1","uid":1091556,"ip_address":"","ucode":"2970BB5446B70A","user_header":"https://static001.geekbang.org/account/avatar/00/10/a7/e4/5a4515e9.jpg","comment_is_top":false,"comment_ctime":1579391914,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579391914","product_id":100029201,"comment_content":"4ä¸ª","like_count":0},{"had_liked":false,"id":159902,"user_name":"å¤§é¸¡è…¿","can_delete":false,"product_type":"c1","uid":1502174,"ip_address":"","ucode":"A93E0598D68252","user_header":"https://static001.geekbang.org/account/avatar/00/16/eb/de/087611a3.jpg","comment_is_top":false,"comment_ctime":1575821680,"is_pvip":false,"replies":[{"id":"61047","content":"ä¼šæœ‰çš„ï¼Œåªæ˜¯æš‚æ—¶è¿˜ä¸çŸ¥é“ID","user_name":"ä½œè€…å›å¤","user_name_real":"huxi_2b","uid":"1288090","ctime":1575851820,"ip_address":"","comment_id":159902,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575821680","product_id":100029201,"comment_content":"èƒ¡å¤§ä½¬ï¼Œé—®ä¸‹ &quot;å®ƒè¿æ¥çš„ Broker èŠ‚ç‚¹çš„ ID æ˜¯ -1ï¼Œè¡¨ç¤ºæ¶ˆè´¹è€…æ ¹æœ¬ä¸çŸ¥é“è¦è¿æ¥çš„ Kafka Broker çš„ä»»ä½•ä¿¡æ¯ã€‚&quot; è¿™è¾¹ä¼šæœ‰çœŸå®çš„brokeræœºå™¨ä¸ä¹‹å¯¹åº”å˜›ï¼Ÿ ","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477204,"discussion_content":"ä¼šæœ‰çš„ï¼Œåªæ˜¯æš‚æ—¶è¿˜ä¸çŸ¥é“ID","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575851820,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132109,"user_name":"å…”2ğŸ°ğŸƒ","can_delete":false,"product_type":"c1","uid":1096984,"ip_address":"","ucode":"1FEDA044BB6CBD","user_header":"https://static001.geekbang.org/account/avatar/00/10/bd/18/2af6bf4b.jpg","comment_is_top":false,"comment_ctime":1568023986,"is_pvip":false,"replies":[{"id":"50563","content":"å¦‚æœæ˜¯ä¸è€ƒè™‘æœºæ¶ä¿¡æ¯ï¼Œä½ åŸºæœ¬ä¸Šå¯ä»¥è®¤ä¸ºæ˜¯round robinç­–ç•¥","user_name":"ä½œè€…å›å¤","user_name_real":"huxi_2b","uid":"1288090","ctime":1568077774,"ip_address":"","comment_id":132109,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1568023986","product_id":100029201,"comment_content":"æœ‰2ä¸ª Brokerï¼Œ5ä¸ªåˆ†åŒºçš„é¢†å¯¼è€…å‰¯æœ¬ï¼Œç”±zookeeperåˆ†é…Leaderï¼Œæ‰€ä»¥é»˜è®¤æ˜¯å‡åŒ€çš„ï¼Œç¬¬ä¸‰ç±»ä¼šåˆ›å»º2ä¸ªTCPè¿æ¥ï¼Œæ•…å…±æœ‰4ä¸ªTCPè¿æ¥ã€‚<br>è¯·é—®èƒ¡è€å¸ˆ Leaderå‰¯æœ¬ åˆ†é…ç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466771,"discussion_content":"å¦‚æœæ˜¯ä¸è€ƒè™‘æœºæ¶ä¿¡æ¯ï¼Œä½ åŸºæœ¬ä¸Šå¯ä»¥è®¤ä¸ºæ˜¯round robinç­–ç•¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568077774,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119894,"user_name":"è½éœä¸å­¤é¹œ","can_delete":false,"product_type":"c1","uid":1111004,"ip_address":"","ucode":"1F06EB86DD2E6B","user_header":"https://static001.geekbang.org/account/avatar/00/10/f3/dc/e7e5c159.jpg","comment_is_top":false,"comment_ctime":1564721961,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1564721961","product_id":100029201,"comment_content":"æœ€ç»ˆä¼šä¿ç•™ä¸‰ä¸ªå§ï¼Œåè°ƒè€…é“¾æ¥éœ€è¦ä¸å…¶ä»–é“¾æ¥ç‰¹åœ°åˆ†å¼€ã€‚","like_count":0},{"had_liked":false,"id":116523,"user_name":"Hello world","can_delete":false,"product_type":"c1","uid":1333607,"ip_address":"","ucode":"4D2EF3034571B7","user_header":"https://static001.geekbang.org/account/avatar/00/14/59/67/f4ba1da4.jpg","comment_is_top":false,"comment_ctime":1563863469,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1563863469","product_id":100029201,"comment_content":"è€å¸ˆï¼Œå¦‚æœæ˜¯è°ƒç”¨consumer.createMessageStreams()è¿™ä¸ªæ–¹æ³•ï¼Œé‚£è¿™æ ·ä¹Ÿæ˜¯å»ºç«‹min(brokeræ•°ï¼Œåˆ†åŒºleaderæ•°)+1ä¸ªtcpè¿æ¥å—ï¼Ÿè¿˜æœ‰å»ºç«‹ä¸€ä¸ªè¿æ¥ä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹çš„å§ï¼Œæˆ‘çœ‹äº†æˆ‘çš„javaè¿›ç¨‹ä¸‹æœ‰å‡ åä¸ªçº¿ç¨‹,ä½†æ˜¯å¥½åƒä¹Ÿè¿œè¿œå¤§äºbrokerçš„æ•°é‡ã€‚","like_count":0,"discussions":[{"author":{"id":1956764,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/db/9c/f4116338.jpg","nickname":"CG","note":"","ucode":"4A2121D219DC14","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293578,"discussion_content":"è€å¸ˆæ‚¨å¥½ï¼Œåœ¨pollæ•°æ®é˜¶æ®µï¼Œå¦‚æœ10ä¸ªåˆ†åŒºï¼Œåˆ†å¸ƒåœ¨10ä¸ªbrokerä¸Šï¼Œconsumerä¼šå»ºç«‹10ä¸ªsocketè¿æ¥ï¼Œæƒ³é—®ä¸‹consumeræ˜¯å¹¶å‘çš„ä»è¿™10ä¸ªsocketä¸­å–æ•°æ®å—ï¼Œè¿˜æ˜¯ä¸²è¡Œçš„å»å–","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595586142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115830,"user_name":"30æ–¤çš„å¤§ç•ªè–¯","can_delete":false,"product_type":"c1","uid":1564545,"ip_address":"","ucode":"1C85FEE30B1CF2","user_header":"https://static001.geekbang.org/account/avatar/00/17/df/81/756f7a87.jpg","comment_is_top":false,"comment_ctime":1563755652,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1563755652","product_id":100029201,"comment_content":"è€å¸ˆæ‚¨å¥½ã€‚æˆ‘ä¹‹å‰æ­å»ºäº†ä¸€ä¸ªå•æœºkafkaï¼Œèƒ½æ­£å¸¸æ”¶å‘æ¶ˆæ¯ã€‚æœ€è¿‘æˆ‘æŒ‰ç½‘ä¸Šçš„ä»‹ç»ï¼ŒæŠŠkafkaæ”¹æˆé›†ç¾¤ï¼Œå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼šä½¿ç”¨kafkaè‡ªå¸¦çš„å‘½ä»¤è¡Œç”Ÿäº§è€…å·¥å…·å¯ä»¥æˆåŠŸå‘é€æ¶ˆæ¯ã€‚ä½†æ˜¯ç”¨å‘½ä»¤è¡Œæ¶ˆè´¹è€…å·¥å…·æ€»æ˜¯æ¥æ”¶ä¸åˆ°æ•°æ®ï¼ˆå¯åŠ¨æ¶ˆè´¹è€…ä¸€ç›´ä¸è¾“å‡ºæ•°æ®ï¼Œä»¿ä½›æ²¡æ”¶åˆ°æ¶ˆæ¯ä¸€æ ·ï¼‰ã€‚æˆ‘ç”¨straceè·Ÿè¸ªå‘ç°æ¶ˆè´¹è€…è¿›ç¨‹ä¸€åœ¨å¾ªç¯è¿›è¡Œepollï¼ˆè¶…æ—¶ï¼‰è°ƒç”¨ï¼ŒkafkaæœåŠ¡å™¨æ—¥å¿—æ— å¼‚å¸¸ã€‚è¯·é—®è¿™ç§æƒ…å†µè¦æ€ä¹ˆæ£€æŸ¥é—®é¢˜ã€‚","like_count":0,"discussions":[{"author":{"id":1246493,"avatar":"https://static001.geekbang.org/account/avatar/00/13/05/1d/018804ad.jpg","nickname":"æŠ›ç‰©çº¿","note":"","ucode":"46BD27D7BA8CE3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3189,"discussion_content":"æˆ‘ä¹‹å‰å¥½åƒé‡åˆ°äº†å’Œä½ ä¸€æ ·çš„é—®é¢˜ï¼Œæœ€åæ˜¯å› ä¸ºæˆ‘å¯åŠ¨æ¶ˆè´¹è€…çš„æ—¶å€™ï¼Œé…çš„broken serveræœ‰é—®é¢˜ï¼Œéœ€è¦ä¸»æœºååŠ ipï¼Œä½ å¯ä»¥å¯åŠ¨ä¸€ä¸ªJavaæ¶ˆè´¹è€…ç¨‹åºï¼Œdebugä¸€ä¸‹ï¼Œçœ‹èƒ½ä¸èƒ½è·å–åˆ°é›†ç¾¤å…ƒæ•°æ®ï¼Œæˆ‘ä¸Šæ¬¡è§£å†³å°±æ˜¯è¿™æ ·å‘ç°é—®é¢˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564286483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115533,"user_name":"æ¨é™†ä¼Ÿ","can_delete":false,"product_type":"c1","uid":1108457,"ip_address":"","ucode":"3BC968447406EB","user_header":"https://static001.geekbang.org/account/avatar/00/10/e9/e9/1f95e422.jpg","comment_is_top":false,"comment_ctime":1563613650,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1563613650","product_id":100029201,"comment_content":"æˆ‘è§‰å¾—æ˜¯3ä¸ªTCPè¿æ¥ï¼ŒæŸ¥æ‰¾åè°ƒè€…1ä¸ªè¿æ¥ï¼Œè¿æ¥ä¸¤ä¸ªBroker2ä¸ªè¿æ¥ï¼Œä¸”æŸ¥æ‰¾åè°ƒè€…çš„è¿æ¥æ…¢æ…¢ä¼šå…³é—­","like_count":0,"discussions":[{"author":{"id":1034204,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c7/dc/9408c8c2.jpg","nickname":"ban","note":"","ucode":"E523CE97E48266","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2445,"discussion_content":"è¿æ¥åè°ƒè€…çš„è¿æ¥ä¹Ÿç®—ä¸€ä¸ªå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563628602,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":115381,"user_name":"ç©ºçŸ¥","can_delete":false,"product_type":"c1","uid":1013283,"ip_address":"","ucode":"C448E98238DD36","user_header":"https://static001.geekbang.org/account/avatar/00/0f/76/23/31e5e984.jpg","comment_is_top":false,"comment_ctime":1563548161,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563548161","product_id":100029201,"comment_content":"åŒä¸€ä¸ªbroker ä¸€ä¸ªtopicä¸‹çš„åˆ†åŒºå¯ä»¥å¤ç”¨ä¸€ä¸ªè¿æ¥ ä½†æ˜¯topicçš„ä¸åŒåˆ†åŒºçš„ leader ä¸ä¸€å®šéƒ½åœ¨ä¸€ä¸ªbrokerä¸Š ä¹Ÿå°±æ˜¯æ¶ˆè´¹æ—¶å€™ åªæœ‰ä¸€ä¸ªbrokerä¸Šçš„tcpè¿æ¥èµ·ä½œç”¨","like_count":0}]}