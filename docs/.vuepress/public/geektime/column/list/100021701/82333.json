{"id":82333,"title":"29丨EM聚类（下）：用EM算法对王者荣耀英雄进行划分","content":"<p>今天我来带你进行EM的实战。上节课，我讲了EM算法的原理，EM算法相当于一个聚类框架，里面有不同的聚类模型，比如GMM高斯混合模型，或者HMM隐马尔科夫模型。其中你需要理解的是EM的两个步骤，E步和M步：E步相当于通过初始化的参数来估计隐含变量，M步是通过隐含变量来反推优化参数。最后通过EM步骤的迭代得到最终的模型参数。</p><p>今天我们进行EM算法的实战，你需要思考的是：</p><ul>\n<li>\n<p>如何使用EM算法工具完成聚类？</p>\n</li>\n<li>\n<p>什么情况下使用聚类算法？我们用聚类算法的任务目标是什么？</p>\n</li>\n<li>\n<p>面对王者荣耀的英雄数据，EM算法能帮助我们分析出什么？</p>\n</li>\n</ul><h2>如何使用EM工具包</h2><p>在Python中有第三方的EM算法工具包。由于EM算法是一个聚类框架，所以你需要明确你要用的具体算法，比如是采用GMM高斯混合模型，还是HMM隐马尔科夫模型。</p><p>这节课我们主要讲解GMM的使用，在使用前你需要引入工具包：</p><pre><code>\nfrom sklearn.mixture import GaussianMixture\n\n</code></pre><p>我们看下如何在sklearn中创建GMM聚类。</p><p>首先我们使用gmm = GaussianMixture(n_components=1, covariance_type=‘full’, max_iter=100)来创建GMM聚类，其中有几个比较主要的参数（GMM类的构造参数比较多，我筛选了一些主要的进行讲解），我分别来讲解下：</p><!-- [[[read_end]]] --><p>1.n_components：即高斯混合模型的个数，也就是我们要聚类的个数，默认值为1。如果你不指定n_components，最终的聚类结果都会为同一个值。</p><p>2.covariance_type：代表协方差类型。一个高斯混合模型的分布是由均值向量和协方差矩阵决定的，所以协方差的类型也代表了不同的高斯混合模型的特征。协方差类型有4种取值：</p><ul>\n<li>\n<p>covariance_type=full，代表完全协方差，也就是元素都不为0；</p>\n</li>\n<li>\n<p>covariance_type=tied，代表相同的完全协方差；</p>\n</li>\n<li>\n<p>covariance_type=diag，代表对角协方差，也就是对角不为0，其余为0；</p>\n</li>\n<li>\n<p>covariance_type=spherical，代表球面协方差，非对角为0，对角完全相同，呈现球面的特性。</p>\n</li>\n</ul><p>3.max_iter：代表最大迭代次数，EM算法是由E步和M步迭代求得最终的模型参数，这里可以指定最大迭代次数，默认值为100。</p><p>创建完GMM聚类器之后，我们就可以传入数据让它进行迭代拟合。</p><p>我们使用fit函数，传入样本特征矩阵，模型会自动生成聚类器，然后使用prediction=gmm.predict(data)来对数据进行聚类，传入你想进行聚类的数据，可以得到聚类结果prediction。</p><p>你能看出来拟合训练和预测可以传入相同的特征矩阵，这是因为聚类是无监督学习，你不需要事先指定聚类的结果，也无法基于先验的结果经验来进行学习。只要在训练过程中传入特征值矩阵，机器就会按照特征值矩阵生成聚类器，然后就可以使用这个聚类器进行聚类了。</p><h2>如何用EM算法对王者荣耀数据进行聚类</h2><p>了解了GMM聚类工具之后，我们看下如何对王者荣耀的英雄数据进行聚类。</p><p>首先我们知道聚类的原理是“人以群分，物以类聚”。通过聚类算法把特征值相近的数据归为一类，不同类之间的差异较大，这样就可以对原始数据进行降维。通过分成几个组（簇），来研究每个组之间的特性。或者我们也可以把组（簇）的数量适当提升，这样就可以找到可以互相替换的英雄，比如你的对手选择了你擅长的英雄之后，你可以选择另一个英雄作为备选。</p><p>我们先看下数据长什么样子：</p><p><img src=\"https://static001.geekbang.org/resource/image/3c/a0/3c4e14e7b33fc211f96fe0108f6196a0.png?wh=1726*396\" alt=\"\"><br>\n这里我们收集了69名英雄的20个特征属性，这些属性分别是最大生命、生命成长、初始生命、最大法力、法力成长、初始法力、最高物攻、物攻成长、初始物攻、最大物防、物防成长、初始物防、最大每5秒回血、每5秒回血成长、初始每5秒回血、最大每5秒回蓝、每5秒回蓝成长、初始每5秒回蓝、最大攻速和攻击范围等。</p><p>具体的数据集你可以在GitHub上下载：<a href=\"https://github.com/cystanford/EM_data\">https://github.com/cystanford/EM_data</a>。</p><p>现在我们需要对王者荣耀的英雄数据进行聚类，我们先设定项目的执行流程：</p><p><img src=\"https://static001.geekbang.org/resource/image/8a/78/8af94562f6bd3ac42036ec47f5ad2578.jpg?wh=2373*1087\" alt=\"\"></p><ol>\n<li>\n<p>首先我们需要加载数据源；</p>\n</li>\n<li>\n<p>在准备阶段，我们需要对数据进行探索，包括采用数据可视化技术，让我们对英雄属性以及这些属性之间的关系理解更加深刻，然后对数据质量进行评估，是否进行数据清洗，最后进行特征选择方便后续的聚类算法；</p>\n</li>\n<li>\n<p>聚类阶段：选择适合的聚类模型，这里我们采用GMM高斯混合模型进行聚类，并输出聚类结果，对结果进行分析。</p>\n</li>\n</ol><p>按照上面的步骤，我们来编写下代码。完整的代码如下：</p><pre><code># -*- coding: utf-8 -*-\nimport pandas as pd\nimport csv\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.mixture import GaussianMixture\nfrom sklearn.preprocessing import StandardScaler\n \n# 数据加载，避免中文乱码问题\ndata_ori = pd.read_csv('./heros7.csv', encoding = 'gb18030')\nfeatures = [u'最大生命',u'生命成长',u'初始生命',u'最大法力', u'法力成长',u'初始法力',u'最高物攻',u'物攻成长',u'初始物攻',u'最大物防',u'物防成长',u'初始物防', u'最大每5秒回血', u'每5秒回血成长', u'初始每5秒回血', u'最大每5秒回蓝', u'每5秒回蓝成长', u'初始每5秒回蓝', u'最大攻速', u'攻击范围']\ndata = data_ori[features]\n \n# 对英雄属性之间的关系进行可视化分析\n# 设置plt正确显示中文\nplt.rcParams['font.sans-serif']=['SimHei'] #用来正常显示中文标签\nplt.rcParams['axes.unicode_minus']=False #用来正常显示负号\n# 用热力图呈现features_mean字段之间的相关性\ncorr = data[features].corr()\nplt.figure(figsize=(14,14))\n# annot=True显示每个方格的数据\nsns.heatmap(corr, annot=True)\nplt.show()\n \n# 相关性大的属性保留一个，因此可以对属性进行降维\nfeatures_remain = [u'最大生命', u'初始生命', u'最大法力', u'最高物攻', u'初始物攻', u'最大物防', u'初始物防', u'最大每5秒回血', u'最大每5秒回蓝', u'初始每5秒回蓝', u'最大攻速', u'攻击范围']\ndata = data_ori[features_remain]\ndata[u'最大攻速'] = data[u'最大攻速'].apply(lambda x: float(x.strip('%'))/100)\ndata[u'攻击范围']=data[u'攻击范围'].map({'远程':1,'近战':0})\n# 采用Z-Score规范化数据，保证每个特征维度的数据均值为0，方差为1\nss = StandardScaler()\ndata = ss.fit_transform(data)\n# 构造GMM聚类\ngmm = GaussianMixture(n_components=30, covariance_type='full')\ngmm.fit(data)\n# 训练数据\nprediction = gmm.predict(data)\nprint(prediction)\n# 将分组结果输出到CSV文件中\ndata_ori.insert(0, '分组', prediction)\ndata_ori.to_csv('./hero_out.csv', index=False, sep=',')\n</code></pre><p>运行结果如下：</p><p><img src=\"https://static001.geekbang.org/resource/image/db/fb/dbe96b767d7f3ff2dd9f44b651cde8fb.png?wh=1729*1396\" alt=\"\"></p><pre><code>[28 14  8  9  5  5 15  8  3 14 18 14  9  7 16 18 13  3  5  4 19 12  4 12\n 12 12  4 17 24  2  7  2  2 24  2  2 24  6 20 22 22 24 24  2  2 22 14 20\n 14 24 26 29 27 25 25 28 11  1 23  5 11  0 10 28 21 29 29 29 17]\n</code></pre><p>同时你也能看到输出的聚类结果文件hero_out.csv（它保存在你本地运行的文件夹里，程序会自动输出这个文件，你可以自己看下）。</p><p>我来简单讲解下程序的几个模块。</p><p><strong>关于引用包</strong></p><p>首先我们会用DataFrame数据结构来保存读取的数据，最后的聚类结果会写入到CSV文件中，因此会用到pandas和CSV工具包。另外我们需要对数据进行可视化，采用热力图展现属性之间的相关性，这里会用到matplotlib.pyplot和seaborn工具包。在数据规范化中我们使用到了Z-Score规范化，用到了StandardScaler类，最后我们还会用到sklearn中的GaussianMixture类进行聚类。</p><p><strong>数据可视化的探索</strong></p><p>你能看到我们将20个英雄属性之间的关系用热力图呈现了出来，中间的数字代表两个属性之间的关系系数，最大值为1，代表完全正相关，关系系数越大代表相关性越大。从图中你能看出来“最大生命”“生命成长”和“初始生命”这三个属性的相关性大，我们只需要保留一个属性即可。同理我们也可以对其他相关性大的属性进行筛选，保留一个。你在代码中可以看到，我用features_remain数组保留了特征选择的属性，这样就将原本的20个属性降维到了13个属性。</p><p><strong>关于数据规范化</strong></p><p>我们能看到“最大攻速”这个属性值是百分数，不适合做矩阵运算，因此我们需要将百分数转化为小数。我们也看到“攻击范围”这个字段的取值为远程或者近战，也不适合矩阵运算，我们将取值做个映射，用1代表远程，0代表近战。然后采用Z-Score规范化，对特征矩阵进行规范化。</p><p><strong>在聚类阶段</strong></p><p>我们采用了GMM高斯混合模型，并将结果输出到CSV文件中。</p><p>这里我将输出的结果截取了一段（设置聚类个数为30）：</p><p><img src=\"https://static001.geekbang.org/resource/image/5c/ce/5c74ffe6741f1bf1bfdf7711932d47ce.png?wh=1262*446\" alt=\"\"><br>\n第一列代表的是分组（簇），我们能看到张飞、程咬金分到了一组，牛魔、白起是一组，老夫子自己是一组，达摩、典韦是一组。聚类的特点是相同类别之间的属性值相近，不同类别的属性值差异大。因此如果你擅长用典韦这个英雄，不防试试达摩这个英雄。同样你也可以在张飞和程咬金中进行切换。这样就算你的英雄被别人选中了，你依然可以有备选的英雄可以使用。</p><h2>总结</h2><p>今天我带你一起做了EM聚类的实战，具体使用的是GMM高斯混合模型。从整个流程中可以看出，我们需要经过数据加载、数据探索、数据可视化、特征选择、GMM聚类和结果分析等环节。</p><p>聚类和分类不一样，聚类是无监督的学习方式，也就是我们没有实际的结果可以进行比对，所以聚类的结果评估不像分类准确率一样直观，那么有没有聚类结果的评估方式呢？这里我们可以采用Calinski-Harabaz指标，代码如下：</p><pre><code>from sklearn.metrics import calinski_harabaz_score\nprint(calinski_harabaz_score(data, prediction))\n</code></pre><p>指标分数越高，代表聚类效果越好，也就是相同类中的差异性小，不同类之间的差异性大。当然具体聚类的结果含义，我们需要人工来分析，也就是当这些数据被分成不同的类别之后，具体每个类表代表的含义。</p><p>另外聚类算法也可以作为其他数据挖掘算法的预处理阶段，这样我们就可以将数据进行降维了。</p><p><img src=\"https://static001.geekbang.org/resource/image/43/d7/43b35b8f49ac83799ea1ca88383609d7.png?wh=1729*984\" alt=\"\"><br>\n最后依然是两道思考题。针对王者荣耀的英雄数据集，我进行了特征选择，实际上王者荣耀的英雄数量并不多，我们可以省略特征选择这个阶段，你不妨用全部的特征值矩阵进行聚类训练，来看下聚类得到的结果。第二个问题是，依然用王者荣耀英雄数据集，在聚类个数为3以及聚类个数为30的情况下，请你使用GMM高斯混合模型对数据集进行聚类，并得出Calinski_Harabaz分数。</p><p>欢迎在评论区与我分享你的答案，也欢迎点击“请朋友读”，把这篇文章分享给你的朋友或者同事。</p><p></p>","comments":[{"had_liked":false,"id":68266,"user_name":"哆哩咪fa👻","can_delete":false,"product_type":"c1","uid":1426563,"ip_address":"","ucode":"B70DF62E91F172","user_header":"https://static001.geekbang.org/account/avatar/00/15/c4/83/d1c4237a.jpg","comment_is_top":false,"comment_ctime":1550472382,"is_pvip":false,"replies":[{"id":64542,"content":"找运营加微信群","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577621489,"ip_address":"","comment_id":68266,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"才买的课，请问有vx群或者可以相互沟通的群么","like_count":15},{"had_liked":false,"id":80668,"user_name":"高桥凉瓜","can_delete":false,"product_type":"c1","uid":1220666,"ip_address":"","ucode":"2E10283BF25B4F","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/3a/312ce1b7.jpg","comment_is_top":false,"comment_ctime":1553696621,"is_pvip":false,"replies":[{"id":64348,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577617351,"ip_address":"","comment_id":80668,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"之所以热力图不显示最大攻速和攻击范围，是因为这两列的数据的类型是string，想要在热力图也显示这两项的话可以在构建热力图前就进行数据清洗：\n```\ndata[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;))&#47;100)\ndata[u&#39;攻击范围&#39;]=data[u&#39;攻击范围&#39;].map({&#39;远程&#39;:1,&#39;近战&#39;:0})\n```","like_count":11,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439598,"discussion_content":"找运营加微信群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1738003,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/85/13/6bb2f004.jpg","nickname":"黄尚儒","note":"","ucode":"2EAF6386133292","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394189,"discussion_content":"问了公众号，说没有啊。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631775014,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1903793,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/0c/b1/182f2f08.jpg","nickname":"dUb","note":"","ucode":"9F86CF263CD0BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":262522,"discussion_content":"进不了群啊\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589109566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1674204,"avatar":"https://static001.geekbang.org/account/avatar/00/19/8b/dc/925e0f8a.jpg","nickname":"换个调调","note":"","ucode":"F781C8EBB6D529","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202326,"discussion_content":"怎么加微信群呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583897246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1014106,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/79/5a/ae8f8ac2.jpg","nickname":"小南天门","note":"","ucode":"D2B2A83248CF62","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1674204,"avatar":"https://static001.geekbang.org/account/avatar/00/19/8b/dc/925e0f8a.jpg","nickname":"换个调调","note":"","ucode":"F781C8EBB6D529","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":240156,"discussion_content":"运营在哪","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587344027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":202326,"ip_address":"","group_id":0},"score":240156,"extra":""}]}]},{"had_liked":false,"id":68594,"user_name":"許敲敲","can_delete":false,"product_type":"c1","uid":1046681,"ip_address":"","ucode":"6486466820E7BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg","comment_is_top":false,"comment_ctime":1550552583,"is_pvip":false,"replies":[{"id":24451,"content":"嗯 中文的话需要需要注意这个。","user_name":"编辑回复","user_name_real":"何昌梅","uid":1165037,"ctime":1550632520,"ip_address":"","comment_id":68594,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"最后一个 data_to_csv()也最好加上encoding=&#39;gb18030&#39;;不然会乱码","like_count":7,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444938,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577617351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1298468,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOc0n02eNKflX5ey4TYl1NBfb0kicc20AgayEAGDYylalqHnLTeqMnaJ2iaZsLVmqEo0T0YViadU9Ig/132","nickname":"lianlian","note":"","ucode":"79B48B38259097","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":397038,"discussion_content":"棒棒","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632546777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68143,"user_name":"从未在此","can_delete":false,"product_type":"c1","uid":1354589,"ip_address":"","ucode":"5A4AA275D8EE9A","user_header":"https://static001.geekbang.org/account/avatar/00/14/ab/5d/430ed3b6.jpg","comment_is_top":false,"comment_ctime":1550448567,"is_pvip":false,"replies":[{"id":24450,"content":"相关性比较大的时候，可以任意选择其中一个，因为这些指标相关性比较大，所以你选择哪一个其实结果都相差不大。当然对于相关性比较大，不同人的理解是不同的额，比如你可以定义相关性大于0.9或者相关性大于0.8。","user_name":"编辑回复","user_name_real":"何昌梅","uid":1165037,"ctime":1550632469,"ip_address":"","comment_id":68143,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"问下老师，当几个特征相关性较大时，怎么选择最具有代表性的那个呢","like_count":4,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439744,"discussion_content":"嗯 中文的话需要需要注意这个。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550632520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89958,"user_name":"周飞","can_delete":false,"product_type":"c1","uid":1073374,"ip_address":"","ucode":"F85FA236EB0C0D","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg","comment_is_top":false,"comment_ctime":1556349365,"is_pvip":false,"replies":[{"id":64216,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577614416,"ip_address":"","comment_id":89958,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"1.不做特征选择的情况下，得到的Calinski_Harabaz 分数 大约是 23.1530273621 ,做特征选择的情况下 大约是：21.2142191471.\n2.聚类个数为3的时候 Calinski_Harabaz 分数 大约是 22.9119297953 。聚类个数为30的时候 Calinski_Harabaz 分数 大约是 21.2142191471","like_count":2,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439535,"discussion_content":"相关性比较大的时候，可以任意选择其中一个，因为这些指标相关性比较大，所以你选择哪一个其实结果都相差不大。当然对于相关性比较大，不同人的理解是不同的额，比如你可以定义相关性大于0.9或者相关性大于0.8。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550632469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68148,"user_name":"从未在此","can_delete":false,"product_type":"c1","uid":1354589,"ip_address":"","ucode":"5A4AA275D8EE9A","user_header":"https://static001.geekbang.org/account/avatar/00/14/ab/5d/430ed3b6.jpg","comment_is_top":false,"comment_ctime":1550448746,"is_pvip":false,"replies":[{"id":24449,"content":"非数值的类型需要先转化为数值类型，比如“远程”转化为1，“近战”转化为0。这样才能做矩阵的运算。","user_name":"编辑回复","user_name_real":"何昌梅","uid":1165037,"ctime":1550632457,"ip_address":"","comment_id":68148,"utype":2}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"还有，非数值型的特征怎么进行聚类？","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448336,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2917819,"avatar":"","nickname":"Geek_35a6a8","note":"","ucode":"E8EC58E33079C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572729,"discussion_content":"聚类3个的时候只有13分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652938962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":273277,"user_name":"McKee Chen","can_delete":false,"product_type":"c1","uid":2037505,"ip_address":"","ucode":"F74B76542FAB65","user_header":"https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg","comment_is_top":false,"comment_ctime":1610521788,"is_pvip":false,"replies":[{"id":100866,"content":"加油 总结的不错","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1612705129,"ip_address":"","comment_id":273277,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"分别针对以下三种情况进行聚类操作，得到的Calinski_Harabaz 分数分别为：\n1.使用所有特征数，聚类类别为30，得分为33.286020580818494\n2.特征数降维处理后，聚类类别为30，得分为27.964658388803077\n3.特征数降维处理后，聚类类别为3，得分为19.358008332914284\n\n根据以上结果，可以总结出：当聚类类别数相同时，特征数越多，聚类效果越好；当进行特征数降维处理时，聚类类别数越多，聚类效果越好","like_count":1,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513551,"discussion_content":"加油 总结的不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612705129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207213,"user_name":"Ricky","can_delete":false,"product_type":"c1","uid":1940971,"ip_address":"","ucode":"0BC8F8DB52F01D","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9d/eb/2c7f3d3b.jpg","comment_is_top":false,"comment_ctime":1587025375,"is_pvip":false,"replies":[{"id":104214,"content":"CH指标通过计算类中各点与类中心的距离平方和来度量类内的紧密度，通过计算各类中心点与数据集中心点距离平方和来度量数据集的分离度，CH指标由分离度与紧密度的比值得到。从而，CH值越大代表着类自身越紧密，类与类之间越分散，即聚类结果的更优。","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617727083,"ip_address":"","comment_id":207213,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"问个问题：关于calinski_harabaz_score的使用，同一套样本数据，用不同的模型计算prediction后，对比值得大小么？\n谢谢！","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513551,"discussion_content":"加油 总结的不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612705129,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204699,"user_name":"Simon","can_delete":false,"product_type":"c1","uid":1914504,"ip_address":"","ucode":"A8A2E3E57BD029","user_header":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","comment_is_top":false,"comment_ctime":1586443709,"is_pvip":false,"replies":[{"id":104322,"content":"是的。如果特征取值范围已经在0~1之间，确实无需再进行数据规范化","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617894603,"ip_address":"","comment_id":204699,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"&#39;攻击范围&#39; 特征进行映射为0,1后，是不是可以不用z-score了？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491254,"discussion_content":"是的。如果特征取值范围已经在0~1之间，确实无需再进行数据规范化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617894603,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173762,"user_name":"groot888","can_delete":false,"product_type":"c1","uid":1266597,"ip_address":"","ucode":"50E50681D6BE0C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/oseia6IjJIPziamTI2EQ0Bpr8icUicXTea2UuH105t4Bia4yFwBHld49cIQbjORvDdTtMCVdL39H9WxFwzyXspqqHUg/132","comment_is_top":false,"comment_ctime":1579681129,"is_pvip":false,"replies":[{"id":104019,"content":"可以尝试。或者如果两个特征相关系数= ±1，这种情况称为多重共线性，可以考虑去掉一个特征。","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617294277,"ip_address":"","comment_id":173762,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"热力图展现出来，相关的分数大，是不是也可以当做一种聚类算法。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491254,"discussion_content":"是的。如果特征取值范围已经在0~1之间，确实无需再进行数据规范化","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617894603,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68266,"user_name":"哆哩咪fa👻","can_delete":false,"product_type":"c1","uid":1426563,"ip_address":"","ucode":"B70DF62E91F172","user_header":"https://static001.geekbang.org/account/avatar/00/15/c4/83/d1c4237a.jpg","comment_is_top":false,"comment_ctime":1550472382,"is_pvip":false,"replies":[{"id":64542,"content":"找运营加微信群","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577621489,"ip_address":"","comment_id":68266,"utype":1}],"discussion_count":5,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"才买的课，请问有vx群或者可以相互沟通的群么","like_count":15,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439598,"discussion_content":"找运营加微信群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577621489,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1738003,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/85/13/6bb2f004.jpg","nickname":"黄尚儒","note":"","ucode":"2EAF6386133292","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394189,"discussion_content":"问了公众号，说没有啊。。。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631775014,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1903793,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/0c/b1/182f2f08.jpg","nickname":"dUb","note":"","ucode":"9F86CF263CD0BC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":262522,"discussion_content":"进不了群啊\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589109566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1674204,"avatar":"https://static001.geekbang.org/account/avatar/00/19/8b/dc/925e0f8a.jpg","nickname":"换个调调","note":"","ucode":"F781C8EBB6D529","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202326,"discussion_content":"怎么加微信群呢","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583897246,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1014106,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/79/5a/ae8f8ac2.jpg","nickname":"小南天门","note":"","ucode":"D2B2A83248CF62","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1674204,"avatar":"https://static001.geekbang.org/account/avatar/00/19/8b/dc/925e0f8a.jpg","nickname":"换个调调","note":"","ucode":"F781C8EBB6D529","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":240156,"discussion_content":"运营在哪","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587344027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":202326,"ip_address":"","group_id":0},"score":240156,"extra":""}]}]},{"had_liked":false,"id":80668,"user_name":"高桥凉瓜","can_delete":false,"product_type":"c1","uid":1220666,"ip_address":"","ucode":"2E10283BF25B4F","user_header":"https://static001.geekbang.org/account/avatar/00/12/a0/3a/312ce1b7.jpg","comment_is_top":false,"comment_ctime":1553696621,"is_pvip":false,"replies":[{"id":64348,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577617351,"ip_address":"","comment_id":80668,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"之所以热力图不显示最大攻速和攻击范围，是因为这两列的数据的类型是string，想要在热力图也显示这两项的话可以在构建热力图前就进行数据清洗：\n```\ndata[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;))&#47;100)\ndata[u&#39;攻击范围&#39;]=data[u&#39;攻击范围&#39;].map({&#39;远程&#39;:1,&#39;近战&#39;:0})\n```","like_count":11,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444938,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577617351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1298468,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJOc0n02eNKflX5ey4TYl1NBfb0kicc20AgayEAGDYylalqHnLTeqMnaJ2iaZsLVmqEo0T0YViadU9Ig/132","nickname":"lianlian","note":"","ucode":"79B48B38259097","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":397038,"discussion_content":"棒棒","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632546777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68594,"user_name":"許敲敲","can_delete":false,"product_type":"c1","uid":1046681,"ip_address":"","ucode":"6486466820E7BF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f8/99/8e760987.jpg","comment_is_top":false,"comment_ctime":1550552583,"is_pvip":false,"replies":[{"id":24451,"content":"嗯 中文的话需要需要注意这个。","user_name":"编辑回复","user_name_real":"何昌梅","uid":1165037,"ctime":1550632520,"ip_address":"","comment_id":68594,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"最后一个 data_to_csv()也最好加上encoding=&#39;gb18030&#39;;不然会乱码","like_count":7,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439744,"discussion_content":"嗯 中文的话需要需要注意这个。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550632520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68143,"user_name":"从未在此","can_delete":false,"product_type":"c1","uid":1354589,"ip_address":"","ucode":"5A4AA275D8EE9A","user_header":"https://static001.geekbang.org/account/avatar/00/14/ab/5d/430ed3b6.jpg","comment_is_top":false,"comment_ctime":1550448567,"is_pvip":false,"replies":[{"id":24450,"content":"相关性比较大的时候，可以任意选择其中一个，因为这些指标相关性比较大，所以你选择哪一个其实结果都相差不大。当然对于相关性比较大，不同人的理解是不同的额，比如你可以定义相关性大于0.9或者相关性大于0.8。","user_name":"编辑回复","user_name_real":"何昌梅","uid":1165037,"ctime":1550632469,"ip_address":"","comment_id":68143,"utype":2}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"问下老师，当几个特征相关性较大时，怎么选择最具有代表性的那个呢","like_count":4,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439535,"discussion_content":"相关性比较大的时候，可以任意选择其中一个，因为这些指标相关性比较大，所以你选择哪一个其实结果都相差不大。当然对于相关性比较大，不同人的理解是不同的额，比如你可以定义相关性大于0.9或者相关性大于0.8。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550632469,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":89958,"user_name":"周飞","can_delete":false,"product_type":"c1","uid":1073374,"ip_address":"","ucode":"F85FA236EB0C0D","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/de/5c67895a.jpg","comment_is_top":false,"comment_ctime":1556349365,"is_pvip":false,"replies":[{"id":64216,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577614416,"ip_address":"","comment_id":89958,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"1.不做特征选择的情况下，得到的Calinski_Harabaz 分数 大约是 23.1530273621 ,做特征选择的情况下 大约是：21.2142191471.\n2.聚类个数为3的时候 Calinski_Harabaz 分数 大约是 22.9119297953 。聚类个数为30的时候 Calinski_Harabaz 分数 大约是 21.2142191471","like_count":2,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":448336,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577614416,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2917819,"avatar":"","nickname":"Geek_35a6a8","note":"","ucode":"E8EC58E33079C0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572729,"discussion_content":"聚类3个的时候只有13分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652938962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68148,"user_name":"从未在此","can_delete":false,"product_type":"c1","uid":1354589,"ip_address":"","ucode":"5A4AA275D8EE9A","user_header":"https://static001.geekbang.org/account/avatar/00/14/ab/5d/430ed3b6.jpg","comment_is_top":false,"comment_ctime":1550448746,"is_pvip":false,"replies":[{"id":24449,"content":"非数值的类型需要先转化为数值类型，比如“远程”转化为1，“近战”转化为0。这样才能做矩阵的运算。","user_name":"编辑回复","user_name_real":"何昌梅","uid":1165037,"ctime":1550632457,"ip_address":"","comment_id":68148,"utype":2}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"还有，非数值型的特征怎么进行聚类？","like_count":2,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439537,"discussion_content":"非数值的类型需要先转化为数值类型，比如“远程”转化为1，“近战”转化为0。这样才能做矩阵的运算。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550632457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1914504,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","nickname":"Simon","note":"","ucode":"A8A2E3E57BD029","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224904,"discussion_content":"算法之前，所有非数值型特征都要数值化。这在数据清洗阶段完成。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586336693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":273277,"user_name":"McKee Chen","can_delete":false,"product_type":"c1","uid":2037505,"ip_address":"","ucode":"F74B76542FAB65","user_header":"https://static001.geekbang.org/account/avatar/00/1f/17/01/1c5309a3.jpg","comment_is_top":false,"comment_ctime":1610521788,"is_pvip":false,"replies":[{"id":100866,"content":"加油 总结的不错","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1612705129,"ip_address":"","comment_id":273277,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"分别针对以下三种情况进行聚类操作，得到的Calinski_Harabaz 分数分别为：\n1.使用所有特征数，聚类类别为30，得分为33.286020580818494\n2.特征数降维处理后，聚类类别为30，得分为27.964658388803077\n3.特征数降维处理后，聚类类别为3，得分为19.358008332914284\n\n根据以上结果，可以总结出：当聚类类别数相同时，特征数越多，聚类效果越好；当进行特征数降维处理时，聚类类别数越多，聚类效果越好","like_count":1,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439537,"discussion_content":"非数值的类型需要先转化为数值类型，比如“远程”转化为1，“近战”转化为0。这样才能做矩阵的运算。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550632457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1914504,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","nickname":"Simon","note":"","ucode":"A8A2E3E57BD029","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224904,"discussion_content":"算法之前，所有非数值型特征都要数值化。这在数据清洗阶段完成。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586336693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":207213,"user_name":"Ricky","can_delete":false,"product_type":"c1","uid":1940971,"ip_address":"","ucode":"0BC8F8DB52F01D","user_header":"https://static001.geekbang.org/account/avatar/00/1d/9d/eb/2c7f3d3b.jpg","comment_is_top":false,"comment_ctime":1587025375,"is_pvip":false,"replies":[{"id":104214,"content":"CH指标通过计算类中各点与类中心的距离平方和来度量类内的紧密度，通过计算各类中心点与数据集中心点距离平方和来度量数据集的分离度，CH指标由分离度与紧密度的比值得到。从而，CH值越大代表着类自身越紧密，类与类之间越分散，即聚类结果的更优。","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617727083,"ip_address":"","comment_id":207213,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"问个问题：关于calinski_harabaz_score的使用，同一套样本数据，用不同的模型计算prediction后，对比值得大小么？\n谢谢！","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492044,"discussion_content":"CH指标通过计算类中各点与类中心的距离平方和来度量类内的紧密度，通过计算各类中心点与数据集中心点距离平方和来度量数据集的分离度，CH指标由分离度与紧密度的比值得到。从而，CH值越大代表着类自身越紧密，类与类之间越分散，即聚类结果的更优。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617727083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":204699,"user_name":"Simon","can_delete":false,"product_type":"c1","uid":1914504,"ip_address":"","ucode":"A8A2E3E57BD029","user_header":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","comment_is_top":false,"comment_ctime":1586443709,"is_pvip":false,"replies":[{"id":104322,"content":"是的。如果特征取值范围已经在0~1之间，确实无需再进行数据规范化","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617894603,"ip_address":"","comment_id":204699,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"&#39;攻击范围&#39; 特征进行映射为0,1后，是不是可以不用z-score了？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":492044,"discussion_content":"CH指标通过计算类中各点与类中心的距离平方和来度量类内的紧密度，通过计算各类中心点与数据集中心点距离平方和来度量数据集的分离度，CH指标由分离度与紧密度的比值得到。从而，CH值越大代表着类自身越紧密，类与类之间越分散，即聚类结果的更优。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617727083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173762,"user_name":"groot888","can_delete":false,"product_type":"c1","uid":1266597,"ip_address":"","ucode":"50E50681D6BE0C","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/oseia6IjJIPziamTI2EQ0Bpr8icUicXTea2UuH105t4Bia4yFwBHld49cIQbjORvDdTtMCVdL39H9WxFwzyXspqqHUg/132","comment_is_top":false,"comment_ctime":1579681129,"is_pvip":false,"replies":[{"id":104019,"content":"可以尝试。或者如果两个特征相关系数= ±1，这种情况称为多重共线性，可以考虑去掉一个特征。","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1617294277,"ip_address":"","comment_id":173762,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100021701,"comment_content":"热力图展现出来，相关的分数大，是不是也可以当做一种聚类算法。","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482199,"discussion_content":"可以尝试。或者如果两个特征相关系数= ±1，这种情况称为多重共线性，可以考虑去掉一个特征。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617294277,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1914504,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","nickname":"Simon","note":"","ucode":"A8A2E3E57BD029","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224910,"discussion_content":"不行哦，这里的相关是两个属性的相关，最终的聚类是样本层面的（样本相关）。不在一个层面上考虑问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586337032,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87843,"user_name":"滢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1555729433,"is_pvip":false,"replies":[{"id":64237,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577615038,"ip_address":"","comment_id":87843,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"全部特征，聚类个数为3个：\n[0 0 2 0 2 2 2 2 0 0 0 0 0 0 0 0 0 0 2 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1\n 1 0 1 1 1 1 1 1 1 0 0 0 1 2 0 2 0 0 0 0 0 1 2 0 2 2 0 2 1 1 0 1]\n22.91192979526994\n全部特征：聚类个数为30个\n[16 12 11 13  2  2 19 11  3 12 15 12 13  8 24 15 25 13 21 27 26  7 27  7\n  7  7 27 22 28  1  8  1 29 28  1  1 28  6 20 18 29 28 28  1 28 18 12 20\n 12 28 17 14 21  4  4 16  0 12 23 21  0  5  9 16 10 14 14 16 22]\n22.211084900636873","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447622,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79255,"user_name":"hlz-123","can_delete":false,"product_type":"c1","uid":1433586,"ip_address":"","ucode":"B7E5EF0C260BD2","user_header":"","comment_is_top":false,"comment_ctime":1553418050,"is_pvip":false,"replies":[{"id":64367,"content":"也算是正常","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577617847,"ip_address":"","comment_id":79255,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"老师，同一程序每次运行结果不一样，有时赵云和孙悟空聚在一类，有时赵云和兰陵王聚在一类，这种情况正常吗？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444418,"discussion_content":"也算是正常","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577617847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71723,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1551420497,"is_pvip":false,"replies":[{"id":64485,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577619938,"ip_address":"","comment_id":71723,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\nimport sys\nreload(sys)\nsys.setdefaultencoding(&#39;utf8&#39;)\n\nimport pandas as pd\nimport csv\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.mixture import GaussianMixture\nfrom sklearn.preprocessing import StandardScaler\n\n# 数据加载，避免中文乱码问题\ndata_ori = pd.read_csv(&#39;.&#47;heros.csv&#39;, encoding=&#39;gb18030&#39;)\nfeatures = [u&#39;最大生命&#39;, u&#39;生命成长&#39;, u&#39;初始生命&#39;, u&#39;最大法力&#39;, u&#39;法力成长&#39;, u&#39;初始法力&#39;, u&#39;最高物攻&#39;, u&#39;物攻成长&#39;, u&#39;初始物攻&#39;, u&#39;最大物防&#39;, u&#39;物防成长&#39;, u&#39;初始物防&#39;,\n            u&#39;最大每5秒回血&#39;, u&#39;每5秒回血成长&#39;, u&#39;初始每5秒回血&#39;, u&#39;最大每5秒回蓝&#39;, u&#39;每5秒回蓝成长&#39;, u&#39;初始每5秒回蓝&#39;, u&#39;最大攻速&#39;, u&#39;攻击范围&#39;]\ndata = data_ori[features]\n\n# 对英雄属性之间的关系进行可视化分析\n# 设置 plt 正确显示中文\nplt.rcParams[&#39;font.sans-serif&#39;] = [&#39;SimHei&#39;]  # 用来正常显示中文标签\nplt.rcParams[&#39;axes.unicode_minus&#39;] = False  # 用来正常显示负号\n# 用热力图呈现 features_mean 字段之间的相关性\ncorr = data[features].corr()\nplt.figure(figsize=(14, 14))\n# annot=True 显示每个方格的数据\nsns.heatmap(corr, annot=True)\nplt.show()\n\npd.set_option(&#39;mode.chained_assignment&#39;, None)\ndata[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;)) &#47; 100)\ndata[u&#39;攻击范围&#39;] = data[u&#39;攻击范围&#39;].map({u&#39;远程&#39;: 1, u&#39;近战&#39;: 0})\n\n# 采用 Z-Score 规范化数据，保证每个特征维度的数据均值为 0，方差为 1\nss = StandardScaler()\ndata = ss.fit_transform(data)\n\n#print(data)\n\n# 构造 GMM 聚类\ngmm = GaussianMixture(n_components=3, covariance_type=&#39;full&#39;)\ngmm.fit(data)\n# 训练数据\nprediction = gmm.predict(data)\nprint(prediction)\n\n# 将分组结果输出到 CSV 文件中\ndata_ori.insert(0, &#39;分组&#39;, prediction)\ndata_ori.to_csv(&#39;.&#47;hero_out2.csv&#39;, index=False, sep=&#39;,&#39;, encoding=&#39;utf-8&#39;)\n\nfrom sklearn.metrics import calinski_harabaz_score\nprint(calinski_harabaz_score(data, prediction))\n\n    分组    英雄  最大生命   生命成长  初始生命  ...    初始每5秒回蓝    最大攻速  攻击范围  主要定位  次要定位 \n0    0   夏侯惇  7350  288.8  3307  ...         15  28.00%    近战    坦克     战士\n...\n43   1    张良  5799  198.0  3027  ...         18  14.00%    远程    法师    NaN\n...\n68   2  百里守约  5611  185.1  3019  ...         16  28.00%    远程    射手     刺客\n\n[69 rows x 24 columns]\n23.869655882044263","like_count":0},{"had_liked":false,"id":71117,"user_name":"JingZ","can_delete":false,"product_type":"c1","uid":1023464,"ip_address":"","ucode":"6F97895B2CC375","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132","comment_is_top":false,"comment_ctime":1551268531,"is_pvip":false,"replies":[{"id":64495,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577620081,"ip_address":"","comment_id":71117,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"# EM算法\n全部特征值\n[20 11  9 27  5  5  0  9  6  2 16 22 27 11 25 16 24  6  5 14  7 14 13 14\n 14 14 13 18 21  8 11  8 28 21  8  8 21 23  1 11 28 21 21  8  8 28 22  1\n 11 21 10  4 17  3  3 20 12  4 26  5 12 17 19 20 15  4 29  4 18]\n23.16819127214688\n\n聚类个数=3\n[0 0 1 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 0 2 2 2 2 2 2\n 2 0 2 2 2 2 2 2 2 0 0 0 2 1 0 1 0 0 0 0 0 2 1 0 1 1 0 1 2 2 0 2]\n22.91192979526994\n\n聚类个数=30\n[10  1  9  8  2  2  6  9  8 27  4  5  8  1 19  4 25  8 12  3 23 17  3 17\n 17 17  3 11  0 13  1 18 18  0 13 18  0  7 20 22 22  0  0 18  0 22  5 20\n  5  0 28 14 12 24 24 10 10 26 21  2 10 29 15 10 16 26 26 10 11]\n21.034625759895164","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447622,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577615038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70060,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1550979458,"is_pvip":false,"replies":[{"id":64510,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577620219,"ip_address":"","comment_id":70060,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"1、用全部的特征值矩阵进行聚类训练\n[12 17  9 13  1  1 15  9  3 27 18 24 13 17 14 18 12  3  1  5 23 11  5 11\n 11 11  5 22  7 26 17  7 21  7 26  7  7  4  0 28 21  7  7  7  7 28 24  0\n 17  7 25  2  8 19 19 12 10  2 20  1 10  8 16 12  6  2 29  2 22]\n23.195087563465346\n\n2、依然用王者荣耀英雄数据集，\n1）聚类个数为 3 以及\n[1 1 2 1 2 2 2 2 1 1 1 1 1 1 1 1 1 1 2 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0\n 0 1 0 0 0 0 0 0 0 1 1 1 0 2 1 2 1 1 1 1 1 0 2 1 2 2 1 2 0 0 1 0]\n聚类结果评估：22.91192979526994\n\n2）聚类个数为 30 \n[20 12  9 16  3  3 18  9  6 20 15  4 16 28 26 15  0  6 23 14  7  5 14  5\n  5  5 14 24 10 29 28 10 10 10 29 10  1 21 25 19 10  1 10 10 10 19  4 25\n  4 10  8  2 23 17 17 20  2 12 19  3  2 11 13 20 22 27 27 12 24]\n聚类结果评估：21.300387287083122","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":444418,"discussion_content":"也算是正常","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577617847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68610,"user_name":"深白浅黑","can_delete":false,"product_type":"c1","uid":1123923,"ip_address":"","ucode":"DCCAA31DE8B127","user_header":"https://static001.geekbang.org/account/avatar/00/11/26/53/60fe31fb.jpg","comment_is_top":false,"comment_ctime":1550556512,"is_pvip":false,"replies":[{"id":24452,"content":"Good","user_name":"编辑回复","user_name_real":"何昌梅","uid":1165037,"ctime":1550632539,"ip_address":"","comment_id":68610,"utype":2}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"全部特征\n聚类个数为3：\n[2 2 0 2 0 0 0 0 2 2 2 2 2 2 2 2 2 2 0 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1\n 1 1 2 1 1 1 1 1 1 2 1 2 1 0 2 0 1 1 2 2 2 1 0 2 0 0 2 0 1 1 2 1]\n34.46996086536748\n聚类个数为30：\n[22 23 11 16  1  1 25 11  2  7  9  7 16 24 28  9 14  2  1  4  5  4 20  4\n  4  4 20 27  0  8 23  0 26  0  8  0  0 17 15 10 26  0  0 26  0 10 29 15\n  7  0  6  3 12 13 13 22 22 23 18  1 22 12 21 22 19  3  3 23 27]\n25.04467629288216","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441298,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70061,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1550979571,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"有一个疑惑，在数据规范化的时候，为何Z-Score进行规范化，而不是Min-Max进行规范化，虽然最后的结果是差不多的。\n请问在数据规范化时，何时用Z-Score进行规范化，何时是Min-Max","like_count":28,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440999,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78004,"user_name":"iamtalent123","can_delete":false,"product_type":"c1","uid":1360936,"ip_address":"","ucode":"E009E6F7EE8003","user_header":"","comment_is_top":false,"comment_ctime":1553052694,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"老师，请问有没有什么方法在得到相关性系数后，自动筛选出不太相关的特征呢？在特征比较多的时候，自己一个一个的看是不是有点太费时了？","like_count":12},{"had_liked":false,"id":74388,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1320379,"ip_address":"","ucode":"4FD6817E4D4893","user_header":"https://static001.geekbang.org/account/avatar/00/14/25/bb/20c876ce.jpg","comment_is_top":false,"comment_ctime":1552210745,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"老师，covariance_type这个参数，什么情况下选择什么类型，能不能再说的详细点儿呢？","like_count":8},{"had_liked":false,"id":68775,"user_name":"third","can_delete":false,"product_type":"c1","uid":1025114,"ip_address":"","ucode":"9A37408A834F0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg","comment_is_top":false,"comment_ctime":1550601110,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"思考：为什么分类越少，反而指标分数越高，分类效果越好？\n总样本过少，分成的类越多，每个类的所拥有的个体相对越少，类中个体差异变大，导致指标分数变低\n为3个\n[2 2 1 2 1 1 1 1 2 2 2 2 2 0 2 2 2 2 1 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 2 0 2 0 1 0 1 0 0 2 2 0 0 1 2 1 1 2 1 0 0 0 0]\n34.74970397246901\n\n为30\n[ 1 20  5 13 26 15 14  5  8 20 16 20 13  0 22 16 19 22 26 10  6  4 10  4\n  4  4 10 12  3 27  0 27 29  3 27  3  3 24 27 18 29  3  3 27  3 18 20 27\n 20  3 21 11  2 23 23  1 28 11 25 26 28  2 17  1  9 11 11  7 12]\n24.220124542171177","like_count":8,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439755,"discussion_content":"Good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550632539,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87843,"user_name":"滢","can_delete":false,"product_type":"c1","uid":1221511,"ip_address":"","ucode":"971A6F20AF3F9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a3/87/c415e370.jpg","comment_is_top":false,"comment_ctime":1555729433,"is_pvip":false,"replies":[{"id":64237,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577615038,"ip_address":"","comment_id":87843,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"全部特征，聚类个数为3个：\n[0 0 2 0 2 2 2 2 0 0 0 0 0 0 0 0 0 0 2 1 1 1 1 1 1 1 1 1 1 1 0 1 1 1 1 1 1\n 1 0 1 1 1 1 1 1 1 0 0 0 1 2 0 2 0 0 0 0 0 1 2 0 2 2 0 2 1 1 0 1]\n22.91192979526994\n全部特征：聚类个数为30个\n[16 12 11 13  2  2 19 11  3 12 15 12 13  8 24 15 25 13 21 27 26  7 27  7\n  7  7 27 22 28  1  8  1 29 28  1  1 28  6 20 18 29 28 28  1 28 18 12 20\n 12 28 17 14 21  4  4 16  0 12 23 21  0  5  9 16 10 14 14 16 22]\n22.211084900636873","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":441298,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577619938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":79255,"user_name":"hlz-123","can_delete":false,"product_type":"c1","uid":1433586,"ip_address":"","ucode":"B7E5EF0C260BD2","user_header":"","comment_is_top":false,"comment_ctime":1553418050,"is_pvip":false,"replies":[{"id":64367,"content":"也算是正常","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577617847,"ip_address":"","comment_id":79255,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"老师，同一程序每次运行结果不一样，有时赵云和孙悟空聚在一类，有时赵云和兰陵王聚在一类，这种情况正常吗？","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440999,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71723,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1551420497,"is_pvip":false,"replies":[{"id":64485,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577619938,"ip_address":"","comment_id":71723,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"# -*- coding: utf-8 -*-\nimport sys\nreload(sys)\nsys.setdefaultencoding(&#39;utf8&#39;)\n\nimport pandas as pd\nimport csv\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.mixture import GaussianMixture\nfrom sklearn.preprocessing import StandardScaler\n\n# 数据加载，避免中文乱码问题\ndata_ori = pd.read_csv(&#39;.&#47;heros.csv&#39;, encoding=&#39;gb18030&#39;)\nfeatures = [u&#39;最大生命&#39;, u&#39;生命成长&#39;, u&#39;初始生命&#39;, u&#39;最大法力&#39;, u&#39;法力成长&#39;, u&#39;初始法力&#39;, u&#39;最高物攻&#39;, u&#39;物攻成长&#39;, u&#39;初始物攻&#39;, u&#39;最大物防&#39;, u&#39;物防成长&#39;, u&#39;初始物防&#39;,\n            u&#39;最大每5秒回血&#39;, u&#39;每5秒回血成长&#39;, u&#39;初始每5秒回血&#39;, u&#39;最大每5秒回蓝&#39;, u&#39;每5秒回蓝成长&#39;, u&#39;初始每5秒回蓝&#39;, u&#39;最大攻速&#39;, u&#39;攻击范围&#39;]\ndata = data_ori[features]\n\n# 对英雄属性之间的关系进行可视化分析\n# 设置 plt 正确显示中文\nplt.rcParams[&#39;font.sans-serif&#39;] = [&#39;SimHei&#39;]  # 用来正常显示中文标签\nplt.rcParams[&#39;axes.unicode_minus&#39;] = False  # 用来正常显示负号\n# 用热力图呈现 features_mean 字段之间的相关性\ncorr = data[features].corr()\nplt.figure(figsize=(14, 14))\n# annot=True 显示每个方格的数据\nsns.heatmap(corr, annot=True)\nplt.show()\n\npd.set_option(&#39;mode.chained_assignment&#39;, None)\ndata[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;)) &#47; 100)\ndata[u&#39;攻击范围&#39;] = data[u&#39;攻击范围&#39;].map({u&#39;远程&#39;: 1, u&#39;近战&#39;: 0})\n\n# 采用 Z-Score 规范化数据，保证每个特征维度的数据均值为 0，方差为 1\nss = StandardScaler()\ndata = ss.fit_transform(data)\n\n#print(data)\n\n# 构造 GMM 聚类\ngmm = GaussianMixture(n_components=3, covariance_type=&#39;full&#39;)\ngmm.fit(data)\n# 训练数据\nprediction = gmm.predict(data)\nprint(prediction)\n\n# 将分组结果输出到 CSV 文件中\ndata_ori.insert(0, &#39;分组&#39;, prediction)\ndata_ori.to_csv(&#39;.&#47;hero_out2.csv&#39;, index=False, sep=&#39;,&#39;, encoding=&#39;utf-8&#39;)\n\nfrom sklearn.metrics import calinski_harabaz_score\nprint(calinski_harabaz_score(data, prediction))\n\n    分组    英雄  最大生命   生命成长  初始生命  ...    初始每5秒回蓝    最大攻速  攻击范围  主要定位  次要定位 \n0    0   夏侯惇  7350  288.8  3307  ...         15  28.00%    近战    坦克     战士\n...\n43   1    张良  5799  198.0  3027  ...         18  14.00%    远程    法师    NaN\n...\n68   2  百里守约  5611  185.1  3019  ...         16  28.00%    远程    射手     刺客\n\n[69 rows x 24 columns]\n23.869655882044263","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440420,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":71117,"user_name":"JingZ","can_delete":false,"product_type":"c1","uid":1023464,"ip_address":"","ucode":"6F97895B2CC375","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/wJphZ3HcvhjVUyTWCIsCugzfQY5NAy6VJ0XoPLibDlcHWMswFmFe678zd0lUjFETia80NQhyQcVnGDlKgKPcRGyw/132","comment_is_top":false,"comment_ctime":1551268531,"is_pvip":false,"replies":[{"id":64495,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577620081,"ip_address":"","comment_id":71117,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"# EM算法\n全部特征值\n[20 11  9 27  5  5  0  9  6  2 16 22 27 11 25 16 24  6  5 14  7 14 13 14\n 14 14 13 18 21  8 11  8 28 21  8  8 21 23  1 11 28 21 21  8  8 28 22  1\n 11 21 10  4 17  3  3 20 12  4 26  5 12 17 19 20 15  4 29  4 18]\n23.16819127214688\n\n聚类个数=3\n[0 0 1 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0 1 2 2 2 2 2 2 2 2 2 2 2 0 2 2 2 2 2 2\n 2 0 2 2 2 2 2 2 2 0 0 0 2 1 0 1 0 0 0 0 0 2 1 0 1 1 0 1 2 2 0 2]\n22.91192979526994\n\n聚类个数=30\n[10  1  9  8  2  2  6  9  8 27  4  5  8  1 19  4 25  8 12  3 23 17  3 17\n 17 17  3 11  0 13  1 18 18  0 13 18  0  7 20 22 22  0  0 18  0 22  5 20\n  5  0 28 14 12 24 24 10 10 26 21  2 10 29 15 10 16 26 26 10 11]\n21.034625759895164","like_count":0,"discussions":[{"author":{"id":1165037,"avatar":"https://static001.geekbang.org/account/avatar/00/11/c6/ed/89a2dc13.jpg","nickname":"丢了个丢丢丢","note":"","ucode":"BDD7E97E0E5E96","race_medal":0,"user_type":4,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":439755,"discussion_content":"Good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1550632539,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":4}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70060,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1550979458,"is_pvip":false,"replies":[{"id":64510,"content":"Good Job","user_name":"作者回复","user_name_real":"cy","uid":1306094,"ctime":1577620219,"ip_address":"","comment_id":70060,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"1、用全部的特征值矩阵进行聚类训练\n[12 17  9 13  1  1 15  9  3 27 18 24 13 17 14 18 12  3  1  5 23 11  5 11\n 11 11  5 22  7 26 17  7 21  7 26  7  7  4  0 28 21  7  7  7  7 28 24  0\n 17  7 25  2  8 19 19 12 10  2 20  1 10  8 16 12  6  2 29  2 22]\n23.195087563465346\n\n2、依然用王者荣耀英雄数据集，\n1）聚类个数为 3 以及\n[1 1 2 1 2 2 2 2 1 1 1 1 1 1 1 1 1 1 2 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0\n 0 1 0 0 0 0 0 0 0 1 1 1 0 2 1 2 1 1 1 1 1 0 2 1 2 2 1 2 0 0 1 0]\n聚类结果评估：22.91192979526994\n\n2）聚类个数为 30 \n[20 12  9 16  3  3 18  9  6 20 15  4 16 28 26 15  0  6 23 14  7  5 14  5\n  5  5 14 24 10 29 28 10 10 10 29 10  1 21 25 19 10  1 10 10 10 19  4 25\n  4 10  8  2 23 17 17 20  2 12 19  3  2 11 13 20 22 27 27 12 24]\n聚类结果评估：21.300387287083122","like_count":0,"discussions":[{"author":{"id":1306094,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ed/ee/c4779b67.jpg","nickname":"cy","note":"","ucode":"50D653399A31F6","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":440420,"discussion_content":"Good Job","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577620219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68610,"user_name":"深白浅黑","can_delete":false,"product_type":"c1","uid":1123923,"ip_address":"","ucode":"DCCAA31DE8B127","user_header":"https://static001.geekbang.org/account/avatar/00/11/26/53/60fe31fb.jpg","comment_is_top":false,"comment_ctime":1550556512,"is_pvip":false,"replies":[{"id":24452,"content":"Good","user_name":"编辑回复","user_name_real":"何昌梅","uid":1165037,"ctime":1550632539,"ip_address":"","comment_id":68610,"utype":2}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"全部特征\n聚类个数为3：\n[2 2 0 2 0 0 0 0 2 2 2 2 2 2 2 2 2 2 0 1 1 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1\n 1 1 2 1 1 1 1 1 1 2 1 2 1 0 2 0 1 1 2 2 2 1 0 2 0 0 2 0 1 1 2 1]\n34.46996086536748\n聚类个数为30：\n[22 23 11 16  1  1 25 11  2  7  9  7 16 24 28  9 14  2  1  4  5  4 20  4\n  4  4 20 27  0  8 23  0 26  0  8  0  0 17 15 10 26  0  0 26  0 10 29 15\n  7  0  6  3 12 13 13 22 22 23 18  1 22 12 21 22 19  3  3 23 27]\n25.04467629288216","like_count":0,"discussions":[{"author":{"id":1022786,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9b/42/aeb79b35.jpg","nickname":"Ling","note":"","ucode":"EE15D1ABDB073B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":52801,"discussion_content":"数据零散时，可以考虑使用 Min-Max 规范化；数据符合高斯分布时，可以考虑使用 Z-Score 规范化。","likes_number":14,"is_delete":false,"is_hidden":false,"ctime":1574086050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2219062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/dc/36/6cb18467.jpg","nickname":"悟","note":"","ucode":"38B121A751289B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311356,"discussion_content":"MIN-MAX标准化会由于部分单个值异常值","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602315729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70061,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1550979571,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"有一个疑惑，在数据规范化的时候，为何Z-Score进行规范化，而不是Min-Max进行规范化，虽然最后的结果是差不多的。\n请问在数据规范化时，何时用Z-Score进行规范化，何时是Min-Max","like_count":28,"discussions":[{"author":{"id":1022786,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/9b/42/aeb79b35.jpg","nickname":"Ling","note":"","ucode":"EE15D1ABDB073B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":52801,"discussion_content":"数据零散时，可以考虑使用 Min-Max 规范化；数据符合高斯分布时，可以考虑使用 Z-Score 规范化。","likes_number":14,"is_delete":false,"is_hidden":false,"ctime":1574086050,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2219062,"avatar":"https://static001.geekbang.org/account/avatar/00/21/dc/36/6cb18467.jpg","nickname":"悟","note":"","ucode":"38B121A751289B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311356,"discussion_content":"MIN-MAX标准化会由于部分单个值异常值","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602315729,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":78004,"user_name":"iamtalent123","can_delete":false,"product_type":"c1","uid":1360936,"ip_address":"","ucode":"E009E6F7EE8003","user_header":"","comment_is_top":false,"comment_ctime":1553052694,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"老师，请问有没有什么方法在得到相关性系数后，自动筛选出不太相关的特征呢？在特征比较多的时候，自己一个一个的看是不是有点太费时了？","like_count":12},{"had_liked":false,"id":74388,"user_name":"Frank","can_delete":false,"product_type":"c1","uid":1320379,"ip_address":"","ucode":"4FD6817E4D4893","user_header":"https://static001.geekbang.org/account/avatar/00/14/25/bb/20c876ce.jpg","comment_is_top":false,"comment_ctime":1552210745,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"老师，covariance_type这个参数，什么情况下选择什么类型，能不能再说的详细点儿呢？","like_count":8},{"had_liked":false,"id":68775,"user_name":"third","can_delete":false,"product_type":"c1","uid":1025114,"ip_address":"","ucode":"9A37408A834F0B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/5a/e708e423.jpg","comment_is_top":false,"comment_ctime":1550601110,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100021701,"comment_content":"思考：为什么分类越少，反而指标分数越高，分类效果越好？\n总样本过少，分成的类越多，每个类的所拥有的个体相对越少，类中个体差异变大，导致指标分数变低\n为3个\n[2 2 1 2 1 1 1 1 2 2 2 2 2 0 2 2 2 2 1 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 2 0 2 0 1 0 1 0 0 2 2 0 0 1 2 1 1 2 1 0 0 0 0]\n34.74970397246901\n\n为30\n[ 1 20  5 13 26 15 14  5  8 20 16 20 13  0 22 16 19 22 26 10  6  4 10  4\n  4  4 10 12  3 27  0 27 29  3 27  3  3 24 27 18 29  3  3 27  3 18 20 27\n 20  3 21 11  2 23 23  1 28 11 25 26 28  2 17  1  9 11 11  7 12]\n24.220124542171177","like_count":8},{"had_liked":false,"id":178290,"user_name":"Miracle","can_delete":false,"product_type":"c1","uid":1758279,"ip_address":"","ucode":"74116B4D0C0760","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d4/47/6d9f2da6.jpg","comment_is_top":false,"comment_ctime":1581651936,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"老师，我有一个疑惑，  这个EM算法算硬币的那个看明白了，但是放到一个具体的项目里面，很好奇究竟是怎么聚类的呢？   比如就拿上面这个王者荣耀英雄聚类来讲，我们给的输入是好多条数据，然后我假设聚成3类。 那么这里的隐藏变量是啥？  E步和M步又都是怎么操作的啊？  能不能讲讲这个流程啊？    ","like_count":6},{"had_liked":false,"id":68223,"user_name":"Grandia_Z","can_delete":false,"product_type":"c1","uid":1354034,"ip_address":"","ucode":"4928A7ABA7C24C","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/32/eb71b457.jpg","comment_is_top":false,"comment_ctime":1550460498,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"画热力图时 为什么没有“最大攻速”和“攻击范围”这两项","like_count":5,"discussions":[{"author":{"id":2344228,"avatar":"https://static001.geekbang.org/account/avatar/00/23/c5/24/182c710f.jpg","nickname":"lin","note":"","ucode":"356B5A4152B02D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343858,"discussion_content":"同样想知道在这种场景下的EM过程是怎么样的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611197638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94574,"user_name":"挠头侠","can_delete":false,"product_type":"c1","uid":1150474,"ip_address":"","ucode":"F96966832E2252","user_header":"https://static001.geekbang.org/account/avatar/00/11/8e/0a/31ec5392.jpg","comment_is_top":false,"comment_ctime":1557844156,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"老师能否说明一下不同的协方差类型会带来一个什么样的效果呢？","like_count":2},{"had_liked":false,"id":71667,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1551408850,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"跑案例提示如下，请问老师怎么破？谢谢。\n\nSettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: http:&#47;&#47;pandas.pydata.org&#47;pandas-docs&#47;stable&#47;indexing.html#indexing-view-versus-copy\n  data[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;)) &#47; 100)\nE:\\DevelopTool\\Python\\Python27\\lib\\site-packages\\pandas\\core\\indexes\\base.py:3259: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal\n  indexer = self._engine.get_indexer(target._ndarray_values)\nG:&#47;Program&#47;python&#47;Geekbang&#47;DataAnalysis&#47;Part01&#47;Lesson29&#47;01_GMM.py:31: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: http:&#47;&#47;pandas.pydata.org&#47;pandas-docs&#47;stable&#47;indexing.html#indexing-view-versus-copy\n  data[u&#39;攻击范围&#39;] = data[u&#39;攻击范围&#39;].map({&#39;远程&#39;: 1, &#39;近战&#39;: 0})\nE:\\DevelopTool\\Python\\Python27\\lib\\site-packages\\sklearn\\preprocessing\\data.py:625: DataConversionWarning: Data with input dtype int64, float64 were all converted to float64 by StandardScaler.\n  return self.partial_fit(X, y)\nE:\\DevelopTool\\Python\\Python27\\lib\\site-packages\\sklearn\\utils\\extmath.py:776: RuntimeWarning: invalid value encountered in true_divide\n  updated_mean = (last_sum + new_sum) &#47; updated_sample_count\n...\nTraceback (most recent call last):\n  ...\nValueError: Input contains NaN, infinity or a value too large for dtype(&#39;float64&#39;).","like_count":2},{"had_liked":false,"id":389530,"user_name":"yanyu-xin","can_delete":false,"product_type":"c1","uid":1899757,"ip_address":"广东","ucode":"3AA389F9E4C236","user_header":"","comment_is_top":false,"comment_ctime":1712797330,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"出现两个问题：\n一、发生异常: ValueError could not convert string to float: &#39;近战&#39; File &quot;D:\\EM_data-master\\here_em.py&quot;, line 21, in &lt;module&gt; corr = data[features].corr() ^^^^^^^^^^^^^^^^^^^^^ ValueError: could not convert string to float: &#39;近战&#39;\n解决：在尝试计算数据帧（DataFrame）中特征之间的相关性时，使用了corr()方法。这个方法默认情况下只能在数值型数据上进行计算，无法处理字符串类型的数据。为了解决这个问题，需要确保所有参与相关性计算的特征都是数值型数据。为此需要在代码中　“　corr = data[features].corr()　”　前，增加两行实现的：\ndata[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;))&#47;100)\ndata[u&#39;攻击范围&#39;]=data[u&#39;攻击范围&#39;].map({&#39;远程&#39;:1,&#39;近战&#39;:0})\n\n二、发生异常: ImportError cannot import name &#39;calinski_harabaz_score&#39; from &#39;sklearn.metrics&#39; (c:\\Python311\\Lib\\site-packages\\sklearn\\metrics\\__init__.py) File &quot;D:\\EM_data-master\\here_em1.py&quot;, line 49, in &lt;module&gt; from sklearn.metrics import calinski_harabaz_score ImportError: cannot import name &#39;calinski_harabaz_score&#39; from &#39;sklearn.metrics&#39; (c:\\Python311\\Lib\\site-packages\\sklearn\\metrics\\__init__.py)\n这个问题的原因是在较新版本的scikit-learn中，calinski_harabaz_score已经被重命名为calinski_harabasz_score。因此，正确的导入方式应该是从sklearn.metrics导入calinski_harabasz_score。为了解决这个问题，安装更新最新scikit-learn版本，\n将代码：\nfrom sklearn.metrics import calinski_harabaz_score\nprint(calinski_harabaz_score(data, prediction))\n改为：\nfrom sklearn.metrics import calinski_harabasz_score\nprint(calinski_harabasz_score(data, prediction))","like_count":1},{"had_liked":false,"id":314329,"user_name":"Geek_e888b2","can_delete":false,"product_type":"c1","uid":2772642,"ip_address":"","ucode":"8722773DE79327","user_header":"","comment_is_top":false,"comment_ctime":1632971751,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"最后.insert()和.to_scv()括号里面怎么理解？","like_count":1},{"had_liked":false,"id":68301,"user_name":"白夜","can_delete":false,"product_type":"c1","uid":1354449,"ip_address":"","ucode":"7AABFA7C04EA34","user_header":"https://static001.geekbang.org/account/avatar/00/14/aa/d1/076482f3.jpg","comment_is_top":false,"comment_ctime":1550480610,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"这个相关性的计算原理能扩展讲讲吗？蛮好奇的","like_count":1,"discussions":[{"author":{"id":1914504,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","nickname":"Simon","note":"","ucode":"A8A2E3E57BD029","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224908,"discussion_content":"就是协方差，相关系数。没什么特别。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586336753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263677,"user_name":"非同凡想","can_delete":false,"product_type":"c1","uid":1934969,"ip_address":"","ucode":"713FD449A49D5A","user_header":"https://static001.geekbang.org/account/avatar/00/1d/86/79/066a062a.jpg","comment_is_top":false,"comment_ctime":1606215912,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"1.全部特征 30个聚类\n[25 13  8  5  1  1 21  8 12 13  2 13  5  4 28  2 15 12  1 24 18  9 24  9\n  9  9 24 22  6  6  4  6  6  6  6  6  6  7 23  0  6  6  6  6  6  0 27 23\n 13  6 16 26  1  3  3 25 11 26 14  1 11 10 17 25 20 26 19 29 22]\n23.507078366657264\n\n2.全部特征 3个聚类\n[2 2 1 2 1 1 1 1 2 2 2 2 2 0 2 2 2 2 1 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 2 0 2 0 1 0 1 0 0 2 2 0 0 1 2 1 1 2 1 0 0 0 0]\n34.74970397246901\n\n3. 12个特征，30个聚类\n[ 9 19  5 12  3  3 23 29 12  1  7 19 12  6 20  7 28 12  3  2 17  2  2  2\n  2  2  2  0 21 26  6 21  4 21 26 21 21 10 14 11  4 21 21  4 21 11 19 14\n 19 21 27 13  8 16 16  9 25 19 24  3 25  8 15  9 18 13 13 22  0]\n20.931148834796\n\n4.12个特征，3个聚类\n[0 0 1 1 1 1 2 1 1 0 1 0 1 0 1 1 0 1 1 2 2 2 2 2 2 2 2 2 2 2 0 2 2 2 2 2 2\n 2 0 2 2 2 2 2 2 2 0 0 0 2 0 0 0 0 0 0 0 0 2 1 0 0 0 0 0 0 0 0 2]\n20.773369734506527","like_count":0},{"had_liked":false,"id":203432,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1586188487,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"交作业：\nhttps:&#47;&#47;github.com&#47;LearningChanging&#47;Data-analysis-in-action&#47;tree&#47;master&#47;29-EM%E8%81%9A%E7%B1%BB%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E7%94%A8EM%E7%AE%97%E6%B3%95%E5%AF%B9%E7%8E%8B%E8%80%85%E8%8D%A3%E8%80%80%E8%8B%B1%E9%9B%84%E8%BF%9B%E8%A1%8C%E5%88%92%E5%88%86","like_count":0},{"had_liked":false,"id":83203,"user_name":"滨滨","can_delete":false,"product_type":"c1","uid":1334567,"ip_address":"","ucode":"881EFA798BEE34","user_header":"https://static001.geekbang.org/account/avatar/00/14/5d/27/74e152d3.jpg","comment_is_top":false,"comment_ctime":1554458543,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"为什么分类越少，反而指标分数越高，分类效果越好？\n总样本过少，分成的类越多，每个类的所拥有的个体相对越少，类中个体差异变大，导致指标分数变低","like_count":0},{"had_liked":false,"id":178290,"user_name":"Miracle","can_delete":false,"product_type":"c1","uid":1758279,"ip_address":"","ucode":"74116B4D0C0760","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d4/47/6d9f2da6.jpg","comment_is_top":false,"comment_ctime":1581651936,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"老师，我有一个疑惑，  这个EM算法算硬币的那个看明白了，但是放到一个具体的项目里面，很好奇究竟是怎么聚类的呢？   比如就拿上面这个王者荣耀英雄聚类来讲，我们给的输入是好多条数据，然后我假设聚成3类。 那么这里的隐藏变量是啥？  E步和M步又都是怎么操作的啊？  能不能讲讲这个流程啊？    ","like_count":6,"discussions":[{"author":{"id":2344228,"avatar":"https://static001.geekbang.org/account/avatar/00/23/c5/24/182c710f.jpg","nickname":"lin","note":"","ucode":"356B5A4152B02D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343858,"discussion_content":"同样想知道在这种场景下的EM过程是怎么样的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611197638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68223,"user_name":"Grandia_Z","can_delete":false,"product_type":"c1","uid":1354034,"ip_address":"","ucode":"4928A7ABA7C24C","user_header":"https://static001.geekbang.org/account/avatar/00/14/a9/32/eb71b457.jpg","comment_is_top":false,"comment_ctime":1550460498,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"画热力图时 为什么没有“最大攻速”和“攻击范围”这两项","like_count":5,"discussions":[{"author":{"id":1622750,"avatar":"https://static001.geekbang.org/account/avatar/00/18/c2/de/98cd7728.jpg","nickname":"Lisa","note":"","ucode":"9879032355DC55","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5094,"discussion_content":"因为这俩是字符型","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565939058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94574,"user_name":"挠头侠","can_delete":false,"product_type":"c1","uid":1150474,"ip_address":"","ucode":"F96966832E2252","user_header":"https://static001.geekbang.org/account/avatar/00/11/8e/0a/31ec5392.jpg","comment_is_top":false,"comment_ctime":1557844156,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"老师能否说明一下不同的协方差类型会带来一个什么样的效果呢？","like_count":2},{"had_liked":false,"id":71667,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1551408850,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"跑案例提示如下，请问老师怎么破？谢谢。\n\nSettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: http:&#47;&#47;pandas.pydata.org&#47;pandas-docs&#47;stable&#47;indexing.html#indexing-view-versus-copy\n  data[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;)) &#47; 100)\nE:\\DevelopTool\\Python\\Python27\\lib\\site-packages\\pandas\\core\\indexes\\base.py:3259: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal\n  indexer = self._engine.get_indexer(target._ndarray_values)\nG:&#47;Program&#47;python&#47;Geekbang&#47;DataAnalysis&#47;Part01&#47;Lesson29&#47;01_GMM.py:31: SettingWithCopyWarning: \nA value is trying to be set on a copy of a slice from a DataFrame.\nTry using .loc[row_indexer,col_indexer] = value instead\n\nSee the caveats in the documentation: http:&#47;&#47;pandas.pydata.org&#47;pandas-docs&#47;stable&#47;indexing.html#indexing-view-versus-copy\n  data[u&#39;攻击范围&#39;] = data[u&#39;攻击范围&#39;].map({&#39;远程&#39;: 1, &#39;近战&#39;: 0})\nE:\\DevelopTool\\Python\\Python27\\lib\\site-packages\\sklearn\\preprocessing\\data.py:625: DataConversionWarning: Data with input dtype int64, float64 were all converted to float64 by StandardScaler.\n  return self.partial_fit(X, y)\nE:\\DevelopTool\\Python\\Python27\\lib\\site-packages\\sklearn\\utils\\extmath.py:776: RuntimeWarning: invalid value encountered in true_divide\n  updated_mean = (last_sum + new_sum) &#47; updated_sample_count\n...\nTraceback (most recent call last):\n  ...\nValueError: Input contains NaN, infinity or a value too large for dtype(&#39;float64&#39;).","like_count":2},{"had_liked":false,"id":389530,"user_name":"yanyu-xin","can_delete":false,"product_type":"c1","uid":1899757,"ip_address":"广东","ucode":"3AA389F9E4C236","user_header":"","comment_is_top":false,"comment_ctime":1712797330,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"出现两个问题：\n一、发生异常: ValueError could not convert string to float: &#39;近战&#39; File &quot;D:\\EM_data-master\\here_em.py&quot;, line 21, in &lt;module&gt; corr = data[features].corr() ^^^^^^^^^^^^^^^^^^^^^ ValueError: could not convert string to float: &#39;近战&#39;\n解决：在尝试计算数据帧（DataFrame）中特征之间的相关性时，使用了corr()方法。这个方法默认情况下只能在数值型数据上进行计算，无法处理字符串类型的数据。为了解决这个问题，需要确保所有参与相关性计算的特征都是数值型数据。为此需要在代码中　“　corr = data[features].corr()　”　前，增加两行实现的：\ndata[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;))&#47;100)\ndata[u&#39;攻击范围&#39;]=data[u&#39;攻击范围&#39;].map({&#39;远程&#39;:1,&#39;近战&#39;:0})\n\n二、发生异常: ImportError cannot import name &#39;calinski_harabaz_score&#39; from &#39;sklearn.metrics&#39; (c:\\Python311\\Lib\\site-packages\\sklearn\\metrics\\__init__.py) File &quot;D:\\EM_data-master\\here_em1.py&quot;, line 49, in &lt;module&gt; from sklearn.metrics import calinski_harabaz_score ImportError: cannot import name &#39;calinski_harabaz_score&#39; from &#39;sklearn.metrics&#39; (c:\\Python311\\Lib\\site-packages\\sklearn\\metrics\\__init__.py)\n这个问题的原因是在较新版本的scikit-learn中，calinski_harabaz_score已经被重命名为calinski_harabasz_score。因此，正确的导入方式应该是从sklearn.metrics导入calinski_harabasz_score。为了解决这个问题，安装更新最新scikit-learn版本，\n将代码：\nfrom sklearn.metrics import calinski_harabaz_score\nprint(calinski_harabaz_score(data, prediction))\n改为：\nfrom sklearn.metrics import calinski_harabasz_score\nprint(calinski_harabasz_score(data, prediction))","like_count":1},{"had_liked":false,"id":314329,"user_name":"Geek_e888b2","can_delete":false,"product_type":"c1","uid":2772642,"ip_address":"","ucode":"8722773DE79327","user_header":"","comment_is_top":false,"comment_ctime":1632971751,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"最后.insert()和.to_scv()括号里面怎么理解？","like_count":1},{"had_liked":false,"id":68301,"user_name":"白夜","can_delete":false,"product_type":"c1","uid":1354449,"ip_address":"","ucode":"7AABFA7C04EA34","user_header":"https://static001.geekbang.org/account/avatar/00/14/aa/d1/076482f3.jpg","comment_is_top":false,"comment_ctime":1550480610,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"这个相关性的计算原理能扩展讲讲吗？蛮好奇的","like_count":1,"discussions":[{"author":{"id":1622750,"avatar":"https://static001.geekbang.org/account/avatar/00/18/c2/de/98cd7728.jpg","nickname":"Lisa","note":"","ucode":"9879032355DC55","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5094,"discussion_content":"因为这俩是字符型","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1565939058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":263677,"user_name":"非同凡想","can_delete":false,"product_type":"c1","uid":1934969,"ip_address":"","ucode":"713FD449A49D5A","user_header":"https://static001.geekbang.org/account/avatar/00/1d/86/79/066a062a.jpg","comment_is_top":false,"comment_ctime":1606215912,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"1.全部特征 30个聚类\n[25 13  8  5  1  1 21  8 12 13  2 13  5  4 28  2 15 12  1 24 18  9 24  9\n  9  9 24 22  6  6  4  6  6  6  6  6  6  7 23  0  6  6  6  6  6  0 27 23\n 13  6 16 26  1  3  3 25 11 26 14  1 11 10 17 25 20 26 19 29 22]\n23.507078366657264\n\n2.全部特征 3个聚类\n[2 2 1 2 1 1 1 1 2 2 2 2 2 0 2 2 2 2 1 0 0 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 2 0 2 0 1 0 1 0 0 2 2 0 0 1 2 1 1 2 1 0 0 0 0]\n34.74970397246901\n\n3. 12个特征，30个聚类\n[ 9 19  5 12  3  3 23 29 12  1  7 19 12  6 20  7 28 12  3  2 17  2  2  2\n  2  2  2  0 21 26  6 21  4 21 26 21 21 10 14 11  4 21 21  4 21 11 19 14\n 19 21 27 13  8 16 16  9 25 19 24  3 25  8 15  9 18 13 13 22  0]\n20.931148834796\n\n4.12个特征，3个聚类\n[0 0 1 1 1 1 2 1 1 0 1 0 1 0 1 1 0 1 1 2 2 2 2 2 2 2 2 2 2 2 0 2 2 2 2 2 2\n 2 0 2 2 2 2 2 2 2 0 0 0 2 0 0 0 0 0 0 0 0 2 1 0 0 0 0 0 0 0 0 2]\n20.773369734506527","like_count":0},{"had_liked":false,"id":203432,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1586188487,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"交作业：\nhttps:&#47;&#47;github.com&#47;LearningChanging&#47;Data-analysis-in-action&#47;tree&#47;master&#47;29-EM%E8%81%9A%E7%B1%BB%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E7%94%A8EM%E7%AE%97%E6%B3%95%E5%AF%B9%E7%8E%8B%E8%80%85%E8%8D%A3%E8%80%80%E8%8B%B1%E9%9B%84%E8%BF%9B%E8%A1%8C%E5%88%92%E5%88%86","like_count":0},{"had_liked":false,"id":83203,"user_name":"滨滨","can_delete":false,"product_type":"c1","uid":1334567,"ip_address":"","ucode":"881EFA798BEE34","user_header":"https://static001.geekbang.org/account/avatar/00/14/5d/27/74e152d3.jpg","comment_is_top":false,"comment_ctime":1554458543,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100021701,"comment_content":"为什么分类越少，反而指标分数越高，分类效果越好？\n总样本过少，分成的类越多，每个类的所拥有的个体相对越少，类中个体差异变大，导致指标分数变低","like_count":0,"discussions":[{"author":{"id":1914504,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/36/88/20b6a6ee.jpg","nickname":"Simon","note":"","ucode":"A8A2E3E57BD029","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224908,"discussion_content":"就是协方差，相关系数。没什么特别。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586336753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76830,"user_name":"三硝基甲苯","can_delete":false,"product_type":"c1","uid":1141929,"ip_address":"","ucode":"C492B058C2A5C0","user_header":"","comment_is_top":false,"comment_ctime":1552722006,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"在同样30个类的时候，没有任何特征过滤的时候分数大概是23附近，若是每种最大 成长 最初这三个里面去掉成长的话分数大概是19-21左右，若是只保留最大那一项，则分数可以到44-46左右。\n\n\n聚类30个和聚类3个分数差距，3个的分数比30个高","like_count":0},{"had_liked":false,"id":71687,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1551414167,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"问题1：\ndata[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;)) &#47; 100)\n会产生 SettingWithCopyWarning 警告\n解决方法：使用 pd.set_option(&#39;mode.chained_assignment&#39;, None) 屏蔽警告\n\n问题2：\n导出文件时，会报UnicodeEncodeError: &#39;ascii&#39; codec can&#39;t encode characters in position 0-1: ordinal not in range(128)\n解决方法：\n设置编码 data_ori.to_csv(&#39;.&#47;hero_out.csv&#39;, index=False, sep=&#39;,&#39;, encoding=&#39;utf-8&#39;)","like_count":0},{"had_liked":false,"id":70052,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1550977690,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"1、在特征选择时，老师是以选取相关性大于0.95中的一个特征进行保留的吗？\n那么应该是20个属性保留12个属性\n#老师提供的特征选择\nfeatures_remain = [u&#39;最大生命&#39;, u&#39;初始生命&#39;, u&#39;最大法力&#39;, u&#39;最高物攻&#39;, u&#39;初始物攻&#39;, u&#39;初始物攻&#39;, u&#39;最大物防&#39;, u&#39;初始物防&#39;, u&#39;最大每 5 秒回血&#39;, u&#39;最大每 5 秒回蓝&#39;, u&#39;初始每 5 秒回蓝&#39;, u&#39;最大攻速&#39;, u&#39;攻击范围&#39;]\n\n#自己筛选的特征\nfeatures = [u&#39;最大生命&#39;,u&#39;初始生命&#39;,u&#39;最大法力&#39;,u&#39;最高物攻&#39;,u&#39;初始物攻&#39;,u&#39;最大物防&#39;,u&#39;初始物防&#39;, u&#39;最大每 5 秒回血&#39;, u&#39;最大每 5 秒回蓝&#39;, u&#39;初始每 5 秒回蓝&#39;, u&#39;最大攻速&#39;, u&#39;攻击范围&#39;]","like_count":0},{"had_liked":false,"id":68773,"user_name":"fancy","can_delete":false,"product_type":"c1","uid":1243166,"ip_address":"","ucode":"0C51F80B9C35B1","user_header":"https://static001.geekbang.org/account/avatar/00/12/f8/1e/0d5f8336.jpg","comment_is_top":false,"comment_ctime":1550599706,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"运行时出错，说不存在u&#39;初始每 5 秒回蓝&#39;和u&#39;每 5 秒回蓝成长&#39;这两个index，删了以后能正常运行\n","like_count":0,"discussions":[{"author":{"id":1187792,"avatar":"https://static001.geekbang.org/account/avatar/00/12/1f/d0/660502a4.jpg","nickname":"初","note":"","ucode":"E124D8A566DA43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647389,"discussion_content":"data.loc[:, u&#39;最大攻速&#39;] = data.loc[:, u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;)) / 100)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719974958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68390,"user_name":"Chen","can_delete":false,"product_type":"c1","uid":1359478,"ip_address":"","ucode":"DBCC6C2A5D513E","user_header":"https://static001.geekbang.org/account/avatar/00/14/be/76/55e5e326.jpg","comment_is_top":false,"comment_ctime":1550493032,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"需要和陈老师讨论一个问题（关于数据规范化那节的），在网上看到有前辈讲关于“逻辑回归是否需要进行标准化？”，答案是取决于逻辑回归是不是用正则。讲的原因是不用正则时，仅仅是度量预测与真实值的差距，加上正则后，损失函数除了要度量差距外还要度量参数值是否足够小。。而参数值的大小程度或者说大小的级别是与特征的数值范围相关的。您是否同意呢？您讲是当用到梯度下降作为优化器，提高寻找最优解的效率而做标准化。这个前辈讲的是否有道理呢？我比较迷糊了。","like_count":0},{"had_liked":false,"id":68153,"user_name":"文晟","can_delete":false,"product_type":"c1","uid":1098714,"ip_address":"","ucode":"2CD9A626CB354C","user_header":"https://static001.geekbang.org/account/avatar/00/10/c3/da/44b9273b.jpg","comment_is_top":false,"comment_ctime":1550449963,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"老师，样本自动就是样本特征矩阵了吗","like_count":0,"discussions":[{"author":{"id":1613856,"avatar":"","nickname":"Geek_a012c0","note":"","ucode":"9A033F7A6F8D49","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7777,"discussion_content":"直接复制的话会发现‘5’前后有空格","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567671027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":76830,"user_name":"三硝基甲苯","can_delete":false,"product_type":"c1","uid":1141929,"ip_address":"","ucode":"C492B058C2A5C0","user_header":"","comment_is_top":false,"comment_ctime":1552722006,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"在同样30个类的时候，没有任何特征过滤的时候分数大概是23附近，若是每种最大 成长 最初这三个里面去掉成长的话分数大概是19-21左右，若是只保留最大那一项，则分数可以到44-46左右。\n\n\n聚类30个和聚类3个分数差距，3个的分数比30个高","like_count":0},{"had_liked":false,"id":71687,"user_name":"mickey","can_delete":false,"product_type":"c1","uid":1051663,"ip_address":"","ucode":"8B490C2DDE4010","user_header":"https://static001.geekbang.org/account/avatar/00/10/0c/0f/93d1c8eb.jpg","comment_is_top":false,"comment_ctime":1551414167,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"问题1：\ndata[u&#39;最大攻速&#39;] = data[u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;)) &#47; 100)\n会产生 SettingWithCopyWarning 警告\n解决方法：使用 pd.set_option(&#39;mode.chained_assignment&#39;, None) 屏蔽警告\n\n问题2：\n导出文件时，会报UnicodeEncodeError: &#39;ascii&#39; codec can&#39;t encode characters in position 0-1: ordinal not in range(128)\n解决方法：\n设置编码 data_ori.to_csv(&#39;.&#47;hero_out.csv&#39;, index=False, sep=&#39;,&#39;, encoding=&#39;utf-8&#39;)","like_count":0,"discussions":[{"author":{"id":1187792,"avatar":"https://static001.geekbang.org/account/avatar/00/12/1f/d0/660502a4.jpg","nickname":"初","note":"","ucode":"E124D8A566DA43","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647389,"discussion_content":"data.loc[:, u&#39;最大攻速&#39;] = data.loc[:, u&#39;最大攻速&#39;].apply(lambda x: float(x.strip(&#39;%&#39;)) / 100)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719974958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":70052,"user_name":"Geek_hve78z","can_delete":false,"product_type":"c1","uid":1015045,"ip_address":"","ucode":"386803B8FC2DD5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7d/05/4bad0c7c.jpg","comment_is_top":false,"comment_ctime":1550977690,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"1、在特征选择时，老师是以选取相关性大于0.95中的一个特征进行保留的吗？\n那么应该是20个属性保留12个属性\n#老师提供的特征选择\nfeatures_remain = [u&#39;最大生命&#39;, u&#39;初始生命&#39;, u&#39;最大法力&#39;, u&#39;最高物攻&#39;, u&#39;初始物攻&#39;, u&#39;初始物攻&#39;, u&#39;最大物防&#39;, u&#39;初始物防&#39;, u&#39;最大每 5 秒回血&#39;, u&#39;最大每 5 秒回蓝&#39;, u&#39;初始每 5 秒回蓝&#39;, u&#39;最大攻速&#39;, u&#39;攻击范围&#39;]\n\n#自己筛选的特征\nfeatures = [u&#39;最大生命&#39;,u&#39;初始生命&#39;,u&#39;最大法力&#39;,u&#39;最高物攻&#39;,u&#39;初始物攻&#39;,u&#39;最大物防&#39;,u&#39;初始物防&#39;, u&#39;最大每 5 秒回血&#39;, u&#39;最大每 5 秒回蓝&#39;, u&#39;初始每 5 秒回蓝&#39;, u&#39;最大攻速&#39;, u&#39;攻击范围&#39;]","like_count":0},{"had_liked":false,"id":68773,"user_name":"fancy","can_delete":false,"product_type":"c1","uid":1243166,"ip_address":"","ucode":"0C51F80B9C35B1","user_header":"https://static001.geekbang.org/account/avatar/00/12/f8/1e/0d5f8336.jpg","comment_is_top":false,"comment_ctime":1550599706,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"运行时出错，说不存在u&#39;初始每 5 秒回蓝&#39;和u&#39;每 5 秒回蓝成长&#39;这两个index，删了以后能正常运行\n","like_count":0,"discussions":[{"author":{"id":1613856,"avatar":"","nickname":"Geek_a012c0","note":"","ucode":"9A033F7A6F8D49","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7777,"discussion_content":"直接复制的话会发现‘5’前后有空格","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567671027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":68390,"user_name":"Chen","can_delete":false,"product_type":"c1","uid":1359478,"ip_address":"","ucode":"DBCC6C2A5D513E","user_header":"https://static001.geekbang.org/account/avatar/00/14/be/76/55e5e326.jpg","comment_is_top":false,"comment_ctime":1550493032,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"需要和陈老师讨论一个问题（关于数据规范化那节的），在网上看到有前辈讲关于“逻辑回归是否需要进行标准化？”，答案是取决于逻辑回归是不是用正则。讲的原因是不用正则时，仅仅是度量预测与真实值的差距，加上正则后，损失函数除了要度量差距外还要度量参数值是否足够小。。而参数值的大小程度或者说大小的级别是与特征的数值范围相关的。您是否同意呢？您讲是当用到梯度下降作为优化器，提高寻找最优解的效率而做标准化。这个前辈讲的是否有道理呢？我比较迷糊了。","like_count":0},{"had_liked":false,"id":68153,"user_name":"文晟","can_delete":false,"product_type":"c1","uid":1098714,"ip_address":"","ucode":"2CD9A626CB354C","user_header":"https://static001.geekbang.org/account/avatar/00/10/c3/da/44b9273b.jpg","comment_is_top":false,"comment_ctime":1550449963,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":5,"product_id":100021701,"comment_content":"老师，样本自动就是样本特征矩阵了吗","like_count":0}]}