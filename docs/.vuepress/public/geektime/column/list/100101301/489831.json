{"id":489831,"title":"32 | Alibaba Seata æ¡†æ¶ï¼šä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ","content":"<p>æˆ‘ç¬¬ä¸€æ¬¡è¢«é—®åŠåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œæ˜¯åœ¨ä¸€æ¬¡é¢è¯•çš„ç»ˆé¢ç¯èŠ‚ã€‚å¤šå¹´ä»¥åï¼Œé¢å¯¹å½¢å½¢è‰²è‰²çš„é¢è¯•è€…ï¼Œæˆ‘æ€»ä¼šå›æƒ³èµ·ç•…è°ˆåˆ†å¸ƒå¼æ–¹æ¡ˆçš„é‚£ä¸ªé¥è¿œçš„ä¸‹åˆã€‚</p><p>å½¼æ—¶çš„æ‰“å·¥äººè¿˜æ²¡ä»996 PUAçš„ç¦æŠ¥å‚¬çœ ä¸­è§‰é†’ï¼Œæ— äººåˆ¶è£çš„å¤§å‚å–œæ¬¢è‚†æ— å¿Œæƒ®åœ°å°†é¢è¯•å®‰æ’åœ¨å‘¨æœ«ï¼Œä¼¼ä¹ä»é¢è¯•çš„é‚£ä¸€åˆ»å¼€å§‹ï¼Œ996çš„èŠ‚å¥å°±è¢«å®ƒä»¬æ¼”ç»å¾—åƒå‘¼å¸ä¸€æ ·è‡ªç„¶ã€‚åœ¨ä¸€ä¸ªå‘¨å…­çš„ä¸‹åˆæˆ‘æ¥åˆ°äº†çº¦å®šçš„é¢è¯•åœ°ç‚¹ã€‚</p><p>â€œæœ‰æ²¡æœ‰åšè¿‡åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿâ€åˆšå’Œé¢è¯•å®˜å¯¹ä¸Šçº¿ï¼Œä»–å°±è¿é¢ç”©æˆ‘ä¸€ä¸ªå¤§æ‹›ã€‚</p><p>â€œåšè¿‡ï¼â€æˆ‘çš„å›ç­”åƒå¤é¾™å°è¯´ä¸€æ ·æƒœå­—å¦‚é‡‘ã€‚ä½†æˆ‘å¤§æ¦‚èƒ½çŒœåˆ°ä»–æƒ³å¬çš„å®Œç¾ç­”æ¡ˆï¼Œå…«æˆå°±æ˜¯<strong>é˜¿é‡Œç³»è‡ªç ”çš„åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶</strong>ã€‚</p><p>â€œè¯´è¯´æ˜¯æ€ä¹ˆå®ç°åˆ†å¸ƒå¼äº‹åŠ¡çš„ã€‚â€ä¸ºäº†è®©ä¸€ä¸ªç­”æ¡ˆå˜å¾—æœ‰å±‚æ¬¡ï¼Œæˆ‘è®¡åˆ’ä»ä¸‰ä¸ªé˜¶æ®µæ¥å›ç­”è¿™ä¸ªé—®é¢˜ï¼šä¸€ä¸ªæ“¦è¾¹çƒç­”æ¡ˆã€ä¸€ä¸ªæ­£ç¡®ä½†ä¸å®Œç¾çš„ç­”æ¡ˆã€ä¸€ä¸ªè¶…å‡ºé¢„æœŸçš„ç­”æ¡ˆã€‚å¦‚æœç”¨ä¸€éƒ¨èˆå°å‰§æ¥å½¢å®¹è¿™ä¸‰ä¸ªé˜¶æ®µï¼Œé‚£ä¹ˆå°±æ˜¯â€œå‰æˆã€æ­£æˆã€é«˜æ½®â€ã€‚</p><p>ä¸è¿™ä¸‰ä¸ªé˜¶æ®µç›¸å¯¹åº”çš„è¯æœ¯ï¼Œåˆ†åˆ«æ˜¯â€œæœ¬åœ°äº‹åŠ¡ã€ä¼ ç»Ÿçš„åˆ†å¸ƒå¼äº‹åŠ¡ã€é˜¿é‡Œç³»Seataåˆ†å¸ƒå¼äº‹åŠ¡â€ï¼Œä»å¹³æ·¡æ— å¥‡åˆ°ç¾½åŒ–è€Œç™»ä»™ã€‚</p><h2>ä¸€åœºå‰æˆ</h2><p>â€œå¤§éƒ¨åˆ†ä¼ ç»Ÿå…¬å¸çš„ä¸šåŠ¡è¿˜æ˜¯æ„å»ºåœ¨å•ä½“åº”ç”¨é›†ç¾¤ä¹‹ä¸Šï¼Œè¯´ç™½äº†ï¼Œå°±æ˜¯ä¸€ç§ä¼ªåˆ†å¸ƒå¼çš„åº”ç”¨ï¼Œäº‹åŠ¡åœ¨åº”ç”¨ä¸Šä¸‹æ–‡ä¸­ä¼ æ’­ã€‚â€æˆ‘å…ˆæŠ›å‡ºäº†ä¸€ä¸ªæ“¦è¾¹çƒç­”æ¡ˆä½œä¸ºå‰æˆï¼Œå‰æˆå®œé€Ÿæˆ˜é€Ÿå†³ä¸å®œæ‹æˆ˜ï¼Œåªä¸ºé“ºå«ç¬¬äºŒé˜¶æ®µçš„æ­£æˆã€‚</p><!-- [[[read_end]]] --><p>åœ¨å•ä½“åº”ç”¨é‡Œï¼Œä¸€ä¸ªäº‹åŠ¡ä»ç”Ÿåˆ°æ­»éƒ½æ˜¯åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œè¯´ç™½äº†å°±æ˜¯åœ¨åŒä¸€ä¸ªJVMè·‘äº†å„ç§CRUDæ“ä½œã€‚æˆ‘ä»¬åªéœ€è¦åœ¨æœåŠ¡å…¥å£å¤„çš„åˆ‡é¢ç‚¹ä¸Šé…ç½®ä¸€ä¸ª@Transactionalæ ‡ç­¾å°±å¯ä»¥å¼€å¯äº‹åŠ¡ç®¡ç†ï¼Œæ— å¤–ä¹å†é…ç½®ä¸‹äº‹åŠ¡çš„ä¼ æ’­æ€§ã€‚è¿™åªæ˜¯ä¸€ä¸ªåœ¨æœ¬åœ°æ§åˆ¶çš„Spring Transactionè€Œå·²ï¼Œæ²¡æœ‰å¤ªå¤šæŠ€æœ¯å«é‡ï¼Œå……å…¶é‡æ˜¯èƒ½ç®—ä½œä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ã€‚</p><p>ä¹Ÿè®¸ä½ å¹¶ä¸è§‰å¾—è¿™åœºå‰æˆå’Œåˆ†å¸ƒå¼äº‹åŠ¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œä½†æˆ‘è¿™é‡Œè¦æé†’ä½ çš„æ˜¯ï¼Œæˆ‘ä»¬çš„ç»ˆæè§£å†³æ–¹æ¡ˆSeataåˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶çš„ç§ç§ä¼ç¬”å°±åŸ‹è—äºæ­¤ã€‚<strong>å†å¤æ‚çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œç»ˆå°†å›å½’åˆ°è¿™æœ¬åœ°äº‹åŠ¡çš„åŸç‚¹ä¸Šã€‚</strong>ä¸ªä¸­å¥¥å¦™æš‚ä¸”ä¸è¡¨ï¼Œæˆ‘ä»¬åœ¨åé¢çš„è¯¾ç¨‹ä¸­ä¸€ä¸€é“æ¥ã€‚</p><p>â€œé‚£å¦‚æœä¸æ˜¯å•ä½“åº”ç”¨ï¼Œè€Œæ˜¯ç»è¿‡æ‹†åˆ†ä¹‹åçš„å¾®æœåŠ¡ï¼Œè·¨æœåŠ¡çš„äº‹åŠ¡å¦‚ä½•ä¿è¯ä¸€è‡´æ€§ï¼Ÿâ€å¦‚æˆ‘æ‰€æ–™ï¼Œæ“¦è¾¹çƒçš„å‰æˆå¹¶ä¸èƒ½æ»¡è¶³é¢è¯•å®˜çš„èƒƒå£ï¼Œä»–æ€¥åˆ‡çš„æƒ³è¦è¿›å…¥æ­£æˆã€‚</p><p>â€œæˆ‘å…ˆæ¥è¯´ä¸€è¯´ä¼ ç»Ÿçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œç„¶åå†ä¸€èµ·æ¢è®¨ä¸‹å¾®æœåŠ¡æ¶æ„ä¸‹çš„æ–°ä¸€ä»£æ–¹æ¡ˆã€‚â€è¿™ä¸€å¹•æ­£æˆï¼Œæˆ‘å°±ç”¨æ›¾ç»çº¢éå¤§æ±Ÿå—åŒ—çš„XAè§„èŒƒæ¥æ¼”ç»å§ã€‚</p><h2>ä¸€å¹•æ­£æˆ</h2><p>è¯´èµ·XAåè®®ï¼Œè¿™ä¸ªåè¯ä½ æœªå¿…å¬è¯´è¿‡ï¼Œä½†ä¸€æåˆ°2PCå’Œ3PCä½ å°±ç§’æ‡‚äº†ã€‚è¿™å°±æ˜¯å¤§å¤šæ•°é“¶è¡Œç³»ç»Ÿå’Œä¸Šäº†å¹´çºªçš„è€ç³»ç»Ÿæœ€å–œæ¬¢ä½¿ç”¨çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œè¿™å¥—æ–¹æ¡ˆä¾èµ–äºåº•å±‚æ•°æ®åº“çš„æ”¯æŒï¼ŒDBè¿™å±‚é¦–å…ˆå¾—è¦å®ç°XAåè®®ã€‚æ¯”å¦‚Oracle XAå’ŒMySQL InnoDBï¼Œéƒ½æ˜¯æ”¯æŒXAåè®®çš„æ•°æ®åº“æ–¹æ¡ˆã€‚ä½ å¯ä»¥æŠŠXAç†è§£ä¸ºä¸€ä¸ª<strong>å¼ºä¸€è‡´æ€§çš„ä¸­å¿ƒåŒ–åŸå­æäº¤åè®®ã€‚</strong></p><p>åŸå­æ€§çš„æ¦‚å¿µç‰¹åˆ«å¥½ç†è§£ï¼Œå°±æ˜¯æŠŠä¸€ç³»åˆ—æ“ä½œåˆå¹¶æˆä¸€ä¸ªæ•´ä½“ï¼Œè¦ä¹ˆéƒ½æ‰§è¡Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚è€Œæ‰€è°“çš„2PCå°±æ›´å¥½ç†è§£äº†ï¼Œå®ƒå°±æ˜¯æŠŠä¸€ä¸ªäº‹åŠ¡åˆ†æˆäº†ä¸¤æ­¥æ¥æäº¤ã€‚ç¬¬ä¸€æ­¥åšå‡†å¤‡åŠ¨ä½œï¼Œç¬¬äºŒæ­¥åšæäº¤/å›æ»šåŠ¨ä½œï¼Œè¿™ä¸¤æ­¥ä¹‹é—´çš„åè°ƒæ˜¯äº¤ç”±ä¸€ä¸ªä¸­å¿ƒåŒ–çš„Coordinatoræ¥ç®¡ç†ï¼Œä¿è¯å¤šæ­¥æ“ä½œçš„åŸå­æ€§ã€‚</p><p><strong>ç¬¬ä¸€æ­¥ï¼ˆPrepareï¼‰</strong>ï¼šCoordinatorå‘å„ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„å‚ä¸è€…ä¸‹è¾¾äº†PrepareæŒ‡ä»¤ï¼Œå„ä¸ªäº‹åŠ¡åˆ†åˆ«å°†SQLè¯­å¥åœ¨æ•°æ®åº“æ‰§è¡Œä½†ä¸æäº¤ï¼Œå¹¶ä¸”å°†å°±ç»ªçŠ¶æ€ä¸ŠæŠ¥ç»™Coordinatorã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/42/19/42fb5c890e79859089a0f09da75c3e19.jpg?wh=1920x725\" alt=\"å›¾ç‰‡\"></p><p><strong>ç¬¬äºŒæ­¥ï¼ˆCommit/Rollbackï¼‰</strong>ï¼šå¦‚æœæ‰€æœ‰èŠ‚ç‚¹éƒ½å·²å°±ç»ªï¼Œé‚£ä¹ˆCoordinatorå°±ä¸‹è¾¾CommitæŒ‡ä»¤ï¼Œå„ä¸ªå‚ä¸è€…æäº¤æœ¬åœ°äº‹åŠ¡ï¼›å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ä¸èƒ½å°±ç»ªï¼ŒCoordinatoråˆ™ä¸‹è¾¾RollbackæŒ‡ä»¤è¿›è¡Œæœ¬åœ°å›æ»šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/38/01/385ee9c2111509329438a467be169601.jpg?wh=1920x725\" alt=\"å›¾ç‰‡\"></p><p>æˆ‘ç”¨ä¸€ä¸ªå®é™…ä¾‹å­æ¥å¸®ä½ ç†è§£XAçš„è¿™ä¸¤æ­¥èµ°ã€‚è¯è¯´å¼ ä¸‰å’Œæå››ä¸¤ä¸ªäººå–å¤šäº†ï¼Œè¦å¹²æ¶ï¼Œæå››ä»¥ä¸€å¥â€œæœ‰æœ¬äº‹ä½ æ‰“æˆ‘â€å¼€å¯äº†ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ã€‚æ³•å¤–ç‹‚å¾’å¼ ä¸‰æŠ„èµ·ä¸€å•¤é…’ç“¶å«åˆ°â€œä¿¡ä¸ä¿¡æˆ‘å‰Šä½ ä¸«çš„ï¼â€ï¼ˆå¼ ä¸‰è¿›å…¥Prepareé˜¶æ®µå¹¶å°±ç»ªï¼‰ï¼Œæå››æŒ‡ç€è‡ªå·±è„‘è¢‹å›åº”åˆ°â€œæ¥æ¥æ¥ï¼Œç…§è¿™å‰Šâ€ï¼ˆæå››è¿›å…¥Prepareé˜¶æ®µå¹¶å°±ç»ªï¼‰ã€‚â€œå•ªï¼â€ï¼ˆå¼ ä¸‰Commitäº‹åŠ¡ï¼‰ï¼Œâ€œå“å‘¦ï¼â€ï¼ˆæå››Commitäº‹åŠ¡ï¼‰ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡å®Œæˆã€‚</p><p>è¿™ç§åˆ†å¸ƒå¼äº‹åŠ¡æœ‰ä¸€ä¸ªå¤©ç„¶ç¼ºé™·ï¼Œå¯¼è‡´XAç‰¹åˆ«ä¸é€‚åˆç”¨åœ¨äº’è”ç½‘çš„é«˜å¹¶å‘åœºæ™¯é‡Œé¢ã€‚å› ä¸ºæ¯ä¸ªæœ¬åœ°äº‹åŠ¡åœ¨Prepareé˜¶æ®µï¼Œéƒ½è¦ä¸€ç›´å ç”¨ä¸€ä¸ªæ•°æ®åº“è¿æ¥èµ„æºï¼Œè¿™ä¸ªèµ„æºç›´åˆ°äºŒé˜¶æ®µCommitæˆ–è€…Rollbackä¹‹åæ‰ä¼šè¢«é‡Šæ”¾ã€‚è¯•æƒ³ï¼Œå¼ ä¸‰è¿›å…¥Prepareé˜¶æ®µå°±è¦æ¡ç€ä¸€ä¸ªå•¤é…’ç“¶ï¼Œä»å¼ ä¸‰çš„è§’åº¦æ¥è¯´ï¼Œæå››ä¸å°±ç»ªä»–å°±è¦ä¸€ç›´æ¡ç€è¿™ä¸ªç“¶å­ï¼ˆä¹Ÿå°±æ˜¯æœ¬åœ°äº‹åŠ¡æ—¶é—´é•¿ï¼‰ã€‚</p><p>ä½†äº’è”ç½‘åœºæ™¯çš„ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿé«˜å¹¶å‘ï¼å› ä¸ºå¹¶å‘é‡ç‰¹åˆ«é«˜ï¼Œæ‰€ä»¥æ¯ä¸ªäº‹åŠ¡å¿…é¡»å°½å¿«é‡Šæ”¾æ‰æ‰€æŒæœ‰çš„æ•°æ®åº“è¿æ¥èµ„æºã€‚äº‹åŠ¡æ‰§è¡Œæ—¶é—´è¶ŠçŸ­è¶Šå¥½ï¼Œè¿™æ ·æ‰èƒ½è®©åˆ«çš„äº‹åŠ¡å°½å¿«è¢«æ‰§è¡Œã€‚å› ä¸ºä»å•¤é…’ç“¶çš„è§’åº¦æ¥çœ‹ï¼Œé…’ç“¶ï¼ˆæ•°æ®åº“è¿æ¥èµ„æºï¼‰æ˜¯æœ‰é™çš„ï¼Œæ€»è¢«é•¿äº‹åŠ¡å ç”¨ç€ï¼Œå…¶å®ƒç‹äº”èµµå…­çš„ç­‰ä¸åˆ°ç“¶å­å°±å¹²ä¸æˆæ¶ï¼Œè¿™è‚¯å®šä¸æˆã€‚</p><p>é‚£æœ‰ä»€ä¹ˆæ–¹æ³•<strong>æ—¢èƒ½é™ä½äº‹åŠ¡æ‰§è¡Œæ—¶é—´ï¼Œåˆèƒ½ä¿è¯ä¸€è‡´æ€§å‘¢</strong>ï¼Ÿæœ‰æ—¶å€™é¢å¯¹å¤æ‚çš„é—®é¢˜ï¼Œæˆ‘ä»¬åªè¦å›å½’åˆ°é—®é¢˜çš„æœ¬æºï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿå°±è¿åˆƒè€Œè§£äº†ã€‚è¿™å°±å«ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ç¯ç«é˜‘çŠå¤„ã€‚è¿™ä¸ªäººï¼Œå°±æ˜¯å‰æˆé‡Œæåˆ°çš„é‚£ä¸ªä¸èµ·çœ¼çš„æœ¬åœ°äº‹åŠ¡ã€‚</p><h2>é«˜æ½®æœªå°½</h2><p>å…¶å®é¢å¯¹ä»»ä½•ä¸€ä¸ªå¤æ‚çš„é—®é¢˜ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡â€œå¤§äº‹åŒ–å°å°äº‹åŒ–äº†â€çš„æ€æƒ³ï¼ŒæŠŠå¤§é—®é¢˜ä¸€æ­¥æ­¥æ‹†è§£æˆä¸€ä¸ªä¸ªå°é—®é¢˜æ¥è§£å†³æ‰ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘è¦æåˆ°çš„Seataåˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚</p><p>åˆ†å¸ƒå¼äº‹åŠ¡æ‰€è¦è§£å†³çš„é—®é¢˜ï¼Œä¸å°±æ˜¯è·¨æœåŠ¡è·¨DBçš„äº‹åŠ¡ä¸€è‡´æ€§ä¹ˆï¼Ÿé‚£ä¹ˆæˆ‘ä»¬å°±æŠŠè¿™ä¸ªåœºæ™¯åšä¸€å±‚æŠ½è±¡ï¼ŒæŠŠåˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸šåŠ¡æ¨¡å‹ç®€åŒ–æˆâ€œå…¨å±€äº‹åŠ¡â€å’Œâ€œåˆ†æ”¯äº‹åŠ¡â€ä¸¤éƒ¨åˆ†ï¼Œç°åœ¨è®©ä½ ç¡®ä¿ä¸¤è€…çš„ä¸€è‡´æ€§æ€ä¹ˆåšï¼Ÿå¾ˆç®€å•ï¼Œä½ æŠŠè¿™äº›ä¸ªåˆ†æ”¯äº‹åŠ¡çœ‹æˆè‘«èŠ¦å¨ƒä¸ƒå…„å¼Ÿï¼Œä¸æ±‚åŒå¹´åŒæœˆåŒæ—¥ç”Ÿï¼Œä½†æ±‚åŒå¹´åŒæœˆåŒæ—¥æ­»ã€‚åˆ†æ”¯äº‹åŠ¡å…¨æˆåŠŸ=å…¨å±€äº‹åŠ¡æˆåŠŸï¼Œä½†å‡¡ä¸€ä¸ªåˆ†æ”¯äº‹åŠ¡å¤±è´¥ï¼Œé‚£ä¹ˆå…¶ä½™çš„åˆ†æ”¯äº‹åŠ¡å…¨éƒ¨å›æ»šã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b5/f7/b594989fece43798730204670bf4a9f7.jpg?wh=1920x455\" alt=\"å›¾ç‰‡\"></p><p>è¿™å°±æ˜¯å„ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶éƒ½åœ¨é‡‡ç”¨çš„åŸºç¡€æ¨¡å‹ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªç®€åŒ–åçš„ä¸šåŠ¡æ¨¡å‹ä¸Šå†åšæŠŠé—®é¢˜åšä¸€ç•ªæ‹†è§£ï¼ŒæŠŠç›®å…‰èšç„¦åœ¨åˆ†æ”¯äº‹åŠ¡æœ¬è´¨ä¸Šã€‚ä»å•ä¸ªåˆ†æ”¯äº‹åŠ¡çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒä¸å°±æ˜¯æˆ‘åœ¨å‰æˆé‡Œè®²åˆ°çš„æœ¬åœ°äº‹åŠ¡ä¹ˆï¼Ÿé‚£ä¹ˆç°åœ¨ä½ æƒ³ä¸€ä¸‹ï¼Œå®Œæˆä¸€æ¬¡æœ¬åœ°äº‹åŠ¡çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›æ­¥éª¤ï¼Ÿä¸¤æ­¥è€Œå·²ï¼Œæ‰§è¡ŒSQL-&gt;Commit/Rollbackã€‚</p><p>ä»æœ¬åœ°äº‹åŠ¡çš„è§’åº¦æ¥çœ‹ï¼ŒXAæ–¹æ¡ˆçš„æœ¬è´¨æ˜¯åœ¨â€œæ‰§è¡ŒSQLâ€åˆ°â€œCommit/Rollbackâ€è¿™ä¸¤æ­¥ä¹‹é—´å§‹ç»ˆæ¡ç€DBäº‹åŠ¡ä¸æäº¤ï¼Œç›´åˆ°æ‰€æœ‰åˆ†æ”¯å…¨éƒ¨readyä¹‹åå†Commitã€‚æ‰€ä»¥ï¼ŒXAæ˜¯é€šè¿‡â€œé•¿äº‹åŠ¡â€æ¥ä¿è¯ä¸€è‡´æ€§çš„ã€‚</p><p>å¦‚å¤©é¾™å…«éƒ¨é‡Œæ— å´–å­æ‘†ä¸‹çš„çç‘æ£‹å±€ä¸€èˆ¬ï¼Œç ´å±€ä¹‹é“ä¹ƒç½®ä¹‹æ­»åœ°è€Œåç”Ÿä¹Ÿï¼ŒSeataæ–¹æ¡ˆçš„ç ´å±€ä¹‹é“å°±æ˜¯è¿™ä¸ªé•¿äº‹åŠ¡ï¼XAå¼•å…¥â€œé•¿äº‹åŠ¡â€çš„æœ¬è´¨æ˜¯ä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œä½†å‰é¢æˆ‘ä»¬è¯´åˆ°è¿‡ï¼Œé•¿äº‹åŠ¡åœ¨è¶…é«˜å¹¶å‘çš„äº’è”ç½‘åœºæ™¯ä¸­ä¸æ€ä¹ˆå—å¾…è§ã€‚ä½ ä¸æ˜¯å¾ˆé•¿å—ï¼Ÿé‚£æˆ‘å°±åè¦æŠŠä½ æœ€é•¿çš„åœ°æ–¹ç»™å‰ªçŸ­ã€‚</p><p>å¦‚æœå¯ä»¥æŠŠâ€œé•¿äº‹åŠ¡â€å˜æˆè‹¥å¹²ä¸ªâ€œçŸ­äº‹åŠ¡â€ï¼Œå°†â€œæ‰§è¡ŒSQLâ€å’Œâ€œCommit/Rollbackâ€é€šè¿‡å¤šä¸ªæœ¬åœ°äº‹åŠ¡æ¥æ§åˆ¶ï¼Œä¸å°±å¯ä»¥è§£å†³é—®é¢˜äº†å—ï¼Ÿæˆ‘ä»¬é¡ºç€è¿™ä¸ªæ€è·¯ç»§ç»­å¾€ä¸‹æ‹†è§£ã€‚</p><p>åœ¨é¼é¼å¤§åçš„CAPå¤§å®šç†ä¸­ï¼Œâ€œé•¿äº‹åŠ¡â€æ˜¯å…¸å‹çš„åå‘CPä¾§çš„å¼ºä¸€è‡´æ€§æ–¹æ¡ˆã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦æ‰“ç ´é•¿äº‹åŠ¡çš„æŸç¼šï¼Œå°±å¿…é¡»å°†â€œå¼ºä¸€è‡´æ€§â€æ”¹ä¸ºâ€œæœ€ç»ˆä¸€è‡´æ€§â€æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯åå‘APä¾§çš„æ–¹æ¡ˆã€‚<strong>æœ€ç»ˆä¸€è‡´æ€§æ˜¯ä¸€ç§å…¼é¡¾ä¸€è‡´æ€§å’Œå¯ç”¨æ€§çš„ç­–ç•¥</strong>ï¼Œå®ƒå…è®¸åº”ç”¨äº§ç”ŸçŸ­æœŸçš„ä¸ä¸€è‡´æ€§ï¼Œç„¶ååœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´å°†è¾¾æˆâ€œæœ€ç»ˆä¸€è‡´â€çš„çŠ¶æ€ï¼Œé€šè¿‡ç‰ºç‰²å¼ºä¸€è‡´æ€§æ¥æ¢å–é«˜å¯ç”¨æ€§ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/2a/a6/2a84cf6436e81f1c6aa7de8c5d6710a6.jpg?wh=1920x634\" alt=\"å›¾ç‰‡\"></p><p>æˆ‘ä»¬å¯ä»¥æŠŠæ‰§è¡Œäº‹åŠ¡ã€æäº¤äº‹åŠ¡å’Œå›æ»šäº‹åŠ¡æ”¾åˆ°ä¸‰ä¸ªä¸åŒçš„åˆ†æ”¯äº‹åŠ¡ä¸­ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªåˆ†æ”¯äº‹åŠ¡éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„Transactionï¼Œä¸€ä¸ªåˆ†æ”¯äº‹åŠ¡æ‰§è¡Œå®Œæ¯•å°±ä¼šè¿…é€Ÿé‡Šæ”¾æ‰æ•°æ®åº“è¿æ¥èµ„æºã€‚è¿™æ ·ä¸€æ¥ï¼ŒåŸæœ¬æ¨ªè·¨Execute-Commit-Rollbackçš„ä¸€ä¸ªé•¿äº‹åŠ¡ï¼Œå°±è¢«æ‹†åˆ†æˆäº†ä¸‰ä¸ªç‹¬ç«‹çš„åˆ†æ”¯äº‹åŠ¡ã€‚</p><p>é‚£ä¹ˆè°æ¥æ§åˆ¶Execute-Commit-Rollbackçš„æ‰§è¡Œå‘¢ï¼Ÿè¿™ä¸ªä»»åŠ¡ï¼Œå°±äº¤ç»™ä¸­å¿ƒåŒ–çš„Transaction Coordinatoræ¥åšå°±å¥½äº†ã€‚ç°åœ¨ä½ ä¸å¿…å…³å¿ƒå®ƒæ˜¯æ€ä¹ˆåšçš„ï¼Œä½ åªè¦è®°ä½Seataæ–¹æ¡ˆæœ‰è¿™ä¹ˆä¸ªç»„ä»¶å°±æˆäº†ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å°±ä¸“é—¨å»æ­å»ºè¿™ä¸ªä¸œè¥¿ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬åªå‰©ä¸‹æœ€åä¸€ä¸ªçµé­‚æ‹·é—®äº†ï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿæ˜¯Seataåˆ†å¸ƒå¼äº‹åŠ¡çš„æ ¸å¿ƒé—®é¢˜ã€‚ä½ çŸ¥é“Executeã€Commitå’ŒRollbackåˆ†æ”¯äº‹åŠ¡ç©¶ç«Ÿè¦æ‰§è¡Œä»€ä¹ˆSQLå‘¢ï¼Ÿæ¢å¥è¯è¯´ï¼Œå¦‚ä½•å°†æœ¬åœ°SQLæ‹†åˆ†ä¸ºä¸‰é˜¶æ®µå»æ‰§è¡Œå‘¢ï¼Ÿ</p><p>åœ¨ç­”æ¡ˆå‘¼ä¹‹æ¬²å‡ºä¹‹æ—¶ï¼Œåœ¨ä½ ä»¥ä¸ºé©¬ä¸Šå°±è¦è¿æ¥è¿™éƒ¨å‰§çš„é«˜æ½®ä¹‹é™…ï¼Œè¿™ç¯‡æ–‡ç« å´å·²æ‚„ç„¶è½å¹•ã€‚æ–¹æ‰æç„¶å¤§æ‚Ÿï¼ŒåŸæ¥ä»å¼€ç¯‡åˆ°ç°åœ¨ï¼Œæˆ‘æ¼”ç»çš„åªæ˜¯è¿™éƒ¨èˆå°å‰§çš„ä¸€æ®µå‰æˆè€Œå·²ã€‚ä¸‹èŠ‚è¯¾æˆ‘ä»¬å°†æ­£å¼æ‹‰å¼€ä¸‹ä¸€å¹•å¤§æˆï¼šSeataåŒæ–™ç‹ç‰Œä¹‹ATæ— ä¾µå…¥å¼æ–¹æ¡ˆ + TCCæŸ”æ€§äº‹åŠ¡ã€‚å¾…æˆ‘ä¸ä½ å†ç»­å‰ç¼˜ã€‚</p>","neighbors":{"left":{"article_title":"31 | æ¶ˆæ¯é©±åŠ¨ï¼šå¦‚ä½•é€šè¿‡ RabbitMQ æ’ä»¶å®ç°å»¶è¿Ÿæ¶ˆæ¯ï¼Ÿ","id":489022},"right":{"article_title":"33 | åˆ†å¸ƒå¼äº‹åŠ¡ï¼šæ­å»º Seata æœåŠ¡å™¨","id":490315}},"comments":[{"had_liked":false,"id":337928,"user_name":"Heavenï¼‡s Fall","can_delete":false,"product_type":"c1","uid":2922397,"ip_address":"","ucode":"14EF5C82674229","user_header":"https://static001.geekbang.org/account/avatar/00/2c/97/9d/9fe599dc.jpg","comment_is_top":false,"comment_ctime":1647163007,"is_pvip":false,"replies":[{"id":"123557","content":"å¾ˆåŒæ„åŒå­¦çš„è¿™ä¸ªè§‚ç‚¹ï¼Œæˆ‘åœ¨åé¢seataå®æˆ˜çš„æ–‡ç« ä¸­æ——å¸œé²œæ˜çš„è¡¨è¾¾äº†ä¸€ä¸ªè§‚ç‚¹ï¼Œå¦‚æœèƒ½é€šè¿‡äº‹åŠ¡å‹æ¶ˆæ¯ã€è¡¥å¿è·‘æ‰¹ã€æ—¥å¿—è¡¨çš„æ–¹å¼ä¿è¯ä¸€è‡´æ€§ï¼Œæœ€å¥½ä¸è¦ä¸Šé‡é‡çº§çš„åˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆï¼Œå¼€å‘ç»´æŠ¤æˆæœ¬éƒ½å¾ˆé«˜ã€‚<br><br>é™¤æ­¤ä¹‹å¤–å‘¢ï¼Œè¿˜æœ‰ä¸€ç‚¹æ˜¯äº‹åŠ¡å‹æ¶ˆæ¯ä¸èƒ½æ›¿ä»£çš„åœºæ™¯ã€‚äº‹åŠ¡å‹æ¶ˆæ¯å¯ä»¥ä¿è¯â€œä¸šåŠ¡æ‰§è¡Œâ€å’Œâ€œæ¶ˆæ¯è¢«æ¶ˆè´¹â€è¿™ä¸¤ä¸ªäº‹ä»¶çš„åŸå­æ€§ï¼Œä½†è¿™æ˜¯å»ºç«‹åœ¨æ¶ˆæ¯é©±åŠ¨çš„åœºæ™¯ä¹‹ä¸Šï¼Œéœ€è¦å°†æ•´ä¸ªåœºæ™¯éƒ½åŸºäºå¼‚æ­¥æ¶ˆæ¯æ¥å®ç°ã€‚è€Œå¾®æœåŠ¡æ˜¯åŸºäºAPIè°ƒç”¨çš„æ–¹å¼ï¼Œæ‰€ä»¥è·¨APIè°ƒç”¨çš„éæ¶ˆæ¯é©±åŠ¨åœºæ™¯çš„ä¸€è‡´æ€§ï¼Œseataå°±æœ‰ç”¨æ­¦ä¹‹åœ°äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2819998","ctime":1647182122,"ip_address":"","comment_id":337928,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31711934079","product_id":100101301,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹<br>æˆ‘ä»¬ä¼ ç»Ÿçš„æœåŠ¡é—´è°ƒç”¨å¯ä»¥é€šè¿‡è°ƒç”¨æœåŠ¡å¤±è´¥äº†ä½¿ç”¨æœ¬åœ°äº‹åŠ¡å›æ»šä¸šåŠ¡ï¼ˆæ¯”å¦‚æœåŠ¡Aè°ƒç”¨æœåŠ¡Bï¼ŒæœåŠ¡Bå¤±è´¥äº†æˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡Aä¸Šå›æ»šä¸šåŠ¡ï¼Œç„¶åå†å‘ä¸Šæ¸¸æŠ¥å‘Šä¸šåŠ¡å¤±è´¥ã€‚ã€‚ã€‚ï¼‰<br>ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„æƒ…å†µä¹Ÿå¯ä»¥ä½¿ç”¨äº‹åŠ¡å‹æ¶ˆæ¯ä¿è¯ä¸€è‡´æ€§<br>ä¸ºå•¥è¿˜éœ€è¦è¿™æ ·ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„æ¡†æ¶å¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦å‘¢ï¼Ÿ","like_count":7,"discussions":[{"author":{"id":2819998,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/07/9e/d2de2832.jpg","nickname":"å§šåŠä»™","note":"","ucode":"4C86AA5D6D8C39","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556057,"discussion_content":"å¾ˆåŒæ„åŒå­¦çš„è¿™ä¸ªè§‚ç‚¹ï¼Œæˆ‘åœ¨åé¢seataå®æˆ˜çš„æ–‡ç« ä¸­æ——å¸œé²œæ˜çš„è¡¨è¾¾äº†ä¸€ä¸ªè§‚ç‚¹ï¼Œå¦‚æœèƒ½é€šè¿‡äº‹åŠ¡å‹æ¶ˆæ¯ã€è¡¥å¿è·‘æ‰¹ã€æ—¥å¿—è¡¨çš„æ–¹å¼ä¿è¯ä¸€è‡´æ€§ï¼Œæœ€å¥½ä¸è¦ä¸Šé‡é‡çº§çš„åˆ†å¸ƒå¼äº‹åŠ¡æ–¹æ¡ˆï¼Œå¼€å‘ç»´æŠ¤æˆæœ¬éƒ½å¾ˆé«˜ã€‚\n\né™¤æ­¤ä¹‹å¤–å‘¢ï¼Œè¿˜æœ‰ä¸€ç‚¹æ˜¯äº‹åŠ¡å‹æ¶ˆæ¯ä¸èƒ½æ›¿ä»£çš„åœºæ™¯ã€‚äº‹åŠ¡å‹æ¶ˆæ¯å¯ä»¥ä¿è¯â€œä¸šåŠ¡æ‰§è¡Œâ€å’Œâ€œæ¶ˆæ¯è¢«æ¶ˆè´¹â€è¿™ä¸¤ä¸ªäº‹ä»¶çš„åŸå­æ€§ï¼Œä½†è¿™æ˜¯å»ºç«‹åœ¨æ¶ˆæ¯é©±åŠ¨çš„åœºæ™¯ä¹‹ä¸Šï¼Œéœ€è¦å°†æ•´ä¸ªåœºæ™¯éƒ½åŸºäºå¼‚æ­¥æ¶ˆæ¯æ¥å®ç°ã€‚è€Œå¾®æœåŠ¡æ˜¯åŸºäºAPIè°ƒç”¨çš„æ–¹å¼ï¼Œæ‰€ä»¥è·¨APIè°ƒç”¨çš„éæ¶ˆæ¯é©±åŠ¨åœºæ™¯çš„ä¸€è‡´æ€§ï¼Œseataå°±æœ‰ç”¨æ­¦ä¹‹åœ°äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1647182122,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336030,"user_name":"å¤šå–çƒ­æ°´","can_delete":false,"product_type":"c1","uid":1297375,"ip_address":"","ucode":"8DB7DB144B7E30","user_header":"https://static001.geekbang.org/account/avatar/00/13/cb/df/e72646dd.jpg","comment_is_top":false,"comment_ctime":1645856031,"is_pvip":false,"replies":[{"id":"122901","content":"å°±çœ‹å›½å®¶ä»€ä¹ˆæ—¶å€™å¼€å§‹ä¸‹ä¸€æ¬¡å‡€ç½‘è¡ŒåŠ¨äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2819998","ctime":1646051856,"ip_address":"","comment_id":336030,"utype":1}],"discussion_count":2,"race_medal":0,"score":"31710627103","product_id":100101301,"comment_content":"è®²çš„çœŸå¥½ï¼Œç”Ÿæ€•å“ªå¤©è¿™èŠ‚å°±ä¸è§äº†ğŸ˜‚ğŸ˜‚ğŸ˜‚","like_count":7,"discussions":[{"author":{"id":2819998,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/07/9e/d2de2832.jpg","nickname":"å§šåŠä»™","note":"","ucode":"4C86AA5D6D8C39","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553753,"discussion_content":"å°±çœ‹å›½å®¶ä»€ä¹ˆæ—¶å€™å¼€å§‹ä¸‹ä¸€æ¬¡å‡€ç½‘è¡ŒåŠ¨äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1646051856,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1045577,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f4/49/2add4f6b.jpg","nickname":"åŒ—æçš„å¤§ä¼é¹…","note":"","ucode":"8935346D08E109","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":559303,"discussion_content":"è¯­éŸ³å¬åˆ°ä¸€åŠï¼Œå£°éŸ³æˆ›ç„¶è€Œæ­¢ï¼Œå“¦ï¼Œè¯¥ä¸‹ä¸€èŠ‚è¯¾äº†å•Šã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648695792,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336311,"user_name":"è–›å®šè°”çš„ç–¯å…”å­","can_delete":false,"product_type":"c1","uid":1904140,"ip_address":"","ucode":"BEF678D50400F5","user_header":"https://static001.geekbang.org/account/avatar/00/1d/0e/0c/4ec2075f.jpg","comment_is_top":false,"comment_ctime":1646062085,"is_pvip":true,"replies":[{"id":"123091","content":"ä¹Ÿå°±è¿™ä¸€ç¯‡æ–‡ç« æ˜¯æˆ‘é è‡ªå·±æ„å¿—å†™çš„ï¼Œå…¶å®ƒéƒ½å¾—éµå¾ªå¹³å°çš„èŒƒå¼ï¼Œæ‘Šæ‰‹~","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2819998","ctime":1646405184,"ip_address":"","comment_id":336311,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10235996677","product_id":100101301,"comment_content":"å“ˆå“ˆ è€å¸ˆè¯´è¯è´¼æœ‰æ„æ€","like_count":2,"discussions":[{"author":{"id":2819998,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/07/9e/d2de2832.jpg","nickname":"å§šåŠä»™","note":"","ucode":"4C86AA5D6D8C39","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554497,"discussion_content":"ä¹Ÿå°±è¿™ä¸€ç¯‡æ–‡ç« æ˜¯æˆ‘é è‡ªå·±æ„å¿—å†™çš„ï¼Œå…¶å®ƒéƒ½å¾—éµå¾ªå¹³å°çš„èŒƒå¼ï¼Œæ‘Šæ‰‹~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646405184,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":342619,"user_name":"ç‰›å¹´æ¦´è²","can_delete":false,"product_type":"c1","uid":1183703,"ip_address":"","ucode":"230C076193C6C0","user_header":"https://static001.geekbang.org/account/avatar/00/12/0f/d7/31d07471.jpg","comment_is_top":false,"comment_ctime":1650366445,"is_pvip":false,"replies":[{"id":"125464","content":"å“ˆå“ˆé¢è¯•å˜›ï¼Œå°±å¾€æ­»é‡Œå¹å°±æˆäº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2819998","ctime":1651033905,"ip_address":"","comment_id":342619,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5945333741","product_id":100101301,"comment_content":"è€å¸ˆé¢è¯•å¥—è·¯æ·±å•Šï¼","like_count":2,"discussions":[{"author":{"id":2819998,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/07/9e/d2de2832.jpg","nickname":"å§šåŠä»™","note":"","ucode":"4C86AA5D6D8C39","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":567955,"discussion_content":"å“ˆå“ˆé¢è¯•å˜›ï¼Œå°±å¾€æ­»é‡Œå¹å°±æˆäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651033905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":337591,"user_name":"Lonely_ZJ","can_delete":false,"product_type":"c1","uid":1340614,"ip_address":"","ucode":"370AD90A8302B9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ6Gia1LtqJmDNlFqdd07hibCibY5z8DSoXd8c639Libe5LC3xtuEzzaeicjGCuv2F5IYDZhGxNrukVogg/132","comment_is_top":false,"comment_ctime":1646905450,"is_pvip":false,"replies":[{"id":"123400","content":"æ¡ä¸ªçˆªåŒå­¦ï¼å’±ä¿©æ˜¯æ–‡åŒ–äººå„¿ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2819998","ctime":1646995135,"ip_address":"","comment_id":337591,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5941872746","product_id":100101301,"comment_content":"ç™¾å¹´å­¤ç‹¬å¼çš„å¼€å¤´å¤ªæœ‰å–œæ„Ÿå•¦~","like_count":1,"discussions":[{"author":{"id":2819998,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/07/9e/d2de2832.jpg","nickname":"å§šåŠä»™","note":"","ucode":"4C86AA5D6D8C39","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555626,"discussion_content":"æ¡ä¸ªçˆªåŒå­¦ï¼å’±ä¿©æ˜¯æ–‡åŒ–äººå„¿ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646995135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":354721,"user_name":"æ¨å¦","can_delete":false,"product_type":"c1","uid":1640991,"ip_address":"é™•è¥¿","ucode":"D734D8512B27D6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/GkMk4gBlfZcljsY3Vqu7w6GM4qd7QjEy4X6c25jdtEowhjyTzOeIBDFXYcleXmfF1qFicaI8gz5k2TkUgvAYibNQ/132","comment_is_top":false,"comment_ctime":1660717409,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1660717409","product_id":100101301,"comment_content":"è¿™ä¸€è®²çœ‹çš„æˆ‘é…£ç•…æ·‹æ¼“","like_count":0},{"had_liked":false,"id":347489,"user_name":"è¯´è¯çš„é±¼","can_delete":false,"product_type":"c1","uid":1388522,"ip_address":"","ucode":"6AAAF108DB678C","user_header":"https://static001.geekbang.org/account/avatar/00/15/2f/ea/a5173a49.jpg","comment_is_top":false,"comment_ctime":1654073571,"is_pvip":true,"replies":[{"id":"126734","content":"ç®€ç›´æ˜¯é£éªšå¥½å˜›","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2819998","ctime":1654238329,"ip_address":"","comment_id":347489,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1654073571","product_id":100101301,"comment_content":"è¿™èŠ‚è¯¾çœŸçš„æ˜¯é£è¶£ï¼Œæœ‰å¤é¾™å°è¯´è¯­è¨€é£èŒƒ","like_count":0,"discussions":[{"author":{"id":2819998,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/07/9e/d2de2832.jpg","nickname":"å§šåŠä»™","note":"","ucode":"4C86AA5D6D8C39","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574674,"discussion_content":"ç®€ç›´æ˜¯é£éªšå¥½å˜›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654238329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":345610,"user_name":"Black Jack","can_delete":false,"product_type":"c1","uid":2845977,"ip_address":"","ucode":"CB16C8F44EF422","user_header":"https://static001.geekbang.org/account/avatar/00/2b/6d/19/204b0900.jpg","comment_is_top":false,"comment_ctime":1652430867,"is_pvip":true,"replies":[{"id":"126171","content":"é«˜å…´çš„ä¸€æ‰¹å¥½ä¹ˆï¼Œè¿™ç¯‡æ˜¯æˆ‘å†²ç ´æå®¢çš„å‚»é¸Ÿâ€œå†™ä½œèŒƒå¼â€ï¼Œç”¨çœŸå®æ„å¿—å†™çš„ã€‚ã€‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2819998","ctime":1652585035,"ip_address":"","comment_id":345610,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1652430867","product_id":100101301,"comment_content":"è€å¸ˆï¼Œçœ‹èµ·æ¥å¿ƒæƒ…ä¸é”™å•Š","like_count":0,"discussions":[{"author":{"id":2819998,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/07/9e/d2de2832.jpg","nickname":"å§šåŠä»™","note":"","ucode":"4C86AA5D6D8C39","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572056,"discussion_content":"é«˜å…´çš„ä¸€æ‰¹å¥½ä¹ˆï¼Œè¿™ç¯‡æ˜¯æˆ‘å†²ç ´æå®¢çš„å‚»é¸Ÿâ€œå†™ä½œèŒƒå¼â€ï¼Œç”¨çœŸå®æ„å¿—å†™çš„ã€‚ã€‚ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1652585036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":344668,"user_name":"å¥”è·‘çš„å°é»„ç‰›","can_delete":false,"product_type":"c1","uid":1104869,"ip_address":"","ucode":"C4E014CA41CB66","user_header":"https://static001.geekbang.org/account/avatar/00/10/db/e5/26c2f7de.jpg","comment_is_top":false,"comment_ctime":1651717394,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1651717394","product_id":100101301,"comment_content":"è‡ªå·±çœ‹ä¹¦æœ‰äº›çŸ¥è¯†ç‚¹çœ‹ä¸æ‡‚ï¼Œçœ‹è€å¸ˆçš„æ–‡ç« ä¸€ä¸‹å°±æ‡‚äº†ã€‚","like_count":0},{"had_liked":false,"id":342004,"user_name":"æŠ€æœ¯æ˜¯ä¼™ä¼´","can_delete":false,"product_type":"c1","uid":1641193,"ip_address":"","ucode":"3B38709BC88C8C","user_header":"https://static001.geekbang.org/account/avatar/00/19/0a/e9/6fad9109.jpg","comment_is_top":false,"comment_ctime":1649948032,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649948032","product_id":100101301,"comment_content":"è®²çš„å¾ˆå¥½å•Šï¼Œæœ‰è¶£ï¼Œæœ‰æ–™","like_count":0},{"had_liked":false,"id":338302,"user_name":"å¼ å¹³","can_delete":false,"product_type":"c1","uid":2619322,"ip_address":"","ucode":"4A600617F69991","user_header":"https://static001.geekbang.org/account/avatar/00/27/f7/ba/08044ec3.jpg","comment_is_top":false,"comment_ctime":1647414545,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1647414545","product_id":100101301,"comment_content":"æœ‰ç‚¹è®²è¯„ä¹¦çš„æ„Ÿè§‰ï¼Œéå¸¸ä¸é”™ï¼›","like_count":0},{"had_liked":false,"id":335873,"user_name":"peter","can_delete":false,"product_type":"c1","uid":1058183,"ip_address":"","ucode":"261C3FC001DE2D","user_header":"https://static001.geekbang.org/account/avatar/00/10/25/87/f3a69d1b.jpg","comment_is_top":false,"comment_ctime":1645750988,"is_pvip":true,"replies":[{"id":"123080","content":"ç»™åŒå­¦ä¸€ä¸ªå­¦ä¹ çš„å°å»ºè®®ï¼Œå…¶å®è¿™é‡Œå¾ˆå¤šé—®é¢˜éƒ½æ˜¯éå¸¸ç®€å•çš„åªè¦ç™¾åº¦ä¸€ä¸‹å°±èƒ½è·å¾—çš„ç­”æ¡ˆï¼Œæœ‰é—®é¢˜è¯´æ˜è¯¾æ–‡è®¤çœŸè¯»äº†ï¼Œä½†æ˜¯å¦‚æœèƒ½å…ˆè‡ªå·±å¯¹é—®é¢˜åšä¸€ä¸‹è°ƒç ”ï¼Œä¹Ÿæ˜¯æé«˜è§£å†³é—®é¢˜çš„èƒ½åŠ›çš„ä¸€ç§æ–¹å¼ã€‚<br><br>æ¯”å¦‚ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå°±å¯ä»¥è½¬åŒ–ä¸ºmysqléƒ½æœ‰å“ªäº›å¼•æ“ï¼Œä»–ä»¬ä¹‹é—´å·®åˆ«æ˜¯ä»€ä¹ˆï¼Œå“ªäº›æ”¯æŒäº‹åŠ¡å“ªäº›ä¸æ”¯æŒï¼Œè¿›è€Œå†äº†è§£ä¸€ä¸‹æ•°æ®åº“çš„äº‹åŠ¡ä¼ æ’­æ€§å’Œcommitçº§åˆ«ã€‚<br><br>ç¬¬äºŒä¸ªé—®é¢˜commitå¤±è´¥ä¹‹åå°±å›æ»šï¼Œå› ä¸ºäº‹åŠ¡æ²¡æäº¤ï¼Œå’Œæœ¬åœ°äº‹åŠ¡å›æ»šä¸€æ ·çš„æµç¨‹","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"2819998","ctime":1646403758,"ip_address":"","comment_id":335873,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1645750988","product_id":100101301,"comment_content":"è¯·æ•™è€å¸ˆä¸¤ä¸ªé—®é¢˜ï¼š<br>Q1ï¼šMySQLåªæœ‰InnoDBå¼•æ“æ”¯æŒXAåè®®å—ï¼Ÿ<br>æ–‡ä¸­æœ‰è¿™æ ·ä¸€å¥ï¼šâ€œDB è¿™å±‚é¦–å…ˆå¾—è¦å®ç° XA åè®®ã€‚æ¯”å¦‚ Oracle XA å’Œ MySQL InnoDBï¼Œéƒ½æ˜¯æ”¯æŒ XA åè®®çš„æ•°æ®åº“æ–¹æ¡ˆã€‚â€ã€‚<br>MySQLæ”¯æŒå¤šç§å­˜å‚¨å¼•æ“ï¼Œä»è¿™å¥è¯çœ‹ï¼Œä¼¼ä¹åªæœ‰InnoDBæ”¯æŒXAåè®®äº†ï¼Œæ˜¯å—ï¼Ÿ<br>Q2ï¼š2PCæ–¹æ¡ˆä¸­ï¼Œå¦‚æœcommité˜¶æ®µå‡ºç°é—®é¢˜ï¼Œä¼šæ˜¯ä»€ä¹ˆç»“æœï¼Ÿå¦‚æœæœ‰é—®é¢˜æ€ä¹ˆè§£å†³ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2819998,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/07/9e/d2de2832.jpg","nickname":"å§šåŠä»™","note":"","ucode":"4C86AA5D6D8C39","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554486,"discussion_content":"ç»™åŒå­¦ä¸€ä¸ªå­¦ä¹ çš„å°å»ºè®®ï¼Œå…¶å®è¿™é‡Œå¾ˆå¤šé—®é¢˜éƒ½æ˜¯éå¸¸ç®€å•çš„åªè¦ç™¾åº¦ä¸€ä¸‹å°±èƒ½è·å¾—çš„ç­”æ¡ˆï¼Œæœ‰é—®é¢˜è¯´æ˜è¯¾æ–‡è®¤çœŸè¯»äº†ï¼Œä½†æ˜¯å¦‚æœèƒ½å…ˆè‡ªå·±å¯¹é—®é¢˜åšä¸€ä¸‹è°ƒç ”ï¼Œä¹Ÿæ˜¯æé«˜è§£å†³é—®é¢˜çš„èƒ½åŠ›çš„ä¸€ç§æ–¹å¼ã€‚\n\næ¯”å¦‚ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå°±å¯ä»¥è½¬åŒ–ä¸ºmysqléƒ½æœ‰å“ªäº›å¼•æ“ï¼Œä»–ä»¬ä¹‹é—´å·®åˆ«æ˜¯ä»€ä¹ˆï¼Œå“ªäº›æ”¯æŒäº‹åŠ¡å“ªäº›ä¸æ”¯æŒï¼Œè¿›è€Œå†äº†è§£ä¸€ä¸‹æ•°æ®åº“çš„äº‹åŠ¡ä¼ æ’­æ€§å’Œcommitçº§åˆ«ã€‚\n\nç¬¬äºŒä¸ªé—®é¢˜commitå¤±è´¥ä¹‹åå°±å›æ»šï¼Œå› ä¸ºäº‹åŠ¡æ²¡æäº¤ï¼Œå’Œæœ¬åœ°äº‹åŠ¡å›æ»šä¸€æ ·çš„æµç¨‹","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1646403758,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1496998,"avatar":"https://static001.geekbang.org/account/avatar/00/16/d7/a6/1e94e96f.jpg","nickname":"zojian","note":"","ucode":"5EAFEB779BE5C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":554201,"discussion_content":"å¦‚æœcommité˜¶æ®µå‡ºç°é—®é¢˜å°±ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´ï¼ˆéƒ¨åˆ†commitæˆåŠŸéƒ¨åˆ†å¤±è´¥ï¼‰ï¼Œç„¶åå°±è¡ç”Ÿå‡º3PCçš„è¶…æ—¶æœºåˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜:-P ä¸è¿‡3PCä¹Ÿå¸¦æ¥äº†ä¸€äº›å…¶ä»–é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646269208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}