{"id":230848,"title":"é‡ç£…åŠ é¤ | å¸¦ä½ å¿«é€Ÿå…¥é—¨Scalaè¯­è¨€","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯èƒ¡å¤•ã€‚æœ€è¿‘ï¼Œæˆ‘åœ¨ç•™è¨€åŒºçœ‹åˆ°ä¸€äº›åŒå­¦åé¦ˆè¯´â€œScalaè¯­è¨€ä¸å¤ªå®¹æ˜“ç†è§£â€ï¼Œäºæ˜¯ï¼Œæˆ‘å†³å®šä¸´æ—¶åŠ ä¸€èŠ‚è¯¾ï¼Œç»™ä½ è®²ä¸€è®²Scalaè¯­è¨€çš„åŸºç¡€è¯­æ³•ï¼ŒåŒ…æ‹¬å˜é‡å’Œå‡½æ•°çš„å®šä¹‰ã€å…ƒç»„çš„å†™æ³•ã€å‡½æ•°å¼ç¼–ç¨‹é£æ ¼çš„å¾ªç¯è¯­å¥çš„å†™æ³•ã€å®ƒç‹¬æœ‰çš„caseç±»å’Œå¼ºå¤§çš„matchæ¨¡å¼åŒ¹é…åŠŸèƒ½ï¼Œä»¥åŠOptionå¯¹è±¡çš„ç”¨æ³•ã€‚</p><p>å­¦å®Œè¿™èŠ‚è¯¾ä»¥åï¼Œç›¸ä¿¡ä½ èƒ½å¤Ÿåœ¨è¾ƒçŸ­çš„æ—¶é—´é‡ŒæŒæ¡è¿™äº›å®ç”¨çš„Scalaè¯­æ³•ï¼Œç‰¹åˆ«æ˜¯Kafkaæºç ä¸­ç”¨åˆ°çš„Scalaè¯­æ³•ç‰¹æ€§ï¼Œå½»åº•æ‰«æ¸…æºç é˜…è¯»è·¯ä¸Šçš„ç¼–ç¨‹è¯­è¨€éšœç¢ã€‚</p><h2>Javaå‡½æ•°å¼ç¼–ç¨‹</h2><p>å°±åƒæˆ‘åœ¨å¼€ç¯‡è¯é‡Œé¢è¯´çš„ï¼Œä½ ä¸ç†Ÿæ‚‰Scalaè¯­è¨€å…¶å®å¹¶æ²¡æœ‰å…³ç³»ï¼Œä½†ä½ è‡³å°‘è¦å¯¹Java 8çš„å‡½æ•°å¼ç¼–ç¨‹æœ‰ä¸€å®šçš„äº†è§£ï¼Œç‰¹åˆ«æ˜¯è¦ç†Ÿæ‚‰Java 8 Streamçš„ç”¨æ³•ã€‚</p><p>å€˜è‹¥ä½ ä¹‹å‰æ²¡æœ‰æ€ä¹ˆæ¥è§¦è¿‡Lambdaè¡¨è¾¾å¼å’ŒJava 8 Streamï¼Œæˆ‘ç»™ä½ æ¨èä¸€æœ¬å¥½ä¹¦ï¼š<strong>ã€ŠJava 8å®æˆ˜ã€‹</strong>ã€‚è¿™æœ¬ä¹¦é€šè¿‡å¤§é‡çš„å®ä¾‹æ·±å…¥æµ…å‡ºåœ°è®²è§£äº†Lambdaè¡¨è¾¾å¼ã€Streamä»¥åŠå‡½æ•°å¼ç¼–ç¨‹æ–¹é¢çš„å†…å®¹ï¼Œä½ å¯ä»¥å»è¯»ä¸€è¯»ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘å°±ç»™ä½ åˆ†äº«ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œå€Ÿç€å®ƒå¼€å§‹æˆ‘ä»¬ä»Šå¤©çš„æ‰€æœ‰è®¨è®ºã€‚</p><p>TopicPartitionæ˜¯Kafkaå®šä¹‰çš„ä¸»é¢˜åˆ†åŒºç±»ï¼Œå®ƒå»ºæ¨¡çš„æ˜¯Kafkaä¸»é¢˜çš„åˆ†åŒºå¯¹è±¡ï¼Œå…¶å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p><!-- [[[read_end]]] --><pre><code>public final class TopicPartition implements Serializable {\n  private final int partition;\n  private final String topic;\n  // å…¶ä»–å­—æ®µå’Œæ–¹æ³•......\n}\n</code></pre><p>å¯¹äºä»»ä½•ä¸€ä¸ªåˆ†åŒºè€Œè¨€ï¼Œä¸€ä¸ªTopicPartitionå®ä¾‹æœ€é‡è¦çš„å°±æ˜¯<strong>topicå’Œpartitionå­—æ®µ</strong>ï¼Œå³<strong>Kafkaçš„ä¸»é¢˜å’Œåˆ†åŒºå·</strong>ã€‚å‡è®¾ç»™å®šäº†ä¸€ç»„åˆ†åŒºå¯¹è±¡List &lt; TopicPartition &gt; ï¼Œæˆ‘æƒ³è¦æ‰¾å‡ºåˆ†åŒºæ•°å¤§äº3ä¸”ä»¥â€œtestâ€å¼€å¤´çš„æ‰€æœ‰ä¸»é¢˜åˆ—è¡¨ï¼Œæˆ‘åº”è¯¥æ€ä¹ˆå†™è¿™æ®µJavaä»£ç å‘¢ï¼Ÿä½ å¯ä»¥å…ˆæ€è€ƒä¸€ä¸‹ï¼Œç„¶åå†çœ‹ä¸‹é¢çš„ç­”æ¡ˆã€‚</p><p>æˆ‘å…ˆç»™å‡ºJava 8 Streamé£æ ¼çš„ç­”æ¡ˆï¼š</p><pre><code>// å‡è®¾åˆ†åŒºå¯¹è±¡åˆ—è¡¨å˜é‡åæ˜¯list\nSet&lt;String&gt; topics = list.stream()\n        .filter(tp -&gt; tp.topic().startsWith(&quot;test-&quot;))\n        .collect(Collectors.groupingBy(TopicPartition::topic, Collectors.counting()))\n        .entrySet().stream()\n        .filter(entry -&gt; entry.getValue() &gt; 3)\n        .map(entry -&gt; entry.getKey()).collect(Collectors.toSet());\n</code></pre><p>è¿™æ˜¯å…¸å‹çš„Java 8 Streamä»£ç ï¼Œé‡Œé¢å¤§é‡ä½¿ç”¨äº†è¯¸å¦‚filterã€mapç­‰æ“ä½œç®—å­,ä»¥åŠLambdaè¡¨è¾¾å¼ï¼Œè¿™è®©ä»£ç çœ‹ä¸Šå»ä¸€æ°”å‘µæˆï¼Œè€Œä¸”å…·æœ‰å¾ˆå¥½çš„å¯è¯»æ€§ã€‚</p><p>æˆ‘ä»ç¬¬3è¡Œå¼€å§‹è§£é‡Šä¸‹æ¯ä¸€è¡Œçš„ä½œç”¨ï¼šç¬¬3è¡Œçš„filteræ–¹æ³•è°ƒç”¨å®ç°äº†ç­›é€‰ä»¥â€œtestâ€å¼€å¤´ä¸»é¢˜çš„åŠŸèƒ½ï¼›ç¬¬4è¡Œæ˜¯è¿è¡Œcollectæ–¹æ³•ï¼ŒåŒæ—¶æŒ‡å®šä½¿ç”¨groupingByç»Ÿè®¡åˆ†åŒºæ•°å¹¶æŒ‰ç…§ä¸»é¢˜è¿›è¡Œåˆ†ç»„ï¼Œè¿›è€Œç”Ÿæˆä¸€ä¸ªMapå¯¹è±¡ï¼›ç¬¬5~7è¡Œæ˜¯æå–å‡ºè¿™ä¸ªMapå¯¹è±¡çš„æ‰€æœ‰&lt;K, V&gt;å¯¹ï¼Œç„¶åå†æ¬¡è°ƒç”¨filteræ–¹æ³•ï¼Œå°†åˆ†åŒºæ•°å¤§äº3çš„ä¸»é¢˜æå–å‡ºæ¥ï¼›æœ€åæ˜¯å°†è¿™äº›ä¸»é¢˜åšæˆä¸€ä¸ªé›†åˆè¿”å›ã€‚</p><p>å…¶å®ï¼Œç»™å‡ºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘åªæ˜¯æƒ³è¯´æ˜ï¼Œ<strong>Scalaè¯­è¨€çš„ç¼–å†™é£æ ¼å’ŒJava 8 Streamæœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„</strong>ï¼šä¸€æ–¹é¢ï¼Œä»£ç ä¸­æœ‰å¤§é‡çš„filterã€mapï¼Œç”šè‡³æ˜¯flatMapç­‰æ“ä½œç®—å­ï¼›å¦ä¸€æ–¹é¢ï¼Œä»£ç çš„é£æ ¼ä¹Ÿå’ŒJavaä¸­çš„Lambdaè¡¨è¾¾å¼å†™æ³•ç±»ä¼¼ã€‚</p><p>å¦‚æœä½ ä¸ä¿¡çš„è¯ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹Kafkaä¸­è®¡ç®—æ¶ˆè´¹è€…Lagçš„getLagæ–¹æ³•ä»£ç ï¼š</p><pre><code>private def getLag(offset: Option[Long], logEndOffset: Option[Long]): Option[Long] =\n  offset.filter(_ != -1).flatMap(offset =&gt; logEndOffset.map(_ - offset))\n\n</code></pre><p>ä½ çœ‹ï¼Œè¿™é‡Œé¢ä¹Ÿæœ‰filterå’Œmapã€‚æ˜¯ä¸æ˜¯å’Œä¸Šé¢çš„Javaä»£ç æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Ÿ</p><p>å¦‚æœä½ ç°åœ¨è¿˜çœ‹ä¸æ‡‚è¿™ä¸ªæ–¹æ³•çš„ä»£ç æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä¹Ÿä¸ç”¨ç€æ€¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šå¸¦ç€ä½ ä¸€æ­¥ä¸€æ­¥æ¥å­¦ä¹ ã€‚æˆ‘ç›¸ä¿¡ï¼Œå­¦å®Œäº†è¿™èŠ‚è¯¾ä»¥åï¼Œä½ ä¸€å®šèƒ½è‡ªä¸»ææ‡‚getLagæ–¹æ³•çš„æºç å«ä¹‰ã€‚getLagä»£ç æ˜¯éå¸¸å…¸å‹çš„Kafkaæºç ï¼Œä¸€æ—¦ä½ ç†Ÿæ‚‰äº†è¿™ç§ç¼–ç é£æ ¼ï¼Œåé¢ä¸€å®šå¯ä»¥ä¸¾ä¸€åä¸‰ï¼Œä¸€ä¸¾æ”»å…‹å…¶ä»–çš„æºç é˜…è¯»éš¾é¢˜ã€‚</p><p>æˆ‘ä»¬å…ˆä»Scalaè¯­è¨€ä¸­çš„å˜é‡ï¼ˆVariableï¼‰å¼€å§‹è¯´èµ·ã€‚æ¯•ç«Ÿï¼Œä¸ç®¡æ˜¯å­¦ä¹ ä»»ä½•ç¼–ç¨‹è¯­è¨€ï¼Œæœ€åŸºç¡€çš„å°±æ˜¯å…ˆææ˜ç™½å˜é‡æ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚</p><h2>å®šä¹‰å˜é‡å’Œå‡½æ•°</h2><p>Scalaæœ‰ä¸¤ç±»å˜é‡ï¼š<strong>valå’Œvar</strong>ã€‚<strong>valç­‰åŒäºJavaä¸­çš„finalå˜é‡ï¼Œä¸€æ—¦è¢«åˆå§‹åŒ–ï¼Œå°±ä¸èƒ½å†è¢«é‡æ–°èµ‹å€¼äº†</strong>ã€‚ç›¸ååœ°ï¼Œ<strong>varæ˜¯éfinalå˜é‡ï¼Œå¯ä»¥é‡å¤è¢«èµ‹å€¼</strong>ã€‚æˆ‘ä»¬çœ‹ä¸‹è¿™æ®µä»£ç ï¼š</p><pre><code>scala&gt; val msg = &quot;hello, world&quot;\nmsg: String = hello, world\n\nscala&gt; msg = &quot;another string&quot;\n&lt;console&gt;:12: error: reassignment to val\n       msg = &quot;another string&quot;\n\nscala&gt; var a:Long = 1L\na: Long = 1\n\nscala&gt; a = 2\na: Long = 2\n</code></pre><p>å¾ˆç›´è§‚ï¼Œå¯¹å§ï¼Ÿmsgæ˜¯ä¸€ä¸ªvalï¼Œaæ˜¯ä¸€ä¸ªvarï¼Œæ‰€ä»¥msgä¸å…è®¸è¢«é‡å¤èµ‹å€¼ï¼Œè€Œaå¯ä»¥ã€‚æˆ‘æƒ³æé†’ä½ çš„æ˜¯ï¼Œ<strong>å˜é‡åé¢å¯ä»¥è·Ÿâ€œå†’å·+ç±»å‹â€ï¼Œä»¥æ˜¾å¼æ ‡æ³¨å˜é‡çš„ç±»å‹</strong>ã€‚æ¯”å¦‚ï¼Œè¿™æ®µä»£ç ç¬¬6è¡Œçš„â€œï¼šLongâ€ï¼Œå°±æ˜¯å‘Šè¯‰æˆ‘ä»¬å˜é‡aæ˜¯ä¸€ä¸ªLongå‹ã€‚å½“ç„¶ï¼Œå¦‚æœä½ ä¸å†™â€œï¼šLongâ€ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºScalaå¯ä»¥é€šè¿‡åé¢çš„å€¼â€œ1Lâ€è‡ªåŠ¨åˆ¤æ–­å‡ºaçš„ç±»å‹ã€‚</p><p>ä¸è¿‡ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæ˜¾å¼æ ‡æ³¨ä¸Šå˜é‡ç±»å‹ï¼Œå¯ä»¥è®©ä»£ç æœ‰æ›´å¥½çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹Scalaä¸­çš„å‡½æ•°å¦‚ä½•å®šä¹‰ã€‚æˆ‘ä»¥è·å–ä¸¤ä¸ªæ•´æ•°æœ€å¤§å€¼çš„Maxå‡½æ•°ä¸ºä¾‹ï¼Œè¿›è¡Œè¯´æ˜ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre><code>def max(x: Int, y: Int): Int = {\n  if (x &gt; y) x\n  else y\n}\n</code></pre><p>é¦–å…ˆï¼Œdefå…³é”®å­—è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚maxæ˜¯å‡½æ•°åï¼Œæ‹¬å·ä¸­çš„xå’Œyæ˜¯å‡½æ•°è¾“å…¥å‚æ•°ï¼Œå®ƒä»¬éƒ½æ˜¯Intç±»å‹çš„å€¼ã€‚ç»“å°¾çš„â€œInt =â€ç»„åˆè¡¨ç¤ºmaxå‡½æ•°è¿”å›ä¸€ä¸ªæ•´æ•°ã€‚</p><p>å…¶æ¬¡ï¼Œmaxä»£ç ä½¿ç”¨ifè¯­å¥æ¯”è¾ƒxå’Œyçš„å¤§å°ï¼Œå¹¶è¿”å›ä¸¤è€…ä¸­è¾ƒå¤§çš„å€¼ï¼Œä½†æ˜¯å®ƒæ²¡æœ‰ä½¿ç”¨æ‰€è°“çš„returnå…³é”®å­—ï¼Œè€Œæ˜¯ç›´æ¥å†™äº†xæˆ–yã€‚<strong>åœ¨Scalaä¸­ï¼Œå‡½æ•°ä½“å…·ä½“ä»£ç å—æœ€åä¸€è¡Œçš„å€¼å°†è¢«ä½œä¸ºå‡½æ•°ç»“æœè¿”å›</strong>ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œifåˆ†æ”¯ä»£ç å—çš„æœ€åä¸€è¡Œæ˜¯xï¼Œå› æ­¤ï¼Œæ­¤è·¯åˆ†æ”¯è¿”å›xã€‚åŒç†ï¼Œelseåˆ†æ”¯è¿”å›yã€‚</p><p>è®²å®Œäº†maxå‡½æ•°ï¼Œæˆ‘å†ç”¨Kafkaæºç ä¸­çš„ä¸€ä¸ªçœŸå®å‡½æ•°ï¼Œæ¥å¸®ä½ è¿›ä¸€æ­¥åœ°ç†è§£Scalaå‡½æ•°ï¼š</p><pre><code>def deleteIndicesIfExist(\n  // è¿™é‡Œå‚æ•°suffixçš„é»˜è®¤å€¼æ˜¯&quot;&quot;ï¼Œå³ç©ºå­—ç¬¦ä¸²\n  // å‡½æ•°ç»“å°¾å¤„çš„Unitç±»ä¼¼äºJavaä¸­çš„voidå…³é”®å­—ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°ä¸è¿”å›ä»»ä½•ç»“æœ\n  baseFile: File, suffix: String = &quot;&quot;): Unit = {\n  info(s&quot;Deleting index files with suffix $suffix for baseFile $baseFile&quot;)\n  val offset = offsetFromFile(baseFile)\n  Files.deleteIfExists(Log.offsetIndexFile(dir, offset, suffix).toPath)\n  Files.deleteIfExists(Log.timeIndexFile(dir, offset, suffix).toPath)\n  Files.deleteIfExists(Log.transactionIndexFile(dir, offset, suffix).toPath)\n}\n</code></pre><p>å’Œä¸Šé¢çš„maxå‡½æ•°ç›¸æ¯”ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸¤ä¸ªé¢å¤–çš„è¯­æ³•ç‰¹æ€§éœ€è¦ä½ äº†è§£ã€‚</p><p>ç¬¬ä¸€ä¸ªç‰¹æ€§æ˜¯<strong>å‚æ•°é»˜è®¤å€¼</strong>ï¼Œè¿™æ˜¯Javaä¸æ”¯æŒçš„ã€‚è¿™ä¸ªå‡½æ•°çš„å‚æ•°suffixé»˜è®¤å€¼æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œå› æ­¤ï¼Œä»¥ä¸‹ä¸¤ç§è°ƒç”¨æ–¹å¼éƒ½æ˜¯åˆæ³•çš„ï¼š</p><pre><code>deleteIndicesIfExist(baseFile) // OK\ndeleteIndicesIfExist(baseFile, &quot;.swap&quot;) // OK\n</code></pre><p>ç¬¬äºŒä¸ªç‰¹æ€§æ˜¯<strong>è¯¥å‡½æ•°çš„è¿”å›å€¼Unit</strong>ã€‚Scalaçš„Unitç±»ä¼¼äºJavaçš„voidï¼Œå› æ­¤ï¼ŒdeleteIndicesIfExistå‡½æ•°çš„è¿”å›å€¼æ˜¯Unitç±»å‹ï¼Œè¡¨æ˜å®ƒä»…ä»…æ˜¯æ‰§è¡Œä¸€æ®µé€»è¾‘ä»£ç ï¼Œä¸éœ€è¦è¿”å›ä»»ä½•ç»“æœã€‚</p><h2>å®šä¹‰å…ƒç»„ï¼ˆTupleï¼‰</h2><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹Scalaä¸­çš„å…ƒç»„æ¦‚å¿µã€‚<strong>å…ƒç»„æ˜¯æ‰¿è½½æ•°æ®çš„å®¹å™¨ï¼Œä¸€æ—¦è¢«åˆ›å»ºï¼Œå°±ä¸èƒ½å†è¢«æ›´æ”¹äº†</strong>ã€‚å…ƒç»„ä¸­çš„æ•°æ®å¯ä»¥æ˜¯ä¸åŒæ•°æ®ç±»å‹çš„ã€‚å®šä¹‰å’Œè®¿é—®å…ƒç»„çš„æ–¹æ³•å¾ˆç®€å•ï¼Œè¯·çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p><pre><code>scala&gt; val a = (1, 2.3, &quot;hello&quot;, List(1,2,3)) // å®šä¹‰ä¸€ä¸ªç”±4ä¸ªå…ƒç´ æ„æˆçš„å…ƒç»„ï¼Œæ¯ä¸ªå…ƒç´ å…è®¸æ˜¯ä¸åŒçš„ç±»å‹\na: (Int, Double, String, List[Int]) = (1,2.3,hello,List(1, 2, 3))\n\nscala&gt; a._1 // è®¿é—®å…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ \nres0: Int = 1\n\nscala&gt; a._2 // è®¿é—®å…ƒç»„çš„ç¬¬äºŒä¸ªå…ƒç´ \nres1: Double = 2.3\n\nscala&gt; a._3 // è®¿é—®å…ƒç»„çš„ç¬¬ä¸‰ä¸ªå…ƒç´ \nres2: String = hello\n\nscala&gt; a._4 // è®¿é—®å…ƒç»„çš„ç¬¬å››ä¸ªå…ƒç´ \nres3: List[Int] = List(1, 2, 3)\n</code></pre><p>æ€»ä½“ä¸Šè€Œè¨€ï¼Œå…ƒç»„çš„ç”¨æ³•ç®€å•è€Œä¼˜é›…ã€‚Kafkaæºç ä¸­ä¹Ÿæœ‰å¾ˆå¤šä½¿ç”¨å…ƒç»„çš„ä¾‹å­ï¼Œæ¯”å¦‚ï¼š</p><pre><code>def checkEnoughReplicasReachOffset(requiredOffset: Long): (Boolean, Errors) = { // è¿”å›(Booleanï¼ŒErrors)ç±»å‹çš„å…ƒç»„\n\t......\n\tif (minIsr &lt;= curInSyncReplicaIds.size) {\n        ......\n\t\t(true, Errors.NONE)\n    } else\n\t\t(false, Errors.NOT_ENOUGH_REPLICAS_AFTER_APPEND)\n}\n</code></pre><p>checkEnoughReplicasReachOffsetæ–¹æ³•è¿”å›ä¸€ä¸ª(Boolean, Errors)ç±»å‹çš„å…ƒç»„ï¼Œå³å…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æˆ–å­—æ®µæ˜¯Booleanç±»å‹ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯Kafkaè‡ªå®šä¹‰çš„Errorsç±»å‹ã€‚</p><p>è¯¥æ–¹æ³•ä¼šåˆ¤æ–­æŸåˆ†åŒºISRä¸­å‰¯æœ¬çš„æ•°é‡ï¼Œæ˜¯å¦å¤§äºç­‰äºæ‰€éœ€çš„æœ€å°ISRå‰¯æœ¬æ•°ï¼Œå¦‚æœæ˜¯ï¼Œå°±è¿”å›ï¼ˆtrue, Errors.NONEï¼‰å…ƒç»„ï¼Œå¦åˆ™è¿”å›ï¼ˆfalseï¼ŒErrors.NOT_ENOUGH_REPLICAS_AFTER_APPENDï¼‰ã€‚ç›®å‰ï¼Œä½ ä¸å¿…ç†ä¼šä»£ç ä¸­minIsræˆ–curInSyncReplicaIdsçš„å«ä¹‰ï¼Œä»…ä»…æŒæ¡Kafkaæºç ä¸­çš„å…ƒç»„ç”¨æ³•å°±å¤Ÿäº†ã€‚</p><h2>å¾ªç¯å†™æ³•</h2><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹Scalaä¸­å¾ªç¯çš„å†™æ³•ã€‚æˆ‘ä»¬å¸¸è§çš„å¾ªç¯æœ‰ä¸¤ç§å†™æ³•ï¼š<strong>å‘½ä»¤å¼ç¼–ç¨‹æ–¹å¼</strong>å’Œ<strong>å‡½æ•°å¼ç¼–ç¨‹æ–¹å¼</strong>ã€‚æˆ‘ä»¬ç†Ÿæ‚‰çš„æ˜¯ç¬¬ä¸€ç§ï¼Œæ¯”å¦‚ä¸‹é¢çš„forå¾ªç¯ä»£ç ï¼š</p><pre><code>scala&gt; val list = List(1, 2, 3, 4, 5)\nlist: List[Int] = List(1, 2, 3, 4, 5)\n\nscala&gt; for (element &lt;- list) println(element)\n1\n2\n3\n4\n5\n</code></pre><p>Scalaæ”¯æŒçš„å‡½æ•°å¼ç¼–ç¨‹é£æ ¼çš„å¾ªç¯ï¼Œç±»ä¼¼äºä¸‹é¢çš„è¿™ç§ä»£ç ï¼š</p><pre><code>scala&gt; list.foreach(e =&gt; println(e))\n// çœç•¥è¾“å‡º......\nscala&gt; list.foreach(println)\n// çœç•¥è¾“å‡º......\n</code></pre><p>ç‰¹åˆ«æ˜¯ä»£ç ä¸­çš„ç¬¬äºŒç§å†™æ³•ï¼Œä¼šè®©ä»£ç å†™å¾—å¼‚å¸¸ç®€æ´ã€‚æˆ‘ç”¨ä¸€æ®µçœŸå®çš„Kafkaæºç å†å¸®ä½ åŠ å¼ºä¸‹è®°å¿†ã€‚å®ƒå–è‡ªSocketServerç»„ä»¶ä¸­stopProcessingRequestsæ–¹æ³•ï¼Œä¸»è¦ç›®çš„æ˜¯è®©Brokeråœæ­¢è¯·æ±‚å’Œæ–°å…¥ç«™TCPè¿æ¥çš„å¤„ç†ã€‚SocketServerç»„ä»¶æ˜¯å®ç°Kafkaç½‘ç»œé€šä¿¡çš„é‡è¦ç»„ä»¶ï¼Œåé¢æˆ‘ä¼šèŠ±3èŠ‚è¯¾çš„æ—¶é—´ä¸“é—¨è®¨è®ºå®ƒã€‚è¿™é‡Œï¼Œå’±ä»¬å…ˆæ¥å­¦ä¹ ä¸‹è¿™æ®µæ˜æ˜¾å…·æœ‰å‡½æ•°å¼é£æ ¼çš„ä»£ç ï¼š</p><pre><code>// dataPlaneAcceptors:ConcurrentHashMap&lt;Endpoint, Acceptor&gt;å¯¹è±¡\ndataPlaneAcceptors.asScala.values.foreach(_.initiateShutdown())\n</code></pre><p>è¿™ä¸€è¡Œä»£ç é¦–å…ˆè°ƒç”¨asScalaæ–¹æ³•ï¼Œå°†Javaçš„ConcurrentHashMapè½¬æ¢æˆScalaè¯­è¨€ä¸­çš„concurrent.Mapå¯¹è±¡ï¼›ç„¶åè·å–å®ƒä¿å­˜çš„æ‰€æœ‰Acceptorçº¿ç¨‹ï¼Œé€šè¿‡foreachå¾ªç¯ï¼Œè°ƒç”¨æ¯ä¸ªAcceptorå¯¹è±¡çš„initiateShutdownæ–¹æ³•ã€‚å¦‚æœè¿™ä¸ªé€»è¾‘ç”¨å‘½ä»¤å¼ç¼–ç¨‹æ¥å®ç°ï¼Œè‡³å°‘è¦å‡ è¡Œç”šè‡³æ˜¯åå‡ è¡Œæ‰èƒ½å®Œæˆã€‚</p><h2>caseç±»</h2><p>åœ¨Scalaä¸­ï¼Œcaseç±»ä¸æ™®é€šç±»æ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯å®ƒå…·æœ‰ä¸€äº›éå¸¸é‡è¦çš„ä¸åŒç‚¹ã€‚Caseç±»éå¸¸é€‚åˆç”¨æ¥è¡¨ç¤ºä¸å¯å˜æ•°æ®ã€‚åŒæ—¶ï¼Œå®ƒæœ€æœ‰ç”¨çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼Œcaseç±»è‡ªåŠ¨åœ°ä¸ºæ‰€æœ‰ç±»å­—æ®µå®šä¹‰Getteræ–¹æ³•ï¼Œè¿™æ ·èƒ½çœå»å¾ˆå¤šæ ·æœ¬ä»£ç ã€‚æˆ‘ä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸€ä¸‹ã€‚</p><p>å¦‚æœæˆ‘ä»¬è¦ç¼–å†™ä¸€ä¸ªç±»è¡¨ç¤ºå¹³é¢ä¸Šçš„ä¸€ä¸ªç‚¹ï¼ŒJavaä»£ç å¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼š</p><pre><code>public final class Point {\n  private int x;\n  private int y;\n  public Point(int x, int y) {\n    this.x = x;\n    this.y = y;\n  }\n  // setter methods......\n  // getter methods......\n}\n</code></pre><p>æˆ‘å°±ä¸åˆ—å‡ºå®Œæ•´çš„Getterå’ŒSetteræ–¹æ³•äº†ï¼Œå†™è¿‡Javaçš„ä½ ä¸€å®šçŸ¥é“è¿™äº›æ ·æœ¬ä»£ç ã€‚ä½†å¦‚æœç”¨Scalaçš„caseç±»ï¼Œåªéœ€è¦å†™ä¸€è¡Œä»£ç å°±å¯ä»¥äº†ï¼š</p><pre><code>case class Point(x:Int, y: Int) // é»˜è®¤å†™æ³•ã€‚ä¸èƒ½ä¿®æ”¹xå’Œy\ncase class Point(var x: Int, var y: Int) // æ”¯æŒä¿®æ”¹xå’Œy\n</code></pre><p>Scalaä¼šè‡ªåŠ¨åœ°å¸®ä½ åˆ›å»ºå‡ºxå’Œyçš„Getteræ–¹æ³•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œxå’Œyä¸èƒ½è¢«ä¿®æ”¹ï¼Œå¦‚æœè¦æ”¯æŒä¿®æ”¹ï¼Œä½ è¦é‡‡ç”¨ä¸Šé¢ä»£ç ä¸­ç¬¬äºŒè¡Œçš„å†™æ³•ã€‚</p><h2>æ¨¡å¼åŒ¹é…</h2><p>æœ‰äº†caseç±»çš„åŸºç¡€ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥å­¦ä¹ ä¸‹Scalaä¸­å¼ºå¤§çš„æ¨¡å¼åŒ¹é…åŠŸèƒ½äº†ã€‚</p><p>å’ŒJavaä¸­switchä»…ä»…åªèƒ½æ¯”è¾ƒæ•°å€¼å’Œå­—ç¬¦ä¸²ç›¸æ¯”ï¼ŒScalaä¸­çš„matchè¦å¼ºå¤§å¾—å¤šã€‚æˆ‘å…ˆæ¥ä¸¾ä¸ªä¾‹å­ï¼š</p><pre><code>def describe(x: Any) = x match {\n  case 1 =&gt; &quot;one&quot;\n  case false =&gt; &quot;False&quot;\n  case &quot;hi&quot; =&gt; &quot;hello, world!&quot;\n  case Nil =&gt; &quot;the empty list&quot;\n  case e: IOException =&gt; &quot;this is an IOException&quot;\n  case s: String if s.length &gt; 10 =&gt; &quot;a long string&quot;\n  case _ =&gt; &quot;something else&quot;\n}\n</code></pre><p>è¿™ä¸ªå‡½æ•°çš„xæ˜¯Anyç±»å‹ï¼Œè¿™ç›¸å½“äºJavaä¸­çš„Objectç±»å‹ï¼Œå³æ‰€æœ‰ç±»çš„çˆ¶ç±»ã€‚æ³¨æ„å€’æ•°ç¬¬äºŒè¡Œçš„â€œcase _â€çš„å†™æ³•ï¼Œå®ƒæ˜¯ç”¨æ¥å…œåº•çš„ã€‚å¦‚æœä¸Šé¢çš„æ‰€æœ‰caseåˆ†æ”¯éƒ½ä¸åŒ¹é…ï¼Œé‚£å°±è¿›å…¥åˆ°è¿™ä¸ªåˆ†æ”¯ã€‚å¦å¤–ï¼Œå®ƒè¿˜æ”¯æŒä¸€äº›å¤æ‚çš„è¡¨è¾¾å¼ï¼Œæ¯”å¦‚å€’æ•°ç¬¬ä¸‰è¡Œçš„caseåˆ†æ”¯ï¼Œè¡¨ç¤ºxæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè€Œä¸”xçš„é•¿åº¦è¶…è¿‡10çš„è¯ï¼Œå°±è¿›å…¥åˆ°è¿™ä¸ªåˆ†æ”¯ã€‚</p><p>è¦çŸ¥é“ï¼ŒJavaåœ¨JDK 14æ‰åˆšåˆšå¼•å…¥è¿™ä¸ªç›¸åŒçš„åŠŸèƒ½ï¼Œè¶³è§Scalaè¯­æ³•çš„å¼ºå¤§å’Œä¾¿æ·ã€‚</p><h2>Optionå¯¹è±¡</h2><p>æœ€åï¼Œæˆ‘å†ä»‹ç»ä¸€ä¸ªå°çš„è¯­æ³•ç‰¹æ€§æˆ–è¯­è¨€ç‰¹ç‚¹ï¼š<strong>Optionå¯¹è±¡</strong>ã€‚</p><p>å®é™…ä¸Šï¼ŒJavaä¹Ÿå¼•å…¥äº†ç±»ä¼¼çš„ç±»ï¼šOptionalã€‚æ ¹æ®æˆ‘çš„ç†è§£ï¼Œä¸è®ºæ˜¯Scalaä¸­çš„Optionï¼Œè¿˜æ˜¯Javaä¸­çš„Optionalï¼Œéƒ½æ˜¯ç”¨æ¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°è§„é¿NullPointerExceptionå¼‚å¸¸çš„ã€‚</p><p>Optionè¡¨ç¤ºä¸€ä¸ªå®¹å™¨å¯¹è±¡ï¼Œé‡Œé¢å¯èƒ½è£…äº†å€¼ï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰è£…ä»»ä½•å€¼ã€‚ç”±äºæ˜¯å®¹å™¨ï¼Œå› æ­¤ä¸€èˆ¬éƒ½æ˜¯è¿™æ ·çš„å†™æ³•ï¼šOption[Any]ã€‚ä¸­æ‹¬å·é‡Œé¢çš„Anyå°±æ˜¯ä¸Šé¢è¯´åˆ°çš„Anyç±»å‹ï¼Œå®ƒèƒ½æ˜¯ä»»ä½•ç±»å‹ã€‚å¦‚æœå€¼å­˜åœ¨çš„è¯ï¼Œå°±å¯ä»¥ä½¿ç”¨Some(x)æ¥è·å–å€¼æˆ–ç»™å€¼èµ‹å€¼ï¼Œå¦åˆ™å°±ä½¿ç”¨Noneæ¥è¡¨ç¤ºã€‚æˆ‘ç”¨ä¸€æ®µä»£ç å¸®åŠ©ä½ ç†è§£ï¼š</p><pre><code>scala&gt; val keywords = Map(&quot;scala&quot; -&gt; &quot;option&quot;, &quot;java&quot; -&gt; &quot;optional&quot;) // åˆ›å»ºä¸€ä¸ªMapå¯¹è±¡\nkeywords: scala.collection.immutable.Map[String,String] = Map(scala -&gt; option, java -&gt; optional)\n\nscala&gt; keywords.get(&quot;java&quot;) // è·å–keyå€¼ä¸ºjavaçš„valueå€¼ã€‚ç”±äºå€¼å­˜åœ¨æ•…è¿”å›Some(optional)\nres24: Option[String] = Some(optional)\n\nscala&gt; keywords.get(&quot;C&quot;) // è·å–keyå€¼ä¸ºCçš„valueå€¼ã€‚ç”±äºä¸å­˜åœ¨æ•…è¿”å›None\nres23: Option[String] = None\n</code></pre><p>Optionå¯¹è±¡è¿˜ç»å¸¸ä¸æ¨¡å¼åŒ¹é…è¯­æ³•ä¸€èµ·ä½¿ç”¨ï¼Œä»¥å®ç°ä¸åŒæƒ…å†µä¸‹çš„å¤„ç†é€»è¾‘ã€‚æ¯”å¦‚ï¼ŒOptionå¯¹è±¡æœ‰å€¼å’Œæ²¡æœ‰å€¼æ—¶åˆ†åˆ«æ‰§è¡Œä»€ä¹ˆä»£ç ã€‚å…·ä½“å†™æ³•ä½ å¯ä»¥å‚è€ƒä¸‹é¢è¿™æ®µä»£ç ï¼š</p><pre><code>def display(game: Option[String]) = game match {\n  case Some(s) =&gt; s\n  case None =&gt; &quot;unknown&quot;\n}\n\nscala&gt; display(Some(&quot;Heroes 3&quot;))\nres26: String = Heroes 3\n\nscala&gt; display(Some(&quot;StarCraft&quot;))\nres27: String = StarCraft\n\nscala&gt; display(None)\nres28: String = unknown\n</code></pre><h2>æ€»ç»“</h2><p>ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸“é—¨èŠ±äº†äº›æ—¶é—´å¿«é€Ÿåœ°å­¦ä¹ äº†ä¸€ä¸‹Scalaè¯­è¨€çš„è¯­æ³•ï¼Œè¿™äº›è¯­æ³•èƒ½å¤Ÿå¸®åŠ©ä½ æ›´å¿«é€Ÿåœ°ä¸Šæ‰‹Kafkaæºç çš„å­¦ä¹ ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å†æ¥çœ‹ä¸‹è¿™èŠ‚è¯¾åˆšå¼€å§‹æ—¶æˆ‘æåˆ°çš„getLagæ–¹æ³•æºç ï¼Œä½ çœ‹çœ‹ç°åœ¨æ˜¯å¦èƒ½å¤Ÿè¯´å‡ºå®ƒçš„å«ä¹‰ã€‚æˆ‘å†æ¬¡æŠŠå®ƒè´´å‡ºæ¥ï¼š</p><pre><code>private def getLag(offset: Option[Long], logEndOffset: Option[Long]): Option[Long] =\n  offset.filter(_ != -1).flatMap(offset =&gt; logEndOffset.map(_ - offset))\n</code></pre><p>ç°åœ¨ï¼Œä½ åº”è¯¥çŸ¥é“äº†ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¸¤ä¸ªç±»å‹ä¸ºOption[Long]çš„å‚æ•°ï¼ŒåŒæ—¶è¿”å›ä¸€ä¸ªOption[Long]çš„ç»“æœã€‚ä»£ç é€»è¾‘å¾ˆç®€å•ï¼Œé¦–å…ˆåˆ¤æ–­offsetæ˜¯å¦æœ‰å€¼ä¸”ä¸èƒ½æ˜¯-1ã€‚è¿™äº›éƒ½æ˜¯åœ¨filterå‡½æ•°ä¸­å®Œæˆçš„ï¼Œä¹‹åè°ƒç”¨flatMapæ–¹æ³•è®¡ç®—logEndOffsetå€¼ä¸offsetçš„å·®å€¼ï¼Œæœ€åè¿”å›è¿™ä¸ªå·®å€¼ä½œä¸ºLagã€‚</p><p>è¿™èŠ‚è¯¾ç»“æŸä»¥åï¼Œè¯­è¨€é—®é¢˜åº”è¯¥ä¸å†æ˜¯ä½ å­¦ä¹ æºç çš„éšœç¢äº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­ä¸“å¿ƒåœ°å­¦ä¹ æºç äº†ã€‚å€Ÿç€è¿™ä¸ªæœºä¼šï¼Œæˆ‘è¿˜æƒ³è·Ÿä½ å¤šè¯´å‡ å¥ã€‚</p><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä»¥ä¸ºï¼Œè¦æœ‰è¶³å¤Ÿå¼ºå¤§çš„æ¯…åŠ›æ‰èƒ½æŠŠæºç å­¦ä¹ åšæŒä¸‹å»ï¼Œä½†å®é™…ä¸Šï¼Œæ¯…åŠ›æ˜¯åœ¨ä½ è¯»æºç çš„è¿‡ç¨‹ä¸­åŸ¹å…»èµ·æ¥çš„ã€‚</p><p>è€ƒè™‘åˆ°æºç å¹¶ä¸åƒå…·ä½“æŠ€æœ¯æœ¬èº«é‚£æ ·å®¹æ˜“æŒæ¡ï¼Œæˆ‘åŠ›äº‰ç”¨æœ€æ¸…æ™°æ˜“æ‡‚çš„æ–¹å¼æ¥è®²è¿™é—¨è¯¾ã€‚æ‰€ä»¥ï¼Œæˆ‘å¸Œæœ›ä½ æ¯å¤©éƒ½èƒ½èŠ±ä¸€ç‚¹ç‚¹æ—¶é—´è·Ÿç€æˆ‘ä¸€èµ·å­¦ä¹ ï¼Œæˆ‘ç›¸ä¿¡ï¼Œåˆ°ç»“è¯¾çš„æ—¶å€™ï¼Œä½ ä¸ä»…å¯ä»¥ææ‡‚Kafka Brokerç«¯æºç ï¼Œè¿˜èƒ½æå‡è‡ªå·±çš„æ¯…åŠ›ã€‚è€Œæ¯…åŠ›å’Œæ‰§è¡ŒåŠ›çš„æå‡ï¼Œå¯èƒ½æ¯”æŠ€æœ¯æœ¬èº«çš„æå‡è¿˜è¦å¼¥è¶³çè´µã€‚</p><p>å¦å¤–ï¼Œæˆ‘è¿˜æƒ³ç»™ä½ åˆ†äº«ä¸€ä¸ªå°æŠ€å·§ï¼šæƒ³è¦å…»æˆæ¯å¤©é˜…è¯»æºç çš„ä¹ æƒ¯ï¼Œä½ æœ€å¥½æŠŠç›®æ ‡æ‹†è§£å¾—è¶³å¤Ÿå°ã€‚äººçš„å¤§è„‘éƒ½æ˜¯æœ‰æƒ°æ€§çš„ï¼Œæ¯”èµ·â€œæˆ‘æ¯å¤©è¦è¯»1000è¡Œæºç â€ï¼Œå®ƒæ›´æ„¿æ„æ¥å—â€œæ¯å¤©åªè¯»20è¡Œâ€ã€‚ä½ å¯èƒ½ä¼šè¯´ï¼Œæ¯å¤©è¯»20è¡Œï¼Œè¿™ä¹Ÿå¤ªå°‘äº†å§ï¼Ÿå…¶å®ä¸æ˜¯çš„ã€‚åªè¦ä½ è¯»äº†20è¡Œæºç ï¼Œä½ å°±ä¸€å®šèƒ½å†å¤šè¯»ä¸€äº›ï¼Œâ€œ20è¡Œâ€è¿™ä¸ªå°ç›®æ ‡åªæ˜¯ä¸ºäº†ä¿ƒä½¿ä½ æ„¿æ„å¼€å§‹å»åšè¿™ä»¶äº‹æƒ…ã€‚è€Œä¸”ï¼Œå³ä½¿ä½ çœŸçš„åªè¯»äº†20è¡Œï¼Œé‚£åˆæ€æ ·ï¼Ÿè¯»20è¡Œæ€»å¥½è¿‡1è¡Œéƒ½æ²¡æœ‰è¯»ï¼Œå¯¹å§ï¼Ÿ</p><p>å½“ç„¶äº†ï¼Œé˜…è¯»æºç ç»å¸¸ä¼šé‡åˆ°ä¸€ç§æƒ…å†µï¼Œé‚£å°±æ˜¯è¯»ä¸æ‡‚æŸéƒ¨åˆ†çš„ä»£ç ã€‚æ²¡å…³ç³»ï¼Œè¯»ä¸æ‡‚çš„ä»£ç ï¼Œä½ å¯ä»¥é€‰æ‹©å…ˆè·³è¿‡ã€‚</p><p>å¦‚æœä½ æ˜¯ä¸ªè¿½æ±‚å®Œç¾çš„äººï¼Œé‚£ä¹ˆå¯¹äºè¯»ä¸æ‡‚çš„ä»£ç ï¼Œæˆ‘ç»™å‡ºå‡ ç‚¹å»ºè®®ï¼š</p><ol>\n<li><strong>å¤šè¯»å‡ é</strong>ã€‚ä¸è¦å°çœ‹è¿™ä¸ªæœ´ç´ çš„å»ºè®®ã€‚æœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„å¤§è„‘æ˜¯å¾ˆä»»æ€§çš„ï¼Œåªè®©å®ƒçœ‹ä¸€éä»£ç ï¼Œå®ƒå¯èƒ½â€œå‚²å¨‡åœ°è¡¨ç¤ºä¸ç†è§£â€ï¼Œä½†ä½ å¤šç»™å®ƒçœ‹å‡ éï¼Œä¹Ÿè®¸å°±æç„¶å¤§æ‚Ÿäº†ã€‚</li>\n<li><strong>ç»“åˆå„ç§èµ„æ–™æ¥å­¦ä¹ </strong>ã€‚æ¯”å¦‚ï¼Œç¤¾åŒºæˆ–ç½‘ä¸Šå…³äºè¿™éƒ¨åˆ†ä»£ç çš„è®¾è®¡æ–‡æ¡£ã€æºç æ³¨é‡Šæˆ–æºç æµ‹è¯•ç”¨ä¾‹ç­‰ã€‚å°¤å…¶æ˜¯ææ‡‚æµ‹è¯•ç”¨ä¾‹ï¼Œå¾€å¾€æ˜¯è®©æˆ‘ä»¬é¢†æ‚Ÿä»£ç ç²¾ç¥æœ€å¿«æ·çš„åŠæ³•äº†ã€‚</li>\n</ol><p>æ€»ä¹‹ï¼Œé˜…è¯»æºç æ˜¯ä¸€é¡¹é•¿æœŸçš„å·¥ç¨‹ï¼Œä¸è¦å¹»æƒ³æœ‰æ·å¾„æˆ–ä¸€è¹´è€Œå°±ï¼Œå¾®å°ç§¯ç´¯ä¼šå¼•å‘å·¨å¤§æ”¹å˜ï¼Œæˆ‘ä»¬ä¸€èµ·åŠ æ²¹ã€‚</p>","comments":[{"had_liked":false,"id":213316,"user_name":"å°å´”","can_delete":false,"product_type":"c1","uid":1104958,"ip_address":"","ucode":"4E537416787752","user_header":"https://static001.geekbang.org/account/avatar/00/10/dc/3e/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1588384270,"is_pvip":false,"replies":[{"id":"79121","content":"å¥½å¤„åœ¨äºæ˜¾å¼åœ°å‘Šè¯‰ç¨‹åºå‘˜è¿™æ˜¯ä¸€ä¸ªå¯èƒ½ä¸ºç©ºçš„å˜é‡ï¼Œéœ€è¦å°å¿ƒè°¨æ…å¤„ç†ï¼šï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1588399021,"ip_address":"","comment_id":213316,"utype":1}],"discussion_count":2,"race_medal":0,"score":"66012893710","product_id":100050101,"comment_content":"Optionçš„å¥½å¤„æ²¡çœ‹å‡ºæ¥ï¼Œè¯¥åˆ¤æ–­çš„åœ°æ–¹å¹¶æ²¡æœ‰å°‘ã€‚","like_count":16,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493743,"discussion_content":"å¥½å¤„åœ¨äºæ˜¾å¼åœ°å‘Šè¯‰ç¨‹åºå‘˜è¿™æ˜¯ä¸€ä¸ªå¯èƒ½ä¸ºç©ºçš„å˜é‡ï¼Œéœ€è¦å°å¿ƒè°¨æ…å¤„ç†ï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588399021,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1940299,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/9b/4b/11f37239.jpg","nickname":"KuuDS","note":"","ucode":"89E1DACEF817A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":290157,"discussion_content":"Optional.of(a).map(A::getB).map(B::getC).ifPresent()","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594362119,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221177,"user_name":"yellowcloud","can_delete":false,"product_type":"c1","uid":1397597,"ip_address":"","ucode":"508967ED4BBEFC","user_header":"https://static001.geekbang.org/account/avatar/00/15/53/5d/46d369e5.jpg","comment_is_top":false,"comment_ctime":1590421199,"is_pvip":false,"replies":[{"id":"81597","content":"å¦‚æœåªæ˜¯ä¸ºäº†é˜…è¯»Kafkaæºç ï¼Œå…¶å®å¹¶ä¸éœ€è¦å¤ªå¤šçš„ScalaåŠŸåŠ›ã€‚ä¸è¿‡ä¾ç„¶æ¨èå®˜ç½‘ä¸Šçš„è¿™ä¸ªæ•™ç¨‹ï¼šhttps:&#47;&#47;docs.scala-lang.org&#47;overviews&#47;scala-book&#47;introduction.html","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1590457618,"ip_address":"","comment_id":221177,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14475323087","product_id":100050101,"comment_content":"è€å¸ˆï¼Œæ‚¨è¿™è¾¹çš„è¯¾ç¨‹è®²çš„éå¸¸å¥½ï¼Œæˆ‘è¿˜æƒ³è¯¾å¤–å­¦ä¹ ä¸€ä¸‹saclaç›¸å…³çš„çŸ¥è¯†ï¼Œè€å¸ˆæ‚¨æœ‰æ¨èçš„ç½‘ç«™å—æˆ–ä¹¦ç±å—ã€‚","like_count":3,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496371,"discussion_content":"å¦‚æœåªæ˜¯ä¸ºäº†é˜…è¯»Kafkaæºç ï¼Œå…¶å®å¹¶ä¸éœ€è¦å¤ªå¤šçš„ScalaåŠŸåŠ›ã€‚ä¸è¿‡ä¾ç„¶æ¨èå®˜ç½‘ä¸Šçš„è¿™ä¸ªæ•™ç¨‹ï¼šhttps://docs.scala-lang.org/overviews/scala-book/introduction.html","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590457618,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1058231,"avatar":"https://static001.geekbang.org/account/avatar/00/10/25/b7/c90b315b.jpg","nickname":"ç¾Šå…«äº•","note":"","ucode":"72731AC6ECCFA1","race_medal":3,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299090,"discussion_content":"https://scalacn.cool/","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597559339,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244480,"user_name":"ä»˜æ°¸å¼º","can_delete":false,"product_type":"c1","uid":1419544,"ip_address":"","ucode":"898998296EBD56","user_header":"https://static001.geekbang.org/account/avatar/00/15/a9/18/393a841d.jpg","comment_is_top":false,"comment_ctime":1598530623,"is_pvip":false,"replies":[{"id":"89996","content":"display(Some(&quot;Show me the moneyâ˜º&quot;))","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1598580380,"ip_address":"","comment_id":244480,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10188465215","product_id":100050101,"comment_content":"å¼€å¯kafaæºç ä¹‹è·¯ï¼scala&gt; display(Some(&quot;StarCraft&quot;))å¥½è¯„ï¼","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504597,"discussion_content":"display(Some(&amp;quot;Show me the moneyâ˜º&amp;quot;))","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598580380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1209089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/73/01/0aeba3d6.jpg","nickname":"ç«ã®é¾æœ","note":"","ucode":"D59EDD5A4D3072","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302482,"discussion_content":"display(Some(&#34;black sheep wall&#34;))","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598930841,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236260,"user_name":"J.Smile","can_delete":false,"product_type":"c1","uid":1336475,"ip_address":"","ucode":"C4D98DFDBF7584","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/9b/0b578b08.jpg","comment_is_top":false,"comment_ctime":1595379867,"is_pvip":false,"replies":[{"id":"87314","content":"å†™ä¹ æƒ¯äº†ä¹Ÿå°±è¿˜å¥½ï¼Œå“ˆå“ˆï¼šï¼‰","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1595386756,"ip_address":"","comment_id":236260,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10185314459","product_id":100050101,"comment_content":"æ„Ÿè§‰scalaçš„è¯­è¨€é£æ ¼æ¯”è¾ƒå…·åƒåŒ–ï¼Œé€»è¾‘æ€§ä¸å¼ºï¼Œåº”è¯¥æ¯”è¾ƒå¥½å…¥é—¨ï¼Œä½†å¯¹äºå¸¸ç”¨javaå’Œcçš„å¯èƒ½å¼€å§‹æœ‰ç‚¹ä¸ä¹ æƒ¯ã€‚","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502006,"discussion_content":"å†™ä¹ æƒ¯äº†ä¹Ÿå°±è¿˜å¥½ï¼Œå“ˆå“ˆï¼šï¼‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595386756,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":222005,"user_name":"AAA_å¶å­","can_delete":false,"product_type":"c1","uid":1325994,"ip_address":"","ucode":"1E93617D308EE0","user_header":"https://static001.geekbang.org/account/avatar/00/14/3b/aa/e8dfcd7e.jpg","comment_is_top":false,"comment_ctime":1590654888,"is_pvip":false,"replies":[{"id":"81859","content":"â€œé«˜ç‰ˆæœ¬çš„kafkaä½¿ç”¨javaå®ç°çš„â€ --- Kafka  brokerç«¯ä»£ç ä¸€ç›´æ˜¯ç”¨Scalaå®ç°çš„ã€‚Clientsç«¯ä»£ç ä½¿ç”¨Javaå®ç°","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1590676827,"ip_address":"","comment_id":222005,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10180589480","product_id":100050101,"comment_content":"é«˜ç‰ˆæœ¬çš„kafkaä½¿ç”¨javaå®ç°çš„ï¼Œä¸ºä»€ä¹ˆä¸è®²javaç‰ˆæœ¬çš„","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496636,"discussion_content":"â€œé«˜ç‰ˆæœ¬çš„kafkaä½¿ç”¨javaå®ç°çš„â€ --- Kafka  brokerç«¯ä»£ç ä¸€ç›´æ˜¯ç”¨Scalaå®ç°çš„ã€‚Clientsç«¯ä»£ç ä½¿ç”¨Javaå®ç°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590676827,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1030082,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b7/c2/196932c7.jpg","nickname":"å—ç›ä¸€æ¢¦","note":"","ucode":"6338D5428DB2B0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":539315,"discussion_content":"è€å¸ˆï¼Œè¯·æ•™ä¸‹ä¸ºä½•brokerç«¯ä»£ç ä¸€ç›´é‡‡ç”¨scalaå®ç°å‘¢ï¼Ÿæ˜¯æœ€æ—©ä½œè€…ä½¿ç”¨è¿™ä¸ªåï¼Œå°±ä¸€ç›´å»¶ç»­ï¼Œè€Œæ²¡æœ‰å¿…è¦å»åšè¯­è¨€ä¸Šçš„ç»Ÿä¸€æ¥è€ƒè™‘çš„å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639666179,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":496636,"ip_address":""},"score":539315,"extra":""}]}]},{"had_liked":false,"id":214071,"user_name":"ğŸ¾","can_delete":false,"product_type":"c1","uid":1087256,"ip_address":"","ucode":"D0AD0260351C31","user_header":"https://static001.geekbang.org/account/avatar/00/10/97/18/a5218104.jpg","comment_is_top":false,"comment_ctime":1588649703,"is_pvip":false,"replies":[{"id":"79352","content":"å¼º","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1588726616,"ip_address":"","comment_id":214071,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5883616999","product_id":100050101,"comment_content":"å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä»¥ä¸ºï¼Œè¦æœ‰è¶³å¤Ÿå¼ºå¤§çš„æ¯…åŠ›æ‰èƒ½æŠŠæºç å­¦ä¹ åšæŒä¸‹å»ï¼Œä½†å®é™…ä¸Šï¼Œæ¯…åŠ›æ˜¯åœ¨ä½ è¯»æºç çš„è¿‡ç¨‹ä¸­åŸ¹å…»èµ·æ¥çš„ã€‚<br>Getåˆ°å­¦ä¹ æºç çš„åˆä¸€å¥½å¤„ï¼šåŸ¹å…»æ¯…åŠ›ã€‚","like_count":2,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493945,"discussion_content":"å¼º","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588726616,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1056944,"avatar":"https://static001.geekbang.org/account/avatar/00/10/20/b0/0a1551c4.jpg","nickname":"æ—¥æ‹±ä¸€å’","note":"","ucode":"3BDFD6F473862C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393839,"discussion_content":"èµåŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631615550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213403,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1588405239,"is_pvip":false,"replies":[{"id":"79152","content":"è°¢è°¢ï¼Œä¸€èµ·åŠ æ²¹ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1588430630,"ip_address":"","comment_id":213403,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5883372535","product_id":100050101,"comment_content":"å¾ˆå¥½çš„å…¥é—¨æŒ‡å—","like_count":1,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493769,"discussion_content":"è°¢è°¢ï¼Œä¸€èµ·åŠ æ²¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588430630,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":213288,"user_name":"æ¯å¤©æ™’ç™½ç‰™","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1588370845,"is_pvip":false,"replies":[{"id":"79122","content":"å“ˆå“ˆå“ˆï¼Œä¸€èµ·åŠ æ²¹ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1588399027,"ip_address":"","comment_id":213288,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5883338141","product_id":100050101,"comment_content":"å¾ˆåŠæ—¶çš„åŠ é¤","like_count":1,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493732,"discussion_content":"å“ˆå“ˆå“ˆï¼Œä¸€èµ·åŠ æ²¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588399027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":349757,"user_name":"wander","can_delete":false,"product_type":"c1","uid":1971221,"ip_address":"","ucode":"4098B58669E19E","user_header":"https://static001.geekbang.org/account/avatar/00/1e/14/15/6e6e7ac1.jpg","comment_is_top":false,"comment_ctime":1656311753,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656311753","product_id":100050101,"comment_content":"åˆ†åŒºæ•°å¤§äº 3 ä¸”ä»¥â€œtestâ€å¼€å¤´çš„æ‰€æœ‰ä¸»é¢˜åˆ—è¡¨ï¼Œè¿™é‡Œç”¨javaä¸¾ä¾‹å†™çš„æœ‰ç‚¹é—®é¢˜å§ ï¼Œentry.getValue() &gt; 3 ï¼Œè¿™æ¡ä»¶ç”¨ä¸äº†ï¼Œåº”è¯¥è¿™ä¹ˆå†™å§<br>List&lt;TopicPartition&gt; topics  =list.stream()<br>                .filter(tp -&gt; tp.topic().startsWith(&quot;test-&quot;))<br>                .filter(tp -&gt; tp.partition() &gt; 3).collect(Collectors.toList());","like_count":0},{"had_liked":false,"id":312080,"user_name":"æ—¥æ‹±ä¸€å’","can_delete":false,"product_type":"c1","uid":1056944,"ip_address":"","ucode":"3BDFD6F473862C","user_header":"https://static001.geekbang.org/account/avatar/00/10/20/b0/0a1551c4.jpg","comment_is_top":false,"comment_ctime":1631615390,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1631615390","product_id":100050101,"comment_content":"å­¦ä¹ äº†ã€‚","like_count":0},{"had_liked":false,"id":308431,"user_name":"èƒ¡å°ç¦¾","can_delete":false,"product_type":"c1","uid":1132315,"ip_address":"","ucode":"1C23B7492C0C9E","user_header":"https://static001.geekbang.org/account/avatar/00/11/47/1b/64262861.jpg","comment_is_top":false,"comment_ctime":1629618697,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629618697","product_id":100050101,"comment_content":"æˆ‘çš„å¤§è„‘æ˜¯å¾ˆä»»æ€§çš„ï¼Œåªè®©å®ƒçœ‹ä¸€éä»£ç ï¼Œå®ƒâ€œå‚²å¨‡åœ°è¡¨ç¤ºä¸ç†è§£â€ï¼Œä½†æˆ‘å¤šç»™å®ƒçœ‹å‡ éï¼Œå°±æç„¶å¤§æ‚Ÿäº†","like_count":0},{"had_liked":false,"id":296797,"user_name":"ç§‹æ—","can_delete":false,"product_type":"c1","uid":1060632,"ip_address":"","ucode":"B5882D4EC73648","user_header":"https://static001.geekbang.org/account/avatar/00/10/2f/18/0c943f98.jpg","comment_is_top":false,"comment_ctime":1623163907,"is_pvip":false,"replies":[{"id":"107832","content":"åŠ æ²¹ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1623219653,"ip_address":"","comment_id":296797,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1623163907","product_id":100050101,"comment_content":"è¿˜æ˜¯åœ¨15å¹´å­¦è¿‡scala,åé¢å·¥ä½œä¸­æ²¡ç”¨è¿‡å°±å¿˜å¾—å·®ä¸å¤šäº†ï¼Œç»§ç»­è‡ªå·±çš„ç›®æ ‡ï¼šåŠªåŠ›æˆä¸ºKafkaç¤¾åŒºä¸­çš„ä¸€åè´¡çŒ®è€…","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521585,"discussion_content":"åŠ æ²¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623219653,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":257646,"user_name":"flyCoder","can_delete":false,"product_type":"c1","uid":1074897,"ip_address":"","ucode":"82FB7B60775978","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/d1/8664c464.jpg","comment_is_top":false,"comment_ctime":1604049136,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1604049136","product_id":100050101,"comment_content":"ç®—æ˜¯æŠ›ç –å¼•ç‰äº†ï¼Œæ‰“å¡ç¬¬ä¸‰è®²","like_count":0},{"had_liked":false,"id":223454,"user_name":"é«˜å¿—å¼º","can_delete":false,"product_type":"c1","uid":1276563,"ip_address":"","ucode":"68737002043752","user_header":"https://static001.geekbang.org/account/avatar/00/13/7a/93/c9302518.jpg","comment_is_top":false,"comment_ctime":1591093366,"is_pvip":false,"replies":[{"id":"82520","content":"å—¯å—¯ï¼Œå®é™…ä¸Šä¸éœ€è¦å¤ªå¤šçš„ScalaçŸ¥è¯†è¶³ä»¥å­¦ä¹ Kafkaæºç ","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1591283519,"ip_address":"","comment_id":223454,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591093366","product_id":100050101,"comment_content":"å¯¹scalaæœ‰äº†è§£äº†ï¼Œæ„Ÿè°¢teacher!","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497133,"discussion_content":"å—¯å—¯ï¼Œå®é™…ä¸Šä¸éœ€è¦å¤ªå¤šçš„ScalaçŸ¥è¯†è¶³ä»¥å­¦ä¹ Kafkaæºç ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591283519,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217242,"user_name":"å¼ å­æ¶µ","can_delete":false,"product_type":"c1","uid":1743397,"ip_address":"","ucode":"57C509EA32B916","user_header":"https://static001.geekbang.org/account/avatar/00/1a/9a/25/3e5e942b.jpg","comment_is_top":false,"comment_ctime":1589446622,"is_pvip":false,"replies":[{"id":"80313","content":"åŠ æ²¹ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"èƒ¡å¤•","uid":"1288090","ctime":1589457797,"ip_address":"","comment_id":217242,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1589446622","product_id":100050101,"comment_content":"ä¸€ç‚¹ä¸€æ»´çš„åšæŒï¼Œä¹Ÿä¼šæœ‰å¾ˆå¤§çš„æ”¹å˜ï¼Œæ»´æ°´ç©¿çŸ³","like_count":0,"discussions":[{"author":{"id":1288090,"avatar":"https://static001.geekbang.org/account/avatar/00/13/a7/9a/495cb99a.jpg","nickname":"èƒ¡å¤•","note":"","ucode":"5709A689B6683B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":495088,"discussion_content":"åŠ æ²¹ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589457797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}