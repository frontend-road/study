{"id":711840,"title":"19ï½œäº‘æ—¶ä»£çš„çº¿ç¨‹æ¨¡å‹ï¼šé¢†ç•¥çº¿ç¨‹ä¸è™šæ‹Ÿçº¿ç¨‹çš„é£é‡‡","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯åº·æ¨ã€‚</p><p>ä»Šå¤©æˆ‘ä»¬ä¸€èµ·æ¥èŠä¸€èŠJVMä¸­çš„çº¿ç¨‹æ¨¡å‹ä»¥åŠJDK 21çš„å…³é”®ç‰¹æ€§è™šæ‹Ÿçº¿ç¨‹ã€‚</p><p>åœ¨ä¼ ç»Ÿçš„è¿›ç¨‹æ¨¡å‹ä¸­ï¼Œçº¿ç¨‹æ˜¯æ“ä½œç³»ç»Ÿçš„åŸºæœ¬è°ƒåº¦å•ä½ï¼Œä½†æ˜¯ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚çº¿ç¨‹çš„åˆ›å»ºå’Œé”€æ¯å¼€é”€æ¯”è¾ƒå¤§ï¼Œçº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢ä¹Ÿä¼šå ç”¨å¤§é‡CPUæ—¶é—´ã€‚å› æ­¤ï¼Œåœ¨Javaä¸­ï¼ŒJVMé€šè¿‡ä½¿ç”¨å†…æ ¸çº¿ç¨‹æ¥ä»£æ›¿ç”¨æˆ·çº¿ç¨‹ï¼Œä»¥å‡å°‘çº¿ç¨‹çš„åˆ›å»ºå’Œåˆ‡æ¢çš„å¼€é”€ã€‚JVMçº¿ç¨‹ä¹Ÿæ˜¯Javaå¤šçº¿ç¨‹çš„å®ç°åŸºç¡€ï¼Œèƒ½å¤Ÿå¹¶å‘æ‰§è¡Œï¼Œå…±äº«JVMå†…å­˜ï¼Œè€Œä¸”å¼€é”€æ¯”è¾ƒå°ã€‚</p><h2>çº¿ç¨‹çš„æ¨¡å‹</h2><p>JVMé‡‡ç”¨äº†ä¸€å¯¹ä¸€çš„çº¿ç¨‹æ¨¡å‹ï¼Œå³æ¯ä¸ªJavaçº¿ç¨‹éƒ½å¯¹åº”ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„å†…æ ¸çº¿ç¨‹ã€‚è¿™ç§æ¨¡å‹é€šè¿‡è°ƒç”¨æ“ä½œç³»ç»Ÿçš„å†…æ ¸çº¿ç¨‹æ¥å®Œæˆçº¿ç¨‹çš„åˆ‡æ¢å’Œæ‰§è¡Œï¼Œè€Œä¸”æ¯ä¸ªå†…æ ¸çº¿ç¨‹å¯ä»¥çœ‹ä½œæ˜¯æ“ä½œç³»ç»Ÿå†…æ ¸çš„ä¸€ä¸ªåˆ†èº«ã€‚è¿™ä¹Ÿå°±æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿå¤„ç†å¤šä»»åŠ¡çš„åŸå› ã€‚</p><h2>çº¿ç¨‹çš„çŠ¶æ€</h2><p>åœ¨Javaè™šæ‹Ÿæœºä¸­ï¼Œçº¿ç¨‹çŠ¶æ€çš„å˜åŒ–æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚çº¿ç¨‹çŠ¶æ€ä»£è¡¨äº†çº¿ç¨‹åœ¨å®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸­æ‰€å¤„çš„ä¸åŒé˜¶æ®µã€‚åœ¨Javaä¸­ï¼Œçº¿ç¨‹çŠ¶æ€å¯ä»¥æè¿°ä¸º5ç§ã€‚</p><ol>\n<li>å½“çº¿ç¨‹å¯¹è±¡è¢«åˆ›å»ºä¹‹åï¼Œå®ƒä¼šè¿›å…¥æ–°å»ºçŠ¶æ€ï¼Œè¿™ä¸ªæ—¶å€™å®ƒè¿˜æ²¡æœ‰å¯åŠ¨è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œstart()æ–¹æ³•è¿˜æ²¡æœ‰è°ƒç”¨ã€‚</li>\n<li>ä¸€æ—¦çº¿ç¨‹å¯ç”¨äº†start()æ–¹æ³•ï¼Œå®ƒå°±ä¼šåŠ å…¥åˆ°è¿è¡ŒçŠ¶æ€ã€‚åœ¨è¿™ä¸ªçŠ¶æ€ä¸‹ï¼Œçº¿ç¨‹å¯ä»¥ç»§ç»­å·¥ä½œï¼Œä¹Ÿå¯èƒ½æš‚åœã€‚</li>\n<li>å½“çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€çš„æ—¶å€™ï¼Œå®ƒä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚æ¯”å¦‚ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…synchronizedé”çš„æ—¶å€™ï¼Œè€Œå…¶ä»–çº¿ç¨‹å·²ç»å ç”¨äº†é”ï¼Œé‚£ä¹ˆè¿™äº›çº¿ç¨‹å°±ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ã€‚</li>\n<li>å½“ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹å®Œæˆç‰¹å®šä»»åŠ¡çš„æ—¶å€™ï¼Œå®ƒä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚</li>\n<li>å½“çº¿ç¨‹æ‰§è¡Œå®Œæ‰€æœ‰ä»»åŠ¡åï¼Œå®ƒä¼šè¿›å…¥ç»ˆæ­¢çŠ¶æ€ã€‚</li>\n</ol><!-- [[[read_end]]] --><p>è¿™äº›çŠ¶æ€å¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Javaä»£ç å®ç°ä¸åŒçŠ¶æ€ä¹‹é—´çš„è½¬æ¢ï¼Œæˆ‘ç”¨ä¸€ä¸ªä¾‹å­æ¥æ¼”ç¤ºä¸€ä¸‹ã€‚</p><p>åœ¨è¿™æ®µä»£ç é‡ŒRunnableå¯¹è±¡å®ä¾‹åˆ›å»ºå¹¶å¯åŠ¨5ä¸ªçº¿ç¨‹ï¼Œå¹¶ç”¨ä¸€ä¸ªå…±äº«å¯¹è±¡æ¥åŒæ­¥è¿™äº›çº¿ç¨‹ã€‚ç„¶åè®©è¿™äº›çº¿ç¨‹ä¸æ–­åœ°åˆ‡æ¢çŠ¶æ€ï¼Œå±•ç¤ºäº†çº¿ç¨‹çŠ¶æ€æ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚</p><pre><code class=\"language-java\">public class ThreadStateDemo implements Runnable {\n&nbsp;\n&nbsp; &nbsp; public void run() {\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"å½“å‰çº¿ç¨‹ï¼š\" + Thread.currentThread().getName() + \" è¿è¡Œ\");\n&nbsp; &nbsp; &nbsp; &nbsp; synchronized (this) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wait();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (InterruptedException e) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e.printStackTrace();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"å½“å‰çº¿ç¨‹ï¼š\" + Thread.currentThread().getName() + \" ç»ˆæ­¢\");\n&nbsp; &nbsp; }\n&nbsp;\n&nbsp; &nbsp; public static void main(String[] args) throws InterruptedException {\n&nbsp; &nbsp; &nbsp; &nbsp; ThreadStateDemo tsd = new ThreadStateDemo();\n&nbsp; &nbsp; &nbsp; &nbsp; Thread t1 = new Thread(tsd, \"çº¿ç¨‹1\");\n&nbsp; &nbsp; &nbsp; &nbsp; Thread t2 = new Thread(tsd, \"çº¿ç¨‹2\");\n&nbsp; &nbsp; &nbsp; &nbsp; Thread t3 = new Thread(tsd, \"çº¿ç¨‹3\");\n&nbsp; &nbsp; &nbsp; &nbsp; Thread t4 = new Thread(tsd, \"çº¿ç¨‹4\");\n&nbsp; &nbsp; &nbsp; &nbsp; Thread t5 = new Thread(tsd, \"çº¿ç¨‹5\");\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"æ–°å»ºçº¿ç¨‹åï¼Œçº¿ç¨‹1çŠ¶æ€ï¼š\" + t1.getState());\n&nbsp; &nbsp; &nbsp; &nbsp; t1.start();\n&nbsp; &nbsp; &nbsp; &nbsp; t2.start();\n&nbsp; &nbsp; &nbsp; &nbsp; t3.start();\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"è°ƒç”¨start()åï¼Œçº¿ç¨‹1çŠ¶æ€ï¼š\" + t1.getState());\n&nbsp; &nbsp; &nbsp; &nbsp; Thread.sleep(2000);\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"ç­‰å¾…2ç§’åï¼Œçº¿ç¨‹1çŠ¶æ€ï¼š\" + t1.getState());\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; synchronized (tsd) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tsd.notifyAll();\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; Thread.sleep(2000);\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"ç­‰å¾…2ç§’åï¼Œçº¿ç¨‹1çŠ¶æ€ï¼š\" + t1.getState());\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; t4.start();\n&nbsp; &nbsp; &nbsp; &nbsp; t5.start();\n&nbsp; &nbsp; &nbsp; &nbsp; Thread.sleep(2000);\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"ç­‰å¾…2ç§’åï¼Œçº¿ç¨‹1çŠ¶æ€ï¼š\" + t1.getState());\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; synchronized (tsd) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tsd.notifyAll();\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; Thread.sleep(2000);\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"ç­‰å¾…2ç§’åï¼Œçº¿ç¨‹1çŠ¶æ€ï¼š\" + t1.getState());\n&nbsp; &nbsp; }\n}\n</code></pre><p>åœ¨çº¿ç¨‹æœªè¢«æ¿€æ´»çš„æƒ…å†µä¸‹ï¼Œå®ƒå¤„äºåˆ›å»ºçŠ¶æ€ã€‚ç„¶è€Œï¼Œä¸€æ—¦å¯åŠ¨äº†çº¿ç¨‹çš„start()æ–¹æ³•ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±è¿›å…¥äº†è¿è¡ŒçŠ¶æ€ã€‚è¯·æ³¨æ„ï¼Œåœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œä¸åŒçº¿ç¨‹çŠ¶æ€ä¹‹é—´å¹¶ä¸å…·æœ‰å¯æ¯”æ€§ã€‚</p><ul>\n<li>ä¸€ç§è®©çº¿ç¨‹é™·å…¥å¾…æœºçŠ¶å†µçš„æ–¹å¼æ˜¯åˆ©ç”¨wait()å‡½æ•°æ–¹æ³•ã€‚å½“ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œçº¿ç¨‹å°±ä¼šåŠ å…¥ç­‰å¾…æ¨¡å¼ã€‚</li>\n<li>ä¸€ç§è®©çº¿ç¨‹é™·å…¥é˜»å¡çŠ¶æ€çš„ç­–ç•¥æ˜¯é‡‡ç”¨synchronizedé”ã€‚å¦‚æœçº¿ç¨‹è¯·æ±‚äº†ä¸€ä¸ªé”ï¼Œè€Œè¿™ä¸ªé”è¢«å æ®ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±ä¼šé™·å…¥é˜»å¡çŠ¶æ€ã€‚</li>\n</ul><p>å½“çº¿ç¨‹æ‰§è¡Œå®Œæ‰€æœ‰ä»»åŠ¡æ—¶ï¼Œå®ƒå°†è¿›å…¥ç»ˆæ­¢çŠ¶æ€ã€‚</p><p>å¦ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µæ˜¯çº¿ç¨‹çŠ¶æ€çš„å˜åŒ–æ˜¯ç”±çº¿ç¨‹è°ƒåº¦å™¨æ¥æ§åˆ¶çš„ã€‚çº¿ç¨‹è°ƒåº¦å™¨ä¼šåœ¨ä¸åŒçº¿ç¨‹ä¹‹é—´åˆ‡æ¢ï¼Œä»¥ä¾¿åœ¨æ¯ä¸€ä¸ªæ—¶é—´ç‰‡å†…éƒ½èƒ½å¤Ÿåˆ†é…è¶³å¤Ÿçš„æ—¶é—´ç»™æ‰€æœ‰çš„çº¿ç¨‹ã€‚</p><p>ä½ å¯ä»¥çœ‹ä¸€ä¸‹çº¿ç¨‹çŠ¶æ€çš„è½¬æ¢ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/c2/67/c27a6a60de38f7eae7f4yyeb1e15fb67.png?wh=1920x991\" alt=\"å›¾ç‰‡\"></p><h2>è™šæ‹Ÿçº¿ç¨‹ï¼ˆVirtual Threadï¼‰</h2><p>çº¿ç¨‹æ˜¯ä¸€ç§æ˜‚è´µçš„èµ„æºï¼Œæ¯ä¸ªçº¿ç¨‹çš„åˆ›å»ºå’Œä½¿ç”¨éƒ½éœ€è¦å ç”¨ä¸€å®šçš„å†…å­˜å’ŒCPUæ—¶é—´ã€‚å½“éœ€è¦å¤„ç†å¾ˆå¤šå¹¶å‘ä»»åŠ¡æ—¶ï¼Œåˆ›å»ºå’Œç®¡ç†å¤§é‡çº¿ç¨‹å¯èƒ½å¯¼è‡´æ€§èƒ½ä¸‹é™å’Œèµ„æºæµªè´¹ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJavaè™šæ‹Ÿçº¿ç¨‹åº”è¿è€Œç”Ÿã€‚</p><p>Javaè™šæ‹Ÿçº¿ç¨‹æ˜¯ä¸€ç§è½»é‡çº§çš„çº¿ç¨‹å®ç°ï¼Œå®ƒä¸éœ€è¦åƒä¼ ç»Ÿçº¿ç¨‹é‚£æ ·å ç”¨å¤§é‡çš„å†…å­˜å’ŒCPUæ—¶é—´ã€‚ç›¸åï¼Œå®ƒä»¬æ˜¯åœ¨JVMå±‚é¢ä¸Šç®¡ç†çš„ï¼Œä½¿ç”¨æ›´å°‘çš„ç³»ç»Ÿèµ„æºï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªåº•å±‚æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šè¿è¡Œï¼Œå®ƒå…è®¸å¼€å‘äººå‘˜ä»¥æ›´é«˜æ•ˆå’Œç®€åŒ–çš„æ–¹å¼å¤„ç†å¹¶å‘ä»»åŠ¡ã€‚</p><p>åœ¨å·²ç»å‘å¸ƒJDK 21ç‰ˆæœ¬ä¸­ï¼Œè™šæ‹Ÿçº¿ç¨‹æ›´æ˜¯å…¶ä¸­ä¸€é¡¹éå¸¸é‡è¦çš„æ›´æ–°ç‰¹æ€§ï¼Œç›¸ä¿¡ä¼šåœ¨æœªæ¥çš„ä¸€æ®µæ—¶é—´å†…æˆä¸ºçº¿ç¨‹å®ç°çš„ä¼˜å…ˆé€‰æ‹©ã€‚</p><h3>æ¦‚å¿µ</h3><p>åœ¨ä¹‹å‰çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬å·²ç»æåˆ°Javaçº¿ç¨‹å’Œæ“ä½œç³»ç»Ÿå†…æ ¸çº¿ç¨‹æ˜¯ä¸€ä½“åŒ–çš„ã€‚å®é™…ä¸Šï¼ŒJavaçº¿ç¨‹çš„è°ƒåº¦ä¾èµ–äºåº”ç”¨å†…æ ¸çº¿ç¨‹ã€‚è¿™å°±è¦æ±‚æˆ‘ä»¬å¿…é¡»è¿›è¡Œçº¿ç¨‹åˆ‡æ¢å’Œè¿è¡Œï¼ŒåŒæ—¶ä¹Ÿä¼šè€—è´¹å·¨é‡çš„ç³»ç»Ÿèµ„æºã€‚</p><p>å°½ç®¡æˆ‘ä»¬é‡‡ç”¨äº†å„ç±»çº¿ç¨‹æ± æ¥å®ç°æœ€ä¼˜çš„åŠŸèƒ½æ•ˆç›Šï¼Œä½†æ˜¯åœ¨CPUã€ç½‘ç»œæˆ–å­˜å‚¨å™¨èµ„æºç”¨å°½å‰ï¼Œçº¿ç¨‹è¿˜æ˜¯ä¼šå˜æˆè½¯ä»¶æå‡æ€§èƒ½çš„ç“¶é¢ˆã€‚è¿™ä½¿å¾—ç¡¬ä»¶æ— æ³•å……åˆ†å‘æŒ¥å®ƒæœ¬åº”å…·å¤‡çš„åŠŸèƒ½ã€‚</p><p>è™šæ‹Ÿçº¿ç¨‹å°±æ˜¯ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜è€Œäº§ç”Ÿçš„ã€‚åŸæ¥JDKå­˜åœ¨java.lang.Threadç±»ï¼Œä¿—ç§°çº¿ç¨‹ã€‚ä¸ºäº†æ›´å¥½åœ°åŒºåˆ†è™šæ‹Ÿçº¿ç¨‹å’ŒåŸæœ‰çš„çº¿ç¨‹ç±»ï¼Œå¼•å…¥äº†ä¸€ä¸ªå…¨æ–°ç±»java.lang.VirtualThreadï¼Œä¹Ÿæ˜¯Threadç±»çš„ä¸€ä¸ªå­ç±»å‹ï¼Œç›´è¯‘è¿‡æ¥å°±æ˜¯â€œè™šæ‹Ÿçº¿ç¨‹â€ã€‚</p><p>æ›´æ–°çš„JDKæ–‡æ¡£é‡Œä¹ŸæŠŠåŸæ¥çš„Threadå«åšPlatform Threadï¼Œå¯ä»¥æ›´æ¸…æ™°åœ°å’ŒVirtual ThreadåŒºåˆ†å¼€æ¥ã€‚å®é™…ä¸Šï¼ŒPlatform Threadè¿™ä¸ªè¯è¯­å¯ä»¥è¢«ç¿»è¯‘æˆâ€œå¹³å°çº¿ç¨‹â€ï¼Œå®ƒæŒ‡çš„æ˜¯åœ¨è™šæ‹Ÿçº¿ç¨‹æµè¡Œå‰å°±å·²ç»å­˜åœ¨çš„çº¿ç¨‹æ¦‚å¿µã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™šæ‹Ÿçº¿ç¨‹å¹¶ä¸èƒ½å®Œå…¨æ›¿ä»£å¹³å°çº¿ç¨‹ã€‚</p><p>è™šæ‹ŸåŒ–è¿›ç¨‹æ˜¯åœ¨ç½‘ç»œå¹³å°è¿›ç¨‹ä¹‹é—´è¿ä½œçš„ï¼Œå•ä¸ªç½‘ç»œå¹³å°è¿›ç¨‹å¯èƒ½åŒ…å«æ•°ä¸ªè™šæ‹ŸåŒ–è¿›ç¨‹ã€‚åŒæ ·ï¼Œæ¯ä¸€ä¸ªå¹³å°çº¿ç¨‹ä¹Ÿéƒ½å¯¹åº”ç€å†…æ ¸çº¿ç¨‹ã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†è¿™æ ·ä¸€æ¡ç»“è®ºï¼šVTä»£è¡¨ä¸€æ¡è™šæ‹Ÿçº¿ç¨‹ã€‚</p><h3>ä½¿ç”¨æ–¹æ³•</h3><pre><code class=\"language-java\">public class VirtualThreadTest {\n&nbsp;\n&nbsp; &nbsp; public static void main(String[] args) {\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; Thread.ofVirtual().start(() -&gt; System.out.println(\"è™šæ‹Ÿçº¿ç¨‹æ‰§è¡Œä¸­...\"));\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; Thread.startVirtualThread(() -&gt; System.out.println(\"è™šæ‹Ÿçº¿ç¨‹æ‰§è¡Œä¸­...\"));\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; ExecutorService executorService = Executors.newVirtualThreadPerTaskExecutor();\n&nbsp; &nbsp; &nbsp; &nbsp; executorService.execute(() -&gt; System.out.println(\"è™šæ‹Ÿçº¿ç¨‹æ‰§è¡Œä¸­...\"));\n&nbsp; &nbsp; }\n}\n</code></pre><p>ä»£ç é‡Œæä¾›äº†ä¸¤ç§åˆ›å»ºè™šæ‹Ÿçº¿ç¨‹çš„æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯Thread.ofVirtual().start()æ–¹æ³•å’ŒThread.startVirtualThread()æ–¹æ³•ã€‚æ­¤å¤–çº¿ç¨‹æ± ä¹Ÿæ”¯æŒè™šæ‹Ÿçº¿ç¨‹çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬é€šè¿‡ExecutorServiceçš„å®ç°ç±»Executors.newVirtualThreadPerTaskExecutor()åˆ›å»ºäº†çº¿ç¨‹æ± ï¼Œç„¶åé€šè¿‡execute()æ–¹æ³•æ·»åŠ äº†ä¸€ä¸ªè™šæ‹Ÿçº¿ç¨‹ã€‚</p><h3>å®ç°åŸç†</h3><p>è™šæ‹Ÿçº¿ç¨‹æœ€æ—©è¦æº¯æºåˆ°Javaçš„Loomé¡¹ç›®ï¼Œè™šæ‹Ÿçº¿ç¨‹æ­£æ˜¯Loomçš„å‘å±•ç»“æœã€‚Loomé¡¹ç›®æœ€åˆçš„ç›®æ ‡æ˜¯å®ç°ä¸€ç§æ–°çš„çº¿ç¨‹æ¨¡å‹ï¼Œæ¥æä¾›æ›´è½»é‡çº§å’Œæ›´é«˜æ•ˆçš„çº¿ç¨‹ç®¡ç†æ–¹å¼ã€‚</p><p>æ€»ä½“ä¸Šæ¥çœ‹ï¼Œè™šæ‹Ÿçº¿ç¨‹ç”±ä¸¤ä¸ªå…³é”®ç»„ä»¶ç»„æˆï¼šContinuationï¼ˆç»­ä½“ï¼‰å’ŒSchedulerï¼ˆè°ƒåº¦å™¨ï¼‰ã€‚</p><p>è™šæ‹Ÿçº¿ç¨‹ä¼šå°†ä»»åŠ¡ï¼ˆé€šå¸¸æ˜¯java.lang.Runnableå¯¹è±¡ï¼‰å°è£…åˆ°ä¸€ä¸ªContinuationå®ä¾‹ä¸­ã€‚å½“ä»»åŠ¡éœ€è¦é˜»å¡æŒ‚èµ·æ—¶ï¼Œä¼šè°ƒç”¨Continuationçš„yieldæ“ä½œè¿›è¡Œé˜»å¡ï¼›å½“ä»»åŠ¡éœ€è¦è§£é™¤é˜»å¡å¹¶ç»§ç»­æ‰§è¡Œæ—¶ï¼ŒContinuationä¼šè¢«æ¢å¤æ‰§è¡Œã€‚</p><p>Schedulerè´Ÿè´£å°†ä»»åŠ¡æäº¤ç»™ä¸€ä¸ªçº¿ç¨‹æ± æ¥æ‰§è¡Œã€‚å®ƒæ˜¯java.util.concurrent.Executorçš„å­ç±»ã€‚è™šæ‹Ÿçº¿ç¨‹æ¡†æ¶ä¸ºè™šæ‹Ÿçº¿ç¨‹ä»»åŠ¡æä¾›äº†ä¸€ä¸ªé»˜è®¤çš„ForkJoinPoolçº¿ç¨‹æ± æ¥æ‰§è¡Œä»»åŠ¡ã€‚</p><p>Continuationæ˜¯ä¸€ç§ç¼–ç¨‹æ¦‚å¿µï¼Œç”¨æ¥å®ç°è½»é‡çº§çº¿ç¨‹åˆ‡æ¢å’ŒæŒ‚èµ·çš„åŠŸèƒ½ã€‚å®ƒå…è®¸åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æš‚åœæ‰§è¡Œï¼Œä¿å­˜å½“å‰çš„æ‰§è¡ŒçŠ¶æ€ï¼Œç„¶åæ ¹æ®æˆ‘ä»¬çš„éœ€è¦æ¢å¤ï¼Œå¹¶ç»§ç»­æ‰§è¡Œä¹‹å‰ä¿å­˜çš„çŠ¶æ€ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨Continuationçš„ç¤ºä¾‹ï¼Œä½ å¯ä»¥çœ‹ä¸€ä¸‹ã€‚</p><pre><code class=\"language-java\">public class CoroutineExample {\n&nbsp; &nbsp; static Continuation coroutine;\n&nbsp; &nbsp; static String state = \"start\";\n&nbsp;\n&nbsp; &nbsp; public static void main(String[] args) {\n&nbsp; &nbsp; &nbsp; &nbsp; coroutine = new Continuation(new ContinuationScope(\"coroutine\"), () -&gt; {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while (true) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; switch (state) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case \"task1\":\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"Task1 started\");\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; state = \"task2\";\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Continuation.yield();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"Task1 completed\");\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case \"task2\":\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"Task2 started\");\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; state = \"task3\";\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Continuation.yield();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"Task2 completed\");\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case \"task3\":\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"Task3 started\");\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; state = \"done\";\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Continuation.yield();\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"Task3 completed\");\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; });\n&nbsp;\n&nbsp; &nbsp; &nbsp; &nbsp; while (!state.equals(\"done\")) {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; coroutine.run();\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; System.out.println(\"All tasks completed.\");\n&nbsp; &nbsp; }\n}\n</code></pre><p>æ‰§è¡Œç»“æœï¼š</p><pre><code class=\"language-java\">Task1 started\nTask1 completed\nTask2 started\nTask2 completed\nTask3 started\nTask3 completed\nAll tasks completed.\n</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒContinuationå®ä¾‹è¿›è¡Œyieldè°ƒç”¨åï¼Œå†æ¬¡è°ƒç”¨runæ–¹æ³•å¯ä»¥ä»yieldçš„è°ƒç”¨ä½ç½®ç»§ç»­æ‰§è¡Œï¼Œå®ç°äº†ç¨‹åºä¸­æ–­å’Œæ¢å¤çš„æ•ˆæœã€‚</p><h3>è°ƒåº¦æ–¹å¼</h3><p>ç”±äºçº¿ç¨‹ä¾èµ–çš„æ˜¯æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ç®¡ç†æœºåˆ¶è€Œä¸æ˜¯Java JDKä¸­çš„ä»»åŠ¡åˆ†é…å’Œè°ƒé…æ¨¡å—ï¼Œå› æ­¤è¿™ä¸ªä»¥OSä¸ºåŸºç¡€æ„å»ºå‡ºæ¥çš„çº¿ç¨‹æ²¡åŠæ³•è¢«åè€…æ§åˆ¶ã€‚ç›¸ååœ°ï¼Œå®ƒæ˜¯ç”±åº•å±‚ç¡¬ä»¶æä¾›çš„ã€å…·æœ‰ç‹¬ç«‹ç®¡ç†èƒ½åŠ›çš„â€œè™šâ€æ€å¤„ç†å•å…ƒï¼Œå³æ‰€è°“çš„â€œVTâ€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„è™šæ‹ŸåŒ–æŠ€æœ¯ä¸‹çš„å¤šæ ¸æˆ–è¶…æ ¸å¿ƒè®¡ç®—èµ„æºå…±äº«æ–¹å¼ä¸­çš„ä¸€ç§ç‰¹æ®Šå½¢å¼çš„å¤šè·¯å¤ç”¨ç­–ç•¥ã€‚</p><p>æ¯ä¸ªç‰©ç†æœºä¸Šéƒ½å­˜åœ¨ç€å¤šä¸ªè¿™æ ·çš„é€»è¾‘å®ä½“/èŠ‚ç‚¹ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ªä¸ªå¯ä¾›ç”¨æˆ·ä½¿ç”¨çš„æœåŠ¡å®ä¾‹ç©ºé—´ç­‰æ¦‚å¿µä¸Šçš„æŠ½è±¡ä½“ï¼Œå®ƒä»¬å¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€åˆ›å»ºå‡ºæ¥ï¼Œå¹¶åœ¨å¿…è¦æ—¶åˆèƒ½å¤Ÿéšæ—¶é”€æ¯æ‰ï¼Œè€Œä¸å½±å“å…¶ä»–éƒ¨åˆ†çš„åŠŸèƒ½æ­£å¸¸è¿ä½œçŠ¶æ€ï¼Œè¿™äº›ç‰¹æ€§éƒ½æ˜¯éå¸¸é²œæ˜çš„ã€‚</p><p>JDKä¸­çš„è™šæ‹Ÿçº¿ç¨‹è°ƒåº¦æœºåˆ¶æ˜¯é€šè¿‡æŠŠè™šæ‹Ÿçº¿ç¨‹åˆ†æ´¾åˆ°å¯¹åº”çš„å¹³å°çº¿ç¨‹ä¸Šå®Œæˆçš„ã€‚è¿™æ˜¯ä¸€ç§åŸºäºè™šæ‹Ÿçº¿ç¨‹å’Œå¹³å°çº¿ç¨‹ä¹‹é—´çš„M:Nè°ƒåº¦æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªè™šæ‹Ÿçº¿ç¨‹éƒ½å¯ä»¥è¢«å¤šæ¡å¹³å°çº¿ç¨‹æ‰€æ‰§è¡Œã€‚ä¸€æ—¦æŸä¸ªçº¿ç¨‹çš„ç­‰å¾…é˜Ÿåˆ—æ²¡æœ‰ä»»ä½•å¾…å¤„ç†çš„å·¥ä½œï¼Œä¸ºé¿å…å‡ºç°çº¿ç¨‹æŒ¨é¥¿çš„æƒ…å†µï¼ŒForkJoinPoolå®ç°äº†ä»»åŠ¡æŠ¢å¤ºç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è®©å¤„äºæŒ¨é¥¿çŠ¶æ€çš„çº¿ç¨‹èƒ½å¤Ÿä»å…¶ä»–æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹çš„ç­‰å¾…é˜Ÿåˆ—é‡Œè·å–æ–°çš„å·¥ä½œä»»åŠ¡ã€‚</p><p>è™šæ‹Ÿçº¿ç¨‹çš„æŒ‚è½½å’Œå¸è½½è¿‡ç¨‹å¯ä»¥é€šè¿‡ä¼ªä»£ç è¡¨ç¤ºã€‚</p><pre><code class=\"language-java\">mount();\ntry {\n&nbsp; &nbsp; Continuation.run();\n} finally {\n&nbsp; &nbsp; unmount();\n}\n</code></pre><p>å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç æ¥éªŒè¯è™šæ‹Ÿçº¿ç¨‹çš„æŒ‚è½½å’Œå¸è½½ã€‚</p><pre><code class=\"language-java\">public static void main(String[] args) throws Exception {\n&nbsp; var threads = IntStream.range(0, 3).mapToObj(index -&gt; Thread.ofVirtual().unstarted((self) -&gt; {\n&nbsp; &nbsp; System.out.println(Thread.currentThread());\n&nbsp; &nbsp; try {\n&nbsp; &nbsp; &nbsp; Thread.sleep(10);\n&nbsp; &nbsp; } catch (InterruptedException e) {\n&nbsp; &nbsp; &nbsp; throw new RuntimeException(e);\n&nbsp; &nbsp; }\n&nbsp; &nbsp; System.out.println(Thread.currentThread());\n&nbsp; })).toList();\n&nbsp;\n&nbsp; threads.forEach(Thread::start);\n&nbsp; for (Thread thread : threads) {\n&nbsp; &nbsp; thread.join();\n&nbsp; }\n}\n</code></pre><p>è¾“å‡ºç»“æœï¼š</p><pre><code class=\"language-java\">VirtualThread[#24]/runnable@ForkJoinPool-1-worker-3\nVirtualThread[#22]/runnable@ForkJoinPool-1-worker-1\nVirtualThread[#23]/runnable@ForkJoinPool-1-worker-2\nVirtualThread[#26]/runnable@ForkJoinPool-1-worker-2\nVirtualThread[#24]/runnable@ForkJoinPool-1-worker-1\nVirtualThread[#23]/runnable@ForkJoinPool-1-worker-3\nVirtualThread[#22]/runnable@ForkJoinPool-1-worker-2\n</code></pre><p>å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œè™šæ‹Ÿçº¿ç¨‹VirtualThread[#24]æœ€åˆåœ¨worker-3ä¸Šæ‰§è¡Œï¼Œç„¶åé‡æ–°å”¤é†’ååœ¨worker-1ä¸Šæ‰§è¡Œã€‚è¿™æ˜¯å› ä¸ºä»£ç ä¸­ä½¿ç”¨äº†sleepæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå¯¼è‡´è™šæ‹Ÿçº¿ç¨‹åˆ‡æ¢ã€‚</p><p>ä¸è¿‡æœ‰ä¸¤ç§çŠ¶å†µï¼Œè™šæ‹Ÿçº¿ç¨‹ä¼šè¢«å›ºå®šåˆ°å®ƒè¿è¡Œçš„å¹³å°çº¿ç¨‹ä¸Šï¼Œæ²¡åŠæ³•è¿›è¡Œè½½å…¥å’Œå¸è½½ã€‚</p><ol>\n<li>å½“åœ¨synchronizedå—æˆ–æ–¹æ³•ä¸­æ‰§è¡Œä»£ç çš„æ—¶å€™ã€‚</li>\n<li>å½“æ‰§è¡Œnativeæ–¹æ³•æˆ–foreign functionçš„æ—¶å€™ã€‚</li>\n</ol><p>å›ºå®šè™šæ‹Ÿçº¿ç¨‹ä¸ä¼šå¯¹ç¨‹åºçš„æ­£å¸¸è¿è¡Œé€ æˆè´Ÿé¢å½±å“ï¼Œä½†å¯èƒ½ä¼šå‰Šå¼±ç³»ç»Ÿçš„å¹¶å‘æ€§å’Œååé‡ã€‚å½“è™šæ‹Ÿçº¿ç¨‹è¢«è®¾ç½®æˆé˜»å¡æ¨¡å¼çš„æ—¶å€™ï¼Œè´Ÿè´£æ‰§è¡Œå®ƒçš„å¹³å°çº¿ç¨‹ä¹Ÿä¼šé­é‡é˜»å¡ã€‚å¦‚æœè™šæ‹Ÿçº¿ç¨‹æ²¡æœ‰è¢«è®¾ç½®æˆé˜»å¡æ¨¡å¼ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œé˜»å¡æ“ä½œçš„æ—¶å€™ä¼šä»å¹³å°çº¿ç¨‹é‡Œå¸è½½ã€‚</p><p>æ‰€ä»¥è¯´ï¼ŒJDKçš„è™šæ‹Ÿçº¿ç¨‹è°ƒåº¦å™¨é€šè¿‡æŠŠè™šæ‹Ÿçº¿ç¨‹åˆ†é…ç»™å¹³å°çº¿ç¨‹æ¥è¿›è¡Œè°ƒåº¦ï¼Œå…¶ä¸­è™šæ‹Ÿçº¿ç¨‹çš„æŒ‚è½½å’Œå¸è½½è¿‡ç¨‹æ˜¯å…³é”®æ­¥éª¤ã€‚ç„¶è€Œï¼Œè™šæ‹Ÿçº¿ç¨‹çš„æŒ‚è½½å’Œå¸è½½åœ¨æŸäº›æƒ…å†µä¸‹ä¼šå—åˆ°é™åˆ¶ï¼Œè¿™å¯èƒ½ä¼šå½±å“ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½ï¼Œæ‰€ä»¥éœ€è¦ä½ æ ¼å¤–æ³¨æ„ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„åŸºæœ¬è°ƒåº¦å•ä½ï¼Œè€Œåœ¨Javaä¸­ï¼Œçº¿ç¨‹æ˜¯JVMçš„åŸºæœ¬è°ƒåº¦å•ä½ã€‚çº¿ç¨‹çŠ¶æ€çš„å˜åŒ–æ˜¯ä»NEWåˆ°RUNNABLEï¼Œå†åˆ°BLOCKEDã€WAITINGå’ŒTERMINATEDçš„è¿‡ç¨‹ã€‚Javaä¸­é‡‡ç”¨äº†ä¸€å¯¹ä¸€çš„çº¿ç¨‹æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªJavaçº¿ç¨‹å¯¹åº”ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„å†…æ ¸çº¿ç¨‹ã€‚è¿™ç§æ¨¡å‹çš„ç¼ºç‚¹åœ¨äºçº¿ç¨‹çš„åˆ›å»ºå’Œåˆ‡æ¢ä¼šå ç”¨è¾ƒå¤§çš„CPUæ—¶é—´ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒJVMå¼•å…¥äº†è™šæ‹Ÿçº¿ç¨‹ã€‚è™šæ‹Ÿçº¿ç¨‹æ˜¯è¿è¡Œåœ¨JVMé‡Œçš„è½»é‡çº§çº¿ç¨‹ï¼Œå®ƒå¯ä»¥ä½¿çº¿ç¨‹çš„åˆ›å»ºå’Œåˆ‡æ¢æ›´åŠ ç»æµé«˜æ•ˆã€‚</p><p>è™šæ‹Ÿçº¿ç¨‹ç”±Continuationå’ŒSchedulerä¸¤ä¸ªå…³é”®ç»„ä»¶å…±åŒæ„æˆã€‚Continuationæ˜¯ä¸€ç§ç¼–ç¨‹æ¦‚å¿µï¼Œç”¨æ¥å®ç°è½»é‡çº§çº¿ç¨‹åˆ‡æ¢å’ŒæŒ‚èµ·çš„åŠŸèƒ½ã€‚Schedulerè´Ÿè´£æŠŠä»»åŠ¡æäº¤ç»™ä¸€ä¸ªçº¿ç¨‹æ± æ¥æ‰§è¡Œï¼Œå®ƒç±»ä¼¼äºForkJoinPoolçš„çº¿ç¨‹æ± ï¼Œå¹¶ä¸”æ˜¯åŸºäºFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æ¨¡å¼è¿›è¡Œè°ƒåº¦ã€‚è™šæ‹Ÿçº¿ç¨‹çš„è°ƒåº¦å’ŒæŒ‚è½½/å¸è½½è¿‡ç¨‹æ˜¯é€šè¿‡è°ƒåº¦å™¨å®ç°çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼äºæ“ä½œç³»ç»Ÿä¸­çš„è¿›ç¨‹è°ƒåº¦ã€‚</p><p>è™šæ‹Ÿçº¿ç¨‹çš„ä½¿ç”¨å¯ä»¥é€šè¿‡Thread.ofVirtual()å’ŒExecutors.newVirtualThreadPerTaskExecutor()æ–¹æ³•è¿›è¡Œåˆ›å»ºã€‚è™šæ‹Ÿçº¿ç¨‹çš„è°ƒåº¦æ˜¯åŸºäºM:Nçš„ï¼Œæ„å‘³ç€å¤šä¸ªè™šæ‹Ÿçº¿ç¨‹å¯ä»¥è¿è¡Œåœ¨å°‘é‡çš„å¹³å°çº¿ç¨‹ä¸Šã€‚</p><h2><img src=\"https://static001.geekbang.org/resource/image/67/15/67d01a4d6d3dc05d409c0fcfe5db2015.jpg?wh=6666x4185\" alt=\"å›¾ç‰‡\"></h2><h2>æ€è€ƒé¢˜</h2><p>å­¦è€Œä¸æ€åˆ™ç½”ï¼Œå­¦å®Œè¿™èŠ‚è¯¾ä¹‹åï¼Œæˆ‘ç»™ä½ ç•™ä¸¤ä¸ªé—®é¢˜ã€‚</p><ol>\n<li>çº¿ç¨‹æœ‰å“ªäº›çŠ¶æ€ï¼Œå®ƒä»¬æ˜¯å¦‚ä½•è½¬æ¢çš„ï¼Ÿ</li>\n<li>è™šæ‹Ÿçº¿ç¨‹æ˜¯å¦‚ä½•è°ƒåº¦çš„ï¼Ÿ</li>\n</ol><p>å¸Œæœ›ä½ è®¤çœŸæ€è€ƒï¼Œç„¶åæŠŠæ€è€ƒåçš„ç»“æœåˆ†äº«åˆ°è¯„è®ºåŒºï¼Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºï¼Œå¦‚æœæœ‰æ”¶è·çš„è¯ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾çš„å†…å®¹åˆ†äº«ç»™éœ€è¦çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p><p>ğŸ’¡ ç‚¹äº®ä½ çš„çŸ¥è¯†æ¡†æ¶å›¾</p><p><img src=\"https://static001.geekbang.org/resource/image/70/77/7058077c69bf610010ea4b7yyfcd2677.jpg?wh=7515x5387\" alt=\"\"></p>","neighbors":{"left":{"article_title":"18ï½œè¢«å¿½è§†çš„å˜é‡ï¼šå¸¦ä½ å…¨é¢è®¤è¯†JVMä¸­çš„å˜é‡","id":709396},"right":{"article_title":"20ï½œJMMï¼šå¦‚ä½•æ‰“é€ ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç¨‹åºï¼Ÿ","id":713611}},"comments":[{"had_liked":false,"id":383840,"user_name":"Demon.Lee","can_delete":false,"product_type":"c1","uid":1052859,"ip_address":"å®‰å¾½","ucode":"7F0E5493A8E345","user_header":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","comment_is_top":false,"comment_ctime":1699781342,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100613601,"comment_content":"1ã€â€œè™šæ‹ŸåŒ–è¿›ç¨‹æ˜¯åœ¨ç½‘ç»œå¹³å°è¿›ç¨‹ä¹‹é—´è¿ä½œçš„ï¼Œå•ä¸ªç½‘ç»œå¹³å°è¿›ç¨‹å¯èƒ½åŒ…å«æ•°ä¸ªè™šæ‹ŸåŒ–è¿›ç¨‹ã€‚åŒæ ·ï¼Œæ¯ä¸€ä¸ªå¹³å°çº¿ç¨‹ä¹Ÿéƒ½å¯¹åº”ç€å†…æ ¸çº¿ç¨‹ã€‚ç”±æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†è¿™æ ·ä¸€æ¡ç»“è®ºï¼šVT ä»£è¡¨ä¸€æ¡è™šæ‹Ÿçº¿ç¨‹ã€‚â€\n\nè¿™é‡Œçš„è™šæ‹ŸåŒ–è¿›ç¨‹æ˜¯å•¥ï¼Œè€å¸ˆèƒ½å¦å†è§£é‡Šè§£é‡Šã€‚\n\n2ã€â€œç”±äºçº¿ç¨‹ä¾èµ–çš„æ˜¯æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ç®¡ç†æœºåˆ¶è€Œä¸æ˜¯ Java JDK ä¸­çš„ä»»åŠ¡åˆ†é…å’Œè°ƒé…æ¨¡å—ï¼Œå› æ­¤è¿™ä¸ªä»¥ OS ä¸ºåŸºç¡€æ„å»ºå‡ºæ¥çš„çº¿ç¨‹æ²¡åŠæ³•è¢«åè€…æ§åˆ¶ã€‚ç›¸ååœ°ï¼Œå®ƒæ˜¯ç”±åº•å±‚ç¡¬ä»¶æä¾›çš„ã€å…·æœ‰ç‹¬ç«‹ç®¡ç†èƒ½åŠ›çš„â€œè™šâ€æ€å¤„ç†å•å…ƒï¼Œå³æ‰€è°“çš„â€œVTâ€ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„è™šæ‹ŸåŒ–æŠ€æœ¯ä¸‹çš„å¤šæ ¸æˆ–è¶…æ ¸å¿ƒè®¡ç®—èµ„æºå…±äº«æ–¹å¼ä¸­çš„ä¸€ç§ç‰¹æ®Šå½¢å¼çš„å¤šè·¯å¤ç”¨ç­–ç•¥ã€‚â€\n\nè™šæ‹Ÿçº¿ç¨‹ç”± JVM ç®¡ç†ï¼Œè¿™ä¸€æ®µå®é™…ä¸Šæƒ³è¡¨è¾¾çš„æ˜¯ï¼Ÿæ²¡å¤ªçœ‹æ‡‚ï¼Œèƒ½å¦è¯·è€å¸ˆå†è¯´è¯´ã€‚","like_count":0,"discussions":[{"author":{"id":1120057,"avatar":"https://static001.geekbang.org/account/avatar/00/11/17/39/3274257b.jpg","nickname":"ple","note":"","ucode":"E1C4519C325994","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":636193,"discussion_content":"è¿™é‡Œè€å¸ˆä»–åº”è¯¥æ˜¯å†™é”™äº†ï¼Œè¿™é‡Œçš„è¿›ç¨‹å°±æ˜¯çº¿ç¨‹ï¼Œä»–å¥½åƒå“ªé‡Œå¤åˆ¶è¿‡æ¥çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1705771222,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"æµ™æ±Ÿ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":383711,"user_name":"soddygo","can_delete":false,"product_type":"c1","uid":1071509,"ip_address":"å››å·","ucode":"E1D4D272C95804","user_header":"https://static001.geekbang.org/account/avatar/00/10/59/95/a164fa5c.jpg","comment_is_top":false,"comment_ctime":1699506237,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100613601,"comment_content":"è¿™ä¸ªè™šæ‹Ÿçº¿ç¨‹ï¼Œèƒ½å¦å’Œ kotlin çš„åç¨‹åšæ¯”è¾ƒï¼Ÿçœ‹æ€è·¯æ˜¯ä¸€æ ·çš„","like_count":0},{"had_liked":false,"id":382612,"user_name":"é»„æµ·å³°","can_delete":false,"product_type":"c1","uid":1275357,"ip_address":"å¹¿ä¸œ","ucode":"E9340719BC96B2","user_header":"https://static001.geekbang.org/account/avatar/00/13/75/dd/9ead6e69.jpg","comment_is_top":false,"comment_ctime":1697673015,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100613601,"comment_content":"é‚£å°±æ˜¯javaå·²æœ‰åç¨‹äº†å•Š","like_count":0}]}