{"id":761820,"title":"开篇词｜云原生技术：变革基础架构的核动力","content":"<p>你好，我是潘野。</p><p>先简单介绍一下我自己。我曾经在SAP、动视暴雪、eBay等不同行业的IT公司工作过，拥有10多年的基础架构经验，致力于帮助企业构建、管理和优化云原生应用。这些年来，我一直活跃在云平台基础架构与实施领域，积累了丰富的理论和实操经验。</p><h2>云原生技术对基础架构的变革之力</h2><p>回顾我过去的经历，我觉得给我整个职业生涯带来最大转变的一件事，就是2018年的时候，在eBay转入了Kubernetes平台组，亲历了eBay云平台从Openstack转向Kubernetes的全部过程。在这个过程中，我主要负责Kubernetes版本升级（从1.10开始升级到1.18）以及集群的生命周期管理，包括了近百个Kubernetes集群，总计7万个节点。</p><p>这个过程，让我深刻体会到了云原生技术给基础架构管理带来的便利。</p><p><img src=\"https://static001.geekbang.org/resource/image/6d/7e/6dd3cd64888981bf1ca8f4e4756c3d7e.png?wh=1820x1146\" alt=\"图片\"></p><p>在2010年之前，eBay底层架构还是物理机器，混合了Linux、Solaris还有大量的Windows。后来，公司基于VMware平台创造了第一代的云平台，并在2015年转向Openstack。之后伴随容器化的发展趋势，再加上Kubernetes也逐渐成熟了，公司就决定从基于虚拟化的云平台，转向基于Kubernetes的云平台。</p><!-- [[[read_end]]] --><p>从开始接触Kubernetes的时候，我就意识到底层的基础设施管理即将产生变革，这里举几个印象最深刻的例子。</p><p>首先是<strong>应用兼容问题</strong>。转向Kubernetes之前，一些应用无法被eBay标准PaaS很好地兼容。一旦这类应用对应的虚拟机需要重建时，就要耗费大量精力手动补齐机器。但是在Kubernetes里，reconcile模式配合声明式API就能轻松解决这种问题。</p><p>其次就是<strong>资源利用率的提高</strong>。原先基于虚拟机的方式，横向动态扩展还比较容易，但难以做到资源纵向的动态调整，而在Kubernetes里面，无论是横向还是纵向动态扩展，都变得非常容易。</p><p>另外，还有<strong>解耦带来的便利</strong>。Kubernetes完善的调度模型使得上层应用和底层基础架构能够解耦。当底层机器需要维护的时候，利用好PDB和Kubernetes调度，我们可以保证在业务不中断的同时，对底层机器做维护。</p><p>还有很多的特性都切实提高了管理效率，这里就不一一列举了。</p><h2>这门课能帮你解决哪些问题</h2><p>正因为我体会到了云原生技术带来的便利，从此一发不可收拾，一直在这个领域钻研深耕。</p><p>最近几年，我收到极客时间邀请，在云原生训练营里担任了多期领教，帮助学员解决相关的疑难问题。比较典型的问题包括后面这些：</p><ul>\n<li>我们一共就十几个服务，这个业务体量用得着Kubernetes吗？</li>\n<li>Kubernetes spec那么长，不如我原来写个部署脚本来得方便，为何要转向Kubernetes呢？</li>\n<li>既然我都容器化了，那虚拟化平台还有存在的必要吗？</li>\n</ul><p>我非常理解大家的困惑，因为我在最初的时候也产生过同样的疑问。因此我决定通过这门课程，与你分享云原生基础架构自动化方面的落地经验。</p><p>正所谓“兵马未动，粮草先行”，基础架构就相当于我们行军打仗中的粮草。随着分布式技术的成熟以及微服务的流行，基础架构管理面临着新的挑战。比如在微服务中，每一个微服务都有一个自己的数据库，过去那种找系统管理员建立数据库服务器的方式，显然就不再适用了。</p><p>微服务、分布式的背景下，资源的快速获取还有精细管理成为难点，这就要求我们从原先面向配置工具的管理方式，过渡到面向API和资源管理，未来则会转向从应用的角度管理基础架构资源。</p><p>看到这里，你可能又会问，这些问题难道Kubernetes不是已经解决了么？为什么还要专门探讨基础架构的自动化呢？</p><p>实际上，在云原生的体系中，我们可能认为Kubernetes是那层基础架构，但是Kubernetes依然需要与计算、网络、存储三方面打交道，也就是我们经常提到的，Kubernetes中有三大接口——容器运行时接口 CRI，容器网络接口 CNI以及容器存储接口 CSI。</p><p>也就是说，在Kubernetes之外，我们依然还需要完成操作系统、网络、存储等资源的基础配置。所以不仅是Kubernetes，还有它周边的基础设施，都需要完善的自动化程序，才能真正实现基础架构的自动配置、扩展和修复。</p><p>此外，如果你对云原生的DevOps有所了解，应该知道DevOps中有这四个环节，构建、测试、部署和维护。而良好的基础架构自动化可以提升这四个环节的效率，进而实现DevOps，打破传统开发和运维的壁垒，最终实现高效协作的目标。</p><p>所以作为应用开发人员，了解基础架构管理这方面的底层知识，也能帮你加深对系统整体架构的理解。之后遇到线上应用问题的时候，自然可以快速识别问题根源是来自基础架构，还是来自应用本身，进而制定有效的解决方案。</p><p><img src=\"https://static001.geekbang.org/resource/image/25/d7/257b8742c62f2fac501145ca051e34d7.jpg?wh=3900x2194\" alt=\"\"></p><p>总之，我想结合我个人多年的实践经验，通过这门课为你建立一个体系化的基础架构管理实践方法论，帮助你解决基础架构管理中的痛点问题。</p><h2>课程安排</h2><p>在接下来的两个月里，我将带领你一起学习实践，掌握在企业中落地一个自动化的基础架构管理系统所需的关键技术。</p><p>课程内容主要分为基础篇、GitOps实战篇、进阶篇还有安全篇四个部分。</p><p><img src=\"https://static001.geekbang.org/resource/image/yy/29/yya3e523a2d539b1c3ce128d06ec3729.jpg?wh=2871x2023\" alt=\"\"></p><p>首先是基础篇，主要帮你建立基础架构管理的整体认识，了解IaC的主流工具和落地思路，为后续的实战讲解做好理论铺垫。</p><p>这个部分我们主要解决以下问题：</p><ul>\n<li>面对众多的基础架构管理工具（比如Terraform，Pulumi）应该如何选择？</li>\n<li>公司里既有公有云，又有私有云，如何用一套代码来管理两种架构体系？</li>\n<li>公司业务在不断发展变化，很多同学可能会遇到“流程一变，推倒重来”的基础架构管理，我们应该如何打造可扩展、灵活性高的管理方式？</li>\n</ul><p>然后是GitOps实战篇，我会结合在实际业务中的经验，带你搭建<strong>一套自下而上的基础设施管理系统，帮你掌握基础设施管理系统的架构设计和实现方法，提升解决实际业务的能力</strong>。这里顺便说明一下，课程中我们会涉及大量的API与开源工具，但是我们的重心是借助这些工具，帮你建立解决问题的思路。</p><p>学完这个部分，很多工作里的问题都会迎刃而解，比如：</p><ul>\n<li>如何用GitOps方式来管理基础设施？</li>\n<li>面对上百个Kubernetes集群，怎么保证每个集群配置统一？</li>\n<li>DevOps的理念如何应用在基础架构管理上。</li>\n</ul><p>之后是进阶篇，我会结合现在“降本增效”这个热点话题，带你实践如何更高效地利用资源。你将会了解，在公有云上如何利用好Kubernetes自身的横向与纵向扩展能力，做到云上资源的随用随取，用完释放。还有私有云中，如何在有限的资源条件下做到资源扩展和收缩。</p><p>在安全篇，我会和你探讨云原生的安全体系管理，重点讨论如何管理企业的机密信息，比如正确管理企业私有证书，保护企业中机密数据的传输等等。</p><p>我希望，这门课程可以帮你解决工作中遇到的疑难问题，将 DevOps 的理念和实践应用在基础架构的管理上，保障云原生应用的安全性和可靠性，提升你解决问题的能力和职业竞争力。只要你耐心跟住我的思路，两个月后，你会<strong>掌握构建一套可复用的基础设施管理系统的能力，成为一名合格的云原生架构师或SRE工程师。</strong></p><p>最后，我也非常希望了解一下屏幕那边的你，欢迎在留言区里介绍下自己，聊聊你目前在云原生方面的思考与困惑。</p>","neighbors":{"left":[],"right":{"article_title":"01｜发展历程：IaC过去、现在与未来展望","id":761828}},"comments":[{"had_liked":false,"id":389004,"user_name":"陈斯佳","can_delete":false,"product_type":"c1","uid":1259323,"ip_address":"加拿大","ucode":"C236F874FC767A","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","comment_is_top":true,"comment_ctime":1711364365,"is_pvip":false,"replies":[{"id":141571,"content":"陈同学你好，这个问题在我刚开始接触各类公有云的时候也有类似的困惑，其实无论是Azure，还是AWS，还是GCP，还是Alicloud，他们还是计算，网络，存储这三块的内容，主要差异点在他们的API不一样，一些设计的模式略有区别。\n\n这些云厂商非常注重文档的编写，除了用terraform去操作之外，多读一读官方文档，会有不一样的收获。官方文档不仅教你如何使用，还会教你最佳实践的方法。\n\n例如之前在SAP的时候，项目里也是使用了Azure，我会经常翻阅Azure的官方文档来了解不同组件的细节 ，https:&#47;&#47;learn.microsoft.com&#47;zh-cn&#47;azure&#47;?product=popular，而现在的项目里AWS使用较多，有问题的时候，我也会有限搜索AWS的官方文档来寻找答案。","user_name":"作者回复","user_name_real":"编辑","uid":1043450,"ctime":1711454558,"ip_address":"上海","comment_id":389004,"utype":1}],"discussion_count":6,"race_medal":0,"score":2,"product_id":100758001,"comment_content":"老师好 我最大的困惑就是如何能深入的了解云。我们公司现在都是使用 Azure，Azure上所有的资源都是用Terraform进行管理。平常工作就是修改Terraform Code来对Azure资源进行增删改，但是很多都是代码的复制粘贴而已。不知道要如何进一步学习了解云上的这些资源。换句话说，不清楚自己应该做到什么程度才算是了解云呢？","like_count":6,"discussions":[{"author":{"id":1043450,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/eb/fa/5dc2bcae.jpg","nickname":"潘野","note":"","ucode":"5B60CCA6C00359","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":640395,"discussion_content":"陈同学你好，这个问题在我刚开始接触各类公有云的时候也有类似的困惑，其实无论是Azure，还是AWS，还是GCP，还是Alicloud，他们还是计算，网络，存储这三块的内容，主要差异点在他们的API不一样，一些设计的模式略有区别。\n\n这些云厂商非常注重文档的编写，除了用terraform去操作之外，多读一读官方文档，会有不一样的收获。官方文档不仅教你如何使用，还会教你最佳实践的方法。\n\n例如之前在SAP的时候，项目里也是使用了Azure，我会经常翻阅Azure的官方文档来了解不同组件的细节 ，https://learn.microsoft.com/zh-cn/azure/?product=popular，而现在的项目里AWS使用较多，有问题的时候，我也会有限搜索AWS的官方文档来寻找答案。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1711454559,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":1259323,"avatar":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","nickname":"陈斯佳","note":"","ucode":"C236F874FC767A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1043450,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/eb/fa/5dc2bcae.jpg","nickname":"潘野","note":"","ucode":"5B60CCA6C00359","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":640444,"discussion_content":"感谢老师回复！还想问一下，除了文档，有没有什么相关的书籍可以推荐的呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711502043,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":640395,"ip_address":"加拿大","group_id":0},"score":640444,"extra":""}]},{"author":{"id":3654504,"avatar":"","nickname":"Geek_45a572","note":"","ucode":"B0503B2F0D8A6D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":641392,"discussion_content":"有幸读了英文版的《Terraform：多云、混合云环境下实现基础设施即代码》，在aws中实战了eks部分，感觉terraform并没有想象中的好用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1712586324,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1332257,"avatar":"https://static001.geekbang.org/account/avatar/00/14/54/21/0bac2254.jpg","nickname":"橙汁","note":"","ucode":"EC3FF10D708C9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":640382,"discussion_content":"有啥可纠结的，是让你用云 iac化管理，没说让你造云","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711450973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1259323,"avatar":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","nickname":"陈斯佳","note":"","ucode":"C236F874FC767A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1332257,"avatar":"https://static001.geekbang.org/account/avatar/00/14/54/21/0bac2254.jpg","nickname":"橙汁","note":"","ucode":"EC3FF10D708C9D","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":640445,"discussion_content":"你们公司用的是什么iac工具管理云资源？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711502075,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":640382,"ip_address":"加拿大","group_id":0},"score":640445,"extra":""},{"author":{"id":1332257,"avatar":"https://static001.geekbang.org/account/avatar/00/14/54/21/0bac2254.jpg","nickname":"橙汁","note":"","ucode":"EC3FF10D708C9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1259323,"avatar":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","nickname":"陈斯佳","note":"","ucode":"C236F874FC767A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":640589,"discussion_content":"没用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711630784,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":640445,"ip_address":"北京","group_id":0},"score":640589,"extra":""}]}]},{"had_liked":false,"id":389148,"user_name":"首富手记","can_delete":false,"product_type":"c1","uid":1286588,"ip_address":"新加坡","ucode":"879DED4078303C","user_header":"https://static001.geekbang.org/account/avatar/00/13/a1/bc/ef0f26fa.jpg","comment_is_top":false,"comment_ctime":1711682008,"is_pvip":false,"replies":[{"id":141587,"content":"同学你好，在模块三我们会有这个问题的详细讲解，敬请期待。","user_name":"作者回复","user_name_real":"编辑","uid":1043450,"ctime":1711762120,"ip_address":"上海","comment_id":389148,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100758001,"comment_content":"老师请问会详细的介绍Karpenter 和k8s cluster autoScaler吗？给出使用案例的那种；\n\n我们现在会对deployment资源进行逻辑上的划分；\n会让不同的deployment 跑到不同的机器上，这个是靠nodeSelector 实现的；\n我们现在想通过CA来实现节点的自动扩容，不同的标签的pod pending能调用不同的ASG来扩容机器；\n不同标签的POD 就对应不同的nodeSelector\n但是现在苦于没找到方法，老师可以指点一下吗？","like_count":0,"discussions":[{"author":{"id":1043450,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/eb/fa/5dc2bcae.jpg","nickname":"潘野","note":"","ucode":"5B60CCA6C00359","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":640705,"discussion_content":"同学你好，在模块三我们会有这个问题的详细讲解，敬请期待。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711762120,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389144,"user_name":"Geek_2ad16e","can_delete":false,"product_type":"c1","uid":2790549,"ip_address":"广东","ucode":"5FE410C42F97A5","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIibashTHtGDWAT2xhictVILic2eUKFJC6bCwDZ7wYicYNrtQafMBYNWKHBPHuqxLzorMd4dH9HwxDWgQ/132","comment_is_top":false,"comment_ctime":1711678668,"is_pvip":false,"replies":[{"id":141591,"content":"同学你好，eBay转向kubernetes的因素比较多，其中最主要的因素是kubernetes的设计模式非常成功，对资源利用率的大幅提升以及运维成本的降低等，此外社区有kata，kubevirt这样的项目，通过kubernetes来启动VM。","user_name":"作者回复","user_name_real":"编辑","uid":1043450,"ctime":1711913675,"ip_address":"上海","comment_id":389144,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100758001,"comment_content":"老师好，可以详细说说eBay 从 Openstack 转向 Kubernetes 的过程吗？我的理解openstack只是提供了一个功能丰富的虚拟化的环境，而k8s是用来编排这个虚拟化环境里容器的，为什么eBay的k8s能取代openstack呢？比如说k8s也没有自带虚拟化呀？","like_count":0,"discussions":[{"author":{"id":1043450,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/eb/fa/5dc2bcae.jpg","nickname":"潘野","note":"","ucode":"5B60CCA6C00359","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":640833,"discussion_content":"同学你好，eBay转向kubernetes的因素比较多，其中最主要的因素是kubernetes的设计模式非常成功，对资源利用率的大幅提升以及运维成本的降低等，此外社区有kata，kubevirt这样的项目，通过kubernetes来启动VM。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711913675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389005,"user_name":"shark","can_delete":false,"product_type":"c1","uid":1229873,"ip_address":"北京","ucode":"485C22926374B6","user_header":"https://static001.geekbang.org/account/avatar/00/12/c4/31/f92091d1.jpg","comment_is_top":false,"comment_ctime":1711365479,"is_pvip":false,"replies":[{"id":141575,"content":"Hi，Shark同学\n\n我们会在模块一中讲解如何设计多云架构，这里包括了不同云混合，云与本地机房混合的场景。敬请期待。","user_name":"作者回复","user_name_real":"编辑","uid":1043450,"ctime":1711475587,"ip_address":"上海","comment_id":389005,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100758001,"comment_content":"请问这里面有讲到混合云的应用解决方案吗？比如应用在公有云上，数据在私有云上","like_count":0,"discussions":[{"author":{"id":1043450,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/eb/fa/5dc2bcae.jpg","nickname":"潘野","note":"","ucode":"5B60CCA6C00359","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":640431,"discussion_content":"Hi，Shark同学\n\n我们会在模块一中讲解如何设计多云架构，这里包括了不同云混合，云与本地机房混合的场景。敬请期待。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1711475587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":389050,"user_name":"请务必优秀","can_delete":false,"product_type":"c1","uid":2025816,"ip_address":"中国台湾","ucode":"2B7AE4EF41C972","user_header":"https://static001.geekbang.org/account/avatar/00/1e/e9/58/7bb2c561.jpg","comment_is_top":false,"comment_ctime":1711446068,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100758001,"comment_content":"老师会不会有一些大规模k8s集群调优以及排障的一些经验分享","like_count":1},{"had_liked":false,"id":388999,"user_name":"夜空中最亮的星","can_delete":false,"product_type":"c1","uid":1267566,"ip_address":"北京","ucode":"ADC3E7B6789955","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/6e/b6795c44.jpg","comment_is_top":false,"comment_ctime":1711358766,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100758001,"comment_content":"我一定跟住课程的思路，两个月后，掌握构建一套可复用的基础设施管理系统的能力，成为一名合格的云原生架构师或 SRE 工程师。","like_count":1},{"had_liked":false,"id":389010,"user_name":"kaizen","can_delete":false,"product_type":"c1","uid":1675966,"ip_address":"北京","ucode":"313EEA97AEC7C3","user_header":"https://static001.geekbang.org/account/avatar/00/19/92/be/8de4e1fe.jpg","comment_is_top":false,"comment_ctime":1711370082,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100758001,"comment_content":"要是能直接放出来所有的就好了","like_count":0}]}