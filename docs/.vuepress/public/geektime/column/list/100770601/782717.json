{"id":782717,"title":"05｜大模型微调：如何基于ChatGLM3-6B+Lora构建基本法律常识大模型？","content":"<p>你好，我是独行。</p><p>上节课我们本地化部署了ChatGLM3-6B，对于大模型有了进一步的了解。这节课我会从实际需求出发，完整地讲解一个AI大模型需求，从提出到完整落地的过程，学完这节课的内容，你也可以在自己所在的企业进行AI大模型落地实践了。</p><p>目前我们接触的无论是千亿大模型，如130B、ChatGPT，还是小规模的大模型，如6B、LLaMA2，都是通用大模型，就是说通过通用常识进行预训练的，如果我们在实际使用过程中，需要大模型具备某一特定领域知识的能力，我们就需要对大模型进行能力增强，具体如何做呢？</p><h2>如何增强模型能力？</h2><p>微调是其中的一个方法，当然还有其他方式，比如外挂知识库或者通过Agent调用其他API数据源，下面我们详细介绍下这几种方式的区别。</p><ul>\n<li><strong>微调</strong>是一种让预先训练好的模型适应特定任务或数据集的方案，成本相对较低，这种情况下，模型会学习训练者提供的微调数据，并且具备一定的理解能力。</li>\n<li><strong>知识库</strong>使用向量数据库或者其他数据库存储数据，为大语言模型提供信息来源外挂。</li>\n<li><strong>API</strong> 和知识库类似，为大语言模型提供信息来源外挂。</li>\n</ul><p>简单理解，微调相当于让大模型去学习一门新的学科，在回答的时候进行闭卷考试，知识库和API相当于为大模型提供了新学科的课本，回答的时候进行开卷考试。几种模式并不冲突，我们可以同时使用几种方案来优化模型，提升内容输出能力，下面我简单介绍下几种模式的优缺点。</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/a5/30/a546b8a06d21a5c539db005018f10230.jpg?wh=1962x1194\" alt=\"图片\"></p><p>注意，大模型领域所谓的性能，英文原词是Performance，指推理效果，并非我们软件开发里所说的接口性能，比如响应时间、吞吐量等。</p><p>了解这几种模型的区别，有助于我们进行技术方案选型。在大模型实际落地过程中，我们需要先分析需求，然后确定落地方式。</p><ol>\n<li>微调：准备数据、微调、验证、提供服务。</li>\n<li>知识库：准备数据、构建向量库、构建智能体、提供服务。</li>\n<li>API：准备数据、开发接口、构建智能体、提供服务。</li>\n</ol><p>接下来我会通过一个真实的案例，把整个过程串起来。</p><h2>企业真实案例</h2><p>在ChatGPT火爆以后，很多公司都在想办法将AI大模型引入日常工作中，一方面嵌入到产品中，提升产品的竞争力；一方面引入到企业内部，提升员工工作效率。就拿企业内部助手来说，它有很多使用场景，比如文案生成、PPT写作、生活常识等等。这里我们举一个法律小助手的例子。一般来说，当我们确定场景后，首先进行的就是需求分析，因为有些场景不一定是AI场景，有些是AI场景，但是可能可以通过小模型解决，所以我们在实际需求落地的过程中，一定要先进行完整的需求分析。</p><h4>需求分析</h4><p>法律小助手用来帮助员工解决日常生活中遇到的法律问题，以问答的方式进行，这种场景可以使用知识库模式，也可以使用微调模式。使用知识库模式的话，需要将数据集拆分成一条一条的知识，先放到向量库，然后通过Agent从向量库检索，再输入给大模型，这种方式的好处是万一我们发现数据集不足，可以随时补充，即时生效。</p><p>还有一种方式就是进行微调，因为法律知识有的时候需要一定的逻辑能力，不是纯文本检索，而微调就是这样的，通过在一定量的数据集上的训练，增加大模型法律相关的常识及思维，从而进行推理。经过分析，我们确定下来，使用微调的方式进行。接下来就是准备数据了。</p><h4>准备数据</h4><p>准备数据有很多种，可以从公共数据集下载，然后进行调整并加入私有化的知识，也可以完全自己整理，为了便于展示，我从GitHub上面找了一个<a href=\"https://github.com/SophonPlus/ChineseNlpCorpus/blob/master/datasets/lawzhidao/intro.ipynb\">公开的数据集</a>，下载下来的是一个CSV格式的文件。官方给的微调数据格式如下：</p><pre><code class=\"language-python\">{\"conversations\": [{\"role\": \"user\", \"content\": \"类型#裙*裙长#半身裙\"}, {\"role\": \"assistant\", \"content\": \"这款百搭时尚的仙女半身裙，整体设计非常的飘逸随性，穿上之后每个女孩子都能瞬间变成小仙女啦。料子非常的轻盈，透气性也很好，穿到夏天也很舒适。\"}]}\n</code></pre><p>现在我们需要把CSV里的内容，转成官方要求的格式。转化代码我直接让ChatGPT帮我生成，用了如下提示：</p><pre><code class=\"language-python\">原始数据是CSV格式，包含4列：title、question、reply、is_best，需要通过Python语言处理该CSV文件，来构建大语言模型的微调数据集，目标数据集格式是JSON的，单条数据格式为：{\"conversations\":[{\"role\":\"user\",\"content\":\"value1\"},{\"role\":\"assistant\",\"content\":\"value2\"}]}，需要将原始CSV文件里的title列填充到目标JSON文件里的value1处，原始CSV文件里的reply填充到目标JSON文件里的value1处，请注意：最终生成的不是JSON数组，而是每个JSON对象生成一行，出示示例代码。\n</code></pre><p>ChatGPT生成的Python代码：</p><pre><code class=\"language-python\">import csv\nimport json\n\n# CSV文件的路径\ncsv_file_path = 'your_csv_file.csv'\n# 输出JSON文件的路径\njson_file_path = 'output_json_file.json'\n\n# 打开CSV文件，并进行处理\nwith open(csv_file_path, mode='r', encoding='utf-8') as csv_file, \\\n&nbsp; &nbsp; &nbsp;open(json_file_path, mode='w', encoding='utf-8') as json_file:\n&nbsp; &nbsp;&nbsp;\n&nbsp; &nbsp; csv_reader = csv.DictReader(csv_file)\n&nbsp; &nbsp; for row in csv_reader:\n&nbsp; &nbsp; &nbsp; &nbsp; # 根据CSV文件的列名获取数据\n&nbsp; &nbsp; &nbsp; &nbsp; title = row['title']\n&nbsp; &nbsp; &nbsp; &nbsp; reply = row['reply']\n&nbsp; &nbsp; &nbsp; &nbsp; # 构造单条对话的JSON结构\n&nbsp; &nbsp; &nbsp; &nbsp; conversation_entry = {\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \"conversations\": [\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {\"role\": \"user\", \"content\": title},\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {\"role\": \"assistant\", \"content\": reply}\n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ]\n&nbsp; &nbsp; &nbsp; &nbsp; }\n&nbsp; &nbsp; &nbsp; &nbsp; # 将单条记录以JSON格式写入文件，每条记录一行\n&nbsp; &nbsp; &nbsp; &nbsp; json_line = json.dumps(conversation_entry, ensure_ascii=False)\n&nbsp; &nbsp; &nbsp; &nbsp; json_file.write(json_line + '\\n')\n\n</code></pre><p>通过上面的代码，我们就可以成功将下载下来的CSV格式的数据集，格式化成微调所需的数据集。接下来就可以准备微调了。</p><h4>微调</h4><ol>\n<li><strong>安装依赖</strong></li>\n</ol><p>我们先进入到finetune_demo文件夹。执行 <code>pip3 install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple</code>，过程中报了一个错。</p><p><img src=\"https://static001.geekbang.org/resource/image/32/06/329d37d53d4894b70461yy7d4ac1b306.png?wh=1081x276\" alt=\"图片\"></p><p>原因是缺少libopenmpi-dev库，所以我们需要安装这个库。</p><pre><code class=\"language-shell\">sudo apt update\nsudo apt-get install libopenmpi-dev\n</code></pre><p>紧接着安装nltk库。</p><pre><code class=\"language-shell\">pip3 install nltk\n</code></pre><p>到这里，依赖包基本就安装完了。你在操作的过程中，如果遇到其他库的缺失，有可能是操作系统库也有可能是Python库，按照提示完成安装即可。</p><ol start=\"2\">\n<li><strong>准备数据</strong></li>\n</ol><p>训练需要至少准备两个数据集，一个用来训练，一个用来验证。我们把“准备数据”环节格式化好的文件命名为train.json，再准备一个相同格式的测试数据集dev.json，在里面添加一些测试数据，几十条即可，当大模型在训练的过程中，会自动进行测试验证，输出微调效果。然后在finetune_demo文件夹下建立一个data文件夹，将这两个文件放入data文件夹中。</p><ol start=\"3\">\n<li><strong>修改配置</strong></li>\n</ol><p>修改finetune_demo/configs下的lora.yaml文件，将train_file、val_file、test_file、output_dir定义好，记得写全路径，其他参数也可以按需修改，比如：</p><ul>\n<li>max_steps：最大训练轮数，我们填3000。</li>\n<li>save_steps：每训练多少轮保存权重，填500。</li>\n</ul><p>其他参数可以参考下面这张表格。</p><p><img src=\"https://static001.geekbang.org/resource/image/63/f9/63451445dff2f2c943225059382558f9.jpg?wh=1900x2267\" alt=\"图片\"></p><ol start=\"4\">\n<li><strong>开始微调</strong></li>\n</ol><p>如果数据量比较少的话，比如少于50行，注意这一行，会报数组越界，修改小一点即可。</p><pre><code class=\"language-plain\">eval_dataset=val_dataset.select(list(range(50))),\n</code></pre><p>微调脚本用的是finetune_hf.py。</p><ol>\n<li>第一个参数是训练数据集所在目录，此处值是 data。</li>\n<li>第二个参数是模型所在目录，此处值是 ./model。</li>\n<li>第三个参数是微调配置，此处值是 configs/lora.yaml。</li>\n</ol><p>执行微调命令，记得Python命令使用全路径。</p><pre><code class=\"language-shell\">/usr/bin/python3 finetune_hf.py data ../model configs/lora.yaml\n</code></pre><p>如果控制台输出下面这些内容，则说明微调开始了。</p><p><img src=\"https://static001.geekbang.org/resource/image/23/5c/231d74c263160fe4105db1887cbc6a5c.png?wh=1904x664\" alt=\"图片\"></p><p>trainable params指的是在模型训练过程中可以被优化或更新的参数数量。在深度学习模型中，这些参数通常是网络的权重和偏置。它们是可训练的，因为在训练过程中，通过反向传播算法这些参数会根据损失函数的梯度不断更新，以减小模型输出与真实标签之间的差异。通过调整lora.yaml配置文件里peft_config下面的参数 r 来改变可训练参数的数量，r值越大，trainable params越大。</p><p>我们这次微调trainable params为1.9M（190万），整个参数量是6B（62亿），训练比为3%。</p><p><img src=\"https://static001.geekbang.org/resource/image/b8/1e/b8147dbb3bedce449228d6c0cf87221e.png?wh=1403x784\" alt=\"图片\"></p><p>这里有几个参数我来简单讲解下。</p><ul>\n<li>loss：损失函数衡量模型预测的输出与实际数据之间的差异或误差。在训练过程中，目标是最小化这个损失值，从而提高模型的准确性。</li>\n<li>grad_norm（梯度范数）：在训练深度学习模型时，通过反向传播算法计算参数（如权重）的梯度，以便更新这些参数。梯度范数是这些梯度向量的大小或长度，它提供了关于参数更新幅度的信息。如果梯度范数非常大，可能表示模型在训练过程中遇到了梯度爆炸问题；如果梯度范数太小，可能表示存在梯度消失问题。</li>\n<li>learning_rate（学习率）：学习率是一个控制参数更新幅度的超参数。在优化算法中，学习率决定了在反向传播期间参数更新的步长大小。太高的学习率可能导致训练过程不稳定，而太低的学习率可能导致训练进展缓慢或陷入局部最小值。</li>\n<li>epoch（周期）：一个 epoch 指的是训练算法在整个训练数据集上的一次完整遍历。通常需要多个 epochs 来训练模型，以确保模型能够充分学习数据集中的模式。每个 epoch 后，通常会评估模型在验证集上的表现，以监控和调整训练过程。</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/4b/e0/4b25347e2799cdc7f9e9e649ddd05ce0.png?wh=1911x336\" alt=\"图片\"></p><h4>验证</h4><p>等待微调结束，就可以进行验证了，官方demo提供了验证脚本，执行如下命令：</p><pre><code class=\"language-shell\">/usr/bin/python3 inference_hf.py output/checkpoint-3000/ --prompt \"xxxxxxxxxxxx\"\n</code></pre><p>output/checkpoint-3000是指新生成的权重，模型启动的时候会将原模型和新权重全部加载，然后进行推理。–prompt是输入的提示。</p><p>下面是一组微调前后的对比问答，我们对比着来看一下。</p><p>【微调前】</p><p><strong>User</strong>：不交房电费多出由谁承担？法律法规第几条<br>\n<strong>ChatGLM</strong>：这个问题先要明确是哪一种房屋。如果是商业用房，交房后产生的费用一般是由开发商来处理的；如果是住宅用电，那么就属于个人日常用水产生的费用了。如果是因为开发商的过错造成，可以要求开发商进行赔偿，反之也是一样。建议查阅合同以及相关法律条文，也可以向当地的水管公司或者开发商进行咨询。</p><p>【微调后】</p><p><strong>User</strong>：不交房电费多出由谁承担？法律法规第几条？<br>\n<strong>ChatGLM</strong>：协商解决，协商不成可诉讼。</p><p>我们的微调数据集中有下面这条内容：</p><pre><code class=\"language-shell\">{\"conversations\": [{\"role\": \"user\", \"content\": \"不交房电费多出由谁承担？法律法规第几条？\"}, {\"role\": \"assistant\", \"content\": \"按照约定处理，协商不成可以委托律师处理。\"}]}\n</code></pre><p>部分回答效果是比较明显的。</p><p>当然，这里只是通过快速搭建一个demo向你展示Lora微调的细节。实际生产过程中，需要考虑的事情比较多，比如训练轮数、并行数、微调效果比对等一系列问题，需要我们根据实际情况进行调整。</p><h4>提供服务</h4><p>当微调完成，我们验证后得知整体效果满足一定的百分比，那我们就认为这个微调是有效的，可以对外服务，接下来就可以通过API组件将模型的输入输出封装成接口对外提供服务了。实际生产环境中，我们还需要考虑几件事情：</p><ol>\n<li>模型的推理性能（效果）；</li>\n<li>模型的推理吞吐量；</li>\n<li>服务的限流，适当保护大模型集群；</li>\n<li>服务降级，当大模型服务不可用的时候，可以考虑通过修改开关，将AI小助手隐藏暂停使用。</li>\n</ol><p>具体架构思路，后面第四章我会进行专门的讲解，到那时我们再详细学习具体内容。</p><h2>小结</h2><p><img src=\"https://static001.geekbang.org/resource/image/00/50/005965672a948dff6ef733f2yye05650.png?wh=1584x1372\" alt=\"图片\"></p><p>这节课我们通过一个微调案例，来学习一下真正企业在布局AI大模型过程中，到底该怎么做，怎么进行大模型私有化的落地。</p><p>其中模型能力增强有几个重要的策略：<strong>微调、外挂知识库和 API 调用</strong>等。每种方法并不是唯一的，在实际生产环境中，我们可以采用多个方法来增强模型的推理能力。</p><p>为了让你熟悉大模型微调整个操作流程，我通过一个法律小助手的案例，展示了<strong>需求分析、数据准备、微调训练、模型验证到提供服务</strong>的每一步操作，以及在实际操作中可能遇到的问题和解决方案。在这个过程中你还可以通过微调前后的问答对比，看到模型微调后的效果。</p><p>相信学完这节课的内容，你对大模型微调有了一定的了解，不过前面我们也提到了增强模型能力的方法除了微调之外还有很多，下节课我们就来看看怎么用知识库，来增强大模型信息检索的能力。</p><h2>思考题</h2><p>在实际微调过程中我们发现微调不是轮数越多越好，有时轮数低产生的权重会比轮数高产生的权重效果更好，你可以想想这是为什么？欢迎你把你的想法分享在评论区，我们一起交流讨论，如果你觉得这节课的内容对你有帮助的话，也欢迎你分享给其他朋友，我们下节课再见！</p><p><a href=\"https://jinshuju.net/f/D8y8pw\">戳此加入课程交流群</a></p>","neighbors":{"left":{"article_title":"04｜本地部署：如何本地化部署开源大模型ChatGLM3-6B？","id":781435},"right":{"article_title":"06｜RAG实战：基于ChatGLM3-6B+LangChain+Faiss搭建企业内部知识库","id":782736}},"comments":[{"had_liked":false,"id":391524,"user_name":"张申傲","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"北京","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1718423918,"is_pvip":false,"replies":[{"id":142376,"content":"没错，模型性能取决于泛化能力，也就是说，我们希望模型能学习到训练数据中的规律，而不是“记住”某些特定的知识","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1718544616,"ip_address":"浙江","comment_id":391524,"utype":1}],"discussion_count":1,"race_medal":2,"score":2,"product_id":100770601,"comment_content":"第5讲打卡~\n思考题：微调效果应该也和数据量关系很大吧？如果在小数据量下，训练的轮数过多，是不是会降低大模型的泛化能力？就类似人的学习过程，如果把一本没有营养的书反复看了很多遍，反而容易形成思维定式，降低抽象能力。","like_count":16,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646677,"discussion_content":"没错，模型性能取决于泛化能力，也就是说，我们希望模型能学习到训练数据中的规律，而不是“记住”某些特定的知识","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1718544617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391498,"user_name":"冰冻柠檬","can_delete":false,"product_type":"c1","uid":1585858,"ip_address":"安徽","ucode":"DA940109725AE5","user_header":"https://static001.geekbang.org/account/avatar/00/18/32/c2/ffa6c819.jpg","comment_is_top":false,"comment_ctime":1718346953,"is_pvip":false,"replies":[{"id":142370,"content":"有一定的道理，同时还要看训练数据量","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1718415270,"ip_address":"浙江","comment_id":391498,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"轮数过多就过拟合了啊，泛化能力自然不会好。","like_count":3,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646647,"discussion_content":"有一定的道理，同时还要看训练数据量","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718415270,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392052,"user_name":"Geek_frank","can_delete":false,"product_type":"c1","uid":1685433,"ip_address":"上海","ucode":"534D46C2D1EFF5","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erG6I79WlHDjs51JOff9GBibD4Fh2PhITQMvmh2aTUVzH2BKia1tFLLoQr7VFeZddywwRoZlVUyhDDQ/132","comment_is_top":false,"comment_ctime":1719831104,"is_pvip":false,"replies":[{"id":142529,"content":"一般来说，最简单的是观察损失，损失越小说明泛化能力越强；其次，模型训练完可以进行评估，在一些通用数据集上进行评估，来检测模型的性能。这块后面的课程中有讲。","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1719973459,"ip_address":"浙江","comment_id":392052,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"打卡第五课。微调轮数过高不利于提升模型的泛化能力。但这个感觉也不好把控。所以有什么最佳实践之类的吗。比如先把参数调小一点。然后经过多次微调调整参数来使模型推理达满意的准确度","like_count":2,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647383,"discussion_content":"一般来说，最简单的是观察损失，损失越小说明泛化能力越强；其次，模型训练完可以进行评估，在一些通用数据集上进行评估，来检测模型的性能。这块后面的课程中有讲。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719973459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3199773,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/EC0Xp12qA9thF8IIeVu6lJFttDxrocOe40HYSSFjzLJnEacGlBs0kTanvPfchOj3t2RR29gBnBWjGAvMH3JH7w/132","nickname":"Geek_f7b82c","note":"","ucode":"FF2C8610B7BDDB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649168,"discussion_content":"后面哪一课讲了评估呀，没有找到","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1722923396,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391736,"user_name":"jsw","can_delete":false,"product_type":"c1","uid":1254723,"ip_address":"广西","ucode":"E3B978CDAAA19F","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/43/ab300d7c.jpg","comment_is_top":false,"comment_ctime":1718961007,"is_pvip":false,"replies":[{"id":142445,"content":"哈哈，跑通就不错了，微调效果需要花一定的精力研究和尝试，数据量要够，还有训练轮数等等","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1718969163,"ip_address":"浙江","comment_id":391736,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"微调可以了，调整了一些参数，原理的没有按老是的修改。但是感觉微调后的效果很差。","like_count":2,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646908,"discussion_content":"哈哈，跑通就不错了，微调效果需要花一定的精力研究和尝试，数据量要够，还有训练轮数等等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718969164,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391723,"user_name":"jsw","can_delete":false,"product_type":"c1","uid":1254723,"ip_address":"广西","ucode":"E3B978CDAAA19F","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/43/ab300d7c.jpg","comment_is_top":false,"comment_ctime":1718936460,"is_pvip":false,"replies":[{"id":142434,"content":"就是value1，value1是问题，value2是答案","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1718964536,"ip_address":"浙江","comment_id":391723,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"原始数据是CSV格式，包含4列：title、question、reply、is_best，需要通过Python语言处理该CSV文件，来构建大语言模型的微调数据集，目标数据集格式是JSON的，单条数据格式为：{&quot;conversations&quot;:[{&quot;role&quot;:&quot;user&quot;,&quot;content&quot;:&quot;value1&quot;},{&quot;role&quot;:&quot;assistant&quot;,&quot;content&quot;:&quot;value2&quot;}]}，需要将原始CSV文件里的title列填充到目标JSON文件里的value1处，原始CSV文件里的reply填充到目标JSON文件里的value1处，请注意：最终生成的不是JSON数组，而是每个JSON对象生成一行，出示示例代码。\n-----\n原始CSV文件里的reply填充到目标JSON文件里的value1处，这里应该是“value2”才对吧。","like_count":1,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646895,"discussion_content":"就是value1，value1是问题，value2是答案","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718964536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391682,"user_name":"阿斯蒂芬","can_delete":false,"product_type":"c1","uid":1024164,"ip_address":"广东","ucode":"61D5E3BDA4EBC5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/a4/b060c723.jpg","comment_is_top":false,"comment_ctime":1718810000,"is_pvip":false,"replies":[{"id":142439,"content":"是的，知识库检索解决不了推理问题","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1718964883,"ip_address":"浙江","comment_id":391682,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"需要业务逻辑特别是一定业务推理能力的时候，微调应该是比纯知识向量检索更合适的。大模型时代，“面向微调”在一定程度上让非资深算法人员也有了“训练模型”的可能😁","like_count":1,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646900,"discussion_content":"是的，知识库检索解决不了推理问题","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1718964883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":1,"child_discussions":[{"author":{"id":1195258,"avatar":"https://static001.geekbang.org/account/avatar/00/12/3c/fa/e2990931.jpg","nickname":"文敦复","note":"","ucode":"B8F4A6BD5D7805","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":647150,"discussion_content":"这话，重要。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719557567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":646900,"ip_address":"四川","group_id":0},"score":647150,"extra":""}]}]},{"had_liked":false,"id":395509,"user_name":"like life","can_delete":false,"product_type":"c1","uid":3017830,"ip_address":"湖南","ucode":"8D82CD400FC155","user_header":"https://static001.geekbang.org/account/avatar/00/2e/0c/66/51161385.jpg","comment_is_top":false,"comment_ctime":1731026632,"is_pvip":false,"replies":[{"id":143654,"content":"有可能的","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1731470751,"ip_address":"浙江","comment_id":395509,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"“学习率是一个控制参数更新幅度的超参数。在优化算法中，学习率决定了在反向传播期间参数更新的步长大小。太高的学习率可能导致训练过程不稳定，而太低的学习率可能导致训练进展缓慢或陷入局部最小值”，训练轮数太多，学习率是不是可能会更高导致训练过程不稳定呢?","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":653819,"discussion_content":"有可能的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1731470752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":394133,"user_name":"艾尔·马格尼弗科","can_delete":false,"product_type":"c1","uid":3903554,"ip_address":"天津","ucode":"3E8FD8FC78111B","user_header":"https://static001.geekbang.org/account/avatar/00/3b/90/42/8e5e7b36.jpg","comment_is_top":false,"comment_ctime":1725909212,"is_pvip":false,"replies":[{"id":143183,"content":"debug一下看看","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1726813044,"ip_address":"浙江","comment_id":394133,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"  File &quot;&#47;home&#47;naiqi&#47;.cache&#47;huggingface&#47;modules&#47;transformers_modules&#47;model&#47;modeling_chatglm.py&quot;, line 685, in get_masks\n    past_length = past_key_values[0][0].shape[0]\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: &#39;str&#39; object has no attribute &#39;shape&#39;\n老师，这种情况该怎么办呢","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":651390,"discussion_content":"debug一下看看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1726813044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393529,"user_name":"吧啦啦能量","can_delete":false,"product_type":"c1","uid":2279201,"ip_address":"河南","ucode":"C32D74FE8FC28D","user_header":"https://static001.geekbang.org/account/avatar/00/22/c7/21/2ae0f713.jpg","comment_is_top":false,"comment_ctime":1724131318,"is_pvip":false,"replies":[{"id":142942,"content":"尝试减小下批次","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1724424924,"ip_address":"浙江","comment_id":393529,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100770601,"comment_content":"老师，这种情况该怎么办呢OutOfMemoryError: CUDA out of memory. Tried to allocate 214.00 MiB. GPU","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":650144,"discussion_content":"尝试减小下批次","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724424924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393068,"user_name":"石云升","can_delete":false,"product_type":"c1","uid":1024195,"ip_address":"湖南","ucode":"78F1DD33EFD000","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a0/c3/c5db35df.jpg","comment_is_top":false,"comment_ctime":1722697115,"is_pvip":false,"replies":[{"id":142820,"content":"加油！","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1723198361,"ip_address":"浙江","comment_id":393068,"utype":1}],"discussion_count":1,"race_medal":1,"score":2,"product_id":100770601,"comment_content":"好课程，学到了。","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649358,"discussion_content":"加油！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723198361,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392297,"user_name":"夏龙飞","can_delete":false,"product_type":"c1","uid":3679252,"ip_address":"湖北","ucode":"B9981450CB1E90","user_header":"https://static001.geekbang.org/account/avatar/00/38/24/14/4b9add72.jpg","comment_is_top":false,"comment_ctime":1720516354,"is_pvip":false,"replies":[{"id":142593,"content":"详细看一下课程中的表格，有说明的，train_file、val_file、test_file分别取什么。","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1720604506,"ip_address":"浙江","comment_id":392297,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"准备数据的时候只有train.json和dev.json，但是后边的config中train_file、val_file、test_file有三个，这个怎么设置？","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647783,"discussion_content":"详细看一下课程中的表格，有说明的，train_file、val_file、test_file分别取什么。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1720604506,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":392051,"user_name":"Standly","can_delete":false,"product_type":"c1","uid":1181055,"ip_address":"江苏","ucode":"805CC5784D3F76","user_header":"https://static001.geekbang.org/account/avatar/00/12/05/7f/a7df049a.jpg","comment_is_top":false,"comment_ctime":1719826264,"is_pvip":false,"replies":[{"id":142528,"content":"再往后学习，有详细讲解","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1719973356,"ip_address":"浙江","comment_id":392051,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"文章里多次提到的“反向传播”是什么意思？","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":647382,"discussion_content":"再往后学习，有详细讲解","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1719973356,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391730,"user_name":"jsw","can_delete":false,"product_type":"c1","uid":1254723,"ip_address":"广西","ucode":"E3B978CDAAA19F","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/43/ab300d7c.jpg","comment_is_top":false,"comment_ctime":1718949521,"is_pvip":false,"replies":[{"id":142432,"content":"可以发一下你的配置，主要取决与批次，调小一点试试","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1718960773,"ip_address":"浙江","comment_id":391730,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"微调老是报这个错误 OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB. GPU \nRTX 3090(24GB) 的配置应该够吧，有什么办法调低内存占用吗？","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646890,"discussion_content":"可以发一下你的配置，主要取决与批次，调小一点试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718960773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1008257,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/81/ad80f427.jpg","nickname":"Lane","note":"","ucode":"F70459D1BBD9F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649599,"discussion_content":"我把max_input和max_output改小后就可以了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723629279,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391598,"user_name":"徐石头","can_delete":false,"product_type":"c1","uid":1035885,"ip_address":"湖南","ucode":"D8FA8A64FB7E33","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ce/6d/530df0dd.jpg","comment_is_top":false,"comment_ctime":1718616847,"is_pvip":true,"replies":[{"id":142401,"content":"默认FP16情况下，启动运行大约占用13GB显存，微调看情况了，取决于配置，比如批次和半径（r）等","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1718691016,"ip_address":"浙江","comment_id":391598,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"默认情况下 chatglm3-6b 的微调需要 23G 左右的显存，而且启动运行只需要12G","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646760,"discussion_content":"默认FP16情况下，启动运行大约占用13GB显存，微调看情况了，取决于配置，比如批次和半径（r）等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718691017,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1035885,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/ce/6d/530df0dd.jpg","nickname":"徐石头","note":"","ucode":"D8FA8A64FB7E33","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646753,"discussion_content":"1. 16G显存做微调需要修改 batch_size 参数大小\n2. 报错‘NoneType’ object has no attribute ‘to’需要修改 transformers 源码增加 is None 判断\n3.  /usr/bin/python3 finetune_hf.py data ../model configs/lora.yaml yes，最后一个参数要加 yes，不然会报没有 save_checkpoint 错误","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1718682023,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"湖南","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391536,"user_name":"Geek_0ef63f","can_delete":false,"product_type":"c1","uid":1606687,"ip_address":"河北","ucode":"357DB0178E0EC2","user_header":"","comment_is_top":false,"comment_ctime":1718451393,"is_pvip":false,"replies":[{"id":142378,"content":"你好，你想看关于拟合的什么内容？","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1718544994,"ip_address":"浙江","comment_id":391536,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"没有讲拟合的内容啊","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646679,"discussion_content":"你好，你想看关于拟合的什么内容？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718544994,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391507,"user_name":"roman","can_delete":false,"product_type":"c1","uid":1017679,"ip_address":"江苏","ucode":"6E147F09D6EC32","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJZO3Xkicd9Cy8tAian8JnxqVianHNggKcMtdx6sKrQygxnCUKib3ERXIxiaFqkFyhPibkCGzpbdTOiaGvSA/132","comment_is_top":false,"comment_ctime":1718352003,"is_pvip":false,"replies":[{"id":142365,"content":"已经更新啦","user_name":"编辑回复","user_name_real":"编辑","uid":2843479,"ctime":1718387199,"ip_address":"北京","comment_id":391507,"utype":2}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"老师 好，我想确认一下 本文中的数据集是不是链接放错了，点开是一个电商广告文案生成数据集，我理解微调应该是需要准备法律相关的数据集吧","like_count":0,"discussions":[{"author":{"id":2843479,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/63/57/cba4c68b.jpg","nickname":"小虎子🐯","note":"","ucode":"4C9530B3FB407B","race_medal":0,"user_type":8,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646639,"discussion_content":"已经更新啦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718387199,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":8,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":391427,"user_name":"黄琼","can_delete":false,"product_type":"c1","uid":1264845,"ip_address":"中国香港","ucode":"D4451C2857202D","user_header":"https://static001.geekbang.org/account/avatar/00/13/4c/cd/6285a3f3.jpg","comment_is_top":false,"comment_ctime":1718246828,"is_pvip":false,"replies":[{"id":142355,"content":"你说的没错，所以微调要不断进行参数和轮数的调整，来看效果。finetune_demo在示例代码里，你从ChatGLM3官方github仓库里克隆下来的示例代码就有。","user_name":"作者回复","user_name_real":"编辑","uid":2083554,"ctime":1718264904,"ip_address":"浙江","comment_id":391427,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100770601,"comment_content":"微调轮数过多会产生过拟合，性能不一定更好。\n另：文中出现的finetune_demo 文件夹是自已新建的还是有示例代码提供参考？有些来的突然。","like_count":0,"discussions":[{"author":{"id":2083554,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erZP8e2vqiaACFaDxruOzUTPbPv2uRUTp9UuEg98Ib9aYddjZK2kastqf0B14Ec7uXx7CCSXr0fhAA/132","nickname":"Geek_cf2545","note":"","ucode":"B69DF1E734FBA2","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646591,"discussion_content":"你说的没错，所以微调要不断进行参数和轮数的调整，来看效果。finetune_demo在示例代码里，你从ChatGLM3官方github仓库里克隆下来的示例代码就有。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1718264904,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}