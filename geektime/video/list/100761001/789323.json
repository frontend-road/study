{"id":789323,"title":"31ï½œæ³›å‹å£°æ˜ ï¼ˆäºŒï¼‰ï¼šå‡½æ•°ä¸ç±»","content":"","comments":[{"had_liked":false,"id":396379,"user_name":"fatme","can_delete":false,"product_type":"c3","uid":1034451,"ip_address":"å¹¿ä¸œ","ucode":"75A805D2BB2AD1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c8/d3/3020ae46.jpg","comment_is_top":false,"comment_ctime":1734172252,"is_pvip":false,"replies":[{"id":143938,"content":"éå¸¸å‡†ç¡®ã€‚ä½ çš„å‡ ä¸ªæ³¨é‡Šç‚¹éƒ½è¯´åˆ°äº†å…³é”®å¤„ã€‚èµ+5","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1521669,"ctime":1734747998,"ip_address":"æ±Ÿè‹","comment_id":396379,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"&#47;&#47; SuperFoo æ˜¯ä¸€ä¸ªæ³›å‹å‡½æ•°ç±»å‹ï¼Œå®ƒå®ä¾‹åŒ–åçš„ç±»å‹æ˜¯ä¸€ä¸ªå¸¦æ³›å‹å‚æ•°çš„å‡½æ•°ç±»å‹ã€‚è¿™ä¸ªå®ä¾‹åŒ–åçš„æ³›å‹å‚æ•°å‡½æ•°ç±»å‹èƒ½å¤Ÿè¢«æ³›å‹å‡½æ•°èµ‹å€¼ã€‚\ntype SuperFoo&lt;T&gt; = &lt;X&gt;(x: T) =&gt; X;\n&#47;&#47; SuperFoo å¯ä»¥è¢«å®ä¾‹åŒ–ã€‚å®ä¾‹åŒ–åçš„ç±»å‹æ˜¯ä¸€ä¸ªå¸¦æ³›å‹å‚æ•°çš„å‡½æ•°ç±»å‹ã€‚\ntype SuperFoo_string = SuperFoo&lt;string&gt;;\nlet f: &lt;X&gt;(x: string) =&gt; X = &lt;X&gt;(x: string) =&gt; {return x as any as X;};\ntype T = typeof f;\ntype T2 = T extends SuperFoo_string ? SuperFoo_string extends T ? true : false : false; &#47;&#47; T2 = true\ntype T3 = &lt;X&gt;(x: string) =&gt; X;\ntype T4 = T3 extends SuperFoo_string ? SuperFoo_string extends T ? true : false : false; &#47;&#47; T4 = true\n&#47;&#47; SuperFoo_string é™åˆ¶å¯¹åº”çš„ javascript function å¿…é¡»å£°æ˜ä¸ºå¸¦æ³›å‹å‚æ•°çš„å‡½æ•°\nfunction Foo&lt;X&gt;(a: string): X {return a as any as X;}\nlet v4: SuperFoo_string = Foo;\nlet v5: SuperFoo_string = f;\n&#47;&#47; f çš„è°ƒç”¨æ–¹å¼ã€‚å…³é”®æ˜¯è¦ä¹ˆæ˜¾å¼å£°æ˜æ³›å‹å‚æ•°çš„ç±»å‹ï¼Œè¦ä¹ˆèƒ½ä»¤ç¼–è¯‘å™¨æ¨æ–­å‡ºå‡½æ•°è¿”å›ç»“æœçš„ç±»å‹ã€‚\nlet v = f&lt;string&gt;(&quot;a&quot;);\nlet v6: string = f(&quot;a&quot;);\n&#47;&#47; æ³¨æ„ä¸‹é¢ v2&#47;v3 çš„ä¸¤ä¸ªé”™è¯¯ï¼ŒSuperFoo_string é™åˆ¶å¯¹åº”çš„ javascript function å¿…é¡»å£°æ˜ä¸ºå¸¦æ³›å‹å‚æ•°çš„å‡½æ•°\nfunction foo(x: string): number {return 1;}\nlet v2: SuperFoo_string = foo;\nlet v3: SuperFoo_string = (a: string) =&gt; parseFloat(a);","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":655377,"discussion_content":"éå¸¸å‡†ç¡®ã€‚ä½ çš„å‡ ä¸ªæ³¨é‡Šç‚¹éƒ½è¯´åˆ°äº†å…³é”®å¤„ã€‚èµ+5","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1734747998,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393495,"user_name":"Jack Q","can_delete":false,"product_type":"c3","uid":1160078,"ip_address":"å¹¿ä¸œ","ucode":"A7DBC311884FFA","user_header":"https://static001.geekbang.org/account/avatar/00/11/b3/8e/1c564eb2.jpg","comment_is_top":false,"comment_ctime":1724046815,"is_pvip":false,"replies":[{"id":142892,"content":"é«˜åˆ†ç­”æ¡ˆã€‚æ¡ç†æ¸…æ™°ï¼Œå¯¹æ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½æŠŠæ¡å¾—å¾ˆåˆ°ä½ã€‚èµçš„ğŸ‘+5","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1521669,"ctime":1724061902,"ip_address":"æ±Ÿè‹","comment_id":393495,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"1ã€è§£é‡Šå¦‚ä¸‹å£°æ˜ï¼š\ntype SuperFoo&lt;T&gt; = &lt;X&gt;(t: T) =&gt; X\n\nSuperFoo æ˜¯ä¸€ä¸ªæ¥å—ç±»å‹å‚æ•°Tçš„èŒƒå‹å‡½æ•°ç±»å‹ã€‚å®ƒè¡¨ç¤ºä¸€ä¸ªæ¥å—ç±»å‹ä¸ºTçš„å‚æ•°å¹¶è¿”å›ä¸€ä¸ªç±»å‹ä¸ºXçš„å‡½æ•°ã€‚å…¶ä¸­Xæ˜¯åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰çš„æ³›å‹ç±»å‹ã€‚\n\nconst Foo: SuperFoo&lt;number&gt; = &lt;T extends any&gt;(x:number): T =&gt; { &#47;&#47;  T extends any æ˜¯ä¸ºäº†å…¼å®¹ æ”¯æŒ jsx çš„åœºæ™¯\n  return x as T;\n}\n\nconst v = Foo&lt;1&gt;(1);&#47;&#47; typeof v = 1\n2ã€é˜…è¯»ç†è§£è¯¾ä»¶ä¸­çš„ t3.ts\nfunction IsTransporter&lt;Target extends Transportations&gt;(t: any, target: Target): t is Transporters[Target] {\n    return &#39;type&#39; in t &amp;&amp; t.type === target;\n}\n\nfunction IsTransporter2&lt;Target extends Transportations&gt;(t: T, target: Target): t is Transporters[Target] {\n    return [T1, T2, T3].some(T =&gt; t instanceof T &amp;&amp; t.type === target);\n}\n\nfunction IsTransporter3&lt;Target extends new(...args: any[]) =&gt; any&gt;(t: T, target: Target): t is InstanceType&lt;Target&gt; {\n    return t instanceof target;\n}\nlet xx!: T;\n&#47;&#47; æ–¹å¼1\nswitch (true) {\n    case IsTransporter(xx, Transportations.motorcycle):\n        xx\n        break;\n    case IsTransporter(xx, Transportations.car):\n        xx\n        break;\n    case IsTransporter(xx, Transportations.truck):\n        xx\n        break;\n}\n&#47;&#47; æ–¹å¼2\nswitch (true) {\n    case IsTransporter3(xx, T1):\n        xx\n        break;\n    case IsTransporter3(xx, T2):\n        xx\n        break;\n    case IsTransporter3(xx, T3):\n        xx\n        break;\n}\n1ã€åˆ†æIsTransporterã€IsTransporter2ã€IsTransporte3çš„å®ç°\nIsTransporter é€šè¿‡ type in t è¿›è¡Œç±»å‹æ”¶æŸï¼Œç¡®è®¤typeå±æ€§å­˜åœ¨äº tï¼Œ ç„¶åé€šè¿‡ type è¿›è¡Œåˆ¤æ–­\nIsTransporter2 é€šè¿‡ instance ç¡®è®¤tæ˜¯å¦åŸºäº T æ¥ç¡®è®¤ t ä¸Šæ˜¯å¦å­˜åœ¨ type å±æ€§ï¼Œ ç„¶åé€šè¿‡ type è¿›è¡Œåˆ¤æ–­ã€‚ç›¸è¾ƒäº IsTransporterï¼Œ instance å¾—åˆ°çš„ç»“æœæ›´åŠ å®‰å…¨\nIsTransporte3 åˆ™æ˜¯ç›´æ¥åˆ¤æ–­ t å’Œ target æ˜¯å¦ æ˜¯åŸºäºç›¸åŒçš„æ„é€  å‡½æ•°\n2ã€ç†è§£ IsTransporte3çš„è®¾è®¡ä¸ä½¿ç”¨\nå…¶ä¸­ IsTransporter å’Œ IsTransporter2 éƒ½å¯ä»¥ä½¿ç”¨ æ–¹å¼1 è¿›è¡Œæ–­è¨€\nå…¶ä¸­ IsTransporte3 éœ€è¦ ä½¿ç”¨ æ–¹å¼2 è¿›è¡Œæ–­è¨€\né€šè¿‡å¯¹æ¯”æ–­è¨€å‡½æ•°çš„è°ƒç”¨æ–¹å¼ä»¥åŠå‚æ•°ç±»å‹ï¼ŒIsTransporte3 æ˜¯åŸºäºæ„é€ å‡½æ•°è¿›è¡Œåˆ¤æ–­çš„ï¼ŒIsTransporterå’ŒIsTransporter2åˆ™æ˜¯åŸºäºæ ‡è¯†å‹å±æ€§åˆ¤æ–­çš„","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649858,"discussion_content":"é«˜åˆ†ç­”æ¡ˆã€‚æ¡ç†æ¸…æ™°ï¼Œå¯¹æ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½æŠŠæ¡å¾—å¾ˆåˆ°ä½ã€‚èµçš„ğŸ‘+5","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1724061902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393255,"user_name":"Geek_aeb936","can_delete":false,"product_type":"c3","uid":3887128,"ip_address":"æ—¥æœ¬","ucode":"863338D4895F25","user_header":"","comment_is_top":false,"comment_ctime":1723288086,"is_pvip":false,"replies":[{"id":142829,"content":"è°¢è°¢æé†’ï¼Œå·²è¿½åŠ ã€‚:)","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1521669,"ctime":1723386726,"ip_address":"æ±Ÿè‹","comment_id":393255,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"https:&#47;&#47;github.com&#47;aimingoo&#47;jike2&#47;tree&#47;main&#47;src&#47;31\n\næˆ‘çœ‹å¥½åƒæ²¡æœ‰t3.tsæ–‡ä»¶(è¯¾åä½œä¸šï¼‰","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649445,"discussion_content":"è°¢è°¢æé†’ï¼Œå·²è¿½åŠ ã€‚:)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723386726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393254,"user_name":"Geek_aeb936","can_delete":false,"product_type":"c3","uid":3887128,"ip_address":"æ—¥æœ¬","ucode":"863338D4895F25","user_header":"","comment_is_top":false,"comment_ctime":1723287989,"is_pvip":false,"replies":[{"id":142830,"content":"+1 ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1521669,"ctime":1723387241,"ip_address":"æ±Ÿè‹","comment_id":393254,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"type SuperFoo&lt;T&gt; = &lt;X&gt;(x: T) =&gt; X;\n\nconst mySuperFoo: SuperFoo&lt;number&gt; = &lt;X&gt;(x: number): X =&gt; {\n    return (x as unknown) as X;\n};\n\nconst result = mySuperFoo&lt;string&gt;(42);\n\ntype ResultType = typeof result; &#47;&#47; type ResultType = string","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649446,"discussion_content":"+1 ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723387241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ±Ÿè‹","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}