{"id":11207,"title":"35 | 微服务架构最佳实践 - 方法篇","content":"<p>专栏上一期，我谈了实施微服务需要避免踩的陷阱，简单提炼为：</p><ul>\n<li>\n<p>微服务拆分过细，过分强调“small”。</p>\n</li>\n<li>\n<p>微服务基础设施不健全，忽略了“automated”。</p>\n</li>\n<li>\n<p>微服务并不轻量级，规模大了后，“lightweight”不再适应。</p>\n</li>\n</ul><p>针对这些问题，今天我们看看微服务最佳实践应该如何去做。我会分两期介绍这部分内容，今天是<span class=\"orange\">微服务架构最佳实践的方法篇</span>，下一期是基础设施篇。</p><h2>服务粒度</h2><p>针对微服务拆分过细导致的问题，我建议基于团队规模进行拆分，类似贝索斯在定义团队规模时提出的“两个披萨”理论（每个团队的人数不能多到两张披萨都不够吃的地步），分享一个我认为微服务拆分粒度的“三个火枪手”原则，即一个微服务三个人负责开发。当我们在实施微服务架构时，根据团队规模来划分微服务数量，如果业务规继续发展，团队规模扩大，我们再将已有的微服务进行拆分。例如，团队最初有6个人，那么可以划分为2个微服务，随着业务的发展，业务功能越来越多，逻辑越来越复杂，团队扩展到12个人，那么我们可以将已有的2个微服务进行拆分，变成4个微服务。</p><p>为什么是3个人，不是4个，也不是2个呢？</p><p>首先，从系统规模来讲，3个人负责开发一个系统，系统的复杂度刚好达到每个人都能全面理解整个系统，又能够进行分工的粒度；如果是2个人开发一个系统，系统的复杂度不够，开发人员可能觉得无法体现自己的技术实力；如果是4个甚至更多人开发一个系统，系统复杂度又会无法让开发人员对系统的细节都了解很深。</p><!-- [[[read_end]]] --><p>其次，从团队管理来说，3个人可以形成一个稳定的备份，即使1个人休假或者调配到其他系统，剩余2个人还可以支撑；如果是2个人，抽调1个后剩余的1个人压力很大；如果是1个人，这就是单点了，团队没有备份，某些情况下是很危险的，假如这个人休假了，系统出问题了怎么办？</p><p>最后，从技术提升的角度来讲，3个人的技术小组既能够形成有效的讨论，又能够快速达成一致意见；如果是2个人，可能会出现互相坚持自己的意见，或者2个人经验都不足导致设计缺陷；如果是1个人，由于没有人跟他进行技术讨论，很可能陷入思维盲区导致重大问题；如果是4个人或者更多，可能有的参与的人员并没有认真参与，只是完成任务而已。</p><p>“三个火枪手”的原则主要应用于微服务设计和开发阶段，如果微服务经过一段时间发展后已经比较稳定，处于维护期了，无须太多的开发，那么平均1个人维护1个微服务甚至几个微服务都可以。当然考虑到人员备份问题，每个微服务最好都安排2个人维护，每个人都可以维护多个微服务。</p><h2>拆分方法</h2><p>基于“三个火枪手”的理论，我们可以计算出拆分后合适的服务数量，但具体怎么拆也是有技巧的，并不是快刀斩乱麻随便拆分成指定数量的微服务就可以了，也不是只能按照业务来进行拆分，而是可以根据目的的不同灵活地选取不同的拆分方式。接下来我一一介绍常见的拆分方式。</p><p>1.基于业务逻辑拆分</p><p>这是最常见的一种拆分方式，将系统中的业务模块按照职责范围识别出来，每个单独的业务模块拆分为一个独立的服务。</p><p>基于业务逻辑拆分虽然看起来很直观，但在实践过程中最常见的一个问题就是团队成员对于“职责范围”的理解差异很大，经常会出现争论，难以达成一致意见。例如：假设我们做一个电商系统，第一种方式是将服务划分为“商品”“交易”“用户”3个服务，第二种方式是划分为“商品”“订单”“支付”“发货”“买家”“卖家”6个服务，哪种方式更合理，是不是划分越细越正确？</p><p>导致这种困惑的主要根因在于从业务的角度来拆分的话，规模粗和规模细都没有问题，因为拆分基础都是业务逻辑，要判断拆分粒度，不能从业务逻辑角度，而要根据前面介绍的“三个火枪手”的原则，计算一下大概的服务数量范围，然后再确定合适的“职责范围”，否则就可能出现划分过粗或者过细的情况，而且大部分情况下会出现过细的情况。</p><p>例如：如果团队规模是10个人支撑业务，按照“三个火枪手”规则计算，大约需要划分为4个服务，那么“登录、注册、用户信息管理”都可以划到“用户服务”职责范围内；如果团队规模是100人支撑业务，服务数量可以达到40个，那么“用户登录“就是一个服务了；如果团队规模达到1000人支撑业务，那“用户连接管理”可能就是一个独立的服务了。</p><p>2.基于可扩展拆分</p><p>将系统中的业务模块按照稳定性排序，将已经成熟和改动不大的服务拆分为<strong>稳定服务</strong>，将经常变化和迭代的服务拆分为<strong>变动服务</strong>。稳定的服务粒度可以粗一些，即使逻辑上没有强关联的服务，也可以放在同一个子系统中，例如将“日志服务”和“升级服务”放在同一个子系统中；不稳定的服务粒度可以细一些，但也不要太细，始终记住要控制服务的总数量。</p><p>这样拆分主要是为了提升项目快速迭代的效率，避免在开发的时候，不小心影响了已有的成熟功能导致线上问题。</p><p>3.基于可靠性拆分</p><p>将系统中的业务模块按照优先级排序，将可靠性要求高的核心服务和可靠性要求低的非核心服务拆分开来，然后重点保证核心服务的高可用。具体拆分的时候，核心服务可以是一个也可以是多个，只要最终的服务数量满足“三个火枪手”的原则就可以。</p><p>这样拆分带来下面几个好处：</p><ul>\n<li>避免非核心服务故障影响核心服务</li>\n</ul><p>例如，日志上报一般都属于非核心服务，但是在某些场景下可能有大量的日志上报，如果系统没有拆分，那么日志上报可能导致核心服务故障；拆分后即使日志上报有问题，也不会影响核心服务。</p><ul>\n<li>核心服务高可用方案可以更简单</li>\n</ul><p>核心服务的功能逻辑更加简单，存储的数据可能更少，用到的组件也会更少，设计高可用方案大部分情况下要比不拆分简单很多。</p><ul>\n<li>能够降低高可用成本</li>\n</ul><p>将核心服务拆分出来后，核心服务占用的机器、带宽等资源比不拆分要少很多。因此，只针对核心服务做高可用方案，机器、带宽等成本比不拆分要节省较多。</p><p>4.基于性能拆分</p><p>基于性能拆分和基于可靠性拆分类似，将性能要求高或者性能压力大的模块拆分出来，避免性能压力大的服务影响其他服务。常见的拆分方式和具体的性能瓶颈有关，可以拆分Web服务、数据库、缓存等。例如电商的抢购，性能压力最大的是入口的排队功能，可以将排队功能独立为一个服务。</p><p>以上几种拆分方式不是多选一，而是可以根据实际情况自由排列组合，例如可以基于可靠性拆分出服务A，基于性能拆分出服务B，基于可扩展拆分出C/D/F三个服务，加上原有的服务X，最后总共拆分出6个服务（A/B/C/D/F/X）。</p><h2>基础设施</h2><p>大部分人主要关注的是微服务的“small”和“lightweight”特性，但实际上真正决定微服务成败的，恰恰是那个被大部分人都忽略的“automated”。为何这样说呢？因为服务粒度即使划分不合理，实际落地后如果团队遇到麻烦，自然会想到拆服务或者合服务；如果“automated”相关的基础设施不健全，那微服务就是焦油坑，让研发、测试、运维陷入我上一期讲的各种微服务陷阱中。</p><p>微服务基础设施如下图所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/3b/0e/3b4eda0b9786987879a996da1360330e.jpg?wh=1256*1022\" alt=\"\"></p><p>看到上面这张图，相信很多人都会倒吸一口凉气，说好的微服务的“轻量级”呢？都这么多基础设施还好意思说自己是“轻量级”，感觉比ESB还要复杂啊？</p><p>确实如此，微服务并不是很多人认为的那样又简单又轻量级。要做好微服务，这些基础设施都是必不可少的，否则微服务就会变成一个焦油坑，让业务和团队在里面不断挣扎且无法自拔。因此也可以说，微服务并没有减少复杂度，而只是将复杂度从ESB转移到了基础设施。你可以看到，“服务发现”“服务路由”等其实都是ESB的功能，只是在微服务中剥离出来成了独立的基础系统。</p><p>虽然建设完善的微服务基础设施是一项庞大的工程，但也不用太过灰心，认为自己团队小或者公司规模不大就不能实施微服务了。第一个原因是已经有开源的微服务基础设施全家桶了，例如大名鼎鼎的Spring Cloud项目，涵盖了服务发现、服务路由、网关、配置中心等功能；第二个原因是如果微服务的数量并不是很多的话，并不是每个基础设施都是必须的。通常情况下，我建议按照下面优先级来搭建基础设施：</p><p>1.服务发现、服务路由、服务容错：这是最基本的微服务基础设施。</p><p>2.接口框架、API网关：主要是为了提升开发效率，接口框架是提升内部服务的开发效率，API网关是为了提升与外部服务对接的效率。</p><p>3.自动化部署、自动化测试、配置中心：主要是为了提升测试和运维效率。</p><p>4.服务监控、服务跟踪、服务安全：主要是为了进一步提升运维效率。</p><p>以上3和4两类基础设施，其重要性会随着微服务节点数量增加而越来越重要，但在微服务节点数量较少的时候，可以通过人工的方式支撑，虽然效率不高，但也基本能够顶住。</p><h2>小结</h2><p>今天我为你讲了微服务架构实践中的三个关键点：如何把握拆分粒度、按照什么维度进行拆分、需要什么基础设施支撑，希望对你有所帮助。</p><p>这就是今天的全部内容，留一道思考题给你吧，参考文章中提到的方法，思考一下你所在的业务微服务架构是否还有可以改进和提升的空间？</p><p>欢迎你把答案写到留言区，和我一起讨论。相信经过深度思考的回答，也会让你对知识的理解更加深刻。（编辑乱入：精彩的留言有机会获得丰厚福利哦！）</p>","neighbors":{"left":{"article_title":"34 | 深入理解微服务架构：银弹 or 焦油坑？","id":10944},"right":{"article_title":"36 | 微服务架构最佳实践 - 基础设施篇","id":11300}},"comments":[{"had_liked":false,"id":16193,"user_name":"云学","can_delete":false,"product_type":"c1","uid":1027233,"ip_address":"","ucode":"366AE90BA06356","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/a1/43d83698.jpg","comment_is_top":false,"comment_ctime":1531824401,"is_pvip":false,"replies":[{"id":"5621","content":"仅此一家，别无分店，都是我自己思考出来的😄","user_name":"作者回复","comment_id":16193,"uid":"1098920","ip_address":"","utype":1,"ctime":1531877814,"user_name_real":"华仔"}],"discussion_count":1,"race_medal":0,"score":"508337965329","product_id":100006601,"comment_content":"这篇很实用，谢谢分享","like_count":118,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420707,"discussion_content":"仅此一家，别无分店，都是我自己思考出来的😄","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1531877814,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16305,"user_name":"herist","can_delete":false,"product_type":"c1","uid":1122345,"ip_address":"","ucode":"BB31C37F037F62","user_header":"","comment_is_top":false,"comment_ctime":1531876805,"is_pvip":false,"replies":[{"id":"5627","content":"1. 需要，微服务需要独立部署独立运行，数据库不拆分做不到这点<br>2. 参考专栏前面分库分表内容<br>3. 开发环境也可以搭建微服务，我们是三套环境：开发，测试，线上","user_name":"作者回复","comment_id":16305,"uid":"1098920","ip_address":"","utype":1,"ctime":1531878486,"user_name_real":"华仔"}],"discussion_count":10,"race_medal":0,"score":"113201026501","product_id":100006601,"comment_content":"感谢老师对微服务解读，有3个问题：目前公司有个在线交易系统，大概几百个表的单体服务项目，其他业务前端都远程调用这个项目，现在想做微服务的改造。\r<br>1、实施微服务按业务职责划分后，是否对应模块的数据库也必须要独立？\r<br>2、若为每个微服务项目都拆出来新的数据库，原来各业务间的数据依赖（单库的时候Join查询就ok了），拆分多个项目后，有何好的处理办法？\r<br>3、团队开发时的问题，由于每小团队负责一个微服务，但开发时需要访问其他微服务，应该有个开发环境负责集成大家提交的代码，构建新版本供其他团队调用和调试，即：开发团队都可以作为消费者访问服务器上微服务（互通），但是开发人员本机启动调试时，不能注册到这台服务器（隔离），这块如何能很好解决？","like_count":26,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420749,"discussion_content":"1. 需要，微服务需要独立部署独立运行，数据库不拆分做不到这点\n2. 参考专栏前面分库分表内容\n3. 开发环境也可以搭建微服务，我们是三套环境：开发，测试，线上","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531878486,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/55/f2/ba68d931.jpg","nickname":"有米","note":"","ucode":"C9A10B7A67BC12","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":187563,"discussion_content":"数据库不拆分？那么第一很容易出现瓶颈，第二你的数据权限太大，被哪个系统改了你都不知道，如何排查问题","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1582733792,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1078444,"avatar":"","nickname":"Geek_11ac91","note":"","ucode":"B6EF72059264CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386074,"discussion_content":"需要join的两张表的一般业务相关性强，可以归到同一微服务中","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1627393442,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1214303,"avatar":"https://static001.geekbang.org/account/avatar/00/12/87/5f/6bf8b74a.jpg","nickname":"Kepler","note":"","ucode":"0C9CA3DB8B3CF0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":541297,"discussion_content":"数据库也可以先不拆，但要确保微服务间通过接口进行交互，不能a服务直接访问数据库获取b服务的数据，解耦之后再拆库也是很简单的事情","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640325062,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1048261,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/fe/c5/3467cf94.jpg","nickname":"正是那朵玫瑰","note":"","ucode":"73D630B654573F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393670,"discussion_content":"我们现在的技术负责人说拆服务不拆数据库，咋搞？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631541152,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1073443,"avatar":"https://static001.geekbang.org/account/avatar/00/10/61/23/30d134cf.jpg","nickname":"Young","note":"","ucode":"075C0BBE20FD8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376657,"discussion_content":"老师回复的第一点有疑问： 这个拆分是什么意思？如果表本身是分开的，放到一个库里还需要拆分吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622258175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1124692,"avatar":"https://static001.geekbang.org/account/avatar/00/11/29/54/b9fec917.jpg","nickname":"菜鸟一枚","note":"","ucode":"34052769B97FEC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1073443,"avatar":"https://static001.geekbang.org/account/avatar/00/10/61/23/30d134cf.jpg","nickname":"Young","note":"","ucode":"075C0BBE20FD8C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380075,"discussion_content":"放到一个库，你要考虑到数据连接池膨胀的问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624329252,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":376657,"ip_address":""},"score":380075,"extra":""}]},{"author":{"id":1005042,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/55/f2/ba68d931.jpg","nickname":"有米","note":"","ucode":"C9A10B7A67BC12","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":187564,"discussion_content":"第三个问题无论你使用dubbo还是Springcloud都是一个配置就解决了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582733892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1451141,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIu1n1DhUGGKdbP3ib8aoBDIbzaDXM9YzyowcJDTnCOLNJc3CP6dCYVmibHe7LMK37WXSicsFMicLuLBw/132","nickname":"Geek__ad4af7fe01f4","note":"","ucode":"C911D3E120964E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":4045,"discussion_content":"数据库不拆分 不影响 微服务独立部署，运行。不拆分还能利用数据库事务的特性，请老师点评","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565078813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1725691,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/54/fb/d533b03e.jpg","nickname":"Andy","note":"","ucode":"BDA2AEB353ECC4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1451141,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIu1n1DhUGGKdbP3ib8aoBDIbzaDXM9YzyowcJDTnCOLNJc3CP6dCYVmibHe7LMK37WXSicsFMicLuLBw/132","nickname":"Geek__ad4af7fe01f4","note":"","ucode":"C911D3E120964E","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571623,"discussion_content":"得结合具体业务了。不一定非得分。但是一般设计好了服务，其所用的表应该也是独立的。不然可能就是设计还不合理","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652317020,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":4045,"ip_address":""},"score":571623,"extra":""}]}]},{"had_liked":false,"id":16267,"user_name":"型火🔥","can_delete":false,"product_type":"c1","uid":1003205,"ip_address":"","ucode":"C2322918B31E60","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/c5/78626367.jpg","comment_is_top":false,"comment_ctime":1531871737,"is_pvip":true,"replies":[{"id":"5611","content":"一般指后端人员，前端人员是多服务公用的，如果用node之类的系统，本身可以算一个独立的微服务","user_name":"作者回复","comment_id":16267,"uid":"1098920","ip_address":"","utype":1,"ctime":1531876988,"user_name_real":"华仔"}],"discussion_count":1,"race_medal":0,"score":"61661413881","product_id":100006601,"comment_content":"三个火枪手分前后端吗？","like_count":14,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420734,"discussion_content":"一般指后端人员，前端人员是多服务公用的，如果用node之类的系统，本身可以算一个独立的微服务","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531876988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16360,"user_name":"王刚","can_delete":false,"product_type":"c1","uid":1103821,"ip_address":"","ucode":"4763CC9A937C38","user_header":"https://static001.geekbang.org/account/avatar/00/10/d7/cd/6ebfc468.jpg","comment_is_top":false,"comment_ctime":1531903344,"is_pvip":true,"replies":[{"id":"5705","content":"本篇就是精髓😄😄","user_name":"作者回复","comment_id":16360,"uid":"1098920","ip_address":"","utype":1,"ctime":1531966802,"user_name_real":"华仔"}],"discussion_count":1,"race_medal":0,"score":"40186609008","product_id":100006601,"comment_content":"听了老师的课对我自己有很大帮助，最近我们公司也在研究微服务～总感觉是一头雾水～希望老师多讲解一下关于微服务经常会涉及到的精髓！","like_count":9,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420771,"discussion_content":"本篇就是精髓😄😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531966802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16177,"user_name":"赵武艺","can_delete":false,"product_type":"c1","uid":1003133,"ip_address":"","ucode":"03A3864EE5DF1C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/7d/33feec7e.jpg","comment_is_top":false,"comment_ctime":1531817857,"is_pvip":false,"replies":[{"id":"5622","content":"是的，等业务发展，人员规模大了再重构，90%以上的新业务还没发展就挂掉了😂😂","user_name":"作者回复","comment_id":16177,"uid":"1098920","ip_address":"","utype":1,"ctime":1531877899,"user_name_real":"华仔"}],"discussion_count":1,"race_medal":0,"score":"40186523521","product_id":100006601,"comment_content":"看来小企业还是不太适合微服务架构，尤其是开发人员少的？","like_count":9,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420701,"discussion_content":"是的，等业务发展，人员规模大了再重构，90%以上的新业务还没发展就挂掉了😂😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531877899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16109,"user_name":"Ivan","can_delete":false,"product_type":"c1","uid":1107171,"ip_address":"","ucode":"1D914D64D3D6C2","user_header":"https://static001.geekbang.org/account/avatar/00/10/e4/e3/b56b31f5.jpg","comment_is_top":false,"comment_ctime":1531789186,"is_pvip":false,"replies":[{"id":"5560","content":"一个可以独立部署和运行的子系统","user_name":"作者回复","comment_id":16109,"uid":"1098920","ip_address":"","utype":1,"ctime":1531791552,"user_name_real":"华仔"}],"discussion_count":1,"race_medal":0,"score":"40186494850","product_id":100006601,"comment_content":"使用dubbo体系，开发微服务。那么一个微服务是指一个部署单元(jar or war)还是指一个暴露的接口？我的答案是部署单元。请老师帮忙解惑，谢谢！","like_count":9,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420673,"discussion_content":"一个可以独立部署和运行的子系统","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531791552,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81018,"user_name":"杨陆伟","can_delete":false,"product_type":"c1","uid":1108457,"ip_address":"","ucode":"3BC968447406EB","user_header":"https://static001.geekbang.org/account/avatar/00/10/e9/e9/1f95e422.jpg","comment_is_top":false,"comment_ctime":1553777215,"is_pvip":true,"replies":[{"id":"30113","content":"不用去几十台服务器几百个节点手工修改配置文件","user_name":"作者回复","comment_id":81018,"uid":"1098920","ip_address":"","utype":1,"ctime":1554537038,"user_name_real":"华仔"}],"discussion_count":1,"race_medal":0,"score":"31618548287","product_id":100006601,"comment_content":"为什么说配置中心可以提升测试和运维的效率，这里不是太理解","like_count":7,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445047,"discussion_content":"不用去几十台服务器几百个节点手工修改配置文件","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554537038,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":35005,"user_name":"Geek_89bbab","can_delete":false,"product_type":"c1","uid":1156607,"ip_address":"","ucode":"B3110D5B3C9500","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/ff/6201122c.jpg","comment_is_top":false,"comment_ctime":1540380162,"is_pvip":false,"replies":[{"id":"12491","content":"任何配置都可以放配置中心，区别只是动态配置还是需要重启，中间件也不例外","user_name":"作者回复","comment_id":35005,"uid":"1098920","ip_address":"","utype":1,"ctime":1540388813,"user_name_real":"华仔"}],"discussion_count":1,"race_medal":0,"score":"31605151234","product_id":100006601,"comment_content":"那么对于像kafka，rabbitmq这样的对应的消费者服务的消费地址是否应该放置到配置中心动态配置？还是不建议动态修改？","like_count":7,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427412,"discussion_content":"任何配置都可以放配置中心，区别只是动态配置还是需要重启，中间件也不例外","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540388813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":25852,"user_name":"森林","can_delete":false,"product_type":"c1","uid":1071920,"ip_address":"","ucode":"53BD05633B77B6","user_header":"https://static001.geekbang.org/account/avatar/00/10/5b/30/9dcf35ff.jpg","comment_is_top":false,"comment_ctime":1537453082,"is_pvip":false,"replies":[{"id":"10988","content":"招人的第一标准是业务有没有发展😄","user_name":"作者回复","comment_id":25852,"uid":"1098920","ip_address":"","utype":1,"ctime":1538870004,"user_name_real":"华仔"}],"discussion_count":2,"race_medal":0,"score":"27307256858","product_id":100006601,"comment_content":"这里有个先有鸡还是现有蛋的问题。究竟是先根据人数量决定服务数量，还是根据服务数量决定人的数量。就像文章里提到的，很多时候需要根据各种需求场景拆分服务，当生产确切不拆分就会导致问题时，应该反向以服务数量评估要扩招的人","like_count":6,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424434,"discussion_content":"招人的第一标准是业务有没有发展😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538870004,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259280,"avatar":"https://static001.geekbang.org/account/avatar/00/13/37/10/a8aa9acb.jpg","nickname":"jzdayz","note":"","ucode":"E84C0DFC53BE8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376324,"discussion_content":"对，大家编码不是秀技术，是为了帮公司解决问题。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622082261,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24414,"user_name":"孙振超","can_delete":false,"product_type":"c1","uid":1101755,"ip_address":"","ucode":"0F9EABC6125350","user_header":"https://static001.geekbang.org/account/avatar/00/10/cf/bb/22af0e52.jpg","comment_is_top":false,"comment_ctime":1536988648,"is_pvip":false,"replies":[{"id":"8957","content":"其实你这句话已经包含了答案“用户操作必然发生在设备上”，这就是说设备是基础数据，用户和设备对应关系应该是用户系统管理的。<br><br>还有一种判断标准是设备数据还可以给其它业务用，如果设备系统存储用户和设备对应关系，这个数据不是通用的，违背了设备系统的职责","user_name":"作者回复","comment_id":24414,"uid":"1098920","ip_address":"","utype":1,"ctime":1537062351,"user_name_real":"华仔"}],"discussion_count":1,"race_medal":0,"score":"27306792424","product_id":100006601,"comment_content":"咨询老师一个问题：在服务切分的时候会存两个系统间数据发生交集的情况，比如一个是设备系统，另一个是用户系统，用户的各项操作必然发生在设备上，这样就会存在设备和用户的各种关系和操作记录，像这样的数据设备系统和用户系统都希望以自己为准，而后对外提供相应的服务。如果是数据存储两份，设备系统存储设备和用户的关系，用户系统存储用户和设备的关系，那么在数据一致性和调用链路上就会变得复杂；如果只存储一份，放在那个系统上另一个系统都会有意见。对于此种情况，有什么比较好的解法？","like_count":6,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423972,"discussion_content":"其实你这句话已经包含了答案“用户操作必然发生在设备上”，这就是说设备是基础数据，用户和设备对应关系应该是用户系统管理的。\n\n还有一种判断标准是设备数据还可以给其它业务用，如果设备系统存储用户和设备对应关系，这个数据不是通用的，违背了设备系统的职责","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537062351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":24838,"user_name":"laolinshi","can_delete":false,"product_type":"c1","uid":1024994,"ip_address":"","ucode":"269B879389D7D5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a3/e2/5cb4f43f.jpg","comment_is_top":false,"comment_ctime":1537197993,"is_pvip":false,"replies":[{"id":"9263","content":"自古评论出人才😄","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1537342376,"ip_address":"","comment_id":24838,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18717067177","product_id":100006601,"comment_content":"看评论中的那些问题真是受益良多。","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":424117,"discussion_content":"自古评论出人才😄","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1537342376,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":20465,"user_name":"女巫在寒江","can_delete":false,"product_type":"c1","uid":1013180,"ip_address":"","ucode":"B3707072224C1C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/bc/664bbdf7.jpg","comment_is_top":false,"comment_ctime":1534466022,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"18714335206","product_id":100006601,"comment_content":"我觉着我们现在的微服务架构刚好，我们是四个人负责集成公司的规则引擎，引擎那边有规则的编译器和执行器，对应的服务就划分为 规则编辑 和规则执行这两个部分，基本是两人负责一个服务","like_count":4},{"had_liked":false,"id":16102,"user_name":"wind2017","can_delete":false,"product_type":"c1","uid":1017448,"ip_address":"","ucode":"DB1341145117C1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/86/68/bda37080.jpg","comment_is_top":false,"comment_ctime":1531787832,"is_pvip":false,"replies":[{"id":"5562","content":"通常用GA版本就可以","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1531791805,"ip_address":"","comment_id":16102,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18711657016","product_id":100006601,"comment_content":"老师，目前Spring Cloud哪个版本更稳定些？","like_count":4,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420668,"discussion_content":"通常用GA版本就可以","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531791805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":186918,"user_name":"谭方敏","can_delete":false,"product_type":"c1","uid":1710960,"ip_address":"","ucode":"728DC7ECB7C902","user_header":"https://static001.geekbang.org/account/avatar/00/1a/1b/70/547042ee.jpg","comment_is_top":false,"comment_ctime":1583972572,"is_pvip":false,"replies":[{"id":"72859","content":"可以试试","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1584425476,"ip_address":"","comment_id":186918,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14468874460","product_id":100006601,"comment_content":"服务粒度<br>三个火枪手，一个服务三个人。<br>好处包括：1）全面了解系统，2）相互形成备份，3）相互讨论。<br><br>拆分原则<br>1）基于业务逻辑<br>结合三个火枪手选择，计算服务数量，由此决定服务的职责范围。<br>2）基于可扩展性<br>将成熟的和不变化的服务分为稳定服务，而将不成熟和变化的服务称为变化服。<br>3）基于可靠性<br>将业务模块按照优先级排序，将高可用的核心模块和不高可用的非核心模块分开，重点保证核心模块的高可用性。<br>好处有a）让非核心业务不再影响核心业务，b）让核心业务变得更加简单，c）降低高可用成本<br>4）基于性能<br>类似于基于可靠性分析，将对性能要求高的和负载大的模块拆分出来，避免受其它业务影响。<br>基础设施<br>包括四大块：<br>1）服务发现，服务路由，服务容错<br>2）接口框架，api网关<br>3）自动化部署，自动化测试，配置中心<br>4）服务监控，服务跟踪，服务安全。<br>在现有微服务上拆分上，之前并没有将研发人数跟服务数量很好地结合起来。三个火枪手的原则很实用。不用特别高大上，异常接地气。<br>另外在描述基础设施的时候，表述非常全面。","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":486918,"discussion_content":"可以试试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584425476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":34999,"user_name":"Geek_89bbab","can_delete":false,"product_type":"c1","uid":1156607,"ip_address":"","ucode":"B3110D5B3C9500","user_header":"https://static001.geekbang.org/account/avatar/00/11/a5/ff/6201122c.jpg","comment_is_top":false,"comment_ctime":1540378090,"is_pvip":false,"replies":[{"id":"12486","content":"通常这类配置需要重启生效，一般改动频率也低，改动的时候由运维人工参与是可以的","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1540378840,"ip_address":"","comment_id":34999,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14425279978","product_id":100006601,"comment_content":"老师，问一下关于配置中心的问题，<br>配置中心修改配置，然后通知对应的微服务，那么收到通知的微服务怎么使新的配置生效，我这里特别指的是那些通过配置有创建长生命周期对象的那种。比如mysql连接池，redis-client。比如数据库配置修改了，怎么使新的配置生效？求解惑","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427407,"discussion_content":"通常这类配置需要重启生效，一般改动频率也低，改动的时候由运维人工参与是可以的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540378840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1259280,"avatar":"https://static001.geekbang.org/account/avatar/00/13/37/10/a8aa9acb.jpg","nickname":"jzdayz","note":"","ucode":"E84C0DFC53BE8A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376325,"discussion_content":"这个得看连接池能不能支持动态修改，我记得druid可以的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622082355,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1305634,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIxUs41OibzN4WsMSZEiaSHI17etB9UQhLaQFfFOq0Wjf5caR0tzVY8otFfwgnNNuwLAZ8MibZwRRllQ/132","nickname":"唐家三叔","note":"","ucode":"3B4022B227B9E7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269624,"discussion_content":"服务监听配置改动（服务定时轮询或者配置通知），有改动触发服务重载，重载时先根据新的配置创建连接，之后释放掉旧的连接。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589934045,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30128,"user_name":"小思绪","can_delete":false,"product_type":"c1","uid":1123040,"ip_address":"","ucode":"A7F813280BFF10","user_header":"https://static001.geekbang.org/account/avatar/00/11/22/e0/8e58a7e1.jpg","comment_is_top":false,"comment_ctime":1538693111,"is_pvip":false,"replies":[{"id":"10986","content":"下一课就讲了","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1538869753,"ip_address":"","comment_id":30128,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14423594999","product_id":100006601,"comment_content":"请问“接口框架”是指什么？有无成熟产品可以借鉴，它的作用是什么？API网关是指通用网关，比如支付宝开放平台网关，还是业务网关呢？我理解的业务网关的职责应该包括协议转换（比如外网的HTTP转内部Dubbo）和业务逻辑。","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425861,"discussion_content":"下一课就讲了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538869753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16775,"user_name":"return","can_delete":false,"product_type":"c1","uid":1135528,"ip_address":"","ucode":"42B8A3380DF04B","user_header":"https://static001.geekbang.org/account/avatar/00/11/53/a8/abc96f70.jpg","comment_is_top":false,"comment_ctime":1532176104,"is_pvip":false,"replies":[{"id":"5842","content":"很形象，向大仲马和贝索斯借用了一些创意","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1532255524,"ip_address":"","comment_id":16775,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14417077992","product_id":100006601,"comment_content":"三个火枪手， 很犀利。 ","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420922,"discussion_content":"很形象，向大仲马和贝索斯借用了一些创意","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532255524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16465,"user_name":"张威","can_delete":false,"product_type":"c1","uid":1101090,"ip_address":"","ucode":"6F8585E33E778B","user_header":"https://static001.geekbang.org/account/avatar/00/10/cd/22/dfa52b74.jpg","comment_is_top":false,"comment_ctime":1531965956,"is_pvip":false,"replies":[{"id":"5770","content":"正常来说这样有很大隐患，我们之前有后台管理系统这样做，每周都需要安排人力排查线上数据错乱问题，因为数据写入有两个源","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1532069027,"ip_address":"","comment_id":16465,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14416867844","product_id":100006601,"comment_content":"我们项目正好相反，将系统拆分了多个子系统，但是同一个库，子系统之间没有相互调用，而是直接对相同库中的表进行操作。在开发过程中发现每个系统中多少会有些重复的代码。该系统是校级系统，目前没发现其它弊端","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420806,"discussion_content":"正常来说这样有很大隐患，我们之前有后台管理系统这样做，每周都需要安排人力排查线上数据错乱问题，因为数据写入有两个源","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532069027,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1073443,"avatar":"https://static001.geekbang.org/account/avatar/00/10/61/23/30d134cf.jpg","nickname":"Young","note":"","ucode":"075C0BBE20FD8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376659,"discussion_content":"不同的微服务写不同的表，但只是读别的微服务写的表，还需要拆分数据库吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622259190,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2387358,"avatar":"https://static001.geekbang.org/account/avatar/00/24/6d/9e/6a82a5ea.jpg","nickname":"good boby","note":"","ucode":"1471E2E499412C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":363856,"discussion_content":"一、此类方式，并发量不高的请下，出现错乱的概率低。二、因多个源（多进程）写如数据库导致数据错乱问题，统一持久层的处理（程序代码实现或数据库操作中间件）可以解决此类问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617291440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16261,"user_name":"LB","can_delete":false,"product_type":"c1","uid":1047988,"ip_address":"","ucode":"25DD8D5597CB1A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fd/b4/b5483cd5.jpg","comment_is_top":false,"comment_ctime":1531870287,"is_pvip":false,"replies":[{"id":"5612","content":"采用微服务不明智，你们这种是典型的SOA应用场景，因为基本都是采购的","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1531877081,"ip_address":"","comment_id":16261,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14416772175","product_id":100006601,"comment_content":"我所在工作单位系统基本都是外部采购，大概有100多个，开发、测试人员大部分是各个公司的外包人员，开发和运维部门又相对比较独立。请问实施微服务是否是一个明智的选择？代价会有多大？领导觉得SOA的ESB太重，又没有使用。希望华仔帮忙给些架构方面的建议，谢谢。","like_count":3,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420732,"discussion_content":"采用微服务不明智，你们这种是典型的SOA应用场景，因为基本都是采购的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531877081,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279328,"user_name":"进击的巨人","can_delete":false,"product_type":"c1","uid":1167120,"ip_address":"","ucode":"DB62D77D460BF1","user_header":"https://static001.geekbang.org/account/avatar/00/11/cf/10/9fa2e5ba.jpg","comment_is_top":false,"comment_ctime":1613722252,"is_pvip":false,"replies":[{"id":"101535","content":"一般微服务不建议按层来横向分，而是纵向按照业务功能或者业务域来分。<br><br>你说的B2C商品微服务和社区团购微服务这种复用，其实是中台的概念，即：中台提供“商品中心”这样一个业务子域的概念，支撑上层不同的业务。","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1613812857,"ip_address":"","comment_id":279328,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10203656844","product_id":100006601,"comment_content":"老师请问，微服务拆饭是否可以按照层拆分，例如电商的商品，拆分成基础商品中心层，这样相当于沉淀了一个商品基础服务，这样拆的好处在于，上层可以构建不同业务模式的商品业务服务，例如传统B2C的商品可以作为一个微服务，社区团购的商品又可以作为一个微服务，达到了商品基础模型能力的复用","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515705,"discussion_content":"一般微服务不建议按层来横向分，而是纵向按照业务功能或者业务域来分。\n\n你说的B2C商品微服务和社区团购微服务这种复用，其实是中台的概念，即：中台提供“商品中心”这样一个业务子域的概念，支撑上层不同的业务。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613812857,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":47317,"user_name":"希望","can_delete":false,"product_type":"c1","uid":1003047,"ip_address":"","ucode":"C10E7E12F41A45","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4e/27/cd9796cd.jpg","comment_is_top":false,"comment_ctime":1544105379,"is_pvip":false,"replies":[{"id":"16900","content":"要精确保证的话需要引入zookeeper之类的系统，不需要精确保证的话可以通过定时校验来做","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1544132969,"ip_address":"","comment_id":47317,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10134039971","product_id":100006601,"comment_content":"老师请教一个问题，如果一个业务需要由多个微服务参与。如果在调用链中一部分已经成功，数据已提交数据库，此时某服务失败，那么此时如何保证所有服务上的数据一致性呢？","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":431734,"discussion_content":"要精确保证的话需要引入zookeeper之类的系统，不需要精确保证的话可以通过定时校验来做","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1544132969,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1073443,"avatar":"https://static001.geekbang.org/account/avatar/00/10/61/23/30d134cf.jpg","nickname":"Young","note":"","ucode":"075C0BBE20FD8C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376660,"discussion_content":"失败的服务恢复的时候，基于失败点的数据继续处理，保证最终一致性  是否满足？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622259520,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2426430,"avatar":"https://static001.geekbang.org/account/avatar/00/25/06/3e/33acbf9d.jpg","nickname":"🍎","note":"","ucode":"6CDB30749169CF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372086,"discussion_content":"想请问下，没有服务调用链层面的回滚吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620182229,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":21571,"user_name":"文竹","can_delete":false,"product_type":"c1","uid":1103167,"ip_address":"","ucode":"74413B1975976B","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/3f/80bf4841.jpg","comment_is_top":false,"comment_ctime":1535170507,"is_pvip":false,"replies":[{"id":"7702","content":"你们这个算不上微服务，微服务是业务相关的，肯定有依赖关系和调用关系","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1535276549,"ip_address":"","comment_id":21571,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10125105099","product_id":100006601,"comment_content":"目前业务中只使用了网关，为什么首先使用网关呢？因为想对一批互不关联的服务进行统一认证、限流等。这样的话，这批服务就不是微服务了，因为服务间没有关联。面对这种场景，认为不能完全照搬微服务的一些设施，具体问题还得具体分析。<br><br>由于服务间不存在互相调用，所以一些微服务的设施可以不使用。比如：<br>1、服务追踪，服务发现、路由，容错。<br>2、配置中心<br>","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422747,"discussion_content":"你们这个算不上微服务，微服务是业务相关的，肯定有依赖关系和调用关系","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535276549,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":20438,"user_name":"钗","can_delete":false,"product_type":"c1","uid":1099581,"ip_address":"","ucode":"0163C7029EE468","user_header":"https://static001.geekbang.org/account/avatar/00/10/c7/3d/bfbd10fc.jpg","comment_is_top":false,"comment_ctime":1534441797,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10124376389","product_id":100006601,"comment_content":"失眠，来听听课吧。微服务的粒度拆分简直堪称一门艺术了。不过七夕啦，单身狗祝大家好好珍惜身边人，也给你的他&#47;她提供微服务化～","like_count":2},{"had_liked":false,"id":16345,"user_name":"yason li","can_delete":false,"product_type":"c1","uid":1050986,"ip_address":"","ucode":"C1465F8E12564E","user_header":"","comment_is_top":false,"comment_ctime":1531889890,"is_pvip":false,"replies":[{"id":"5706","content":"1. 这也是一种思路<br>2. 微服务基础设施做完，复杂度和ESB类似","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1531966894,"ip_address":"","comment_id":16345,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10121824482","product_id":100006601,"comment_content":"感觉应该还可以按照领域模型中数据一致性的维度来拆分。比如对实时一致性要求比较高的业务，尽量避免散落在太多服务中，增加分布式事务管理的复杂度。还有，感觉现在各种服务治理的架构其实还是造名词多一些，本质上都应该算是SOA思想的延伸或者变形。比如现在很火的Service Mesh本质上就是借鉴了通信领域的控制面数据面分离思想做出的去中心化的ESB。","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420766,"discussion_content":"1. 这也是一种思路\n2. 微服务基础设施做完，复杂度和ESB类似","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531966894,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16225,"user_name":"空档滑行","can_delete":false,"product_type":"c1","uid":1091611,"ip_address":"","ucode":"06A6A7F503FAA7","user_header":"https://static001.geekbang.org/account/avatar/00/10/a8/1b/ced1d171.jpg","comment_is_top":false,"comment_ctime":1531837241,"is_pvip":false,"replies":[{"id":"5617","content":"1. 网关的场景和设计关键点下一章节会讲<br>2. service mesh目前并不算成熟，中小公司没有必要用","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1531877610,"ip_address":"","comment_id":16225,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10121771833","product_id":100006601,"comment_content":"这里面服务容错是比较容易被忽视的，见过太多的开发问，服务好好的怎么会出错呢？我做开发2,3年了也没见过数据库数据损坏。<br>关于api网关请教下，什么时候应该考虑加网关层，以微服务数量来评估吗？<br>还有现在讨论的比较多的service mesh，单独把通信层解耦出来，感觉对于一般的中型互联网公司也没有必要吧","like_count":2,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420721,"discussion_content":"1. 网关的场景和设计关键点下一章节会讲\n2. service mesh目前并不算成熟，中小公司没有必要用","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531877610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338498,"user_name":"BIZ_UI_3","can_delete":false,"product_type":"c1","uid":1655948,"ip_address":"","ucode":"1B9718610A5A59","user_header":"","comment_is_top":false,"comment_ctime":1647526835,"is_pvip":false,"replies":[{"id":"123766","content":"别嘴炮，如果没理解就再认真学学，如果没有成功的经验就先积累，不要上来就否定，按照你的想法去做的坑了多少团队和业务你知道吗？<br><br>同样是用户管理，小公司连独立服务都不需要，淘宝这种规模的业务用户中心几百个人。","user_name":"作者回复","user_name_real":"作者","uid":"1098920","ctime":1647588826,"ip_address":"","comment_id":338498,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5942494131","product_id":100006601,"comment_content":"按人员数量拆分简直误人子弟。。。同样的业务，难道团队3人就1个服务，团队要是30人就10个服务吗？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":556967,"discussion_content":"别嘴炮，如果没理解就再认真学学，如果没有成功的经验就先积累，不要上来就否定，按照你的想法去做的坑了多少团队和业务你知道吗？\n\n同样是用户管理，小公司连独立服务都不需要，淘宝这种规模的业务用户中心几百个人。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1647588826,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":312473,"user_name":"青年祭司","can_delete":false,"product_type":"c1","uid":1259156,"ip_address":"","ucode":"C88EDAE3FF09AE","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/94/0b969588.jpg","comment_is_top":false,"comment_ctime":1631836413,"is_pvip":false,"replies":[{"id":"113253","content":"你是看完课程之后不知道怎么应用么？你的这个案例在这篇文章中已经讲到了解法，从几种拆分方式挑选一个，具体挑选哪个你先判断一下，如果自己思考后还是判断不了，再提问，说明为什么你判断不了","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1631924521,"ip_address":"","comment_id":312473,"utype":1}],"discussion_count":1,"race_medal":5,"score":"5926803709","product_id":100006601,"comment_content":"老师，目前公司有个结算系统已经不堪重负，经常线程执行过程中卡死，想改造成微服务，请问应该按照什么步骤改造","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":526976,"discussion_content":"你是看完课程之后不知道怎么应用么？你的这个案例在这篇文章中已经讲到了解法，从几种拆分方式挑选一个，具体挑选哪个你先判断一下，如果自己思考后还是判断不了，再提问，说明为什么你判断不了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631924521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":292037,"user_name":"菜鸟葫芦娃","can_delete":false,"product_type":"c1","uid":1701051,"ip_address":"","ucode":"B402A23D3F1381","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK28icgzo9R0rT9h0Q7iaYkJQtCPa0oriaDfFdaQMUibnnH7BW2CU9yKwDUvou63AmoGGIPgZJDyjMRJA/132","comment_is_top":false,"comment_ctime":1620652400,"is_pvip":false,"replies":[{"id":"105785","content":"1. 后台管理系统由程序聚合数据<br>2. 后台管理系统统一管理数据，然后推送给各个微服务","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1620727863,"ip_address":"","comment_id":292037,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5915619696","product_id":100006601,"comment_content":"微服务拆分，涉及到后台管理系统，是需要怎样处理?比如列表展示，甚至是夸库的操作","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519646,"discussion_content":"1. 后台管理系统由程序聚合数据\n2. 后台管理系统统一管理数据，然后推送给各个微服务","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620727863,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1701051,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK28icgzo9R0rT9h0Q7iaYkJQtCPa0oriaDfFdaQMUibnnH7BW2CU9yKwDUvou63AmoGGIPgZJDyjMRJA/132","nickname":"菜鸟葫芦娃","note":"","ucode":"B402A23D3F1381","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373520,"discussion_content":"老师答惑很及时，茅塞顿开，通过异步方式把分开的数据进行聚合，毕竟现在存储成本已经很低了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620774970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249868,"user_name":"陈栋","can_delete":false,"product_type":"c1","uid":1254730,"ip_address":"","ucode":"D362D393E1F591","user_header":"https://static001.geekbang.org/account/avatar/00/13/25/4a/091c7373.jpg","comment_is_top":false,"comment_ctime":1600836195,"is_pvip":false,"replies":[{"id":"91869","content":"是的，但是DDD既想搞定业务服务划分，又想搞定实际代码编写，很多人看不清什么时候该用哪一部分","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1601431430,"ip_address":"","comment_id":249868,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5895803491","product_id":100006601,"comment_content":"DDD也算是微服务划分的利器了","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506041,"discussion_content":"是的，但是DDD既想搞定业务服务划分，又想搞定实际代码编写，很多人看不清什么时候该用哪一部分","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601431430,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":75864,"user_name":"星星童鞋","can_delete":false,"product_type":"c1","uid":1127645,"ip_address":"","ucode":"134A19261B9666","user_header":"https://static001.geekbang.org/account/avatar/00/11/34/dd/baaef6cc.jpg","comment_is_top":false,"comment_ctime":1552484327,"is_pvip":false,"replies":[{"id":"28716","content":"可以的，一般最开始拆分几个粗一点的","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1553299977,"ip_address":"","comment_id":75864,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5847451623","product_id":100006601,"comment_content":"请问老师，到底项目进展到什么程度，才需要做微服务架构的拆分，可不可以在业务最初设计时就做简单的微服务拆分设计？（在满足人员需求时）","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":443063,"discussion_content":"可以的，一般最开始拆分几个粗一点的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1553299977,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36306,"user_name":"随心而至","can_delete":false,"product_type":"c1","uid":1097836,"ip_address":"","ucode":"31866865255101","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg","comment_is_top":false,"comment_ctime":1541034134,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5836001430","product_id":100006601,"comment_content":"Spring cloud全家桶了解一下","like_count":1},{"had_liked":false,"id":29092,"user_name":"小思绪","can_delete":false,"product_type":"c1","uid":1123040,"ip_address":"","ucode":"A7F813280BFF10","user_header":"https://static001.geekbang.org/account/avatar/00/11/22/e0/8e58a7e1.jpg","comment_is_top":false,"comment_ctime":1538267541,"is_pvip":false,"replies":[{"id":"10514","content":"不包含业务逻辑，只负责编解码，路由，安全这些功能。<br>暂时没有线下微信交流群","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1538307612,"ip_address":"","comment_id":29092,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833234837","product_id":100006601,"comment_content":"请问api网关的职责是什么？只负责协议转码参数校验，不包含业务逻辑吗？另外，有没有线下沟通的微信群呢？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425490,"discussion_content":"不包含业务逻辑，只负责编解码，路由，安全这些功能。\n暂时没有线下微信交流群","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538307612,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16935,"user_name":"飞鱼","can_delete":false,"product_type":"c1","uid":1137357,"ip_address":"","ucode":"27278A74FD2F6C","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epq2AfJ26y9tHxOEDbSCLbRKxdcTRwqibpEBkCnOicg4JkAjLXggtbln0XGib7vXMTrRpsFmAznzqQgA/132","comment_is_top":false,"comment_ctime":1532313400,"is_pvip":false,"replies":[{"id":"5936","content":"缩减服务数量到6~10个最好","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1532424751,"ip_address":"","comment_id":16935,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5827280696","product_id":100006601,"comment_content":"我的团队有20个人，但有二十多个服务模块，目前是采用人员复用的方式，比如甲乙丙负责A服务，乙丙丁负责B服务，从长远来看，有没有好的建议？加人？合并服务？","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420975,"discussion_content":"缩减服务数量到6~10个最好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532424751,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16236,"user_name":"大碗","can_delete":false,"product_type":"c1","uid":1027207,"ip_address":"","ucode":"F9CDC0C5BE48AC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/87/8ed5880a.jpg","comment_is_top":false,"comment_ctime":1531841317,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5826808613","product_id":100006601,"comment_content":"服务拆封的粒度不能过小，对应来说看服务的接口数，如果只有一个controller的划分，从业务的角度来说应该是太细了~可以放多几个类似规模的一起在这个服务","like_count":1},{"had_liked":false,"id":16197,"user_name":"探索无止境","can_delete":false,"product_type":"c1","uid":1044178,"ip_address":"","ucode":"91D2A9907DFA79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ee/d2/7024431c.jpg","comment_is_top":false,"comment_ctime":1531826342,"is_pvip":false,"replies":[{"id":"5618","content":"微服务基础设施全部讲透的内容足够开另外一个专栏了，极客时间已有类似的专栏，我主要提炼关键设计点","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1531877681,"ip_address":"","comment_id":16197,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5826793638","product_id":100006601,"comment_content":"微服务的基础设施非常重要，希望后续老师可以花比较多的篇幅来把这块讲透，十分感谢！","like_count":1,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420710,"discussion_content":"微服务基础设施全部讲透的内容足够开另外一个专栏了，极客时间已有类似的专栏，我主要提炼关键设计点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531877681,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":358504,"user_name":"牛年榴莲","can_delete":false,"product_type":"c1","uid":1183703,"ip_address":"广东","ucode":"230C076193C6C0","user_header":"https://static001.geekbang.org/account/avatar/00/12/0f/d7/31d07471.jpg","comment_is_top":false,"comment_ctime":1664368433,"is_pvip":false,"replies":[{"id":"130881","content":"ApiFox、Swagger","user_name":"作者回复","user_name_real":"编辑","uid":"1098920","ctime":1665886846,"ip_address":"广东","comment_id":358504,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1664368433","product_id":100006601,"comment_content":"接口框架这个词还是第一次听说，有哪些常用的选型呢？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590564,"discussion_content":"ApiFox、Swagger","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665886846,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":355246,"user_name":"Geek_8a88cd","can_delete":false,"product_type":"c1","uid":3161821,"ip_address":"广东","ucode":"6723F898D124CD","user_header":"","comment_is_top":false,"comment_ctime":1661223928,"is_pvip":false,"replies":[{"id":"129498","content":"DDD告诉你“要划分、划分有好处”，但是怎么划分，你自己看着办；可以根据组织结构来划分，可以根据业务事件来划分，可以根据业务专家意见来划分……","user_name":"作者回复","user_name_real":"编辑","uid":"1098920","ctime":1661763620,"ip_address":"广东","comment_id":355246,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1661223928","product_id":100006601,"comment_content":"划分多少个可以根据&quot;三个火枪手&quot;的原则，依据什么划分可以根据&quot;4种维度&quot;，请问下老师：DDD的作用是什么？也是指导服务划分的吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":585694,"discussion_content":"DDD告诉你“要划分、划分有好处”，但是怎么划分，你自己看着办；可以根据组织结构来划分，可以根据业务事件来划分，可以根据业务专家意见来划分……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661763620,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东"},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":347709,"user_name":"Kevin","can_delete":false,"product_type":"c1","uid":2929228,"ip_address":"","ucode":"0027EFD7D9AC22","user_header":"","comment_is_top":false,"comment_ctime":1654333143,"is_pvip":true,"replies":[{"id":"126771","content":"Spring Cloud Gateway是微服务网关，负责处理将外部请求转发给内部微服务；Spring Cloud Feign + Ribbon是微服务路由，负责微服务之间的请求调用。","user_name":"作者回复","user_name_real":"编辑","uid":"1098920","ctime":1654415585,"ip_address":"","comment_id":347709,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1654333143","product_id":100006601,"comment_content":"老师，微服务路由一般指代什么，我的理解现在的微服务网关都可以配置路由，是不是不需要单独的路由组件了？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":574873,"discussion_content":"Spring Cloud Gateway是微服务网关，负责处理将外部请求转发给内部微服务；Spring Cloud Feign + Ribbon是微服务路由，负责微服务之间的请求调用。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654415585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":334086,"user_name":"DRL","can_delete":false,"product_type":"c1","uid":2664496,"ip_address":"","ucode":"B2362FA3839A8E","user_header":"https://static001.geekbang.org/account/avatar/00/28/a8/30/44319f60.jpg","comment_is_top":false,"comment_ctime":1644736971,"is_pvip":true,"replies":[{"id":"122121","content":"可以的，微服务可以是某个大的分层架构中业务层的架构模式，单个微服务本身也可以采用分层架构","user_name":"作者回复","user_name_real":"编辑","uid":"1098920","ctime":1644893705,"ip_address":"","comment_id":334086,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1644736971","product_id":100006601,"comment_content":"一套系统，可能同时属于分层架构和微服务架构吗？比如一个缓存中间件，按照接入层、Cache服务层、元数据管理层、持久化层进行分层组织；同时，内部各个子系统通过接口框架进行交互，并具备相应的集群管理模块（调度，服务注册，服务发现等）以及基础设施模块（提供公共接口、服务、操作系统对接等），对外通过通过抽象的适配层（API网关）提供服务，如此又是微服务架构，想问下这两种架构模式可能在一个系统内共存吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551077,"discussion_content":"可以的，微服务可以是某个大的分层架构中业务层的架构模式，单个微服务本身也可以采用分层架构","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644893706,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2664496,"avatar":"https://static001.geekbang.org/account/avatar/00/28/a8/30/44319f60.jpg","nickname":"DRL","note":"","ucode":"B2362FA3839A8E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":551526,"discussion_content":"好的，谢谢！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645057006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":551077,"ip_address":""},"score":551526,"extra":""}]}]},{"had_liked":false,"id":332962,"user_name":"青山","can_delete":false,"product_type":"c1","uid":1085803,"ip_address":"","ucode":"A91D297A9939E3","user_header":"https://static001.geekbang.org/account/avatar/00/10/91/6b/3590eb7f.jpg","comment_is_top":false,"comment_ctime":1643894603,"is_pvip":true,"replies":[{"id":"121706","content":"我是看了《长津湖》才知道我军有三三制这个原则 ：）","user_name":"作者回复","user_name_real":"编辑","uid":"1098920","ctime":1644027847,"ip_address":"","comment_id":332962,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1643894603","product_id":100006601,"comment_content":"很多优秀的军队底层组合都是三三制原则，三个火枪手，这个原则好👍","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549487,"discussion_content":"我是看了《长津湖》才知道我军有三三制这个原则 ：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644027847,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326385,"user_name":"shawn","can_delete":false,"product_type":"c1","uid":1516046,"ip_address":"","ucode":"1A52A00A0A6610","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIkkg9icSGleYMAnwlb7A9MMJYOdovl8kOCA0asMkDe6grPNF74ib0prQMicicJTNa1WsdpMJ4p1CWkUQ/132","comment_is_top":false,"comment_ctime":1639491442,"is_pvip":false,"replies":[{"id":"118569","content":"我不认同这种观点，这个“安全感”与“尊重感”也不符合实际情况，事实上1个人负责一个核心微服务，不管是开发压力、故障处理压力等都会很大。","user_name":"作者回复","user_name_real":"作者","uid":"1098920","ctime":1639543511,"ip_address":"","comment_id":326385,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1639491442","product_id":100006601,"comment_content":"在郭东白老师基于马斯洛的需求层级的文章里说为了给开发人员安全感，如果单个微服务一个人就行那就一个人负责，这样那个人会得到极大的安全感和被尊重感，从而更好的工作，<br>😄","like_count":0,"discussions":[{"author":{"id":1516046,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIkkg9icSGleYMAnwlb7A9MMJYOdovl8kOCA0asMkDe6grPNF74ib0prQMicicJTNa1WsdpMJ4p1CWkUQ/132","nickname":"shawn","note":"","ucode":"1A52A00A0A6610","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538898,"discussion_content":"是的，我也不认同，起码得主备，谢谢华仔回复","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639552072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":538869,"discussion_content":"我不认同这种观点，这个“安全感”与“尊重感”也不符合实际情况，事实上1个人负责一个核心微服务，不管是开发压力、故障处理压力等都会很大。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1639543511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1592279,"avatar":"https://static001.geekbang.org/account/avatar/00/18/4b/d7/f46c6dfd.jpg","nickname":"William Ning","note":"","ucode":"4DB8D05E69E5F3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569323,"discussion_content":"学习要有的思考～","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651406627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":325853,"user_name":"DDL007","can_delete":false,"product_type":"c1","uid":1441576,"ip_address":"","ucode":"385870514758C7","user_header":"https://static001.geekbang.org/account/avatar/00/15/ff/28/76d736e3.jpg","comment_is_top":false,"comment_ctime":1639197258,"is_pvip":false,"replies":[{"id":"118216","content":"全套基础设施落地下来，工作量不小","user_name":"作者回复","user_name_real":"编辑","uid":"1098920","ctime":1639278392,"ip_address":"","comment_id":325853,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1639197258","product_id":100006601,"comment_content":"微服务架构算是技术在业务复杂度和团队规模的一种权衡方案，我对这个 基础设施  很有感觉。如果后端决定切微服务架构，带动测试，运维等伙伴迭代知识。对方支持就有基础设施，不支持就没有。<br><br>服务化刚开始解决了开发和部署的问题，后来测试，运维配套能力成为瓶颈，于是面向服务化的测试和运维能力也要建设。以上是服务化落地的常见阻碍，老师的图中提到了测试和运维，但相比服务本身的问题直观上要少许多，但实际上这部分是工作量最大的一部分，只是不在后端。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":537953,"discussion_content":"全套基础设施落地下来，工作量不小","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639278392,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314967,"user_name":"Kim","can_delete":false,"product_type":"c1","uid":1067212,"ip_address":"","ucode":"824575C9FCE06D","user_header":"https://static001.geekbang.org/account/avatar/00/10/48/cc/109fa895.jpg","comment_is_top":false,"comment_ctime":1633615060,"is_pvip":false,"replies":[{"id":"114109","content":"要的就是这个效果 ：）","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1633684289,"ip_address":"","comment_id":314967,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633615060","product_id":100006601,"comment_content":"这专栏，怎么说呢，扫了我的各种盲区。。而且很有体系，把我之前的一些思考、经历、学习的知识串起来了","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527843,"discussion_content":"要的就是这个效果 ：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1633684289,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":314778,"user_name":"梁聪明","can_delete":false,"product_type":"c1","uid":2053611,"ip_address":"","ucode":"712FAD6E071585","user_header":"https://static001.geekbang.org/account/avatar/00/1f/55/eb/a441eda8.jpg","comment_is_top":false,"comment_ctime":1633422437,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633422437","product_id":100006601,"comment_content":"服务监控、服务跟踪、服务安全 这三项能够快速发现和定位线上问题！","like_count":0},{"had_liked":false,"id":313490,"user_name":"Drake敏","can_delete":false,"product_type":"c1","uid":2734734,"ip_address":"","ucode":"38366767EFDC90","user_header":"https://static001.geekbang.org/account/avatar/00/29/ba/8e/4645afae.jpg","comment_is_top":false,"comment_ctime":1632462736,"is_pvip":false,"replies":[{"id":"113587","content":"云原生 = 服务化 + 容器化 + Service Mesh + 云产品","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1632532976,"ip_address":"","comment_id":313490,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1632462736","product_id":100006601,"comment_content":"慢慢都会使用到K8S容器技术，这样对微服务则更加重要了<br>","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527369,"discussion_content":"云原生 = 服务化 + 容器化 + Service Mesh + 云产品","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632532976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":300587,"user_name":"小鬼爱风雪","can_delete":false,"product_type":"c1","uid":2646199,"ip_address":"","ucode":"FF72E39E557C6F","user_header":"https://static001.geekbang.org/account/avatar/00/28/60/b7/4a665c73.jpg","comment_is_top":false,"comment_ctime":1625231511,"is_pvip":false,"replies":[{"id":"108928","content":"都是实践出来的","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1625286767,"ip_address":"","comment_id":300587,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625231511","product_id":100006601,"comment_content":"看完上一篇，直接来看这个感觉受益匪浅","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":522769,"discussion_content":"都是实践出来的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625286767,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":293356,"user_name":"msgx","can_delete":false,"product_type":"c1","uid":1065556,"ip_address":"","ucode":"EB634F9AC016BF","user_header":"https://static001.geekbang.org/account/avatar/00/10/42/54/0530d18d.jpg","comment_is_top":false,"comment_ctime":1621349470,"is_pvip":false,"replies":[{"id":"106241","content":"这样可以提升性能，一般是用在首页或者一些比较复杂的页面，需要调用很多次后台接口，通过聚合一次完成，能够提升性能。<br><br>但是不建议所有接口都走聚合层，没有必要，事实上现在很多公司的聚合层都是由前端通过node.js自己来做的，后端只负责细粒度的服务接口。这样的好处是分工明确，职责清晰，前端自己分析自己优化自己来设计聚合接口","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1621389191,"ip_address":"","comment_id":293356,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1621349470","product_id":100006601,"comment_content":"老师，问下现在我们APP访问我们业务中台微服务的中间加了一层聚合服务，每次APP调用后台业务都由APP聚合服务统一调用后台服务接口，这样设计感觉虽然方面了APP对接服务的数量，但每次都要聚合层包装一下是否也不好。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":520174,"discussion_content":"这样可以提升性能，一般是用在首页或者一些比较复杂的页面，需要调用很多次后台接口，通过聚合一次完成，能够提升性能。\n\n但是不建议所有接口都走聚合层，没有必要，事实上现在很多公司的聚合层都是由前端通过node.js自己来做的，后端只负责细粒度的服务接口。这样的好处是分工明确，职责清晰，前端自己分析自己优化自己来设计聚合接口","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621389191,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288838,"user_name":"prader26","can_delete":false,"product_type":"c1","uid":1433707,"ip_address":"","ucode":"5EFFFC374ADECE","user_header":"https://static001.geekbang.org/account/avatar/00/15/e0/6b/f61d7466.jpg","comment_is_top":false,"comment_ctime":1618724619,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1618724619","product_id":100006601,"comment_content":"可以三个人开发一个微服务<br>拆分系统，的方法:<br>1. 基于业务逻辑拆分<br>2. 基于可扩展拆分<br>3. 基于可靠性拆分<br>4. 基于性能拆分<br><br>二 微服务搭建的步骤<br>，我建议按照下面优先级来搭建基础设施：<br>1. 服务发现、服务路由、服务容错：这是最基本的微服务基础设施。<br>2. 接口框架、API 网关：主要是为了提升开发效率，接口框架是提升内部服务的开发效率，API 网关是为了提升与外部服务对接的效率。<br>3. 自动化部署、自动化测试、配置中心：主要是为了提升测试和运维效率。<br>4. 服务监控、服务跟踪、服务安全：主要是为了进一步提升运维效率。<br>","like_count":0},{"had_liked":false,"id":288079,"user_name":"梦倚栏杆","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1618291375,"is_pvip":false,"replies":[{"id":"104617","content":"可能叫“服务拆分”更好，没有配套设施的微服务都是假的微服务 ：）","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1618369942,"ip_address":"","comment_id":288079,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1618291375","product_id":100006601,"comment_content":"我都怀疑我们的是不是微服务了，更像是按照模块拆分之后好维护而已","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518509,"discussion_content":"可能叫“服务拆分”更好，没有配套设施的微服务都是假的微服务 ：）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618369942,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288077,"user_name":"梦倚栏杆","can_delete":false,"product_type":"c1","uid":1095857,"ip_address":"","ucode":"BDEB97F2822445","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/bvj76PmeUvW8kokyu91IZWuRATKmabibDWbzAj2TajeEic7WvKCJOLaOh6jibEmdQ36EO3sBUZ0HibAiapsrZo64U8w/132","comment_is_top":false,"comment_ctime":1618291204,"is_pvip":false,"replies":[{"id":"104616","content":"配置中心主要作用由：<br>1. 避免手工修改，尤其是机器数量多了后<br>2. 配置自动校验，避免人工出错<br>3. 配置备份恢复，故障处理的时候很方便","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1618369902,"ip_address":"","comment_id":288077,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1618291204","product_id":100006601,"comment_content":"对比老师提到的几个点：<br>服务的拆分：大部分是按照业务逻辑拆分，少量有基于性能拆分的。还有一些实在学习实践领域模型拆分的，拆的有点多了，领域的概念一划分，服务数量一下子就上来了<br>基础设施：<br>服务路由，我们是通过一个统一的网关调用的；没有熔断功能，只是看写代码的健壮性，对依赖服务的容错性。配置中心：我们有，以环境project唯维度管理，但感觉还好：不经常改变的配置，偶尔上子次线也没啥，经常改动的配置给业务做一个界面，存入数据库，get不到配置中心的优点了","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518508,"discussion_content":"配置中心主要作用由：\n1. 避免手工修改，尤其是机器数量多了后\n2. 配置自动校验，避免人工出错\n3. 配置备份恢复，故障处理的时候很方便","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618369902,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286423,"user_name":"good boby","can_delete":false,"product_type":"c1","uid":2387358,"ip_address":"","ucode":"1471E2E499412C","user_header":"https://static001.geekbang.org/account/avatar/00/24/6d/9e/6a82a5ea.jpg","comment_is_top":false,"comment_ctime":1617290830,"is_pvip":false,"replies":[{"id":"104054","content":"当前微服务基础设施一般不会影响微服务划分，如果不够，就完善基础设施；<br><br>如果运维说现在微服务基础设施不健全，先划分少一些，这个一般情况下可能会被喷，因为后面如果有要拆的话，成本也不小 ：）<br>其实运维如果稍微有进取心，会非常希望完善和强大运维的基础设施的，而不会把这个作为限制架构的一个条件。","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1617327426,"ip_address":"","comment_id":286423,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617290830","product_id":100006601,"comment_content":"感谢老师，上面微服务的划分写的非常详细，从根据业务划分微服务，根据扩展性划分微服务，根据可靠性与性能划分微服务，再将团队成员考虑进来，但是个人感觉还遗漏了一个维度。例如当前基础设施情况与运维团队情况。微服务划分越多，对于基础实施要求越高，运维复杂度和成本越高。例如20个微服务和100个微服务，说需要的集成设施和运维人员配置要求肯定不一样。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517982,"discussion_content":"当前微服务基础设施一般不会影响微服务划分，如果不够，就完善基础设施；\n\n如果运维说现在微服务基础设施不健全，先划分少一些，这个一般情况下可能会被喷，因为后面如果有要拆的话，成本也不小 ：）\n其实运维如果稍微有进取心，会非常希望完善和强大运维的基础设施的，而不会把这个作为限制架构的一个条件。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617327426,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":286252,"user_name":"超斌hello","can_delete":false,"product_type":"c1","uid":2081401,"ip_address":"","ucode":"DA41E2C19B51F8","user_header":"https://static001.geekbang.org/account/avatar/00/1f/c2/79/fbc18da4.jpg","comment_is_top":false,"comment_ctime":1617231179,"is_pvip":false,"replies":[{"id":"104049","content":"可以合并，但是合并的难度比拆分更大，如果你们后面还会加人的话，就不要合并，即使就是你们4个人，最好也不要合并，因为就算合并带来的价值也不明显，除非能合并成4个，但那样的话投入的合并工作量会很大。","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1617326524,"ip_address":"","comment_id":286252,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617231179","product_id":100006601,"comment_content":"我们是电商，4个开发人，分了13个微服务。。。<br>“一个服务出问题，团队没有备份”这个问题比较突出。。<br><br>1. 不过现在合并也不行吧<br>2. 只能让其他人看能不能学习了","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517921,"discussion_content":"可以合并，但是合并的难度比拆分更大，如果你们后面还会加人的话，就不要合并，即使就是你们4个人，最好也不要合并，因为就算合并带来的价值也不明显，除非能合并成4个，但那样的话投入的合并工作量会很大。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617326524,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285652,"user_name":"恐龙","can_delete":false,"product_type":"c1","uid":1323030,"ip_address":"","ucode":"7B85A27E40D261","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/16/4773d604.jpg","comment_is_top":false,"comment_ctime":1616941360,"is_pvip":false,"replies":[{"id":"103686","content":"日志中心不属于微服务特有的基础设施","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1617013388,"ip_address":"","comment_id":285652,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1616941360","product_id":100006601,"comment_content":"补充一个问题，基础设施里不需要日志中心吗？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517741,"discussion_content":"日志中心不属于微服务特有的基础设施","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617013388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":279294,"user_name":"太子长琴","can_delete":false,"product_type":"c1","uid":1090266,"ip_address":"","ucode":"0627D0FA370AD4","user_header":"https://static001.geekbang.org/account/avatar/00/10/a2/da/a8a32113.jpg","comment_is_top":false,"comment_ctime":1613711345,"is_pvip":false,"replies":[{"id":"101534","content":"k8s现在已经是行业标准了","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1613812664,"ip_address":"","comment_id":279294,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1613711345","product_id":100006601,"comment_content":"钟爱k8s","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515697,"discussion_content":"k8s现在已经是行业标准了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613812664,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278591,"user_name":"业余爱好者","can_delete":false,"product_type":"c1","uid":1482915,"ip_address":"","ucode":"A890935A982988","user_header":"https://static001.geekbang.org/account/avatar/00/16/a0/a3/8da99bb0.jpg","comment_is_top":false,"comment_ctime":1613115992,"is_pvip":false,"replies":[{"id":"101367","content":"可以这么理解，如果达到了阿里蚂蚁这种体量，首先会划分业务子域，例如交易域、支付域、营销域等，然后子域内会按照微服务继续拆分，例如交易域的订单、退款、退货等","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1613483145,"ip_address":"","comment_id":278591,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1613115992","product_id":100006601,"comment_content":"今天明白了微服务除了按照业务拆分，还可以按照稳定性，性能拆分。不是说微服务都是按照业务构建团队吗，其它的拆分方式是不是在业务体量不大的时候的一种折中方案？<br>","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515437,"discussion_content":"可以这么理解，如果达到了阿里蚂蚁这种体量，首先会划分业务子域，例如交易域、支付域、营销域等，然后子域内会按照微服务继续拆分，例如交易域的订单、退款、退货等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613483145,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277891,"user_name":"黄sir","can_delete":false,"product_type":"c1","uid":2068406,"ip_address":"","ucode":"247317A3BB19FD","user_header":"https://static001.geekbang.org/account/avatar/00/1f/8f/b6/9b978449.jpg","comment_is_top":false,"comment_ctime":1612661408,"is_pvip":false,"replies":[{"id":"100926","content":"那必然的，单体应用拆分为微服务后，数据肯定也要跟着拆分。<br><br>但是，这样的一个应用，为何要拆分微服务呢？用户数过百，那么性能可靠性业务压力都不会有问题呀，拆分微服务看不到有什么明显的好处。","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1612757196,"ip_address":"","comment_id":277891,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612661408","product_id":100006601,"comment_content":"老师，我有个在线的SaaS系统，用户数过百，单体应用，目前有400张表左右。为了性能，当初设计为一个用户一个库，作微服务改造的话，数据库拆分后，是不是就应该是一个用户多个库了？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515204,"discussion_content":"那必然的，单体应用拆分为微服务后，数据肯定也要跟着拆分。\n\n但是，这样的一个应用，为何要拆分微服务呢？用户数过百，那么性能可靠性业务压力都不会有问题呀，拆分微服务看不到有什么明显的好处。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612757196,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":255561,"user_name":"flyCoder","can_delete":false,"product_type":"c1","uid":1074897,"ip_address":"","ucode":"82FB7B60775978","user_header":"https://static001.geekbang.org/account/avatar/00/10/66/d1/8664c464.jpg","comment_is_top":false,"comment_ctime":1603372905,"is_pvip":true,"replies":[{"id":"93163","content":"微服务刚起来的时候很多人都没有意识到，一窝蜂的冲上去拆系统������","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1603422209,"ip_address":"","comment_id":255561,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1603372905","product_id":100006601,"comment_content":"微服务的运维是一个大坑，如果基础系统没有做全，真的就是焦油坑","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507753,"discussion_content":"微服务刚起来的时候很多人都没有意识到，一窝蜂的冲上去拆系统������","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603422209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252609,"user_name":"escray","can_delete":false,"product_type":"c1","uid":1020525,"ip_address":"","ucode":"1F4204930E47C4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/92/6d/becd841a.jpg","comment_is_top":false,"comment_ctime":1602399676,"is_pvip":true,"replies":[{"id":"92534","content":"用最成熟的非Spring莫属","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1602672160,"ip_address":"","comment_id":252609,"utype":1}],"discussion_count":1,"race_medal":2,"score":"1602399676","product_id":100006601,"comment_content":"3 个人负责开发一个微服务，每个微服务由 2 个人负责维护，的确是一个很好的人力资源配置标准。<br><br>微服务可以按照业务逻辑（其实是按照团队规模？）以及可扩展、高可用、高性能（架构设计三原则？）来拆分。<br><br>微服务所需要的基础设施确实比较多，但是搭建了微服务基础设施之后，应该是可以重复利用的——一次搭建，多处使用。<br><br>文中给出的微服务基础设施优先级很有帮助，而且老师似乎是比较推崇 Spring Cloud 全家桶的，不知道还有没有其他的微服务开发框架？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506815,"discussion_content":"用最成熟的非Spring莫属","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602672160,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244283,"user_name":"piboye","can_delete":false,"product_type":"c1","uid":1066752,"ip_address":"","ucode":"7CFD8712857A85","user_header":"https://static001.geekbang.org/account/avatar/00/10/47/00/3202bdf0.jpg","comment_is_top":false,"comment_ctime":1598450563,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1598450563","product_id":100006601,"comment_content":"3个人做一个app的后台，按3个火枪手就没办法拆了😹","like_count":0},{"had_liked":false,"id":228190,"user_name":"Jaime","can_delete":false,"product_type":"c1","uid":1078333,"ip_address":"","ucode":"904192CC4E916F","user_header":"https://static001.geekbang.org/account/avatar/00/10/74/3d/54bbc1df.jpg","comment_is_top":false,"comment_ctime":1592583831,"is_pvip":true,"replies":[{"id":"84349","content":"你这个思路是说网关通过http访问微服务，微服务来完成转换？这样性能太低了。通常的做法是制定标准，然后按照标准转化，网关不应该理解实际的接口含义","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1592796023,"ip_address":"","comment_id":228190,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1592583831","product_id":100006601,"comment_content":"老师，问一问，如果在网关做协议转换，比如htpp到grpc的转换，没有办法做的自动转换的，我知想到了两个思路，一个是一大堆的reflect操作，一个是动态生成代码去映射，但都觉得好麻烦。目前有一个思路就是提供sdk给每个微服务端，然后在微服务端提供接口去做协议的转换和映射，不知道我这个想法对不对? 多谢老师了😬","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":498951,"discussion_content":"你这个思路是说网关通过http访问微服务，微服务来完成转换？这样性能太低了。通常的做法是制定标准，然后按照标准转化，网关不应该理解实际的接口含义","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592796023,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":218212,"user_name":"pding","can_delete":false,"product_type":"c1","uid":1093135,"ip_address":"","ucode":"F32DF066DE6BE0","user_header":"https://static001.geekbang.org/account/avatar/00/10/ae/0f/5c4efe46.jpg","comment_is_top":false,"comment_ctime":1589759853,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589759853","product_id":100006601,"comment_content":"服务拆分，需要。考虑系统的稳定、快速迭代","like_count":0},{"had_liked":false,"id":201608,"user_name":"Geek_7389a6","can_delete":false,"product_type":"c1","uid":1905516,"ip_address":"","ucode":"8A8ED1E0128F3F","user_header":"","comment_is_top":false,"comment_ctime":1585811199,"is_pvip":false,"replies":[{"id":"75497","content":"自己搜一下？","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1585890476,"ip_address":"","comment_id":201608,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585811199","product_id":100006601,"comment_content":"在评论中看到了很多次Spring Cloud全家桶，很好奇都包含哪些内容，分别如何应用？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490376,"discussion_content":"自己搜一下？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585890476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130092,"user_name":"钱","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1567385594,"is_pvip":false,"replies":[{"id":"49157","content":"全链路压测呀，但是成本高","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1567597260,"ip_address":"","comment_id":130092,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567385594","product_id":100006601,"comment_content":"课后思考及问题<br>1：道理都是相通的，虽然是华仔自己思考和总结的，不过和胡忠想老师讲的异曲同工，并且他讲的更加细致，专栏定位不同吧!<br>老师所提的这些基础服务目前的公司基本都有，要说提升自己到是需要多多提升，因为有人运维和和研发，作为业务开发时间多花在了业务开发的细节上了，这也是公司这么安排的目的，不过作为业务研发再出去找工作就处于劣势位置了，中间件是各种使用都OK，不过里面的实现细节却不太清楚。<br>另外，压测时是有痛点的，特别是微服务的使用赖外部服务较多的接口压测时疼得更厉害。不能压到其他系统，但又不得不依赖 ，只能自己模拟一下外部接口。所以，每逢大促必压测必痛一次。不知老师针对这种情况，有什么更好的方式？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465798,"discussion_content":"全链路压测呀，但是成本高","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567597260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":94081,"user_name":"jacky","can_delete":false,"product_type":"c1","uid":1049177,"ip_address":"","ucode":"A0BD06E2ABF520","user_header":"https://static001.geekbang.org/account/avatar/00/10/02/59/989f65c8.jpg","comment_is_top":false,"comment_ctime":1557715991,"is_pvip":false,"replies":[{"id":"33791","content":"按照业务可以分的很细，不一定是5个","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1557837787,"ip_address":"","comment_id":94081,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1557715991","product_id":100006601,"comment_content":"服务粒度控制有内在的划分方法，如果加入团队人数去指导划分会不会出现自相矛盾。比如按照业务、可扩展来划分的话有5个服务。但是人只有9个人，是不是要把原来的5个服务压缩成3个？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":449906,"discussion_content":"按照业务可以分的很细，不一定是5个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1557837787,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":87271,"user_name":"花花大脸猫","can_delete":false,"product_type":"c1","uid":1117318,"ip_address":"","ucode":"8ABDB3F7F4FB0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","comment_is_top":false,"comment_ctime":1555555910,"is_pvip":true,"replies":[{"id":"31424","content":"合并微服务是最有效的","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1555598158,"ip_address":"","comment_id":87271,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1555555910","product_id":100006601,"comment_content":"我们现在的微服务是基于业务进行拆分的，基本是一个人对接3-4个微服务项目，当时拆的时候根本没有考虑人员的实际情况，目前的微服务已经开始有烂的迹象了（三个火枪手的原则现在来看确实是太形象生动）！看了下老师这篇文章，感觉现在要么是招人（人月神话中添加人手指不定是好是坏），要么是需要对服务进行整理合并，另外基础设施目前只接入了1和2两个。请问老师现在这种情况您这边有什么好的建议么？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":447375,"discussion_content":"合并微服务是最有效的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1555598158,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":58446,"user_name":"包子","can_delete":false,"product_type":"c1","uid":1051996,"ip_address":"","ucode":"C82F8BDF4E3907","user_header":"https://static001.geekbang.org/account/avatar/00/10/0d/5c/ef42b1c1.jpg","comment_is_top":false,"comment_ctime":1547084376,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1547084376","product_id":100006601,"comment_content":"经常回顾，每次都有思考收获","like_count":0},{"had_liked":false,"id":22554,"user_name":"李勇","can_delete":false,"product_type":"c1","uid":1122136,"ip_address":"","ucode":"B5AE3D070D9269","user_header":"https://static001.geekbang.org/account/avatar/00/11/1f/58/ade4475d.jpg","comment_is_top":false,"comment_ctime":1535786277,"is_pvip":false,"replies":[{"id":"8195","content":"不是很明白这么做要解决什么问题，本来消息队列就有消费确认的功能，消费端可以直接消费成功后确认","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1535957102,"ip_address":"","comment_id":22554,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535786277","product_id":100006601,"comment_content":"老师，构建一个微服务作为消息处理中心，客户端先发送消息到kafka，然后消息处理中心根据配置消费Kafka集群消息，并以http形式投递消息到真实的消费端，消息中心会对消费失败的消息进行重新投递，请问这个有意义吗？相比消费端直接对接Kafka集群消费消息有什么不同？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":423159,"discussion_content":"不是很明白这么做要解决什么问题，本来消息队列就有消费确认的功能，消费端可以直接消费成功后确认","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535957102,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":22052,"user_name":"李峰","can_delete":false,"product_type":"c1","uid":1107209,"ip_address":"","ucode":"3DA3574DB432A2","user_header":"https://static001.geekbang.org/account/avatar/00/10/e5/09/ddabec76.jpg","comment_is_top":false,"comment_ctime":1535461981,"is_pvip":false,"replies":[{"id":"7993","content":"没法在数据库层面做，只能自己代码做，或者冗余数据来做join，例如统计报表类系统","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1535608892,"ip_address":"","comment_id":22052,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1535461981","product_id":100006601,"comment_content":"这种每个服务都是分开的库，数据join一般如何做？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422979,"discussion_content":"没法在数据库层面做，只能自己代码做，或者冗余数据来做join，例如统计报表类系统","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1535608892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16711,"user_name":"云辉","can_delete":false,"product_type":"c1","uid":1103058,"ip_address":"","ucode":"0E67E8E8421294","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/d2/96dbfa5a.jpg","comment_is_top":false,"comment_ctime":1532132097,"is_pvip":false,"replies":[{"id":"5818","content":"可以基于gRPC之类的制定自己的数据规范就是接口框架了","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1532174253,"ip_address":"","comment_id":16711,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1532132097","product_id":100006601,"comment_content":"华仔，接口框架是什么作用，有开源项目可以直接用的嘛？⚽️","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420905,"discussion_content":"可以基于gRPC之类的制定自己的数据规范就是接口框架了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532174253,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16446,"user_name":"Xg huang","can_delete":false,"product_type":"c1","uid":1016995,"ip_address":"","ucode":"9680FA95DE3553","user_header":"","comment_is_top":false,"comment_ctime":1531962572,"is_pvip":false,"replies":[{"id":"5694","content":"可以合在一起呀，如果只有三个开发人员，合在一起更好","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1531965400,"ip_address":"","comment_id":16446,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1531962572","product_id":100006601,"comment_content":"请教一下老师，即便有三个火枪手的原则，是不是也应该优先按照业务的边界做一层划分？例如:内容消费模块和社区模块，就至少是两个微服务，而不能因为只有三个开发人员就合并到一起？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420798,"discussion_content":"可以合在一起呀，如果只有三个开发人员，合在一起更好","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531965400,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16407,"user_name":"不吃番茄的西红柿","can_delete":false,"product_type":"c1","uid":1142465,"ip_address":"","ucode":"AC62CE8D23FACD","user_header":"https://static001.geekbang.org/account/avatar/00/11/6e/c1/e2cc1261.jpg","comment_is_top":false,"comment_ctime":1531927636,"is_pvip":false,"replies":[{"id":"5771","content":"没有太好方法，要么接口后向兼容，要么接口加版本号","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1532069141,"ip_address":"","comment_id":16407,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1531927636","product_id":100006601,"comment_content":"华仔，能否讲一下app多版本共存问题和解决思路呢","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420786,"discussion_content":"没有太好方法，要么接口后向兼容，要么接口加版本号","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532069141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16192,"user_name":"小橙橙","can_delete":false,"product_type":"c1","uid":1054923,"ip_address":"","ucode":"4F467210A15F66","user_header":"https://static001.geekbang.org/account/avatar/00/10/18/cb/edb5a0a0.jpg","comment_is_top":false,"comment_ctime":1531823376,"is_pvip":false,"replies":[{"id":"5620","content":"可以共用实例，别共用库","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1531877781,"ip_address":"","comment_id":16192,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1531823376","product_id":100006601,"comment_content":"老师，多个微服务会共用一个数据库实例吗，还是每个微服务都有独立的数据库绑定？","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420706,"discussion_content":"可以共用实例，别共用库","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531877781,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16150,"user_name":"gen_jin","can_delete":false,"product_type":"c1","uid":1118102,"ip_address":"","ucode":"E282DB98815F13","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/wBibtTTkiaGtcJ3qBeG4BnB4MmaurYf8hZTrXiczmvLHlRrqxJicRaoQPAZ0vw9HHd7yxDH27TLCzBQqqOqyGukw1g/132","comment_is_top":false,"comment_ctime":1531802177,"is_pvip":false,"replies":[{"id":"5587","content":"太多了，后面你们会发现会有很多问题","user_name":"作者回复","user_name_real":"华仔","uid":"1098920","ctime":1531810681,"ip_address":"","comment_id":16150,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1531802177","product_id":100006601,"comment_content":"我们项目刚开发了两个月，一个人负责开发4~5个位微服务。可能是开始业务不复杂。是不是有点多？没办法，人数少 考虑扩展性又想用微服务框架。","like_count":0,"discussions":[{"author":{"id":1098920,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c4/a8/f2685e1b.jpg","nickname":"华仔","note":"","ucode":"851FF94CF5133A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420689,"discussion_content":"太多了，后面你们会发现会有很多问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1531810681,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}