{"id":614570,"title":"05ï½œK8s æç®€å®æˆ˜ï¼šç¤ºä¾‹åº”ç”¨ä»‹ç»","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹ç‚œã€‚</p><p>ä¸Šä¸€ç« ï¼Œæˆ‘ä»¬ä»¥ä¸€ä¸ª Python åº”ç”¨ä¸ºä¾‹ï¼Œå­¦ä¹ äº†å°†åº”ç”¨è¿ç§»åˆ°äº‘åŸç”Ÿæ¶æ„ä¸‹çš„å®Œæ•´è¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯ä»å®¹å™¨åŒ–ã€éƒ¨ç½²åˆ° K8sã€å¼¹æ€§ä¼¸ç¼©æœ€ååˆ° GitOps çš„å…¨è¿‡ç¨‹ã€‚åœ¨å®æˆ˜çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘æ²¡æœ‰å¤ªå¤šåœ°ä»‹ç»æ¦‚å¿µï¼Œè€Œæ˜¯è®©ä½ ç›´æ¥ä¸Šæ‰‹æ„Ÿå— K8s å’Œ GitOps çš„å¼ºå¤§ä¹‹å¤„ã€‚</p><p>è¿™ä¸€ç« ï¼Œæˆ‘ä¼šè®¾è®¡ä¸€ä¸ªæ›´åŠ æ¥è¿‘çœŸå®ä¸šåŠ¡çš„ç¤ºä¾‹åº”ç”¨ã€‚è¿™ä¸ªåº”ç”¨ä¼šæ¶µç›–ä½ åœ¨å·¥ä½œä¸­å¸¸ç”¨çš„ K8s å¯¹è±¡ï¼ŒåŒ…æ‹¬ Deploymentã€Serviceã€Ingressã€HPAã€Namespaceã€ConfigMap ç­‰ã€‚åœ¨å°†è¿™ä¸ªåº”ç”¨éƒ¨ç½²åˆ° K8s çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šé€æ¸æ·±å…¥åˆ°æ¯ä¸ª K8s å¯¹è±¡ä¸­ã€‚</p><p>è¿™èŠ‚è¯¾ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹è¿™ä¸ªç¤ºä¾‹åº”ç”¨ã€‚</p><p>åœ¨å¼€å§‹å­¦ä¹ ä¹‹å‰ï¼Œä½ éœ€è¦åšå¥½ä»¥ä¸‹å‡†å¤‡ï¼š</p><ul>\n<li>å‡†å¤‡ä¸€å°ç”µè„‘ï¼ˆé¦–é€‰ Linux æˆ– macOSï¼ŒWindows ä¹Ÿé€‚ç”¨ï¼Œæ³¨æ„æ“ä½œå·®å¼‚ï¼‰ï¼›</li>\n<li><a href=\"https://docs.docker.com/engine/install/\">å®‰è£… Docker</a>ï¼›</li>\n<li><a href=\"https://kubernetes.io/docs/tasks/tools/\">å®‰è£… Kubectl</a>ï¼›</li>\n<li><a href=\"https://kind.sigs.k8s.io/docs/user/quick-start/#installation\">å®‰è£… Kind</a>ã€‚</li>\n</ul><h2>æ¶æ„ä»‹ç»</h2><h3>åº”ç”¨æ¶æ„</h3><p>æˆ‘è®¾è®¡çš„è¿™ä¸ªç¤ºä¾‹åº”ç”¨æ˜¯ä¸€å¥—å¾®æœåŠ¡æ¶æ„çš„åº”ç”¨ï¼Œä½ å¯ä»¥åœ¨ GitHub ä¸Šè·å–<a href=\"https://github.com/lyzhang1999/kubernetes-example\">æºç </a>ï¼Œæºç ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><pre><code class=\"language-powershell\">$ ls\nbackend&nbsp; deploy&nbsp; &nbsp;frontend\n</code></pre><p>åœ¨è¿™é‡Œï¼Œbackend ç›®å½•ä¸ºåç«¯æºç ï¼Œfrontend ç›®å½•ä¸ºå‰ç«¯æºç ï¼Œdeploy ç›®å½•æ˜¯åº”ç”¨çš„ K8s Manifestï¼Œå‰åç«¯éƒ½å·²ç»åŒ…å«æ„å»ºé•œåƒæ‰€éœ€çš„ Dockerfileã€‚</p><!-- [[[read_end]]] --><p>ç¤ºä¾‹åº”ç”¨ç”±ä¸‰ä¸ªæœåŠ¡ç»„æˆï¼š</p><ol>\n<li>å‰ç«¯ï¼›</li>\n<li>åç«¯ï¼›</li>\n<li>æ•°æ®åº“ã€‚</li>\n</ol><p>å…¶ä¸­ï¼Œå‰ç«¯é‡‡ç”¨ React ç¼–å†™ï¼Œå®ƒä¹Ÿæ˜¯åº”ç”¨å¯¹å¤–æä¾›æœåŠ¡çš„å…¥å£ï¼›åç«¯ç”± Python ç¼–å†™ï¼›æ•°æ®åº“é‡‡ç”¨æµè¡Œçš„ Postgresã€‚åº”ç”¨æ•´ä½“æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/e4/e0/e47ayy03e7a3a6429c6c5b404133ede0.jpg?wh=1920x1074\" alt=\"å›¾ç‰‡\"></p><p>å‰ç«¯å®ç°äº†ä¸‰ä¸ªåŠŸèƒ½ï¼Œåˆ†åˆ«æ˜¯å­˜å‚¨è¾“å…¥çš„å†…å®¹ï¼Œåˆ—å‡ºè¾“å…¥å†…å®¹è®°å½•ä»¥åŠåˆ é™¤æ‰€æœ‰çš„è®°å½•ã€‚è¿™ä¸‰ä¸ªåŠŸèƒ½åˆ†åˆ«å¯¹åº”äº†åç«¯çš„ä¸‰ä¸ªæ¥å£ï¼Œä¹Ÿå°±æ˜¯ /add, /fetch å’Œ /deleteï¼Œæœ€åæ•°æ®ä¼šè¢«å­˜å‚¨åœ¨ Postgres æ•°æ®åº“ä¸­ã€‚</p><p>ç¤ºä¾‹åº”ç”¨çš„å‰ç«¯ç•Œé¢å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/4d/af/4d24857b5b97a1c8e7629198c8f379af.png?wh=1920x1172\" alt=\"å›¾ç‰‡\"></p><h3>K8s éƒ¨ç½²æ¶æ„</h3><p>ä¸ºäº†æ–¹ä¾¿ä½ æŠŠç¤ºä¾‹åº”ç”¨ç›´æ¥éƒ¨ç½²åˆ° K8s é›†ç¾¤å†…ï¼Œæˆ‘å·²ç»å†™å¥½äº† K8s Manifest æ–‡ä»¶ï¼Œä½ å¯ä»¥åœ¨ <a href=\"https://github.com/lyzhang1999/kubernetes-example/tree/main/deploy\">GitHub</a> æ‰¾åˆ°è¿™äº›æ¸…å•æ–‡ä»¶ã€‚åº”ç”¨çš„ K8s éƒ¨ç½²æ¶æ„å›¾å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/f1/56/f1e65380bb2342676024341b034f0e56.jpg?wh=1920x1001\" alt=\"å›¾ç‰‡\"></p><p>åœ¨è¿™å¼ æ¶æ„å›¾ä¸­ï¼ŒIngress æ˜¯åº”ç”¨çš„å…¥å£ï¼ŒIngress ä¼šæ ¹æ®è¯·æ±‚è·¯å¾„å°†æµé‡åˆ†æµè‡³å‰åç«¯çš„ Service ä¸­ï¼Œç„¶å Service å°†è¯·æ±‚è½¬å‘ç»™å‰åç«¯ Pod è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œåç«¯çš„å·¥ä½œè´Ÿè½½ Deployment é…ç½®äº† HPA è‡ªåŠ¨æ¨ªå‘æ‰©å®¹ã€‚åŒæ—¶ï¼ŒPostgres ä¹Ÿæ˜¯ä»¥ Deployment çš„æ–¹å¼éƒ¨ç½²åˆ°é›†ç¾¤å†…çš„ã€‚æœ€åï¼Œæ‰€æœ‰èµ„æºéƒ½éƒ¨ç½²åœ¨ K8s çš„ example å‘½åç©ºé—´ï¼ˆNamespaceï¼‰ä¸‹ã€‚</p><p>åœ¨ç†Ÿæ‚‰äº†åº”ç”¨æ¶æ„ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æŠŠå®ƒéƒ¨ç½²åˆ° K8s é›†ç¾¤å†…ã€‚</p><h2>éƒ¨ç½²åº”ç”¨</h2><h3>åˆ›å»ºæ–°çš„ K8s é›†ç¾¤</h3><p>æˆ‘ä»¬è¿˜æ˜¯ä»¥éƒ¨ç½²åˆ°æœ¬åœ° Kind é›†ç¾¤ä¸ºä¾‹ï¼Œä¸ºäº†é¿å…èµ„æºå†²çªï¼Œéœ€è¦å…ˆæŠŠç¬¬ä¸€ç« å®éªŒè¿‡ç¨‹åˆ›å»ºçš„ Kind é›†ç¾¤åˆ æ‰ã€‚ä½ å¯ä»¥ç”¨ kind delete cluster æ¥åˆ é™¤é›†ç¾¤ï¼š</p><pre><code class=\"language-powershell\">$ kind delete cluster\n</code></pre><p>ç„¶åï¼Œé‡æ–°åˆ›å»ºä¸€ä¸ª K8s é›†ç¾¤ï¼Œå°†ä¸‹é¢çš„å†…å®¹ä¿å­˜ä¸º config.yamlï¼š</p><pre><code class=\"language-yaml\">kind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n  kubeadmConfigPatches:\n  - |\n    kind: InitConfiguration\n    nodeRegistration:\n      kubeletExtraArgs:\n        node-labels: \"ingress-ready=true\"\n  extraPortMappings:\n  - containerPort: 80\n    hostPort: 80\n    protocol: TCP\n  - containerPort: 443\n    hostPort: 443\n    protocol: TCP\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ kind create cluster é‡æ–°åˆ›å»ºé›†ç¾¤ï¼š</p><pre><code class=\"language-yaml\">â¯ kind create cluster --config config.yaml\nCreating cluster \"kind\" ...\n âœ“ Ensuring node image (kindest/node:v1.23.4) ğŸ–¼\n âœ“ Preparing nodes ğŸ“¦  \n âœ“ Writing configuration ğŸ“œ \n âœ“ Starting control-plane ğŸ•¹ï¸ \n âœ“ Installing CNI ğŸ”Œ \n âœ“ Installing StorageClass ğŸ’¾ \nSet kubectl context to \"kind-kind\"\nYou can now use your cluster with:\n\nkubectl cluster-info --context kind-kind\n</code></pre><p>ç”±äºç¤ºä¾‹åº”ç”¨ä½¿ç”¨äº† Ingressï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸º Kind éƒ¨ç½² Ingressï¼Œä½ å¯ä»¥ä½¿ç”¨ kubectl apply -f æ¥éƒ¨ç½² Ingress-Nginxï¼š</p><pre><code class=\"language-powershell\">$ kubectl create -f https://ghproxy.com/https://raw.githubusercontent.com/lyzhang1999/resource/main/ingress-nginx/ingress-nginx.yaml\nnamespace/ingress-nginx created\nserviceaccount/ingress-nginx created\nserviceaccount/ingress-nginx-admission created\n......\n</code></pre><p>æœ€åï¼Œå†éƒ¨ç½² Metric Serverï¼Œä»¥ä¾¿å¼€å¯ HPA åŠŸèƒ½ï¼š</p><pre><code class=\"language-powershell\">$ kubectl apply -f https://ghproxy.com/https://raw.githubusercontent.com/lyzhang1999/resource/main/metrics/metrics.yaml\nserviceaccount/metrics-server created\nclusterrole.rbac.authorization.k8s.io/system:aggregated-metrics-reader created\nclusterrole.rbac.authorization.k8s.io/system:metrics-server created\n......\n</code></pre><p><strong>å‡†å¤‡å¥½æ–°çš„ K8s é›†ç¾¤åï¼Œå°±å¯ä»¥å¼€å§‹éƒ¨ç½²ç¤ºä¾‹åº”ç”¨äº†ã€‚</strong></p><h3>éƒ¨ç½²ç¤ºä¾‹åº”ç”¨</h3><p>æˆ‘ä»¬æŠŠç¤ºä¾‹åº”ç”¨æ‰€æœ‰çš„èµ„æºéƒ½éƒ¨ç½²åœ¨ä¸€ä¸ªæ–°çš„å‘½åç©ºé—´ä¸‹ï¼Œæ–°çš„å‘½åç©ºé—´å‘½åä¸º exampleã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦åˆ›å»ºè¯¥å‘½åç©ºé—´ï¼Œä½ å¯ä»¥ä½¿ç”¨ kubectl create namespace æ¥åˆ›å»ºå‘½åç©ºé—´ï¼š</p><pre><code class=\"language-powershell\">$ kubectl create namespace example\nnamespace/example created\n</code></pre><p>ç„¶åï¼Œåˆ›å»º Postgres æ•°æ®åº“ï¼ŒåŒæ ·ä½¿ç”¨ kubectl apply æ¥åˆ›å»ºï¼š</p><pre><code class=\"language-powershell\">$ kubectl apply -f https://ghproxy.com/https://raw.githubusercontent.com/lyzhang1999/kubernetes-example/main/deploy/database.yaml -n example\nconfigmap/pg-init-script created\ndeployment.apps/postgres created\nservice/pg-service created\n</code></pre><p>åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œ-n å‚æ•°ä»£è¡¨æŒ‡å®šå‘½åç©ºé—´ï¼Œä¹Ÿå°±æ˜¯ example å‘½åç©ºé—´ï¼Œ<strong>æ³¨æ„ï¼Œåç»­åˆ›å»ºèµ„æºæ—¶éƒ½éœ€è¦æŒ‡å®šè¿™ä¸ªå‘½åç©ºé—´ã€‚</strong></p><p>ç„¶åå†åˆ†åˆ«åˆ›å»ºå‰åç«¯ Deployment å·¥ä½œè´Ÿè½½å’Œ Serviceï¼š</p><pre><code class=\"language-powershell\">$ kubectl apply -f https://ghproxy.com/https://raw.githubusercontent.com/lyzhang1999/kubernetes-example/main/deploy/frontend.yaml -n example\ndeployment.apps/frontend created\nservice/frontend-service created\n\n$ kubectl apply -f https://ghproxy.com/https://raw.githubusercontent.com/lyzhang1999/kubernetes-example/main/deploy/backend.yaml -n example\ndeployment.apps/backend created\nservice/backend-service created\n</code></pre><p>æ¥ä¸‹æ¥ï¼Œä¸ºåº”ç”¨åˆ›å»º Ingress å’Œ HPA ç­–ç•¥ï¼š</p><pre><code class=\"language-powershell\">$ kubectl apply -f https://ghproxy.com/https://raw.githubusercontent.com/lyzhang1999/kubernetes-example/main/deploy/ingress.yaml -n example\ningress.networking.k8s.io/frontend-ingress created\n\n$ kubectl apply -f https://ghproxy.com/https://raw.githubusercontent.com/lyzhang1999/kubernetes-example/main/deploy/hpa.yaml -n example\nhorizontalpodautoscaler.autoscaling/backend created\n</code></pre><p>å…¶å®ï¼Œé™¤äº†å¯ä»¥æŒ‰ç…§ä¸Šé¢çš„å¼•å¯¼å•ç‹¬åˆ›å»ºç¤ºä¾‹åº”ç”¨çš„æ¯ä¸€ä¸ª K8s å¯¹è±¡ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹æ³•ï¼Œé‚£å°±æ˜¯æŠŠè¿™ä¸ª Git ä»“åº“å…‹éš†åˆ°æœ¬åœ°ï¼Œç„¶åä½¿ç”¨ kubectl apply <strong>ä¸€æ¬¡æ€§å°†æ‰€æœ‰ç¤ºä¾‹åº”ç”¨çš„å¯¹è±¡</strong>éƒ¨ç½²åˆ°é›†ç¾¤å†…ï¼š</p><pre><code class=\"language-yaml\">$ git clone https://ghproxy.com/https://github.com/lyzhang1999/kubernetes-example &amp;&amp; cd kubernetes-example\nCloning into 'kubernetes-example'...\n......\nResolving deltas: 100% (28/28), done.\n\n$ kubectl apply -f deploy -n example\ndeployment.apps/backend created\nservice/backend-service created\nconfigmap/pg-init-script created\n......\n</code></pre><p>è¿™é‡Œçš„ -f å‚æ•°é™¤äº†å¯ä»¥æŒ‡å®šæ–‡ä»¶å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šç›®å½•ï¼Œkubectl å°†ä¼šæ£€æŸ¥ç›®å½•ä¸‹æ‰€æœ‰å¯ç”¨çš„ Manifestï¼Œç„¶åæŠŠå®ƒéƒ¨ç½²åˆ° K8s é›†ç¾¤ã€‚-n å‚æ•°ä»£è¡¨å°†æ‰€æœ‰ Manifest éƒ¨ç½²åˆ° example å‘½åç©ºé—´ã€‚</p><p>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ kubectl wait æ¥æ£€æŸ¥æ‰€æœ‰èµ„æºæ˜¯ä¸æ˜¯å·²ç»å¤„äº Ready çŠ¶æ€äº†ï¼š</p><pre><code class=\"language-powershell\">$ kubectl wait --for=condition=Ready pods --all -n example\npod/backend-9b677898b-n5lsm condition met\npod/frontend-f948bdc85-q6x9f condition met\npod/postgres-7745b57d5d-f4trt condition met\n</code></pre><p><strong>åˆ°è¿™é‡Œï¼Œç¤ºä¾‹åº”ç”¨å°±éƒ¨ç½²å®Œäº†ã€‚</strong></p><p>æ‰“å¼€æµè§ˆå™¨è®¿é—® 127.0.0.1ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°ç¤ºä¾‹åº”ç”¨çš„å‰ç«¯ç•Œé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/4d/07/4dae13ff82229226916b7b767d6a5007.png?wh=1920x1190\" alt=\"å›¾ç‰‡\"></p><p>ä½ å¯ä»¥å°è¯•åœ¨è¾“å‡ºæ¡†ä¸­è¾“å…¥å†…å®¹ï¼Œå¦‚æœç‚¹å‡» Add æŒ‰é’®ï¼Œä¸‹æ–¹çš„åˆ—è¡¨å†…ä¼šå‡ºç°ä½ è¾“å…¥çš„å†…å®¹ï¼Œç‚¹å‡» Clear æ‰€æœ‰å†…å®¹è¢«æ¸…ç©ºï¼Œè¿™å°±è¯´æ˜åº”ç”¨å·²ç»å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚</p><h2>K8s å¯¹è±¡è§£æ</h2><p>åœ¨è¿™ä¸ªç¤ºä¾‹åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å‘½åç©ºé—´æ¥éƒ¨ç½²æ‰€æœ‰èµ„æºï¼Œè¿™ä¸ªå‘½åç©ºé—´æ˜¯ exampleã€‚</p><p>æ­¤å¤–ï¼Œç¤ºä¾‹åº”ç”¨æ¶‰åŠåˆ°çš„èµ„æºæ¯”è¾ƒå¤šï¼Œä¸ºäº†æ›´æ¸…æ¥šåœ°æ¢³ç†å®ƒä»¬ä¹‹é—´çš„é€»è¾‘å…³ç³»ï¼Œæˆ‘ç»™ä½ ç®€å•åœ°æ€»ç»“ä¸€ä¸‹ã€‚</p><p>é¦–å…ˆï¼Œä½ å¯ä»¥ä½¿ç”¨ kubectl get all æ¥æŸ¥çœ‹æŸä¸ªå‘½åç©ºé—´ä¸‹çš„æ‰€æœ‰èµ„æºï¼š</p><pre><code class=\"language-powershell\">â¯ kubectl get all -n example\nNAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; READY&nbsp; &nbsp;STATUS&nbsp; &nbsp; RESTARTS&nbsp; &nbsp;AGE\npod/backend-648ff85f48-8qgjg&nbsp; &nbsp; 1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 29s\npod/backend-648ff85f48-f845h&nbsp; &nbsp; 1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 51s\npod/frontend-7b55cc5c67-4svjz&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14s\npod/frontend-7b55cc5c67-9cx57&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 14s\npod/postgres-7745b57d5d-f4trt&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;Running&nbsp; &nbsp;0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 44m\n\nNAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TYPE&nbsp; &nbsp; &nbsp; &nbsp; CLUSTER-IP&nbsp; &nbsp; &nbsp; EXTERNAL-IP&nbsp; &nbsp;PORT(S)&nbsp; &nbsp; AGE\nservice/backend-service&nbsp; &nbsp; ClusterIP&nbsp; &nbsp;10.96.244.140&nbsp; &nbsp;&lt;none&gt;&nbsp; &nbsp; &nbsp; &nbsp; 5000/TCP&nbsp; &nbsp;42m\nservice/frontend-service&nbsp; &nbsp;ClusterIP&nbsp; &nbsp;10.96.85.54&nbsp; &nbsp; &nbsp;&lt;none&gt;&nbsp; &nbsp; &nbsp; &nbsp; 3000/TCP&nbsp; &nbsp;43m\nservice/pg-service&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ClusterIP&nbsp; &nbsp;10.96.166.74&nbsp; &nbsp; &lt;none&gt;&nbsp; &nbsp; &nbsp; &nbsp; 5432/TCP&nbsp; &nbsp;44m\n\nNAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;READY&nbsp; &nbsp;UP-TO-DATE&nbsp; &nbsp;AVAILABLE&nbsp; &nbsp;AGE\ndeployment.apps/backend&nbsp; &nbsp; 2/2&nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;42m\ndeployment.apps/frontend&nbsp; &nbsp;2/2&nbsp; &nbsp; &nbsp;4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;43m\ndeployment.apps/postgres&nbsp; &nbsp;1/1&nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;44m\n\nNAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DESIRED&nbsp; &nbsp;CURRENT&nbsp; &nbsp;READY&nbsp; &nbsp;AGE\nreplicaset.apps/backend-648ff85f48&nbsp; &nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp;51s\nreplicaset.apps/frontend-7b55cc5c67&nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp;54s\nreplicaset.apps/postgres-7745b57d5d&nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1&nbsp; &nbsp; &nbsp; &nbsp;44m\n\nNAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;REFERENCE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TARGETS&nbsp; &nbsp; MINPODS&nbsp; &nbsp;MAXPODS&nbsp; &nbsp;REPLICAS&nbsp; &nbsp;AGE\nhorizontalpodautoscaler.autoscaling/backend&nbsp; &nbsp; Deployment/backend&nbsp; &nbsp; 0%/50%&nbsp; &nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10&nbsp; &nbsp; &nbsp; &nbsp; 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8m17s\nhorizontalpodautoscaler.autoscaling/frontend&nbsp; &nbsp;Deployment/frontend&nbsp; &nbsp;51%/80%&nbsp; &nbsp;2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;10&nbsp; &nbsp; &nbsp; &nbsp; 10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;8m17s\n</code></pre><p>-n å‚æ•°è¡¨ç¤ºæŒ‡å®šä¸€ä¸ªå‘½åç©ºé—´ï¼Œä»è¿”å›ç»“æœå¯ä»¥çœ‹å‡ºï¼Œç¤ºä¾‹åº”ç”¨ä¸€å…±åˆ›å»ºäº† 5 ä¸ª Podã€3 ä¸ª Serviceã€3 ä¸ª Deploymentã€3 ä¸ª Replicasetã€2 ä¸ª HPAï¼Œæ˜¯ä¸æ˜¯å¯¹æœ‰äº›æ¦‚å¿µæœ‰ç‚¹é™Œç”Ÿå‘¢ï¼Ÿåˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬è¿˜ä¼šåœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹ä¸­è¯¦ç»†ä»‹ç»ã€‚</p><h2>æ€»ç»“</h2><p>åœ¨è¿™èŠ‚è¯¾ï¼Œæˆ‘ä¸ºä½ å‡†å¤‡äº†ä¸€ä¸ªç¤ºä¾‹åº”ç”¨ï¼Œå¹¶å¼•å¯¼ä½ åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æœ¬åœ° Kind é›†ç¾¤ï¼Œè¿˜å®Œæˆäº†éƒ¨ç½²çš„æ“ä½œã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä»‹ç»äº†åº”ç”¨æ•´ä½“çš„æ¶æ„è®¾è®¡ï¼ŒåŒ…æ‹¬ä¸šåŠ¡æ¶æ„å’Œ K8s éƒ¨ç½²æ¶æ„ã€‚</p><p>ç¤ºä¾‹åº”ç”¨ä¸»è¦ä»çœŸå®é¡¹ç›®å‡ºå‘ï¼Œåœ¨æˆ‘ä»¬è¿™ä¸ªåº”ç”¨é‡Œå‡ºç°çš„å¤§å¤šæ•° K8s å¯¹è±¡ï¼Œä½ ä¹Ÿä¼šåœ¨å®é™…å·¥ä½œä¸­ç”¨åˆ°å®ƒä»¬ï¼ŒæŒæ¡å®ƒä»¬æœ‰åŠ©äºä½ æŠŠçœŸå®çš„åº”ç”¨è¿ç§»åˆ° K8sã€‚åœ¨æ¥ä¸‹æ¥çš„è¯¾ç¨‹é‡Œï¼Œæˆ‘ä¼šä»è¿™ä¸ªç¤ºä¾‹åº”ç”¨å‡ºå‘ï¼Œä¸ºä½ è¯¦ç»†ä»‹ç»è¿™é‡Œå‡ºç°çš„æ¯ä¸€ä¸ª K8s å¯¹è±¡ç±»å‹ï¼Œä¸ºæœªæ¥çš„ GitOps è¯¾ç¨‹æ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚</p><h2>æ€è€ƒé¢˜</h2><p>æœ€åï¼Œç»™ä½ ç•™ä¸€é“æ€è€ƒé¢˜å§ã€‚</p><p>è¯·ä½ å°è¯•åœ¨ç¤ºä¾‹åº”ç”¨ä¸­æ·»åŠ ä¸€äº›æ•°æ®ï¼Œç„¶åä½¿ç”¨ kubectl delete pod åˆ é™¤ Postgres çš„ Podï¼Œåˆ é™¤å K8s å°†ä¼šé‡æ–°åˆ›å»º Podï¼Œè¯·ä½ è§‚å¯Ÿä¸€ä¸‹ä¹‹å‰ä¿å­˜çš„æ•°æ®è¿˜å­˜åœ¨å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</p><p>æ¬¢è¿ä½ ç»™æˆ‘ç•™è¨€äº¤æµè®¨è®ºï¼Œä½ ä¹Ÿå¯ä»¥æŠŠè¿™èŠ‚è¯¾åˆ†äº«ç»™æ›´å¤šçš„æœ‹å‹ä¸€èµ·é˜…è¯»ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾è§ã€‚</p>","neighbors":{"left":{"article_title":"04ï½œå¦‚ä½•å€ŸåŠ©GitOpså®ç°åº”ç”¨ç§’çº§è‡ªåŠ¨å‘å¸ƒå’Œå›æ»šï¼Ÿ","id":612577},"right":{"article_title":"06 | å¦‚ä½•ä½¿ç”¨å‘½åç©ºé—´éš”ç¦»å›¢é˜ŸåŠåº”ç”¨ç¯å¢ƒï¼Ÿ","id":615238}},"comments":[{"had_liked":false,"id":364728,"user_name":"includestdio.h","can_delete":false,"product_type":"c1","uid":2314854,"ip_address":"å¹¿ä¸œ","ucode":"5027BACE9319CD","user_header":"https://static001.geekbang.org/account/avatar/00/23/52/66/3e4d4846.jpg","comment_is_top":false,"comment_ctime":1671420268,"is_pvip":true,"replies":[{"id":132808,"content":"æ„Ÿè°¢æŒ‡æ­£ã€‚\nå›ç­”éå¸¸æ­£ç¡®ï¼","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671432056,"ip_address":"å¹¿ä¸œ","comment_id":364728,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"â€œé¦–å…ˆï¼Œä½ å¯ä»¥ä½¿ç”¨ kubect get all æ¥æŸ¥çœ‹æŸä¸ªå‘½åç©ºé—´ä¸‹çš„æ‰€æœ‰èµ„æºâ€ ã€‚å‘½ä»¤å†™é”™äº†ï¼Œkubectl\n\nåˆ é™¤ Postgres Pod åï¼Œæ·»åŠ çš„æ•°æ®ä¸å­˜åœ¨ã€‚åŸå› ï¼šå†™å…¥çš„æ•°æ®ä½äºå®¹å™¨çš„å¯å†™å±‚ï¼Œä¸commitä¸ä¿å­˜ï¼Œdelete åï¼Œé‡æ–°æ‹‰èµ·çš„ Pod åŸºäºåŸå§‹å®¹å™¨é•œåƒåˆ›å»ºï¼Œä»…å­˜åœ¨åŸå§‹çš„åªè¯»å±‚æ•°æ®ã€‚éœ€è¦ä¿å­˜æ•°æ®çš„è¯ï¼Œå¯ä»¥æå‰é€šè¿‡ volume ç­‰åšå¥½æŒä¹…åŒ–æ–¹æ¡ˆï¼ŒæŠŠå®¹å™¨å’Œæ•°æ®è§£è€¦","like_count":9,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597092,"discussion_content":"æ„Ÿè°¢æŒ‡æ­£ã€‚\nå›ç­”éå¸¸æ­£ç¡®ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671432056,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364733,"user_name":"Y","can_delete":false,"product_type":"c1","uid":1179432,"ip_address":"å¹¿ä¸œ","ucode":"952AA9B2CD91CE","user_header":"https://static001.geekbang.org/account/avatar/00/11/ff/28/040f6f01.jpg","comment_is_top":false,"comment_ctime":1671425565,"is_pvip":true,"replies":[{"id":132809,"content":"ğŸ˜„","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671432118,"ip_address":"å¹¿ä¸œ","comment_id":364733,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"ç»§ç»­è¿½å‰§","like_count":3,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597093,"discussion_content":"ğŸ˜„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671432119,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364730,"user_name":"GACÂ·DU","can_delete":false,"product_type":"c1","uid":1385403,"ip_address":"å¹¿ä¸œ","ucode":"7847FBE1C13740","user_header":"https://static001.geekbang.org/account/avatar/00/15/23/bb/a1a61f7c.jpg","comment_is_top":false,"comment_ctime":1671420913,"is_pvip":false,"replies":[{"id":132807,"content":"åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æœ‰å¾ˆå¤šå­˜å‚¨æ–¹æ¡ˆï¼Œæ¯”å¦‚ï¼š\n1. https:&#47;&#47;github.com&#47;rook&#47;rook\n2. https:&#47;&#47;github.com&#47;ceph&#47;ceph\n3. https:&#47;&#47;github.com&#47;longhorn&#47;longhorn\n\nå¦‚æœä½ ç”¨çš„æ˜¯äº‘å‚å•†çš„æ‰˜ç®¡ K8s é›†ç¾¤ï¼Œäº‘å‚å•†ä¸€èˆ¬ä¼šç›´æ¥æä¾›ç°æˆçš„å­˜å‚¨æ–¹æ¡ˆï¼Œæ¯”å¦‚ç»“åˆè‡ªå®¶äº‘ç›˜çš„å­˜å‚¨ï¼Œä¸éœ€è¦è‡ªå»ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671431995,"ip_address":"å¹¿ä¸œ","comment_id":364730,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"å‰ç«¯æ·»åŠ çš„æ•°æ®ä¼šè¢«åˆ é™¤ï¼Œå› ä¸ºæ²¡æœ‰æŒ‚ç›˜å­˜å‚¨ã€‚ç”Ÿäº§ç¯å¢ƒç”¨é‚£ç§å­˜å‚¨æ¡†æ¶ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597090,"discussion_content":"åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æœ‰å¾ˆå¤šå­˜å‚¨æ–¹æ¡ˆï¼Œæ¯”å¦‚ï¼š\n1. https://github.com/rook/rook\n2. https://github.com/ceph/ceph\n3. https://github.com/longhorn/longhorn\n\nå¦‚æœä½ ç”¨çš„æ˜¯äº‘å‚å•†çš„æ‰˜ç®¡ K8s é›†ç¾¤ï¼Œäº‘å‚å•†ä¸€èˆ¬ä¼šç›´æ¥æä¾›ç°æˆçš„å­˜å‚¨æ–¹æ¡ˆï¼Œæ¯”å¦‚ç»“åˆè‡ªå®¶äº‘ç›˜çš„å­˜å‚¨ï¼Œä¸éœ€è¦è‡ªå»ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671431996,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372541,"user_name":"Alex","can_delete":false,"product_type":"c1","uid":1024763,"ip_address":"å±±ä¸œ","ucode":"F6B5C64BC99FB7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a2/fb/94af9cf1.jpg","comment_is_top":false,"comment_ctime":1681267315,"is_pvip":false,"replies":[{"id":135991,"content":"ğŸ‘ğŸ»æ„Ÿè°¢åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1681297704,"ip_address":"å¹¿ä¸œ","comment_id":372541,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"é’ˆå¯¹æ— æ³•æ‹‰å–é•œåƒçš„æƒ…å†µï¼Œå»ºè®®ä¿®æ”¹ä¸‹KINDå†…é›†ç¾¤çš„é•œåƒæºåˆ°å›½å†…é˜¿é‡Œçš„é•œåƒæºä¸Š\nkind: Cluster\napiVersion: kind.x-k8s.io&#47;v1alpha4\nnodes:\n- role: control-plane\n  kubeadmConfigPatches:\n  - |\n    kind: InitConfiguration\n    imageRepository: registry.aliyuncs.com&#47;google_containers\n    nodeRegistration:\n      kubeletExtraArgs:\n        node-labels: &quot;ingress-ready=true&quot;\n  extraPortMappings:\n  - containerPort: 80\n    hostPort: 80\n    protocol: TCP\n  - containerPort: 443\n    hostPort: 443\n    protocol: TCP","like_count":1,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613383,"discussion_content":"ğŸ‘ğŸ»æ„Ÿè°¢åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681297704,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365220,"user_name":"ç†Šæ‚Ÿç©ºçš„å‡¶","can_delete":false,"product_type":"c1","uid":1933459,"ip_address":"å¹¿ä¸œ","ucode":"5FA9498BDA92C0","user_header":"https://static001.geekbang.org/account/avatar/00/1d/80/93/dde3d5f0.jpg","comment_is_top":false,"comment_ctime":1672281003,"is_pvip":false,"replies":[{"id":133040,"content":"Draw.io","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1672294244,"ip_address":"å¹¿ä¸œ","comment_id":365220,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"è€å¸ˆä½ å¥½  éº»çƒ¦é—®ä¸‹  æ‚¨ç”»å›¾å·¥å…·ç”¨ä»€ä¹ˆç”»çš„ æŒºå¥½çš„","like_count":1,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597874,"discussion_content":"Draw.io","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1672294244,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364721,"user_name":"Amosãƒ¾","can_delete":false,"product_type":"c1","uid":1567014,"ip_address":"å¹¿ä¸œ","ucode":"833F6FCB4042AD","user_header":"https://static001.geekbang.org/account/avatar/00/17/e9/26/472e16e4.jpg","comment_is_top":false,"comment_ctime":1671414343,"is_pvip":true,"replies":[{"id":132811,"content":"æ„Ÿè°¢æŒ‡æ­£ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671434486,"ip_address":"å¹¿ä¸œ","comment_id":364721,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"å›¾é‡Œä¸æ˜¯5ä¸ªpodå—","like_count":1,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597098,"discussion_content":"æ„Ÿè°¢æŒ‡æ­£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671434486,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377732,"user_name":"Sophia-ç™¾é‘«","can_delete":false,"product_type":"c1","uid":1269105,"ip_address":"ä¸Šæµ·","ucode":"070DC977441003","user_header":"https://static001.geekbang.org/account/avatar/00/13/5d/71/4f6aad17.jpg","comment_is_top":false,"comment_ctime":1689128176,"is_pvip":false,"replies":[{"id":137657,"content":"ğŸ‘ğŸ»å€¼å¾—å€Ÿé‰´çš„è§£å†³æ€è·¯","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1689131694,"ip_address":"å¹¿ä¸œ","comment_id":377732,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"æˆ‘åœ¨å­¦ä¹ åé¢ç« èŠ‚æ—¶ ï¼Œæ‰¾åˆ°äº† 503 å¤±è´¥çš„åŸå› ï¼Œæ˜¯åœ¨æˆ‘clone åˆ°æœ¬åœ°çš„ä»£ç é‡Œï¼Œ frontend deployment ä¸­ podå®šä¹‰æ ‡ç­¾ å’Œ frontend service ä¸­ pod é€‰æ‹©å™¨çš„æ ‡ç­¾ä¸åŒ ï¼ˆä¼°è®¡æ˜¯æˆ‘ä¸å°å¿ƒç¢°åˆ°è¯¯æ”¹äº†è€å¸ˆçš„åŸæ–‡ï¼‰ï¼Œå¯¼è‡´åé¢æ— æ³•ç”Ÿäº§endpointå¯¹è±¡ ä¹Ÿæ— æ³•æ‰¾åˆ°frontend service ä¸ front pod çš„å¯¹åº”å…³ç³»ï¼Œå¯¼è‡´æ— æ³•æä¾›æœåŠ¡ã€‚ èƒ½è¯»æ‡‚å„ä¸ªmanifestæ–‡ä»¶åŠé‡Œé¢å‚æ•°çš„å«ä¹‰å’Œå…³è”å…³ç³»éå¸¸é‡è¦ã€‚æ˜¯å­¦ä¹ K8S çš„æ ¸å¿ƒã€‚\n","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623176,"discussion_content":"ğŸ‘ğŸ»å€¼å¾—å€Ÿé‰´çš„è§£å†³æ€è·¯","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1689131694,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377618,"user_name":"Sophia-ç™¾é‘«","can_delete":false,"product_type":"c1","uid":1269105,"ip_address":"ä¸Šæµ·","ucode":"070DC977441003","user_header":"https://static001.geekbang.org/account/avatar/00/13/5d/71/4f6aad17.jpg","comment_is_top":false,"comment_ctime":1688885548,"is_pvip":false,"replies":[{"id":137625,"content":"æ˜¯ç”¨çš„ Kind å—ï¼Œæ£€æŸ¥ä¸€ä¸‹ ingress-nginx æ˜¯å¦éƒ¨ç½²æˆåŠŸï¼Œingress å¯¹è±¡æ˜¯å¦æ­£å¸¸åŒ¹é…åˆ°äº† serviceï¼Œservice å…³è”çš„ pod æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1688953248,"ip_address":"å¹¿ä¸œ","comment_id":377618,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"Mac ä¸Šå®Œæˆé›†ç¾¤éƒ¨ç½²ï¼Œè§£å†³äº† frontend pod  OOMKILL é—®é¢˜åï¼Œ5ä¸ªpod éƒ½æ­£å¸¸ runningã€‚ ä½†æµè§ˆå™¨è®¿é—®127.0.0.1 æŠ¥ 503 ã€‚ \nkubernetes-example git:(main) âœ— kubectl  get  pods -n example\nNAME                        READY   STATUS    RESTARTS   AGE\nbackend-f8ffdcdd6-57qkp     1&#47;1     Running   0          28m\nbackend-f8ffdcdd6-7rvhv     1&#47;1     Running   0          28m\nfrontend-696c87cc48-4qqvv   1&#47;1     Running   0          28m\nfrontend-696c87cc48-kg2jw   1&#47;1     Running   0          28m\npostgres-f4745bb69-2m2bt    1&#47;1     Running   0          28m\nâœ  kubernetes-example git:(main) âœ— kubectl get all -n example\nNAME                            READY   STATUS    RESTARTS   AGE\npod&#47;backend-f8ffdcdd6-57qkp     1&#47;1     Running   0          31m\npod&#47;backend-f8ffdcdd6-7rvhv     1&#47;1     Running   0          31m\npod&#47;frontend-696c87cc48-4qqvv   1&#47;1     Running   0          31m\npod&#47;frontend-696c87cc48-kg2jw   1&#47;1     Running   0          31m\npod&#47;postgres-f4745bb69-2m2bt    1&#47;1     Running   0          31m\n\nNAME                       TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE\nservice&#47;backend-service    ClusterIP   10.96.56.77     &lt;none&gt;        5000&#47;TCP   31m\nservice&#47;frontend-service   ClusterIP   10.96.119.215   &lt;none&gt;        3000&#47;TCP   31m\nservice&#47;pg-service         ClusterIP   10.96.46.127    &lt;none&gt;        5432&#47;TCP   31m\n\nNAME                       READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps&#47;backend    2&#47;2     2            2           31m\ndeployment.apps&#47;frontend   2&#47;2     2            2           31m\ndeployment.apps&#47;postgres   1&#47;1     1            1           31m\n\nNAME                                  DESIRED   CURRENT   READY   AGE\nreplicaset.apps&#47;backend-f8ffdcdd6     2         2         2       31m\nreplicaset.apps&#47;frontend-696c87cc48   2         2         2       31m\nreplicaset.apps&#47;postgres-f4745bb69    1         1         1       31m\n\nNAME                                           REFERENCE             TARGETS           MINPODS   MAXPODS   REPLICAS   AG","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623022,"discussion_content":"æ˜¯ç”¨çš„ Kind å—ï¼Œæ£€æŸ¥ä¸€ä¸‹ ingress-nginx æ˜¯å¦éƒ¨ç½²æˆåŠŸï¼Œingress å¯¹è±¡æ˜¯å¦æ­£å¸¸åŒ¹é…åˆ°äº† serviceï¼Œservice å…³è”çš„ pod æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688953248,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1269105,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5d/71/4f6aad17.jpg","nickname":"Sophia-ç™¾é‘«","note":"","ucode":"070DC977441003","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623172,"discussion_content":"æˆ‘åœ¨ä½¿ç”¨ kubectl get endpoint -n  example   æŸ¥çœ‹ å‘½åç©ºé—´ä¸‹æœåŠ¡ çš„endpoint å¯¹è±¡æ—¶ï¼Œå‘ç° frontend -service çš„endpoint æ˜¯ noneã€‚ è¯´æ˜frontend -service çš„ pod é€‰æ‹©å™¨å®šä¹‰é”™è¯¯ å¯¼è‡´ k8s æ— æ³•åœ¨åˆ›å»º service åï¼Œä¸»åŠ¨åˆ›å»ºå‡ºæ­¤service å¯¹åº”çš„endpoint ã€‚ é€šè¿‡è¿™æ¡å‘½ä»¤ å‘ç°äº†é—®é¢˜çš„æ ¹æœ¬ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1689128879,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1269105,"avatar":"https://static001.geekbang.org/account/avatar/00/13/5d/71/4f6aad17.jpg","nickname":"Sophia-ç™¾é‘«","note":"","ucode":"070DC977441003","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623170,"discussion_content":"é€šè¿‡åé¢ç« èŠ‚çš„å­¦ä¹ æ‰¾åˆ°äº†å¤±è´¥çš„åŸå›  æ˜¯ frontend deployment ä¸­ pod å®šä¹‰ä¸­çš„label ä¸frontend service ä¸­ pod é€‰æ‹©å™¨çš„label ä¸ä¸€è‡´å¯¼è‡´çš„ã€‚ï¼ˆæˆ‘clone åˆ°æœ¬åœ°çš„ä»£ç ä¸å°å¿ƒè¯¯æ”¹äº† frontend service ä¸­ pod é€‰æ‹©å™¨çš„labelï¼‰ï¼Œè¿™æ ·å¯¼è‡´äº† frontend service æ— æ³•åŒ¹é…åˆ°å¯¹åº”çš„frontend pod ï¼Œå¯¼è‡´æ— æ³•æä¾›æœåŠ¡ã€‚ å„ä¸ª manifestæ–‡ä»¶çš„å‚æ•°å®šä¹‰ä»¥åŠå‚æ•°é—´çš„å…³ç³»çš„ç†è§£æŒæ¡éå¸¸é‡è¦ã€‚ æ„Ÿè°¢è€å¸ˆ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1689128534,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":373209,"user_name":"Da Vinci","can_delete":false,"product_type":"c1","uid":1061671,"ip_address":"å¹¿ä¸œ","ucode":"DB3B7F6A6028C1","user_header":"https://static001.geekbang.org/account/avatar/00/10/33/27/e5a74107.jpg","comment_is_top":false,"comment_ctime":1682243772,"is_pvip":true,"replies":[{"id":136332,"content":"æ£€æŸ¥ä¸€ä¸‹ ingress-nginx pod æ˜¯ä¸æ˜¯ running çŠ¶æ€ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1682302979,"ip_address":"æ³°å›½","comment_id":373209,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"éƒ¨ç½²å®Œingressï¼Œè®¿é—®404ï¼Œæ˜¯æœ‰ä»€ä¹ˆä¸å¯¹å—ï¼Œè€å¸ˆ\n","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":615488,"discussion_content":"æ£€æŸ¥ä¸€ä¸‹ ingress-nginx pod æ˜¯ä¸æ˜¯ running çŠ¶æ€ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1682302979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ³°å›½","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":372617,"user_name":"æ¸£æ¸£è¾‰","can_delete":false,"product_type":"c1","uid":1911235,"ip_address":"æ—¥æœ¬","ucode":"730838D9161579","user_header":"https://static001.geekbang.org/account/avatar/00/1d/29/c3/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1681352999,"is_pvip":false,"replies":[{"id":136008,"content":"æ–¹ä¾¿è´´ä¸€ä¸‹ pod çš„æ—¥å¿—ä¿¡æ¯å—","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1681377068,"ip_address":"å¹¿ä¸œ","comment_id":372617,"utype":1}],"discussion_count":4,"race_medal":0,"score":2,"product_id":100312001,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘é€šè¿‡ä¸‹è½½githubé¡¹ç›®è¿›è¡Œéƒ¨ç½²ã€‚ä½†æ˜¯å½“æˆ‘è®¿é—®å‰ç«¯çš„æ—¶å€™å‡ºç°äº†502 BadGatewayé”™è¯¯ã€‚ç„¶åæŸ¥çœ‹podçš„æ—¶å€™å‘ç°å‰ç«¯çš„podé‡å¯äº†ã€‚å¹¶ä¸”åœ¨é‡å¯æˆåŠŸåå†æ¬¡è®¿é—®è¿˜æ˜¯å‡ºç°äº†502çš„é”™è¯¯ã€‚æˆ‘ç”¨çš„æ˜¯m1èŠ¯ç‰‡çš„macbookã€‚","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":613527,"discussion_content":"æ–¹ä¾¿è´´ä¸€ä¸‹ pod çš„æ—¥å¿—ä¿¡æ¯å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681377068,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1911235,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/29/c3/791d0f5e.jpg","nickname":"æ¸£æ¸£è¾‰","note":"","ucode":"730838D9161579","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":613560,"discussion_content":"kubectl logs frontend-6b48fbbc48-k2zjf -n example\nyarn run v1.22.19\n$ react-scripts start\nâ„¹ ï½¢wdsï½£: Project is running at http://10.244.0.6/\nâ„¹ ï½¢wdsï½£: webpack output is served from \nâ„¹ ï½¢wdsï½£: Content not from webpack is served from /frontend/public\nâ„¹ ï½¢wdsï½£: 404s will fallback to /\nStarting the development server...\n\nBrowserslist: caniuse-lite is outdated. Please run:\n  npx update-browserslist-db@latest\n  Why you should do it regularly: https://github.com/browserslist/update-db#readme\nThe build failed because the process exited too early. This probably means the system ran out of memory or someone called `kill -9` on the process.\nerror Command failed with exit code 1.\ninfo Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1681393292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":613527,"ip_address":"æ—¥æœ¬","group_id":0},"score":613560,"extra":""}]},{"author":{"id":2870395,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/cc/7b/fb7920f3.jpg","nickname":"Xueqiuâ›„ï¸","note":"","ucode":"DEC8196A8BA5A9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":620266,"discussion_content":"æˆ‘é‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ã€‚frontend pod ä¸åœçš„crashï¼Œç„¶åé‡å¯ã€‚ä¸ºäº†æµ‹è¯•ï¼Œæˆ‘åœ¨æœ¬åœ°ç¯å¢ƒä¸‹ç”¨docker å•ç‹¬è·‘äº†ä¸€ä¸‹frontend containerã€‚å‘ç°frontend container éœ€è¦è‡³å°‘ 300mbiã€‚ä½†æ˜¯deployment ä¸­åªæœ‰requestsï¼š128Miï¼Œlimitsï¼š256Miã€‚æ‰€ä»¥å½“æ—¶çŒœæƒ³çš„é—®é¢˜åº”è¯¥æ˜¯Podé‡åˆ°äº† out of memory issueï¼Œç„¶åè¢«ä¸åœé‡å¯ã€‚æˆ‘æŠŠrequestså’Œlimits memoryéƒ½æ”¹åˆ°1024Miä¹‹åï¼Œå°±æ²¡æœ‰å†å‡ºç°crash loopçš„é—®é¢˜ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1685991465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ç¾å›½","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2808415,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/da/5f/f72f0ffd.jpg","nickname":"HD","note":"","ucode":"E7990C3384BDF4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":646016,"discussion_content":"å…„å¼Ÿï¼Œç‰›ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1717127882,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371903,"user_name":"å¿ƒçœ‹ä¸–ç•Œ","can_delete":false,"product_type":"c1","uid":1353069,"ip_address":"é™•è¥¿","ucode":"992FFF9C33DE85","user_header":"https://static001.geekbang.org/account/avatar/00/14/a5/6d/ad719e86.jpg","comment_is_top":false,"comment_ctime":1680510269,"is_pvip":false,"replies":[{"id":135695,"content":"Ingress-nginx éƒ¨ç½²å¤±è´¥äº†ï¼Œæ£€æŸ¥ä¸€ä¸‹é•œåƒçš„æ‹‰å–æƒ…å†µã€‚å¦‚æœæ˜¯å› ä¸ºç½‘ç»œåŸå› ï¼Œå¯ä»¥å¼€é€šä¸€å°äº‘å‚å•†çš„é¦™æ¸¯è™šæ‹Ÿæœºæˆ–è€…æ‰˜ç®¡çš„ K8s é›†ç¾¤æ¥å®éªŒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1680524061,"ip_address":"æ–°åŠ å¡","comment_id":371903,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"è€å¸ˆï¼Œè¯·æ•™ä¸€ä¸‹ï¼Œè¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼Œå‘ç”Ÿé”™è¯¯ï¼š\nkubectl apply -f https:&#47;&#47;ghproxy.com&#47;https:&#47;&#47;raw.githubusercontent.com&#47;lyzhang1999&#47;kubernetes-example&#47;main&#47;deploy&#47;ingress.yaml -n example\n\nError from server (InternalError): error when creating &quot;deploy&#47;ingress.yaml&quot;: Internal error occurred: failed calling webhook &quot;validate.nginx.ingress.kubernetes.io&quot;: failed to call webhook: Post &quot;https:&#47;&#47;ingress-nginx-controller-admission.ingress-nginx.svc:443&#47;networking&#47;v1&#47;ingresses?timeout=10s&quot;: dial tcp 10.96.57.158:443: connect: connection refused","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":612127,"discussion_content":"Ingress-nginx éƒ¨ç½²å¤±è´¥äº†ï¼Œæ£€æŸ¥ä¸€ä¸‹é•œåƒçš„æ‹‰å–æƒ…å†µã€‚å¦‚æœæ˜¯å› ä¸ºç½‘ç»œåŸå› ï¼Œå¯ä»¥å¼€é€šä¸€å°äº‘å‚å•†çš„é¦™æ¸¯è™šæ‹Ÿæœºæˆ–è€…æ‰˜ç®¡çš„ K8s é›†ç¾¤æ¥å®éªŒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1680524061,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"æ–°åŠ å¡","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371133,"user_name":"å°é©¬ğŸ","can_delete":false,"product_type":"c1","uid":1107540,"ip_address":"ä¸Šæµ·","ucode":"8CA466A4004BDB","user_header":"https://static001.geekbang.org/account/avatar/00/10/e6/54/86056001.jpg","comment_is_top":false,"comment_ctime":1679565955,"is_pvip":false,"replies":[{"id":135397,"content":"ç½‘ç»œåŸå› ï¼Œå¯ä»¥å°è¯•å¼€é€šäº‘å‚å•†é¦™æ¸¯é›†ç¾¤æ¥å®éªŒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1679574472,"ip_address":"å¹¿ä¸œ","comment_id":371133,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"å®¹å™¨podçš„çŠ¶æ€åªæœ‰ä¸€ä¸ªrunning å…¶ä»–çš„éƒ½æ˜¯contaninerCreating æ€ä¹ˆæï¼Ÿã€‹","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610470,"discussion_content":"ç½‘ç»œåŸå› ï¼Œå¯ä»¥å°è¯•å¼€é€šäº‘å‚å•†é¦™æ¸¯é›†ç¾¤æ¥å®éªŒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679574472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":371114,"user_name":"å°é©¬ğŸ","can_delete":false,"product_type":"c1","uid":1107540,"ip_address":"ä¸Šæµ·","ucode":"8CA466A4004BDB","user_header":"https://static001.geekbang.org/account/avatar/00/10/e6/54/86056001.jpg","comment_is_top":false,"comment_ctime":1679555476,"is_pvip":false,"replies":[{"id":135395,"content":"ingress-nginx æ²¡æœ‰éƒ¨ç½²æˆåŠŸï¼Œæ£€æŸ¥å·¥ä½œè´Ÿè½½ã€‚ä¸€èˆ¬æ˜¯é•œåƒæ²¡æ‹‰å–æˆåŠŸï¼Œä½ å¯ä»¥å¼€é€šä¸€å°äº‘å‚å•†çš„é¦™æ¸¯é›†ç¾¤æ¥å®éªŒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1679573817,"ip_address":"å¹¿ä¸œ","comment_id":371114,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"Error from server (InternalError): error when creating &quot;https:&#47;&#47;ghproxy.com&#47;https:&#47;&#47;raw.githubusercontent.com&#47;lyzhang1999&#47;kubernetes-example&#47;main&#47;deploy&#47;ingress.yaml&quot;: Internal error occurred: failed calling webhook &quot;validate.nginx.ingress.kubernetes.io&quot;: failed to call webhook: Post &quot;https:&#47;&#47;ingress-nginx-controller-admission.ingress-nginx.svc:443&#47;networking&#47;v1&#47;ingresses?timeout=10s&quot;: dial tcp 10.96.16.113:443: connect: connection refused    \n\nè¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› å‘€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610467,"discussion_content":"ingress-nginx æ²¡æœ‰éƒ¨ç½²æˆåŠŸï¼Œæ£€æŸ¥å·¥ä½œè´Ÿè½½ã€‚ä¸€èˆ¬æ˜¯é•œåƒæ²¡æ‹‰å–æˆåŠŸï¼Œä½ å¯ä»¥å¼€é€šä¸€å°äº‘å‚å•†çš„é¦™æ¸¯é›†ç¾¤æ¥å®éªŒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679573817,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":369935,"user_name":"é™ˆæ•","can_delete":false,"product_type":"c1","uid":2841834,"ip_address":"ç¦å»º","ucode":"A8F05ADF47E5F0","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erUYW4duhqyicJEAOaEAbtSiaz22iaUmV1Mh1SJGcwRgicyZC16Rk3fJFvwXuhZJP6lqjLKCH13TEvrGg/132","comment_is_top":false,"comment_ctime":1678158065,"is_pvip":false,"replies":[{"id":134860,"content":"äº‘æ•°æ®åº“å·²ç»å¾ˆæˆç†Ÿäº†ï¼Œåœ¨è¿ç§»è¿‡ç¨‹ä¸»è¦æ˜¯è¦åšæ•°æ®åŒæ­¥å’Œæµé‡åˆ‡æ¢ï¼Œä»ç§æœ‰éƒ¨ç½²çš„æ•°æ®åº“å®ä¾‹è¿ç§»åˆ°äº‘æ•°æ®åº“å¯èƒ½ä¼šå¯¼è‡´çŸ­æ—¶é—´çš„åœæœºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1678170012,"ip_address":"å¹¿ä¸œ","comment_id":369935,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"è€å¸ˆä½ å¥½ï¼Œè¯·é—®ä¸€ä¸‹ï¼Œç”Ÿäº§ä¸Šæ•°æ®åº“ä¸Šäº‘çš„è¯æœ‰ä»€ä¹ˆæœ€ä½³å®è·µå¯ä»¥æ¨èå‘¢","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607875,"discussion_content":"äº‘æ•°æ®åº“å·²ç»å¾ˆæˆç†Ÿäº†ï¼Œåœ¨è¿ç§»è¿‡ç¨‹ä¸»è¦æ˜¯è¦åšæ•°æ®åŒæ­¥å’Œæµé‡åˆ‡æ¢ï¼Œä»ç§æœ‰éƒ¨ç½²çš„æ•°æ®åº“å®ä¾‹è¿ç§»åˆ°äº‘æ•°æ®åº“å¯èƒ½ä¼šå¯¼è‡´çŸ­æ—¶é—´çš„åœæœºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1678170012,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":369453,"user_name":"toranx11","can_delete":false,"product_type":"c1","uid":1728431,"ip_address":"æ¹–å—","ucode":"80F54B52BEE8B3","user_header":"https://static001.geekbang.org/account/avatar/00/1a/5f/af/a2a7c866.jpg","comment_is_top":false,"comment_ctime":1677558048,"is_pvip":false,"replies":[{"id":134670,"content":"é•œåƒæ˜¯æ­£å¸¸çš„ï¼Œâ€œtoo many open filesâ€ä¼¼ä¹æ˜¯å®¿ä¸»æœºçš„é…ç½®å¯¼è‡´çš„ï¼ŒæŸ¥çœ‹è¿™ä¸ªæ–‡æ¡£æ’æŸ¥ï¼šhttps:&#47;&#47;kind.sigs.k8s.io&#47;docs&#47;user&#47;known-issues&#47;#pod-errors-due-to-too-many-open-filesã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1677639006,"ip_address":"å¹¿ä¸œ","comment_id":369453,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"æœ€æ–°çš„å‰ç«¯é•œåƒï¼ˆlyzhang1999&#47;frontend:latestï¼‰æ˜¯æœ‰é—®é¢˜å—ï¼Ÿfrontend pod ä¸€ç›´CrashLoopBackOffï¼š\n\nStarting the development server...\n\nnode:events:491\n      throw er; &#47;&#47; Unhandled &#39;error&#39; event\n      ^\n\nError: EMFILE: too many open files, watch &#39;&#47;frontend&#47;public&#39;\n    at FSWatcher.&lt;computed&gt; (node:internal&#47;fs&#47;watchers:244:19)\n    at Object.watch (node:fs:2301:34)\n    at createFsWatchInstance (&#47;frontend&#47;node_modules&#47;chokidar&#47;lib&#47;nodefs-handler.js:38:15)\n    at setFsWatchListener (&#47;frontend&#47;node_modules&#47;chokidar&#47;lib&#47;nodefs-handler.js:81:15)\n    at FSWatcher.NodeFsHandler._watchWithNodeFs (&#47;frontend&#47;node_modules&#47;chokidar&#47;lib&#47;nodefs-handler.js:233:14)\n    at FSWatcher.NodeFsHandler._handleDir (&#47;frontend&#47;node_modules&#47;chokidar&#47;lib&#47;nodefs-handler.js:429:19)\n    at FSWatcher.&lt;anonymous&gt; (&#47;frontend&#47;node_modules&#47;chokidar&#47;lib&#47;nodefs-handler.js:477:19)\n    at FSWatcher.&lt;anonymous&gt; (&#47;frontend&#47;node_modules&#47;chokidar&#47;lib&#47;nodefs-handler.js:482:16)\n    at FSReqCallback.oncomplete (node:fs:207:5)\nEmitted &#39;error&#39; event on FSWatcher instance at:\n    at FSWatcher._handleError (&#47;frontend&#47;node_modules&#47;chokidar&#47;index.js:260:10)\n    at createFsWatchInstance (&#47;frontend&#47;node_modules&#47;chokidar&#47;lib&#47;nodefs-handler.js:40:5)\n    at setFsWatchListener (&#47;frontend&#47;node_modules&#47;chokidar&#47;lib&#47;nodefs-handler.js:81:15)\n    [... lines matching original stack trace ...]\n    at FSReqCallback.oncomplete (node:fs:207:5) {\n  errno: -24,\n  syscall: &#39;watch&#39;,\n  code: &#39;EMFILE&#39;,\n  path: &#39;&#47;frontend&#47;public&#39;,\n  filename: &#39;&#47;frontend&#47;public&#39;\n}","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":607140,"discussion_content":"é•œåƒæ˜¯æ­£å¸¸çš„ï¼Œâ€œtoo many open filesâ€ä¼¼ä¹æ˜¯å®¿ä¸»æœºçš„é…ç½®å¯¼è‡´çš„ï¼ŒæŸ¥çœ‹è¿™ä¸ªæ–‡æ¡£æ’æŸ¥ï¼šhttps://kind.sigs.k8s.io/docs/user/known-issues/#pod-errors-due-to-too-many-open-filesã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1677639006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":367704,"user_name":"é˜¿æ˜Ÿ","can_delete":false,"product_type":"c1","uid":2883767,"ip_address":"ç¦å»º","ucode":"B4F6135FFA9B51","user_header":"https://static001.geekbang.org/account/avatar/00/2c/00/b7/a39ab3e5.jpg","comment_is_top":false,"comment_ctime":1675473771,"is_pvip":false,"replies":[{"id":133937,"content":"æ£€æŸ¥ä¸€ä¸‹ Ingress-nginx æ˜¯ä¸æ˜¯æ²¡å®‰è£…æˆåŠŸï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1675486921,"ip_address":"å¹¿ä¸œ","comment_id":367704,"utype":1}],"discussion_count":4,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"CentOS 8.2 ä¸‹ï¼ŒæŒ‰ç…§å¼•å¯¼éƒ½å®‰è£…å¥½äº†ï¼Œä½†æ˜¯æ‰§è¡Œ\nkubectl apply -f .&#47;deploy&#47;ingress.yaml -n example æ—¶æŠ¥é”™äº†ï¼š\n\nerror when creating &quot;deploy&#47;ingress.yaml&quot;: Internal error occurred: failed calling webhook &quot;validate.nginx.ingress.kubernetes.io&quot;: failed to call webhook: Post &quot;https:&#47;&#47;ingress-nginx-controller-admission.ingress-nginx.svc:443&#47;networking&#47;v1&#47;ingresses?timeout=10s&quot;: dial tcp 10.96.136.247:443: connect: connection refused","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601905,"discussion_content":"æ£€æŸ¥ä¸€ä¸‹ Ingress-nginx æ˜¯ä¸æ˜¯æ²¡å®‰è£…æˆåŠŸï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675486921,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2883767,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/00/b7/a39ab3e5.jpg","nickname":"é˜¿æ˜Ÿ","note":"","ucode":"B4F6135FFA9B51","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":601909,"discussion_content":"è°¢è°¢è€å¸ˆå›å¤ï¼Œå†æ¬¡å°è¯•äº†å‘ç°æ˜¯ kind é‡Œé¢å¯åŠ¨ Ingress-nginx å¤±è´¥äº†ã€‚åç»­å‘ç° kind é‡Œé¢ä¼¼ä¹æ— æ³•æˆåŠŸæ‹‰å–é•œåƒï¼Œéœ€è¦å…ˆæœ¬åœ° pull ä¸‹æ¥åï¼Œè°ƒç”¨ kind load docker-image åŠ è½½å®Œæ¯•åæ‰å¯ä»¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675493555,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":601905,"ip_address":"ç¦å»º","group_id":0},"score":601909,"extra":""}]},{"author":{"id":2883767,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/00/b7/a39ab3e5.jpg","nickname":"é˜¿æ˜Ÿ","note":"","ucode":"B4F6135FFA9B51","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":601912,"discussion_content":"åˆç ”ç©¶äº†ä¸€ä¸‹ï¼Œå‘ç°æ˜¯å› ä¸ºç»ˆç«¯è®¾ç½®äº†ä»£ç†ï¼Œå¯¼è‡´ kind é‡Œé¢ pull image å¤±è´¥äº†ã€‚å…³æ‰ä»£ç†åå°±å¥½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1675495161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ç¦å»º","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1107540,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e6/54/86056001.jpg","nickname":"å°é©¬ğŸ","note":"","ucode":"8CA466A4004BDB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2883767,"avatar":"https://static001.geekbang.org/account/avatar/00/2c/00/b7/a39ab3e5.jpg","nickname":"é˜¿æ˜Ÿ","note":"","ucode":"B4F6135FFA9B51","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":610436,"discussion_content":"å…„å¼Ÿï¼Œä»€ä¹ˆæ„æ€ï¼Ÿæ²¡çœ‹æ‡‚ï¼Œæˆ‘ç°åœ¨ä¹Ÿç¢°åˆ°è¿™ä¸ªé—®é¢˜äº†ï¼Œæˆ‘æ˜¯åœ¨Macä¸Šçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1679560569,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":601912,"ip_address":"ä¸Šæµ·","group_id":0},"score":610436,"extra":""}]}]},{"had_liked":false,"id":366303,"user_name":"éƒ‘æµ·æˆ","can_delete":false,"product_type":"c1","uid":1192616,"ip_address":"åŒ—äº¬","ucode":"B0363EA4B2C646","user_header":"https://static001.geekbang.org/account/avatar/00/12/32/a8/d5bf5445.jpg","comment_is_top":false,"comment_ctime":1673571401,"is_pvip":true,"replies":[{"id":133470,"content":"éå¸¸æ­£ç¡®ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1673575421,"ip_address":"å¹¿ä¸œ","comment_id":366303,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"åˆ é™¤podåï¼Œæ·»åŠ çš„æ•°æ®ä¸å­˜åœ¨äº†ã€‚podæ²¡æœ‰æŒ‚è½½æŒä¹…åŒ–å­˜å‚¨ï¼Œkubernetes å­˜å‚¨æŒ‰ç…§ç”Ÿå‘½å‘¨æœŸåˆ†ä¸º: å®¹å™¨æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ã€ä¸´æ—¶å­˜å‚¨ã€æŒä¹…åŒ–å­˜å‚¨ã€‚å®¹å™¨æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ä¸podå†…å®¹å™¨ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œå®¹å™¨åˆ é™¤åé”€æ¯ï¼›ä¸´æ—¶å­˜å‚¨ä¸podç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œpodåˆ é™¤åé”€æ¯ï¼›æŒä¹…åŒ–å­˜å‚¨æ˜¯å¤–éƒ¨çš„ç½‘ç»œå­˜å‚¨æˆ–è€…hostpathï¼Œä¼šä¸€ç›´ä¿ç•™ã€‚ç¤ºä¾‹ä¸­ä½¿ç”¨å®¹å™¨æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ï¼Œåˆ é™¤podå°±è¢«é”€æ¯","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":599518,"discussion_content":"éå¸¸æ­£ç¡®ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673575422,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":366051,"user_name":"é‚£é£åœ¨æå®¢","can_delete":false,"product_type":"c1","uid":1026502,"ip_address":"å¹¿ä¸œ","ucode":"132B9263006BB9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a9/c6/30b29c22.jpg","comment_is_top":false,"comment_ctime":1673343244,"is_pvip":false,"replies":[{"id":133417,"content":"æ˜¯çš„ï¼Œéœ€è¦ 1.23 ä»¥ä¸Šçš„ç‰ˆæœ¬ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1673443899,"ip_address":"å¹¿ä¸œ","comment_id":366051,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"æç¤º unable to recognize &quot;hpa.yaml&quot;: no matches for kind &quot;HorizontalPodAutoscaler&quot; in version &quot;autoscaling&#47;v2&quot;ï¼Œæ˜¯æˆ‘çš„ k8s ç‰ˆæœ¬ä½äº†å—ï¼Œæˆ‘çš„ k8s å®éªŒç‰ˆæœ¬æ˜¯ v1.22.2","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":599321,"discussion_content":"æ˜¯çš„ï¼Œéœ€è¦ 1.23 ä»¥ä¸Šçš„ç‰ˆæœ¬ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1673443899,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":365559,"user_name":"æå¤š","can_delete":false,"product_type":"c1","uid":2806068,"ip_address":"å¹¿ä¸œ","ucode":"974E2C405C2CE7","user_header":"https://static001.geekbang.org/account/avatar/00/2a/d1/34/03dc9e03.jpg","comment_is_top":false,"comment_ctime":1672760026,"is_pvip":false,"replies":[{"id":133150,"content":"æˆ‘æ›´æ–°äº†ä¸€ç‰ˆï¼Œä½ å¯ä»¥é‡æ–°æ‹‰ä¸€ä¸‹ç¤ºä¾‹åº”ç”¨ä»“åº“ï¼Œé‡æ–°éƒ¨ç½²è¯•è¯•çœ‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1672794307,"ip_address":"å¹¿ä¸œ","comment_id":365559,"utype":1}],"discussion_count":2,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"è€å¸ˆï¼Œfrontendçš„èµ„æºé…é¢æ•°å€¼æ˜¯ä¸æ˜¯æœ‰é—®é¢˜ï¼Œæˆ‘è¿™é‡Œä¸€ç›´æç¤ºOOMé”™è¯¯ï¼š\n\npod&#47;backend-6f756f886f-8ncv8    1&#47;1     Running             0                   15m\npod&#47;backend-6f756f886f-k6c9x    1&#47;1     Running             0                   58m\npod&#47;frontend-7b55cc5c67-5r54z   1&#47;1     Terminating         0                   5m12s\npod&#47;frontend-7b55cc5c67-brl6q   1&#47;1     Running             2 (81s ago)         4m57s\npod&#47;frontend-7b55cc5c67-cwgtt   0&#47;1     OOMKilled           3 (&lt;invalid&gt; ago)   15m\npod&#47;frontend-7b55cc5c67-tktd9   1&#47;1     Running             2 (&lt;invalid&gt; ago)   5m12s\npod&#47;frontend-7b85d8fc8-5fj6t    0&#47;1     ContainerCreating   0                   8s\npod&#47;frontend-7b85d8fc8-8v2b7    1&#47;1     Running             0                   38s\npod&#47;frontend-7b85d8fc8-jnw4j    0&#47;1     ContainerCreating   0                   38s\npod&#47;frontend-7b85d8fc8-x9vv9    0&#47;1     ContainerCreating   0                   38s\npod&#47;postgres-7745b57d5d-hckqd   1&#47;1     Running             0                   58m\n\næŸ¥çœ‹hpaå¯¹åº”çš„é¢åº¦ä¹Ÿè¶…äº†ï¼š\n\nhorizontalpodautoscaler.autoscaling&#47;backend    Deployment&#47;backend    25%&#47;50%, 1%&#47;50%   2         10        2          5m46s\nhorizontalpodautoscaler.autoscaling&#47;frontend   Deployment&#47;frontend   200%&#47;80%          2         10        5          5m46s\n","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":598352,"discussion_content":"æˆ‘æ›´æ–°äº†ä¸€ç‰ˆï¼Œä½ å¯ä»¥é‡æ–°æ‹‰ä¸€ä¸‹ç¤ºä¾‹åº”ç”¨ä»“åº“ï¼Œé‡æ–°éƒ¨ç½²è¯•è¯•çœ‹ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1672794308,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2806068,"avatar":"https://static001.geekbang.org/account/avatar/00/2a/d1/34/03dc9e03.jpg","nickname":"æå¤š","note":"","ucode":"974E2C405C2CE7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":598370,"discussion_content":"å¥½çš„è€å¸ˆã€‚æˆ‘çœ‹åˆ°æ‚¨æ›´æ–°çš„å¥½åƒæ˜¯hpaï¼Œæ˜¨å¤©æˆ‘æŠŠfrontendå†…å­˜requeståŠ åˆ°512äº†ï¼Œå°±å¯ä»¥èµ·æ¥äº†ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1672797738,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":598352,"ip_address":"å±±ä¸œ","group_id":0},"score":598370,"extra":""}]}]},{"had_liked":false,"id":365226,"user_name":"ç†Šæ‚Ÿç©ºçš„å‡¶","can_delete":false,"product_type":"c1","uid":1933459,"ip_address":"å¹¿ä¸œ","ucode":"5FA9498BDA92C0","user_header":"https://static001.geekbang.org/account/avatar/00/1d/80/93/dde3d5f0.jpg","comment_is_top":false,"comment_ctime":1672283908,"is_pvip":false,"replies":[{"id":133042,"content":"ä¸»è¦çš„åŸå› æ˜¯æ²¡æœ‰ä¸º Pg Pod é…ç½®æŒä¹…åŒ–å­˜å‚¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1672294335,"ip_address":"å¹¿ä¸œ","comment_id":365226,"utype":1}],"discussion_count":1,"race_medal":0,"score":3,"product_id":100312001,"comment_content":"æ€è€ƒé¢˜ï¼š åˆ é™¤å‘½åç©ºé—´ä¸‹pgæ•°æ®åº“å æ•°æ®ä¸è§äº†ï¼›å®ä¾‹éƒ½åˆ äº†ï¼ˆç†è§£æ˜¯ç‰©ç†åˆ é™¤ï¼‰ï¼› æ•°æ®è‚¯å®šä¸åº”è¯¥åœ¨äº† ","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597876,"discussion_content":"ä¸»è¦çš„åŸå› æ˜¯æ²¡æœ‰ä¸º Pg Pod é…ç½®æŒä¹…åŒ–å­˜å‚¨ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1672294335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364764,"user_name":"çƒŸç«ä¸å ","can_delete":false,"product_type":"c1","uid":1149539,"ip_address":"å¹¿ä¸œ","ucode":"BEEE3173C66E5F","user_header":"https://static001.geekbang.org/account/avatar/00/11/8a/63/a5fda84d.jpg","comment_is_top":false,"comment_ctime":1671458673,"is_pvip":false,"replies":[{"id":132832,"content":"æ­£ç¡®ï¼Œå¯ä»¥è¿›ä¸€æ­¥å°è¯•ä¸º pg å¢åŠ æŒä¹…åŒ–å­˜å‚¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671504902,"ip_address":"å¹¿ä¸œ","comment_id":364764,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100312001,"comment_content":"æ€è€ƒé¢˜ï¼šæ•°æ®ä¸åœ¨äº†ï¼Œpgæ²¡æœ‰æŒä¹…åŒ–å­˜å‚¨ï¼Œæ–°podåŸºäºyamlæ–‡ä»¶å®šä¹‰çš„é•œåƒå¯åŠ¨ã€‚","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597165,"discussion_content":"æ­£ç¡®ï¼Œå¯ä»¥è¿›ä¸€æ­¥å°è¯•ä¸º pg å¢åŠ æŒä¹…åŒ–å­˜å‚¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671504903,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364754,"user_name":"å¥•","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"å¹¿ä¸œ","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1671449521,"is_pvip":false,"replies":[{"id":132821,"content":"éƒ¨ç½² Ingress-Nginx ä¹‹åè®¿é—®æœ¬åœ° 127.0.0.1 å°±å¯ä»¥äº†ï¼Œåº”ç”¨å¸¦æœ‰ Ingress ç­–ç•¥ã€‚å¦å¤–æ³¨æ„åˆ›å»º Kind é›†ç¾¤çš„æ—¶å€™éœ€è¦æŒ‰ç…§æ–‡ä¸­çš„æ­¥éª¤æš´éœ² 80 ç«¯å£ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671452241,"ip_address":"å¹¿ä¸œ","comment_id":364754,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100312001,"comment_content":"mac éƒ¨ç½²å®Œæˆä¹‹åï¼Œè®¿é—® 127.0.0.1 :3000 æ— æ³•è®¿é—®ï¼Œè¿›å…¥åˆ°å®¹å™¨å†…å°±å¯ä»¥è®¿é—®ï¼Œç½‘ç»œä¸é€š","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597127,"discussion_content":"éƒ¨ç½² Ingress-Nginx ä¹‹åè®¿é—®æœ¬åœ° 127.0.0.1 å°±å¯ä»¥äº†ï¼Œåº”ç”¨å¸¦æœ‰ Ingress ç­–ç•¥ã€‚å¦å¤–æ³¨æ„åˆ›å»º Kind é›†ç¾¤çš„æ—¶å€™éœ€è¦æŒ‰ç…§æ–‡ä¸­çš„æ­¥éª¤æš´éœ² 80 ç«¯å£ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671452241,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":364744,"user_name":"Geek_7c4279","can_delete":false,"product_type":"c1","uid":3247407,"ip_address":"å¹¿ä¸œ","ucode":"A085F4F1C29E77","user_header":"","comment_is_top":false,"comment_ctime":1671444354,"is_pvip":false,"replies":[{"id":132815,"content":"åŠ æ²¹ï½","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":1275456,"ctime":1671447162,"ip_address":"å¹¿ä¸œ","comment_id":364744,"utype":1}],"discussion_count":1,"race_medal":0,"score":4,"product_id":100312001,"comment_content":"ç»§ç»­è¿½å‰§","like_count":0,"discussions":[{"author":{"id":1275456,"avatar":"https://static001.geekbang.org/account/avatar/00/13/76/40/791d0f5e.jpg","nickname":"ç‹ç‚œ","note":"","ucode":"B6F98A1EC06BDB","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":597115,"discussion_content":"åŠ æ²¹ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1671447162,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"å¹¿ä¸œ","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393226,"user_name":"Geek_72141d","can_delete":false,"product_type":"c1","uid":2608731,"ip_address":"é‡åº†","ucode":"9573E68C340CCD","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epJo44GuuyRFNiaicEbXBpqu1WqLFQ4wj7pernCWibYD2CQyBlqUs0oF9xlFibACdoEmSJp7Ips1xDkiaw/132","comment_is_top":false,"comment_ctime":1723198451,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100312001,"comment_content":"åšå®éªŒç”¨çš„docker imageä¸‹ä¸ä¸‹æ¥ï¼Œå¯ä»¥ä¸Šä¼ åˆ°å›½å†…çš„dockeré•œåƒç«™å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":384079,"user_name":"dj","can_delete":false,"product_type":"c1","uid":1512964,"ip_address":"åŒ—äº¬","ucode":"F6803089067D80","user_header":"https://static001.geekbang.org/account/avatar/00/17/16/04/3168b413.jpg","comment_is_top":false,"comment_ctime":1700229620,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100312001,"comment_content":"$ kubectl -n example  apply  -f .&#47;deploy&#47;hpa.yaml \nresource mapping not found for name: &quot;frontend&quot; namespace: &quot;&quot; from &quot;.&#47;deploy&#47;hpa.yaml&quot;: no matches for kind &quot;HorizontalPodAutoscaler&quot; in version &quot;autoscaling&#47;v2&quot;\nensure CRDs are installed first\nresource mapping not found for name: &quot;backend&quot; namespace: &quot;&quot; from &quot;.&#47;deploy&#47;hpa.yaml&quot;: no matches for kind &quot;HorizontalPodAutoscaler&quot; in version &quot;autoscaling&#47;v2&quot;","like_count":0},{"had_liked":false,"id":384072,"user_name":"dj","can_delete":false,"product_type":"c1","uid":1512964,"ip_address":"åŒ—äº¬","ucode":"F6803089067D80","user_header":"https://static001.geekbang.org/account/avatar/00/17/16/04/3168b413.jpg","comment_is_top":false,"comment_ctime":1700223676,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":4,"product_id":100312001,"comment_content":"åˆ›å»º ingress-nginx æŠ¥é”™  olebinding.rbac.authorization.k8s.io&#47;ingress-nginx-admission created\nclusterrolebinding.rbac.authorization.k8s.io&#47;ingress-nginx created\nclusterrolebinding.rbac.authorization.k8s.io&#47;ingress-nginx-admission created\nconfigmap&#47;ingress-nginx-controller created\nerror: error validating &quot;&#47;mnt&#47;d&#47;gitops&#47;resource&#47;ingress-nginx&#47;ingress-nginx.yaml&quot;: error validating data: \n[ValidationError(Service.spec): unknown field &quot;ipFamilies&quot; in io.k8s.api.core.v1.ServiceSpec, ValidationError(Service.spec): unknown field &quot;ipFamilyPolicy&quot; in io.k8s.api.core.v1.ServiceSpec]; if you choose to ignore these errors, turn validation off with --validate=false","like_count":0}]}