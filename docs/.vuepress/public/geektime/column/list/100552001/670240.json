{"id":670240,"title":"01｜业界的主流消息队列是如何发展起来的？","content":"<p>你好，我是文强。</p><p>作为一个消息队列的老兵，我经常被团队的新同学或者客户的研发人员问：我希望在我们的业务中引入消息队列，应该选择哪一款合适？是不是用最近很火的Pulsar就好了，但是业务团队推荐用RocketMQ或RabbitMQ，而大数据团队推荐用Kafka，有没有什么选择的标准可以参考呢？</p><p>这个问题你之前一定疑惑过，可能也有了一套自己的选择标准，不过遇到这种情况，我都会先反问：你觉得消息队列是做什么的？</p><p>自从负责消息队列云服务之后，我接触了很多客户，发现基本90%以上的用户（大概率你也在其中），业务的数据量都不大，场景也不复杂。只用到了消息队列最基本的生产和消费功能，把消息队列当做缓冲分发的管道，基本不会用到消息队列的高级功能，比如死信队列、事务消息、延时消息等等。</p><p>所以，很多情况下，我们不需要很复杂的消息队列，有些时候甚至都不需要引入业界标准的消息队列产品。是不是和你之前的想法不太一致？今天我们就从这个有点反常识的观点开始讨论。</p><h2>你真的需要标准消息队列吗？</h2><p>我第一次用消息队列是在我负责游戏论坛开发的时候，有一个功能是需要把用户对帖子的评论和点赞数据发给下游分析。你可以想一下，如果你接到这个需求，会怎么做呢？</p><!-- [[[read_end]]] --><p>我的第一个想法就是在流程里面加一个函数，封装一下，再把数据通过 HTTP API 发送给下游，就完成了。</p><p>不过我上级选择了另外一套方案，引入Kafka，在主流程里面先把数据发送到Kafka，再让下游去消费数据。那时候Kafka还是0.8.*的版本，公司用得很少，我们团队也是第一次用，还特意找运维搭了套集群。</p><blockquote>\n<p><span class=\"reference\">Apache Kafka是 LinkedIn 在2011 年贡献给了 Apache 软件基金会的分布式消息队列。主要满足大数据领域中的高吞吐量、低延迟场景。核心功能较为简单，只提供生产和消费，后来加了幂等和事务。采用通用分布式架构实现发布-订阅模型，能高效地处理海量数据。</span></p>\n</blockquote><p>当时我不太理解加Kafka的意义是什么。</p><p>因为我们的需求非常简单，只涉及生产和消费两个动作，而且现网一直在用Redis。当时我认为使用Redis的List实现Push/Pop就可以满足需求，效果是一样的，还省去Kafka的维护和学习成本。进一步，如果担心Redis的数据没做持久化丢失了，也可以通过MySQL的表，把数据insert进去，下游去select出来，也能实现Push/Pop的效果。</p><p>那为什么还是用Kafka呢？</p><p>当时有个业务背景：用户的回复会包含图片和表情等复杂结构数据，导致内容可能会特别长。另外遇到高峰时，回帖数量会特别多，短时间内可能有几千万的回帖，回帖的总内容很大。</p><p>Redis的问题在于数据都存在内存里，如果数据没有及时消费，就会打爆内存。而且因为回帖内容可能很大，在Redis的Value里存大的数据会有性能和稳定性问题。而MySQL在insert上是有性能瓶颈的，短时间内大量回帖，插入会特别频繁，性能就扛不住。</p><p>而Kafka就没有这个问题，作为一个消息队列，它的特点就是高吞吐、大消息、高并发、持久化，不会存在性能、功能、稳定性方面的问题。这就是我们选择Kafka的理由。</p><p>其实如果没有大消息和大流量等复杂场景，是可以选用非标准消息队列产品的。比如在用户状态审核的场景中，只需要向下游传递用户ID和审核结果，结构简单，数量有限。这时候选择非标准消息队列比如Redis和MySQL也是可以的。</p><p><strong>所以，是否选择使用标准消息队列产品，取决于你的数据和业务场景的需求。</strong>当数据量大、场景复杂后，才必须引入标准消息队列，因为它有高吞吐、持久化、长久堆积的特性。</p><p>既然用非标准消息队列也可以满足相应需求，那到底什么是消息队列呢？</p><p>从宏观上来讲，我会认为具有缓冲作用、具备类发布和订阅能力的存储引擎都可以称做消息队列。因为消息队列的最基本功能就是生产和消费，在发布订阅之上，扩展如死信队列、顺序消息、延时消息等高阶能力，并实现高吞吐、低延时、高可靠等特性，就成为了我们所熟知的功能齐全的标准消息队列。</p><p>现在业界都有哪些标准的消息队列呢？我们一起来梳理下。</p><h2><strong>业界都有哪些消息队列？</strong></h2><p>还是跟随我的时间线来看。后来我负责的广告业务用到了另一款消息队列 RabbitMQ，当时我最直观的感觉就是：它功能比Kafka多好多，支持延时消息、死信队列、优先级队列、事务消息等等，业务上也是因为要用到这些功能才选择的RabbitMQ。</p><blockquote>\n<p><span class=\"reference\">RabbitMQ是2007年由国外一家叫做Rabbit的公司开源的，用Erlang 写成的消息队列。主要满足业务中消息总线的场景。特点是功能丰富，低流量下稳定性较高，基本具备消息队列所应该具备的所有功能。缺点是在大流量的情况下会有明显的瓶颈和稳定性风险。</span></p>\n</blockquote><p>当时开源的消息队列并不丰富。基于JMS协议发展出来的ActiveMQ 因为功能和稳定性问题，用的人比较少。Kafka刚开源不久，功能只有生产和消费。AMQP协议的 Erlang 实现 RabbitMQ，因为功能丰富，稳定性较高，成为主流选择。</p><blockquote>\n<p><span class=\"reference\">ActiveMQ 项目最初是由 LogicBlaze 的创始人于 2004 年创建的，支持完成JMS规范的消息队列。因为生态、功能定位方面的原因，在国内用的人并不多。</span><br>\n&nbsp;<br>\n<span class=\"reference\">AMQP是一个消息队列协议规范，它不是一款具体的消息队列。因为不同消息队列的访问协议是不一样的，导致不同的消息队列需要用不同的SDK访问，客户的切换成本很高。2003年，多个金融服务机构希望制定一个消息队列的协议规范，希望不同的消息队列的协议都根据这个标准实现，这样就可以不需要重复开发SDK，不同的应用程序之间的交互和切换可以更简单、更方便。这就是AMQP的由来。</span></p>\n</blockquote><p>不过开源选择少，并不意味着那时候没有好的消息队列可用，商业化的闭源的消息队列一直在蓬勃发展，但需要购买才能使用，而且不便宜。</p><p>比如微软1997年推出的MSMQ、AWS 2004年推出的SQS，而消息队列领域最牛的，某种意义上（从收入维度看）一直都是 IBM MQ，在金融、证券行业用得特别多，几乎一统天下。数据显示，到了2020 年 IBM MQ 每年在全球仍有近 10 亿美金的营收。现在国内各大云厂商消息队列的收入加起来，可能都不够IBM MQ的零头。</p><p>后来开源社区逐渐完善，阿里的 RocketMQ在2017年从Apache基金会毕业，Pulsar也在2018成为了Apache的顶级项目，开源社区生态逐渐繁荣，选择慢慢变多。</p><p><strong>RocketMQ 在定位上和 RabbitMQ 很像，功能丰富，在业务消息中经常会用到</strong>。不过RocketMQ是在移动互联网浪潮下发展起来的，业务场景更加复杂，也支持更多功能，比如消息Tag、消息轨迹、消息查询等等。</p><p>除了功能层面，在架构和性能层面，RabbitMQ开发设计早，当时分布式的设计理念还不成熟，导致它在架构层面的设计存在较大的缺陷，遇到大流量、高并发的时候，容易出现集群不可用、网络分区等情况无法解决。而RocketMQ在分布式架构上实现得更合理优雅，在大流量、高并发的场景下表现优秀稳定。</p><blockquote>\n<p><span class=\"reference\">RocketMQ是2013年阿里研发，2016年开源，可满足大规模微服务场景的消息队列产品。可以理解为是RabbitMQ的高可用、分布式升级版。功能丰富，基本可以满足业务消息场景下的所有需求。稳定性、数据可靠性方面的表现都较好。性能介于RabbitMQ和Kafka之间。</span></p>\n</blockquote><p><strong>Pulsar和Kafka很像，主要定位在流领域，主打大吞吐的流式计算</strong>。但Kafka的功能比较简单，支持基本的发布订阅、幂等、事务消息。Pulsar在满足这些功能的基础上，也希望支持RocketMQ和RabbitMQ的功能，所以功能最丰富。</p><p>除了功能层面，在架构和性能层面上，Pulsar的架构设计比Kafka更符合当前云原生架构，它的定位是Kafka的升级版，主要解决Kafka当前的一些痛点问题，比如集群扩缩容慢、分区迁移需要Rebalance、无法支持超多分区等。性能目前没有特别大的差距。</p><p>不过Pulsar发展时间较短，架构较复杂，功能支持较多，当前阶段在稳定性上Kafka会比Pulsar好非常多。</p><blockquote>\n<p><span class=\"reference\">Pulsar 2017年由 Yahoo 开发的消息队列系统。一开始定位是流计算领域，可以理解为Kafka的升级版，近期希望同时发展消息和流两个方向。其架构上的设计理念较为优秀，比如计算存储分离、弹性、多租户。在功能上目前正在追赶RabbitMQ/RocketMQ。性能层面，和Kafka没有明显的差异。但当前阶段的稳定性还需要提升。</span></p>\n</blockquote><p>这里总结一下，当前开源社区用的较多的消息队列主要有RabbitMQ、Kafka，RocketMQ和Pulsar四款。下面我整理了一张消息队列发展的时间脉络图，供你参考。</p><p><img src=\"https://static001.geekbang.org/resource/image/2a/50/2a40cdcf45f4a1ffea4ca87dc67c0f50.jpg?wh=2076x342\" alt=\"\"></p><p>在开源社区发展的这段时间，国内大厂也一直在自研消息队列，比如阿里的RocketMQ、腾讯的CMQ和TubeMQ、京东的JMQ、字节的BMQ。只是发展程度不一样，有的开源了成为顶级项目，有的慢慢消亡了，有的仅限在公司内部使用。</p><p>虽然有这么多的消息队列，但它们发展的方向其实是一致的。</p><h2>消息队列的发展脉络</h2><p>结合我的个人经历，我们可以从消息队列的历史中抽象出两条交织的发展脉络：上层的需求变化和下层的架构演进。</p><ul>\n<li>从需求发展路径上看，消息队列的发展趋势是：<strong>消息 -&gt; 流 -&gt; 消息和流融合</strong>。</li>\n<li>从架构发展的角度来看，消息队列的发展趋势是：<strong>单机 -&gt; 分布式 -&gt; 云原生/Serverless</strong>。</li>\n</ul><p>在90年代到21世纪初，以IBM MQ和AMQP为代表的消息队列主要满足业务上对消息的需求，即异步通讯、架构解耦。</p><p>2010年左右，移动互联网发展，大数据兴起，传统的消息队列在架构上无法满足大流量的吞吐需求，就发展出了以Kafka为代表的消息队列，主打大吞吐、大流量。我们也进入了分布式的时代，现在大家熟知的消息队列都是分布式的架构，所以会有分区、副本、一致性概念。</p><p>随着业务场景越来越复杂，业务消息的数据量也越来越大。基于开源AMQP的RabbitMQ在性能和架构上已经无法满足消息场景的需求，从而发展出了RocketMQ。</p><p>近几年随着云计算的发展、云原生和Serverless的理念兴起，在弹性、成本的驱动下，消息队列的架构往云原生/Serverless方向演变，简单来说，就是利用云上的弹性计算、存储等基础设施去实现架构的Serverless，按需使用、按量付费，最终达到使用端感受到的免运维、低成本。</p><p>基于云原生架构设计的Pulsar开始走向成熟，业界的MQ也出现了<strong>计算存储分离、分层存储、多租户、弹性计算等概念</strong>。</p><p>云原生/Serverless的发展趋势，你应该听得比较多了，“消息和流融合”的趋势可能有些陌生，我稍微解释一下。</p><h2>什么是消息和流？</h2><p>消息、流分开来看都比较好理解。</p><ul>\n<li>消息就是业务消息，在业务架构（比如微服务架构）中用来作消息传递，做系统的消息总线，比如用户提交订单的流程。</li>\n<li>流，就是在大数据架构中用来做大流量时的数据削峰，比如日志的投递流转。</li>\n</ul><p>消息和流融合就是这两个事情都能做。不过为什么会有消息和流融合的这个趋势呢？</p><p>其实都是钱的原因。虽然消息队列是基础组件，但是功能比较单一，主要是缓冲作用，在消息、流的方向上，功能需求一直是相对固定的，细分的市场也都有领头组件，流领域目前是Kafka一家独大，消息领域的头部玩家，国外是RabbitMQ，国内是RocketMQ。</p><p>对MQ厂商来说，如果希望扩大产品份额或者新品抢占市场，就需要有<strong>独特竞争力，核心就是自己产品的功能和成本，</strong>即功能更多更丰富、成本更低。这里的成本指的是能为客户，也就是消息队列使用者，节省多少资源、人力成本。</p><p>因为对我们使用者来说，业务和大数据都不陌生，日常工作都需要进行业务和数据系统的开发。但是麻烦的问题是：在业务消息中，我们经常需要使用RocketMQ或RabbitMQ，在大数据系统中，我们又需要使用Kafka或Pulsar。</p><p>所以，<strong>运维侧需要运维多款 MQ，研发侧需要学习使用多款MQ</strong>，这在一定程度上拉升了研发和运维的成本。如果有一款消息队列满足所有场景，只需要部署一款消息队列，就能满足所有业务的需求，这种设计思想是非常有商业价值的。</p><p>现在我们也可以看到业界主流的4款消息队列，在消息和流的融合上各有动作。</p><ul>\n<li>RabbitMQ因为开发语言、架构和社区的活跃度、定位的原因，基本不会走这条路。</li>\n<li>Kafka虽然也强调云原生，但目前主要工作在自身的架构优化上，比如去ZooKeeper，暂时在消息方向没有提出明确概念。但在我看来，未来Kafka应该会往这个方向转变，因为流的场景始终会有瓶颈，打通一个新方向在商业上肯定是有价值的。</li>\n<li>RocketMQ在消息领域已经非常成熟，社区也希望打通流的场景，扩展使用范围，提升竞争力，抢占市场，也在往这个方向努力。</li>\n<li>Pulsar是一个新兴架构，没有历史包袱，主打的就是云原生的消息和流的融合架构，希望满足更多场景，解决更多业务需求。</li>\n</ul><h2>总结</h2><p>现在你应该能解答我们开头提出的问题了，广义上讲，消息队列是有缓冲作用、具备类发布和订阅能力的存储引擎。而技术方案如何选择消息队列，来源于业务场景和数据量。如果只需要最基本的生产和消费功能，可以不用标准消息队列产品，大部分公司或业务的场景下，一款消息队列就能满足所有需求了。</p><p>技术的演进都是商业驱动的，消息队列的演进，无论是从需求发展路径上看是消息 -&gt; 流 -&gt; 消息和流融合，还是从架构发展角度的单机 -&gt; 分布式 -&gt; 云原生/Serverless，本质其实都是在思考如何降低成本和吸引客户。</p><p>为了降低成本，弹性是最基础的要求。所以消息队列在技术上，对计算弹性的需求提出了计算存储分离架构，对低存储成本的需求提出了分层存储的概念，对资源复用的需求提出了多租户的概念。</p><p>为了吸引客户，各个消息队列都在尽量提高自己的竞争力，围绕着功能、容灾、多架构、生态建设展开。</p><p>不过要注意，消息和流只是业界的趋势，不是我们作为使用者必然的非此即彼的选择。在开发者实际使用的时候，我也发现很多人会将Kafka当做一个业务消息总线在用，也有人使用RocketMQ传递大流量的日志，当做大数据架构中的管道在用。</p><h2>思考题</h2><p>你现在做的项目业务场景和数据量是什么样的，是否会考虑引入消息队列，你会引入哪款消息队列呢？</p><p>期待看到你的留言，也欢迎你把这节课分享给感兴趣的朋友。我们下节课再见！</p>","neighbors":{"left":{"article_title":"开篇词｜深度拆解核心原理，轻松掌握所有消息队列","id":670207},"right":{"article_title":"02｜消息队列在架构和功能层面都包含哪些概念？","id":670580}},"comments":[{"had_liked":false,"id":376968,"user_name":"Geek_206e82","can_delete":false,"product_type":"c1","uid":1073353,"ip_address":"广东","ucode":"A081F141948B25","user_header":"https://static001.geekbang.org/account/avatar/00/10/60/c9/ebbb52e2.jpg","comment_is_top":false,"comment_ctime":1687779589,"is_pvip":false,"replies":[{"id":137440,"content":"瞬时消息的特性确实很多主流消息队列都不支持，是一个很特殊的场景。 之前接触过公司内部的一个大型游戏团队，也是因为瞬时消息选择使用pulsar。","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1688024292,"ip_address":"广东","comment_id":376968,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100552001,"comment_content":"我是做游戏的，目前我在使用pulsar，功能有瞬时消息，也有顺序消息，能同时满足这2个就pulsar了","like_count":12,"discussions":[{"author":{"id":2347440,"avatar":"https://static001.geekbang.org/account/avatar/00/23/d1/b0/789844a6.jpg","nickname":"好青年","note":"","ucode":"A37A12CEC830F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625769,"discussion_content":"请问 “瞬时消息” 是指什么？ ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1692171633,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622228,"discussion_content":"瞬时消息的特性确实很多主流消息队列都不支持，是一个很特殊的场景。 之前接触过公司内部的一个大型游戏团队，也是因为瞬时消息选择使用pulsar。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1688024292,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377026,"user_name":"顾庆隆","can_delete":false,"product_type":"c1","uid":1106956,"ip_address":"北京","ucode":"BD28175B1D7CC8","user_header":"https://static001.geekbang.org/account/avatar/00/10/e4/0c/a9ac0ca8.jpg","comment_is_top":false,"comment_ctime":1687850937,"is_pvip":false,"replies":[{"id":137418,"content":"你这一说，我也很有兴趣分析一下。这个我记录一下，可能要放到最后了。这个MQ 目前主流比较少用。不过从技术设计上来看，是蛮有参考分析价值的。","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1687876652,"ip_address":"广东","comment_id":377026,"utype":1}],"discussion_count":3,"race_medal":0,"score":2,"product_id":100552001,"comment_content":"文强老师，能不能讲一下Nats，Ｇｏｌａｎｇ编写的消息队列，ＣＮＣＦ孵化的项目，设计上非常有特点，功能和性能都挺出色，与课程中四个消息队列想比，在分布式集群通信、消息持久化设计、集群互通和集群级联通信上别具一格，很想听听老师的分析。","like_count":9,"discussions":[{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622064,"discussion_content":"你这一说，我也很有兴趣分析一下。这个我记录一下，可能要放到最后了。这个MQ 目前主流比较少用。不过从技术设计上来看，是蛮有参考分析价值的。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687876652,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2025816,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/e9/58/7bb2c561.jpg","nickname":"请务必优秀","note":"","ucode":"2B7AE4EF41C972","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":624076,"discussion_content":"期待","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1690192300,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":622064,"ip_address":"湖北","group_id":0},"score":624076,"extra":""}]},{"author":{"id":1106956,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e4/0c/a9ac0ca8.jpg","nickname":"顾庆隆","note":"","ucode":"BD28175B1D7CC8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622092,"discussion_content":"谢谢老师，很期待。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687918006,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376959,"user_name":"张申傲","can_delete":false,"product_type":"c1","uid":1182372,"ip_address":"北京","ucode":"22D46BC529BA8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","comment_is_top":false,"comment_ctime":1687774128,"is_pvip":false,"replies":[{"id":137480,"content":"我理解是商业化层面的考虑，文章中我有写了一下我的观点","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1688201261,"ip_address":"广东","comment_id":376959,"utype":1}],"discussion_count":5,"race_medal":2,"score":2,"product_id":100552001,"comment_content":"请问下老师，消息和流的本质区别是什么呢？我理解流也可以看作是大数据领域的业务消息，只不过消息体是日志、指标等等这些数据，为什么要强调消息和流的融合呢？","like_count":6,"discussions":[{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622392,"discussion_content":"我理解是商业化层面的考虑，文章中我有写了一下我的观点","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688201261,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3532684,"avatar":"","nickname":"Geek_dc33f9","note":"","ucode":"89B6E0661EE260","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622035,"discussion_content":"我觉得处理流需要高吞吐，处理消息需要低延迟。融合就是结合两者优点吧","likes_number":18,"is_delete":false,"is_hidden":false,"ctime":1687860492,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"浙江","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1182372,"avatar":"https://static001.geekbang.org/account/avatar/00/12/0a/a4/828a431f.jpg","nickname":"张申傲","note":"","ucode":"22D46BC529BA8A","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":3532684,"avatar":"","nickname":"Geek_dc33f9","note":"","ucode":"89B6E0661EE260","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622087,"discussion_content":"这个解释很赞~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687915651,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":622035,"ip_address":"北京","group_id":0},"score":622087,"extra":""}]},{"author":{"id":1891437,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/dc/6d/03130ea9.jpg","nickname":"JW","note":"","ucode":"7B73FB16B999E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622178,"discussion_content":"这两个概念确实大且不清晰。偏业务的叫消息，偏数据的叫流。核心就是数量级和格式的区别吧。","likes_number":9,"is_delete":false,"is_hidden":false,"ctime":1687996084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1811277,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a3/4d/59390ba9.jpg","nickname":"排骨","note":"","ucode":"A413CF46211E1F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1891437,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/dc/6d/03130ea9.jpg","nickname":"JW","note":"","ucode":"7B73FB16B999E1","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622709,"discussion_content":"很赞同老哥你的观点，所以偏业务偏向低延迟，偏数据则偏向高吞吐","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1688567889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":622178,"ip_address":"广东","group_id":0},"score":622709,"extra":""}]}]},{"had_liked":false,"id":377208,"user_name":"一一","can_delete":false,"product_type":"c1","uid":1252756,"ip_address":"浙江","ucode":"8F15F87CEDB019","user_header":"https://static001.geekbang.org/account/avatar/00/13/1d/94/80b8a9f4.jpg","comment_is_top":false,"comment_ctime":1688089140,"is_pvip":false,"replies":[{"id":137458,"content":"你能加一下微信群吗，我们在群里聊。这个是一个很有意思的case，我们现网也经常做这个事情。","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1688104662,"ip_address":"广东","comment_id":377208,"utype":1}],"discussion_count":9,"race_medal":0,"score":2,"product_id":100552001,"comment_content":"老师，你好，有没有可能带我们搭一个数据量相对大，并发量相对大的业务测试环境，再接入各种消息队列进行横向测评，对比使用消息队列和不使用消息队列的区别，这样，对我们这种传统行业，平时很少接触到高并发，大数据量的业务场景的小白来说，会不会更加直观，好理解一些？毕竟有了直观的数据，才能印象深刻。","like_count":3,"discussions":[{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622311,"discussion_content":"你能加一下微信群吗，我们在群里聊。这个是一个很有意思的case，我们现网也经常做这个事情。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688104663,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1252756,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1d/94/80b8a9f4.jpg","nickname":"一一","note":"","ucode":"8F15F87CEDB019","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":622409,"discussion_content":"Ok","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688228931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":622311,"ip_address":"浙江","group_id":0},"score":622409,"extra":""}]},{"author":{"id":1101534,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ce/de/31caf2ff.jpg","nickname":"相遇了久别重逢","note":"","ucode":"75B7571520A2A6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":635012,"discussion_content":"没看到微信群二维码","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1704287931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1233810,"avatar":"https://static001.geekbang.org/account/avatar/00/12/d3/92/71f0243d.jpg","nickname":"01","note":"","ucode":"6B1A0B773A17C6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626202,"discussion_content":"你好，请问一下微信群咋么加呀","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1692631205,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"陕西","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1252756,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1d/94/80b8a9f4.jpg","nickname":"一一","note":"","ucode":"8F15F87CEDB019","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1233810,"avatar":"https://static001.geekbang.org/account/avatar/00/12/d3/92/71f0243d.jpg","nickname":"01","note":"","ucode":"6B1A0B773A17C6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626887,"discussion_content":"课程介绍有微信群二维码","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693467563,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":626202,"ip_address":"浙江","group_id":0},"score":626887,"extra":""}]},{"author":{"id":1117318,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","nickname":"花花大脸猫","note":"","ucode":"8ABDB3F7F4FB0F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":625121,"discussion_content":"同问！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1691380002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1252756,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1d/94/80b8a9f4.jpg","nickname":"一一","note":"","ucode":"8F15F87CEDB019","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1117318,"avatar":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","nickname":"花花大脸猫","note":"","ucode":"8ABDB3F7F4FB0F","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":626889,"discussion_content":"课程介绍有微信群二维码","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693467610,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":625121,"ip_address":"浙江","group_id":0},"score":626889,"extra":""}]},{"author":{"id":1568589,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ef/4d/83a56dad.jpg","nickname":"Z.","note":"","ucode":"9C9C97C470D761","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623021,"discussion_content":"请问微信群怎么加呀\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688952987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1252756,"avatar":"https://static001.geekbang.org/account/avatar/00/13/1d/94/80b8a9f4.jpg","nickname":"一一","note":"","ucode":"8F15F87CEDB019","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1568589,"avatar":"https://static001.geekbang.org/account/avatar/00/17/ef/4d/83a56dad.jpg","nickname":"Z.","note":"","ucode":"9C9C97C470D761","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":626888,"discussion_content":"课程介绍中有微信群二维码","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1693467587,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":623021,"ip_address":"浙江","group_id":0},"score":626888,"extra":""}]}]},{"had_liked":false,"id":377047,"user_name":"Geek.Kwok","can_delete":false,"product_type":"c1","uid":1043668,"ip_address":"上海","ucode":"80D38825D990F9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/d4/8f877895.jpg","comment_is_top":false,"comment_ctime":1687866609,"is_pvip":false,"replies":[{"id":137413,"content":"在我看来，业务侧的功能需求是第一考虑项。如果功能上一个MQ都能满足的话，选择只运维一个MQ是可以的，反之就得考虑是否运维多款MQ。","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1687875673,"ip_address":"广东","comment_id":377047,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100552001,"comment_content":"我司就在用 Kafka 当做一个业务消息总线在用，当然同时也用来传递日志。从运维成本的角度考虑，一家公司一般只会选择使用一个MQ。","like_count":3,"discussions":[{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622059,"discussion_content":"在我看来，业务侧的功能需求是第一考虑项。如果功能上一个MQ都能满足的话，选择只运维一个MQ是可以的，反之就得考虑是否运维多款MQ。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687875673,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":376982,"user_name":"OAuth","can_delete":false,"product_type":"c1","uid":1234664,"ip_address":"广东","ucode":"691F528EB533B5","user_header":"https://static001.geekbang.org/account/avatar/00/12/d6/e8/50b58ed8.jpg","comment_is_top":false,"comment_ctime":1687790217,"is_pvip":false,"replies":[{"id":137417,"content":"业务消息类的消息队列，rocketmq我觉得是第一选择","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1687876522,"ip_address":"广东","comment_id":376982,"utype":1}],"discussion_count":1,"race_medal":1,"score":2,"product_id":100552001,"comment_content":"我是做企业供应链的 主要的应用场景是做外围系统与供应链系统的异步数据交换 数据量不大 目前用的rocketmq ","like_count":3,"discussions":[{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622063,"discussion_content":"业务消息类的消息队列，rocketmq我觉得是第一选择","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1687876522,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377663,"user_name":"Geek_f6zh7v","can_delete":false,"product_type":"c1","uid":1027359,"ip_address":"广东","ucode":"67E0CD4E351663","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoyc6BbcH51u0wCyJWwj6cWrQOqm81nr47dhv0jB0e6vba4qZgK3dVDef108rbibKIPOcPs3RgU2zw/132","comment_is_top":false,"comment_ctime":1688973986,"is_pvip":false,"replies":[{"id":137635,"content":"集群扩缩容慢、分区迁移需要 Rebalance：是的，存算分离从理论上可以解决这些问题的。\n无法支持超多分区：和存算分离关系不是特别大，主要和元数据存储(基于Zookeeper)、系统架构有关(比如单机分区的文件的存储方式、Controller等)。","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1689044144,"ip_address":"广东","comment_id":377663,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100552001,"comment_content":"集群扩缩容慢、分区迁移需要 Rebalance、无法支持超多分区  kafka有这些问题是不是主要是因为计算和存储没分离","like_count":1,"discussions":[{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623101,"discussion_content":"集群扩缩容慢、分区迁移需要 Rebalance：是的，存算分离从理论上可以解决这些问题的。\n无法支持超多分区：和存算分离关系不是特别大，主要和元数据存储(基于Zookeeper)、系统架构有关(比如单机分区的文件的存储方式、Controller等)。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1689044144,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377627,"user_name":"杯莫停","can_delete":false,"product_type":"c1","uid":1759325,"ip_address":"四川","ucode":"4FA1D5CBBEF702","user_header":"https://static001.geekbang.org/account/avatar/00/1a/d8/5d/07dfb3b5.jpg","comment_is_top":false,"comment_ctime":1688894153,"is_pvip":false,"replies":[{"id":137621,"content":"是的，很多用户都是这么用的。其实大部分用户的场景不复杂。","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1688950408,"ip_address":"广东","comment_id":377627,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100552001,"comment_content":"我们公司只用到了发布订阅场景，但数据吞吐量比较大，只用到了Kafka","like_count":1,"discussions":[{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":623013,"discussion_content":"是的，很多用户都是这么用的。其实大部分用户的场景不复杂。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688950408,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377560,"user_name":"运维夜谈","can_delete":false,"product_type":"c1","uid":1054300,"ip_address":"广东","ucode":"E2E93375FF5A07","user_header":"https://static001.geekbang.org/account/avatar/00/10/16/5c/d0476f9f.jpg","comment_is_top":false,"comment_ctime":1688715383,"is_pvip":true,"replies":[{"id":137583,"content":"我是这么理解的，这种有两种情况：\n1. 瓶颈在MQ\n2. 瓶颈在消费者\n\n如果是1，就得考虑MQ的调优、扩容、扩分区或者换消息队列等\n如果是2，得排查一下消费者的瓶颈在哪里，然后针对性处理\n\n课程详情有一个微信群二维码，你可以加一下，群里刚好在讨论这个。","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1688794266,"ip_address":"广东","comment_id":377560,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100552001,"comment_content":"老师，请教个问题，数据量大选择消息队列，但有一个问题就是消息的消费效率取决于消费者，消费者消费不过来就导致消息积压，这这样也会影响业务，这如何避免？\n另外，咱有微信群吗？","like_count":1,"discussions":[{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622893,"discussion_content":"我是这么理解的，这种有两种情况：\n1. 瓶颈在MQ\n2. 瓶颈在消费者\n\n如果是1，就得考虑MQ的调优、扩容、扩分区或者换消息队列等\n如果是2，得排查一下消费者的瓶颈在哪里，然后针对性处理\n\n课程详情有一个微信群二维码，你可以加一下，群里刚好在讨论这个。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1688794266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377079,"user_name":"清泉","can_delete":false,"product_type":"c1","uid":2527666,"ip_address":"上海","ucode":"1AB18CC7B97883","user_header":"https://static001.geekbang.org/account/avatar/00/26/91/b2/9f36dc5e.jpg","comment_is_top":false,"comment_ctime":1687918099,"is_pvip":false,"replies":[{"id":137442,"content":"在我接触客户的过程中，确实有接触到用NSQ的客户，但是不多，感觉在国内看起来用的人不多。\n\n","user_name":"作者回复","user_name_real":"编辑","uid":1299071,"ctime":1688024852,"ip_address":"广东","comment_id":377079,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100552001,"comment_content":"感觉没什么人提到NSQ的，难道没什么人玩吗","like_count":0,"discussions":[{"author":{"id":1299071,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/7f/a3d193ea.jpg","nickname":"许文强(LoboXu)","note":"","ucode":"8D6AB35808A88C","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622234,"discussion_content":"在我接触客户的过程中，确实有接触到用NSQ的客户，但是不多，感觉在国内看起来用的人不多。\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1688024852,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1168851,"avatar":"https://static001.geekbang.org/account/avatar/00/11/d5/d3/4b0e8142.jpg","nickname":"Rolle","note":"","ucode":"6BC3DD2BFD9726","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":630666,"discussion_content":"我之前也用过这个的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1698768067,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":377028,"user_name":"aoe","can_delete":false,"product_type":"c1","uid":1121758,"ip_address":"浙江","ucode":"1C6201EDB4E954","user_header":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","comment_is_top":false,"comment_ctime":1687851231,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100552001,"comment_content":"回忆\n以前因为 Kafka 吞吐量最强选择使用，但实际数据量用 MySQL 支撑都绰绰有余；\n后来 Pulsar 出来了，看了介绍比 Kafka 还厉害，心动了，没行动\n最近在使用 RocketMQ 是因为公司决定使用的\n\n业务场景\n「购买商品成功」统计用户消费排名、计算平台与商户收益、计算活动有效期内的相关数据；\n处理第三方回调（因为有一次调用方疯狂请求接口压暴了服务器）；\n「商品秒杀」将 TCP 请求压力转移到 MQ\n\n数据量\n最高峰值：10 万 QPS&#47;秒","like_count":3},{"had_liked":false,"id":378107,"user_name":"ZhiguoXue_IT","can_delete":false,"product_type":"c1","uid":2639055,"ip_address":"北京","ucode":"EAA83F53B54520","user_header":"https://static001.geekbang.org/account/avatar/00/28/44/cf/791d0f5e.jpg","comment_is_top":false,"comment_ctime":1689760372,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":3,"product_id":100552001,"comment_content":"延时消息-我理解在一些延时处理的业务会用到\n死信队列-一般用那种场景呢\n优先级队列、事务消息-实际工作中没用过，作者是如何理解的呢","like_count":1,"discussions":[{"author":{"id":1637475,"avatar":"https://static001.geekbang.org/account/avatar/00/18/fc/63/bcda2f87.jpg","nickname":"熊","note":"","ucode":"B6423D29701EC5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":642038,"discussion_content":"死信队列的场景：之前我们在使用celery类似的分布式任务系统的时候，需要保存异常任务队列以供运维人员确定是否做额外处理/丢弃\n优先级队列：也是在分布式任务调度系统的时候，针对不同优先级的任务，类似保障高优先级任务一定要准时/立即执行\n事务消息：我理解应该主要是针对的电商场景，存在本地事务概念","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1713254480,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"广东","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":396265,"user_name":"walle斌","can_delete":false,"product_type":"c1","uid":1062848,"ip_address":"北京","ucode":"0DB3243004951F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","comment_is_top":false,"comment_ctime":1733810929,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100552001,"comment_content":"也有人使用 RocketMQ 传递大流量的日志，当做大数据架构中的管道在用。\n如果此rocketmq 集群业务也在使用的话，会与比较大的问题，大流量日志这种消息qos级别基本为0，对于rocketmq 存储都在一个文件，会造成commitlog的大量无效数据","like_count":0},{"had_liked":false,"id":394132,"user_name":"左耳朵狮子","can_delete":false,"product_type":"c1","uid":1067280,"ip_address":"美国","ucode":"095DD787E58967","user_header":"https://static001.geekbang.org/account/avatar/00/10/49/10/af49fa20.jpg","comment_is_top":false,"comment_ctime":1725905913,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100552001,"comment_content":"消息列队，use case: （个人经历）\nasync 任务分发， 上下游结偶，point-2-point 异步交流，message retention 时间相对较短。基本顺序保障。Worker-based scaling out\n流处理， user case:\nevents can be replayed later, 日志，IoT(车）的sensor, 实时数据流。data pipeline to DB or lakes. message retention 时间相对较长。消息顺序严格保障在 partition.  Partition based scalling out. ","like_count":0},{"had_liked":false,"id":392261,"user_name":"Geek_frank","can_delete":false,"product_type":"c1","uid":1592177,"ip_address":"福建","ucode":"FC513F40F8D554","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoktzQK57CSMxbrRnHgFhHia5ic4tSzXxgyvZm3dA3BJDFp7ak3zpJD1PXzQzY4BML2V619lrs9fK1g/132","comment_is_top":false,"comment_ctime":1720436000,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100552001,"comment_content":"流，就是在大数据架构中用来做大流量时的数据削峰，比如日志的投递流转。  这个还是没理解！","like_count":0},{"had_liked":false,"id":390293,"user_name":"yongailuma","can_delete":false,"product_type":"c1","uid":2541358,"ip_address":"广东","ucode":"2867A009EC3927","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/sc6Sem7sKWQnjlIhjSx1kzQRlttN7fWC1oEsv4bWvXGPeQNEhYgicdAzDDjjSD6Ev1MSpDgWgxUhnZyibCsy0XGQ/132","comment_is_top":false,"comment_ctime":1715010085,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100552001,"comment_content":"文强老师，微信群还在么？","like_count":0},{"had_liked":false,"id":379178,"user_name":"walle斌","can_delete":false,"product_type":"c1","uid":1062848,"ip_address":"北京","ucode":"0DB3243004951F","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ersGSic8ib7OguJv6CJiaXY0s4n9C7Z51sWxTTljklFpq3ZAIWXoFTPV5oLo0GMTkqW5sYJRRnibNqOJQ/132","comment_is_top":false,"comment_ctime":1691483877,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100552001,"comment_content":"大数据基本都在用kafka，之前我们业务团队历史原因kafka，我们业务这边根据实际情况，努力转到了rocketmq，业务消费kafka的优点没体现出来，跟rocketmq对比的缺点倒是过于明显了","like_count":0},{"had_liked":false,"id":379106,"user_name":"花花大脸猫","can_delete":false,"product_type":"c1","uid":1117318,"ip_address":"江苏","ucode":"8ABDB3F7F4FB0F","user_header":"https://static001.geekbang.org/account/avatar/00/11/0c/86/8e52afb8.jpg","comment_is_top":false,"comment_ctime":1691379910,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100552001,"comment_content":"目前在做监控平台，收集各业务系统的业务处理异常日志（手动埋点封装），通过RabbitMQ进行消息的生产消费处理，但是这个不清楚是属于流处理还是消息处理，我的理解还是在消息，但是会对消息做些类似ETL的加工工作，请教下老师，这个理解是否正确？","like_count":0},{"had_liked":false,"id":377167,"user_name":"春","can_delete":false,"product_type":"c1","uid":3663495,"ip_address":"广东","ucode":"5CCDBC6E4365FE","user_header":"https://static001.geekbang.org/account/avatar/00/37/e6/87/f35aaff1.jpg","comment_is_top":false,"comment_ctime":1688021632,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100552001,"comment_content":"通俗易懂，条条有理，支持老师","like_count":0}]}