{"id":322528,"title":"17 | 远程控制：怎样打造联网的智能电灯？","content":"<p>你好，我是郭朝斌。</p><p>在上一讲，我们把智能电灯开发的实验环境搭好了。今天，我们就一起去完成智能电灯的开发工作，并且连接到腾讯云的<a href=\"https://console.cloud.tencent.com/iotexplorer\">物联网平台</a>吧（如有需要，你可以根据<a href=\"https://shimo.im/sheets/D3VVPdwcYRhhQRXh/MODOC\">这份文档</a>自行采购相关硬件）。</p><p>那为什么一定要连接到一个物联网平台呢？这是因为物联网平台提供了基本的设备管理功能，可以帮助我们更快速地实现设备的远程控制功能。比如说，我们可以通过“腾讯连连”小程序，来控制电灯的状态，而不用自己花费时间和精力去写相应的代码等工作。</p><h2>物联网平台上需要做什么准备？</h2><p>那为什么要选择腾讯云的物联网平台呢？</p><p>主要是两个原因。一方面是，它的平台是开放注册的，我们普通的用户也可以注册来使用，不像很多平台那样需要企业用户才能注册。另一方面是，腾讯云提供的交互方式非常方便，不需要编译，或者下载其他App，在微信上用小程序就可以进行。</p><h3>注册与登录</h3><p>确定了要接入腾讯云的物联网平台以后，我们就需要先在这个平台上做一些准备工作了。准备工作的第一步，当然就是你得先注册个账号并且登录。注册和登录的流程非常简单，你打开<a href=\"https://console.cloud.tencent.com/iotexplorer\">这个链接</a>，一眼就能看明白。</p><p><img src=\"https://static001.geekbang.org/resource/image/a8/4f/a8a8c11d4be7c1e1c6fd69b2febed24f.png?wh=1118*998\" alt=\"\"></p><h3>创建项目和产品</h3><p>登录之后，我们直接进入准备工作的第二步，创建项目和产品。我们先在物联网开发平台创建一个新项目“智能家居”。</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/bc/81/bc6d5d04e08bae0939c3a783775fd281.png?wh=1202*730\" alt=\"\"></p><p>然后，进入这个“智能家居”项目，创建一个新产品“智能电灯”。到这里，我们需要简单设置几个参数：</p><ul>\n<li>产品品类，直接选择“智能生活”--&gt;“电工照明”--&gt;“灯”。</li>\n<li>认证方式选择密钥认证，这个比较简单，而且适合我们的开发板NodeMCU。</li>\n<li>通信方式，选择Wi-Fi。</li>\n<li>数据协议选择“数据模板”，也就是基于物模型来解析数据。</li>\n</ul><p><img src=\"https://static001.geekbang.org/resource/image/cd/f0/cdac3c2b897e53917e9afd6aa28ca7f0.png?wh=1276*1184\" alt=\"\"></p><p>设置完成后，我们就可以点击进入智能电灯这个产品了，然后开始定义物模型。</p><h3>物模型在哪里使用？</h3><p>点击进入产品，我们可以看到“数据模板”界面中列出了“电灯开关”“亮度”“颜色”和“色温”等属性和事件。这些都是平台根据上一步选择的产品品类，自动生成的。</p><p>当然了，我们也可以通过“导入 JSON”的方式，把我们在<a href=\"https://time.geekbang.org/column/article/310441\">第6讲</a>编写的 JSON 文本导入，完成产品功能的定义。</p><p><img src=\"https://static001.geekbang.org/resource/image/15/22/153908e6522de593d07d46346e879722.png?wh=2464*1178\" alt=\"\"></p><p>定义好物模型之后，我们就完成了“设备开发”的工作，需要继续完成“交互开发”配置了。</p><h3>交互界面如何定义？</h3><p>在“交互开发”界面中，我们需要关注两个配置项：“使用官方小程序控制产品”的选项要保持打开，因为我们后面要通过小程序来控制智能电灯；在“扫一扫产品介绍”配置项中，设置产品图片和备注信息。</p><p><img src=\"https://static001.geekbang.org/resource/image/62/27/62a990cf4a6ea288f9770445134a1f27.png?wh=1096*1056\" alt=\"\"></p><p>其他项目，比如“配置引导”“面板配置”和“快捷入口配置”，我们保持默认配置就行，当然你也可以根据自己的喜好进行调整。</p><p>这些都配置好之后，我们就可以开始准备“调试设备”的配置了。</p><h3>为调试设备做准备</h3><p>在“设备调试”界面中，我们创建一个测试设备。点击“新建设备”，输入设备名称“Led_1”。</p><p><img src=\"https://static001.geekbang.org/resource/image/75/54/759caa00ed7f5ebd1c001b18f4808054.png?wh=1198*506\" alt=\"\"></p><p>创建成功后，在测试设备列表中，点击“Led_1”，进入设备的详情页面：</p><p><img src=\"https://static001.geekbang.org/resource/image/9d/e9/9db3727e33082f821c8f21c6b642c1e9.png?wh=2266*686\" alt=\"\"></p><p>在这个“设备信息”标签页，我们可以看到“设备名称”“设备秘钥”和“产品ID”的信息。我们需要把这些信息记录下来，因为在后面设备的开发中需要用到。</p><p>这里有一点我们要注意下。<strong>设备名称（DeviceName）、设备秘钥（SecretKey）和产品ID（ProductID）也经常被称为设备三元组</strong>。它完整地标识了一个设备。在调试阶段，设备名称可以手动命名，不过在正式应用中，为了保证设备名称的唯一性，平台会帮你自动生成设备名称。</p><p>另外，在“设备调试”标签页，你需要点击下图中“二维码”，获取这个设备的二维码，并保存好。因为在后面的步骤中，你需要使用“腾讯连连”小程序扫描这个二维码，将设备添加到小程序中。</p><p><img src=\"https://static001.geekbang.org/resource/image/97/a6/9721c6f1f394c14ca03e72dfe0c55ea6.png?wh=1866*624\" alt=\"\"></p><p>这是我在这个配置界面中定义的产品的二维码。</p><p><img src=\"https://static001.geekbang.org/resource/image/b5/ff/b515137b43f769c249df48b7f6f550ff.png?wh=280*280\" alt=\"\"></p><p>这个二维码的信息内容，如下所示：</p><pre><code>{&quot;DeviceName&quot;:&quot;Led_1&quot;,&quot;ProductId&quot;:&quot;XNXP231VQA&quot;,&quot;Signature&quot;:&quot;2aa86e4e826b49b2a93949955f50761&quot;}\n</code></pre><p>可以看到，这个链接中主要包含了产品ID的信息。每个产品 ID 是唯一的，所以你的产品 ID 与这个不同。</p><p>到这里，我们就完成了腾讯云的物联网开发平台的准备工作。接下来，我们就要实打实地在开发板上，实现一个功能更加完善的智能电灯产品了。</p><h2>如何打造智能电灯设备？</h2><p>在上一讲，我们用代码实现了开发板上LED的控制。不过那个功能非常简单，为了让我们的智能电灯功能更完善，效果更酷炫，我们可以开发更多的功能，主要包括控制LED灯的颜色、开关，并能够实现远程控制。</p><p>我们先看看如何控制灯的颜色。</p><h3>如何控制 LED 灯的颜色？</h3><p>我们使用的 RGB LED 灯模块，是使用 <a href=\"https://en.wikipedia.org/wiki/Pulse-width_modulation\">PWM</a> （Pulse Width Modulation，脉冲宽度调制）来实现控制 LED 的颜色和亮度的。PWM的原理是，通过芯片的数字管脚（GPIO）来获得模拟电路信号的输出，它会控制芯片管脚在高电平和低电平之间进行快速切换。</p><p>那如何产生不同的 PWM 信号呢？这涉及到 2 个 PWM 信号的参数：<strong>频率和占空比</strong>。PWM 信号是一个方波信号，如下图的样子：</p><p><img src=\"https://static001.geekbang.org/resource/image/63/y4/633d089ea84047198dd53f560488fyy4.jpg?wh=2700*765\" alt=\"\"></p><p>频率，是指1秒内方波的周期个数，一个周期包含一个完整的高、低电平变化。比如一个周期是 20 ms（毫秒），那么通过计算：</p><p>1000毫秒/20毫秒 = 50Hz</p><p>我们可以知道方波的频率是50 Hz（赫兹）。</p><p>那PWM输出的方波信号的频率不同，会对我们有什么影响呢？</p><p>如果频率小于 100 Hz的话，我们的肉眼就会感受到灯的闪烁，甚至产生生理上的不适，比如视觉疲劳、偏头痛等。因此，对于 LED 灯，PWM 的频率必须大于 100Hz，最好在 200Hz以上。对于我们选择的NodeMCU 开发板来说，可以选择它支持的最大值，也就是1000Hz。</p><p>在PWM的信号图中，我们还可以看到一个叫做“脉宽时间”的标识，它代表的是一个周期里高电平的占用时间。而所谓的占空比，就是脉宽时间占整个周期时间的比例。比如，脉宽时间是10ms，那占空比的计算公式就是：</p><p>10/20 = 50%</p><p>占空比等于 50%。关于占空比参数，我需要提前说明一下：在 <a href=\"https://docs.micropython.org/en/latest/esp8266/tutorial/pwm.html\">MicroPython 代码</a>中，占空比 Duty 不是使用百分比数值来表示的，而是 0 到 1023 之间的数值。0 代表占空比为 0%，1023 代表占空比为 100%。</p><p>在代码中，当你设置了不同的占空比参数时，对应管脚输出的方波信号也会不同。下图展示了占空比分别为 0%、25%、50%、75% 和 100% 的方波信号，它们的平均电压（下图右侧）逐渐增大。我们正是通过平均电压的变化，达到了控制 LED 颜色和亮度等效果的目的。</p><p><img src=\"https://static001.geekbang.org/resource/image/66/31/66f9943cc758b8d42e165caa47ed7c31.jpg?wh=2700*1842\" alt=\"\"></p><p>关于PWM信号，我们了解这些就够了。接下来，我们解决的问题，就是通过上一讲选定的开发板NodeMCU上的GPIO管脚来控制LED等的颜色了。NodeMCU的<a href=\"https://github.com/nodemcu/nodemcu-devkit-v1.0\">管脚图</a>如下所示：</p><p><img src=\"https://static001.geekbang.org/resource/image/d5/ae/d53af13yy9320eaa90b8ff6cf3c565ae.png?wh=791*703\" alt=\"\" title=\"图片来自GitHub\"></p><p>一下子看到这么多管脚，你不要担心，因为只要关注带浅黄色背景的“GPIO”的几个管脚就够了。</p><p>我们先考虑一个问题，NodeMCU 开发板中的所有 GPIO 管脚都可以连接 RGB LED 模块吗？</p><p>答案是不可以。因为不是所有的 GPIO 管脚都可以输出 PWM 信号。NodeMCU 开发板是基于 ESP8266 芯片的，管脚GPIO0、GPIO2、GPIO4、GPIO5、GPIO12、GPIO13、GPIO14 和 GPIO15 具备 PWM 的输出能力，它们分别对应 NodeMCU 开发板的 D3、D4、D2、D1、D6、D7、D5 和 D8 接口。</p><p>因此，我们选择 D1、D2和D3这三个接口，分别连接 RGB LED 模组的红色、绿色和蓝色通道。</p><p>这里，我提供一下我创建的LED类文件，供你参考：</p><pre><code>from machine import PWM\nfrom machine import Pin\n\nclass Led():\n    &quot;&quot;&quot;\n    创建LED类\n    &quot;&quot;&quot;\n    def __init__(self, rpin, gpin, bpin, freq=1000):\n        &quot;&quot;&quot;\n        构造函数\n        :param pin: 接LED的管脚，必须支持PWM\n        :param freq: PWM的默认频率是1000\n        &quot;&quot;&quot;\n        self.pin_red = Pin(rpin)\n        self.pin_green = Pin(gpin)\n        self.pin_blue = Pin(bpin)\n\n        self.led_red = PWM(self.pin_red, freq = freq)\n        self.led_green = PWM(self.pin_green, freq = freq)\n        self.led_blue = PWM(self.pin_blue, freq = freq)\n\n    def rgb_light(self, red, green, blue, brightness):\n        if red in range(256) and \\\n            green in range(256) and \\\n            blue in range(256) and \\\n            0.0 &lt;= brightness and \\\n            brightness &lt;=1.0:\n            self.led_red.duty(int(red/255*brightness*1023))\n            self.led_green.duty(int(green/255*brightness*1023))\n            self.led_blue.duty(int(blue/255*brightness*1023))\n        else:\n            print(&quot;red green blue must between 0 and 255, and brightness from 0.0 to 1.0&quot;)\n        \n    def deinit(self):\n        &quot;&quot;&quot;\n        析构函数\n        &quot;&quot;&quot;\n        self.led_red.deinit()\n        self.led_green.deinit()\n        self.led_blue.deinit()\n</code></pre><h3>如何控制电灯的开关？</h3><p>智能电灯的“开”和“关”控制，我们使用继电器来实现。</p><p>继电器分为弱电（小电流、低电压）和强电（大电流、高电压）两个部分。其中，弱电的部分可以接微处理芯片；强电部分可以连接交流电设备，比如电风扇、冰箱和灯泡等。继电器其实就像是我们现实生活中“中间人”的角色，它通过电磁器件、或者光耦单元将弱电和强电联系起来，以完成微处理芯片对强电设备的控制。</p><p>在这次的实验中，我使用的一款基于 SRD-05VDC-SL-C 型号的电磁继电器。使用中，模块的控制接口，需要连接 NodeMCU 开发板的 GPIO 管脚。我们通过设置这个 GPIO 的输出电平高、低状态，实现控制继电器强电部分电路的“通”和“断”。</p><p>需要注意的是：在我们这一讲的实战中，继电器强电部分连接的 LED 灯，属于低电压设备，电压不超过 5V，这是对人体没有危害的电压；我们实战的目的是学习知识，在这个基础上，我们基于安全考虑，不建议把继电器的强电部分，连接220V交流电供电的电灯。</p><p>如果你有一定的交流电实践经验，那么在实践时也要注意两点：</p><ol>\n<li>注意自身和周围人的安全，比如强电部分不要有裸露的电线，一定用绝缘胶带包扎好；</li>\n<li>弱电部分的供电，不要使用电脑的 USB 接口；为了电脑设备安全，建议使用独立的电源为开发板供电。</li>\n</ol><p>我同样把我创建的Relay类文件放在这里，供你参考：</p><pre><code>from machine import ADC\nfrom machine import Pin\n\nclass Relay():\n\n    def __init__(self, pin):\n        self.relaypin = Pin(pin, Pin.OUT)\n        self.last_status = 1\n\n    def set_state(self, state):\n        self.relaypin.value(state)\n        self.last_status = state\n</code></pre><h3>智能电灯的整体电路如何搭建？</h3><p>确定了LED的技术方案和继电器后，我们就可以搭建出智能电灯的电路。我简单画了一下电路中各模块的连线情况，你在连接电路的时候按照这个连线来就行。</p><p><img src=\"https://static001.geekbang.org/resource/image/dd/61/dde075941211c591c44ea46cf4673861.png?wh=1306*1018\" alt=\"\"></p><p>电路搭建完成后，你可以运行下面的代码测试一下：</p><pre><code>from machine import PWM, Pin\nimport time \n\n#设置对应红、绿、蓝的三个GPIO管脚\nled_red = PWM(Pin(5), freq = 1000)  \nled_green = PWM(Pin(4), freq = 1000)\nled_blue = PWM(Pin(0), freq = 1000)\n\n#继电器的GPIO管脚\nrelaypin = Pin(16, Pin.OUT)#\n\n#通过PWM的占空比设置颜色\ndef rgb_light(red, green, blue, brightness):\n    pwm_red = led_red.duty(int(red/255*brightness*1023))\n    pwm_green = led_green.duty(int(green/255*brightness*1023))\n    pwm_blue = led_blue.duty(int(blue/255*brightness*1023))\n\nrgb_light(255, 255, 0, 1.0)\n\n#周期点亮、熄灭\nwhile True:\n    relaypin.on()\n    time.sleep(2)\n    relaypin.off()\n    time.sleep(2)\n</code></pre><h3>远程控制如何实现？</h3><p>准备好了智能电灯设备后，要实现远程控制，我们还需要让智能电灯连接到物联网平台。那智能电灯如何与物联网平台通信交互呢？这里就要用到MQTT通信协议了。</p><p>首先，你需要在NodeMCU开发板上安装一个 MQTT 客户端代码库 <a href=\"https://github.com/micropython/micropython-lib/tree/master/umqtt.simple\">umqtt.simple 库</a>。它来自MicroPython官方维护的非内核标准库 <a href=\"https://github.com/micropython/micropython-lib\">micropython-lib</a>，你可以使用upip包管理器来安装。在串口 REPL 中运行下面的命令，就可以完成安装：</p><pre><code>&gt;&gt;&gt; import upip\n&gt;&gt;&gt; upip.install('micropython-umqtt.simple')\n</code></pre><p>安装命令是不是很简单？但是这里有一个前提要求，就是NodeMCU需要连接到Wi-Fi路由器上，也就是能够访问网络，因为这个安装过程是从网络下载安装文件。</p><p>怎么让NodeMCU连接到Wi-Fi路由器呢？你仍然可以通过串口 REPL 来完成。你可以在REPL中依次输入下面的命令来接入网络：</p><pre><code>&gt;&gt;&gt; import network\n&gt;&gt;&gt; wifi = network.WLAN(network.STA_IF)\n&gt;&gt;&gt; wifi.active(True) \n&gt;&gt;&gt; wifi.scan() \n&gt;&gt;&gt; wifi.isconnected() \n&gt;&gt;&gt; wifi.connect('你家中Wi-Fi的SSID', '你家中Wi-Fi密码') \n&gt;&gt;&gt; wifi.isconnected() \n</code></pre><p><strong>安装好 umqtt.simple 库之后，我们需要再设置一下物联网平台的MQTT协议交互的 Topic和具体的连接参数。</strong></p><p>我们用到的MQTT Topic主要有两个：一个用于发布消息，即消息流向是从设备到物联网平台；另一个用于接收订阅消息，即消息流向是从物联网平台到设备。</p><pre><code>#发布消息\n$thing/up/property/ProductID/DeviceName\n\n#接收订阅消息\n$thing/down/property/ProductID/DeviceName\n</code></pre><p>需要注意的是，ProductID和DeviceName需要替换为我们在上面创建设备的具体值。</p><p>设备与物联网平台建立MQTT连接，涉及Broker 服务器地址、端口号、设备ID（ClientID）、用户名（UserName）和密码（Password）。我把这些参数整理到了一张表里，供你参考。</p><p><img src=\"https://static001.geekbang.org/resource/image/12/46/12623e989f7c3d29a7efc1a3e1d86246.jpg?wh=2700*2428\" alt=\"\"></p><p>用户名和密码不太好手动生成，我们可以借助一个<a href=\"https://iot-exp-individual-1258344699.cos.ap-guangzhou.myqcloud.com/password%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7.zip\">网页工具</a>来生成。下载完成后，你可以解压缩，得到一些网页原文件，双击打开sign.html，然后在页面输入设备三元组，点击“Generate”即可生成用户名和密码。</p><p><img src=\"https://static001.geekbang.org/resource/image/72/96/72db80e852a9d87a073c78f8d5272e96.png?wh=1792*1092\" alt=\"\"></p><p>有了这些信息，我们就可以开始为智能电灯设备编写MQTT代码了：</p><pre><code>from LED import Led\nfrom Button import Button\nfrom Relay import Relay\n\nimport time \nimport uasyncio\nimport network\nimport ujson\nfrom umqtt.simple import MQTTClient\n\n&quot;&quot;&quot;\nWi-Fi Gateway : SSID and Password\n&quot;&quot;&quot;\nWIFI_AP_SSID = &quot;你家的Wi-Fi SSID&quot;\nWIFI_AP_PSW = &quot;你家的Wi-Fi密码&quot;\n\n&quot;&quot;&quot;\nQCloud Device Info\n&quot;&quot;&quot;\nDEVICE_NAME = &quot;你的设备名称&quot;\nPRODUCT_ID = &quot;你的产品ID&quot;\nDEVICE_KEY = &quot;你的设备密钥&quot;\n\n&quot;&quot;&quot;\nMQTT topic\n&quot;&quot;&quot;\nMQTT_CONTROL_TOPIC = &quot;$thing/down/property/&quot;+PRODUCT_ID+&quot;/&quot;+DEVICE_NAME\nMQTT_CONTROL_REPLY_TOPIC = &quot;$thing/up/property/&quot;+PRODUCT_ID+&quot;/&quot;+DEVICE_NAME\n\nled = Led(5, 4, 0)\nrelay = Relay(16)\nbutton = Button(14)\n\nmqtt_client = None\ncolor = 0   #enum 0=red, 1=green, 2=blue\nname= &quot;&quot;    #light name. it is optional\nbrightness = 100  # 0%~100%\nlight_changed = False\n\nasync def wifi_connect(ssid, pwd):\n    sta = network.WLAN(network.STA_IF)\n    sta.active(True)\n    sta.connect(ssid, pwd)\n\n    while not sta.isconnected():\n        print(&quot;Wi-Fi Connecting...&quot;)\n        time.sleep_ms(500)\n\ndef mqtt_callback(topic, msg):\n    global led, relay, button\n    global color, name, brightness, light_changed\n\n    print((topic, msg))\n    msg_json = ujson.loads(msg)\n    if msg_json['method'] == 'control':\n        params = msg_json['params']\n\n        power_switch_tmp = params.get('power_switch')\n        if power_switch_tmp is not None:\n            power_switch = power_switch_tmp\n            relay.set_state(power_switch)\n        \n        brightness_tmp = params.get('brightness')\n        if brightness_tmp is not None:\n            brightness = brightness_tmp\n\n        color_tmp = params.get('color')\n        if color_tmp is not None:\n            color = color_tmp\n        \n        name_tmp = params.get('name')\n        if name_tmp is not None:\n            name = name_tmp\n        \n        if brightness_tmp is not None or color_tmp is not None:\n            light_changed = True\n\nasync def mqtt_connect():\n    global mqtt_client\n\n    MQTT_SERVER = PRODUCT_ID + &quot;.iotcloud.tencentdevices.com&quot;\n    MQTT_PORT = 1883\n    MQTT_CLIENT_ID = PRODUCT_ID+DEVICE_NAME\n    MQTT_USER_NAME = &quot;你的用户名&quot;\n    MQTTT_PASSWORD = &quot;你的密码&quot;\n\n    mqtt_client = MQTTClient(MQTT_CLIENT_ID, MQTT_SERVER, MQTT_PORT,MQTT_USER_NAME, MQTTT_PASSWORD, 60)\n    mqtt_client.set_callback(mqtt_callback)\n    mqtt_client.connect()\n\ndef mqtt_report(client, color, name, switch, brightness):\n\n    msg = {\n        &quot;method&quot;: &quot;report&quot;,\n        &quot;clientToken&quot;: &quot;clientToken-2444532211&quot;,\n        &quot;params&quot;: {\n            &quot;color&quot;: color,\n            &quot;color_temp&quot;: 0,\n            &quot;name&quot;: name,\n            &quot;power_switch&quot;: switch,\n            &quot;brightness&quot;: brightness\n        }   \n    }\n\n    client.publish(MQTT_CONTROL_REPLY_TOPIC.encode(), ujson.dumps(msg).encode())\n\nasync def light_loop():\n    global led, relay, button\n    global color, name, brightness, light_changed\n\n    switch_status_last = 1\n    LED_status = 1  \n\n    color = 2   #blue\n    brightness = 100    #here 100% == 1\n    led.rgb_light(0, 0, 255, brightness/100.0)\n\n    time_cnt = 0\n\n    mqtt_client.subscribe(MQTT_CONTROL_TOPIC.encode())\n\n    while True:\n        mqtt_client.check_msg()\n\n        switch_status = button.state()\n        LED_status = relay.state()\n        if switch_status != switch_status_last:\n            if switch_status == 0 and switch_status_last == 1:\n                LED_status = 0 if LED_status else 1\n            relay.set_state(LED_status)\n            switch_status_last = switch_status\n        \n        if light_changed:\n            light_changed = False\n            led.rgb_light(255 if color==0 else 0, 255 if color==1 else 0, 255 if color==2 else 0, brightness/100.0)\n\n        if time_cnt &gt;= 20:\n            mqtt_report(mqtt_client, color, name, LED_status, brightness)\n            time_cnt = 0\n        time_cnt = time_cnt+1\n        uasyncio.sleep_ms(50)\n\nasync def main():\n    global mqtt_client\n\n    # Wi-Fi connection\n    try:\n        await uasyncio.wait_for(wifi_connect(WIFI_AP_SSID, WIFI_AP_PSW), 20)\n    except uasyncio.TimeoutError:\n        print(&quot;wifi connected timeout!&quot;)\n    \n    # MQTT connection\n    try:\n        await uasyncio.wait_for(mqtt_connect(), 20)\n    except uasyncio.TimeoutError:\n        print(&quot;mqtt connected timeout!&quot;)\n\n    await uasyncio.gather(light_loop())\n\nuasyncio.run(main())\n</code></pre><h2>如何通过手机远程控制？</h2><p>在完成代码后，我们通过ampy工具或者pyboard.py工具，将这些源代码上传到NodeMCU开发板中。程序开始自动执行，智能电灯自动接入物联网平台。打开物联网平台的设备调试页面，我们就可以看到设备显示“在线”。</p><p>点击“调试”，通过调试界面发送MQTT消息来控制智能电灯。</p><p><img src=\"https://static001.geekbang.org/resource/image/5d/28/5d03e52c440c12f7d0e00c972223dd28.png?wh=1330*1210\" alt=\"\"></p><p>点击“发送”，物联网平台会向设备发送下面这样的消息内容：</p><pre><code>{\n  &quot;method&quot;: &quot;control&quot;,\n  &quot;clientToken&quot;: &quot;clientToken-e9d920ea-a1f4-4a53-aada-a1d36fbbdd20&quot;,\n  &quot;params&quot;: {\n    &quot;power_switch&quot;: 1,\n    &quot;brightness&quot;: 50,\n    &quot;color&quot;: 0,\n    &quot;color_temp&quot;: 0,\n    &quot;name&quot;: &quot;&quot;\n  }\n}\n</code></pre><p>那怎么通过手机小程序控制电灯呢？这也很好实现，我们只需要在小程序上添加设备，就可以使用小程序界面控制了。</p><p>打开“腾讯连连”小程序，点击“+”按钮，扫描我们在“设备调试”界面保存的二维码，就完成添加动作了。</p><p><img src=\"https://static001.geekbang.org/resource/image/1d/7f/1d7b56914e783d7f5bfe18a633af2e7f.png?wh=1125*2436\" alt=\"\"></p><p>然后，点击设备卡片，进入设备交互界面，就可以进行远程控制了。</p><p><img src=\"https://static001.geekbang.org/resource/image/40/5c/40969abc41cafa86910c231046099d5c.png?wh=1125*2436\" alt=\"\"></p><p>到这里，我们就可以用手机来远程控制智能电灯的开关状态和颜色了。</p><h2>小结</h2><p>在这一讲中，我们边实战边学习了智能电灯的电路组成、程序代码，以及与腾讯云物联网平台进行MQTT通信的相关知识。我再来帮你总结下需要记住的几个核心知识点。</p><ol>\n<li>基于物联网平台开发产品，我们一般需要完成三件事，分别是物理网平台的创建和设置、智能设备的功能开发（每个产品最重要的部分），以及用户交互界面的开发。</li>\n<li>物模型是在物联网平台上定义设备的重要概念，你可以将<a href=\"https://time.geekbang.org/column/article/310441\">第6讲</a>的物模型直接导入来创建设备。</li>\n<li>PWM 是照明控制中非常重要的一种技术手段，了解了频率和占空比的概念，也就掌握了它的工作原理。</li>\n<li>智能电灯通过MQTT通信协议与物联网平台交互。在NodeMCU开发板上可以安装一个 MQTT 客户端代码库 <a href=\"https://github.com/micropython/micropython-lib/tree/master/umqtt.simple\">umqtt.simple 库</a>，来开发MQTT客户端代码。</li>\n</ol><p>其实今天我们控制的 RGB LED 灯只是一颗灯珠，但是在实际产品中，我们很可能要控制多颗 LED。这时候，我们面临的首要问题，就是微控制芯片（MCU）的管脚不够用了。那怎么办呢？</p><p>关于这个问题，行业里已经有很多解决方案了。其中，<a href=\"https://learn.adafruit.com/adafruit-neopixel-uberguide\">NeoPixel</a> 是开源硬件方案，你可以在网上搜索、了解一下，当然也可以和我多多交流。</p><h2>思考题</h2><p>最后，我给你留一道思考题吧。</p><p>在物联网平台的设备调试界面，我们可以发送MQTT 消息来控制设备，而且我还给出了具体的消息内容。你可以和我说说，这个消息的主题（Topic）是什么吗？</p><p>另外，在智能电灯的功能实现中，我们通过继电器实现了电路通断的控制，通过LED灯实现了颜色的调节。你可以实现一下按钮的功能吗？这样就可以通过设备本身来控制电灯的打开和熄灭了。这也更符合现实中灯的样式。</p><p>欢迎你在留言区和我分享你的思考，如果在实战今天的智能电灯控制时遇到了什么问题，也可以和我进一步交流。同时，也欢迎你把今天的内容分享给你的朋友，一起动手实现一个酷炫的智能电灯控制系统吧。</p>","comments":[{"had_liked":false,"id":269053,"user_name":"郭朝斌","can_delete":false,"product_type":"c1","uid":2302171,"ip_address":"","ucode":"2969986E1B3851","user_header":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","comment_is_top":true,"comment_ctime":1608511607,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"9.2233720556431995e+18","product_id":100063601,"comment_content":"关于安信可nodemcu的烧录问题，简单说在原来的命令中增加-fm dio 参数：<br>esptool.py --port &#47;dev&#47;cu.usbserial-0001 --baud 460800 write_flash --flash_size=detect -fm dio 0 esp8266-20200911-v1.13.bin<br><br>这个与我使用的开发板不同，所以本讲中的烧录命令没有-fm dio参数。<br><br>安可信nodemcu为什么需要呢？Flash芯片和ESP8266主芯片是通过SPI通信的，但是有不同的模式，一般Nodemcu模组是使用Quad I&#47;O 模式，但是这个安信可的板子使用的是Dual I&#47;O 模式，所以需要加这个参数明确指定一下。为什么这样采用DIO模式呢？因为这样可以额外空出2个GPIO管脚使用。嵌入式有时就是这样一个管脚都要珍惜。","like_count":5,"discussions":[{"author":{"id":1692568,"avatar":"https://static001.geekbang.org/account/avatar/00/19/d3/98/fd49cff1.jpg","nickname":"L","note":"","ucode":"FA66FC2705C03A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":408868,"discussion_content":"微信群 说是不导流了，我怎么样才能加入？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1635335958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":309236,"user_name":"硕杨Sxuya","can_delete":false,"product_type":"c1","uid":1007257,"ip_address":"","ucode":"A83A1595C9DCF9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/5e/99/6ded8166.jpg","comment_is_top":false,"comment_ctime":1629993062,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"44579666022","product_id":100063601,"comment_content":"最后的微信物联网平台的连接，说明太少了，新手完全不知道操作了什么。<br><br>怎么查看板子运行时候的信息？win 下是打开 PuTTY 就可以进行查看？<br><br>调试的时候，板子是连接电脑、而非直接电源线么？<br><br>除了 main.py 程序，还有三个程序（LED、Relay、Button）也要上传么？<br><br>到了最后不说清楚，对于第一次接触，真的云里雾里。","like_count":11},{"had_liked":false,"id":271414,"user_name":"garlic","can_delete":false,"product_type":"c1","uid":1019579,"ip_address":"","ucode":"FEB147EDB5774E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8e/bb/c039dc11.jpg","comment_is_top":false,"comment_ctime":1609601815,"is_pvip":true,"replies":[{"id":"99259","content":"Great！","user_name":"作者回复","comment_id":271414,"uid":"2302171","ip_address":"","utype":1,"ctime":1610806805,"user_name_real":"郭朝斌"}],"discussion_count":1,"race_medal":1,"score":"31674372887","product_id":100063601,"comment_content":"1. 使用的这个TopicMQTT_CONTROL_TOPIC = &quot;$thing&#47;down&#47;property&#47;&quot;+PRODUCT_ID+&quot;&#47;&quot;+DEVICE_NAME  终端通过 mqtt_client.subscribe，订阅这个Topic的消息<br>2. 按键功能实现使用配套的按钮组件， 将S接入到D5， 另外两端参考继电器接法接入分别到VCC， GND位置<br>学习笔记： https:&#47;&#47;xie.infoq.cn&#47;article&#47;6a9bce475271b9bab147244b8  ","like_count":8,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512922,"discussion_content":"Great！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610806805,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":275273,"user_name":"Il Mostro","can_delete":false,"product_type":"c1","uid":1206850,"ip_address":"","ucode":"D7B4E35A68CD52","user_header":"https://static001.geekbang.org/account/avatar/00/12/6a/42/7d2af646.jpg","comment_is_top":false,"comment_ctime":1611417165,"is_pvip":false,"replies":[{"id":"100776","content":"可以用rtc时钟唤醒，gpio16接reset","user_name":"作者回复","comment_id":275273,"uid":"2302171","ip_address":"","utype":1,"ctime":1612588483,"user_name_real":"郭朝斌"}],"discussion_count":1,"race_medal":0,"score":"10201351757","product_id":100063601,"comment_content":"NodeMCU有睡眠的模式，如何设计一个唤醒的功能。","like_count":2,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514292,"discussion_content":"可以用rtc时钟唤醒，gpio16接reset","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612588483,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269873,"user_name":"董义","can_delete":false,"product_type":"c1","uid":1355748,"ip_address":"","ucode":"DD32318860B411","user_header":"https://static001.geekbang.org/account/avatar/00/14/af/e4/7bbec200.jpg","comment_is_top":false,"comment_ctime":1608821229,"is_pvip":false,"replies":[{"id":"99270","content":"👍","user_name":"作者回复","comment_id":269873,"uid":"2302171","ip_address":"","utype":1,"ctime":1610807871,"user_name_real":"郭朝斌"}],"discussion_count":2,"race_medal":0,"score":"10198755821","product_id":100063601,"comment_content":"实践过程中碰到一些问题,LED类中brightness &gt;=1.0: 应该是brightness &lt;=1.0:<br>这个bug会导致无法调节亮度,且只有亮度设置为100%时才能调整颜色,否则变色逻辑都不会进入.<br>","like_count":3,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512419,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610807871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1785568,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/3e/e0/08069dfc.jpg","nickname":"牛哥哥","note":"","ucode":"2B3926008E97CB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340109,"discussion_content":"我也遇到了这个问题，改了大于号之后依旧不行","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609904163,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269492,"user_name":"黑羽","can_delete":false,"product_type":"c1","uid":1053338,"ip_address":"","ucode":"D68FD2B38A1D0E","user_header":"https://static001.geekbang.org/account/avatar/00/10/12/9a/062f83c8.jpg","comment_is_top":false,"comment_ctime":1608686366,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10198620958","product_id":100063601,"comment_content":"设备上MQTT消息解析模块（python代码） 必须与 物联网平台发送的消息内容（物模型）对应起来，否则是没办法进行消息解析并控制设备","like_count":2},{"had_liked":false,"id":269371,"user_name":"碎步马拉松","can_delete":false,"product_type":"c1","uid":2303998,"ip_address":"","ucode":"9612A9F8FC6DDA","user_header":"https://static001.geekbang.org/account/avatar/00/23/27/fe/e4e0126d.jpg","comment_is_top":false,"comment_ctime":1608626783,"is_pvip":false,"replies":[{"id":"99455","content":"目前还没有看到类似的。可以基于不同部分的来源软件自己搭建","user_name":"作者回复","comment_id":269371,"uid":"2302171","ip_address":"","utype":1,"ctime":1610860455,"user_name_real":"郭朝斌"}],"discussion_count":1,"race_medal":0,"score":"10198561375","product_id":100063601,"comment_content":"老师好，类似腾讯物联网平台的开源项目有推荐么？","like_count":2,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512250,"discussion_content":"目前还没有看到类似的。可以基于不同部分的来源软件自己搭建","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610860455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":305501,"user_name":"Geek_00be5c","can_delete":false,"product_type":"c1","uid":2273498,"ip_address":"","ucode":"1281317D562862","user_header":"","comment_is_top":false,"comment_ctime":1627999775,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5922967071","product_id":100063601,"comment_content":"继电器 我连nc 和co 会亮   co和no不亮   为什么反了","like_count":1},{"had_liked":false,"id":298118,"user_name":"严炎","can_delete":false,"product_type":"c1","uid":2646561,"ip_address":"","ucode":"EAD8D6E7851495","user_header":"https://static001.geekbang.org/account/avatar/00/28/62/21/a2c4b47d.jpg","comment_is_top":false,"comment_ctime":1623917524,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5918884820","product_id":100063601,"comment_content":"郭老师，用户名和密码生产那个网页打开不了了，能再发一下吗","like_count":1},{"had_liked":false,"id":275433,"user_name":"俊瑶先森 | J꯭u꯭n꯭ ®","can_delete":false,"product_type":"c1","uid":1308674,"ip_address":"","ucode":"D6A1CB7C734475","user_header":"https://static001.geekbang.org/account/avatar/00/13/f8/02/dc76f4dd.jpg","comment_is_top":false,"comment_ctime":1611538906,"is_pvip":false,"replies":[{"id":"100775","content":"这是为了降低难度，如果有兴趣我们可以交流，如果有服务器开发经验，搭建一个平台也没有那么难。","user_name":"作者回复","comment_id":275433,"uid":"2302171","ip_address":"","utype":1,"ctime":1612587756,"user_name_real":"郭朝斌"}],"discussion_count":2,"race_medal":0,"score":"5906506202","product_id":100063601,"comment_content":"我还以为是自己搭建平台。居然是。。。腾讯云物联网。。。。服气。。。","like_count":1,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514341,"discussion_content":"这是为了降低难度，如果有兴趣我们可以交流，如果有服务器开发经验，搭建一个平台也没有那么难。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612587756,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1057843,"avatar":"https://static001.geekbang.org/account/avatar/00/10/24/33/bcf37f50.jpg","nickname":"阿甘","note":"","ucode":"BC93175B70E05D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":548208,"discussion_content":"为了能够端到端的搞清楚整个流程，强烈建议老师把服务端的部分在加餐中补上。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643080971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":514341,"ip_address":""},"score":548208,"extra":""}]}]},{"had_liked":false,"id":275139,"user_name":"Il Mostro","can_delete":false,"product_type":"c1","uid":1206850,"ip_address":"","ucode":"D7B4E35A68CD52","user_header":"https://static001.geekbang.org/account/avatar/00/12/6a/42/7d2af646.jpg","comment_is_top":false,"comment_ctime":1611325615,"is_pvip":false,"replies":[{"id":"100779","content":"当然，本身就可以通过USB供电，同时在电脑上通过串口软件查看控制台信息","user_name":"作者回复","comment_id":275139,"uid":"2302171","ip_address":"","utype":1,"ctime":1612588788,"user_name_real":"郭朝斌"}],"discussion_count":1,"race_medal":0,"score":"5906292911","product_id":100063601,"comment_content":"开发板日志如何查看，开发板在接通电源的情况下是否可以用USB连接至电脑","like_count":1,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514226,"discussion_content":"当然，本身就可以通过USB供电，同时在电脑上通过串口软件查看控制台信息","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612588788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269802,"user_name":"Geek_eb46b7","can_delete":false,"product_type":"c1","uid":2307745,"ip_address":"","ucode":"53394543572702","user_header":"","comment_is_top":false,"comment_ctime":1608790654,"is_pvip":false,"replies":[{"id":"99274","content":"python的repl支持交互操作的","user_name":"作者回复","comment_id":269802,"uid":"2302171","ip_address":"","utype":1,"ctime":1610808049,"user_name_real":"郭朝斌"}],"discussion_count":1,"race_medal":0,"score":"5903757950","product_id":100063601,"comment_content":"老师，编写好的代码，有本地电脑端的调试方式吗？<br>每次改了，在传到 NodeMCU 开发板，验证对错调试，有点繁琐。","like_count":1,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512396,"discussion_content":"python的repl支持交互操作的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610808049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269188,"user_name":"Lijkxb","can_delete":false,"product_type":"c1","uid":2113971,"ip_address":"","ucode":"6FEB32CD80C971","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/TGh6CMbqtMvXJbJcJxU4W0SaQ0Cpp2wCzHpHpDhgrOgqWHjmbQERqDDRLkxfQUzMFzyY0BGGL3kyJYcUfZddNg/132","comment_is_top":false,"comment_ctime":1608551372,"is_pvip":false,"replies":[{"id":"99459","content":"通过开发板的串口信息和平台的调试信息，确认连接平台是否成功。成功后即会激活","user_name":"作者回复","comment_id":269188,"uid":"2302171","ip_address":"","utype":1,"ctime":1610861536,"user_name_real":"郭朝斌"}],"discussion_count":7,"race_medal":0,"score":"5903518668","product_id":100063601,"comment_content":"我的电灯状态一直显示“未激活”，不知道哪里出了问题，有成功实现的朋友可以帮我分析一下吗？<br><br>目前已进行的操作：<br>接线完成，LED可以正常闪烁，连接wifi成功，下载好了umqtt，然后把LED.py、Relay.py、Button.py创建好，传到了esp8266中。在main.py修改的相关信息也修改好了。<br>不知道哪里有问题<br><br>import os<br>&gt;&gt;&gt; os.listdir()<br>[&#39;Button.py&#39;, &#39;LED.py&#39;, &#39;Relay.py&#39;, &#39;boot.py&#39;, &#39;lib&#39;, &#39;main.py&#39;, &#39;webrepl_cfg.py&#39;]<br>&gt;&gt;&gt; os.listdir(&#39;lib&#39;)<br>[&#39;umqtt&#39;]<br><br>是不是腾讯云的开发平台设置有什么要避免的坑？还是说我其他地方操作不到呢？","like_count":1,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512181,"discussion_content":"通过开发板的串口信息和平台的调试信息，确认连接平台是否成功。成功后即会激活","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610861536,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005944,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/78/4f384f93.jpg","nickname":"龙","note":"","ucode":"B353E8002D2BF3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337338,"discussion_content":"同样没找到Button代码","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608878131,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1150696,"avatar":"https://static001.geekbang.org/account/avatar/00/11/8e/e8/f1e12f2e.jpg","nickname":"青木","note":"","ucode":"2B566ABDAD1339","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337090,"discussion_content":"Button.py 模块的代码是什么？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608794320,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2113971,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/TGh6CMbqtMvXJbJcJxU4W0SaQ0Cpp2wCzHpHpDhgrOgqWHjmbQERqDDRLkxfQUzMFzyY0BGGL3kyJYcUfZddNg/132","nickname":"Lijkxb","note":"","ucode":"6FEB32CD80C971","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1150696,"avatar":"https://static001.geekbang.org/account/avatar/00/11/8e/e8/f1e12f2e.jpg","nickname":"青木","note":"","ucode":"2B566ABDAD1339","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337370,"discussion_content":"老师没有给Button的代码，在思考题里让自己完善。事实上正常的运行起来不需要 Button 模块，把这部分代码注释掉，绕开就可以了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1608884725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":337090,"ip_address":""},"score":337370,"extra":""}]},{"author":{"id":2113971,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/TGh6CMbqtMvXJbJcJxU4W0SaQ0Cpp2wCzHpHpDhgrOgqWHjmbQERqDDRLkxfQUzMFzyY0BGGL3kyJYcUfZddNg/132","nickname":"Lijkxb","note":"","ucode":"6FEB32CD80C971","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336622,"discussion_content":"我鼓捣了一下午，成功了。可能是 main.py中， line 143 的代码缩进问题。\n我下载了一个 uPyCraft 可以进行 debug","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608636233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1271831,"avatar":"https://static001.geekbang.org/account/avatar/00/13/68/17/8cc195cc.jpg","nickname":"小叶","note":"","ucode":"639A452A0634FA","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":2113971,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/TGh6CMbqtMvXJbJcJxU4W0SaQ0Cpp2wCzHpHpDhgrOgqWHjmbQERqDDRLkxfQUzMFzyY0BGGL3kyJYcUfZddNg/132","nickname":"Lijkxb","note":"","ucode":"6FEB32CD80C971","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337573,"discussion_content":"我也是遇到代码缩进问题……","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608978974,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":336622,"ip_address":""},"score":337573,"extra":""},{"author":{"id":2302376,"avatar":"https://static001.geekbang.org/account/avatar/00/23/21/a8/8ac2ccb3.jpg","nickname":"风ffff","note":"","ucode":"5422485EA3265F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2113971,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/TGh6CMbqtMvXJbJcJxU4W0SaQ0Cpp2wCzHpHpDhgrOgqWHjmbQERqDDRLkxfQUzMFzyY0BGGL3kyJYcUfZddNg/132","nickname":"Lijkxb","note":"","ucode":"6FEB32CD80C971","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340757,"discussion_content":"老哥组装图能给我看看吗 我这没反应 也不知道为啥 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610119735,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":336622,"ip_address":""},"score":340757,"extra":""}]}]},{"had_liked":false,"id":268781,"user_name":"小胖","can_delete":false,"product_type":"c1","uid":1117641,"ip_address":"","ucode":"A4071FEA1BA18C","user_header":"https://static001.geekbang.org/account/avatar/00/11/0d/c9/eb444e29.jpg","comment_is_top":false,"comment_ctime":1608347406,"is_pvip":false,"replies":[{"id":"99468","content":"👍","user_name":"作者回复","comment_id":268781,"uid":"2302171","ip_address":"","utype":1,"ctime":1610863677,"user_name_real":"郭朝斌"}],"discussion_count":2,"race_medal":0,"score":"5903314702","product_id":100063601,"comment_content":" dir(network)<br>[&#39;__class__&#39;, &#39;__name__&#39;, &#39;AP_IF&#39;, &#39;AUTH_OPEN&#39;, &#39;AUTH_WEP&#39;, &#39;AUTH_WPA2_PSK&#39;, &#39;AUTH_WPA_PSK&#39;, &#39;AUTH_WPA_WPA2_PSK&#39;, &#39;MODE_11B&#39;, &#39;MODE_11G&#39;, &#39;MODE_11N&#39;, &#39;STAT_CONNECTING&#39;, &#39;STAT_CONNECT_FAIL&#39;, &#39;STAT_GOT_IP&#39;, &#39;STAT_IDLE&#39;, &#39;STAT_NO_AP_FOUND&#39;, &#39;STAT_WRONG_PASSWORD&#39;, &#39;STA_IF&#39;, &#39;WLAN&#39;, &#39;phy_mode&#39;]<br><br>连接WIFI:<br>import network<br>sta_if = network.WLAN(network.STA_IF)<br>sta_if.active(True)<br>sta_if.connect( essid, passowrd)","like_count":1,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512035,"discussion_content":"👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610863677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":336141,"discussion_content":"是的，需要用WLAN","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608513514,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":336319,"user_name":"小伟","can_delete":false,"product_type":"c1","uid":1026271,"ip_address":"","ucode":"BF17F586365E65","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a8/df/a206a1a2.jpg","comment_is_top":false,"comment_ctime":1646072206,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1646072206","product_id":100063601,"comment_content":"本节课程代码供大家参考<br>定时开关测试: https:&#47;&#47;github.com&#47;Kevin181&#47;geektime&#47;tree&#47;main&#47;iot&#47;led&#47;time<br>联网控制: https:&#47;&#47;github.com&#47;Kevin181&#47;geektime&#47;tree&#47;main&#47;iot&#47;led&#47;network-control","like_count":1},{"had_liked":false,"id":336090,"user_name":"小伟","can_delete":false,"product_type":"c1","uid":1026271,"ip_address":"","ucode":"BF17F586365E65","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a8/df/a206a1a2.jpg","comment_is_top":false,"comment_ctime":1645896516,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1645896516","product_id":100063601,"comment_content":"老师“MQTT 代码”里的代码需要修正下，第141行的&quot;uasyncio.sleep_ms(50)&quot; 应为&quot;await uasyncio.sleep_ms(50) &quot; ，不加await会导致睡眠失效，死循环无休眠时间，持续不断向云平台上报信息。<br>老师应该忘了是异步线程了，async和await搭配，这个望修订下，初学者不知错误会无法继续，稍后我也会将我的代码上传到github后分享，感谢老师的指导和分享","like_count":0},{"had_liked":false,"id":314432,"user_name":"杨磊","can_delete":false,"product_type":"c1","uid":1796475,"ip_address":"","ucode":"20FBF43491D80D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/qZ3bvj9j1KibcY7zkv2XS0gDF9oUrkx7zjucHCnIwCnBM6KYUBQUjyXAO3wkNlPiawTNVicKKwNjFkQxv0feHJUdQ/132","comment_is_top":false,"comment_ctime":1633050236,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633050236","product_id":100063601,"comment_content":"这节需要琢磨的问题特别多，郭老师可否帮忙拉我进同学群互相帮助。我微信18675628350<br>后来的同学也可以加我微信一起学习进步。","like_count":0},{"had_liked":false,"id":301305,"user_name":"大力水手","can_delete":false,"product_type":"c1","uid":1527275,"ip_address":"","ucode":"6DA92B8929DCC2","user_header":"https://static001.geekbang.org/account/avatar/00/17/4d/eb/5ff52c77.jpg","comment_is_top":false,"comment_ctime":1625625296,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1625625296","product_id":100063601,"comment_content":"电路连接除了5、4、0、16之外，另外几个连线是做什么的？另外，如果继电器接强电的话是怎么接呢？","like_count":0,"discussions":[{"author":{"id":2991107,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/a4/03/4200b029.jpg","nickname":"林 杰","note":"","ucode":"9502BB50B4D402","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":569731,"discussion_content":"学学电工知识吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651540708,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297490,"user_name":"流云","can_delete":false,"product_type":"c1","uid":2330527,"ip_address":"","ucode":"4DA4CE36520724","user_header":"https://static001.geekbang.org/account/avatar/00/23/8f/9f/0767e5a5.jpg","comment_is_top":false,"comment_ctime":1623576854,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1623576854","product_id":100063601,"comment_content":"设备订阅的主题:thing&#47;down&#47;property&#47;ProductID&#47;DeviceName。<br>设备发布的主题:thing&#47;up&#47;property&#47;ProductID&#47;DeviceName <br>老师，我其实有个疑问，订阅和发布不是在一条消息流里的吗，怎么在这里说的是两条信息流?不应该是物联网平台这边发布一条消息，然后设备端这边订阅一条消息，发布和订阅不应该是一条主题吗?","like_count":0,"discussions":[{"author":{"id":2646561,"avatar":"https://static001.geekbang.org/account/avatar/00/28/62/21/a2c4b47d.jpg","nickname":"严炎","note":"","ucode":"EAD8D6E7851495","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":379471,"discussion_content":"你好，可以加个微信交流一下吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623917407,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290528,"user_name":"李益达","can_delete":false,"product_type":"c1","uid":1025265,"ip_address":"","ucode":"6C2569A97B39F7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a4/f1/1d889d57.jpg","comment_is_top":false,"comment_ctime":1619601110,"is_pvip":false,"replies":[{"id":"106634","content":"本来是希望你们能够动手写一写的。<br>可以加微信群和大家交流一下，有人分享过。","user_name":"作者回复","comment_id":290528,"uid":"2302171","ip_address":"","utype":1,"ctime":1621694174,"user_name_real":"郭朝斌"}],"discussion_count":2,"race_medal":0,"score":"1619601110","product_id":100063601,"comment_content":"Button.py 文件我怎么没有看到","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519229,"discussion_content":"本来是希望你们能够动手写一写的。\n可以加微信群和大家交流一下，有人分享过。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621694174,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1028132,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/b0/24/bb1297cf.jpg","nickname":"z","note":"","ucode":"8A64B9354556CE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":592112,"discussion_content":"微信群号在哪里？ 没找着","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1667119058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":519229,"ip_address":"广东"},"score":592112,"extra":""}]}]},{"had_liked":false,"id":289977,"user_name":"杨磊","can_delete":false,"product_type":"c1","uid":1796475,"ip_address":"","ucode":"20FBF43491D80D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/qZ3bvj9j1KibcY7zkv2XS0gDF9oUrkx7zjucHCnIwCnBM6KYUBQUjyXAO3wkNlPiawTNVicKKwNjFkQxv0feHJUdQ/132","comment_is_top":false,"comment_ctime":1619302374,"is_pvip":false,"replies":[{"id":"106698","content":"看一下平台更新的文档，按照文档来就行，只是界面改了改，内部的步骤和细节变化不大。","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1621760017,"ip_address":"","comment_id":289977,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1619302374","product_id":100063601,"comment_content":"腾讯的物联网平台改版了，不知怎么用了，配不上物模型！","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519080,"discussion_content":"看一下平台更新的文档，按照文档来就行，只是界面改了改，内部的步骤和细节变化不大。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621760017,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1796475,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/qZ3bvj9j1KibcY7zkv2XS0gDF9oUrkx7zjucHCnIwCnBM6KYUBQUjyXAO3wkNlPiawTNVicKKwNjFkQxv0feHJUdQ/132","nickname":"杨磊","note":"","ucode":"20FBF43491D80D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375667,"discussion_content":"谢谢老师，请问如何加入同学微信群？\n通过极客时间的官方账号加不上","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621809139,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288933,"user_name":"杨磊","can_delete":false,"product_type":"c1","uid":1796475,"ip_address":"","ucode":"20FBF43491D80D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/qZ3bvj9j1KibcY7zkv2XS0gDF9oUrkx7zjucHCnIwCnBM6KYUBQUjyXAO3wkNlPiawTNVicKKwNjFkQxv0feHJUdQ/132","comment_is_top":false,"comment_ctime":1618793214,"is_pvip":false,"replies":[{"id":"106680","content":"长针脚的电位器。DHT11。","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1621758044,"ip_address":"","comment_id":288933,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1618793214","product_id":100063601,"comment_content":"调速电位器 2👈信SHLIczBr4HO信 https:&#47;&#47;m.tb.cn&#47;h.4m0orgZ?sm=706fd7 WH138-1 B 5K&#47;10K&#47;20K&#47;50K&#47;100K&#47;250K&#47;500K 带开关调光调速电位器   <br>温湿度传感器 5👈啊tzc6czBI4No信 https:&#47;&#47;m.tb.cn&#47;h.4liAEQh?sm=2dc02f DHT11 DHT22温湿度传感器SHT30&#47;31数字开关 AM2302电子积木模块   <br><br>这两个不知买哪个型号","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518773,"discussion_content":"长针脚的电位器。DHT11。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621758044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":288804,"user_name":"杨磊","can_delete":false,"product_type":"c1","uid":1796475,"ip_address":"","ucode":"20FBF43491D80D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/qZ3bvj9j1KibcY7zkv2XS0gDF9oUrkx7zjucHCnIwCnBM6KYUBQUjyXAO3wkNlPiawTNVicKKwNjFkQxv0feHJUdQ/132","comment_is_top":false,"comment_ctime":1618703728,"is_pvip":false,"replies":[{"id":"106678","content":"从哪里购买的？如果极客商城的话，你需要找一下商城的同学。","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1621757645,"ip_address":"","comment_id":288804,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1618703728","product_id":100063601,"comment_content":"购买的硬件材料里没有看到Led灯啊","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518743,"discussion_content":"从哪里购买的？如果极客商城的话，你需要找一下商城的同学。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621757645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1796475,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/qZ3bvj9j1KibcY7zkv2XS0gDF9oUrkx7zjucHCnIwCnBM6KYUBQUjyXAO3wkNlPiawTNVicKKwNjFkQxv0feHJUdQ/132","nickname":"杨磊","note":"","ucode":"20FBF43491D80D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368650,"discussion_content":"就是“RGB模块”","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618793256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283424,"user_name":"InfoQ_Albert","can_delete":false,"product_type":"c1","uid":1290413,"ip_address":"","ucode":"B4C16362EDC7A9","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIVlib8n4JZhIomleMIyJTrbhn81kXG39DhJzrFMwmwxFsHCkicsC4CmY5Ft8icmzibWzmvibsDKDP3ORQ/132","comment_is_top":false,"comment_ctime":1615778314,"is_pvip":false,"replies":[{"id":"106667","content":"阿里云等都有类似的平台，可以自己探索一下","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1621756565,"ip_address":"","comment_id":283424,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615778314","product_id":100063601,"comment_content":"老师，我想问一下，物联网平台除了腾讯云，还有其它推介的吗？","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517037,"discussion_content":"阿里云等都有类似的平台，可以自己探索一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621756565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":282241,"user_name":"奔跑的天蓝色蜗牛","can_delete":false,"product_type":"c1","uid":1142896,"ip_address":"","ucode":"2EB20C86A729E9","user_header":"https://static001.geekbang.org/account/avatar/00/11/70/70/381820ff.jpg","comment_is_top":false,"comment_ctime":1615172534,"is_pvip":false,"replies":[{"id":"106684","content":"作为元数据平台就可以解析数据，并且设置报警阈值，和腾讯连连小程序的联动都需要这个物模型的","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1621758449,"ip_address":"","comment_id":282241,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615172534","product_id":100063601,"comment_content":"为什么需要把物模型记录在腾讯云中，感觉应该不是技术上必要，是作为元数据方便查看吧？","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516676,"discussion_content":"作为元数据平台就可以解析数据，并且设置报警阈值，和腾讯连连小程序的联动都需要这个物模型的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621758449,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280654,"user_name":"大王叫我来巡山","can_delete":false,"product_type":"c1","uid":1323223,"ip_address":"","ucode":"DC23F4F0444F4F","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/d7/4999e677.jpg","comment_is_top":false,"comment_ctime":1614305842,"is_pvip":false,"replies":[{"id":"102042","content":"网络运营商、服务器、路由器等都有可能。这个MicroPython官方的umqtt的库比较简单，没有中断的异常上报。你可以通过client定期发送ping（ping（）函数），然后监测接收PINGRESP消息来判断是否连接正常。连接异常时调用连接函数，来重新连接broker。","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1614576677,"ip_address":"","comment_id":280654,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614305842","product_id":100063601,"comment_content":"大概在一段时间后, 腾讯云服务器会自动接收到下线通知????  我看wifi还连着. 这个和所谓的睡眠模式有关系么","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516168,"discussion_content":"网络运营商、服务器、路由器等都有可能。这个MicroPython官方的umqtt的库比较简单，没有中断的异常上报。你可以通过client定期发送ping（ping（）函数），然后监测接收PINGRESP消息来判断是否连接正常。连接异常时调用连接函数，来重新连接broker。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614576677,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280629,"user_name":"大王叫我来巡山","can_delete":false,"product_type":"c1","uid":1323223,"ip_address":"","ucode":"DC23F4F0444F4F","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/d7/4999e677.jpg","comment_is_top":false,"comment_ctime":1614299465,"is_pvip":false,"replies":[{"id":"102043","content":"可以自定义的","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1614576693,"ip_address":"","comment_id":280629,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1614299465","product_id":100063601,"comment_content":"Topic可以自定义么？还是必须要像文中的这种格式","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516157,"discussion_content":"可以自定义的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614576693,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280568,"user_name":"大王叫我来巡山","can_delete":false,"product_type":"c1","uid":1323223,"ip_address":"","ucode":"DC23F4F0444F4F","user_header":"https://static001.geekbang.org/account/avatar/00/14/30/d7/4999e677.jpg","comment_is_top":false,"comment_ctime":1614249145,"is_pvip":false,"replies":[{"id":"102044","content":"电脑上安装串口软件，连接nodemcu来查看","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1614576753,"ip_address":"","comment_id":280568,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1614249145","product_id":100063601,"comment_content":"老师,main.py的代码运行在nodemcu 上面 可是调试的print 怎么查看了???","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516138,"discussion_content":"电脑上安装串口软件，连接nodemcu来查看","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614576753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1323223,"avatar":"https://static001.geekbang.org/account/avatar/00/14/30/d7/4999e677.jpg","nickname":"大王叫我来巡山","note":"","ucode":"DC23F4F0444F4F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351488,"discussion_content":"用类似putty这类软件 串口方式查看\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614304730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278572,"user_name":"roger","can_delete":false,"product_type":"c1","uid":1756787,"ip_address":"","ucode":"9D0D9336389926","user_header":"https://static001.geekbang.org/account/avatar/00/1a/ce/73/551f7b09.jpg","comment_is_top":false,"comment_ctime":1613089926,"is_pvip":true,"replies":[{"id":"102066","content":"如果是商城中的继电器，3.3v可以","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1614580294,"ip_address":"","comment_id":278572,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1613089926","product_id":100063601,"comment_content":"5v的继电器用3.3v电压能驱动吗?感觉我这有点问题","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515432,"discussion_content":"如果是商城中的继电器，3.3v可以","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614580294,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1756787,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/ce/73/551f7b09.jpg","nickname":"roger","note":"","ucode":"9D0D9336389926","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":349580,"discussion_content":"经过测试，3.3v的输出电压确实不能驱动继电器。换了5 v电源成功驱动。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613351962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":275233,"user_name":"Geek_7dd590","can_delete":false,"product_type":"c1","uid":2413319,"ip_address":"","ucode":"B70579B53EAEA5","user_header":"","comment_is_top":false,"comment_ctime":1611400781,"is_pvip":false,"replies":[{"id":"100777","content":"进群了吗？群里有人分享过","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1612588561,"ip_address":"","comment_id":275233,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1611400781","product_id":100063601,"comment_content":"这个硬件电路搭建  有没有实物照片的？和买的可能对不上么","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514273,"discussion_content":"进群了吗？群里有人分享过","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612588561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1796475,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/qZ3bvj9j1KibcY7zkv2XS0gDF9oUrkx7zjucHCnIwCnBM6KYUBQUjyXAO3wkNlPiawTNVicKKwNjFkQxv0feHJUdQ/132","nickname":"杨磊","note":"","ucode":"20FBF43491D80D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368645,"discussion_content":"怎么进群？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618791010,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":270322,"user_name":"王宁","can_delete":false,"product_type":"c1","uid":1048061,"ip_address":"","ucode":"4E6258270B7BE9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/fd/fd/1e3d14ee.jpg","comment_is_top":false,"comment_ctime":1609066126,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1609066126","product_id":100063601,"comment_content":"wifi连接程序连接成功了。<br>通过小程序也可以正常下发指令，但是感觉线路组装的有问题。<br>有无同学发下组装的器件图？","like_count":0},{"had_liked":false,"id":269818,"user_name":"青木","can_delete":false,"product_type":"c1","uid":1150696,"ip_address":"","ucode":"2B566ABDAD1339","user_header":"https://static001.geekbang.org/account/avatar/00/11/8e/e8/f1e12f2e.jpg","comment_is_top":false,"comment_ctime":1608795501,"is_pvip":false,"replies":[{"id":"99271","content":"挑战一下自己实现<br>","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610807908,"ip_address":"","comment_id":269818,"utype":1}],"discussion_count":6,"race_medal":0,"score":"1608795501","product_id":100063601,"comment_content":"运行代码提示 ImportError: no module named &#39;Button&#39; ，Button.py 模块的代码有知道的吗？","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512405,"discussion_content":"挑战一下自己实现\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610807908,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1005944,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/78/4f384f93.jpg","nickname":"龙","note":"","ucode":"B353E8002D2BF3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337411,"discussion_content":"from machine import Pin\n\nclass Button():\n\n    def __init__(self, pin):\n        self.buttonpin = Pin(pin, Pin.IN)\n        self.last_status = 1\n\n    def state(self):\n        return self.last_status","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1608896812,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1150696,"avatar":"https://static001.geekbang.org/account/avatar/00/11/8e/e8/f1e12f2e.jpg","nickname":"青木","note":"","ucode":"2B566ABDAD1339","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1005944,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/78/4f384f93.jpg","nickname":"龙","note":"","ucode":"B353E8002D2BF3","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337468,"discussion_content":"谢谢！现在可以通过腾讯连连控制灯启关了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608912264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":337411,"ip_address":""},"score":337468,"extra":""},{"author":{"id":2302376,"avatar":"https://static001.geekbang.org/account/avatar/00/23/21/a8/8ac2ccb3.jpg","nickname":"风ffff","note":"","ucode":"5422485EA3265F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1150696,"avatar":"https://static001.geekbang.org/account/avatar/00/11/8e/e8/f1e12f2e.jpg","nickname":"青木","note":"","ucode":"2B566ABDAD1339","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340756,"discussion_content":"兄弟能把你组装的零件给我看看嘛 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610119575,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":337468,"ip_address":""},"score":340756,"extra":""},{"author":{"id":1150696,"avatar":"https://static001.geekbang.org/account/avatar/00/11/8e/e8/f1e12f2e.jpg","nickname":"青木","note":"","ucode":"2B566ABDAD1339","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2302376,"avatar":"https://static001.geekbang.org/account/avatar/00/23/21/a8/8ac2ccb3.jpg","nickname":"风ffff","note":"","ucode":"5422485EA3265F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":340883,"discussion_content":"面包板上的电路早拆了，你按着老师那张电路图的关键信息确定零件都是哪些，在对照线路布线就行。注：1. 继电器需要启子松紧跳线；2. 跳线的颜色不需要和老师的一致，跳线颜色只是区分电路而已。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610191208,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":340756,"ip_address":""},"score":340883,"extra":""}]},{"author":{"id":1005944,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/59/78/4f384f93.jpg","nickname":"龙","note":"","ucode":"B353E8002D2BF3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":337335,"discussion_content":"Button.py最后找到吗？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608878057,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":268861,"user_name":"孙宇翔","can_delete":false,"product_type":"c1","uid":1944746,"ip_address":"","ucode":"A10DC9018CCCC0","user_header":"https://static001.geekbang.org/account/avatar/00/1d/ac/aa/2f117918.jpg","comment_is_top":false,"comment_ctime":1608376967,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608376967","product_id":100063601,"comment_content":"看到最后的思考题，才豁然开朗，Button类就是监控实体开关的状态，如果状态发生改变，就改变继电器的开关状态，来实现实体开关对灯的控制。但这样的话，感觉把控制权都放到了esp8266上了，万一模块坏了，灯就没法控制了，是否应该再做一路模拟电路备用。","like_count":0},{"had_liked":false,"id":268739,"user_name":"德慢慢","can_delete":false,"product_type":"c1","uid":2049906,"ip_address":"","ucode":"F79F4C1A2C9EFA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epa9fhIhtLUNkCqR9dxZTUolBLs40YiawZ4TUtvTG90HR0OyXzwU7icjyDiaF4FZOicyzRV1bGAylhs2A/132","comment_is_top":false,"comment_ctime":1608336289,"is_pvip":false,"replies":[{"id":"99470","content":"设备订阅的主题是什么呢？","user_name":"作者回复","user_name_real":"郭朝斌","uid":"2302171","ctime":1610863955,"ip_address":"","comment_id":268739,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1608336289","product_id":100063601,"comment_content":"topic是设备id+用户名+密码吗？","like_count":0,"discussions":[{"author":{"id":2302171,"avatar":"https://static001.geekbang.org/account/avatar/00/23/20/db/b04f43dc.jpg","nickname":"郭朝斌","note":"","ucode":"2969986E1B3851","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512021,"discussion_content":"设备订阅的主题是什么呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610863955,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}