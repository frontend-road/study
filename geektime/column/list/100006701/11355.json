{"id":11355,"title":"第32讲 | 如何写出安全的Java代码？","content":"<p>在上一讲中，我们已经初步接触了Java安全，今天我们将一起探讨更多Java开发中可能影响到安全的场合。很多安全问题，在特定的上下文，存在着不同的定义，尽管本质是相似或一致的，这是由于Java平台自身的特性所带来特有的问题。今天这一讲我将侧重于Java开发者的角度谈代码安全，而不是讲广义的安全风险。</p>\n<p>今天我要问你的问题是，<span class=\"orange\">如何写出安全的Java代码？</span></p>\n<h2>典型回答</h2>\n<p>这个问题可能有点宽泛，我们可以用特定类型的安全风险为例，如拒绝服务（DoS）攻击，分析Java开发者需要重点考虑的点。</p>\n<p>DoS是一种常见的网络攻击，有人也称其为“洪水攻击”。最常见的表现是，利用大量机器发送请求，将目标网站的带宽或者其他资源耗尽，导致其无法响应正常用户的请求。</p>\n<p>我认为，从Java语言的角度，更加需要重视的是程序级别的攻击，也就是利用Java、JVM或应用程序的瑕疵，进行低成本的DoS攻击，这也是想要写出安全的Java代码所必须考虑的。例如：</p>\n<ul>\n<li>\n<p>如果使用的是早期的JDK和Applet等技术，攻击者构建合法但恶劣的程序就相对容易，例如，将其线程优先级设置为最高，做一些看起来无害但空耗资源的事情。幸运的是类似技术已经逐步退出历史舞台，在JDK 9以后，相关模块就已经被移除。</p>\n</li>\n<li>\n<p>上一讲中提到的哈希碰撞攻击，就是个典型的例子，对方可以轻易消耗系统有限的CPU和线程资源。从这个角度思考，类似加密、解密、图形处理等计算密集型任务，都要防范被恶意滥用，以免攻击者通过直接调用或者间接触发方式，消耗系统资源。</p>\n</li>\n<li>\n<p>利用Java构建类似上传文件或者其他接受输入的服务，需要对消耗系统内存或存储的上限有所控制，因为我们不能将系统安全依赖于用户的合理使用。其中特别注意的是涉及解压缩功能时，就需要防范<a href=\"https://en.wikipedia.org/wiki/Zip_bomb\">Zip bomb</a>等特定攻击。</p>\n</li>\n<li>\n<p>另外，Java程序中需要明确释放的资源有很多种，比如文件描述符、数据库连接，甚至是再入锁，任何情况下都应该保证资源释放成功，否则即使平时能够正常运行，也可能被攻击者利用而耗尽某类资源，这也算是可能的DoS攻击来源。</p>\n</li>\n</ul><!-- [[[read_end]]] -->\n<p>所以可以看出，实现安全的Java代码，需要从功能设计到实现细节，都充分考虑可能的安全影响。</p>\n<h2>考点分析</h2>\n<p>关于今天的问题，以典型的DoS攻击作为切入点，将问题聚焦在Java开发中，我介绍了Java应用设计、实现的注意事项，后面还会介绍更加全面的实践。</p>\n<p>其实安全问题实际就是软件的缺陷，软件安全并不存在一劳永逸的秘籍，既离不开设计、架构中的风险分析，也离不开编码、测试等阶段的安全实践手段。对于面试官来说，考察安全问题，除了对特定安全领域知识的考察，更多是要看面试者的Java编程基本功和知识的积累。</p>\n<p>所以，我会在后面会循序渐进探讨Java安全编程，这里面没有什么黑科技，只有规范的开发标准，很多安全问题其实是态度问题，取决于你是否真的认真对待它。</p>\n<ul>\n<li>\n<p>我将以一些典型的代码片段为出发点，分析一些非常容易被忽略的安全风险，并介绍安全问题频发的热点场景，如Java序列化和反序列化。</p>\n</li>\n<li>\n<p>从软件生命周期的角度，探讨设计、开发、测试、部署等不同阶段，有哪些常见的安全策略或工具。</p>\n</li>\n</ul>\n<h2>知识扩展</h2>\n<p>首先，我们一起来看一段不起眼的条件判断代码，这里可能有什么问题吗？</p>\n<pre><code>// a, b, c都是int类型的数值\nif (a + b &lt; c) {\n// …\n}\n</code></pre>\n<p>你可能会纳闷，这是再常见不过的一个条件判断了，能有什么安全隐患？</p>\n<p>这里的隐患是数值类型需要防范溢出，否则这不仅仅可能会带来逻辑错误，在特定情况下可能导致严重的安全漏洞。</p>\n<p>从语言特性来说，Java和JVM提供了很多基础性的改进，相比于传统的C、C++等语言，对于数组越界等处理要完善的多，原生的避免了<a href=\"https://en.wikipedia.org/wiki/Buffer_overflow\">缓冲区溢出</a>等攻击方式，提高了软件的安全性。但这并不代表完全杜绝了问题，Java程序可能调用本地代码，也就是JNI技术，错误的数值可能导致C/C++层面的数据越界等问题，这是很危险的。</p>\n<p>所以，上面的条件判断，需要判断其数值范围，例如，写成类似下面结构。</p>\n<pre><code>if (a &lt; c – b)\n</code></pre>\n<p>再来看一个例子，请看下面的一段异常处理代码：</p>\n<pre><code>try {\n// 业务代码\n} catch (Exception e) {\nthrow new RuntimeException(hostname + port + “ doesn’t response”);\n}\n</code></pre>\n<p>这段代码将敏感信息包含在异常消息中，试想，如果是一个Web应用，异常也没有良好的包装起来，很有可能就把内部信息暴露给终端客户。古人曾经告诫我们“言多必失”是很有道理的，虽然其本意不是指软件安全，但尽量少暴露信息，也是保证安全的基本原则之一。即使我们并不认为某个信息有安全风险，我的建议也是如果没有必要，不要暴露出来。</p>\n<p>这种暴露还可能通过其他方式发生，比如某著名的编程技术网站，就被曝光过所有用户名和密码。这些信息都是明文存储，传输过程也未必进行加密，类似这种情况，暴露只是个时间早晚的问题。</p>\n<p>对于安全标准特别高的系统，甚至可能要求敏感信息被使用后，要立即明确在内存中销毁，以免被探测；或者避免在发生core dump时，意外暴露。</p>\n<p>第三，Java提供了序列化等创新的特性，广泛使用在远程调用等方面，但也带来了复杂的安全问题。直到今天，序列化仍然是个安全问题频发的场景。</p>\n<p>针对序列化，通常建议：</p>\n<ul>\n<li>\n<p>敏感信息不要被序列化！在编码中，建议使用transient关键字将其保护起来。</p>\n</li>\n<li>\n<p>反序列化中，建议在readObject中实现与对象构件过程相同的安全检查和数据检查。</p>\n</li>\n</ul>\n<p>另外，在JDK 9中，Java引入了过滤器机制，以保证反序列化过程中数据都要经过基本验证才可以使用。其原理是通过黑名单和白名单，限定安全或者不安全的类型，并且你可以进行定制，然后通过环境变量灵活进行配置， 更加具体的使用你可以参考 <a href=\"https://docs.oracle.com/javase/9/docs/api/java/io/ObjectInputFilter.html\">ObjectInputFilter</a>。</p>\n<p>通过前面的介绍，你可能注意到，很多安全问题都是源于非常基本的编程细节，类似Immutable、封装等设计，都存在着安全性的考虑。从实践的角度，让每个人都了解和掌握这些原则，有必要但并不太现实，有没有什么工程实践手段，可以帮助我们排查安全隐患呢？</p>\n<p><strong>开发和测试阶段</strong></p>\n<p>在实际开发中，各种功能点五花八门，未必能考虑的全面。我建议没有必要所有都需要自己去从头实现，尽量使用广泛验证过的工具、类库，不管是来自于JDK自身，还是Apache等第三方组织，都在社区的反馈下持续地完善代码安全。</p>\n<p>开发过程中应用代码规约标准，是避免安全问题的有效手段。我特别推荐来自孤尽的《阿里巴巴Java开发手册》，以及其配套工具，充分总结了业界在Java等领域的实践经验，将规约实践系统性地引入国内的软件开发，可以有效提高代码质量。</p>\n<p>当然，凡事都是有代价的，规约会增加一定的开发成本，可能对迭代的节奏产生一定影响，所以对于不同阶段、不同需求的团队，可以根据自己的情况对规约进行适应性的调整。</p>\n<p>落实到实际开发流程中，以OpenJDK团队为例，我们应用了几个不同角度的实践：</p>\n<ul>\n<li>\n<p>在早期设计阶段，就由安全专家组对新特性进行风险评估。</p>\n</li>\n<li>\n<p>开发过程中，尤其是code review阶段，应用OpenJDK自身定制的代码规范。</p>\n</li>\n<li>\n<p>利用多种静态分析工具如<a href=\"http://findbugs.sourceforge.net/\">FindBugs</a>、<a href=\"https://labs.oracle.com/pls/apex/f?p=labs:49:::::P49_PROJECT_ID:13\">Parfait</a>等，帮助早期发现潜在安全风险，并对相应问题采取零容忍态度，强制要求解决。</p>\n</li>\n<li>\n<p>甚至OpenJDK会默认将任何（编译等）警告，都当作错误对待，并体现在CI流程中。</p>\n</li>\n<li>\n<p>在代码check-in等关键环节，利用hook机制去调用规则检查工具，以保证不合规代码不能进入OpenJDK代码库。</p>\n</li>\n</ul>\n<p>关于静态分析工具的选择，我们选取的原则是“足够好”。没有什么工具能够发现所有问题，所以在保证功能的前提下，影响更大的是分析效率，换句话说是代码分析的噪音高低。不管分析有多么的完备，如果太多误报，就会导致有用信息被噪音覆盖，也不利于后续其他程序化的处理，反倒不利于排查问题。</p>\n<p>以上这些是为了保证JDK作为基础平台的苛刻质量要求，在实际产品中，你需要斟酌具体什么程度的要求是合理的。</p>\n<p><strong>部署阶段</strong></p>\n<p>JDK自身的也是个软件，难免会存在实现瑕疵，我们平时看到JDK更新的安全漏洞补丁，其实就是在修补这些漏洞。我最近还注意到，某大厂后台被曝出了使用的JDK版本存在序列化相关的漏洞。类似这种情况，大多数都是因为使用的JDK是较低版本，算是可以通过部署解决的问题。</p>\n<p>如果是安全敏感型产品，建议关注JDK在加解密方面的<a href=\"https://java.com/en/jre-jdk-cryptoroadmap.html\">路线图</a>，同样的标准也应用于其他语言和平台，很多早期认为非常安全的算法，已经被攻破，及时地升级基础软件是安全的必要条件。</p>\n<p>攻击和防守是不对称的，只要有一个严重漏洞，对于攻击者就足够了，所以，不能对黑盒形式的部署心存侥幸，这并不能保证系统的安全，攻击者可以利用对软件设计的猜测，结合一系列手段，探测出漏洞。</p>\n<p>今天我以DoS等典型攻击方式为例，分析了其在Java平台上的特定表现，并从更多安全编码的细节帮你体会安全问题的普遍性，最后我介绍了软件开发周期中的安全实践，希望能对你的工作有所帮助。</p>\n<h2>一课一练</h2>\n<p>关于今天我们讨论的题目你做到心中有数了吗？你在开发中遇到过Java特定的安全问题吗？是怎么解决的呢？</p>\n<p>请你在留言区写写你对这个问题的思考，我会选出经过认真思考的留言，送给你一份学习奖励礼券，欢迎你与我一起讨论。</p>\n<p><span class=\"orange\">别忘了今晚8点半我会做客“极客Live”，和你一起聊聊Java面试那些事儿。在“极客时间”App内点击“极客Live”即可加入直播，今晚我们不见不散。</span></p>\n<p>你的朋友是不是也在准备面试呢？你可以“请朋友读”，把今天的题目分享给好友，或许你能帮到他。</p>\n<p></p>\n","comments":[{"had_liked":false,"id":16634,"user_name":"Len","can_delete":false,"product_type":"c1","uid":1022767,"ip_address":"","ucode":"53C623CE17973F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9b/2f/b7a3625e.jpg","comment_is_top":false,"comment_ctime":1532058740,"is_pvip":true,"replies":[{"id":"6056","content":"不错","user_name":"作者回复","user_name_real":"杨晓峰","uid":"1009360","ctime":1532680850,"ip_address":"","comment_id":16634,"utype":1}],"discussion_count":5,"race_medal":0,"score":"426733821044","product_id":100006701,"comment_content":"在密码使用的场景中，比如用户注册&#47;登录。<br>我使用 char[] 数组存储和验证密码，并在使用结束后，通过随机的字符覆盖掉 char[]。<br>如果使用 string 存储密码，由于它的不可变性，它的缺陷是会一直驻留在堆中，直到未来被垃圾回收。","like_count":100,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"杨晓峰","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420881,"discussion_content":"不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532680850,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2391701,"avatar":"","nickname":"Geek_a3890b","note":"","ucode":"BF67D080DAF96D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":404296,"discussion_content":"为啥不直接 置为null","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634283443,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1110662,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f2/86/d689f77e.jpg","nickname":"Hank_Yan","note":"","ucode":"86899B561C502B","race_medal":3,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":289186,"discussion_content":"学习了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594020527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":174500,"discussion_content":"学习了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1581923322,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1616954,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/ODqoBdTKsL1jW4m72BZ0ibECEtWPq0N1tAIlbzjsq6mcJiavT2CKtx0ejpIqQdHbRXdMWH0I1jpI2ZiawFIkF1icsQ/132","nickname":"白中白","note":"","ucode":"95F9DABEBEFAAA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":33165,"discussion_content":"用 new String 创建不是更方便？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571104481,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16448,"user_name":"李二木","can_delete":false,"product_type":"c1","uid":1103091,"ip_address":"","ucode":"30E03BB84ADB27","user_header":"https://static001.geekbang.org/account/avatar/00/10/d4/f3/129d6dfe.jpg","comment_is_top":false,"comment_ctime":1531963249,"is_pvip":true,"replies":[{"id":"5738","content":"jdk新版中 random升级很多，例如基于DRBG的实现，值得尝试","user_name":"作者回复","user_name_real":"杨晓峰","uid":"1009360","ctime":1532019419,"ip_address":"","comment_id":16448,"utype":1}],"discussion_count":2,"race_medal":0,"score":"91726276465","product_id":100006701,"comment_content":"<br> 最近项目在改安全问题，主要遇到的有：SQL注入，IO流没有关闭，使用不安全Random，重定向Url合法性没做检验，上传文件前后端没做文件大小类型校验。通过反射方式访问私有方法。日志包含敏感信息，没有禁止除GET,POST以外的HTTP请求等等","like_count":22,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"杨晓峰","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420799,"discussion_content":"jdk新版中 random升级很多，例如基于DRBG的实现，值得尝试","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532019419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2550743,"avatar":"https://static001.geekbang.org/account/avatar/00/26/eb/d7/90391376.jpg","nickname":"if...else...","note":"","ucode":"D0565908C99695","race_medal":4,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":376407,"discussion_content":"😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622111819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16613,"user_name":"Leiy","can_delete":false,"product_type":"c1","uid":1009001,"ip_address":"","ucode":"BE812F95D6089E","user_header":"https://static001.geekbang.org/account/avatar/00/0f/65/69/efb57b83.jpg","comment_is_top":false,"comment_ctime":1532052903,"is_pvip":true,"replies":[{"id":"5795","content":"对，所以我强调判断数值范围，具体看情况选择","user_name":"作者回复","user_name_real":"杨晓峰","uid":"1009360","ctime":1532096965,"ip_address":"","comment_id":16613,"utype":1}],"discussion_count":2,"race_medal":0,"score":"83136431527","product_id":100006701,"comment_content":"老师，你好，那个c是负数，b是正数，c-b也可能溢出吧？","like_count":20,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"杨晓峰","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420869,"discussion_content":"对，所以我强调判断数值范围，具体看情况选择","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532096965,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2052476,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Qq6oLfOTgKzjiculoUDicdv7WoY1iabPfOTumibWeInVP2Mnod9XVPrNSClvIiaLbvtDlIjRnWUNaXcYwREGzlcaDog/132","nickname":"Geek_在下蟑螂王","note":"","ucode":"E1F5BBB5BC5962","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":291443,"discussion_content":"这波杠的可以，逻辑缜密。我混子王这波是服的","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1594820649,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":83780,"user_name":"程序员小跃","can_delete":false,"product_type":"c1","uid":1015483,"ip_address":"","ucode":"25BB96E0791A60","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7e/bb/947c329a.jpg","comment_is_top":false,"comment_ctime":1554715174,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"27324518950","product_id":100006701,"comment_content":"这节课让我想去以前在菊厂做的各种红线检查，就是针对各种安全来应对的。通过findbugs，pclint，fortify等静待代码检查；安全扫描；Sql注入；Android还有Monkey测试等手段进行安全攻防","like_count":7},{"had_liked":false,"id":16441,"user_name":"我滴头好大呀","can_delete":false,"product_type":"c1","uid":1116847,"ip_address":"","ucode":"192ABAE47EAC99","user_header":"https://static001.geekbang.org/account/avatar/00/11/0a/af/b6fc4f8d.jpg","comment_is_top":false,"comment_ctime":1531961780,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18711830964","product_id":100006701,"comment_content":"期待","like_count":4},{"had_liked":false,"id":16529,"user_name":"birdzxc","can_delete":false,"product_type":"c1","uid":1014510,"ip_address":"","ucode":"096EF1960F6BDB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLS0FDycDR2RlONhAX782uZxesnyrojEabVH7lJY20RexENpvdcNwgy4Jn4QSPzNeFjAew65Fkl7A/132","comment_is_top":false,"comment_ctime":1532008483,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14416910371","product_id":100006701,"comment_content":"老师，能否就spring 源码 解读一下呢？非常期待","like_count":4},{"had_liked":false,"id":16779,"user_name":"羊羊羊","can_delete":false,"product_type":"c1","uid":1138589,"ip_address":"","ucode":"D0092F444AA65D","user_header":"","comment_is_top":false,"comment_ctime":1532179543,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10122114135","product_id":100006701,"comment_content":"安全倾向于 “明显没有漏洞”，而不是“没有明显漏洞”。这段话很喜欢，老师能不能在详细的剖析下这句话。","like_count":3,"discussions":[{"author":{"id":1262126,"avatar":"https://static001.geekbang.org/account/avatar/00/13/42/2e/d88a457f.jpg","nickname":"Fly","note":"","ucode":"E4845E446CDCDF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283571,"discussion_content":"就是再小的问题也不要忽略","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592298348,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":192714,"user_name":"护爽使者","can_delete":false,"product_type":"c1","uid":1275464,"ip_address":"","ucode":"12DC35DD74671C","user_header":"https://static001.geekbang.org/account/avatar/00/13/76/48/5ab89daa.jpg","comment_is_top":false,"comment_ctime":1584869326,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5879836622","product_id":100006701,"comment_content":"单线程可以使用非线程安全的代码；<br>并发情况下使用cas 等锁技术","like_count":0},{"had_liked":false,"id":20571,"user_name":"郭俊杰","can_delete":false,"product_type":"c1","uid":1095011,"ip_address":"","ucode":"3BA7F5CA0BA864","user_header":"https://static001.geekbang.org/account/avatar/00/10/b5/63/b66f3d37.jpg","comment_is_top":false,"comment_ctime":1534555133,"is_pvip":false,"replies":[{"id":"7377","content":"需要理解为什么有线程安全问题，看是否线程间共享，不可变还是可修改","user_name":"作者回复","user_name_real":"杨晓峰","uid":"1009360","ctime":1534858313,"ip_address":"","comment_id":20571,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5829522429","product_id":100006701,"comment_content":"老师，你好，多线程访问共享数据会有线程安全问题，是不是在方法内部new的对象也一样存在线程安全问题呢？","like_count":2,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"杨晓峰","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":422306,"discussion_content":"需要理解为什么有线程安全问题，看是否线程间共享，不可变还是可修改","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1534858313,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":16445,"user_name":"老韩","can_delete":false,"product_type":"c1","uid":1123053,"ip_address":"","ucode":"F351906BEDF095","user_header":"https://static001.geekbang.org/account/avatar/00/11/22/ed/73cea0b9.jpg","comment_is_top":false,"comment_ctime":1531962413,"is_pvip":false,"replies":[{"id":"5739","content":"openjdk用的是自身定制的...但我理解主流代码检查工具，都可以试试定制个适合做check-in守门的版本，想清楚限定什么，一般是个子集","user_name":"作者回复","user_name_real":"杨晓峰","uid":"1009360","ctime":1532019661,"ip_address":"","comment_id":16445,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5826929709","product_id":100006701,"comment_content":"hook有直接可用的或者简单修改就能用的推荐吗","like_count":2,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"杨晓峰","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420797,"discussion_content":"openjdk用的是自身定制的...但我理解主流代码检查工具，都可以试试定制个适合做check-in守门的版本，想清楚限定什么，一般是个子集","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532019661,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":272098,"user_name":"随心而至","can_delete":false,"product_type":"c1","uid":1097836,"ip_address":"","ucode":"31866865255101","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg","comment_is_top":false,"comment_ctime":1609932443,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1609932443","product_id":100006701,"comment_content":"基本功扎实，正确规范地写代码，知道哪里可能出问题。关注安全问题，一旦爆出，及时跟进解决。","like_count":1},{"had_liked":false,"id":224941,"user_name":"亚林","can_delete":false,"product_type":"c1","uid":1018972,"ip_address":"","ucode":"4A5A6D24314B79","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8c/5c/3f164f66.jpg","comment_is_top":false,"comment_ctime":1591598734,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1591598734","product_id":100006701,"comment_content":"旧的系统在进行安全检查的过程中，遇到XSS安全问题。最后用OWASP Enterprise Security API提供的Java安全库，通过Spring的拦截机制解决的。","like_count":1},{"had_liked":false,"id":192201,"user_name":"今天","can_delete":false,"product_type":"c1","uid":1532354,"ip_address":"","ucode":"F8577A2BABCD1F","user_header":"https://static001.geekbang.org/account/avatar/00/17/61/c2/94c1d4c9.jpg","comment_is_top":false,"comment_ctime":1584843017,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584843017","product_id":100006701,"comment_content":"不能放过任何一个错误","like_count":0},{"had_liked":false,"id":190475,"user_name":"时代先锋","can_delete":false,"product_type":"c1","uid":1856411,"ip_address":"","ucode":"956E3E6A6A4F30","user_header":"https://static001.geekbang.org/account/avatar/00/1c/53/9b/d0a21378.jpg","comment_is_top":false,"comment_ctime":1584663396,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584663396","product_id":100006701,"comment_content":"java安全是慎之又慎的问题。","like_count":0},{"had_liked":false,"id":16704,"user_name":"Santo","can_delete":false,"product_type":"c1","uid":1137177,"ip_address":"","ucode":"D922BAD08571B1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er1iaMWWwbibUvPiaYXMPKUQDDgynPwU7n4fkRtuekqhYiaKUibgqEBzmygWmWjIhiaiblbAjrUSTkTOhgtw/132","comment_is_top":false,"comment_ctime":1532104508,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1532104508","product_id":100006701,"comment_content":"错过了老师的live课，好可惜，不知道后面还有没有？","like_count":1},{"had_liked":false,"id":16630,"user_name":"小粉蒸","can_delete":false,"product_type":"c1","uid":1013072,"ip_address":"","ucode":"55C4C491C196B9","user_header":"https://static001.geekbang.org/account/avatar/00/0f/75/50/a9f93142.jpg","comment_is_top":false,"comment_ctime":1532056185,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1532056185","product_id":100006701,"comment_content":"请问没赶上直播的怎么办，有录音之类的吗？","like_count":0},{"had_liked":false,"id":16588,"user_name":"王大为","can_delete":false,"product_type":"c1","uid":1177982,"ip_address":"","ucode":"CE50988A4C4605","user_header":"https://static001.geekbang.org/account/avatar/00/11/f9/7e/3c71fa3d.jpg","comment_is_top":false,"comment_ctime":1532047545,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1532047545","product_id":100006701,"comment_content":"谢谢老师的回复，我编译的openjdk8,netbeans7.4,按照周志明老师的jvm书籍上说的编译的。请问oracle jdk也可以编译下来断点调试吗,您那边用的什么IDE调试的愣?","like_count":0},{"had_liked":false,"id":16460,"user_name":"王大为","can_delete":false,"product_type":"c1","uid":1177982,"ip_address":"","ucode":"CE50988A4C4605","user_header":"https://static001.geekbang.org/account/avatar/00/11/f9/7e/3c71fa3d.jpg","comment_is_top":false,"comment_ctime":1531964960,"is_pvip":false,"replies":[{"id":"5737","content":"netbeans…基本没怎么用过，openjdk什么版本？netbeans呢？oracle官方的jdk有这个问题吗？<br>另外build的时候有没有加上—enable-debug之类参数？","user_name":"作者回复","user_name_real":"杨晓峰","uid":"1009360","ctime":1532019328,"ip_address":"","comment_id":16460,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1531964960","product_id":100006701,"comment_content":"老师，您好，我编译了openjdk，导入到netbeans中，怎么打不了断点调试jdk模块，请您指导下","like_count":0,"discussions":[{"author":{"id":1009360,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/66/d0/6541f1d5.jpg","nickname":"杨晓峰","note":"","ucode":"2BF255467A978F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":420804,"discussion_content":"netbeans…基本没怎么用过，openjdk什么版本？netbeans呢？oracle官方的jdk有这个问题吗？\n另外build的时候有没有加上—enable-debug之类参数？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1532019328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}