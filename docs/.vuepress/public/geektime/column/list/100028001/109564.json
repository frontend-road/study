{"id":109564,"title":"27 | å•ä¾‹æ¨¡å¼ï¼šå¦‚ä½•åˆ›å»ºå•ä¸€å¯¹è±¡ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯åˆ˜è¶…ã€‚</p><p>ä»è¿™ä¸€è®²å¼€å§‹ï¼Œæˆ‘ä»¬å°†ä¸€èµ·æ¢è®¨è®¾è®¡æ¨¡å¼çš„æ€§èƒ½è°ƒä¼˜ã€‚åœ¨ã€ŠDesign Patterns: Elements of Reusable Object-Oriented Softwareã€‹ä¸€ä¹¦ä¸­ï¼Œæœ‰23ç§è®¾è®¡æ¨¡å¼çš„æè¿°ï¼Œå…¶ä¸­ï¼Œå•ä¾‹è®¾è®¡æ¨¡å¼æ˜¯æœ€å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚æ— è®ºæ˜¯åœ¨å¼€æºæ¡†æ¶ï¼Œè¿˜æ˜¯åœ¨æˆ‘ä»¬çš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œå•ä¾‹æ¨¡å¼å‡ ä¹æ— å¤„ä¸åœ¨ã€‚</p><h2>ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼Ÿ</h2><p>å®ƒçš„æ ¸å¿ƒåœ¨äºï¼Œå•ä¾‹æ¨¡å¼å¯ä»¥ä¿è¯ä¸€ä¸ªç±»ä»…åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚</p><p>è¯¥æ¨¡å¼æœ‰ä¸‰ä¸ªåŸºæœ¬è¦ç‚¹ï¼šä¸€æ˜¯è¿™ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ï¼›äºŒæ˜¯å®ƒå¿…é¡»è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹ï¼›ä¸‰æ˜¯å®ƒå¿…é¡»è‡ªè¡Œå‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ã€‚</p><p>ç»“åˆè¿™ä¸‰ç‚¹ï¼Œæˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç®€å•çš„å•ä¾‹ï¼š</p><pre><code>//é¥¿æ±‰æ¨¡å¼\npublic final class Singleton {\n    private static Singleton instance=new Singleton();//è‡ªè¡Œåˆ›å»ºå®ä¾‹\n    private Singleton(){}//æ„é€ å‡½æ•°\n    public static Singleton getInstance(){//é€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹\n        return instance;\n    }\n}\n</code></pre><p>ç”±äºåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªç±»ç»å¸¸ä¼šè¢«ä½¿ç”¨åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œ<span class=\"orange\">é€šè¿‡å•ä¾‹æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…å¤šæ¬¡åˆ›å»ºå¤šä¸ªå®ä¾‹ï¼Œä»è€ŒèŠ‚çº¦ç³»ç»Ÿèµ„æºã€‚</span></p><h2>é¥¿æ±‰æ¨¡å¼</h2><p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä»¥ä¸Šç¬¬ä¸€ç§å®ç°å•ä¾‹çš„ä»£ç ä¸­ï¼Œä½¿ç”¨äº†staticä¿®é¥°äº†æˆå‘˜å˜é‡instanceï¼Œæ‰€ä»¥è¯¥å˜é‡ä¼šåœ¨ç±»åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­è¢«æ”¶é›†è¿›ç±»æ„é€ å™¨å³&lt;clinit&gt;æ–¹æ³•ä¸­ã€‚åœ¨å¤šçº¿ç¨‹åœºæ™¯ä¸‹ï¼ŒJVMä¼šä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œè¯¥ç±»çš„&lt;clinit&gt;æ–¹æ³•ï¼Œå…¶å®ƒçº¿ç¨‹å°†ä¼šè¢«é˜»å¡ç­‰å¾…ã€‚</p><p>ç­‰åˆ°å”¯ä¸€çš„ä¸€æ¬¡&lt;clinit&gt;æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œå…¶å®ƒçº¿ç¨‹å°†ä¸ä¼šå†æ‰§è¡Œ&lt;clinit&gt;æ–¹æ³•ï¼Œè½¬è€Œæ‰§è¡Œè‡ªå·±çš„ä»£ç ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œstaticä¿®é¥°äº†æˆå‘˜å˜é‡instanceï¼Œåœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹èƒ½ä¿è¯åªå®ä¾‹åŒ–ä¸€æ¬¡ã€‚</p><!-- [[[read_end]]] --><p>è¿™ç§æ–¹å¼å®ç°çš„å•ä¾‹æ¨¡å¼ï¼Œåœ¨ç±»åˆå§‹åŒ–é˜¶æ®µå°±å·²ç»åœ¨å †å†…å­˜ä¸­å¼€è¾Ÿäº†ä¸€å—å†…å­˜ï¼Œç”¨äºå­˜æ”¾å®ä¾‹åŒ–å¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿç§°ä¸ºé¥¿æ±‰æ¨¡å¼ã€‚</p><p>é¥¿æ±‰æ¨¡å¼å®ç°çš„å•ä¾‹çš„ä¼˜ç‚¹æ˜¯ï¼Œå¯ä»¥ä¿è¯å¤šçº¿ç¨‹æƒ…å†µä¸‹å®ä¾‹çš„å”¯ä¸€æ€§ï¼Œè€Œä¸”getInstanceç›´æ¥è¿”å›å”¯ä¸€å®ä¾‹ï¼Œæ€§èƒ½éå¸¸é«˜ã€‚</p><p>ç„¶è€Œï¼Œåœ¨ç±»æˆå‘˜å˜é‡æ¯”è¾ƒå¤šï¼Œæˆ–å˜é‡æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œè¿™ç§æ¨¡å¼å¯èƒ½ä¼šåœ¨æ²¡æœ‰ä½¿ç”¨ç±»å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä¸€ç›´å ç”¨å †å†…å­˜ã€‚è¯•æƒ³ä¸‹ï¼Œå¦‚æœä¸€ä¸ªç¬¬ä¸‰æ–¹å¼€æºæ¡†æ¶ä¸­çš„ç±»éƒ½æ˜¯åŸºäºé¥¿æ±‰æ¨¡å¼å®ç°çš„å•ä¾‹ï¼Œè¿™å°†ä¼šåˆå§‹åŒ–æ‰€æœ‰å•ä¾‹ç±»ï¼Œæ— ç–‘æ˜¯ç¾éš¾æ€§çš„ã€‚</p><h2>æ‡’æ±‰æ¨¡å¼</h2><p>æ‡’æ±‰æ¨¡å¼å°±æ˜¯ä¸ºäº†é¿å…ç›´æ¥åŠ è½½ç±»å¯¹è±¡æ—¶æå‰åˆ›å»ºå¯¹è±¡çš„ä¸€ç§å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚è¯¥æ¨¡å¼ä½¿ç”¨æ‡’åŠ è½½æ–¹å¼ï¼Œåªæœ‰å½“ç³»ç»Ÿä½¿ç”¨åˆ°ç±»å¯¹è±¡æ—¶ï¼Œæ‰ä¼šå°†å®ä¾‹åŠ è½½åˆ°å †å†…å­˜ä¸­ã€‚é€šè¿‡ä»¥ä¸‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°äº†è§£ä¸‹æ‡’åŠ è½½çš„å®ç°æ–¹å¼ï¼š</p><pre><code>//æ‡’æ±‰æ¨¡å¼\npublic final class Singleton {\n    private static Singleton instance= null;//ä¸å®ä¾‹åŒ–\n    private Singleton(){}//æ„é€ å‡½æ•°\n    public static Singleton getInstance(){//é€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹\n        if(null == instance){//å½“instanceä¸ºnullæ—¶ï¼Œåˆ™å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦åˆ™ç›´æ¥è¿”å›å¯¹è±¡\n            instance = new Singleton();//å®ä¾‹åŒ–å¯¹è±¡\n        }\n        return instance;//è¿”å›å·²å­˜åœ¨çš„å¯¹è±¡\n    }\n}\n</code></pre><p>ä»¥ä¸Šä»£ç åœ¨å•çº¿ç¨‹ä¸‹è¿è¡Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†è¦è¿è¡Œåœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œå°±ä¼šå‡ºç°å®ä¾‹åŒ–å¤šä¸ªç±»å¯¹è±¡çš„æƒ…å†µã€‚è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p>å½“çº¿ç¨‹Aè¿›å…¥åˆ°ifåˆ¤æ–­æ¡ä»¶åï¼Œå¼€å§‹å®ä¾‹åŒ–å¯¹è±¡ï¼Œæ­¤æ—¶instanceä¾ç„¶ä¸ºnullï¼›åˆæœ‰çº¿ç¨‹Bè¿›å…¥åˆ°ifåˆ¤æ–­æ¡ä»¶ä¸­ï¼Œä¹‹åä¹Ÿä¼šé€šè¿‡æ¡ä»¶åˆ¤æ–­ï¼Œè¿›å…¥åˆ°æ–¹æ³•é‡Œé¢åˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹è¯¥æ–¹æ³•è¿›è¡ŒåŠ é”ï¼Œä¿è¯å¤šçº¿ç¨‹æƒ…å†µä¸‹ä»…åˆ›å»ºä¸€ä¸ªå®ä¾‹ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨SynchronizedåŒæ­¥é”æ¥ä¿®é¥°getInstanceæ–¹æ³•ï¼š</p><pre><code>//æ‡’æ±‰æ¨¡å¼ + synchronizedåŒæ­¥é”\npublic final class Singleton {\n    private static Singleton instance= null;//ä¸å®ä¾‹åŒ–\n    private Singleton(){}//æ„é€ å‡½æ•°\n    public static synchronized Singleton getInstance(){//åŠ åŒæ­¥é”ï¼Œé€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹\n        if(null == instance){//å½“instanceä¸ºnullæ—¶ï¼Œåˆ™å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦åˆ™ç›´æ¥è¿”å›å¯¹è±¡\n            instance = new Singleton();//å®ä¾‹åŒ–å¯¹è±¡\n        }\n        return instance;//è¿”å›å·²å­˜åœ¨çš„å¯¹è±¡\n    }\n}\n</code></pre><p>ä½†æˆ‘ä»¬å‰é¢è®²è¿‡ï¼ŒåŒæ­¥é”ä¼šå¢åŠ é”ç«äº‰ï¼Œå¸¦æ¥ç³»ç»Ÿæ€§èƒ½å¼€é”€ï¼Œä»è€Œå¯¼è‡´ç³»ç»Ÿæ€§èƒ½ä¸‹é™ï¼Œå› æ­¤è¿™ç§æ–¹å¼ä¹Ÿä¼šé™ä½å•ä¾‹æ¨¡å¼çš„æ€§èƒ½ã€‚</p><p>è¿˜æœ‰ï¼Œæ¯æ¬¡è¯·æ±‚è·å–ç±»å¯¹è±¡æ—¶ï¼Œéƒ½ä¼šé€šè¿‡getInstance()æ–¹æ³•è·å–ï¼Œé™¤äº†ç¬¬ä¸€æ¬¡ä¸ºnullï¼Œå…¶å®ƒæ¯æ¬¡è¯·æ±‚åŸºæœ¬éƒ½æ˜¯ä¸ä¸ºnullçš„ã€‚åœ¨æ²¡æœ‰åŠ åŒæ­¥é”ä¹‹å‰ï¼Œæ˜¯å› ä¸ºifåˆ¤æ–­æ¡ä»¶ä¸ºnullæ—¶ï¼Œæ‰å¯¼è‡´åˆ›å»ºäº†å¤šä¸ªå®ä¾‹ã€‚åŸºäºä»¥ä¸Šä¸¤ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†åŒæ­¥é”æ”¾åœ¨ifæ¡ä»¶é‡Œé¢ï¼Œè¿™æ ·å°±å¯ä»¥å‡å°‘åŒæ­¥é”èµ„æºç«äº‰ã€‚</p><pre><code>//æ‡’æ±‰æ¨¡å¼ + synchronizedåŒæ­¥é”\npublic final class Singleton {\n    private static Singleton instance= null;//ä¸å®ä¾‹åŒ–\n    private Singleton(){}//æ„é€ å‡½æ•°\n    public static Singleton getInstance(){//åŠ åŒæ­¥é”ï¼Œé€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹\n        if(null == instance){//å½“instanceä¸ºnullæ—¶ï¼Œåˆ™å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦åˆ™ç›´æ¥è¿”å›å¯¹è±¡\n          synchronized (Singleton.class){\n              instance = new Singleton();//å®ä¾‹åŒ–å¯¹è±¡\n          } \n        }\n        return instance;//è¿”å›å·²å­˜åœ¨çš„å¯¹è±¡\n    }\n}\n</code></pre><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ æ˜¯ä¸æ˜¯è§‰å¾—è¿™æ ·å°±å¯ä»¥äº†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¾ç„¶ä¼šåˆ›å»ºå¤šä¸ªå®ä¾‹ã€‚è¿™æ˜¯å› ä¸ºå½“å¤šä¸ªçº¿ç¨‹è¿›å…¥åˆ°ifåˆ¤æ–­æ¡ä»¶é‡Œï¼Œè™½ç„¶æœ‰åŒæ­¥é”ï¼Œä½†æ˜¯è¿›å…¥åˆ°åˆ¤æ–­æ¡ä»¶é‡Œé¢çš„çº¿ç¨‹ä¾ç„¶ä¼šä¾æ¬¡è·å–åˆ°é”åˆ›å»ºå¯¹è±¡ï¼Œç„¶åå†é‡Šæ”¾åŒæ­¥é”ã€‚æ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åœ¨åŒæ­¥é”é‡Œé¢å†åŠ ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶ï¼š</p><pre><code>//æ‡’æ±‰æ¨¡å¼ + synchronizedåŒæ­¥é” + double-check\npublic final class Singleton {\n    private static Singleton instance= null;//ä¸å®ä¾‹åŒ–\n    private Singleton(){}//æ„é€ å‡½æ•°\n    public static Singleton getInstance(){//åŠ åŒæ­¥é”ï¼Œé€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹\n        if(null == instance){//ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå½“instanceä¸ºnullæ—¶ï¼Œåˆ™å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦åˆ™ç›´æ¥è¿”å›å¯¹è±¡\n          synchronized (Singleton.class){//åŒæ­¥é”\n             if(null == instance){//ç¬¬äºŒæ¬¡åˆ¤æ–­\n                instance = new Singleton();//å®ä¾‹åŒ–å¯¹è±¡\n             }\n          } \n        }\n        return instance;//è¿”å›å·²å­˜åœ¨çš„å¯¹è±¡\n    }\n}\n</code></pre><p>ä»¥ä¸Šè¿™ç§æ–¹å¼ï¼Œé€šå¸¸è¢«ç§°ä¸ºDouble-Checkï¼Œå®ƒå¯ä»¥å¤§å¤§æé«˜æ”¯æŒå¤šçº¿ç¨‹çš„æ‡’æ±‰æ¨¡å¼çš„è¿è¡Œæ€§èƒ½ã€‚é‚£è¿™æ ·åšæ˜¯ä¸æ˜¯å°±èƒ½ä¿è¯ä¸‡æ— ä¸€å¤±äº†å‘¢ï¼Ÿè¿˜ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</p><p>å…¶å®è¿™é‡Œåˆè·ŸHappens-Beforeè§„åˆ™å’Œé‡æ’åºæ‰¯ä¸Šå…³ç³»äº†ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸‹Happens-Beforeè§„åˆ™å’Œé‡æ’åºã€‚</p><p>æˆ‘ä»¬åœ¨ç¬¬äºŒæœŸ<a href=\"https://time.geekbang.org/column/article/105756\">åŠ é¤</a>ä¸­åˆ†äº«è¿‡ï¼Œç¼–è¯‘å™¨ä¸ºäº†å°½å¯èƒ½åœ°å‡å°‘å¯„å­˜å™¨çš„è¯»å–ã€å­˜å‚¨æ¬¡æ•°ï¼Œä¼šå……åˆ†å¤ç”¨å¯„å­˜å™¨çš„å­˜å‚¨å€¼ï¼Œæ¯”å¦‚ä»¥ä¸‹ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œé‡æ’åºä¼˜åŒ–ï¼Œæ­£å¸¸çš„æ‰§è¡Œé¡ºåºæ˜¯æ­¥éª¤1/2/3ï¼Œè€Œåœ¨ç¼–è¯‘æœŸé—´è¿›è¡Œäº†é‡æ’åºä¼˜åŒ–ä¹‹åï¼Œæ‰§è¡Œçš„æ­¥éª¤æœ‰å¯èƒ½å°±å˜æˆäº†æ­¥éª¤1/3/2ï¼Œè¿™æ ·å°±èƒ½å‡å°‘ä¸€æ¬¡å¯„å­˜å™¨çš„å­˜å–æ¬¡æ•°ã€‚</p><pre><code>int a = 1;//æ­¥éª¤1ï¼šåŠ è½½aå˜é‡çš„å†…å­˜åœ°å€åˆ°å¯„å­˜å™¨ä¸­ï¼ŒåŠ è½½1åˆ°å¯„å­˜å™¨ä¸­ï¼ŒCPUé€šè¿‡movæŒ‡ä»¤æŠŠ1å†™å…¥åˆ°å¯„å­˜å™¨æŒ‡å®šçš„å†…å­˜ä¸­\nint b = 2;//æ­¥éª¤2 åŠ è½½bå˜é‡çš„å†…å­˜åœ°å€åˆ°å¯„å­˜å™¨ä¸­ï¼ŒåŠ è½½2åˆ°å¯„å­˜å™¨ä¸­ï¼ŒCPUé€šè¿‡movæŒ‡ä»¤æŠŠ2å†™å…¥åˆ°å¯„å­˜å™¨æŒ‡å®šçš„å†…å­˜ä¸­\na = a + 1;//æ­¥éª¤3 é‡æ–°åŠ è½½aå˜é‡çš„å†…å­˜åœ°å€åˆ°å¯„å­˜å™¨ä¸­ï¼ŒåŠ è½½1åˆ°å¯„å­˜å™¨ä¸­ï¼ŒCPUé€šè¿‡movæŒ‡ä»¤æŠŠ1å†™å…¥åˆ°å¯„å­˜å™¨æŒ‡å®šçš„å†…å­˜ä¸­\n</code></pre><p>åœ¨  JMM  ä¸­ï¼Œé‡æ’åºæ˜¯ååˆ†é‡è¦çš„ä¸€ç¯ï¼Œç‰¹åˆ«æ˜¯åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ã€‚å¦‚æœJVMå¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œä»»æ„æ’åºä»¥æé«˜ç¨‹åºæ€§èƒ½ï¼Œä¹Ÿå¯èƒ½ä¼šç»™å¹¶å‘ç¼–ç¨‹å¸¦æ¥ä¸€ç³»åˆ—çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä¸Šé¢è®²åˆ°çš„Double-Checkçš„å•ä¾‹é—®é¢˜ï¼Œå‡è®¾ç±»ä¸­æœ‰å…¶å®ƒçš„å±æ€§ä¹Ÿéœ€è¦å®ä¾‹åŒ–ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œé™¤äº†è¦å®ä¾‹åŒ–å•ä¾‹ç±»æœ¬èº«ï¼Œè¿˜éœ€è¦å¯¹å…¶å®ƒå±æ€§ä¹Ÿè¿›è¡Œå®ä¾‹åŒ–ï¼š</p><pre><code>//æ‡’æ±‰æ¨¡å¼ + synchronizedåŒæ­¥é” + double-check\npublic final class Singleton {\n    private static Singleton instance= null;//ä¸å®ä¾‹åŒ–\n    public List&lt;String&gt; list = null;//listå±æ€§\n    private Singleton(){\n      list = new ArrayList&lt;String&gt;();\n    }//æ„é€ å‡½æ•°\n    public static Singleton getInstance(){//åŠ åŒæ­¥é”ï¼Œé€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹\n        if(null == instance){//ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå½“instanceä¸ºnullæ—¶ï¼Œåˆ™å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦åˆ™ç›´æ¥è¿”å›å¯¹è±¡\n          synchronized (Singleton.class){//åŒæ­¥é”\n             if(null == instance){//ç¬¬äºŒæ¬¡åˆ¤æ–­\n                instance = new Singleton();//å®ä¾‹åŒ–å¯¹è±¡\n             }\n          } \n        }\n        return instance;//è¿”å›å·²å­˜åœ¨çš„å¯¹è±¡\n    }\n}\n</code></pre><p>åœ¨æ‰§è¡Œinstance = new Singleton();ä»£ç æ—¶ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå®ä¾‹è¿‡ç¨‹è¿™æ ·çš„ï¼š</p><ul>\n<li>ç»™ Singleton åˆ†é…å†…å­˜ï¼›</li>\n<li>è°ƒç”¨ Singleton çš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–æˆå‘˜å˜é‡ï¼›</li>\n<li>å°† Singleton å¯¹è±¡æŒ‡å‘åˆ†é…çš„å†…å­˜ç©ºé—´ï¼ˆæ‰§è¡Œå®Œè¿™æ­¥ singleton å°±ä¸ºé null äº†ï¼‰ã€‚</li>\n</ul><p>å¦‚æœè™šæ‹Ÿæœºå‘ç”Ÿäº†é‡æ’åºä¼˜åŒ–ï¼Œè¿™ä¸ªæ—¶å€™æ­¥éª¤3å¯èƒ½å‘ç”Ÿåœ¨æ­¥éª¤2ä¹‹å‰ã€‚å¦‚æœåˆå§‹åŒ–çº¿ç¨‹åˆšå¥½å®Œæˆæ­¥éª¤3ï¼Œè€Œæ­¥éª¤2æ²¡æœ‰è¿›è¡Œæ—¶ï¼Œåˆ™åˆšå¥½æœ‰å¦ä¸€ä¸ªçº¿ç¨‹åˆ°äº†ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œè¿™ä¸ªæ—¶å€™åˆ¤æ–­ä¸ºénullï¼Œå¹¶è¿”å›å¯¹è±¡ä½¿ç”¨ï¼Œè¿™ä¸ªæ—¶å€™å®é™…æ²¡æœ‰å®Œæˆå…¶å®ƒå±æ€§çš„æ„é€ ï¼Œå› æ­¤ä½¿ç”¨è¿™ä¸ªå±æ€§å°±å¾ˆå¯èƒ½ä¼šå¯¼è‡´å¼‚å¸¸ã€‚åœ¨è¿™é‡Œï¼ŒSynchronizedåªèƒ½ä¿è¯å¯è§æ€§ã€åŸå­æ€§ï¼Œæ— æ³•ä¿è¯æ‰§è¡Œçš„é¡ºåºã€‚</p><p>è¿™ä¸ªæ—¶å€™ï¼Œå°±ä½“ç°å‡ºHappens-Beforeè§„åˆ™çš„é‡è¦æ€§äº†ã€‚é€šè¿‡å­—é¢æ„æ€ï¼Œä½ å¯èƒ½ä¼šè¯¯ä»¥ä¸ºæ˜¯å‰ä¸€ä¸ªæ“ä½œå‘ç”Ÿåœ¨åä¸€ä¸ªæ“ä½œä¹‹å‰ã€‚ç„¶è€ŒçœŸæ­£çš„æ„æ€æ˜¯ï¼Œå‰ä¸€ä¸ªæ“ä½œçš„ç»“æœå¯ä»¥è¢«åç»­çš„æ“ä½œè·å–ã€‚è¿™æ¡è§„åˆ™è§„èŒƒäº†ç¼–è¯‘å™¨å¯¹ç¨‹åºçš„é‡æ’åºä¼˜åŒ–ã€‚</p><p>æˆ‘ä»¬çŸ¥é“volatileå…³é”®å­—å¯ä»¥ä¿è¯çº¿ç¨‹é—´å˜é‡çš„å¯è§æ€§ï¼Œç®€å•åœ°è¯´å°±æ˜¯å½“çº¿ç¨‹Aå¯¹å˜é‡Xè¿›è¡Œä¿®æ”¹åï¼Œåœ¨çº¿ç¨‹Aåé¢æ‰§è¡Œçš„å…¶å®ƒçº¿ç¨‹å°±èƒ½çœ‹åˆ°å˜é‡Xçš„å˜åŠ¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œvolatileåœ¨JDK1.5ä¹‹åè¿˜æœ‰ä¸€ä¸ªä½œç”¨å°±æ˜¯é˜»æ­¢å±€éƒ¨é‡æ’åºçš„å‘ç”Ÿï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œvolatileå˜é‡çš„æ“ä½œæŒ‡ä»¤éƒ½ä¸ä¼šè¢«é‡æ’åºã€‚æ‰€ä»¥ä½¿ç”¨volatileä¿®é¥°instanceä¹‹åï¼ŒDouble-Checkæ‡’æ±‰å•ä¾‹æ¨¡å¼å°±ä¸‡æ— ä¸€å¤±äº†ã€‚</p><pre><code>//æ‡’æ±‰æ¨¡å¼ + synchronizedåŒæ­¥é” + double-check\npublic final class Singleton {\n    private volatile static Singleton instance= null;//ä¸å®ä¾‹åŒ–\n    public List&lt;String&gt; list = null;//listå±æ€§\n    private Singleton(){\n      list = new ArrayList&lt;String&gt;();\n    }//æ„é€ å‡½æ•°\n    public static Singleton getInstance(){//åŠ åŒæ­¥é”ï¼Œé€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹\n        if(null == instance){//ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå½“instanceä¸ºnullæ—¶ï¼Œåˆ™å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦åˆ™ç›´æ¥è¿”å›å¯¹è±¡\n          synchronized (Singleton.class){//åŒæ­¥é”\n             if(null == instance){//ç¬¬äºŒæ¬¡åˆ¤æ–­\n                instance = new Singleton();//å®ä¾‹åŒ–å¯¹è±¡\n             }\n          } \n        }\n        return instance;//è¿”å›å·²å­˜åœ¨çš„å¯¹è±¡\n    }\n}\n</code></pre><h2>é€šè¿‡å†…éƒ¨ç±»å®ç°</h2><p>ä»¥ä¸Šè¿™ç§åŒæ­¥é”+Double-Checkçš„å®ç°æ–¹å¼ç›¸å¯¹æ¥è¯´ï¼Œå¤æ‚ä¸”åŠ äº†åŒæ­¥é”ï¼Œé‚£æœ‰æ²¡æœ‰ç¨å¾®ç®€å•ä¸€ç‚¹å„¿çš„å¯ä»¥å®ç°çº¿ç¨‹å®‰å…¨çš„æ‡’åŠ è½½æ–¹å¼å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨é¥¿æ±‰æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†staticä¿®é¥°äº†æˆå‘˜å˜é‡instanceï¼Œæ‰€ä»¥è¯¥å˜é‡ä¼šåœ¨ç±»åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­è¢«æ”¶é›†è¿›ç±»æ„é€ å™¨å³&lt;clinit&gt;æ–¹æ³•ä¸­ã€‚åœ¨å¤šçº¿ç¨‹åœºæ™¯ä¸‹ï¼ŒJVMä¼šä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œè¯¥ç±»çš„&lt;clinit&gt;æ–¹æ³•ï¼Œå…¶å®ƒçº¿ç¨‹å°†ä¼šè¢«é˜»å¡ç­‰å¾…ã€‚è¿™ç§æ–¹å¼å¯ä»¥ä¿è¯å†…å­˜çš„å¯è§æ€§ã€é¡ºåºæ€§ä»¥åŠåŸå­æ€§ã€‚</p><p>å¦‚æœæˆ‘ä»¬åœ¨Singletonç±»ä¸­åˆ›å»ºä¸€ä¸ªå†…éƒ¨ç±»æ¥å®ç°æˆå‘˜å˜é‡çš„åˆå§‹åŒ–ï¼Œåˆ™å¯ä»¥é¿å…å¤šçº¿ç¨‹ä¸‹é‡å¤åˆ›å»ºå¯¹è±¡çš„æƒ…å†µå‘ç”Ÿã€‚è¿™ç§æ–¹å¼ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨getInstance()æ–¹æ³•æ—¶ï¼Œæ‰ä¼šåŠ è½½InnerSingletonç±»ï¼Œè€Œåªæœ‰åœ¨åŠ è½½InnerSingletonç±»ä¹‹åï¼Œæ‰ä¼šå®ä¾‹åŒ–åˆ›å»ºå¯¹è±¡ã€‚å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><pre><code>//æ‡’æ±‰æ¨¡å¼ å†…éƒ¨ç±»å®ç°\npublic final class Singleton {\n\tpublic List&lt;String&gt; list = null;// listå±æ€§\n\n\tprivate Singleton() {//æ„é€ å‡½æ•°\n\t\tlist = new ArrayList&lt;String&gt;();\n\t}\n\n\t// å†…éƒ¨ç±»å®ç°\n\tpublic static class InnerSingleton {\n\t\tprivate static Singleton instance=new Singleton();//è‡ªè¡Œåˆ›å»ºå®ä¾‹\n\t}\n\n\tpublic static Singleton getInstance() {\n\t\treturn InnerSingleton.instance;// è¿”å›å†…éƒ¨ç±»ä¸­çš„é™æ€å˜é‡\n\t}\n}\n</code></pre><h2>æ€»ç»“</h2><p>å•ä¾‹çš„å®ç°æ–¹å¼å…¶å®æœ‰å¾ˆå¤šï¼Œä½†æ€»ç»“èµ·æ¥å°±ä¸¤ç§ï¼šé¥¿æ±‰æ¨¡å¼å’Œæ‡’æ±‰æ¨¡å¼ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥åšé€‰æ‹©ã€‚</p><p>å¦‚æœæˆ‘ä»¬åœ¨ç¨‹åºå¯åŠ¨åï¼Œä¸€å®šä¼šåŠ è½½åˆ°ç±»ï¼Œé‚£ä¹ˆç”¨é¥¿æ±‰æ¨¡å¼å®ç°çš„å•ä¾‹ç®€å•åˆå®ç”¨ï¼›å¦‚æœæˆ‘ä»¬æ˜¯å†™ä¸€äº›å·¥å…·ç±»ï¼Œåˆ™ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨æ‡’æ±‰æ¨¡å¼ï¼Œå› ä¸ºå¾ˆå¤šé¡¹ç›®å¯èƒ½ä¼šå¼•ç”¨åˆ°jaråŒ…ï¼Œä½†æœªå¿…ä¼šä½¿ç”¨åˆ°è¿™ä¸ªå·¥å…·ç±»ï¼Œæ‡’æ±‰æ¨¡å¼å®ç°çš„å•ä¾‹å¯ä»¥é¿å…æå‰è¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå ç”¨ç³»ç»Ÿèµ„æºã€‚</p><h2>æ€è€ƒé¢˜</h2><p><span class=\"orange\">é™¤äº†ä»¥ä¸Šé‚£äº›å®ç°å•ä¾‹çš„æ–¹å¼ï¼Œä½ è¿˜çŸ¥é“å…¶å®ƒå®ç°æ–¹å¼å—ï¼Ÿ</span></p><p>æœŸå¾…åœ¨ç•™è¨€åŒºçœ‹åˆ°ä½ çš„ç­”æ¡ˆã€‚ä¹Ÿæ¬¢è¿ä½ ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ï¼Œé‚€è¯·ä»–ä¸€èµ·è®¨è®ºã€‚</p><p></p>","neighbors":{"left":{"article_title":"26 | ç­”ç–‘è¯¾å ‚ï¼šæ¨¡å—å››çƒ­ç‚¹é—®é¢˜è§£ç­”","id":109201},"right":{"article_title":"28 | åŸå‹æ¨¡å¼ä¸äº«å…ƒæ¨¡å¼ï¼šæå‡ç³»ç»Ÿæ€§èƒ½çš„åˆ©å™¨","id":109980}},"comments":[{"had_liked":false,"id":116444,"user_name":"Loubobooo","can_delete":false,"product_type":"c1","uid":1108306,"ip_address":"","ucode":"7B2543A80EBDEF","user_header":"https://static001.geekbang.org/account/avatar/00/10/e9/52/aa3be800.jpg","comment_is_top":false,"comment_ctime":1563851376,"is_pvip":false,"replies":[{"id":"42694","content":"å¾ˆèµï¼è¿™æ˜¯ä¸€ç§æ‡’åŠ è½½æ¨¡å¼çš„æšä¸¾å®ç°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563931850,"ip_address":"","comment_id":116444,"utype":1}],"discussion_count":7,"race_medal":0,"score":"229197118064","product_id":100028001,"comment_content":"ä½¿ç”¨æšä¸¾æ¥å®ç°å•ä¾‹æ¨¡å¼ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼špublic class SinletonExample5 {<br>    private static SinletonExample5 instance = null;<br><br>    &#47;&#47; ç§æœ‰æ„é€ å‡½æ•°<br>    private SinletonExample5(){<br>    }<br><br>    public static SinletonExample5 getInstance(){<br>        return Sinleton.SINLETON.getInstance();<br>    }<br><br>    private enum Sinleton{<br>        SINLETON;<br><br>        private SinletonExample5 singleton;<br><br>        &#47;&#47; JVMä¿è¯è¿™ä¸ªæ–¹æ³•åªè°ƒç”¨ä¸€æ¬¡<br>        Sinleton(){<br>            singleton = new SinletonExample5();<br>        }<br><br>        public SinletonExample5 getInstance(){<br>            return singleton;<br>        }<br>    }<br>}","like_count":54,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459541,"discussion_content":"å¾ˆèµï¼è¿™æ˜¯ä¸€ç§æ‡’åŠ è½½æ¨¡å¼çš„æšä¸¾å®ç°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563931850,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1307497,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f3/69/7039d03f.jpg","nickname":"ä¹¦ç­–ç¨ æµŠ","note":"","ucode":"A29875CE15FDA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386507,"discussion_content":"å°±æ˜¯å†…éƒ¨ç±»å§ï¼Œæ¢äº†ä¸ªå†™æ³•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627620874,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1038574,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/d8/ee/6e7c2264.jpg","nickname":"Only now","note":"","ucode":"C617473A03AE27","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":321778,"discussion_content":"ä¸å†…éƒ¨ç±»çš„å®ç°æ–¹æ¡ˆæ²¡æœ‰æœ¬è´¨åŒºåˆ« ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604631175,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304000,"discussion_content":"å’Œé™æ€å†…éƒ¨ç±»å¼‚æ›²åŒå·¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599446821,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1181960,"avatar":"https://static001.geekbang.org/account/avatar/00/12/09/08/f3547e77.jpg","nickname":"lobby","note":"","ucode":"8D81722BE36AD4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":261658,"discussion_content":"è€å“¥çš„å®ç°å¥½ï¼Œå®‰å…¨åˆå»¶è¿ŸåŠ è½½äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588989627,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1205697,"avatar":"https://static001.geekbang.org/account/avatar/00/12/65/c1/afcd981b.jpg","nickname":"ç¨‹åºå‘˜äºŒå¸ˆå…„","note":"","ucode":"C9E3B5B3358BDF","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258786,"discussion_content":"pretty good","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588728093,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1073027,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5f/83/bb728e53.jpg","nickname":"Douglas","note":"","ucode":"CFDE3D76B9DAE6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":47647,"discussion_content":"è¿™ç§æ–¹å¼å·²ç»å¤±å»äº†ä½¿ç”¨æšä¸¾çš„æ„ä¹‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573385501,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116291,"user_name":"è±†æ³¥ä¸¸","can_delete":false,"product_type":"c1","uid":1186828,"ip_address":"","ucode":"D1638AFD21A224","user_header":"https://static001.geekbang.org/account/avatar/00/12/1c/0c/b5b2cd51.jpg","comment_is_top":false,"comment_ctime":1563833490,"is_pvip":false,"replies":[{"id":"42688","content":"å¯¹çš„ï¼Œæˆ‘ä»¬ä¹‹å‰åºåˆ—åŒ–ä¼˜åŒ–è¿™ä¸€è®²ä¸­çš„é—®ç­”é¢˜å°±æ˜¯ä¸æšä¸¾å®ç°å•ä¾‹ç›¸å…³ï¼Œã€ŠEffective Javaã€‹ä½œè€…ä¹Ÿæ˜¯å¼ºçƒˆæ¨èæšä¸¾æ–¹å¼å®ç°å•ä¾‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563930924,"ip_address":"","comment_id":116291,"utype":1}],"discussion_count":4,"race_medal":0,"score":"126117885074","product_id":100028001,"comment_content":"æœ€å®‰å…¨çš„æšä¸¾æ¨¡å¼ï¼Œåå°„å’Œåºåˆ—åŒ–éƒ½æ˜¯å•ä¾‹ã€‚","like_count":30,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459467,"discussion_content":"å¯¹çš„ï¼Œæˆ‘ä»¬ä¹‹å‰åºåˆ—åŒ–ä¼˜åŒ–è¿™ä¸€è®²ä¸­çš„é—®ç­”é¢˜å°±æ˜¯ä¸æšä¸¾å®ç°å•ä¾‹ç›¸å…³ï¼Œã€ŠEffective Javaã€‹ä½œè€…ä¹Ÿæ˜¯å¼ºçƒˆæ¨èæšä¸¾æ–¹å¼å®ç°å•ä¾‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563930924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1483912,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL4bZibSxNmZ2Ygpib7N4BWYanDZKWdX2epvXmR4G6ryHN9zsG43wUtoXb1ZtF65icTrz4SWdLiclAuicg/132","nickname":"solzs","note":"","ucode":"E8B7569A359235","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568184,"discussion_content":"æšä¸¾å•ä¾‹æ˜¯é¥¿æ±‰å®ç°,åå°„ä¼šæŠ¥é”™,javaä¸å…è®¸åå°„åˆ›å»ºæšä¸¾ç±»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651074051,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304001,"discussion_content":"æšä¸¾æ¯”é™æ€å†…éƒ¨ç±»å¥½åœ¨å“ªé‡Œï¼Ÿä¸æ˜¯ä¸€æ ·çš„å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599446911,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1483912,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL4bZibSxNmZ2Ygpib7N4BWYanDZKWdX2epvXmR4G6ryHN9zsG43wUtoXb1ZtF65icTrz4SWdLiclAuicg/132","nickname":"solzs","note":"","ucode":"E8B7569A359235","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":568183,"discussion_content":"å¥½åœ¨ååºåˆ—åŒ–å’Œåå°„éƒ½æ˜¯å®‰å…¨çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651073995,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":304001,"ip_address":""},"score":568183,"extra":""}]}]},{"had_liked":false,"id":116732,"user_name":"Jxin","can_delete":false,"product_type":"c1","uid":1251111,"ip_address":"","ucode":"4C03928388C413","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","comment_is_top":false,"comment_ctime":1563896911,"is_pvip":false,"replies":[{"id":"42717","content":"è™½ç„¶æœ‰ç‚¹ç»•ï¼Œè¿˜æ˜¯å€¼å¾—è¡¨æ‰¬çš„ã€‚æˆ‘ä»¬è¿˜æ˜¯é¼“åŠ±ç®€å•æ˜“æ‡‚çš„ç¼–ç¨‹é£æ ¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563933151,"ip_address":"","comment_id":116732,"utype":1}],"discussion_count":6,"race_medal":0,"score":"44513569871","product_id":100028001,"comment_content":"1.å¯èƒ½å¤§éƒ¨åˆ†åŒå­¦éƒ½çŸ¥é“ï¼Œä½†ä¸ºäº†å°‘éƒ¨åˆ†åŒå­¦ï¼Œæˆ‘åœ¨è€å¸ˆè¿™ä¸ªå•ä¾‹ä¸Šè¡¥ä¸ªç‚¹ã€‚å…¶å®ƒçº¿ç¨‹ç©ºæŒ‡é’ˆå¼‚å¸¸ç¡®å®æ˜¯æŒ‡ä»¤é‡æ’å¯¼è‡´çš„ï¼Œä½†å…¶åŸå› è¿˜æœ‰ä¸€ä¸ªã€‚åŠ é”å¹¶ä¸èƒ½é˜»æ­¢cpuè°ƒåº¦çº¿ç¨‹æ‰§è¡Œä½“ï¼Œæ‰€ä»¥æ—¶é—´ç‰‡è¿˜æ˜¯ä¼šåˆ‡çš„ï¼ˆå‡è®¾å•æ ¸ï¼‰ï¼Œæ‰€ä»¥å…¶ä»–çº¿ç¨‹ä¾æ—§ä¼šæ‰§è¡Œé”å¤–å±‚çš„ifï¼ˆï¼‰ï¼Œå¹¶å‘æƒ…å†µä¸‹å°±å¯èƒ½æ‹¿åˆ°ä»…èµ‹å€¼å¼•ç”¨ï¼Œæœªåœ¨å†…å­˜ç©ºé—´å­˜å‚¨æ•°æ®çš„å®ä¾‹ï¼ˆnullå®ä¾‹ï¼‰ï¼Œè¿›è€Œç©ºæŒ‡é’ˆã€‚<br>2.ç»™è€å¸ˆçš„ä»£ç è¡¥æ®µéªšçš„ï¼š<br>&#47;&#47; æ‡’æ±‰æ¨¡å¼ + synchronized åŒæ­¥é” + double-check<br>public final class Singleton {<br>    private static validate Singleton instance = null;&#47;&#47; ä¸å®ä¾‹åŒ–<br>    public List&lt;String&gt; list;&#47;&#47;list å±æ€§<br>    private Singleton(){<br>      list = new ArrayList&lt;String&gt;();<br>    }&#47;&#47; æ„é€ å‡½æ•°<br>    public static Singleton getInstance(){&#47;&#47; åŠ åŒæ­¥é”ï¼Œé€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹<br>        Singleton  temp = instanceï¼›<br>        if(null == temp){&#47;&#47; ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå½“ instance ä¸º null æ—¶ï¼Œåˆ™å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦åˆ™ç›´æ¥è¿”å›å¯¹è±¡<br>          synchronized ï¼ˆSingleton.classï¼‰{&#47;&#47; åŒæ­¥é”<br>             temp = instanceï¼›<br>             if(null == temp){&#47;&#47; ç¬¬äºŒæ¬¡åˆ¤æ–­<br>                temp = new Singleton();&#47;&#47; å®ä¾‹åŒ–å¯¹è±¡<br>                instance = tempï¼›<br>             }<br>          } <br>        }<br>        return instance;&#47;&#47; è¿”å›å·²å­˜åœ¨çš„å¯¹è±¡<br>    }<br>}<br>ç”¨ä¸´æ—¶å˜é‡åšæ–¹æ³•å†…æ•°æ®æ‰¿è½½ï¼ˆç›¸å¯¹äºvalidateä¿®é¥°çš„å±æ€§ï¼Œå¯ä»¥å‡å°‘ä»å†…å­˜ç›´æ¥æ‹·è´æ•°æ®çš„æ¬¡æ•°ï¼‰ï¼Œæœ€åç”¨instanceæ¥æ”¶ä¸´æ—¶å˜é‡æ—¶ï¼Œå› ä¸ºæ˜¯validateä¿®é¥°ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šæœ‰æŒ‡ä»¤é‡æ’ã€‚æ‰€ä»¥å‰é¢ä¸´æ—¶å˜é‡çš„èµ‹å€¼æ“ä½œå·²ç»å®Œæˆï¼Œè¿™æ ·instanceå°±å¿…ç„¶æ˜¯èµ‹å€¼å¥½çš„å®ä¾‹ã€‚ï¼ˆå¦‚æœ‰é”™è¯¯è¯·è€å¸ˆæŒ‡å‡ºï¼Œä»…ä¸ªäººç†è§£çš„éªšæ“ä½œï¼‰<br><br>3.æé™ç¼–ç¨‹è¯•è¯•å°±å¥½ï¼Œä¸šåŠ¡ä»£ç è¿˜æ˜¯å°½é‡ä¼˜å…ˆä¿è¯å¯è¯»æ€§ï¼Œåªæœ‰åœ¨æœ‰æ€§èƒ½éœ€æ±‚æ—¶å†é‡‡ç”¨å½±å“å¯è¯»æ€§çš„æ€§èƒ½ä¼˜åŒ–ã€‚æˆ‘çš„è¿™ç§éªšå†™æ³•å’Œè€å¸ˆçš„å†…éƒ¨ç±»ï¼Œè¿™ç§çœ‹èµ·æ¥éœ€è¦æƒ³é‚£ä¹ˆä¸€ä¸‹çš„ä¸œè¥¿å°½é‡é¿å…ï¼Œç®€å•æ‰æ˜¯ç‹é“ã€‚","like_count":11,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459663,"discussion_content":"è™½ç„¶æœ‰ç‚¹ç»•ï¼Œè¿˜æ˜¯å€¼å¾—è¡¨æ‰¬çš„ã€‚æˆ‘ä»¬è¿˜æ˜¯é¼“åŠ±ç®€å•æ˜“æ‡‚çš„ç¼–ç¨‹é£æ ¼ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563933151,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1655960,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/s3l1cvljHFoibnZEHaLl4IJ1ryRFI0zYePAVdYfhfcoyr20uEaf1ibZhMHb5aze8Fuib8FnoYbsC0mnggIeYIjVzg/132","nickname":"åˆæœˆåä¸‰","note":"","ucode":"4383EA1DBE959B","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":368011,"discussion_content":"è¿™ç§å†™æ³•æ˜¯åœ¨jdk1.4åŠä¹‹å‰çš„ç‰ˆæœ¬é¢å¯¹é‡æ’åºçš„æä¾›ä¸€ç§å†™æ³•å§ï¼Œå› ä¸ºé‚£æ—¶å€™è€çš„å†…å­˜æ¨¡å‹ä¸­ï¼Œvolatileæ²¡æœ‰ç¦æ­¢é‡æ’åºçš„è¯­ä¹‰ï¼Œä½†æ˜¯å¯æƒœçš„æ˜¯ï¼Œåœ¨é‚£ä¸ªå¹´ä»£ï¼Œè¿™ç§å†™æ³•è¿˜æ˜¯æ²¡åŠæ³•å®Œç¾é¿å…è¿™äº›é—®é¢˜ã€‚æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆè¿˜æ˜¯æ–°å†…å­˜æ¨¡å‹çš„volatileç¦æ­¢é‡æ’åºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618539073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304008,"discussion_content":"volatile å…³é”®å­—ï¼Œå…¨éƒ¨å†™æˆvalidateï¼ˆæ ¡éªŒï¼‰ä¹Ÿæ˜¯é†‰äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599447647,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1099216,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c5/d0/cf6bbe55.jpg","nickname":"CALL ME","note":"","ucode":"2A5BE26EAC9716","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301356,"discussion_content":"åº”è¯¥return tempå§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598499742,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1232984,"avatar":"https://static001.geekbang.org/account/avatar/00/12/d0/58/ac40120f.jpg","nickname":"biubiubiu","note":"","ucode":"3310E95533D22B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282066,"discussion_content":"è…»å®³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591878337,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1073027,"avatar":"https://static001.geekbang.org/account/avatar/00/10/5f/83/bb728e53.jpg","nickname":"Douglas","note":"","ucode":"CFDE3D76B9DAE6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":47649,"discussion_content":"ä¸é”™çš„ï¼Œspringæºç ä¸­å¤§é‡è¿™æ ·çš„ä»£ç ï¼Œå¾ˆèµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573385766,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116490,"user_name":"è¡Œè€…","can_delete":false,"product_type":"c1","uid":1063734,"ip_address":"","ucode":"EA31201A7C5AE1","user_header":"https://static001.geekbang.org/account/avatar/00/10/3b/36/2d61e080.jpg","comment_is_top":false,"comment_ctime":1563857043,"is_pvip":false,"replies":[{"id":"42697","content":"ä¹Ÿå¯ä»¥ä½¿ç”¨æšä¸¾å®ç°æ‡’æ±‰æ¨¡å¼ï¼Œå¯ä»¥æ ¹æ®æœ¬è®²ä¸­çš„ä½¿ç”¨å†…éƒ¨ç±»æ–¹å¼å®ç°æ‡’åŠ è½½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563931998,"ip_address":"","comment_id":116490,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40218562707","product_id":100028001,"comment_content":"æšä¸¾ä¹Ÿæ˜¯ä¸€ç§å•ä¾‹æ¨¡å¼ï¼ŒåŒæ—¶æ˜¯é¥¿æ±‰å¼ã€‚<br>ç›¸æ¯”Double Checkï¼Œä»¥å†…éƒ¨ç±»æ–¹å¼å®ç°å•ä¾‹æ¨¡å¼ï¼Œä»£ç ç®€æ´ï¼Œæ€§èƒ½ç›¸è¿‘ï¼Œåœ¨æˆ‘çœ‹æ¥æ˜¯æ›´ä¼˜çš„é€‰æ‹©ã€‚","like_count":9,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459565,"discussion_content":"ä¹Ÿå¯ä»¥ä½¿ç”¨æšä¸¾å®ç°æ‡’æ±‰æ¨¡å¼ï¼Œå¯ä»¥æ ¹æ®æœ¬è®²ä¸­çš„ä½¿ç”¨å†…éƒ¨ç±»æ–¹å¼å®ç°æ‡’åŠ è½½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563931998,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116325,"user_name":"-W.LI-","can_delete":false,"product_type":"c1","uid":1210699,"ip_address":"","ucode":"3556786538664F","user_header":"https://static001.geekbang.org/account/avatar/00/12/79/4b/740f91ca.jpg","comment_is_top":false,"comment_ctime":1563841519,"is_pvip":false,"replies":[{"id":"42692","content":"å¯¹çš„ï¼Œæšä¸¾æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œåœ¨Javaç¼–è¯‘åï¼Œæšä¸¾ç±»ä¸­çš„æšä¸¾ä¼šè¢«å£°æ˜ä¸ºstaticï¼Œæ¥ä¸‹æ¥å°±è·Ÿæˆ‘ä»¬æ–‡ä¸­è®²çš„ä¸€æ ·äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563931720,"ip_address":"","comment_id":116325,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31628612591","product_id":100028001,"comment_content":"æšä¸¾åº•å±‚å®ç°å°±æ˜¯é™æ€å†…éƒ¨ç±»å§","like_count":8,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459488,"discussion_content":"å¯¹çš„ï¼Œæšä¸¾æ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œåœ¨Javaç¼–è¯‘åï¼Œæšä¸¾ç±»ä¸­çš„æšä¸¾ä¼šè¢«å£°æ˜ä¸ºstaticï¼Œæ¥ä¸‹æ¥å°±è·Ÿæˆ‘ä»¬æ–‡ä¸­è®²çš„ä¸€æ ·äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563931720,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116298,"user_name":"æˆ‘åˆä¸ä¹±æ¥","can_delete":false,"product_type":"c1","uid":1221356,"ip_address":"","ucode":"737405E2339A8D","user_header":"https://static001.geekbang.org/account/avatar/00/12/a2/ec/205fd50c.jpg","comment_is_top":false,"comment_ctime":1563837282,"is_pvip":false,"replies":[{"id":"42693","content":"Springä¸­çš„beançš„å•ä¾‹è™½ç„¶æ˜¯ä¸€ç§å•ä¾‹æ•ˆæœï¼Œä½†å®ç°æ–¹å¼æ˜¯é€šè¿‡å®¹å™¨ç¼“å­˜å®ç°ï¼Œä¸¥æ ¼æ¥è¯´æ˜¯ä¸€ç§äº«å…ƒæ¨¡å¼ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563931801,"ip_address":"","comment_id":116298,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23038673762","product_id":100028001,"comment_content":"æšä¸¾å¤©ç”Ÿå°±æ˜¯å•ä¾‹ï¼Œä½†æ˜¯ä¸æ¸…æ¥šè¿™ä¹ˆå®ç°ã€‚<br>æ³¨å†Œå¼å•ä¾‹ï¼Œspringåº”è¯¥æ˜¯ç”¨çš„è¿™ç§ã€‚è¿™ä¸ªä¹Ÿä¸å¤ªæ¸…æ¥šï¼Œè¶…å“¥æœ‰æœºä¼šè®²ä¸€ä¸‹springçš„å®ç°æ–¹å¼å’Œæšä¸¾æ–¹å¼å®ç°çš„å•ä¾‹ã€‚è°¢è°¢ğŸ˜","like_count":6,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459472,"discussion_content":"Springä¸­çš„beançš„å•ä¾‹è™½ç„¶æ˜¯ä¸€ç§å•ä¾‹æ•ˆæœï¼Œä½†å®ç°æ–¹å¼æ˜¯é€šè¿‡å®¹å™¨ç¼“å­˜å®ç°ï¼Œä¸¥æ ¼æ¥è¯´æ˜¯ä¸€ç§äº«å…ƒæ¨¡å¼ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1563931801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":191011,"user_name":"æ‰¿é¦™å¢¨å½±","can_delete":false,"product_type":"c1","uid":1023750,"ip_address":"","ucode":"4D6A4D6E1ED29F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9f/06/287d77dd.jpg","comment_is_top":false,"comment_ctime":1584717366,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"18764586550","product_id":100028001,"comment_content":"è€å¸ˆï¼Œæ‚¨å¥½ï¼Œæœ‰ä¸ªé—®é¢˜æƒ³è¯·æ•™æ‚¨ã€‚<br>æˆ‘åœ¨çœ‹æå®¢æ—¶é—´ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¾ã€‹ä¸“æ ä¸­æœ‰ä¸€ç¯‡è®²å•ä¾‹çš„æ–‡ç« ï¼Œå…¶ä¸­è®²è¿°äº†åœ¨Javaçš„é«˜ç‰ˆæœ¬ä¸­ï¼Œå·²ç»ä¸éœ€è¦å¢åŠ volatileæ¥ç¦æ­¢ç±»é‡æ’åºã€‚<br>æˆ‘è‡ªå·±æŸ¥äº†ä¸€ä¸‹æ²¡æœ‰æ‰¾åˆ°ç›¸å…³çš„èµ„æ–™ï¼Œæˆ‘æƒ³è¯·é—®è¿™ä¸ªè¯´æ³•æœ‰ä¾æ®å—ï¼Ÿå¦‚æœæ˜¯è¿™æ ·çš„ï¼Œèƒ½ä¸èƒ½æ¨èä¸€äº›æ–‡ç« çš„é“¾æ¥æˆ–è€…èµ„æ–™æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Ÿ<br>----<br>åŸæ–‡å¦‚ä¸‹ï¼š<br>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç»™ instance æˆå‘˜å˜é‡åŠ ä¸Š volatile å…³é”®å­—ï¼Œç¦æ­¢æŒ‡ä»¤é‡æ’åºæ‰è¡Œã€‚å®é™…ä¸Šï¼Œåªæœ‰å¾ˆä½ç‰ˆæœ¬çš„ Java æ‰ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ç°åœ¨ç”¨çš„é«˜ç‰ˆæœ¬çš„ Java å·²ç»åœ¨ JDK å†…éƒ¨å®ç°ä¸­è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼ˆè§£å†³çš„æ–¹æ³•å¾ˆç®€å•ï¼Œåªè¦æŠŠå¯¹è±¡ new æ“ä½œå’Œåˆå§‹åŒ–æ“ä½œè®¾è®¡ä¸ºåŸå­æ“ä½œï¼Œå°±è‡ªç„¶èƒ½ç¦æ­¢é‡æ’åºï¼‰ã€‚","like_count":4,"discussions":[{"author":{"id":1926759,"avatar":"","nickname":"èµµç‰é—¯","note":"","ucode":"82E85AC08206EA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":231889,"discussion_content":"æˆ‘è§‰å¾—å¯ä»¥å•Šï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œåˆ«çš„çº¿ç¨‹åœ¨è¯»å–å®ä¾‹çš„æˆå‘˜å˜é‡çš„åˆ°æ—¶å€™ï¼Œé‡åˆ°äº†è¯»å†™é”ï¼Œæ˜¯ä¸æ˜¯è¿™ä¸ªæ„æ€ã€‚\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586836053,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1438863,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f4/8f/6b3d4370.jpg","nickname":"ç‘¶è€æ¿çš„å°å¼Ÿ","note":"","ucode":"EA6CDB3165227F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309153,"discussion_content":"é‡æ’åºè¯´ä¸€ç§ç¼–è¯‘å™¨ä¼˜åŒ–æ–¹å¼ï¼ŒDCLä¸­å­˜åœ¨çš„å®‰å…¨é—®é¢˜æ˜¯åˆ›å»ºå®ä¾‹çš„æ—¶å€™äº§ç”Ÿçš„ï¼Œå¦‚æœè°ƒç”¨æ„é€ å™¨çš„ä»£ç ç¼–è¯‘åä¸æ‰§è¡Œé‡æ’åºï¼Œå°±ä¸ä¼šå‡ºç°å®‰å…¨é—®é¢˜äº†ã€‚è¯¦è§ã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹ 3.8èŠ‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601198687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":145369,"user_name":"ylw66","can_delete":false,"product_type":"c1","uid":1228185,"ip_address":"","ucode":"3FD0A4937793B7","user_header":"https://static001.geekbang.org/account/avatar/00/12/bd/99/851b0db6.jpg","comment_is_top":false,"comment_ctime":1572259063,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"18752128247","product_id":100028001,"comment_content":"ğŸ‘ï¼Œçœ‹è¿‡çš„è®²singletonæœ€å¥½çš„æ–‡ç« ","like_count":4},{"had_liked":false,"id":143520,"user_name":"å¼ ä¸‰ä¸°","can_delete":false,"product_type":"c1","uid":1155275,"ip_address":"","ucode":"3A6215A40B3B21","user_header":"https://static001.geekbang.org/account/avatar/00/11/a0/cb/aab3b3e7.jpg","comment_is_top":false,"comment_ctime":1571723931,"is_pvip":false,"replies":[{"id":"56522","content":"è¿™ä¸ªæ²¡æ³•è°ƒç”¨çš„å“¦ï¼Œé™æ€æ–¹æ³•æ— æ³•è°ƒç”¨éé™æ€æˆå‘˜å˜é‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1572520595,"ip_address":"","comment_id":143520,"utype":1}],"discussion_count":1,"race_medal":0,"score":"18751593115","product_id":100028001,"comment_content":"å¦‚æœæŠŠè¿™ä¸ªæˆå‘˜å˜é‡çš„staticå»æ‰ï¼Œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹å°±å¯èƒ½åˆ›å»ºå¤šä¸ªå®ä¾‹ï¼Œå•çº¿ç¨‹æ²¡é—®é¢˜ã€‚è€å¸ˆï¼Œè¿™ä¹ˆç†è§£æ²¡é—®é¢˜å§ï¼Ÿ<br><br><br>&#47;&#47; é¥¿æ±‰æ¨¡å¼<br>public final class Singleton {<br>    private  Singleton instance=new Singleton();&#47;&#47; è‡ªè¡Œåˆ›å»ºå®ä¾‹<br>    private Singleton(){}&#47;&#47; æ„é€ å‡½æ•°<br>    public static Singleton getInstance(){&#47;&#47; é€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹<br>        return instance;<br>    }<br>}","like_count":4,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471575,"discussion_content":"è¿™ä¸ªæ²¡æ³•è°ƒç”¨çš„å“¦ï¼Œé™æ€æ–¹æ³•æ— æ³•è°ƒç”¨éé™æ€æˆå‘˜å˜é‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572520595,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116547,"user_name":"Zed","can_delete":false,"product_type":"c1","uid":1184951,"ip_address":"","ucode":"09947C76F55A46","user_header":"https://static001.geekbang.org/account/avatar/00/12/14/b7/bb6a1fd4.jpg","comment_is_top":false,"comment_ctime":1563867237,"is_pvip":false,"replies":[{"id":"42700","content":"Springä¸­beançš„å•ä¾‹å°±æ˜¯ä½¿ç”¨å®¹å™¨æ¥å®ç°çš„ï¼Œä¾¿äºç®¡ç†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563932086,"ip_address":"","comment_id":116547,"utype":1}],"discussion_count":3,"race_medal":0,"score":"18743736421","product_id":100028001,"comment_content":"å®¹å™¨ç±»ç®¡ç†<br><br>class InstanceManager {<br>    private static Map&lt;String, Object&gt; objectMap = new HashMap&lt;&gt;();<br>    private InstanceManager(){}<br>    public static void registerService(String key,Object instance){<br>        if (!objectMap.containsKey(key)){<br>            objectMap.put(key,instance);<br>        }<br>    }<br>    public static Object getService(String key){<br>        return objectMap.get(key);<br>    }<br>}","like_count":4,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459588,"discussion_content":"Springä¸­beançš„å•ä¾‹å°±æ˜¯ä½¿ç”¨å®¹å™¨æ¥å®ç°çš„ï¼Œä¾¿äºç®¡ç†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563932086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1083504,"avatar":"https://static001.geekbang.org/account/avatar/00/10/88/70/32534e2d.jpg","nickname":"David Mo","note":"","ucode":"66C30A3CD7EDA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":2760,"discussion_content":"æ„Ÿè§‰è¿™ä¸ªå¤šç°åœºä¸‹ä¼šæœ‰é—®é¢˜çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563907801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1216848,"avatar":"https://static001.geekbang.org/account/avatar/00/12/91/50/e576a068.jpg","nickname":"åˆ˜å¤©è‹¥Warner","note":"","ucode":"032639CD670DA3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1083504,"avatar":"https://static001.geekbang.org/account/avatar/00/10/88/70/32534e2d.jpg","nickname":"David Mo","note":"","ucode":"66C30A3CD7EDA6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5257,"discussion_content":"å“ˆå“ˆæˆ‘ä¹Ÿè§‰å¾—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566119158,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":2760,"ip_address":""},"score":5257,"extra":""}]}]},{"had_liked":false,"id":116294,"user_name":"æˆ‘çŸ¥é“äº†å—¯","can_delete":false,"product_type":"c1","uid":1138471,"ip_address":"","ucode":"9186EC1F32C490","user_header":"https://static001.geekbang.org/account/avatar/00/11/5f/27/a6873bc9.jpg","comment_is_top":false,"comment_ctime":1563834944,"is_pvip":false,"replies":[{"id":"42691","content":"å¯¹çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563931395,"ip_address":"","comment_id":116294,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14448736832","product_id":100028001,"comment_content":"æšä¸¾å®ç°å•ä¾‹","like_count":3,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459470,"discussion_content":"å¯¹çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563931395,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":172989,"user_name":"æ¥Šå¨","can_delete":false,"product_type":"c1","uid":1025474,"ip_address":"","ucode":"8BA77716CE8179","user_header":"https://static001.geekbang.org/account/avatar/00/0f/a5/c2/41fa26df.jpg","comment_is_top":false,"comment_ctime":1579403615,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"5874370911","product_id":100028001,"comment_content":"çˆ±æ˜¯ä¸€é“å…‰","like_count":1},{"had_liked":false,"id":132555,"user_name":"è¡Œåˆ™å°†è‡³","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1568165418,"is_pvip":false,"replies":[{"id":"51130","content":"å¯ä»¥é€šè¿‡ååºåˆ—åŒ–å¯¹è±¡ç™½åå•æ¥æ§åˆ¶è¿è¡Œååºåˆ—å“ªäº›å¯¹è±¡ï¼Œè¿™ç§æ–¹å¼éœ€è¦é‡å†™resolveClass æ–¹æ³•ï¼Œå…·ä½“å‚è€ƒ09è®²ï¼š<br><br>æå®¢æ—¶é—´ç‰ˆæƒæ‰€æœ‰: https:&#47;&#47;time.geekbang.org&#47;column&#47;article&#47;99774","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568538655,"ip_address":"","comment_id":132555,"utype":1}],"discussion_count":1,"race_medal":1,"score":"5863132714","product_id":100028001,"comment_content":"è€å¸ˆã€‚æšä¸¾å•ä¾‹å¯ä»¥é˜²æ­¢åå°„æ”»å‡»ã€åºåˆ—åŒ–æ”»å‡»ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è¦è·å–çš„å®ä¾‹åŒ–å¯¹è±¡æ€ä¹ˆé˜²æ­¢æš´åŠ›åå°„å‘¢ï¼Ÿæˆ‘ç°åœ¨çš„åšæ³•æ˜¯åœ¨å®ä¾‹åŒ–å¯¹è±¡çš„ç§æœ‰æ„é€ å™¨ä¸­åŠ åˆ¤æ–­ï¼Œå¦‚æœæš´åŠ›åå°„ï¼Œç›´æ¥æŠ›å‡ºè¿è¡Œå¼‚å¸¸ã€‚è€å¸ˆæœ‰æ²¡æœ‰å¥½çš„åŠæ³•ï¼Ÿç™¾æ€ä¸å¾—å…¶è§£","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467006,"discussion_content":"å¯ä»¥é€šè¿‡ååºåˆ—åŒ–å¯¹è±¡ç™½åå•æ¥æ§åˆ¶è¿è¡Œååºåˆ—å“ªäº›å¯¹è±¡ï¼Œè¿™ç§æ–¹å¼éœ€è¦é‡å†™resolveClass æ–¹æ³•ï¼Œå…·ä½“å‚è€ƒ09è®²ï¼š\n\næå®¢æ—¶é—´ç‰ˆæƒæ‰€æœ‰: https://time.geekbang.org/column/article/99774","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568538655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124349,"user_name":"rong","can_delete":false,"product_type":"c1","uid":1128740,"ip_address":"","ucode":"637A27C532D817","user_header":"https://static001.geekbang.org/account/avatar/00/11/39/24/ab14f6cf.jpg","comment_is_top":false,"comment_ctime":1565864430,"is_pvip":false,"replies":[{"id":"45727","content":"å¯¹çš„ï¼Œå·²çº æ­£","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1565918541,"ip_address":"","comment_id":124349,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5860831726","product_id":100028001,"comment_content":"å¤§ä½¬ï¼Œè¯·æ•™ä¸ªé—®é¢˜ï¼Œâ€œè¿™ç§æ–¹å¼å®ç°çš„å•ä¾‹æ¨¡å¼ï¼Œåœ¨ç±»åŠ è½½é˜¶æ®µå°±å·²ç»åœ¨å †å†…å­˜ä¸­å¼€è¾Ÿäº†ä¸€å—å†…å­˜ï¼Œç”¨äºå­˜æ”¾å®ä¾‹åŒ–å¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿç§°ä¸ºé¥¿æ±‰æ¨¡å¼ã€‚â€ï¼Œ   é¥¿æ±‰æ¨¡å¼ä¸‹ï¼Œç±»åŠ è½½é˜¶æ®µï¼Œä¸ä¼šæ‰§è¡Œstaticä»£ç å—å’Œæˆå‘˜å˜é‡ï¼Œåˆå§‹åŒ–é˜¶æ®µçš„æ—¶å€™æ‰ä¼šæ‰§è¡Œã€‚æ‰€ä»¥ï¼Œç±»åŠ è½½é˜¶æ®µï¼Œä¸ä¼šå¼€è¾Ÿå†…å­˜å§ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463128,"discussion_content":"å¯¹çš„ï¼Œå·²çº æ­£","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565918541,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":118192,"user_name":"ä¸€ä¸ªå–ç«æŸ´çš„è€ç”·äºº","can_delete":false,"product_type":"c1","uid":1181265,"ip_address":"","ucode":"1227638C457F49","user_header":"https://static001.geekbang.org/account/avatar/00/12/06/51/1d24ead6.jpg","comment_is_top":false,"comment_ctime":1564286301,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5859253597","product_id":100028001,"comment_content":"è°¢è°¢è¶…å“¥åˆ†äº«ï¼Œå†™äº†è¿™ä¹ˆå¤šå¹´ä»£ç ï¼Œä¹Ÿçœ‹äº†ä¸å°‘åšå®¢ä¹Ÿå†™äº†ä¸å°‘åšå®¢ï¼Œä»Šå¤©ç®—æ˜¯å½»åº•ææ‡‚äº†ï¼Œå¾ˆå¤šæ—¶å€™éƒ½æ˜¯è§‰å¾—ä¼¼ä¹æ‡‚äº†ï¼Œè‡ªå·±åšå‘ç°è¿˜æœ‰ç‚¹æ¨¡ç³Šï¼Œå·¥ä½œå¿™åæ­£å¹³æ—¶éƒ½é‚£ä¹ˆå†™æ²¡æ·±ç©¶ã€‚getåˆ°äº†å¾ˆå¤šå¹²æ´»ã€‚è°¢è°¢ğŸ™","like_count":1},{"had_liked":false,"id":116651,"user_name":"QQæ€ª","can_delete":false,"product_type":"c1","uid":1211223,"ip_address":"","ucode":"1A39B8433D9208","user_header":"https://static001.geekbang.org/account/avatar/00/12/7b/57/a9b04544.jpg","comment_is_top":false,"comment_ctime":1563885177,"is_pvip":false,"replies":[{"id":"42701","content":"äº’ç›¸å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563932142,"ip_address":"","comment_id":116651,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5858852473","product_id":100028001,"comment_content":"è¿™ä¸€èŠ‚è™½ç„¶éƒ½æ‡‚ï¼Œä½†æ˜¯è¯„è®ºåŒºè¡¥å……çš„æˆ‘è¿˜æ˜¯ç¬¬ä¸€æ¬¡è§åˆ°ï¼Œgetåˆ°äº†ï¼Œæœ‰æ”¶è·ï¼Œå“ˆå“ˆ","like_count":1,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459626,"discussion_content":"äº’ç›¸å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563932142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":328226,"user_name":"æ¥ä¼½å±±äºº","can_delete":false,"product_type":"c1","uid":1142335,"ip_address":"","ucode":"5859C06DAC790D","user_header":"https://static001.geekbang.org/account/avatar/00/11/6e/3f/49e5079f.jpg","comment_is_top":false,"comment_ctime":1640613188,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1640613188","product_id":100028001,"comment_content":"è€å¸ˆä½ å¥½ å¯¹äºè¿™æ®µä»£ç æœ‰äº›ä¸ç†è§£çš„åœ°æ–¹ è¿™é‡Œæ˜¯å·²ç»åŠ äº†åŒæ­¥é” <br> éš¾é“ è¿™é‡Œé¢çš„ç¬¬3æ­¥ä¼šç»è¿‡æŒ‡ä»¤æ’åºæ’åˆ°åŒæ­¥é”å¤–é¢å»ä¹ˆï¼Ÿ å¦‚æœä¸ä¼šé‚£åŠ volatileå…³é”®å­—æ„ä¹‰ä½•åœ¨ï¼Ÿ<br> synchronized (Singleton.class){&#47;&#47;åŒæ­¥é”<br>             if(null == instance){&#47;&#47;ç¬¬äºŒæ¬¡åˆ¤æ–­ <br>                instance = new Singleton();&#47;&#47;å®ä¾‹åŒ–å¯¹è±¡<br>             }<br>          } ","like_count":0},{"had_liked":false,"id":290706,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1619695126,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1619695126","product_id":100028001,"comment_content":"Singleton ç±»åœ¨åŠ è½½ï¼Œè¿æ¥ï¼Œåˆå§‹åŒ–æ—¶ï¼Œæ²¡æ¶‰åŠåˆ°é™æ€å˜é‡å’Œé™æ€ä»£ç å—çš„æ‰§è¡Œæ“ä½œã€‚å½“è°ƒç”¨ç±»çš„é™æ€æ–¹æ³• getInstance() æ—¶ï¼Œè§¦å‘ InnerSingleton ç±»çš„åŠ è½½ï¼Œè¿æ¥ï¼Œåˆå§‹åŒ–æµç¨‹ï¼ŒInnerSingleton ç±»çš„é™æ€å˜é‡åœ¨å‡†å¤‡é˜¶æ®µä¼šè¢«åˆ†é…å†…å­˜ï¼Œå¹¶åˆå§‹åŒ–ä¸ºç³»ç»Ÿåˆå§‹å€¼ï¼Œåœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œä¼šè¢«æ”¶å½•åˆ° clinit æ–¹æ³•æ‰§è¡Œåˆå§‹åŒ–ä¸ºç”¨æˆ·æŒ‡å®šçš„å€¼ã€‚<br><br>æ˜¯è¿™æ ·ä¹ˆï¼Œè€å¸ˆã€‚è°¢è°¢ï¼","like_count":0},{"had_liked":false,"id":284625,"user_name":"FileNotfoundException","can_delete":false,"product_type":"c1","uid":1073951,"ip_address":"","ucode":"6C7731071F7C80","user_header":"https://static001.geekbang.org/account/avatar/00/10/63/1f/c9a783da.jpg","comment_is_top":false,"comment_ctime":1616393436,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1616393436","product_id":100028001,"comment_content":"public class Ceshi {<br><br><br><br>    public  static Ceshi getinstance(){<br>        return text.INSTANCE.getinstance();<br>    }<br><br><br>    enum text{<br>        &#47;**<br>         *<br>         *&#47;<br>        INSTANCE;<br><br>        private Ceshi ceshi=new Ceshi();<br><br><br>        public   Ceshi getinstance(){<br>            return ceshi;<br>        }<br><br>    }<br><br><br><br>    public static void main(String[] args) throws NoSuchMethodException, IllegalAccessException, InvocationTargetException, InstantiationException {<br>        System.out.println(Ceshi.getinstance());<br>        System.out.println(Ceshi.getinstance());<br>        System.out.println(Ceshi.getinstance()==Ceshi.getinstance());<br>        Class&lt;Ceshi&gt; c = Ceshi.class;<br>        Constructor&lt;Ceshi&gt; declaredConstructor = c.getDeclaredConstructor();<br>        declaredConstructor.setAccessible(true);<br>        Ceshi ceshi1 = declaredConstructor.newInstance();<br>        System.out.println(ceshi1);<br>        System.out.println(Ceshi.getinstance()==ceshi1);<br>    }<br>}<br>æˆ‘ä½¿ç”¨æšä¸¾å»åˆ›å»ºå•ä¾‹å¯¹è±¡ ,ä½†æ˜¯åå°„å»è°ƒç”¨,è¿˜æ˜¯ä¼šå‡ºç°å¤šä¸ªå¯¹è±¡,è¯·æŒ‡æ•™æ˜¯å“ªé‡Œå‡ºç°é—®é¢˜äº†,è°¢è°¢<br>===============è¿è¡Œç»“æœ==================<br>com.skyedu.live.constant.Ceshi@56f4468b<br>com.skyedu.live.constant.Ceshi@56f4468b<br>true<br>com.skyedu.live.constant.Ceshi@6cc4c815<br>false","like_count":0},{"had_liked":false,"id":254203,"user_name":"ç¼˜åˆ†æ³¨å®š","can_delete":false,"product_type":"c1","uid":1096361,"ip_address":"","ucode":"21E66B4B68B32C","user_header":"https://static001.geekbang.org/account/avatar/00/10/ba/a9/7614d645.jpg","comment_is_top":false,"comment_ctime":1603081947,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603081947","product_id":100028001,"comment_content":"è®¾è®¡æ¨¡å¼ é‡ç‚¹ä¸­çš„é‡ç‚¹","like_count":0},{"had_liked":false,"id":252835,"user_name":"å®‹å…µä¹™","can_delete":false,"product_type":"c1","uid":1213454,"ip_address":"","ucode":"400CF70EC70346","user_header":"https://static001.geekbang.org/account/avatar/00/12/84/0e/2d0ec13b.jpg","comment_is_top":false,"comment_ctime":1602497815,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1602497815","product_id":100028001,"comment_content":"æ— è®ºæ‡’æ±‰è¿˜æ˜¯é¥¿æ±‰ï¼Œæ„é€ æ–¹æ³•éƒ½æ˜¯privateï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡getInstanceæ–¹æ³•æ¥åšç±»çš„åˆå§‹åŒ–ï¼Œé‚£ä¹ˆæ‡’æ±‰å’Œé¥¿æ±‰çš„æœ¬è´¨éƒ½ä¸€æ ·äº†ï¼Œé¥¿æ±‰ä¹Ÿéœ€è¦ç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥æ–¹æ³•æ‰ä¼šåˆå§‹åŒ–ï¼Œå¹¶ä¸ä¼šâ€œäº‹å…ˆâ€å ç”¨å †å†…å­˜ã€‚ä¸çŸ¥é“ç†è§£çš„å¯¹ä¸ï¼Ÿ","like_count":0},{"had_liked":false,"id":237353,"user_name":"Gavin","can_delete":false,"product_type":"c1","uid":1616970,"ip_address":"","ucode":"A5735665E303FD","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/2UXuSevhia94o9Eky4OfMuSictaldxcqpjGuvRCOcvjIIoVBAENLEZbv2lgwmwC8icK1ZrUcneNtiaeFBV8MT3uzNg/132","comment_is_top":false,"comment_ctime":1595804795,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1595804795","product_id":100028001,"comment_content":"ç„¶è€Œï¼Œåœ¨ç±»æˆå‘˜å˜é‡æ¯”è¾ƒå¤šï¼Œæˆ–å˜é‡æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œè¿™ç§æ¨¡å¼å¯èƒ½ä¼šåœ¨æ²¡æœ‰ä½¿ç”¨ç±»å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œä¸€ç›´å ç”¨å †å†…å­˜ã€‚è¯•æƒ³ä¸‹ï¼Œå¦‚æœä¸€ä¸ªç¬¬ä¸‰æ–¹å¼€æºæ¡†æ¶ä¸­çš„ç±»éƒ½æ˜¯åŸºäºé¥¿æ±‰æ¨¡å¼å®ç°çš„å•ä¾‹ï¼Œè¿™å°†ä¼šåˆå§‹åŒ–æ‰€æœ‰å•ä¾‹ç±»ï¼Œæ— ç–‘æ˜¯ç¾éš¾æ€§çš„ã€‚<br><br>è€å¸ˆï¼Œç±»ä¸æ˜¯åœ¨ä½¿ç”¨æ—¶æ‰åŠ è½½çš„å—ï¼Ÿä¸ºä»€ä¹ˆæ–‡ä¸­è¯´ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¡†æ¶ä¼šåˆå§‹åŒ–æ‰€æœ‰å•ä¾‹ç±»ï¼Ÿ<br><br>æœŸå¾…è€å¸ˆçš„è§£ç­”","like_count":0},{"had_liked":false,"id":227185,"user_name":"è€¿å˜‰è‰º","can_delete":false,"product_type":"c1","uid":2023401,"ip_address":"","ucode":"727A22BD41E8AF","user_header":"","comment_is_top":false,"comment_ctime":1592308136,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592308136","product_id":100028001,"comment_content":"å¦‚æœå£°æ˜ä¸ºprivate final static Singleton singleton = new Singleton();ä¹Ÿå¯ä»¥è¿è¡ŒæˆåŠŸï¼Œè¿™ä¸ªæ˜¯å¦æ­£ç¡®ï¼Ÿ<br>è¿˜æœ‰æƒ³é—®ä¸‹ï¼Œè¿™ä¸ªå£°æ˜åŠ è½½é¡ºåºæ—¶æ€æ ·çš„ï¼Ÿ","like_count":0},{"had_liked":false,"id":219054,"user_name":"ç¨‹è‰¯","can_delete":false,"product_type":"c1","uid":1829158,"ip_address":"","ucode":"5C83059732EBCB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqjLWFD8dvRgM7lia8YLRH8YrOQtN6MCjLjcib7PnA9XAaRKJae1iaX9Ndqiakc62gu6hrViaxiacBELzibQ/132","comment_is_top":false,"comment_ctime":1589937746,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1589937746","product_id":100028001,"comment_content":"synchronized åŠ é”ä¹‹åï¼Œè™½ç„¶é‡æ’åºäº†ï¼Œåˆ°é”é‡Šæ”¾ä¸æ˜¯ä¹Ÿè¦ç­‰éƒ½æ‰§è¡Œå®Œäº†å—ï¼Ÿä¸ºä»€ä¹ˆè¿˜éœ€è¦åŠ volicateå…³é”®å­—å‘¢","like_count":0,"discussions":[{"author":{"id":1138821,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/85/f72f1d94.jpg","nickname":"ä¸è·¯åŒé£","note":"","ucode":"2985F1440A1962","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308097,"discussion_content":"Synchronizedé”å†…éƒ¨æ˜¯å¯ä»¥é‡æ’çš„ï¼ŒåŠ äº†volatileå°±æ˜¯é˜²æ­¢å¯¹instanceå­—æ®µæ“ä½œè¿›è¡Œé‡æ’åº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600845466,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1138821,"avatar":"https://static001.geekbang.org/account/avatar/00/11/60/85/f72f1d94.jpg","nickname":"ä¸è·¯åŒé£","note":"","ucode":"2985F1440A1962","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":308096,"discussion_content":"è¯´çš„å°±æ˜¯é”è¿˜æ²¡é‡Šæ”¾çš„æƒ…å†µï¼Œinstanceå·²ç»èµ‹å€¼ï¼Œä½†æ˜¯å¯¹è±¡è¿˜æ²¡æœ‰åˆå§‹åŒ–å¥½ã€‚åˆ«çš„çº¿ç¨‹è®¿é—®çš„æ—¶å€™ç¬¬ä¸€ä¸ªcheckåˆ¤æ–­instanceä¸ä¸ºç©ºï¼Œå°±è¿”å›äº†ä¸€ä¸ªæœªåˆå§‹åŒ–å¥½çš„å¯¹è±¡ï¼Œä¼šæœ‰é—®é¢˜çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1600845301,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199378,"user_name":"10å¹´ä»¥å","can_delete":false,"product_type":"c1","uid":1297421,"ip_address":"","ucode":"FE58CA7E5C2AF9","user_header":"https://static001.geekbang.org/account/avatar/00/13/cc/0d/89435926.jpg","comment_is_top":false,"comment_ctime":1585488008,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585488008","product_id":100028001,"comment_content":"å•ä¾‹æ¨¡å‹","like_count":0},{"had_liked":false,"id":186564,"user_name":"éšå¿ƒè€Œè‡³","can_delete":false,"product_type":"c1","uid":1097836,"ip_address":"","ucode":"31866865255101","user_header":"https://static001.geekbang.org/account/avatar/00/10/c0/6c/29be1864.jpg","comment_is_top":false,"comment_ctime":1583885168,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583885168","product_id":100028001,"comment_content":"å®ç°å•ä¾‹æ¨¡å¼ï¼Œå…³é”®æ˜¯å¦‚ä½•ä¿è¯æ­£ç¡®åœ°åªåˆ›å»ºä¸€æ¬¡ã€‚<br>1.åˆ©ç”¨JVMè‡ªèº«çš„å•çº¿ç¨‹ä¿è¯ã€‚staticå˜é‡åœ¨cinitä¸­åˆå§‹åŒ–ï¼Œæšä¸¾ç±»æˆå‘˜çš„åˆå§‹åŒ–<br>2.åˆ©ç”¨double check+é”+volatile","like_count":0},{"had_liked":false,"id":163616,"user_name":"æŸã€ î‰","can_delete":false,"product_type":"c1","uid":1221247,"ip_address":"","ucode":"44360946CCAC8A","user_header":"https://static001.geekbang.org/account/avatar/00/12/a2/7f/cf86eef9.jpg","comment_is_top":false,"comment_ctime":1576755884,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1576755884","product_id":100028001,"comment_content":"ç”¨CASçš„æ–¹å¼å®ç°å•ä¾‹æ¨¡å¼","like_count":0},{"had_liked":false,"id":133234,"user_name":"è¡Œåˆ™å°†è‡³","can_delete":false,"product_type":"c1","uid":1542987,"ip_address":"","ucode":"DB972F2DF059C4","user_header":"https://static001.geekbang.org/account/avatar/00/17/8b/4b/fa52d222.jpg","comment_is_top":false,"comment_ctime":1568455509,"is_pvip":false,"replies":[{"id":"51101","content":"å¯ä»¥å¿½ç•¥ï¼Œè¿™ä¸ªå±æ€§åœ¨è¿™é‡Œåªæ˜¯ç”¨ä½œé‡æ’åºçš„é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1568532388,"ip_address":"","comment_id":133234,"utype":1}],"discussion_count":1,"race_medal":1,"score":"1568455509","product_id":100028001,"comment_content":"è€å¸ˆï¼Œæ‚¨åœ¨å†…éƒ¨ç±»å®ç°å•ä¾‹çš„ä¾‹å­çš„ä¸­ã€‚åœ¨ç§æœ‰æ„é€ æ–¹æ³•ä¸­ï¼Œæ‰‹åŠ¨newäº†ä¸€ä¸ªArrayListé›†åˆã€‚åœ¨åé¢çš„æ–¹æ³•ä¸­å¹¶æ²¡æœ‰ä½¿ç”¨è¿™ä¸ªlistï¼Œè¿™ä¸ªlistå®ä¾‹æ˜¯å¹²å˜›ç”¨çš„","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467311,"discussion_content":"å¯ä»¥å¿½ç•¥ï¼Œè¿™ä¸ªå±æ€§åœ¨è¿™é‡Œåªæ˜¯ç”¨ä½œé‡æ’åºçš„é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568532388,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132810,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1568245235,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1568245235","product_id":100028001,"comment_content":"ä¸é”™ï¼Œä»¥ä¸ºè‡ªå·±æ‡‚äº†çš„ä¸œè¥¿ï¼Œå…¶å®æ·±æŒ–ä¹‹åå‘ç°è¿˜æœ‰è®¸å¤šè‡ªå·±ä»æœªæƒ³åˆ°çš„å®è´ã€‚<br>æ„Ÿè°¢ï¼Œè€å¸ˆåŠå…¶ä»–åŒå­¦çš„åˆ†äº«!<br>å†…éƒ¨ç±»å®ç°çš„æ‡’æ±‰æ¨¡å¼ï¼Œä»£ç ç®€å•æ€§èƒ½ä¼˜è¶Šä¹Ÿä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå€¼å¾—å°è¯•ã€‚","like_count":0},{"had_liked":false,"id":129944,"user_name":"å°”å†¬æ©™","can_delete":false,"product_type":"c1","uid":1225224,"ip_address":"","ucode":"0B013A49BC18DA","user_header":"https://static001.geekbang.org/account/avatar/00/12/b2/08/92f42622.jpg","comment_is_top":false,"comment_ctime":1567331966,"is_pvip":false,"replies":[{"id":"50246","content":"ä¸è¡Œï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯åŠ è½½æ—¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1567827788,"ip_address":"","comment_id":129944,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567331966","product_id":100028001,"comment_content":"è€å¸ˆï¼Œèµµé¥¿æ±‰æ¨¡å¼çš„å†™æ³•ï¼Œjava ä¸­staticå˜é‡å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ï¼Ÿä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥å‘¢","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465727,"discussion_content":"ä¸è¡Œï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯åŠ è½½æ—¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567827788,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":123117,"user_name":"è·¯è¥¿æ³•","can_delete":false,"product_type":"c1","uid":1078911,"ip_address":"","ucode":"63169B0823C12A","user_header":"https://static001.geekbang.org/account/avatar/00/10/76/7f/0ab2763d.jpg","comment_is_top":false,"comment_ctime":1565609019,"is_pvip":false,"replies":[{"id":"45277","content":"è¿™é‡Œçš„volatile æ˜¯ç”¨æ¥é˜²æ­¢é‡æ’åº","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1565659728,"ip_address":"","comment_id":123117,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1565609019","product_id":100028001,"comment_content":"&#47;&#47; æ‡’æ±‰æ¨¡å¼ + synchronized åŒæ­¥é” + double-check<br>public final class Singleton {<br>    private volatile static Singleton instance= null;&#47;&#47; ä¸å®ä¾‹åŒ–<br>    public List&lt;String&gt; list = null;&#47;&#47;list å±æ€§<br>    private Singleton(){<br>      list = new ArrayList&lt;String&gt;();<br>    }&#47;&#47; æ„é€ å‡½æ•°<br>    public static Singleton getInstance(){&#47;&#47; åŠ åŒæ­¥é”ï¼Œé€šè¿‡è¯¥å‡½æ•°å‘æ•´ä¸ªç³»ç»Ÿæä¾›å®ä¾‹<br>        if(null == instance){&#47;&#47; ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå½“ instance ä¸º null æ—¶ï¼Œåˆ™å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¦åˆ™ç›´æ¥è¿”å›å¯¹è±¡<br>          synchronized (Singleton.class){&#47;&#47; åŒæ­¥é”<br>             if(null == instance){&#47;&#47; ç¬¬äºŒæ¬¡åˆ¤æ–­<br>                instance = new Singleton();&#47;&#47; å®ä¾‹åŒ–å¯¹è±¡<br>             }<br>          } <br>        }<br>        return instance;&#47;&#47; è¿”å›å·²å­˜åœ¨çš„å¯¹è±¡<br>    }<br>}<br><br><br><br>è¿™é‡Œä¸éœ€è¦åŠ  volatile<br><br>synchronized éµå¾ª happens before åŸåˆ™ï¼Œå³ åœ¨ synchronized å—é‡Œçš„å†™ï¼Œå¯¹åç»­å…¶å®ƒçº¿ç¨‹çš„è¯»æ˜¯å¯è§çš„ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":462545,"discussion_content":"è¿™é‡Œçš„volatile æ˜¯ç”¨æ¥é˜²æ­¢é‡æ’åº","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565659728,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1142335,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6e/3f/49e5079f.jpg","nickname":"æ¥ä¼½å±±äºº","note":"","ucode":"5859C06DAC790D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":541956,"discussion_content":"æˆ‘ä¹Ÿæ˜¯è¿™ä¹ˆç†è§£ä¸éœ€è¦åŠ çš„ volatileï¼Œå¦‚æœè¦åŠ è¯´æ˜è€å¸ˆè¯´çš„ç¬¬3æ­¥ä¼šé‡æ’åˆ°synchronizedä¿®é¥°çš„ä»£ç å—å¤–é¢å» éº»çƒ¦è€å¸ˆè§£ç­”ä¸€ä¸‹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640613807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":462545,"ip_address":""},"score":541956,"extra":""}]}]},{"had_liked":false,"id":120527,"user_name":"è«è§‚ç”Ÿ","can_delete":false,"product_type":"c1","uid":1276562,"ip_address":"","ucode":"DD7BF63D387A98","user_header":"https://static001.geekbang.org/account/avatar/00/13/7a/92/f5339feb.jpg","comment_is_top":false,"comment_ctime":1564923650,"is_pvip":false,"replies":[{"id":"53046","content":"å³æ—¶ç¼–è¯‘å¹¶éè¿è¡Œå¤šæ¬¡ä»£ç æ‰ä¼šè§¦å‘ï¼Œjavaå°†å­—èŠ‚ç è½¬ä¸ºæœºå™¨ç æ—¶å°±æ˜¯å³æ—¶ç¼–è¯‘","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1569977783,"ip_address":"","comment_id":120527,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1564923650","product_id":100028001,"comment_content":"è¶…å“¥ï¼Œjvmè¦åœ¨ä»£ç è¢«æ‰§è¡Œä¸€å®šæ¬¡æ•°ä¹‹åæ‰ä¼šè§¦å‘å³æ—¶ç¼–è¯‘ï¼Œä¹Ÿå°±æ˜¯getInstanceæ–¹æ³•éœ€è¦è§¦å‘å¤šæ¬¡æ‰ä¼šè§¦å‘å³æ—¶ç¼–è¯‘å¯¼è‡´æŒ‡ä»¤é‡æ’ï¼Œä½†æ˜¯getInstanceè¢«æ‰§è¡Œä¸€æ¬¡åå•ä¾‹å¯¹è±¡å°±å·²ç»è¢«åˆå§‹åŒ–äº†ï¼Œç†è®ºä¸Šæ˜¯ä¸åº”è¯¥å‡ºç°æŒ‡ä»¤é‡æ’çš„é—®é¢˜ï¼Ÿæ±‚è§£æƒ‘","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":461373,"discussion_content":"å³æ—¶ç¼–è¯‘å¹¶éè¿è¡Œå¤šæ¬¡ä»£ç æ‰ä¼šè§¦å‘ï¼Œjavaå°†å­—èŠ‚ç è½¬ä¸ºæœºå™¨ç æ—¶å°±æ˜¯å³æ—¶ç¼–è¯‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569977783,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1412994,"avatar":"https://static001.geekbang.org/account/avatar/00/15/8f/82/374f43a1.jpg","nickname":"å‡è£…è‡ªå·±ä¸èƒ–","note":"","ucode":"308F1BAA96CDA5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5780,"discussion_content":"æŒ‡ä»¤é‡æ’ä¸ä¸€å®šè¦å³æ—¶ç¼–è¯‘æ‰èƒ½å¤Ÿè§¦å‘,è§£é‡Šå™¨ç¼–è¯‘ä¹Ÿèƒ½è§¦å‘å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566464082,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":119244,"user_name":"å‘æ¡æ©™å­ ã€‚","can_delete":false,"product_type":"c1","uid":1259218,"ip_address":"","ucode":"ED076F4534FFED","user_header":"https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg","comment_is_top":false,"comment_ctime":1564542577,"is_pvip":false,"replies":[{"id":"44487","content":"æ˜¯çš„","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1565056631,"ip_address":"","comment_id":119244,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1564542577","product_id":100028001,"comment_content":"è€å¸ˆ ï¼Œæœ€åå®ç°çš„æ‡’æ±‰æ¨¡å¼æœ‰ä¸€ä¸ªåœ°æ–¹ä¸å¤ªæ‡‚ã€‚ åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œå†…éƒ¨ç±»ä¸ä¼šè·Ÿç€ä¸€èµ·åŠ è½½ä¹ˆï¼Ÿ<br><br>æˆ‘ä¹‹å‰ä»¥ä¸ºä¼šå°†å†…éƒ¨ç±»ä¸€èµ·åŠ è½½ï¼Œå¼€è¾Ÿä¸€å—å†…å­˜ã€‚è¿™æ ·å…¶ä»–åœ°æ–¹å¼•ç”¨è¯¥å†…éƒ¨ç±»çš„æ—¶å€™æ‰å¯ä»¥åœ¨è§£æé˜¶æ®µæŠŠç¬¦å·å¼•ç”¨è½¬ä¸ºåœ°å€å¼•ç”¨ã€‚<br><br>ä½†æ˜¯çœ‹è€å¸ˆçš„ä¾‹å­ï¼Œåº”è¯¥æ˜¯åœ¨å¤–éƒ¨è°ƒç”¨å†…éƒ¨ç±»çš„æ—¶å€™æ‰çœŸæ­£å»åŠ è½½","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":460803,"discussion_content":"æ˜¯çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1565056631,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116768,"user_name":"WL","can_delete":false,"product_type":"c1","uid":1173771,"ip_address":"","ucode":"6277DCD776B87E","user_header":"https://static001.geekbang.org/account/avatar/00/11/e9/0b/1171ac71.jpg","comment_is_top":false,"comment_ctime":1563924151,"is_pvip":false,"replies":[{"id":"42703","content":"Springæ˜¯é€šè¿‡å®¹å™¨ç®¡ç†æ¥å®ç°å•ä¾‹çš„ï¼Œä¹Ÿæ˜¯åŸºäºè¿™ä¸‰ä¸ªåŸºæœ¬ç‚¹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563932207,"ip_address":"","comment_id":116768,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1563924151","product_id":100028001,"comment_content":"è€å¸ˆè¯·é—®æ‚¨è®²çš„å•ä¾‹æ¨¡å¼ä¸‰ä¸ªåŸºæœ¬è¦ç‚¹, ä½†æ˜¯æˆ‘ä½¿ç”¨springçš„æ¡†æ¶å¹¶é‡Œé¢é»˜è®¤çš„ç±»ä¸éƒ½æ˜¯å•ä¾‹çš„å—,ä½†æ˜¯å¹¶æ²¡æœ‰æ»¡è¶³æ‚¨è¯´çš„è¦ç‚¹, ç”¨tomcatä¹Ÿæ˜¯, tomcaté‡Œé¢çš„servletåº”è¯¥ä¹Ÿæ˜¯å•ä¾‹çš„å§, å¥½åƒä¹Ÿæ²¡æœ‰æ»¡è¶³æ‚¨è¯´çš„ä¸‰ä¸ªè¦ç‚¹, è¯·é—®springå’Œtomcatæ˜¯å’‹å®ç°çš„, æ˜¯æ•°æ®æ‡’æ±‰è¿˜æ˜¯é¥¿æ±‰çš„å®ç°æ–¹å¼.","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459677,"discussion_content":"Springæ˜¯é€šè¿‡å®¹å™¨ç®¡ç†æ¥å®ç°å•ä¾‹çš„ï¼Œä¹Ÿæ˜¯åŸºäºè¿™ä¸‰ä¸ªåŸºæœ¬ç‚¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563932207,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1937062,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/8e/a6/c3286b61.jpg","nickname":"Javaå’å¢™å·¥ç¨‹å¸ˆ","note":"","ucode":"E76AE44A9C76AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304012,"discussion_content":"springå’Œtomcat é‡Œé¢æ‰€è°“å•ä¾‹å’Œå¤šä¾‹æ˜¯åº”ç”¨ï¼Œä¸æ˜¯è®¾è®¡æ¨¡å¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599448568,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116763,"user_name":"colin","can_delete":false,"product_type":"c1","uid":1292206,"ip_address":"","ucode":"7A8849B8AE33E0","user_header":"https://static001.geekbang.org/account/avatar/00/13/b7/ae/a25fcb73.jpg","comment_is_top":false,"comment_ctime":1563921515,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563921515","product_id":100028001,"comment_content":"çœ‹è¯„è®ºæ¶¨çŸ¥è¯†","like_count":0},{"had_liked":false,"id":116576,"user_name":"ç å¾·çº½@å®","can_delete":false,"product_type":"c1","uid":1345546,"ip_address":"","ucode":"FA4088B0DD4EBB","user_header":"https://static001.geekbang.org/account/avatar/00/14/88/0a/31e6d5bb.jpg","comment_is_top":false,"comment_ctime":1563873859,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563873859","product_id":100028001,"comment_content":"æšä¸¾æ¨¡å¼ï¼Œä¹‹å¤–è¿˜æœ‰CASæ–¹å¼å•ä¾‹æ¨¡å¼","like_count":0},{"had_liked":false,"id":116455,"user_name":"OMT","can_delete":false,"product_type":"c1","uid":1084813,"ip_address":"","ucode":"7EC7311F4A55D9","user_header":"https://static001.geekbang.org/account/avatar/00/10/8d/8d/91e9afb0.jpg","comment_is_top":false,"comment_ctime":1563852257,"is_pvip":false,"replies":[{"id":"42696","content":"å¯¹çš„ï¼Œåœ¨ç¬¬9è®²ä¸­ï¼Œæˆ‘ä»¬çš„é—®ç­”é¢˜ä¹Ÿæ˜¯å…³äºæšä¸¾å®ç°å•ä¾‹æ¥è§£å†³åºåˆ—åŒ–é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"åˆ˜è¶…","uid":"1228576","ctime":1563931919,"ip_address":"","comment_id":116455,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1563852257","product_id":100028001,"comment_content":"çœ‹è¿‡å…¶ä»–æ–‡ç« æœ‰åˆ†æå•ä¾‹åå°„å’Œåºåˆ—åŒ–é—®é¢˜ã€‚<br>æšä¸¾å•ä¾‹å¯ä»¥åç¼–è¯‘æŸ¥çœ‹ã€‚","like_count":0,"discussions":[{"author":{"id":1228576,"avatar":"https://static001.geekbang.org/account/avatar/00/12/bf/20/19d42715.jpg","nickname":"åˆ˜è¶…","note":"","ucode":"CD56F93596E818","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":459547,"discussion_content":"å¯¹çš„ï¼Œåœ¨ç¬¬9è®²ä¸­ï¼Œæˆ‘ä»¬çš„é—®ç­”é¢˜ä¹Ÿæ˜¯å…³äºæšä¸¾å®ç°å•ä¾‹æ¥è§£å†³åºåˆ—åŒ–é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563931919,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":116360,"user_name":"DebugDog","can_delete":false,"product_type":"c1","uid":1027798,"ip_address":"","ucode":"1664D37CE03B9D","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/d6/fbb8236d.jpg","comment_is_top":false,"comment_ctime":1563843974,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1563843974","product_id":100028001,"comment_content":"æšä¸¾å•ä¾‹","like_count":0},{"had_liked":false,"id":116344,"user_name":"nightmare","can_delete":false,"product_type":"c1","uid":1056314,"ip_address":"","ucode":"EF2E51C2122A86","user_header":"https://static001.geekbang.org/account/avatar/00/10/1e/3a/5b21c01c.jpg","comment_is_top":false,"comment_ctime":1563842657,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1563842657","product_id":100028001,"comment_content":"666","like_count":0}]}