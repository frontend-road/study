{"id":295300,"title":"05 | ç‰¹å¾å¤„ç†ï¼šå¦‚ä½•åˆ©ç”¨Sparkè§£å†³ç‰¹å¾å¤„ç†é—®é¢˜ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç‹å–†ã€‚</p><p>ä¸ŠèŠ‚è¯¾ï¼Œæˆ‘ä»¬çŸ¥é“äº†æ¨èç³»ç»Ÿè¦ä½¿ç”¨çš„å¸¸ç”¨ç‰¹å¾æœ‰å“ªäº›ã€‚ä½†è¿™äº›åŸå§‹çš„ç‰¹å¾æ˜¯æ— æ³•ç›´æ¥æä¾›ç»™æ¨èæ¨¡å‹ä½¿ç”¨çš„ï¼Œå› ä¸ºæ¨èæ¨¡å‹æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¾“å‡ºéƒ½æ˜¯æ•°å­—æˆ–æ•°å€¼å‹çš„å‘é‡ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œ<span class=\"orange\">åƒåŠ¨ä½œã€å–œå‰§ã€çˆ±æƒ…ã€ç§‘å¹»è¿™äº›ç”µå½±é£æ ¼ï¼Œæ˜¯æ€ä¹ˆè½¬æ¢æˆæ•°å€¼ä¾›æ¨èæ¨¡å‹ä½¿ç”¨çš„å‘¢ï¼Ÿç”¨æˆ·çš„è¡Œä¸ºå†å²åˆæ˜¯æ€ä¹ˆè½¬æ¢æˆæ•°å€¼ç‰¹å¾çš„å‘¢ï¼Ÿ</span></p><p>è€Œä¸”ï¼Œç±»ä¼¼çš„ç‰¹å¾å¤„ç†è¿‡ç¨‹åœ¨æ•°æ®é‡å˜å¤§ä¹‹åè¿˜ä¼šå˜å¾—æ›´åŠ å¤æ‚ï¼Œå› ä¸ºå·¥ä¸šç•Œçš„æ•°æ®é›†å¾€å¾€éƒ½æ˜¯TBç”šè‡³PBè§„æ¨¡çš„ï¼Œè¿™åœ¨å•æœºä¸Šè‚¯å®šæ˜¯æ²¡æ³•å¤„ç†çš„ã€‚<span class=\"orange\">é‚£ä¸šç•Œåˆæ˜¯æ€æ ·è¿›è¡Œæµ·é‡æ•°æ®çš„ç‰¹å¾å¤„ç†å‘¢ï¼Ÿ</span>è¿™èŠ‚è¯¾ï¼Œæˆ‘å°±å¸¦ä½ ä¸€èµ·æ¥è§£å†³è¿™å‡ ä¸ªé—®é¢˜ã€‚</p><h2>ä¸šç•Œä¸»æµçš„å¤§æ•°æ®å¤„ç†åˆ©å™¨ï¼šSpark</h2><p>æ—¢ç„¶è¦å¤„ç†æµ·é‡æ•°æ®ï¼Œé‚£é€‰æ‹©å“ªä¸ªæ•°æ®å¤„ç†å¹³å°å°±æ˜¯æˆ‘ä»¬é¦–å…ˆè¦è§£å†³çš„é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬éšæœºé‡‡è®¿å‡ ä½æ¨èç³»ç»Ÿé¢†åŸŸçš„ç¨‹åºå‘˜ï¼Œé—®ä»–ä»¬åœ¨å…¬å¸ç”¨ä»€ä¹ˆå¹³å°å¤„ç†å¤§æ•°æ®ï¼Œæˆ‘æƒ³æœ€å°‘æœ‰ä¸€åŠä»¥ä¸Šä¼šå›ç­”æ˜¯Sparkã€‚ä½œä¸ºä¸šç•Œä¸»æµçš„å¤§æ•°æ®å¤„ç†åˆ©å™¨ï¼ŒSparkçš„åœ°ä½æ¯‹åº¸ç½®ç–‘ã€‚æ‰€ä»¥ï¼Œä»Šå¤©æˆ‘å…ˆå¸¦ä½ äº†è§£ä¸€ä¸‹Sparkçš„ç‰¹ç‚¹ï¼Œå†ä¸€èµ·æ¥çœ‹æ€ä¹ˆç”¨Sparkå¤„ç†æ¨èç³»ç»Ÿçš„ç‰¹å¾ã€‚</p><p>Sparkæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è®¡ç®—å¹³å°ã€‚æ‰€è°“åˆ†å¸ƒå¼ï¼ŒæŒ‡çš„æ˜¯è®¡ç®—èŠ‚ç‚¹ä¹‹é—´ä¸å…±äº«å†…å­˜ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œé€šä¿¡çš„æ–¹å¼äº¤æ¢æ•°æ®ã€‚Sparkæœ€å…¸å‹çš„åº”ç”¨æ–¹å¼å°±æ˜¯å»ºç«‹åœ¨å¤§é‡å»‰ä»·çš„è®¡ç®—èŠ‚ç‚¹ä¸Šï¼Œè¿™äº›èŠ‚ç‚¹å¯ä»¥æ˜¯å»‰ä»·ä¸»æœºï¼Œä¹Ÿå¯ä»¥æ˜¯è™šæ‹Ÿçš„Docker Containerï¼ˆDockerå®¹å™¨ï¼‰ã€‚</p><!-- [[[read_end]]] --><p>ç†è§£äº†Sparkçš„åŸºæœ¬æ¦‚å¿µï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å®ƒçš„æ¶æ„ã€‚ä»ä¸‹é¢Sparkçš„æ¶æ„å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒSparkç¨‹åºç”±Manager Nodeï¼ˆç®¡ç†èŠ‚ç‚¹ï¼‰è¿›è¡Œè°ƒåº¦ç»„ç»‡ï¼Œç”±Worker Nodeï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰è¿›è¡Œå…·ä½“çš„è®¡ç®—ä»»åŠ¡æ‰§è¡Œï¼Œæœ€ç»ˆå°†ç»“æœè¿”å›ç»™Drive Programï¼ˆé©±åŠ¨ç¨‹åºï¼‰ã€‚åœ¨ç‰©ç†çš„Worker Nodeä¸Šï¼Œæ•°æ®è¿˜ä¼šåˆ†ä¸ºä¸åŒçš„partitionï¼ˆæ•°æ®åˆ†ç‰‡ï¼‰ï¼Œå¯ä»¥è¯´partitionæ˜¯Sparkçš„åŸºç¡€æ•°æ®å•å…ƒã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/4a/9b/4ae1153e4daee39985c357ed796eca9b.jpeg?wh=796*404\" alt=\"\" title=\"å›¾1 Sparkæ¶æ„å›¾\"></p><p>Sparkè®¡ç®—é›†ç¾¤èƒ½å¤Ÿæ¯”ä¼ ç»Ÿçš„å•æœºé«˜æ€§èƒ½æœåŠ¡å™¨å…·å¤‡æ›´å¼ºå¤§çš„è®¡ç®—èƒ½åŠ›ï¼Œå°±æ˜¯ç”±è¿™äº›æˆç™¾ä¸Šåƒï¼Œç”šè‡³è¾¾åˆ°ä¸‡ä»¥ä¸Šè§„æ¨¡çš„å·¥ä½œèŠ‚ç‚¹å¹¶è¡Œå·¥ä½œå¸¦æ¥çš„ã€‚</p><p>é‚£åœ¨æ‰§è¡Œä¸€ä¸ªå…·ä½“ä»»åŠ¡çš„æ—¶å€™ï¼Œ<strong>Sparkæ˜¯æ€ä¹ˆååŒè¿™ä¹ˆå¤šçš„å·¥ä½œèŠ‚ç‚¹ï¼Œé€šè¿‡å¹¶è¡Œè®¡ç®—å¾—å‡ºæœ€ç»ˆçš„ç»“æœå‘¢ï¼Ÿ</strong>è¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªä»»åŠ¡æ¥è§£é‡Šä¸€ä¸‹Sparkçš„å·¥ä½œè¿‡ç¨‹ã€‚</p><p>è¿™ä¸ªä»»åŠ¡å¹¶ä¸å¤æ‚ï¼Œæˆ‘ä»¬éœ€è¦å…ˆä»æœ¬åœ°ç¡¬ç›˜è¯»å–æ–‡ä»¶textFileï¼Œå†ä»åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»ŸHDFSè¯»å–æ–‡ä»¶hadoopFileï¼Œç„¶ååˆ†åˆ«å¯¹å®ƒä»¬è¿›è¡Œå¤„ç†ï¼Œå†æŠŠä¸¤ä¸ªæ–‡ä»¶æŒ‰ç…§IDéƒ½joinèµ·æ¥å¾—åˆ°æœ€ç»ˆçš„ç»“æœã€‚</p><p>è¿™é‡Œä½ æ²¡å¿…è¦æ‰§ç€äºä»»åŠ¡çš„ç»†èŠ‚ï¼Œåªè¦æ¸…æ¥šä»»åŠ¡çš„å¤§è‡´æµç¨‹å°±å¥½ã€‚åœ¨Sparkå¹³å°ä¸Šå¤„ç†è¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œä¼šå°†è¿™ä¸ªä»»åŠ¡æ‹†è§£æˆä¸€ä¸ªå­ä»»åŠ¡DAGï¼ˆDirected Acyclic Graphï¼Œæœ‰å‘æ— ç¯å›¾ï¼‰ï¼Œå†æ ¹æ®DAGå†³å®šç¨‹åºå„æ­¥éª¤æ‰§è¡Œçš„æ–¹æ³•ã€‚ä»å›¾2ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªSparkç¨‹åºåˆ†åˆ«ä»textFileå’ŒhadoopFileè¯»å–æ–‡ä»¶ï¼Œå†ç»è¿‡ä¸€ç³»åˆ—mapã€filterç­‰æ“ä½œåè¿›è¡Œjoinï¼Œæœ€ç»ˆå¾—åˆ°äº†å¤„ç†ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/01/fd/01524cdf0ff7f64bcf86c656dd5470fd.jpeg?wh=960*316\" alt=\"\" title=\"å›¾2 æŸSparkç¨‹åºçš„ä»»åŠ¡æœ‰å‘æ— ç¯å›¾\"></p><p>å…¶ä¸­ï¼Œæœ€å…³é”®çš„è¿‡ç¨‹æ˜¯æˆ‘ä»¬è¦ç†è§£å“ªäº›æ˜¯å¯ä»¥çº¯å¹¶è¡Œå¤„ç†çš„éƒ¨åˆ†ï¼Œå“ªäº›æ˜¯å¿…é¡»shuffleï¼ˆæ··æ´—ï¼‰å’Œreduceçš„éƒ¨åˆ†ã€‚</p><p>è¿™é‡Œçš„shuffleæŒ‡çš„æ˜¯æ‰€æœ‰partitionçš„æ•°æ®å¿…é¡»è¿›è¡Œæ´—ç‰Œåæ‰èƒ½å¾—åˆ°ä¸‹ä¸€æ­¥çš„æ•°æ®ï¼Œæœ€å…¸å‹çš„æ“ä½œå°±æ˜¯å›¾2ä¸­çš„groupByKeyæ“ä½œå’Œjoinæ“ä½œã€‚ä»¥joinæ“ä½œä¸ºä¾‹ï¼Œæˆ‘ä»¬å¿…é¡»å¯¹textFileæ•°æ®å’ŒhadoopFileæ•°æ®åšå…¨é‡çš„åŒ¹é…æ‰å¯ä»¥å¾—åˆ°joinåçš„dataframeï¼ˆSparkä¿å­˜æ•°æ®çš„ç»“æ„ï¼‰ã€‚è€ŒgroupByKeyæ“ä½œåˆ™éœ€è¦å¯¹æ•°æ®ä¸­æ‰€æœ‰ç›¸åŒçš„keyè¿›è¡Œåˆå¹¶ï¼Œä¹Ÿéœ€è¦å…¨å±€çš„shuffleæ‰èƒ½å®Œæˆã€‚</p><p>ä¸ä¹‹ç›¸æ¯”ï¼Œmapã€filterç­‰æ“ä½œä»…éœ€è¦é€æ¡åœ°è¿›è¡Œæ•°æ®å¤„ç†å’Œè½¬æ¢ï¼Œä¸éœ€è¦è¿›è¡Œæ•°æ®é—´çš„æ“ä½œï¼Œå› æ­¤å„partitionä¹‹é—´å¯ä»¥å®Œå…¨å¹¶è¡Œå¤„ç†ã€‚</p><p>æ­¤å¤–ï¼Œåœ¨å¾—åˆ°æœ€ç»ˆçš„è®¡ç®—ç»“æœä¹‹å‰ï¼Œç¨‹åºéœ€è¦è¿›è¡Œreduceçš„æ“ä½œï¼Œä»å„partitionä¸Šæ±‡æ€»ç»Ÿè®¡ç»“æœï¼Œéšç€partitionçš„æ•°é‡é€æ¸å‡å°ï¼Œreduceæ“ä½œçš„å¹¶è¡Œç¨‹åº¦é€æ¸é™ä½ï¼Œç›´åˆ°å°†æœ€ç»ˆçš„è®¡ç®—ç»“æœæ±‡æ€»åˆ°masterèŠ‚ç‚¹ï¼ˆä¸»èŠ‚ç‚¹ï¼‰ä¸Šã€‚å¯ä»¥è¯´ï¼Œshuffleå’Œreduceæ“ä½œçš„è§¦å‘å†³å®šäº†çº¯å¹¶è¡Œå¤„ç†é˜¶æ®µçš„è¾¹ç•Œã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/6e/13/6e50b4010c27fac81acb0b230516e113.jpeg?wh=960*355\" alt=\"\" title=\"å›¾3 è¢«shuffleæ“ä½œåˆ†å‰²çš„DAG stages\"></p><p>æœ€åï¼Œæˆ‘è¿˜æƒ³å¼ºè°ƒçš„æ˜¯ï¼Œshuffleæ“ä½œéœ€è¦åœ¨ä¸åŒè®¡ç®—èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œéå¸¸æ¶ˆè€—è®¡ç®—ã€é€šä¿¡åŠå­˜å‚¨èµ„æºï¼Œå› æ­¤shuffleæ“ä½œæ˜¯sparkç¨‹åºåº”è¯¥å°½é‡é¿å…çš„ã€‚</p><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œè¿™é‡Œæˆ‘ä»¬å†ç”¨ä¸€å¥è¯æ€»ç»“Sparkçš„è®¡ç®—è¿‡ç¨‹ï¼š<strong>Stageå†…éƒ¨æ•°æ®é«˜æ•ˆå¹¶è¡Œè®¡ç®—ï¼ŒStageè¾¹ç•Œå¤„è¿›è¡Œæ¶ˆè€—èµ„æºçš„shuffleæ“ä½œæˆ–è€…æœ€ç»ˆçš„reduceæ“ä½œ</strong>ã€‚</p><p>æ¸…æ¥šäº†Sparkçš„åŸç†ï¼Œç›¸ä¿¡ä½ å·²ç»æ‘©æ‹³æ“¦æŒæœŸå¾…å°†Sparkåº”ç”¨åœ¨æ¨èç³»ç»Ÿçš„ç‰¹å¾å¤„ç†ä¸Šäº†ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å°±è¿›å…¥å®æˆ˜é˜¶æ®µï¼Œç”¨Sparkå¤„ç†æˆ‘ä»¬çš„Sparrow Recsysé¡¹ç›®çš„æ•°æ®é›†ã€‚åœ¨å¼€å§‹å­¦ä¹ ä¹‹å‰ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½å¸¦ç€2ä¸ªé—®é¢˜ï¼Œè¾¹å­¦è¾¹æ€è€ƒï¼š  ç»å…¸çš„ç‰¹å¾å¤„ç†æ–¹æ³•æœ‰ä»€ä¹ˆï¼ŸSparkæ˜¯å¦‚ä½•å®ç°è¿™äº›ç‰¹å¾å¤„ç†æ–¹æ³•çš„ï¼Ÿ</p><h2>å¦‚ä½•åˆ©ç”¨One-hotç¼–ç å¤„ç†ç±»åˆ«å‹ç‰¹å¾</h2><p>å¹¿ä¹‰ä¸Šæ¥è®²ï¼Œæ‰€æœ‰çš„ç‰¹å¾éƒ½å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ã€‚ç¬¬ä¸€ç±»æ˜¯<strong>ç±»åˆ«ã€IDå‹ç‰¹å¾ï¼ˆä»¥ä¸‹ç®€ç§°ç±»åˆ«å‹ç‰¹å¾ï¼‰</strong>ã€‚æ‹¿ç”µå½±æ¨èæ¥è¯´ï¼Œç”µå½±çš„é£æ ¼ã€IDã€æ ‡ç­¾ã€å¯¼æ¼”æ¼”å‘˜ç­‰ä¿¡æ¯ï¼Œç”¨æˆ·çœ‹è¿‡çš„ç”µå½±IDã€ç”¨æˆ·çš„æ€§åˆ«ã€åœ°ç†ä½ç½®ä¿¡æ¯ã€å½“å‰çš„å­£èŠ‚ã€æ—¶é—´ï¼ˆä¸Šåˆï¼Œä¸‹åˆï¼Œæ™šä¸Šï¼‰ã€å¤©æ°”ç­‰ç­‰ï¼Œè¿™äº›æ— æ³•ç”¨æ•°å­—è¡¨ç¤ºçš„ä¿¡æ¯å…¨éƒ½å¯ä»¥è¢«çœ‹ä½œæ˜¯ç±»åˆ«ã€IDç±»ç‰¹å¾ã€‚ç¬¬äºŒç±»æ˜¯<strong>æ•°å€¼å‹ç‰¹å¾</strong>ï¼Œèƒ½ç”¨æ•°å­—ç›´æ¥è¡¨ç¤ºçš„ç‰¹å¾å°±æ˜¯æ•°å€¼å‹ç‰¹å¾ï¼Œå…¸å‹çš„åŒ…æ‹¬ç”¨æˆ·çš„å¹´é¾„ã€æ”¶å…¥ã€ç”µå½±çš„æ’­æ”¾æ—¶é•¿ã€ç‚¹å‡»é‡ã€ç‚¹å‡»ç‡ç­‰ã€‚</p><p>æˆ‘ä»¬è¿›è¡Œç‰¹å¾å¤„ç†çš„ç›®çš„ï¼Œæ˜¯æŠŠæ‰€æœ‰çš„ç‰¹å¾å…¨éƒ¨è½¬æ¢æˆä¸€ä¸ªæ•°å€¼å‹çš„ç‰¹å¾å‘é‡ï¼Œå¯¹äºæ•°å€¼å‹ç‰¹å¾ï¼Œè¿™ä¸ªè¿‡ç¨‹éå¸¸ç®€å•ï¼Œç›´æ¥æŠŠè¿™ä¸ªæ•°å€¼æ”¾åˆ°ç‰¹å¾å‘é‡ä¸Šç›¸åº”çš„ç»´åº¦ä¸Šå°±å¯ä»¥äº†ã€‚ä½†æ˜¯å¯¹äºç±»åˆ«ã€IDç±»ç‰¹å¾ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå¤„ç†å®ƒä»¬å‘¢ï¼Ÿ</p><p>è¿™é‡Œæˆ‘ä»¬å°±è¦ç”¨åˆ°One-hotç¼–ç ï¼ˆä¹Ÿè¢«ç§°ä¸ºç‹¬çƒ­ç¼–ç ï¼‰ï¼Œå®ƒæ˜¯å°†ç±»åˆ«ã€IDå‹ç‰¹å¾è½¬æ¢æˆæ•°å€¼å‘é‡çš„ä¸€ç§æœ€å…¸å‹çš„ç¼–ç æ–¹å¼ã€‚å®ƒé€šè¿‡æŠŠæ‰€æœ‰å…¶ä»–ç»´åº¦ç½®ä¸º0ï¼Œå•ç‹¬å°†å½“å‰ç±»åˆ«æˆ–è€…IDå¯¹åº”çš„ç»´åº¦ç½®ä¸º1çš„æ–¹å¼ç”Ÿæˆç‰¹å¾å‘é‡ã€‚è¿™æ€ä¹ˆç†è§£å‘¢ï¼Ÿæˆ‘ä»¬ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾æŸæ ·æœ¬æœ‰ä¸‰ä¸ªç‰¹å¾ï¼Œåˆ†åˆ«æ˜¯æ˜ŸæœŸã€æ€§åˆ«å’ŒåŸå¸‚ï¼Œæˆ‘ä»¬ç”¨ [Weekday=Tuesday, Gender=Male, City=London] æ¥è¡¨ç¤ºï¼Œç”¨One-hotç¼–ç å¯¹å…¶è¿›è¡Œæ•°å€¼åŒ–çš„ç»“æœã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/94/15/94f78685d98671648638e330a461ab15.jpeg?wh=960*247\" alt=\"\" title=\"å›¾4 One-hotç¼–ç ç‰¹å¾å‘é‡\"></p><p>ä»å›¾4ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒWeekdayè¿™ä¸ªç‰¹å¾åŸŸæœ‰7ä¸ªç»´åº¦ï¼ŒTuesdayå¯¹åº”ç¬¬2ä¸ªç»´åº¦ï¼Œæ‰€ä»¥æˆ‘æŠŠå¯¹åº”ç»´åº¦ç½®ä¸º1ã€‚è€ŒGenderåˆ†ä¸ºMaleå’ŒFemaleï¼Œæ‰€ä»¥å¯¹åº”çš„One-hotç¼–ç å°±æœ‰ä¸¤ä¸ªç»´åº¦ï¼ŒCityç‰¹å¾åŸŸåŒç†ã€‚</p><p>é™¤äº†è¿™äº›ç±»åˆ«å‹ç‰¹å¾å¤–ï¼ŒIDå‹ç‰¹å¾ä¹Ÿç»å¸¸ä½¿ç”¨One-hotç¼–ç ã€‚æ¯”å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„SparrowRecsysä¸­ï¼Œç”¨æˆ·Uè§‚çœ‹è¿‡ç”µå½±Mï¼Œè¿™ä¸ªè¡Œä¸ºæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç”¨æˆ·ç‰¹å¾ï¼Œé‚£æˆ‘ä»¬åº”è¯¥å¦‚ä½•å‘é‡åŒ–è¿™ä¸ªè¡Œä¸ºå‘¢ï¼Ÿå…¶å®ä¹Ÿæ˜¯ä½¿ç”¨One-hotç¼–ç ã€‚å‡è®¾ï¼Œæˆ‘ä»¬çš„ç”µå½±åº“ä¸­ä¸€å…±æœ‰1000éƒ¨ç”µå½±ï¼Œç”µå½±Mçš„IDæ˜¯310ï¼ˆç¼–å·ä»0å¼€å§‹ï¼‰ï¼Œé‚£è¿™ä¸ªè¡Œä¸ºå°±å¯ä»¥ç”¨ä¸€ä¸ª1000ç»´çš„å‘é‡æ¥è¡¨ç¤ºï¼Œè®©ç¬¬310ç»´çš„å…ƒç´ ä¸º1ï¼Œå…¶ä»–å…ƒç´ éƒ½ä¸º0ã€‚</p><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°±çœ‹çœ‹SparrowRecsysæ˜¯å¦‚ä½•åˆ©ç”¨Sparkå®Œæˆè¿™ä¸€è¿‡ç¨‹çš„ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨Sparkçš„æœºå™¨å­¦ä¹ åº“MLlibæ¥å®ŒæˆOne-hotç‰¹å¾çš„å¤„ç†ã€‚</p><p>å…¶ä¸­ï¼Œæœ€ä¸»è¦çš„æ­¥éª¤æ˜¯ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªè´Ÿè´£One-hotç¼–ç çš„è½¬æ¢å™¨ï¼ŒOneHotEncoderEstimatorï¼Œç„¶åé€šè¿‡å®ƒçš„fitå‡½æ•°å®ŒæˆæŒ‡å®šç‰¹å¾çš„é¢„å¤„ç†ï¼Œå¹¶åˆ©ç”¨transformå‡½æ•°å°†åŸå§‹ç‰¹å¾è½¬æ¢æˆOne-hotç‰¹å¾ã€‚å®ç°æ€è·¯å¤§ä½“ä¸Šå°±æ˜¯è¿™æ ·ï¼Œå…·ä½“çš„æ­¥éª¤ä½ å¯ä»¥å‚è€ƒæˆ‘ä¸‹é¢ç»™å‡ºçš„æºç ï¼š</p><pre><code>def oneHotEncoderExample(samples:DataFrame): Unit ={\n  //samplesæ ·æœ¬é›†ä¸­çš„æ¯ä¸€æ¡æ•°æ®ä»£è¡¨ä¸€éƒ¨ç”µå½±çš„ä¿¡æ¯ï¼Œå…¶ä¸­movieIdä¸ºç”µå½±id\n  val samplesWithIdNumber = samples.withColumn(&quot;movieIdNumber&quot;, col(&quot;movieId&quot;).cast(sql.types.IntegerType))\n\n\n  //åˆ©ç”¨Sparkçš„æœºå™¨å­¦ä¹ åº“Spark MLlibåˆ›å»ºOne-hotç¼–ç å™¨\n  val oneHotEncoder = new OneHotEncoderEstimator()\n    .setInputCols(Array(&quot;movieIdNumber&quot;))\n    .setOutputCols(Array(&quot;movieIdVector&quot;))\n    .setDropLast(false)\n\n\n  //è®­ç»ƒOne-hotç¼–ç å™¨ï¼Œå¹¶å®Œæˆä»idç‰¹å¾åˆ°One-hotå‘é‡çš„è½¬æ¢\n  val oneHotEncoderSamples =      oneHotEncoder.fit(samplesWithIdNumber).transform(samplesWithIdNumber)\n  //æ‰“å°æœ€ç»ˆæ ·æœ¬çš„æ•°æ®ç»“æ„\n  oneHotEncoderSamples.printSchema()\n  //æ‰“å°10æ¡æ ·æœ¬æŸ¥çœ‹ç»“æœ\n  oneHotEncoderSamples.show(10)\n\n_ï¼ˆå‚è€ƒ com.wzhe.sparrowrecsys.offline.spark.featureeng.FeatureEngineering__ä¸­çš„oneHotEncoderExampleå‡½æ•°ï¼‰_\n</code></pre><p>One-hotç¼–ç ä¹Ÿå¯ä»¥è‡ªç„¶è¡ç”ŸæˆMulti-hotç¼–ç ï¼ˆå¤šçƒ­ç¼–ç ï¼‰ã€‚æ¯”å¦‚ï¼Œå¯¹äºå†å²è¡Œä¸ºåºåˆ—ç±»ã€æ ‡ç­¾ç‰¹å¾ç­‰æ•°æ®æ¥è¯´ï¼Œç”¨æˆ·å¾€å¾€ä¼šä¸å¤šä¸ªç‰©å“äº§ç”Ÿäº¤äº’è¡Œä¸ºï¼Œæˆ–è€…ä¸€ä¸ªç‰©å“è¢«æ‰“ä¸Šå¤šä¸ªæ ‡ç­¾ï¼Œè¿™æ—¶æœ€å¸¸ç”¨çš„ç‰¹å¾å‘é‡ç”Ÿæˆæ–¹å¼å°±æ˜¯æŠŠå…¶è½¬æ¢æˆMulti-hotç¼–ç ã€‚åœ¨SparrowRecsysä¸­ï¼Œå› ä¸ºæ¯ä¸ªç”µå½±éƒ½æ˜¯æœ‰å¤šä¸ªGenreï¼ˆé£æ ¼ï¼‰ç±»åˆ«çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç”¨Multi-hotç¼–ç å®Œæˆæ ‡ç­¾åˆ°å‘é‡çš„è½¬æ¢ã€‚ä½ å¯ä»¥è‡ªå·±å°è¯•ç€ç”¨Sparkå®ç°è¯¥è¿‡ç¨‹ï¼Œä¹Ÿå¯ä»¥å‚è€ƒSparrowRecsysé¡¹ç›®ä¸­ multiHotEncoderExampleçš„å®ç°ï¼Œæˆ‘å°±ä¸å¤šè¯´å•¦ã€‚</p><h2>æ•°å€¼å‹ç‰¹å¾çš„å¤„ç†-å½’ä¸€åŒ–å’Œåˆ†æ¡¶</h2><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å†å¥½å¥½èŠä¸€èŠæ•°å€¼å‹ç‰¹å¾çš„å¤„ç†ã€‚ä½ å¯èƒ½ä¼šé—®äº†ï¼Œæ•°å€¼å‹ç‰¹å¾æœ¬èº«ä¸å°±æ˜¯æ•°å­—å—ï¼Ÿç›´æ¥æ”¾å…¥ç‰¹å¾å‘é‡ä¸å°±å¥½äº†ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å¤„ç†å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬ä¸»è¦è®¨è®ºä¸¤æ–¹é¢é—®é¢˜ï¼Œä¸€æ˜¯ç‰¹å¾çš„å°ºåº¦ï¼ŒäºŒæ˜¯ç‰¹å¾çš„åˆ†å¸ƒã€‚</p><p>ç‰¹å¾çš„å°ºåº¦é—®é¢˜ä¸éš¾ç†è§£ï¼Œæ¯”å¦‚åœ¨ç”µå½±æ¨èä¸­æœ‰ä¸¤ä¸ªç‰¹å¾ï¼Œä¸€ä¸ªæ˜¯ç”µå½±çš„è¯„ä»·æ¬¡æ•°frï¼Œä¸€ä¸ªæ˜¯ç”µå½±çš„å¹³å‡è¯„åˆ†fsã€‚è¯„ä»·æ¬¡æ•°å…¶å®æ˜¯ä¸€ä¸ªæ•°å€¼æ— ä¸Šé™çš„ç‰¹å¾ï¼Œåœ¨SparrowRecsysæ‰€ç”¨MovieLensæ•°æ®é›†ä¸Šï¼Œfr çš„èŒƒå›´ä¸€èˆ¬åœ¨[0,10000]ä¹‹é—´ã€‚å¯¹äºç”µå½±çš„å¹³å‡è¯„åˆ†æ¥è¯´ï¼Œå› ä¸ºæˆ‘ä»¬é‡‡ç”¨äº†5åˆ†ä¸ºæ»¡åˆ†çš„è¯„åˆ†ï¼Œæ‰€ä»¥ç‰¹å¾fsçš„å–å€¼èŒƒå›´åœ¨[0,5]ä¹‹é—´ã€‚</p><p>ç”±äºfrå’Œfs ä¸¤ä¸ªç‰¹å¾çš„å°ºåº¦å·®è·å¤ªå¤§ï¼Œå¦‚æœæˆ‘ä»¬æŠŠç‰¹å¾çš„åŸå§‹æ•°å€¼ç›´æ¥è¾“å…¥æ¨èæ¨¡å‹ï¼Œå°±ä¼šå¯¼è‡´è¿™ä¸¤ä¸ªç‰¹å¾å¯¹äºæ¨¡å‹çš„å½±å“ç¨‹åº¦æœ‰æ˜¾è‘—çš„åŒºåˆ«ã€‚å¦‚æœæ¨¡å‹ä¸­æœªåšç‰¹æ®Šå¤„ç†çš„è¯ï¼Œfrè¿™ä¸ªç‰¹å¾ç”±äºæ³¢åŠ¨èŒƒå›´é«˜å‡ºfså‡ ä¸ªé‡çº§ï¼Œå¯èƒ½ä¼šå®Œå…¨æ©ç›–fsä½œç”¨ï¼Œè¿™å½“ç„¶æ˜¯æˆ‘ä»¬ä¸æ„¿æ„çœ‹åˆ°çš„ã€‚ä¸ºæ­¤æˆ‘ä»¬å¸Œæœ›æŠŠä¸¤ä¸ªç‰¹å¾çš„å°ºåº¦æ‹‰å¹³åˆ°ä¸€ä¸ªåŒºåŸŸå†…ï¼Œé€šå¸¸æ˜¯[0,1]èŒƒå›´ï¼Œè¿™å°±æ˜¯æ‰€è°“<strong>å½’ä¸€åŒ–</strong>ã€‚</p><p>å½’ä¸€åŒ–è™½ç„¶èƒ½å¤Ÿè§£å†³ç‰¹å¾å–å€¼èŒƒå›´ä¸ç»Ÿä¸€çš„é—®é¢˜ï¼Œä½†æ— æ³•æ”¹å˜ç‰¹å¾å€¼çš„åˆ†å¸ƒã€‚æ¯”å¦‚å›¾5å°±æ˜¾ç¤ºäº†Sparrow Recsysä¸­ç¼–å·åœ¨å‰1000çš„ç”µå½±å¹³å‡è¯„åˆ†åˆ†å¸ƒã€‚ä½ å¯ä»¥å¾ˆæ˜æ˜¾åœ°çœ‹åˆ°ï¼Œç”±äºäººä»¬æ‰“åˆ†æœ‰â€œä¸­åº¸åä¸Šâ€çš„å€¾å‘ï¼Œå› æ­¤è¯„åˆ†å¤§é‡é›†ä¸­åœ¨3.5çš„é™„è¿‘ï¼Œè€Œä¸”è¶Šé è¿‘3.5çš„å¯†åº¦è¶Šå¤§ã€‚è¿™å¯¹äºæ¨¡å‹å­¦ä¹ æ¥è¯´ä¹Ÿä¸æ˜¯ä¸€ä¸ªå¥½çš„ç°è±¡ï¼Œå› ä¸ºç‰¹å¾çš„åŒºåˆ†åº¦å¹¶ä¸é«˜ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/56/4e/5675f0777bd9275b5cdd8aa166cebd4e.jpeg?wh=960*540\" alt=\"\" title=\"å›¾5 ç”µå½±çš„å¹³å‡è¯„åˆ†åˆ†å¸ƒ\"></p><p>è¿™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ†æ¡¶çš„æ–¹å¼æ¥è§£å†³ç‰¹å¾å€¼åˆ†å¸ƒæä¸å‡åŒ€çš„é—®é¢˜ã€‚æ‰€è°“â€œåˆ†æ¡¶ï¼ˆBucketingï¼‰â€ï¼Œå°±æ˜¯å°†æ ·æœ¬æŒ‰ç…§æŸç‰¹å¾çš„å€¼ä»é«˜åˆ°ä½æ’åºï¼Œç„¶åæŒ‰ç…§æ¡¶çš„æ•°é‡æ‰¾åˆ°åˆ†ä½æ•°ï¼Œå°†æ ·æœ¬åˆ†åˆ°å„è‡ªçš„æ¡¶ä¸­ï¼Œå†ç”¨æ¡¶IDä½œä¸ºç‰¹å¾å€¼ã€‚</p><p>åœ¨Spark MLlibä¸­ï¼Œåˆ†åˆ«æä¾›äº†ä¸¤ä¸ªè½¬æ¢å™¨MinMaxScalerå’ŒQuantileDiscretizerï¼Œæ¥è¿›è¡Œå½’ä¸€åŒ–å’Œåˆ†æ¡¶çš„ç‰¹å¾å¤„ç†ã€‚å®ƒä»¬çš„ä½¿ç”¨æ–¹æ³•å’Œä¹‹å‰ä»‹ç»çš„OneHotEncoderEstimatorä¸€æ ·ï¼Œéƒ½æ˜¯å…ˆç”¨fitå‡½æ•°è¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼Œå†ç”¨transformå‡½æ•°å®Œæˆç‰¹å¾è½¬æ¢ã€‚ä¸‹é¢çš„ä»£ç å°±æ˜¯SparrowRecSysåˆ©ç”¨è¿™ä¸¤ä¸ªè½¬æ¢å™¨å®Œæˆç‰¹å¾å½’ä¸€åŒ–å’Œåˆ†æ¡¶çš„è¿‡ç¨‹ã€‚</p><pre><code>def ratingFeatures(samples:DataFrame): Unit ={\n  samples.printSchema()\n  samples.show(10)\n\n\n  //åˆ©ç”¨æ‰“åˆ†è¡¨ratingsè®¡ç®—ç”µå½±çš„å¹³å‡åˆ†ã€è¢«æ‰“åˆ†æ¬¡æ•°ç­‰æ•°å€¼å‹ç‰¹å¾\n  val movieFeatures = samples.groupBy(col(&quot;movieId&quot;))\n    .agg(count(lit(1)).as(&quot;ratingCount&quot;),\n      avg(col(&quot;rating&quot;)).as(&quot;avgRating&quot;),\n      variance(col(&quot;rating&quot;)).as(&quot;ratingVar&quot;))\n      .withColumn(&quot;avgRatingVec&quot;, double2vec(col(&quot;avgRating&quot;)))\n\n\n  movieFeatures.show(10)\n\n\n  //åˆ†æ¡¶å¤„ç†ï¼Œåˆ›å»ºQuantileDiscretizerè¿›è¡Œåˆ†æ¡¶ï¼Œå°†æ‰“åˆ†æ¬¡æ•°è¿™ä¸€ç‰¹å¾åˆ†åˆ°100ä¸ªæ¡¶ä¸­\n  val ratingCountDiscretizer = new QuantileDiscretizer()\n    .setInputCol(&quot;ratingCount&quot;)\n    .setOutputCol(&quot;ratingCountBucket&quot;)\n    .setNumBuckets(100)\n\n\n  //å½’ä¸€åŒ–å¤„ç†ï¼Œåˆ›å»ºMinMaxScalerè¿›è¡Œå½’ä¸€åŒ–ï¼Œå°†å¹³å‡å¾—åˆ†è¿›è¡Œå½’ä¸€åŒ–\n  val ratingScaler = new MinMaxScaler()\n    .setInputCol(&quot;avgRatingVec&quot;)\n    .setOutputCol(&quot;scaleAvgRating&quot;)\n\n\n  //åˆ›å»ºä¸€ä¸ªpipelineï¼Œä¾æ¬¡æ‰§è¡Œä¸¤ä¸ªç‰¹å¾å¤„ç†è¿‡ç¨‹\n  val pipelineStage: Array[PipelineStage] = Array(ratingCountDiscretizer, ratingScaler)\n  val featurePipeline = new Pipeline().setStages(pipelineStage)\n\n\n  val movieProcessedFeatures = featurePipeline.fit(movieFeatures).transform(movieFeatures)\n  //æ‰“å°æœ€ç»ˆç»“æœ\n  movieProcessedFeatures.show(\n\n_ï¼ˆå‚è€ƒ com.wzhe.sparrowrecsys.offline.spark.featureeng.FeatureEngineeringä¸­çš„ratingFeatureså‡½æ•°ï¼‰_\n</code></pre><p>å½“ç„¶ï¼Œå¯¹äºæ•°å€¼å‹ç‰¹å¾çš„å¤„ç†æ–¹æ³•è¿˜è¿œä¸æ­¢äºæ­¤ï¼Œåœ¨ç»å…¸çš„YouTubeæ·±åº¦æ¨èæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ä¸€äº›å¾ˆæœ‰æ„æ€çš„å¤„ç†æ–¹æ³•ã€‚æ¯”å¦‚ï¼Œåœ¨å¤„ç†è§‚çœ‹æ—¶é—´é—´éš”ï¼ˆtime since last watchï¼‰å’Œè§†é¢‘æ›å…‰é‡ï¼ˆ#previous impressionsï¼‰è¿™ä¸¤ä¸ªç‰¹å¾çš„æ—¶ï¼ŒYouTubeæ¨¡å‹å¯¹å®ƒä»¬è¿›è¡Œå½’ä¸€åŒ–åï¼Œåˆå°†å®ƒä»¬å„è‡ªå¤„ç†æˆäº†ä¸‰ä¸ªç‰¹å¾ï¼ˆå›¾6ä¸­çº¢æ¡†å†…çš„éƒ¨åˆ†ï¼‰ï¼Œåˆ†åˆ«æ˜¯åŸç‰¹å¾å€¼xï¼Œç‰¹å¾å€¼çš„å¹³æ–¹<code>x^2</code>ï¼Œä»¥åŠç‰¹å¾å€¼çš„å¼€æ–¹ï¼Œè¿™åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p><img src=\"https://static001.geekbang.org/resource/image/69/ae/69f2abc980b8d8448867b58468729eae.jpeg?wh=960*540\" alt=\"\" title=\"å›¾6 YouTubeæ¨èæ¨¡å‹ï¼ˆæ¥æºï¼šDeep Neural Networks for YouTube Recommendationsï¼‰\"></p><p>å…¶å®ï¼Œæ— è®ºæ˜¯å¹³æ–¹è¿˜æ˜¯å¼€æ–¹æ“ä½œï¼Œæ”¹å˜çš„è¿˜æ˜¯è¿™ä¸ªç‰¹å¾å€¼çš„åˆ†å¸ƒï¼Œè¿™äº›æ“ä½œä¸åˆ†æ¡¶æ“ä½œä¸€æ ·ï¼Œéƒ½æ˜¯å¸Œæœ›é€šè¿‡æ”¹å˜ç‰¹å¾çš„åˆ†å¸ƒï¼Œè®©æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°å­¦ä¹ åˆ°ç‰¹å¾å†…åŒ…å«çš„æœ‰ä»·å€¼ä¿¡æ¯ã€‚ä½†ç”±äºæˆ‘ä»¬æ²¡æ³•é€šè¿‡äººå·¥çš„ç»éªŒåˆ¤æ–­å“ªç§ç‰¹å¾å¤„ç†æ–¹å¼æ›´å¥½ï¼Œæ‰€ä»¥ç´¢æ€§æŠŠå®ƒä»¬éƒ½è¾“å…¥æ¨¡å‹ï¼Œè®©æ¨¡å‹æ¥åšé€‰æ‹©ã€‚</p><p>è¿™é‡Œå…¶å®è‡ªç„¶è€Œç„¶åœ°å¼•å‡ºäº†æˆ‘ä»¬è¿›è¡Œç‰¹å¾å¤„ç†çš„ä¸€ä¸ªåŸåˆ™ï¼Œå°±æ˜¯<strong>ç‰¹å¾å¤„ç†å¹¶æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆ</strong>ï¼Œä¸å­˜åœ¨ä¸€ç§ç‰¹å¾å¤„ç†æ–¹å¼æ˜¯ä¸€å®šå¥½äºå¦ä¸€ç§çš„ã€‚åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¤šè¿›è¡Œä¸€äº›å°è¯•ï¼Œæ‰¾åˆ°é‚£ä¸ªæœ€èƒ½å¤Ÿæå‡æ¨¡å‹æ•ˆæœçš„ä¸€ç§æˆ–ä¸€ç»„å¤„ç†æ–¹å¼ã€‚</p><h2>å°ç»“</h2><p>è¿™èŠ‚è¯¾æˆ‘ä»¬ä»‹ç»äº†æ¨èç³»ç»Ÿä¸­ç‰¹å¾å¤„ç†çš„ä¸»è¦æ–¹å¼ï¼Œå¹¶åˆ©ç”¨Sparkå®è·µäº†ç±»åˆ«å‹ç‰¹å¾å’Œæ•°å€¼å‹ç‰¹å¾çš„ä¸»è¦å¤„ç†æ–¹æ³•ï¼Œæœ€åæˆ‘ä»¬è¿˜æ€»ç»“å‡ºäº†ç‰¹å¾å¤„ç†çš„åŸåˆ™ï¼Œâ€œç‰¹å¾å¤„ç†æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼Œéœ€è¦æ ¹æ®æ¨¡å‹æ•ˆæœå®è·µå‡ºçœŸçŸ¥â€ã€‚</p><p>é’ˆå¯¹ç‰¹å¾å¤„ç†çš„æ–¹æ³•ï¼Œæ·±åº¦å­¦ä¹ å’Œä¼ ç»Ÿæœºå™¨å­¦ä¹ çš„åŒºåˆ«å¹¶ä¸å¤§ï¼ŒTensorFlowã€PyTorchç­‰æ·±åº¦å­¦ä¹ å¹³å°ä¹Ÿæä¾›äº†ç±»ä¼¼çš„ç‰¹å¾å¤„ç†å‡½æ•°ã€‚åœ¨ä»Šåçš„æ¨èæ¨¡å‹ç« èŠ‚æˆ‘ä»¬ä¼šè¿›ä¸€æ­¥ç”¨åˆ°è¿™äº›æ–¹æ³•ã€‚</p><p>æœ€åï¼Œæˆ‘æŠŠè¿™èŠ‚è¯¾çš„ä¸»è¦çŸ¥è¯†ç‚¹æ€»ç»“æˆäº†ä¸€å¼ è¡¨æ ¼ï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒå·©å›ºä»Šå¤©çš„é‡ç‚¹çŸ¥è¯†ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/b3/7b/b3b8c959df72ce676ae04bd8dd987e7b.jpeg?wh=1609*660\" alt=\"\"></p><p>è¿™èŠ‚è¯¾æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€å ‚å®æˆ˜è¯¾ï¼Œå¯¹äºè¿˜æœªè¿›å…¥åˆ°å·¥ä¸šç•Œçš„åŒå­¦ï¼Œç›¸ä¿¡é€šè¿‡è¿™èŠ‚è¯¾çš„å®è·µï¼Œä¹Ÿèƒ½å¤Ÿä¸€çª¥ä¸šç•Œçš„å¤§æ•°æ®å¤„ç†æ–¹æ³•ï¼Œå¢å¼ºè‡ªå·±çš„å·¥ç¨‹ç»éªŒï¼Œè®©æˆ‘ä»¬ä¸€èµ·ç”±æ­¤è¿ˆå…¥å·¥ä¸šçº§æ¨èç³»ç»Ÿçš„å¤§é—¨å§ï¼</p><h2>è¯¾åæ€è€ƒ</h2><ol>\n<li>\n<p>è¯·ä½ æŸ¥é˜…ä¸€ä¸‹Spark MLlibçš„ç¼–ç¨‹æ‰‹å†Œï¼Œæ‰¾å‡ºNormalizerã€StandardScalerã€RobustScalerã€MinMaxScalerè¿™ä¸ªå‡ ä¸ªç‰¹å¾å¤„ç†æ–¹æ³•æœ‰ä»€ä¹ˆä¸åŒã€‚</p>\n</li>\n<li>\n<p>ä½ èƒ½è¯•ç€è¿è¡Œä¸€ä¸‹SparrowRecSysä¸­çš„FeatureEngineeringç±»ï¼Œä»è¾“å‡ºçš„ç»“æœä¸­æ‰¾å‡ºï¼Œåˆ°åº•å“ªä¸€åˆ—æ˜¯æˆ‘ä»¬å¤„ç†å¥½çš„One-hotç‰¹å¾å’ŒMulti-hotç‰¹å¾å—ï¼Ÿä»¥åŠè¿™ä¸¤ä¸ªç‰¹å¾æ˜¯ç”¨Sparkä¸­çš„ä»€ä¹ˆæ•°æ®ç»“æ„æ¥è¡¨ç¤ºçš„å‘¢ï¼Ÿ</p>\n</li>\n</ol><p>è¿™å°±æ˜¯æˆ‘ä»¬è¿™èŠ‚è¯¾çš„å…¨éƒ¨å†…å®¹äº†ï¼Œä½ æŒæ¡å¾—æ€ä¹ˆæ ·ï¼Ÿæ¬¢è¿ä½ æŠŠè¿™èŠ‚è¯¾è½¬å‘å‡ºå»ã€‚ä¸‹èŠ‚è¯¾æˆ‘ä»¬å°†è®²è§£ä¸€ç§æ›´é«˜é˜¶çš„ç‰¹å¾å¤„ç†æ–¹æ³•ï¼Œå®ƒåŒæ—¶ä¹Ÿæ˜¯æ·±åº¦å­¦ä¹ çŸ¥è¯†ä½“ç³»ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬åˆ°æ—¶å€™è§ï¼</p>","comments":[{"had_liked":false,"id":252883,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1602506224,"is_pvip":false,"replies":[{"id":"92474","content":"éå¸¸æ£’ï¼Œæ¨èå…¶ä»–åŒå­¦å‚è€ƒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602634059,"ip_address":"","comment_id":252883,"utype":1}],"discussion_count":5,"race_medal":0,"score":"306545184240","product_id":100060801,"comment_content":"Normalizerã€StandardScalerã€RobustScalerã€MinMaxScaler éƒ½æ˜¯ç”¨è®©æ•°æ®æ— é‡çº²åŒ–<br>Normalizer:  æ­£åˆ™åŒ–ï¼›ï¼ˆå’ŒPythonçš„sklearnä¸€æ ·æ˜¯æŒ‰è¡Œå¤„ç†ï¼Œè€Œä¸æ˜¯æŒ‰åˆ—[æ¯ä¸€åˆ—æ˜¯ä¸€ä¸ªç‰¹å¾]å¤„ç†ï¼ŒåŸå› æ˜¯ï¼šNormalizationä¸»è¦æ€æƒ³æ˜¯å¯¹æ¯ä¸ªæ ·æœ¬è®¡ç®—å…¶p-èŒƒæ•°ï¼Œç„¶åå¯¹è¯¥æ ·æœ¬ä¸­æ¯ä¸ªå…ƒç´ é™¤ä»¥è¯¥èŒƒæ•°ï¼Œè¿™æ ·å¤„ç†çš„ç»“æœæ˜¯ä½¿å¾—æ¯ä¸ªå¤„ç†åæ ·æœ¬çš„p-èŒƒæ•°(l1-norm,l2-norm)ç­‰äº1ã€‚ï¼‰é’ˆå¯¹æ¯è¡Œæ ·æœ¬å‘é‡ï¼šl1: æ¯ä¸ªå…ƒç´ &#47;æ ·æœ¬ä¸­æ¯ä¸ªå…ƒç´ ç»å¯¹å€¼çš„å’Œï¼Œl2: æ¯ä¸ªå…ƒç´ &#47;æ ·æœ¬ä¸­æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹å’Œå¼€æ ¹å·ï¼Œlp: æ¯ä¸ªå…ƒç´ &#47;æ¯ä¸ªå…ƒç´ çš„pæ¬¡æ–¹å’Œçš„pæ¬¡æ ¹ï¼Œé»˜è®¤ç”¨l2èŒƒæ•°ã€‚<br><br>StandardScalerï¼šæ•°æ®æ ‡å‡†åŒ–ï¼›(xi - u) &#47; Ïƒ ã€u:å‡å€¼ï¼ŒÏƒï¼šæ–¹å·®ã€‘å½“æ•°æ®(x)æŒ‰å‡å€¼(Î¼)ä¸­å¿ƒåŒ–åï¼Œå†æŒ‰æ ‡å‡†å·®(Ïƒ)ç¼©æ”¾ï¼Œæ•°æ®å°±ä¼šæœä»ä¸ºå‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒï¼ˆå³æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼‰ã€‚<br><br>RobustScaler: (xi - median) &#47; IQR ã€medianæ˜¯æ ·æœ¬çš„ä¸­ä½æ•°ï¼ŒIQRæ˜¯æ ·æœ¬çš„Â å››åˆ†ä½è·ï¼šæ ¹æ®ç¬¬1ä¸ªå››åˆ†ä½æ•°å’Œç¬¬3ä¸ªå››åˆ†ä½æ•°ä¹‹é—´çš„èŒƒå›´æ¥ç¼©æ”¾æ•°æ®ã€‘<br><br>MinMaxScalerï¼šæ•°æ®å½’ä¸€åŒ–ï¼Œ(xi - min(x)) &#47; (max(x) - min(x)) ;å½“æ•°æ®(x)æŒ‰ç…§æœ€å°å€¼ä¸­å¿ƒåŒ–åï¼Œå†æŒ‰æå·®ï¼ˆæœ€å¤§å€¼ - æœ€å°å€¼ï¼‰ç¼©æ”¾ï¼Œæ•°æ®ç§»åŠ¨äº†æœ€å°å€¼ä¸ªå•ä½ï¼Œå¹¶ä¸”ä¼šè¢«æ”¶æ•›åˆ° [0,1]ä¹‹é—´<br>","like_count":72,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506906,"discussion_content":"éå¸¸æ£’ï¼Œæ¨èå…¶ä»–åŒå­¦å‚è€ƒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602634059,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2146907,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/qLpWmAg6TR6GgXQ3x5345k2eJsOdsJibYYjxbPtcHlfYSdG5qT1qR72BYzxXWvJuxicPG2lH92ynGfpVtdz5IjjA/132","nickname":"InfoQ_ea311a6b3a82","note":"","ucode":"7D63ABB5C708B8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318593,"discussion_content":"å±‚ä¸»æ€»ç»“çš„å¾ˆå¥½ï¼\nä¸è¿‡ç¬¬ä¸€ç‚¹Normalizerå¯ä»¥æŒ‰è¡Œä¹Ÿå¯ä»¥æŒ‰åˆ—ï¼Œä¾‹å¦‚\nfrom sklearn import preprocessing\n# é»˜è®¤l2æ ‡å‡†åŒ–ï¼Œæ¯ä¸ªæ•°æ®çš„ç‰¹å¾å¹³æ–¹åŠ å’Œä¸º1\nnormalized_X = preprocessing.normalize(X,norm=&#39;l2&#39;,axis=0) \n#0æ˜¯æŒ‰è¡Œï¼Œ1æ˜¯æŒ‰åˆ—","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1603788691,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1127175,"avatar":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","nickname":"JustDoDT","note":"","ucode":"6AF0B80F00EAEF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2146907,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/qLpWmAg6TR6GgXQ3x5345k2eJsOdsJibYYjxbPtcHlfYSdG5qT1qR72BYzxXWvJuxicPG2lH92ynGfpVtdz5IjjA/132","nickname":"InfoQ_ea311a6b3a82","note":"","ucode":"7D63ABB5C708B8","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":318688,"discussion_content":"æ€æƒ³æ˜¯å¤„ç†ä¸€ä¸ªæ ·æœ¬ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç‰¹å¾æ‰€æœ‰æ•°æ®ã€‚è¡Œä¸šæƒ¯ä¾‹ä¸€è¡Œä¸€ä¸ªæ ·æœ¬ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1603807710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":318593,"ip_address":""},"score":318688,"extra":""}]},{"author":{"id":1952248,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/c9/f8/72955ef9.jpg","nickname":"æµ£ç†Šå½“å®¶","note":"","ucode":"939F06050423E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312773,"discussion_content":"Normalizeræ˜¯æŒ‰è¡Œå¤„ç†ï¼Œè¿™ä¸€ç‚¹æç¤ºçš„å¤ªæ£’äº†ï¼æ„Ÿè°¢","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1602812741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2547252,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/rVPgtbGVJZGIpfvOUjVaMYoo5gMuMxxHouMxbdbgAgqhd5LGmgEqIupOtBjXCpCnM9IsTYzAorupGztgsN9TBg/132","nickname":"Geek_dadc1e","note":"","ucode":"D8ED870453C301","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545966,"discussion_content":"https://scikit-learn.org/stable/modules/preprocessing.html#preprocessing-scaler","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642112455,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253705,"user_name":"æ@å›","can_delete":false,"product_type":"c1","uid":2111369,"ip_address":"","ucode":"B077098687B4F4","user_header":"","comment_is_top":false,"comment_ctime":1602837008,"is_pvip":false,"replies":[{"id":"92701","content":"è¿™æ˜¯ä¸ªå¥½é—®é¢˜ã€‚ä½†ä¸åº”è¯¥è¿™æ ·ç†è§£ï¼Œæœ¬è´¨ä¸Šæ˜¯æ”¹å˜äº†ç‰¹å¾çš„åˆ†å¸ƒï¼Œç‰¹å¾çš„åˆ†å¸ƒå’Œè®­ç»ƒæ•°æ®çš„åˆ†å¸ƒæ²¡æœ‰æœ¬è´¨çš„è”ç³»ã€‚åªè¦ä½ ä¸æ”¹å˜è®­ç»ƒæ•°æ®labelçš„åˆ†å¸ƒï¼Œæœ€ç»ˆé¢„æµ‹å‡ºçš„ç»“æœéƒ½åº”è¯¥æ˜¯ç¬¦åˆæ•°æ®æœ¬èº«åˆ†å¸ƒçš„ã€‚å› ä¸ºä½ è¦é¢„æµ‹çš„æ˜¯labelï¼Œå¹¶ä¸æ˜¯ç‰¹å¾æœ¬èº«ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602871666,"ip_address":"","comment_id":253705,"utype":1}],"discussion_count":4,"race_medal":0,"score":"96092117520","product_id":100060801,"comment_content":"å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œå¹³æ–¹æˆ–è€…å¼€æ–¹ï¼Œæ˜¯ä¸ºäº†æ”¹å˜è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒã€‚è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒè¢«æ”¹å˜åï¼Œè®­ç»ƒå‡ºæ¥çš„æ¨¡å‹å²‚ä¸æ˜¯ä¸èƒ½æ­£ç¡®æ‹Ÿåˆè®­ç»ƒæ•°æ®äº†ã€‚","like_count":23,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507151,"discussion_content":"è¿™æ˜¯ä¸ªå¥½é—®é¢˜ã€‚ä½†ä¸åº”è¯¥è¿™æ ·ç†è§£ï¼Œæœ¬è´¨ä¸Šæ˜¯æ”¹å˜äº†ç‰¹å¾çš„åˆ†å¸ƒï¼Œç‰¹å¾çš„åˆ†å¸ƒå’Œè®­ç»ƒæ•°æ®çš„åˆ†å¸ƒæ²¡æœ‰æœ¬è´¨çš„è”ç³»ã€‚åªè¦ä½ ä¸æ”¹å˜è®­ç»ƒæ•°æ®labelçš„åˆ†å¸ƒï¼Œæœ€ç»ˆé¢„æµ‹å‡ºçš„ç»“æœéƒ½åº”è¯¥æ˜¯ç¬¦åˆæ•°æ®æœ¬èº«åˆ†å¸ƒçš„ã€‚å› ä¸ºä½ è¦é¢„æµ‹çš„æ˜¯labelï¼Œå¹¶ä¸æ˜¯ç‰¹å¾æœ¬èº«ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602871666,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":3186244,"avatar":"https://static001.geekbang.org/account/avatar/00/30/9e/44/b9d6a4a9.jpg","nickname":"JohnH","note":"","ucode":"E1BADF7024FC2B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":589478,"discussion_content":"è¿™ä¸€æ­¥åº”è¯¥æ˜¯basis function expansion (BFE)ï¼Œåœ¨æœºå™¨å­¦ä¹ é‡Œé¢å¸¸ç”¨ä¸ºç‰¹å¾æ‰©å¼ çš„å—ï¼Ÿä»…ä»…æ˜¯å¯¹ç‰¹å¾çš„ç»´åº¦è¿›è¡Œäº†å¢å¹¿ï¼ˆæˆ–è®¸èƒ½ä»æ–°çš„æ‰©å¼ ç‰¹å¾ä¸­å­¦åˆ°æœ‰ç”¨çš„ä¸œè¥¿ï¼Œè¿™ä¸€ç‚¹æˆ–è®¸å¯ä»¥ç”¨feature selectionæˆ–è€…dimensional reductionè¿›è¡Œè¿›ä¸€æ­¥ç­›é€‰ï¼‰ï¼Œå¯¹æ ‡ç­¾å€¼æ˜¯æ²¡æœ‰å½±å“çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665032083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ç¾å›½"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2056623,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/61/af/910f3111.jpg","nickname":"tt","note":"","ucode":"64DE06A3862C31","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":409183,"discussion_content":"æƒ³é—®ä¸‹ï¼Œå¯¹æ­£è´Ÿæ ·æœ¬æŒ‰æ¯”ä¾‹é‡‡æ ·ï¼Œç®—ä¸ç®—æ”¹å˜æ•°æ®é›†labelæ•´ä½“åˆ†å¸ƒ~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635389066,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2989808,"avatar":"https://static001.geekbang.org/account/avatar/00/2d/9e/f0/67f85991.jpg","nickname":"ğŸ‰ é™","note":"","ucode":"E3881B06E91CEE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2056623,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/61/af/910f3111.jpg","nickname":"tt","note":"","ucode":"64DE06A3862C31","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":576165,"discussion_content":"æŠ½æ ·æ²¡æœ‰æ”¹å˜labelçš„æ•´ä½“åˆ†å¸ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1655316002,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":409183,"ip_address":""},"score":576165,"extra":""}]}]},{"had_liked":false,"id":274250,"user_name":"å°å¼º","can_delete":false,"product_type":"c1","uid":2398148,"ip_address":"","ucode":"C3D1215867302D","user_header":"https://static001.geekbang.org/account/avatar/00/24/97/c4/6c92c78a.jpg","comment_is_top":false,"comment_ctime":1610940293,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"91805253509","product_id":100060801,"comment_content":"OneHotEncoderEstimator() åœ¨PySpark 3.0.0åŠä»¥ä¸Šç‰ˆæœ¬å·²ç»æ›´æ”¹ä¸º OneHotEncoder()","like_count":22},{"had_liked":false,"id":252738,"user_name":"JustDoDT","can_delete":false,"product_type":"c1","uid":1127175,"ip_address":"","ucode":"6AF0B80F00EAEF","user_header":"https://static001.geekbang.org/account/avatar/00/11/33/07/8f351609.jpg","comment_is_top":false,"comment_ctime":1602472364,"is_pvip":false,"replies":[{"id":"92309","content":"ä¸é”™çš„æ–‡ç« ï¼Œä¹Ÿæ¨èå¤§å®¶å­¦ä¹ ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602485659,"ip_address":"","comment_id":252738,"utype":1}],"discussion_count":3,"race_medal":0,"score":"70321949100","product_id":100060801,"comment_content":"Multipleç¼–ç <br>é¡¾åæ€ä¹‰ï¼ŒMultipleç¼–ç ç‰¹å¾å°†å¤šä¸ªå±æ€§åŒæ—¶ç¼–ç åˆ°ä¸€ä¸ªç‰¹å¾ä¸­ã€‚åœ¨æ¨èåœºæ™¯ä¸­ï¼Œå•ä¸ªç”¨æˆ·å¯¹å“ªäº›ç‰©å“æ„Ÿå…´è¶£çš„ç‰¹å¾å°±æ˜¯ä¸€ç§Multipleç¼–ç ç‰¹å¾ï¼Œå¦‚ï¼Œè¡¨ç¤ºæŸç”¨æˆ·å¯¹äº§å“1ã€äº§å“2ã€äº§å“3ã€äº§å“4æ˜¯å¦æ„Ÿå…´è¶£ï¼Œåˆ™è¿™ä¸ªç‰¹å¾å¯èƒ½æœ‰å¤šä¸ªå–å€¼ï¼Œå¦‚ç”¨æˆ·Aå¯¹äº§å“1å’Œäº§å“2æ„Ÿå…´è¶£ï¼Œç”¨æˆ·Bå¯¹äº§å“1å’Œäº§å“4æ„Ÿå…´è¶£ï¼Œç”¨æˆ·Cå¯¹äº§å“1ã€äº§å“3å’Œäº§å“4æ„Ÿå…´è¶£ï¼Œåˆ™ç”¨æˆ·å…´è¶£ç‰¹å¾ä¸º<br>ç”¨æˆ·\tUserInterests<br>A\t[1, 2]<br>B\t[1, 4]<br>C\t[1, 3, 4]<br><br>Multipleç¼–ç é‡‡ç”¨ç±»ä¼¼oneHotç¼–ç çš„å½¢å¼è¿›è¡Œç¼–ç ï¼Œæ ¹æ®ç‰©å“ç§ç±»æ•°ç›®ï¼Œå±•æˆç‰©å“ç§ç±»æ•°ç›®å¤§å°çš„å‘é‡ï¼Œå½“æŸä¸ªç”¨æˆ·æ„Ÿå…´è¶£æ—¶ï¼Œå¯¹åº”ç»´åº¦ä¸º1ï¼Œåä¹‹ä¸º0ï¼Œå¦‚ä¸‹<br>ç”¨æˆ·\tUserInterests<br>A\t[1, 1, 0, 0]<br>B\t[1, 0, 0, 1]<br>C\t[1, 0, 1, 1]<br><br>å¦‚ä½•ä½¿ç”¨Multipleç¼–ç å‘¢ï¼Ÿ<br>æˆ‘ä»¬å°†å¤šä¸ªå±æ€§åŒæ—¶ç¼–ç åˆ°åŒä¸€ä¸ªç‰¹å¾ä¸­ï¼Œç›®çš„å°±æ˜¯åŒæ—¶åˆ©ç”¨å¤šä¸ªå±æ€§çš„ç‰¹å¾ã€‚ç»è¿‡Multipleç¼–ç åçš„ç‰¹å¾å¤§å°ä¸º[batch_size, num_items]ï¼Œè®°ä½œUï¼Œæ„å»ºç‰©å“itemsçš„EmbeddingçŸ©é˜µï¼Œè¯¥çŸ©é˜µç»´åº¦ä¸º[num_items, embedding_size]ï¼Œè®°ä½œVï¼Œå°†çŸ©é˜µUå’ŒçŸ©é˜µVç›¸ä¹˜ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†å¤§å°ä¸º[batch_sizeï¼Œ embedding_size]çš„å¤šå±æ€§è¡¨ç¤ºã€‚<br>å‚è€ƒèµ„æ–™ï¼šhttps:&#47;&#47;www.codeleading.com&#47;article&#47;97252516619&#47;#_OneHot_19","like_count":16,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506855,"discussion_content":"ä¸é”™çš„æ–‡ç« ï¼Œä¹Ÿæ¨èå¤§å®¶å­¦ä¹ ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602485659,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2338426,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqlGaOqz0NBjhk0VfOx1AAG7k5tqyicuw6sJGcWostrOiaf34wPedm8rIIzrNjPHkBJLG7GboLaNurw/132","nickname":"Geek_55eaf9","note":"","ucode":"3409B413A95188","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":333578,"discussion_content":"é—®ä¸‹ï¼Œå¯¹äºMultipleçš„embå‘é‡ï¼Œä¸€èˆ¬æ˜¯ä¸æ˜¯ç”¨avg/maxä¹‹ç±»çš„æ“ä½œæŠŠå¤šä¸ªembåˆæˆä¸€ä¸ªembå‘é‡å‘¢","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1607568589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1362648,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ca/d8/767d8e6e.jpg","nickname":"å¼ºè€…è‡ªå¼º","note":"","ucode":"391B934CC10342","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":346499,"discussion_content":"ä½ å¥½ï¼Œå¯¹äºbatch_sizeå’Œnum_itemsçš„å¤§å°å¯ä»¥è¯¦ç»†è¯´ä¸€ä¸‹å—ï¼Œè°¢è°¢~","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611974813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":260339,"user_name":"twzd","can_delete":false,"product_type":"c1","uid":1008973,"ip_address":"","ucode":"93341A57D39184","user_header":"https://static001.geekbang.org/account/avatar/00/0f/65/4d/06bf7890.jpg","comment_is_top":false,"comment_ctime":1604987633,"is_pvip":false,"replies":[{"id":"94626","content":"è¿™æ˜¯ä¸€ä¸ªç¨€ç–å‘é‡è¡¨ç¤ºï¼Œ1001ç»´ï¼Œç¬¬1ç»´çš„å€¼ä¸º1.0","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1605078871,"ip_address":"","comment_id":260339,"utype":1}],"discussion_count":1,"race_medal":0,"score":"44554660593","product_id":100060801,"comment_content":"è€å¸ˆè¯·æ•™ä¸€ä¸‹ï¼ŒmovieIdVectoråˆ—è¾“å‡ºç»“æœä¸­(1001,[1],[1.0])ï¼Œæ¯ä¸€åˆ—è¡¨ç¤ºä»€ä¹ˆå«ä¹‰å•Š","like_count":10,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509172,"discussion_content":"è¿™æ˜¯ä¸€ä¸ªç¨€ç–å‘é‡è¡¨ç¤ºï¼Œ1001ç»´ï¼Œç¬¬1ç»´çš„å€¼ä¸º1.0","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605078871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":266153,"user_name":"Geek_ddf8b1","can_delete":false,"product_type":"c1","uid":2309043,"ip_address":"","ucode":"70E1BB4C1CC6C4","user_header":"","comment_is_top":false,"comment_ctime":1607218880,"is_pvip":false,"replies":[{"id":"96780","content":"ä½ å¥½ï¼Œå…¶å®ä½ æçš„ä¸æ˜¯é—®é¢˜ï¼Œæçš„æ˜¯è‡ªå·±çš„æ€è€ƒï¼Œæˆ‘è§‰å¾—éƒ½éå¸¸å¥½ï¼Œä»–ä»¬ç¡®å®éƒ½æ˜¯æˆ‘ä»¬åœ¨å®é™…å·¥ä½œä¸­éœ€è¦è§£å†³çš„é—®é¢˜ã€‚<br>è¿™äº›é—®é¢˜æ²¡æœ‰ä»€ä¹ˆæ‰€è°“ç­”æ¡ˆï¼Œè‡ªå·±å»æ€è€ƒï¼Œè‡ªå·±å»å°è¯•å°±å¥½äº†ã€‚<br><br>æˆ‘è‡ªå·±çš„ç»éªŒæ˜¯å­˜onehotå’Œmuilthotçš„indexï¼Œå­˜å‚¨ç»“æ„ç”¨protobufã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1607389709,"ip_address":"","comment_id":266153,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35966957248","product_id":100060801,"comment_content":"è€å¸ˆ æˆ‘çœ‹æ‚¨FeatureEngForRecModel.scalaä»£ç ä¸­å°†ç‰¹å¾å†™å…¥redisæ˜¯ä»¥å“ˆå¸Œè¡¨çš„æ ¼å¼å†™å…¥çš„ï¼Œè€Œä¸”æœ‰äº›ç‰¹å¾ç›´æ¥æ˜¯ç±»åˆ«å‹çš„æ–‡æœ¬æ•°æ®ã€‚ <br>       è¿™ç§æ–¹å¼çº¿ä¸Šè¯»å–ç‰¹å¾å†åç»­å¤„ç†è¾“å…¥æ’åºæ¨¡å‹é¢„ä¼°çš„æ—¶å€™ä¼šä¸ä¼šæ•ˆç‡å¾ˆä½ï¼Œé¢„ä¼°æ‰“åˆ†æ—¶é—´è¾ƒé•¿ï¼Ÿæ¯”å¦‚å–å‡ºæ–‡æœ¬ç‰¹å¾åšonehot æˆ–è€…multihotå˜æ¢ç­‰ç­‰ï¼Œæ˜¯å¦å¯ä»¥å°†æ–‡æœ¬ç‰¹å¾onehot æˆ–è€…multihotå¤„ç†åå†å†™å…¥redisï¼Ÿ <br>     è¿˜æœ‰ç‰¹å¾é™¤äº†ä»¥hashè¡¨å½¢å¼è¿˜å¯ä»¥ä»¥å…¶å®ƒæ•°æ®ç»“æ„å­˜åˆ°redisï¼Œæ¯”å¦‚ä»¥probufå¯¹è±¡ã€libsvmæ•°æ®æ ¼å¼çš„ç‰¹å¾ç´¢å¼•ï¼šç‰¹å¾å€¼çš„å­—ç¬¦ä¸²å­˜åˆ°redis æ‚¨å¯¹è¿™å‡ ç§å­˜å‚¨æ–¹å¼æ€ä¹ˆçœ‹ï¼Ÿå“ªç§æ›´å¥½ï¼Ÿ","like_count":9,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511164,"discussion_content":"ä½ å¥½ï¼Œå…¶å®ä½ æçš„ä¸æ˜¯é—®é¢˜ï¼Œæçš„æ˜¯è‡ªå·±çš„æ€è€ƒï¼Œæˆ‘è§‰å¾—éƒ½éå¸¸å¥½ï¼Œä»–ä»¬ç¡®å®éƒ½æ˜¯æˆ‘ä»¬åœ¨å®é™…å·¥ä½œä¸­éœ€è¦è§£å†³çš„é—®é¢˜ã€‚\nè¿™äº›é—®é¢˜æ²¡æœ‰ä»€ä¹ˆæ‰€è°“ç­”æ¡ˆï¼Œè‡ªå·±å»æ€è€ƒï¼Œè‡ªå·±å»å°è¯•å°±å¥½äº†ã€‚\n\næˆ‘è‡ªå·±çš„ç»éªŒæ˜¯å­˜onehotå’Œmuilthotçš„indexï¼Œå­˜å‚¨ç»“æ„ç”¨protobufã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607389709,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253231,"user_name":"å¼ å¼› Conor","can_delete":false,"product_type":"c1","uid":2208459,"ip_address":"","ucode":"193EBA4A64BAB3","user_header":"https://static001.geekbang.org/account/avatar/00/21/b2/cb/9c6c7bf7.jpg","comment_is_top":false,"comment_ctime":1602657808,"is_pvip":false,"replies":[{"id":"92640","content":"å…¶å®ä¸å»ºè®®è¿™ç§ç¦»æ•£æ•°å€¼ï¼Œå–å€¼æ•°é‡æœ‰æ¯”è¾ƒå°‘çš„ç‰¹å¾è¿›è¡Œåˆ†æ¡¶æ“ä½œã€‚æŠŠç›¸åŒåˆ†å€¼å¼ºåˆ¶åˆ†åˆ°ä¸¤ä¸ªæ¡¶é‡Œï¼Œä¸ä»…æ²¡æœ‰æ„ä¹‰ï¼Œè€Œä¸”å¼•å…¥å™ªå£°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602827189,"ip_address":"","comment_id":253231,"utype":1}],"discussion_count":2,"race_medal":0,"score":"23077494288","product_id":100060801,"comment_content":"è¯·æ•™è€å¸ˆï¼Œåƒåœ¨ç”µå½±è¯„åˆ†è¿™æ ·çš„ç¦»æ•£æ•°å€¼(ä¸”æ¯”è¾ƒç¨€ç–)ä¾‹å­ä¸­ï¼Œå¦‚æœéœ€è¦å–å¾—åˆ†æ¡¶æ•°è¾ƒå¤šï¼Œè€Œå¯¼è‡´åˆ†ä½æ•°é™„è¿‘å‡æ˜¯åŒä¸€æ•°å€¼çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•ä½¿ç”¨åˆ†æ¡¶çš„æ–¹æ³•å‘¢ï¼Ÿ<br>æ¯”å¦‚æŒ‰ç…§åˆ†æ¡¶æ³•é¦–å…ˆæ’åºå¾—åˆ°è¯„åˆ†ä¸º5,5,4,4,4,4,4,4,3,3,3,3,2,2,1(å…±15ä¸ª)ã€‚å–æ¡¶æ•°ä¸º3æ—¶ï¼Œç¬¬ä¸€ä¸ªæ¡¶å†…æœ‰å‰ä¸¤ä¸ª5ï¼Œè€Œåé¢çš„6ä¸ª4ä¸­åº”è¯¥é€‰æ‹©å“ª3ä¸ªæ¥åˆ†åˆ°ç¬¬ä¸€ä¸ªæ¡¶å‘¢ï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507012,"discussion_content":"å…¶å®ä¸å»ºè®®è¿™ç§ç¦»æ•£æ•°å€¼ï¼Œå–å€¼æ•°é‡æœ‰æ¯”è¾ƒå°‘çš„ç‰¹å¾è¿›è¡Œåˆ†æ¡¶æ“ä½œã€‚æŠŠç›¸åŒåˆ†å€¼å¼ºåˆ¶åˆ†åˆ°ä¸¤ä¸ªæ¡¶é‡Œï¼Œä¸ä»…æ²¡æœ‰æ„ä¹‰ï¼Œè€Œä¸”å¼•å…¥å™ªå£°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602827189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2527743,"avatar":"https://static001.geekbang.org/account/avatar/00/26/91/ff/aa5e573a.jpg","nickname":"ç‰›ç‰ªçŠ‡","note":"","ucode":"007A5E511EA243","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":359230,"discussion_content":"ç¡®å®ï¼Œè¿™ç§ç¨€ç–çš„æ•°å€¼ï¼Œå¦‚æœæ˜¯æ— å°ºåº¦ï¼ˆæ— å¤§å°ä¹‹åˆ†ï¼‰ï¼Œé‚£å¯ä»¥ç”¨onehotç¼–ç ï¼Œå¦‚æœæœ‰å°ºåº¦ï¼Œè¿˜ä¸å¦‚ç›´æ¥ä½¿ç”¨ï¼Œåˆ†æ¡¶è¿™ç§å˜æ¢è¿˜æ˜¯é’ˆå¯¹è¿ç»­å‹çš„æ•°å€¼å˜é‡","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1616146516,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":289976,"user_name":"Yvonne","can_delete":false,"product_type":"c1","uid":2577469,"ip_address":"","ucode":"85287A0AC7456C","user_header":"https://static001.geekbang.org/account/avatar/00/27/54/3d/366462d0.jpg","comment_is_top":false,"comment_ctime":1619292573,"is_pvip":false,"replies":[{"id":"105185","content":"èµ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1619411726,"ip_address":"","comment_id":289976,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14504194461","product_id":100060801,"comment_content":"è°¢è°¢è€å¸ˆï¼åœ¨è¯»youtubeè®ºæ–‡çš„æ—¶å€™ï¼Œå½“æ—¶æ²¡æœ‰ç‰¹åˆ«ç†è§£ä¸ºä»€ä¹ˆè¦å°†åŸå€¼ï¼Œå¼€æ–¹ï¼Œå¹³æ–¹éƒ½æ”¾è¿›å»ï¼Œè§£é‡Šæ˜¯ï¼šIn addition to the raw normalized feature Ëœx, we also input powers Ëœx2 and âˆšxËœ, giving the network more expressive power by allowing it to easily form super- and sub-linear functions of the feature. Feeding powers of continuous features was found to improve offline accuracy.â€¦â€¦ å½“æ—¶æ²¡èƒ½ç†è§£ä¸ºä»€ä¹ˆã€‚æ‚¨æåˆ°å¯ä»¥ç”¨äºæ”¹å˜åˆ†å¸ƒç‰¹å¾ï¼Œçªç„¶å°±ç†è§£äº†XD","like_count":3,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519079,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619411726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":275360,"user_name":"Capricornus","can_delete":false,"product_type":"c1","uid":2371321,"ip_address":"","ucode":"B7B15C58653860","user_header":"https://static001.geekbang.org/account/avatar/00/24/2e/f9/c0a6232c.jpg","comment_is_top":false,"comment_ctime":1611488261,"is_pvip":false,"replies":[{"id":"99965","content":"è¿™ä¸ªå¯å¦è‡ªå·±ç ”ç©¶ä¸€ä¸‹ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1611551194,"ip_address":"","comment_id":275360,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14496390149","product_id":100060801,"comment_content":"+-------+-----------+-----------------+<br>|movieId|ratingCount|ratingCountBucket|<br>+-------+-----------+-----------------+<br>|    296|      14616|             13.0|<br>|    356|      14426|             12.0|<br>|    318|      13826|             12.0|<br>|    593|      13692|             12.0|<br>|    480|      13033|             12.0|<br>|    260|      11958|             12.0|<br>|    110|      11637|             12.0|<br>|    589|      11483|             12.0|<br>|    527|      11017|             12.0|<br>|      1|      10759|             12.0|<br>|    457|      10736|             12.0|<br>|    150|      10324|             12.0|<br>|    780|      10271|             12.0|<br>|     50|      10221|             12.0|<br>|    592|      10028|             12.0|<br>|     32|       9694|             12.0|<br>|    608|       9505|             12.0|<br>|    590|       9497|             12.0|<br>|    380|       9364|             12.0|<br>|     47|       9335|             12.0|<br>+-------+-----------+-----------------+<br>è€å¸ˆæˆ‘è®¾ç½®çš„åˆ†æ¡¶æ•°æ˜¯20ï¼Œä¸ºä»€ä¹ˆæœ€å¤§çš„æ¡¶æ ‡å·ä¸æ˜¯19å•Šï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514323,"discussion_content":"è¿™ä¸ªå¯å¦è‡ªå·±ç ”ç©¶ä¸€ä¸‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611551194,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":271900,"user_name":"Capricornus","can_delete":false,"product_type":"c1","uid":2371321,"ip_address":"","ucode":"B7B15C58653860","user_header":"https://static001.geekbang.org/account/avatar/00/24/2e/f9/c0a6232c.jpg","comment_is_top":false,"comment_ctime":1609855715,"is_pvip":false,"replies":[{"id":"98599","content":"èµï¼Œä½¿ç”¨spark3.0çš„åŒå­¦å¯ä»¥å‚è€ƒ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1609870848,"ip_address":"","comment_id":271900,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14494757603","product_id":100060801,"comment_content":"æˆ‘ä½¿ç”¨çš„spark3.0çš„ç¯å¢ƒï¼Œè„±ç¦»è€å¸ˆçš„é¡¹ç›®ï¼Œå•ç‹¬å»ºç«‹çš„ç”¨æ¥å­¦ä¹ ã€‚<br>1. ä¸‹è½½Scalaæ”¯æŒï¼Œ[ä¸‹è½½é“¾æ¥](https:&#47;&#47;www.scala-lang.org&#47;download&#47;2.12.12.html)<br>2. è§£å‹åæ”¾åœ¨æŒ‡å®šçš„ç›®å½•<br>    ```bash<br>    vi ~&#47;.bash_profile<br>    export PATH=&quot;$PATH:&#47;Library&#47;Scala&#47;scala-2.12.12&#47;bin&quot;<br>    ```<br>3. åœ¨IDEAçš„é¡¹ç›®ä¸­å¼•å…¥ï¼Œç‚¹å‡»â€œ+â€å·ï¼Œæ ¹æ®è·¯å¾„æ·»åŠ <br>4. å³é”®é¡¹ç›®çš„ç›®å½•ï¼Œæ·»åŠ æ¡†æ¶æ”¯æŒ<br>5. æ·»åŠ IDEAçš„æ’ä»¶ï¼Œpreferencesä¸­<br><br><br>6. porm.xmlçš„ç¯å¢ƒä¾èµ–<br><br>    ```xml<br>    &lt;dependencies&gt;<br>    &lt;dependency&gt;<br>        &lt;groupId&gt;org.apache.spark&lt;&#47;groupId&gt;<br>        &lt;artifactId&gt;spark-core_2.12&lt;&#47;artifactId&gt;<br>        &lt;version&gt;3.0.0&lt;&#47;version&gt;<br>    &lt;&#47;dependency&gt;<br>    &lt;dependency&gt;<br>        &lt;groupId&gt;org.apache.spark&lt;&#47;groupId&gt;<br>        &lt;artifactId&gt;spark-mllib_2.12&lt;&#47;artifactId&gt;<br>        &lt;version&gt;3.0.0&lt;&#47;version&gt;<br>    &lt;&#47;dependency&gt;<br>    &lt;dependency&gt;<br>        &lt;groupId&gt;org.apache.spark&lt;&#47;groupId&gt;<br>        &lt;artifactId&gt;spark-sql_2.12&lt;&#47;artifactId&gt;<br>        &lt;version&gt;3.0.0&lt;&#47;version&gt;<br>    &lt;&#47;dependency&gt;<br>    &lt;&#47;dependencies&gt;<br>    ```<br>    **æ³¨æ„ï¼šè·¯å¾„ä¸­ä¸è¦åŒ…æ‹¬ä¸­æ–‡ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°è·¯å¾„ä¸å­˜åœ¨çš„é—®é¢˜ã€‚**<br><br>ç„¶åæœ‰ä¸¤å¤„éœ€è¦æ›´æ”¹<br>    val oneHotEncoder = new OneHotEncoder()<br>      .setInputCols(Array(&quot;movieIdNumber&quot;))<br>      .setOutputCols(Array(&quot;movieIdVector&quot;))<br>      .setDropLast(false)<br>&#47;&#47; å®˜ç½‘çš„è¯´æ³•ï¼šOneHotEncoder which is deprecated in 2.3,is removed in 3.0 and OneHotEncoderEstimator is now renamed to OneHotEncoder.<br><br>    val movieFeatures = samples.groupBy(col(&quot;movieId&quot;))<br>      .agg(count(lit(1)).as(&quot;ratingCount&quot;),<br>        avg(col(&quot;rating&quot;)).as(&quot;avgRating&quot;),<br>        functions.variance(col(&quot;rating&quot;)).as(&quot;ratingVar&quot;))<br>      .withColumn(&quot;avgRatingVec&quot;, double2vec(col(&quot;avgRating&quot;)))","like_count":4,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513088,"discussion_content":"èµï¼Œä½¿ç”¨spark3.0çš„åŒå­¦å¯ä»¥å‚è€ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609870848,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":265758,"user_name":"ç¥ç»è›™","can_delete":false,"product_type":"c1","uid":2242137,"ip_address":"","ucode":"9375BA98E03A8D","user_header":"https://static001.geekbang.org/account/avatar/00/22/36/59/010b3e60.jpg","comment_is_top":false,"comment_ctime":1607003980,"is_pvip":false,"replies":[{"id":"96580","content":"æ€»ç»“çš„å¥½ï¼Œèµ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1607019705,"ip_address":"","comment_id":265758,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14491905868","product_id":100060801,"comment_content":"--- çœ‹äº†å‡ ä½åŒå­¦çš„ç•™è¨€ï¼Œå—ç›ŠåŒªæµ…å•Šã€‚å¸Œæœ›å¤§å®¶å¤šå¤šäº¤æµ~<br><br>1.è¯·ä½ æŸ¥é˜…ä¸€ä¸‹ Spark MLlib çš„ç¼–ç¨‹æ‰‹å†Œï¼Œæ‰¾å‡º Normalizerã€StandardScalerã€RobustScalerã€MinMaxScaler è¿™ä¸ªå‡ ä¸ªç‰¹å¾å¤„ç†æ–¹æ³•æœ‰ä»€ä¹ˆä¸åŒã€‚<br><br>Normalizer<br>æ˜¯è§„èŒƒåŒ–ï¼Œæ ¹æ®æ‰€ä¼ çš„på€¼ï¼ŒåšpèŒƒæ•°å½’ä¸€åŒ–(é»˜è®¤p=2)ã€‚å®ƒæ˜¯ä½œç”¨åœ¨æ¯ä¸ªæ ·æœ¬çš„å‘é‡å†…éƒ¨çš„ã€‚æ— éœ€è®­ç»ƒã€‚<br>eg:x:[v1,v2,v3],p1=sum(abs(vi)), ç»è¿‡normalizer, x:[v1&#47;p1,v2&#47;p1,v3&#47;p1]<br><br>StandardScaler<br>æ ‡å‡†åŒ–ï¼Œå°†æ ·æœ¬çš„æ¯ä¸ªç‰¹å¾çš„æ ‡å‡†å·®å˜ä¸º1.æˆ–è€…å¯ä»¥è®¾ç½®å°†å‡å€¼å˜æ¢ä¸º0(é»˜è®¤setMeanæ˜¯False)ã€‚è¿™é‡Œè®¡ç®—æ ‡å‡†å·®ï¼ˆè®¡ç®—å‡å€¼ï¼‰æ˜¯æ ·æœ¬é›†çš„æ¯ä¸ªç»´åº¦å•ç‹¬è®¡ç®—ã€‚æ‰€ä»¥éœ€è¦fitæ“ä½œã€‚è®¡ç®—åä¿å­˜æ¯ä¸ªæ ·æœ¬æ ‡å‡†å·®ã€å‡å€¼åã€‚å¯¹æ¯ä¸ªæ ·æœ¬ç¬¬iä¸ªç»´åº¦é™¤ä»¥ç¬¬iä¸ªç»´åº¦çš„æ ‡å‡†å·®ï¼ˆå¦‚æ­¤è®¡ç®—å,è¯¥ç»´åº¦å‡å€¼ä¹Ÿä¼šè‡ªåŠ¨è¢«é™¤ä»¥æ ‡å‡†å·®ï¼Œç»è¿‡æ ‡å‡†å·®å…¬å¼ï¼Œåˆ™æ–°çš„æ ‡å‡†å·®ä¸º1ï¼‰ã€‚å¦‚æœsetMean == True, åˆ™åœ¨å˜å¹»æ˜¯éœ€è¦å…ˆå‡å»å‡å€¼ä¹‹åå†é™¤ä»¥æ ‡å‡†å·®ã€‚<br><br>RobustScaler<br>æˆ‘çœ‹spark3æ‰æœ‰,å…·ä½“æ²¡å¼„å‡ºæ¥,çœ‹æ–‡æ¡£å¤§æ¦‚æ„æ€æ˜¯å°†æ•°æ®å˜æ¢åˆ°1&#47;4~3&#47;4åˆ†ä¸ºä¹‹é—´ã€‚å¥½åƒæ˜¯è®©æ•°æ®å˜å¾—ç¨ å¯†äº†ã€‚<br><br>MinMaxScaler<br>å°†æ•°æ®å˜ä¸ºåˆ°[0,1]ä¹‹é—´ï¼Œä¹Ÿéœ€è¦è®­ç»ƒï¼Œå¾—åˆ°æ¯ä¸ªç»´åº¦çš„æœ€å¤§æœ€å°å€¼ã€‚ç„¶åå˜åŒ–Y= (X-X_min)&#47;(X_max-X_min)<br><br><br>2.ä½ èƒ½è¯•ç€è¿è¡Œä¸€ä¸‹ SparrowRecSys ä¸­çš„ FeatureEngineering ç±»ï¼Œä»è¾“å‡ºçš„ç»“æœä¸­æ‰¾å‡ºï¼Œåˆ°åº•å“ªä¸€åˆ—æ˜¯æˆ‘ä»¬å¤„ç†å¥½çš„ One-hot ç‰¹å¾å’Œ Multi-hot ç‰¹å¾å—ï¼Ÿä»¥åŠè¿™ä¸¤ä¸ªç‰¹å¾æ˜¯ç”¨ Spark ä¸­çš„ä»€ä¹ˆæ•°æ®ç»“æ„æ¥è¡¨ç¤ºçš„å‘¢ï¼Ÿ<br><br>å¤„ç†å¥½çš„One-hotç‰¹å¾<br>movieIdVector<br><br>å¤„ç†å¥½çš„Multi-hotç‰¹å¾<br>vector<br><br>æ•°æ®ç»“æ„ï¼š<br>SparseVector<br><br>å…¶ä¸­çš„æ•°æ®åˆ†åˆ«æ˜¯ï¼šï¼ˆç±»åˆ«æ•°é‡ï¼Œç´¢å¼•æ•°ç»„ï¼Œå€¼æ•°ç»„ï¼‰ã€‚ç´¢å¼•æ•°ç»„é•¿åº¦å¿…é¡»ç­‰äºå€¼æ•°ç»„é•¿åº¦ã€‚ ","like_count":3,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":511033,"discussion_content":"æ€»ç»“çš„å¥½ï¼Œèµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607019705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1461122,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4b/82/5be29abf.jpg","nickname":"è€å”å”å®‰æ£®","note":"","ucode":"EF61ACAC9A44FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377271,"discussion_content":"è€å¸ˆï¼Œå€¼æ•°ç»„ä»€ä¹ˆä½œç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622565044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253717,"user_name":"fsc2016","can_delete":false,"product_type":"c1","uid":1255585,"ip_address":"","ucode":"5480F05703A974","user_header":"https://static001.geekbang.org/account/avatar/00/13/28/a1/fd2bfc25.jpg","comment_is_top":false,"comment_ctime":1602842023,"is_pvip":false,"replies":[{"id":"92702","content":"éå¸¸å¥½ã€‚æ¯”ä¹‹å‰çš„å›ç­”æ›´å‡†ç¡®ä¸€äº›ï¼Œæ¨èå¤§å®¶å‚è€ƒã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602871688,"ip_address":"","comment_id":253717,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14487743911","product_id":100060801,"comment_content":"ç¬¬äºŒä¸ªé—®é¢˜ï¼š<br>One-hotç‰¹å¾æ˜¯è°ƒç”¨OneHotEncoderEstimatorå¯¹movieIdè½¬æ¢ï¼Œç”Ÿæˆäº†ç‰¹å¾movieIdVector<br>Multi-hot ç‰¹å¾æ˜¯è°ƒç”¨Vectors.sparseæ–¹æ³•ï¼Œå¯¹å¤„ç†åçš„genreIndexesè½¬æ¢ï¼Œç”Ÿæˆvectorã€‚<br>è¿™ä¿©ä¸ªç‰¹å¾éƒ½æ˜¯ç¨€ç–å‘é‡è¡¨ç¤ºï¼Œä¸æ˜¯ç¨ å¯†å‘é‡<br>","like_count":3,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507155,"discussion_content":"éå¸¸å¥½ã€‚æ¯”ä¹‹å‰çš„å›ç­”æ›´å‡†ç¡®ä¸€äº›ï¼Œæ¨èå¤§å®¶å‚è€ƒã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602871688,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1461122,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4b/82/5be29abf.jpg","nickname":"è€å”å”å®‰æ£®","note":"","ucode":"EF61ACAC9A44FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377269,"discussion_content":"è¯„åˆ†æ•°æ®æ‰æ˜¯dense","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622564741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253694,"user_name":"æ¨ä½³äº¦","can_delete":false,"product_type":"c1","uid":2046547,"ip_address":"","ucode":"D2009DAC396F25","user_header":"https://static001.geekbang.org/account/avatar/00/1f/3a/53/ec2c6c55.jpg","comment_is_top":false,"comment_ctime":1602834144,"is_pvip":false,"replies":[{"id":"92700","content":"éå¸¸è¯¦ç»†äº†ï¼Œä¹Ÿæ¨èåœ¨sparkä¸­è‡ªå·±è¿›è¡Œå®è·µã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602871553,"ip_address":"","comment_id":253694,"utype":1}],"discussion_count":2,"race_medal":0,"score":"14487736032","product_id":100060801,"comment_content":"MinMaxScaler: <br>è®°å½•æ•°æ®æ•´ä½“çš„æœ€å¤§&#47;æœ€å°å€¼ä¸ºmax&#47;min, å¯¹äºFeature Eï¼Œè‹¥Emax!=Emin, åˆ™rescaleåå€¼=(Ei - Emin) &#47; (Emax - Emin) * (max - min) + min. è‹¥Emax == Emin, åˆ™rescaleåå€¼=0.5*(min + max). <br><br>Normalizer: <br>å‚è€ƒäº†å…¶ä»–ç•™è¨€æ‰çœ‹æ‡‚äº†ï¼šè¿™æ­¥åšçš„æ˜¯æ­£åˆ™åŒ–ã€‚æ­£åˆ™åŒ–å°†å‘é‡çš„èŒƒæ•°ç¼©æ”¾åˆ°å•ä½1ï¼Œå³å¯å¯¹ã€Œæ ·æœ¬ã€ä¹Ÿå¯å¯¹ã€Œç‰¹å¾ã€ï¼Œæ­¤å¤„æ˜¯å¯¹æ ·æœ¬çš„æ­£åˆ™åŒ–ï¼Œå³æ±‚æ ·æœ¬åœ¨æ‰€æœ‰ç‰¹å¾ä¸‹çš„å–å€¼çš„PèŒƒæ•°(l1, l2). ç”¨é€šä¿—çš„è¯è§£é‡Šï¼Œl1èŒƒæ•°è®¡ç®—çš„æ˜¯æ¯ä¸ªå…ƒç´ åœ¨åŒä¸€æ ·æœ¬çš„æ‰€æœ‰ç‰¹å¾å–å€¼ä¹‹å’Œä¸‹å çš„æ¯”ä¾‹ï¼Œl2èŒƒæ•°è®¡ç®—çš„æ˜¯æ¯ä¸ªå…ƒç´ ä¸Pç»´ç©ºé—´ä¸­æ¬§æ°è·ç¦»çš„æ¯”å€¼ã€‚<br><br>StandardScaler: <br>å¸¸ç”¨çš„æ•°æ®æ ‡å‡†åŒ–æ–¹æ³•ï¼Œå³è®¡ç®—æ ·æœ¬åœ¨æ‰€æœ‰ç‰¹å¾ä¸‹çš„å‡å€¼å’Œæ ‡å‡†å·®ï¼Œç”¨æ•°æ®å‡å‡å€¼ä»¥ä¸­å¿ƒåŒ–ï¼Œå†é™¤ä»¥æ ‡å‡†å·®ä»¥ç¼©æ”¾è‡³å•ä½1. å°±æ˜¯ä¸€ä¸ªæŠŠåˆ†å¸ƒæœªçŸ¥ï¼ˆé€šå¸¸æƒ…å†µä¸‹ï¼‰çš„æ•°æ®æ‹‰å›åˆ°æ­£æ€åˆ†å¸ƒçš„å‡½æ•°ã€‚<br><br>RobustScalerï¼š<br>æ–°å­¦åˆ°çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä¹‹å‰æ²¡ç”¨è¿‡ã€‚å’ŒminmaxScalerç±»ä¼¼ï¼Œå³ä½¿ç”¨å¤§ã€å°å€¼è¿›è¡Œæ•°æ®çš„ç¼©æ”¾ã€‚å…·ä½“ä¸º(x - median) &#47; (localUpper - localLower). å…¶ä¸­çš„localLower, median, localUpperåˆ†åˆ«ä¸ºæ•°æ®çš„ç¬¬ä¸€ã€äºŒã€ä¸‰åˆ†ä½ç‚¹ã€‚åå­—ä¸­å¸¦æœ‰robustï¼Œæ˜¯å¼ºè°ƒç”¨å››åˆ†ä½ç‚¹è€Œéæœ€å¤§æœ€å°å€¼ç­‰æç«¯å€¼å¯ä»¥åŠ å¼ºæ¨¡å‹å¯¹å™ªéŸ³çš„æŠ—å¹²æ‰°åŠ›ã€‚","like_count":3,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507147,"discussion_content":"éå¸¸è¯¦ç»†äº†ï¼Œä¹Ÿæ¨èåœ¨sparkä¸­è‡ªå·±è¿›è¡Œå®è·µã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602871553,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1127918,"avatar":"https://static001.geekbang.org/account/avatar/00/11/35/ee/8ead7a82.jpg","nickname":"176474441","note":"","ucode":"D36BBC03D12EAF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332673,"discussion_content":"æ€ä¹ˆå®è·µå‘¢ï¼Ÿæ˜¯æŸ¥çœ‹å“ªä¸ªsparrowä»£ç çš„ç›¸åº”æ¨¡å—å—ï¼Ÿæˆ‘ä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607305385,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284505,"user_name":"æµ·æ»¨","can_delete":false,"product_type":"c1","uid":1009518,"ip_address":"","ucode":"F1B94D2DB944DC","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/6e/f5ee46e8.jpg","comment_is_top":false,"comment_ctime":1616310316,"is_pvip":true,"replies":[{"id":"103429","content":"æ­£ç¡®ï¼Œèµã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1616637561,"ip_address":"","comment_id":284505,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10206244908","product_id":100060801,"comment_content":"Normalizerï¼Œæ˜¯èŒƒå¼å½’ä¸€åŒ–æ“ä½œï¼Œä¿è¯å½’ä¸€åŒ–ä¹‹åèŒƒå¼ä¸º1<br>StandardScalerï¼Œæ˜¯æ ‡å‡†å·®å½’ä¸€åŒ–æ“ä½œï¼Œä¿è¯å½’ä¸€åŒ–ä¹‹åå‡å€¼ä¸º0æ ‡å‡†å·®ä¸º1<br>RobustScalerï¼Œæ˜¯ä½¿ç”¨åˆ†ä½æ•°è¿›è¡Œé²æ£’å½’ä¸€åŒ–æ“ä½œï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘å¼‚å¸¸å€¼çš„å¹²æ‰°<br>MinMaxScalerï¼Œæ˜¯ä½¿ç”¨æœ€å¤§å€¼å’Œæœ€å°å€¼è¿›è¡Œå½’ä¸€åŒ–æ“ä½œ","like_count":2,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517370,"discussion_content":"æ­£ç¡®ï¼Œèµã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616637561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":258365,"user_name":"æ¸…æ™¨","can_delete":false,"product_type":"c1","uid":1323691,"ip_address":"","ucode":"37545CE235F2E8","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/ye1IU6yGTuKULCqUlNoDCqvRwQ3FbLJHuBNw6l0lTicz4h9IUDH4JOSPyH2KsKzAEqznhdO29JB4OsibEdUjxl2Q/132","comment_is_top":false,"comment_ctime":1604398346,"is_pvip":false,"replies":[{"id":"94117","content":"æ”¹å˜çš„æ˜¯ç‰¹å¾çš„åˆ†å¸ƒï¼Œä¸ºäº†è®©ç‰¹å¾çš„åŒºåˆ†åº¦æ›´é«˜ï¼Œè®©æ¨¡å‹æ›´å¥½çš„æ•æ‰ç‰¹å¾ä¸­åŒ…å«çš„æœ‰ä»·å€¼ä¿¡æ¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1604464342,"ip_address":"","comment_id":258365,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10194332938","product_id":100060801,"comment_content":"standscalar ä¸æ˜¯æ”¹å˜äº†æ•°æ®çš„åˆ†å¸ƒå— å¤„ç†åçš„ç‰¹å¾ä¸ºå‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1 ä¸ºä»€ä¹ˆè¯´æ²¡æœ‰å‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508634,"discussion_content":"æ”¹å˜çš„æ˜¯ç‰¹å¾çš„åˆ†å¸ƒï¼Œä¸ºäº†è®©ç‰¹å¾çš„åŒºåˆ†åº¦æ›´é«˜ï¼Œè®©æ¨¡å‹æ›´å¥½çš„æ•æ‰ç‰¹å¾ä¸­åŒ…å«çš„æœ‰ä»·å€¼ä¿¡æ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1604464342,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252818,"user_name":"smjccj","can_delete":false,"product_type":"c1","uid":1802329,"ip_address":"","ucode":"F1970D00C8E3B1","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/GomQuKMYYNX7aMCNt4Ut8YyBrzVM71fgly5l1jykTFic8iaqCTG5ELnsIqlhwgG7ibCCxpODn6PzfVaSicrDub6t5Q/132","comment_is_top":false,"comment_ctime":1602493696,"is_pvip":false,"replies":[{"id":"92478","content":"èµ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602634230,"ip_address":"","comment_id":252818,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10192428288","product_id":100060801,"comment_content":"Normalizerï¼š è½¬åŒ–ä¸ºæ–¹å·®ä¸º1ï¼Œä¸å½±å“æ•°æ®åˆ†å¸ƒ<br>StandardScalerï¼š å°†æ•°æ®è½¬åŒ–ä¸º variance= 1ï¼Œmean =0(unit variance and&#47;or zero mean)<br>RobustScalerï¼š ä¸­ä½æ•°æˆ–å››åˆ†ä½æ•°è¿›è¡Œç¼©æ”¾ï¼Œå¤„ç†å¼‚å¸¸å€¼å¸¦æ¥çš„å½±å“<br>MinMaxScaler: å°†ç‰¹å¾ç¼©æ”¾è‡³0-1ä¹‹é—´","like_count":2,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506881,"discussion_content":"èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602634230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2527743,"avatar":"https://static001.geekbang.org/account/avatar/00/26/91/ff/aa5e573a.jpg","nickname":"ç‰›ç‰ªçŠ‡","note":"","ucode":"007A5E511EA243","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":359238,"discussion_content":"è§‰å¾—mormalizerè¿˜æ˜¯æ”¹å˜äº†ç‰¹å¾(çºµå‘)çš„åˆ†å¸ƒï¼Œé™¤éæ¨ªå‘å‘é‡çš„æ¨¡éƒ½ä¸€æ ·ï¼Œä½†å®é™…ä¸­æ¯è¡Œçš„é™¤æ•°ä¸å®Œå…¨ä¸€æ ·","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1616147722,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":326923,"user_name":"LEIBER","can_delete":false,"product_type":"c1","uid":2836458,"ip_address":"","ucode":"6310F3F6DF3295","user_header":"https://static001.geekbang.org/account/avatar/00/2b/47/ea/d2924633.jpg","comment_is_top":false,"comment_ctime":1639753225,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5934720521","product_id":100060801,"comment_content":"ç†è®ºéƒ¨åˆ†éƒ½æ‡‚ï¼Œçœ‹ä»£ç å°±æ‡µäº†ï¼Œæ²¡å­¦è¿‡scalaï¼Œä¹Ÿä¸äº†è§£ç¯å¢ƒåº”è¯¥æ€ä¹ˆé…","like_count":1},{"had_liked":false,"id":291536,"user_name":"liput","can_delete":false,"product_type":"c1","uid":1057683,"ip_address":"","ucode":"CCCF7D7D17C870","user_header":"https://static001.geekbang.org/account/avatar/00/10/23/93/d6cd8897.jpg","comment_is_top":false,"comment_ctime":1620352775,"is_pvip":false,"replies":[{"id":"105682","content":"ç°åœ¨ç‰¹å¾æ›´æ–°ä¸€èˆ¬éƒ½ä¼šæ”¾åœ¨æµå¹³å°ä¸Šï¼ŒåŸºæœ¬ä¿è¯onlineå’Œofflineä¸€è‡´ã€‚<br><br>åœ¨ç¦»çº¿è®­ç»ƒé˜¶æ®µï¼Œå¦‚æœæ— æ³•å¤ç”¨onlineè®¡ç®—ç‰¹å¾çš„ä»£ç çš„è¯ï¼Œä¹Ÿä¸€å®šè¦ä¿è¯äºŒè€…çš„é€»è¾‘æ˜¯ä¸€æ ·çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1620582675,"ip_address":"","comment_id":291536,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5915320071","product_id":100060801,"comment_content":"è¯·é—®è€å¸ˆï¼Œçœ‹åˆ°è¯¾ç¨‹é‡Œé¢ç‰¹å¾æ„é€ éƒ½æ˜¯åœ¨offlineæ‰¹é‡è®¡ç®—å¾—åˆ°ç‰¹å¾ï¼Œè€Œåœ¨onlineå†å¦å¤–è®¡ç®—ç‰¹å¾ï¼Œè¿™é‡Œç»å¸¸ä¼šå‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µã€‚æƒ³é—®ä¸‹ï¼Œåœ¨å·¥ä¸šå®è·µä¸­ï¼Œæœ‰ä»€ä¹ˆå¥½çš„æ–¹æ³•å»ä¿è¯è¿™ä¸¤ä¸ªåœ°æ–¹çš„ä¸€è‡´æ€§å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519500,"discussion_content":"ç°åœ¨ç‰¹å¾æ›´æ–°ä¸€èˆ¬éƒ½ä¼šæ”¾åœ¨æµå¹³å°ä¸Šï¼ŒåŸºæœ¬ä¿è¯onlineå’Œofflineä¸€è‡´ã€‚\n\nåœ¨ç¦»çº¿è®­ç»ƒé˜¶æ®µï¼Œå¦‚æœæ— æ³•å¤ç”¨onlineè®¡ç®—ç‰¹å¾çš„ä»£ç çš„è¯ï¼Œä¹Ÿä¸€å®šè¦ä¿è¯äºŒè€…çš„é€»è¾‘æ˜¯ä¸€æ ·çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620582675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1206147,"avatar":"https://static001.geekbang.org/account/avatar/00/12/67/83/2150e0e0.jpg","nickname":"longhx","note":"","ucode":"581A3BD20D7A04","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":380920,"discussion_content":"ä¸ºä»€ä¹ˆç‰¹å¾æ›´æ–°æ”¾åœ¨æµå¹³å°ä¸Šï¼ŒåŸºæœ¬ä¿è¯onlineå’Œofflineä¸€è‡´äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624795335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290424,"user_name":"diuä½ å¤´å‘æ‰å±å¹•ä¸Šäº†","can_delete":false,"product_type":"c1","uid":2131165,"ip_address":"","ucode":"69E2D5EAD8B50C","user_header":"https://static001.geekbang.org/account/avatar/00/20/84/dd/a9265141.jpg","comment_is_top":false,"comment_ctime":1619535834,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5914503130","product_id":100060801,"comment_content":"ä¸ºä»€ä¹ˆè¿è¡ŒFeatureEngineering.scalaæ˜¯æ­£å¸¸çš„ï¼Œè¿è¡ŒFeatureEngineering.pyä»æ˜¾ç¤ºMultiHotEncoderçš„æ—¶å€™å°±å¼€å§‹æŠ¥é”™äº†ï¼Œè¯´python worker failed to connect back.","like_count":1,"discussions":[{"author":{"id":2660352,"avatar":"https://static001.geekbang.org/account/avatar/00/28/98/00/dfb9251d.jpg","nickname":"æ‘å£ç‹å¸ˆå‚…","note":"","ucode":"F9B84DF46C6224","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386723,"discussion_content":"è¯·é—®æœ‰è§£å†³å—","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627743745,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2615846,"avatar":"https://static001.geekbang.org/account/avatar/00/27/ea/26/e9ad3982.jpg","nickname":"zhy","note":"","ucode":"139912B4799EA6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373510,"discussion_content":"åŒé—®","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620751008,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284100,"user_name":"Geek_71fed1","can_delete":false,"product_type":"c1","uid":2527569,"ip_address":"","ucode":"526351F33FADC9","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/5EgbE7BFRtWHIchE5eCoaXFX4RWxg3iblIbC8G9X2cV4sYlW9qCib1sMiaJusda6p3L5UUq8aoUfOPU1QSia7caibqA/132","comment_is_top":false,"comment_ctime":1616063519,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5911030815","product_id":100060801,"comment_content":"pysparkçš„å®ç°<br>def oneHotEncoderExample(samples):<br>    #ä½¿ç”¨WithColumnå¯ä»¥ä¸ºDataFrameå¢åŠ æ–°åˆ—<br>    #castå¼ºåˆ¶ç±»å‹è½¬æ¢<br>    samplesWithIdNumber = samples.withColumn(&quot;movieIdNumber&quot;,col(&quot;movieId&quot;).cast(&quot;int&quot;))<br>    #åˆ›å»ºonehotç¼–ç å™¨<br>    oneHotEncoder1 = OneHotEncoder().setInputCol(&quot;movieIdNumber&quot;).setOutputCol(&quot;movieIdVector&quot;).setDropLast(False)<br>    #è®­ç»ƒonehotç¼–ç å™¨ï¼Œï¼Œtransformè½¬æ¢<br>    oneHotEncoderSamples= oneHotEncoder1.transform(samplesWithIdNumber)<br>    #æ‰“å°æ•°æ®ç»“æ„<br>    oneHotEncoderSamples.printSchema()<br>    oneHotEncoderSamples.show(10)<br><br><br>double2vec= udf(lambda value:Vectors.dense(value),VectorUDT())<br><br>def ratingFeatures(samples):<br>    #samples.printSchema()<br>    #samples.show()<br>    #è®¡ç®—æ•°å€¼ç‰¹å¾<br>    movieFeatures = samples.groupBy(col(&quot;movieId&quot;)).\\<br>      agg(count(lit(1)).alias(&quot;ratingCount&quot;),\\<br>        avg(col(&quot;rating&quot;)).alias(&quot;avgRating&quot;),\\<br>        variance(col(&quot;rating&quot;)).alias(&quot;ratingVar&quot;)).\\<br>        withColumn(&quot;avgRatingVec&quot;, double2vec(col(&quot;avgRating&quot;)))<br>    #movieFeatures.show()<br>    <br>    #åˆ†æ¡¶<br>    ratignCountDiscretizer = QuantileDiscretizer().setNumBuckets(100).setInputCol(&quot;ratingCount&quot;).setOutputCol(&quot;ratingCountBucket&quot;)<br>    #å½’ä¸€åŒ–<br>    ratingScaler = MinMaxScaler().setMin(5).setMax(10).setInputCol(&quot;avgRatingVec&quot;).setOutputCol(&quot;scaleAvgRating&quot;)<br>    <br>    piplinestage=[ratignCountDiscretizer,ratingScaler]<br>    featurpipeline = Pipeline().setStages(piplinestage)<br>    movieProcessedFeatures=featurpipeline.fit(movieFeatures).transform(movieFeatures)<br>    movieProcessedFeatures.show(10)","like_count":1},{"had_liked":false,"id":280881,"user_name":"é™ˆå¨æ´‹","can_delete":false,"product_type":"c1","uid":2264679,"ip_address":"","ucode":"DCF84B4D3A7354","user_header":"https://static001.geekbang.org/account/avatar/00/22/8e/67/afb412fb.jpg","comment_is_top":false,"comment_ctime":1614435929,"is_pvip":false,"replies":[{"id":"102026","content":"è¿™ä¸ªå¯ä»¥è‡ªå·±å»æŸ¥ä¸€æŸ¥sparkçš„æ–‡æ¡£æˆ–è€…æºç ï¼Œç±»ä¼¼çš„ç»†èŠ‚é—®é¢˜æ¯”è¾ƒå¤šï¼Œè¿˜æ˜¯è‡ªå·±æŸ¥ä¸€æŸ¥æ¯”è¾ƒå¥½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1614563816,"ip_address":"","comment_id":280881,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5909403225","product_id":100060801,"comment_content":"è€å¸ˆï¼Œæ™šä¸Šå¥½ï¼~ è¯·é—®ä¸€ä¸ªé—®é¢˜å“¦ï¼Œæˆ‘ä½¿ç”¨multiHotEncoderExample()å‡½æ•°ç”Ÿæˆçš„æ–°çš„è¡¨ï¼Œè¡¨ä¸­æœ‰ä¸€ä¸ªå­—æ®µï¼šindexSizeï¼Œè¿™ä¸ªå­—æ®µæè¿°æ˜¯ä»€ä¹ˆæ•°æ®ï¼Ÿæ€ä¹ˆæ¥çš„ï¼ŸæœŸå¾…è€å¸ˆçš„å›ç­”~^^","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516232,"discussion_content":"è¿™ä¸ªå¯ä»¥è‡ªå·±å»æŸ¥ä¸€æŸ¥sparkçš„æ–‡æ¡£æˆ–è€…æºç ï¼Œç±»ä¼¼çš„ç»†èŠ‚é—®é¢˜æ¯”è¾ƒå¤šï¼Œè¿˜æ˜¯è‡ªå·±æŸ¥ä¸€æŸ¥æ¯”è¾ƒå¥½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614563816,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2264679,"avatar":"https://static001.geekbang.org/account/avatar/00/22/8e/67/afb412fb.jpg","nickname":"é™ˆå¨æ´‹","note":"","ucode":"DCF84B4D3A7354","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352057,"discussion_content":"å¥½çš„ğŸ‘Œ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614585269,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":278608,"user_name":"Geek_36ba7d","can_delete":false,"product_type":"c1","uid":2418524,"ip_address":"","ucode":"DBF706B842171E","user_header":"","comment_is_top":false,"comment_ctime":1613127277,"is_pvip":false,"replies":[{"id":"101384","content":"æœ¬è´¨ä¸Šæ¥è¯´åªè¦ä½ èƒ½æå–å‡ºä½ è¦çš„featureï¼Œä½ ç”¨ä»€ä¹ˆå·¥å…·éƒ½å¯ä»¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1613529015,"ip_address":"","comment_id":278608,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5908094573","product_id":100060801,"comment_content":"ç”¨ESæ¥ä»£æ›¿sparkå¯ä»¥å—ï¼Ÿä¸€ä¸ªç‰¹å¾å°±æ˜¯ESé‡Œå¾—keywordå‘—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":515445,"discussion_content":"æœ¬è´¨ä¸Šæ¥è¯´åªè¦ä½ èƒ½æå–å‡ºä½ è¦çš„featureï¼Œä½ ç”¨ä»€ä¹ˆå·¥å…·éƒ½å¯ä»¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1613529015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1461122,"avatar":"https://static001.geekbang.org/account/avatar/00/16/4b/82/5be29abf.jpg","nickname":"è€å”å”å®‰æ£®","note":"","ucode":"EF61ACAC9A44FE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377270,"discussion_content":"esèƒ½è®¡ç®—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622564789,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277015,"user_name":"cymx66688","can_delete":false,"product_type":"c1","uid":1510592,"ip_address":"","ucode":"8198B851961BC7","user_header":"https://wx.qlogo.cn/mmopen/vi_32/TYeIuNZlibjr0eCvnCCTkYnFEgc8t7BialET3Bnsrbv9micpGIvbhwQrw7Zvt9BicThAEPPXojibVteAvQLb0eTO3DA/132","comment_is_top":false,"comment_ctime":1612233090,"is_pvip":false,"replies":[{"id":"100804","content":"å®è¯è¯´ï¼Œæˆ‘è¿˜çœŸæ²¡ç ”ç©¶è¿™ä¹ˆç»†ï¼Œå¯ä»¥çœ‹ä¸€çœ‹sparkæºç åˆ°åº•æ˜¯æ€ä¹ˆåšonehotencodingçš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1612594922,"ip_address":"","comment_id":277015,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5907200386","product_id":100060801,"comment_content":"OneHotä»£ç ä¸­setDropLast(false)è®©1000åˆ—å­—æ®µå˜æˆäº†1001åˆ—ï¼ŒæŒ‰ç†è¯´ä¸åº”è¯¥æ˜¯åˆ é™¤æœ€åä¸€åˆ—ä¸º999åˆ—å—ï¼Ÿæ–°å¢çš„ä¸€åˆ—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ<br>val oneHotEncoder = new OneHotEncoderEstimator()<br>      .setInputCols(Array(&quot;movieIdNumber&quot;))<br>      .setOutputCols(Array(&quot;movieIdVector&quot;))<br>      .setDropLast(false)","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514901,"discussion_content":"å®è¯è¯´ï¼Œæˆ‘è¿˜çœŸæ²¡ç ”ç©¶è¿™ä¹ˆç»†ï¼Œå¯ä»¥çœ‹ä¸€çœ‹sparkæºç åˆ°åº•æ˜¯æ€ä¹ˆåšonehotencodingçš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612594922,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2369593,"avatar":"https://static001.geekbang.org/account/avatar/00/24/28/39/7e184c50.jpg","nickname":"Jimmy","note":"","ucode":"6D245FAF932C24","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":372491,"discussion_content":"è¿™é‡Œè¯´ä¸€ä¸‹ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š\n1.ä¸ºå•¥æ˜¯1001\n2.dropLastæœ‰å•¥ç”¨\nå…ˆå›ç­”1ï¼Œä¸æ˜¯å› ä¸ºæœ‰1000éƒ¨ç”µå½±ï¼Œæ‰€ä»¥idæ‰ä¸ºå¤šå°‘ï¼Œè€Œæ˜¯ä»£ç ä¸­ç›´æ¥è¯»å–äº†movieIdä½œä¸ºè¿™ä¸ªå€¼ï¼Œä½ æŠŠ/webroot/sampledata/movies.csvçš„idæŸä¸€ä¸ªæ”¹æˆ1998ï¼Œä½ ä¼šå‘ç°æ˜¯1999ï¼ˆå› ä¸º0-1998ï¼‰ï¼Œï¼Œï¼Œæ‰€ä»¥ï¼ŒåŸå§‹æ•°æ®æ˜¯1-1000ï¼Œç›´æ¥ç”¨idå°±æ˜¯0-1000\nå†å›ç­”dropå¹²å•¥äº†ï¼Œè¿™é‡Œæ²¡æœ‰dropï¼Œæ‰€ä»¥æ˜¯åŸå§‹çš„ï¼Œæˆ‘ä»¬æŠŠåˆ—å‡ä¸º2ï¼Œæ¯”å¦‚ï¼šç”·å¥³ï¼Œå…¶å®è™½ç„¶æœ‰ä¸¤ç±»ï¼Œä½†ä»–ä»¬äº’æ–¥ï¼Œæ‰€ä»¥å¸¸è§„ä¸‹ï¼Œè¿™ç§ä¸¤ç±»æ˜¯ä¸€åˆ—å°±å¥½ã€‚ã€‚ã€‚æ‰©å±•ä¸€ä¸‹ï¼Œå¯¹äº5åˆ†ç±»çš„äº’æ–¥å˜é‡ï¼Œ4åˆ—ä¹Ÿå¤Ÿäº†ï¼ˆå› ä¸ºäº’æ–¥ï¼Œæˆ‘çœ‹åˆ°å‰é¢4åˆ—èƒ½æ¨æ–­æœ€åä¸€åˆ—ï¼Œï¼Œä¹Ÿå°±æ˜¯ä¿¡æ¯åŒ…å«åœ¨å‰é¢é‡Œé¢ï¼Œlastæ²¡å¿…è¦äº†ï¼‰","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1620354964,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":270816,"user_name":"å“åˆ«æ—å…ˆæ£®","can_delete":false,"product_type":"c1","uid":2198724,"ip_address":"","ucode":"253A52EF861BF3","user_header":"https://static001.geekbang.org/account/avatar/00/21/8c/c4/aba3ee31.jpg","comment_is_top":false,"comment_ctime":1609289405,"is_pvip":false,"replies":[{"id":"98282","content":"ä½ è¯´çš„ç‰¹å¾è´¨é‡ï¼Œç›‘æ§æˆ‘è§‰å¾—æ›´å¤šçš„æ˜¯å®è·µå’Œå·¥ç¨‹é—®é¢˜ã€‚ä¸ä¼šæœ‰ä¸€ä¸ªæ–¹æ³•è®ºå»æŒ‡å¯¼ï¼Œæ‰€ä»¥æˆ‘çš„å»ºè®®æ˜¯è‡ªå·±çš„å·¥ä½œä¸­å¤šæ€è€ƒå¤šæ€»ç»“ï¼Œå¤šè·ŸåŒäº‹è®¨è®ºè§£å†³æ–¹æ¡ˆã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1609355034,"ip_address":"","comment_id":270816,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5904256701","product_id":100060801,"comment_content":"ç‹è€å¸ˆæ‚¨å¥½ï¼Œå…³äºæ¨èç³»ç»Ÿ ç‰¹å¾çš„è¡ç”Ÿï¼Œåº”ç”¨æ‚¨éƒ½è®²å¾ˆç»†è‡´ï¼Œç‰¹å¾å†³å®šäº†æ•´ä¸ªæ¨èç³»ç»Ÿçš„æ¨èæ•ˆæœçš„é«˜åº¦ï¼Œè‡³å…³é‡è¦ã€‚æ‰€ä»¥ç‰¹å¾çš„è´¨é‡ä¹Ÿå°¤ä¸ºé‡è¦ï¼Œè¯·é—®æœ‰å…³äºç‰¹å¾è´¨é‡ï¼Œç›‘æ§æ–¹é¢çš„æ¯”è¾ƒå¥½çš„èµ„æ–™æ¨èå—ï¼Œè°¢è°¢äº†ã€‚","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512762,"discussion_content":"ä½ è¯´çš„ç‰¹å¾è´¨é‡ï¼Œç›‘æ§æˆ‘è§‰å¾—æ›´å¤šçš„æ˜¯å®è·µå’Œå·¥ç¨‹é—®é¢˜ã€‚ä¸ä¼šæœ‰ä¸€ä¸ªæ–¹æ³•è®ºå»æŒ‡å¯¼ï¼Œæ‰€ä»¥æˆ‘çš„å»ºè®®æ˜¯è‡ªå·±çš„å·¥ä½œä¸­å¤šæ€è€ƒå¤šæ€»ç»“ï¼Œå¤šè·ŸåŒäº‹è®¨è®ºè§£å†³æ–¹æ¡ˆã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609355034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269304,"user_name":"Geek_99db42","can_delete":false,"product_type":"c1","uid":1628882,"ip_address":"","ucode":"4B02EF0E0B1C58","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DPAiarROoO4JCGLRjyNefCicAZYepFickI1nOyKb6lz476tlYe1S6n5k7iaeicK0AOGn2AAJCvn7qBO8Zp98tDtM4zQ/132","comment_is_top":false,"comment_ctime":1608607113,"is_pvip":false,"replies":[{"id":"97716","content":"2147483647æ˜æ˜¾æ˜¯32ä½integerçš„ä¸Šé™ï¼Œè¦ä¹ˆæ˜¯ä½ çš„idè¿‡å¤§ï¼Œè¶…è¿‡äº†è¿™ä¸ªä¸Šé™ï¼Œè¦ä¹ˆæ˜¯å“ªæœ‰ä¸€äº›éšè—çš„bugã€‚ä½†onehot encoderæœ‰å¯èƒ½çœŸçš„åªæ”¯æŒ32ä½integerã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1608665870,"ip_address":"","comment_id":269304,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5903574409","product_id":100060801,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªå…¶ä»–æ•°æ®é›†ï¼Œè¿™ä¸ªæ•°æ®é›†çš„IDæ¯”è¾ƒå¤§ï¼Œåœ¨åšOneHotæ—¶å‡ºç°äº† OneHotEncoder only supports up to 2147483647 çš„é”™è¯¯ï¼Œè¯·é—®å¯¹äºè¿™ç§æƒ…å†µè¯¥å¦‚ä½•å¤„ç†ï¼Œé€šè¿‡è°·æ­Œæ²¡æœ‰æ‰¾åˆ°å¥½çš„è§£å†³æ–¹æ³•ï¼Œä¹Ÿè®¸æ˜¯æœç´¢çš„æ–¹æ³•æœ‰é”™è¯¯","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512227,"discussion_content":"2147483647æ˜æ˜¾æ˜¯32ä½integerçš„ä¸Šé™ï¼Œè¦ä¹ˆæ˜¯ä½ çš„idè¿‡å¤§ï¼Œè¶…è¿‡äº†è¿™ä¸ªä¸Šé™ï¼Œè¦ä¹ˆæ˜¯å“ªæœ‰ä¸€äº›éšè—çš„bugã€‚ä½†onehot encoderæœ‰å¯èƒ½çœŸçš„åªæ”¯æŒ32ä½integerã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1608665870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":259402,"user_name":"æµå¹´ä¸æµæ¢¦","can_delete":false,"product_type":"c1","uid":1061242,"ip_address":"","ucode":"980EB734E2A058","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/FnAia4oNWqvspqYZ8LxpUMh3J6oDxZHR6N8hut8HnywonBaP06dQkwFcqzslPTkMpqzlyDJ3vuOvwmUMx07psoQ/132","comment_is_top":false,"comment_ctime":1604718608,"is_pvip":false,"replies":[{"id":"95560","content":"æ²¡æœ‰å¿…è¦","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1606115380,"ip_address":"","comment_id":259402,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5899685904","product_id":100060801,"comment_content":"è€å¸ˆå¥½ï¼Œæƒ³é—®ä¸‹åˆ†æ¡¶åçš„ç‰¹å¾è¿˜æœ‰å¿…è¦åšç‰¹å¾å½’ä¸€åŒ–å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":508929,"discussion_content":"æ²¡æœ‰å¿…è¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606115380,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252863,"user_name":"Geek_63ee39","can_delete":false,"product_type":"c1","uid":2202096,"ip_address":"","ucode":"A41379ADD76480","user_header":"https://static001.geekbang.org/account/avatar/00/21/99/f0/ba3c0208.jpg","comment_is_top":false,"comment_ctime":1602503732,"is_pvip":false,"replies":[{"id":"92475","content":"æ˜¯è¿™æ ·ï¼Œå¸Œæœ›å¤§å®¶éƒ½èƒ½è¿è¡Œç¨‹åºæŸ¥çœ‹ä¸€ä¸‹æ•°æ®ç»†èŠ‚ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602634105,"ip_address":"","comment_id":252863,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5897471028","product_id":100060801,"comment_content":"æ€è€ƒ2ï¼šmovieIdVectoræ˜¯å¤„ç†å¥½çš„One-hot ç‰¹å¾ï¼›vectoræ˜¯å¤„ç†å¥½çš„Multi-hot ç‰¹å¾ï¼›è¿™ä¸¤ä¸ªç‰¹å¾æ˜¯ä½¿ç”¨Vectorè¡¨ç¤ºçš„","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506902,"discussion_content":"æ˜¯è¿™æ ·ï¼Œå¸Œæœ›å¤§å®¶éƒ½èƒ½è¿è¡Œç¨‹åºæŸ¥çœ‹ä¸€ä¸‹æ•°æ®ç»†èŠ‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602634105,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":252836,"user_name":"å´æ³¢","can_delete":false,"product_type":"c1","uid":2112775,"ip_address":"","ucode":"3739A695E1357D","user_header":"https://static001.geekbang.org/account/avatar/00/20/3d/07/e2fffa6a.jpg","comment_is_top":false,"comment_ctime":1602497932,"is_pvip":false,"replies":[{"id":"92477","content":"åº”è¯¥æ˜¯ç¯å¢ƒé—®é¢˜é€ æˆçš„ä¸ªä¾‹ã€‚å»ºè®®è‡ªå·±debugä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602634218,"ip_address":"","comment_id":252836,"utype":1}],"discussion_count":8,"race_medal":0,"score":"5897465228","product_id":100060801,"comment_content":"æƒ³é—®ä¸‹ä¸ºä»€ä¹ˆå³é”®è¿è¡ŒFeatureEngineeringä¼šæŠ¥é”™ï¼Œæç¤º é”™è¯¯: æ‰¾ä¸åˆ°æˆ–æ— æ³•åŠ è½½ä¸»ç±» com.wzhe.sparrowrecsys.offline.spark.featureeng.FeatureEngineering<br>","like_count":1,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506887,"discussion_content":"åº”è¯¥æ˜¯ç¯å¢ƒé—®é¢˜é€ æˆçš„ä¸ªä¾‹ã€‚å»ºè®®è‡ªå·±debugä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602634218,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1308552,"avatar":"https://static001.geekbang.org/account/avatar/00/13/f7/88/da243c77.jpg","nickname":"å¤§é­”ç‹","note":"","ucode":"5EB049D18E122F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":311855,"discussion_content":"scalaç‰ˆæœ¬é—®é¢˜","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1602507419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2670260,"avatar":"https://static001.geekbang.org/account/avatar/00/28/be/b4/5091b607.jpg","nickname":"ç›´è¡Œæ ¼å­","note":"","ucode":"D24E6925E34177","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381929,"discussion_content":"å“æˆ‘ç»ˆäºè§£å†³äº†ã€‚æ‰€æœ‰çš„é…ç½®éƒ½å¼„å¥½è¿˜ä¼šæŠ¥é”™ï¼Œéœ€è¦åœ¨ pom æ–‡ä»¶çš„ build é‡ŒåŠ å…¥ä¸‹é¢è¿™ä¸€æ®µæ‰èƒ½è¿è¡Œï¼š\n             <plugin>\n                <groupId>org.scala-tools</groupId>\n                <artifactId>maven-scala-plugin</artifactId>\n                <version>2.11</version>\n                <executions>\n                    <execution>\n                        <goals>\n                            <goal>compile</goal>\n                        </goals>\n                    </execution>\n                </executions>\n            </plugin>","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625301934,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2670260,"avatar":"https://static001.geekbang.org/account/avatar/00/28/be/b4/5091b607.jpg","nickname":"ç›´è¡Œæ ¼å­","note":"","ucode":"D24E6925E34177","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381889,"discussion_content":"è€å¸ˆèƒ½ä¸èƒ½å‡ºä¸ªè¯¦ç»†äº›çš„æ•™ç¨‹ï¼Ÿä¸è¦è®©äººåœ¨é…ç½®ç¯å¢ƒä¸Šå¡è¿™ä¹ˆä¹…ï¼Ÿå®æˆ˜è¯¾ç¨‹æ€ä¹ˆé…ç½®ç¯å¢ƒä¸€ä¸¤å¥è¯å¸¦è¿‡ï¼Œé»˜è®¤å¤§å®¶éƒ½æ˜¯ç²¾é€š java+scala+python çš„å˜›ï¼Ÿï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625280170,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1877078,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/a4/56/29a05cb2.jpg","nickname":"Kepler","note":"","ucode":"C69A3248FB1AF6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351266,"discussion_content":"åº”è¯¥æ˜¯é¡¹ç›®æ²¡æœ‰è½½å…¥scalaï¼Œå¯ä»¥File -> Project Structure -> Libraries -> ï¼‹ -> é€‰æ‹©scalaè½½å…¥ï¼Œ Applyåé‡å¯IntelliJå³å¯ã€‚æœ¬äººé€‚ç”¨ï¼Œä¾›å¤§å®¶ä¼™å‚è€ƒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614220438,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2670260,"avatar":"https://static001.geekbang.org/account/avatar/00/28/be/b4/5091b607.jpg","nickname":"ç›´è¡Œæ ¼å­","note":"","ucode":"D24E6925E34177","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1877078,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/a4/56/29a05cb2.jpg","nickname":"Kepler","note":"","ucode":"C69A3248FB1AF6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381859,"discussion_content":"æ²¡è§£å†³ã€‚ã€‚ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1625242353,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":351266,"ip_address":""},"score":381859,"extra":""}]},{"author":{"id":2203465,"avatar":"https://static001.geekbang.org/account/avatar/00/21/9f/49/babad2a9.jpg","nickname":"ç©º","note":"","ucode":"D3CA6DB61E7393","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":314507,"discussion_content":"æˆ‘ä¹Ÿå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œè¯·é—®æ€ä¹ˆè§£å†³çš„æ¬¸","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603164187,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1952248,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/c9/f8/72955ef9.jpg","nickname":"æµ£ç†Šå½“å®¶","note":"","ucode":"939F06050423E4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312762,"discussion_content":"è¯·é—®æœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆå—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602811387,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":348469,"user_name":"é‡‘å®£","can_delete":false,"product_type":"c1","uid":2448287,"ip_address":"","ucode":"9CDB027E9F7874","user_header":"https://static001.geekbang.org/account/avatar/00/25/5b/9f/c6c20349.jpg","comment_is_top":false,"comment_ctime":1655121553,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1655121553","product_id":100060801,"comment_content":"scalaçš„è¿è¡Œæ–¹å¼ï¼ˆlinuxï¼‰<br>1. å®‰è£…scalaã€sparkã€hadoop<br>cs install scala:2.11.12 &amp;&amp; cs install scalac:2.11.12<br>wget https:&#47;&#47;archive.apache.org&#47;dist&#47;spark&#47;spark-2.4.3&#47;spark-2.4.3-bin-hadoop2.7.tgz<br>wget https:&#47;&#47;archive.apache.org&#47;dist&#47;hadoop&#47;common&#47;hadoop-2.7.7&#47;hadoop-2.7.7.tar.gz<br>tar xzf spark-2.4.3-bin-hadoop2.7.tgz<br>tar xzf hadoop-2.7.7.tar.gz<br>2. é…ç½®ç¯å¢ƒå˜é‡<br>export SPARK_HOME=$PWD&#47;spark-2.4.3-bin-hadoop2.7<br>export HADOOP_HOME=$PWD&#47;hadoop-2.7.7<br>3. åˆ›å»ºå¦‚ä¸‹ç›®å½•ç»“æ„<br>.&#47;build.sbt<br>.&#47;src<br>.&#47;src&#47;main<br>.&#47;src&#47;main&#47;scala<br>.&#47;src&#47;main&#47;scala&#47;FeatureEngineering.scala<br>build.sbtå†…å®¹ä¸ºï¼š<br>name := &quot;SparrowRec&quot;<br>version := &quot;1.0&quot;<br>scalaVersion := &quot;2.11.12&quot;<br>libraryDependencies += &quot;org.apache.spark&quot; %% &quot;spark-sql&quot; % &quot;2.4.3&quot;<br>libraryDependencies += &quot;org.apache.spark&quot; %% &quot;spark-mllib&quot; % &quot;2.4.3&quot;<br>4. ç¼–è¯‘<br>sbt clean package<br>5. è¿è¡Œ<br>spark-submit --class &quot;FeatureEngineering&quot; --master local[4] target&#47;scala-2.11&#47;sparrowrecspark_2.11-1.0.jar","like_count":1},{"had_liked":false,"id":345837,"user_name":"æ˜Ÿæ™´","can_delete":false,"product_type":"c1","uid":2195455,"ip_address":"","ucode":"F748EC40E922CF","user_header":"https://static001.geekbang.org/account/avatar/00/21/7f/ff/0b2adf91.jpg","comment_is_top":false,"comment_ctime":1652623685,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1652623685","product_id":100060801,"comment_content":"è¯·é—®è€å¸ˆï¼š<br>Normalizerã€StandardScalerã€RobustScalerã€MinMaxScaler è¿™ä¸ªå‡ ä¸ªç‰¹å¾å¤„ç†æ–¹æ³•åˆ†åˆ«åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨å‘¢ï¼Ÿ","like_count":0},{"had_liked":false,"id":334354,"user_name":"Calmness","can_delete":false,"product_type":"c1","uid":2885368,"ip_address":"","ucode":"60CC8C3366C3D0","user_header":"https://static001.geekbang.org/account/avatar/00/2c/06/f8/9f6d64bd.jpg","comment_is_top":false,"comment_ctime":1644896334,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644896334","product_id":100060801,"comment_content":"ä»£ç é‡Œä¸ºä»€ä¹ˆæ˜¯å¯¹æ‰“åˆ†æ¬¡æ•°åˆ†æ¡¶ï¼Œå¹³å‡åˆ†å½’ä¸€åŒ–å•Šï¼Ÿæ˜¯ä¸æ˜¯å†™åäº†ï¼Ÿ","like_count":0},{"had_liked":false,"id":326300,"user_name":"é™å¿ƒ","can_delete":false,"product_type":"c1","uid":1335457,"ip_address":"","ucode":"EB264FA6519FDA","user_header":"https://static001.geekbang.org/account/avatar/00/14/60/a1/8f003697.jpg","comment_is_top":false,"comment_ctime":1639464043,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1639464043","product_id":100060801,"comment_content":"å¦‚æœæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š<br>python FeatureEngineering.py<br><br>å‘ç”Ÿå¦‚ä¸‹é”™è¯¯ï¼š<br>Traceback (most recent call last):<br>  File &quot;FeatureEngineering.py&quot;, line 3, in &lt;module&gt;<br>    from pyspark.ml.feature import OneHotEncoderEstimator, StringIndexer, QuantileDiscretizer, MinMaxScaler<br>ImportError: cannot import name OneHotEncoderEstimator<br><br>æ˜¯å› ä¸ºOneHotEncoderEstimatoråœ¨æ–°ç‰ˆæœ¬pysparkä¸­å·²ç»è¢«é‡å‘½ä»¤ä¸ºäº†OneHotEncoderã€‚<br>","like_count":0},{"had_liked":false,"id":321518,"user_name":"m-rui","can_delete":false,"product_type":"c1","uid":2829048,"ip_address":"","ucode":"75C9CBB9580C88","user_header":"https://static001.geekbang.org/account/avatar/00/2b/2a/f8/1af3bba6.jpg","comment_is_top":false,"comment_ctime":1636935082,"is_pvip":false,"replies":[{"id":"116815","content":"ä¾‹å­ä¸­çš„åˆ†æ¡¶æ–¹æ³•å¤„ç†çš„æ¯”è¾ƒéšæ„ï¼Œå½“ç„¶ä¿ç•™åŸè¯„åˆ†æ˜¯æœ€å¥½çš„åšæ³•ã€‚å¯ä»¥æƒ³ä¸€æƒ³å¦‚ä½•æŠŠåŸè¯„åˆ†å¼•å…¥åˆ°æ¨¡å‹è®­ç»ƒä¸­æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1637025150,"ip_address":"","comment_id":321518,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1636935082","product_id":100060801,"comment_content":"è¯·æ•™ä¸‹è€å¸ˆï¼Œä¸€ç›´å¯¹åˆ†æ¡¶æœ‰ä¸ªç–‘æƒ‘ï¼Œè™½ç„¶ä¸šç•Œå®è·µæ˜¯å¯¹skewed distributionè¿›è¡Œåˆ†æ¡¶ï¼Œä½†æ˜¯è¿™æ ·ä»ä¿¡æ¯è®ºçš„è§’åº¦çœ‹ä¸ä¼šä¸¢æ‰ä¸€éƒ¨åˆ†ä¿¡æ¯ä¹ˆï¼Ÿè€Œä¸”ä»æ‚¨çš„ä¾‹å­æ¥è¯´ï¼Œå¤§å®¶è¯„åˆ†éƒ½é›†ä¸­åœ¨3.5æ˜¯ä¸æ˜¯æœ¬èº«å°±ä»£è¡¨äº†ä¸€ç§æ™®éåå¥½å‘¢ï¼Ÿå¦‚ä½•ä¿è¯åˆ†æ¡¶å¢åŠ ç¦»æ•£åº¦å°±èƒ½å¢åŠ æ¨¡å‹æ”¶ç›Šå‘¢ï¼Ÿæœ‰æ²¡æœ‰å•¥ç†è®ºæ”¯æ’‘è¿˜æ˜¯è¿™åªæ˜¯ä¸ªç»éªŒç»“æœï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530309,"discussion_content":"ä¾‹å­ä¸­çš„åˆ†æ¡¶æ–¹æ³•å¤„ç†çš„æ¯”è¾ƒéšæ„ï¼Œå½“ç„¶ä¿ç•™åŸè¯„åˆ†æ˜¯æœ€å¥½çš„åšæ³•ã€‚å¯ä»¥æƒ³ä¸€æƒ³å¦‚ä½•æŠŠåŸè¯„åˆ†å¼•å…¥åˆ°æ¨¡å‹è®­ç»ƒä¸­æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637025150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":315383,"user_name":"Geek_69905b","can_delete":false,"product_type":"c1","uid":1535570,"ip_address":"","ucode":"86073C3D0F4CE4","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/fo79zus88qcdVNuibzPEwKyUuoVx7TozoxgViaYnbYUCFZtdj97Os59EUIBoeiaheuYLib2Suo1YgJCtL4N7XcfzIg/132","comment_is_top":false,"comment_ctime":1633872426,"is_pvip":false,"replies":[{"id":"114468","content":"ç¤ºä¾‹ç¨‹åºé‡Œæ²¡æœ‰ç”¨hdfs","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1634080330,"ip_address":"","comment_id":315383,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1633872426","product_id":100060801,"comment_content":"ä»£ç é‡Œè¿™äº›å¤„ç†å®Œçš„ç‰¹å¾å¥½åƒæ˜¯ä¿å­˜åˆ°csvé‡Œè¾¹äº†å§  æœ‰HDFSå—","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":527948,"discussion_content":"ç¤ºä¾‹ç¨‹åºé‡Œæ²¡æœ‰ç”¨hdfs","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634080330,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":313138,"user_name":"LAKER","can_delete":false,"product_type":"c1","uid":2720513,"ip_address":"","ucode":"B87CDF0A3FB7EC","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eola14nCkjDaWbUoOICNd02xnolbDs1Uzq0Eut3VEQ39KHAGGXTyuzOpS9NcrUtrXIQM0ficEqCcxg/132","comment_is_top":false,"comment_ctime":1632294872,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632294872","product_id":100060801,"comment_content":"æ‚¨å¥½ï¼Œè€å¸ˆï¼Œçœ‹äº†æ‚¨é¡¹ç›®ä»£ç ï¼Œæ‚¨è¿æ¥çš„æ˜¯æœ¬åœ°sparkå—ï¼Œå¦‚æœè¿æ¥è¿œç¨‹sparkçš„è¯ï¼Œä¾‹å¦‚æˆ‘çš„windowsè¿æ¥äº‘æœåŠ¡å™¨ä¸Šçš„sparkï¼Œéœ€è¦æ”¹çš„æ˜¯masterä¸­çš„å‚æ•°å§ï¼Œå°†localæ”¹ä¸ºsparkï¼š&#47;&#47;ipï¼š7077ï¼Œå…¶ä»–çš„ä¾èµ–æ ¹æ®æˆ‘è‡ªå·±çš„sparkç‰ˆæœ¬è¿›è¡Œä¿®æ”¹å¯¹å—ï¼Ÿ","like_count":0},{"had_liked":false,"id":310020,"user_name":"à¸„à¸´à¸”à¸–à¸¶à¸‡Â ","can_delete":false,"product_type":"c1","uid":2735702,"ip_address":"","ucode":"205BA133D638C6","user_header":"https://static001.geekbang.org/account/avatar/00/29/be/56/6a2998ba.jpg","comment_is_top":false,"comment_ctime":1630459498,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1630459498","product_id":100060801,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘æƒ³é—®ä¸€ä¸‹FeatureEngForRecModel.scalaä¸­çš„splitAndSaveTrainingTestSampleså‡½æ•°æ˜¯ä¸æ˜¯æ²¡æœ‰ç”Ÿæ•ˆï¼Œä¸ºä»€ä¹ˆæˆ‘æ¯æ¬¡è¿è¡Œçš„æ—¶å€™ï¼Œæ²¡æœ‰é‡æ–°ç”Ÿæˆæ–‡ä»¶å•Šï¼Ÿ","like_count":0},{"had_liked":false,"id":305938,"user_name":"Geek_8a732a","can_delete":false,"product_type":"c1","uid":2723806,"ip_address":"","ucode":"97A312D97F7B91","user_header":"","comment_is_top":false,"comment_ctime":1628239001,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1628239001","product_id":100060801,"comment_content":"2ã€<br>One-hotæ˜¯è°ƒç”¨OneHotEncoderï¼Œå°†movieIdè½¬æ¢æˆmovieIdVectorå‘é‡<br>Multi-hotæ˜¯å°†genresï¼Œè½¬æ¢æˆgenreIndexeså‘é‡","like_count":0},{"had_liked":false,"id":304845,"user_name":"é™ˆå¨æ´‹","can_delete":false,"product_type":"c1","uid":2264679,"ip_address":"","ucode":"DCF84B4D3A7354","user_header":"https://static001.geekbang.org/account/avatar/00/22/8e/67/afb412fb.jpg","comment_is_top":false,"comment_ctime":1627637795,"is_pvip":false,"replies":[{"id":"110281","content":"è¿™æ˜¯ä¸ªç»éªŒå€¼ï¼Œä¸ç”¨æ­»æ‰£ï¼Œå¤šå°è¯•å°±å¯ä»¥","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1627692858,"ip_address":"","comment_id":304845,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1627637795","product_id":100060801,"comment_content":"å–†å“¥ï¼Œæ‚¨å¥½ï¼Œä¸ºä»€ä¹ˆè¦åˆ†100ä¸ªæ¡¶ï¼Œä¾æ®æ˜¯ä»æ–¹å·®é‚£é‡Œå¾—æ¥çš„å—ï¼Ÿå¦‚æœä¸æ˜¯ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¦è®¡ç®—æ–¹å·®ï¼Ÿç™¾æ€ä¸å¾—å…¶è§£ï¼~~~å¯¹ä¸èµ·å–†å“¥ï¼Œæˆ‘å¾ˆæ­»æ‰£....","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524184,"discussion_content":"è¿™æ˜¯ä¸ªç»éªŒå€¼ï¼Œä¸ç”¨æ­»æ‰£ï¼Œå¤šå°è¯•å°±å¯ä»¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627692858,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2264679,"avatar":"https://static001.geekbang.org/account/avatar/00/22/8e/67/afb412fb.jpg","nickname":"é™ˆå¨æ´‹","note":"","ucode":"DCF84B4D3A7354","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386612,"discussion_content":"å¥½çš„ï¼Œé©¬ä¸Šå°è¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627692905,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":304728,"user_name":"é™ˆå¨æ´‹","can_delete":false,"product_type":"c1","uid":2264679,"ip_address":"","ucode":"DCF84B4D3A7354","user_header":"https://static001.geekbang.org/account/avatar/00/22/8e/67/afb412fb.jpg","comment_is_top":false,"comment_ctime":1627569591,"is_pvip":false,"replies":[{"id":"110272","content":"è¿™ä¸ªå°±æ˜¯excelçš„å›¾","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1627691717,"ip_address":"","comment_id":304728,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1627569591","product_id":100060801,"comment_content":"å–†å“¥ï¼Œæ™šä¸Šå¥½ï¼~<br><br>æˆ‘æ˜¯æ­£è½¬å‹æ¨èç®—æ³•å·¥ç¨‹å¸ˆï¼Œè¯·é—®ï¼š<br><br>æ–‡ç« çš„æ•°æ®åˆ†å¸ƒå›¾ï¼Œå–†å“¥æ˜¯ç”¨ä»€ä¹ˆå·¥å…·è®¡ç®—å‡ºæ¥å“¦ï¼Ÿæœ‰æ¨èå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524136,"discussion_content":"è¿™ä¸ªå°±æ˜¯excelçš„å›¾","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627691717,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2264679,"avatar":"https://static001.geekbang.org/account/avatar/00/22/8e/67/afb412fb.jpg","nickname":"é™ˆå¨æ´‹","note":"","ucode":"DCF84B4D3A7354","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386611,"discussion_content":"Excelç›´æ¥æ–¹ä¾¿ï¼Œæ„Ÿè°¢å–†å“¥ç‚¹ç ´ï½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627692410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2340235,"avatar":"https://static001.geekbang.org/account/avatar/00/23/b5/8b/92549066.jpg","nickname":"Geek_8183d5","note":"","ucode":"D06E69FC7737A2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2264679,"avatar":"https://static001.geekbang.org/account/avatar/00/22/8e/67/afb412fb.jpg","nickname":"é™ˆå¨æ´‹","note":"","ucode":"DCF84B4D3A7354","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":571245,"discussion_content":"ä½¿ç”¨python çš„matplotlib.pyplot åº“ä¹Ÿå¯ä»¥ç”»å‡ºæ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1652154001,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":386611,"ip_address":""},"score":571245,"extra":""}]}]},{"had_liked":false,"id":301813,"user_name":"å‘è´¢äº†å¸¦å¸¦æ‰ç‹—","can_delete":false,"product_type":"c1","uid":2689315,"ip_address":"","ucode":"A85D9520407289","user_header":"https://static001.geekbang.org/account/avatar/00/29/09/23/615b56d2.jpg","comment_is_top":false,"comment_ctime":1625894961,"is_pvip":false,"replies":[{"id":"109397","content":"å•æœºå·¥ä½œï¼Œå½“ä½œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1626216197,"ip_address":"","comment_id":301813,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1625894961","product_id":100060801,"comment_content":"å°ç™½æ¥è¯·æ•™ä¸€ä¸‹è€å¸ˆï¼ŒSparkæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è®¡ç®—çš„å¹³å°ï¼Œé‚£æˆ‘git cloneä¸‹æ¥çš„é¡¹ç›®æ˜¯åœ¨æˆ‘è‡ªå·±çš„windowsæœºå™¨ä¸Šï¼Œåªæœ‰ä¸€å°æœºå™¨ï¼Œé‚£è¿™é‡Œscalaçš„ä»£ç æ˜¯æ€ä¹ˆå·¥ä½œçš„å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":523096,"discussion_content":"å•æœºå·¥ä½œï¼Œå½“ä½œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626216197,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":291457,"user_name":"è‹ç»®çš“","can_delete":false,"product_type":"c1","uid":2474686,"ip_address":"","ucode":"02A772262E1512","user_header":"https://static001.geekbang.org/account/avatar/00/25/c2/be/1a4598e0.jpg","comment_is_top":false,"comment_ctime":1620294377,"is_pvip":false,"replies":[{"id":"105683","content":"æ²¡æœ‰åŠæ³•ã€‚åªèƒ½ç”¨å…¶ä»–cold startçš„æ–¹æ³•æ¥ç”Ÿæˆè¿™ä¸ªæ–°ç”µå½±çš„embã€‚å‚è€ƒ https:&#47;&#47;zhuanlan.zhihu.com&#47;p&#47;351390011","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1620582753,"ip_address":"","comment_id":291457,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1620294377","product_id":100060801,"comment_content":"è€å¸ˆè¯·é—®ï¼Œç¦»çº¿æ—¶ç”µå½±åº“ä¸­æœ‰1000éƒ¨ç”µå½±ï¼Œå¦‚æœçº¿ä¸Šä¸Šçº¿äº†ä¸€éƒ¨æ–°ç”µå½±ï¼Œå®ƒä¸åœ¨åº“ä¸­ï¼Œé‚£å®ƒåšIDçš„Embeddingæ€ä¹ˆåŠï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519475,"discussion_content":"æ²¡æœ‰åŠæ³•ã€‚åªèƒ½ç”¨å…¶ä»–cold startçš„æ–¹æ³•æ¥ç”Ÿæˆè¿™ä¸ªæ–°ç”µå½±çš„embã€‚å‚è€ƒ https://zhuanlan.zhihu.com/p/351390011","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620582753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":290203,"user_name":"InfoQ_bb5278aeccff","can_delete":false,"product_type":"c1","uid":1367444,"ip_address":"","ucode":"E70D5AFB8011B9","user_header":"","comment_is_top":false,"comment_ctime":1619428270,"is_pvip":false,"replies":[{"id":"105350","content":"1. ä¸€èˆ¬å®æ—¶ç‰¹å¾éœ€è¦çº¿ä¸Šé‡å†™ä¸€å¥—ï¼Œéå®æ—¶ç‰¹å¾å¯ä»¥ç¦»çº¿å¤„ç†å¥½å­˜åˆ°å†…å­˜æ•°æ®åº“ä¸­ï¼Œçº¿ä¸Šç›´æ¥å–å‡ºæ¥ã€‚<br><br>2. å¯ä»¥è¿™æ ·ï¼Œå¦‚æœå·¥ç¨‹ä¸Šå¯è¡Œï¼ˆæ¯”å¦‚ç¦»çº¿å’Œåœ¨çº¿éƒ½æ˜¯ç”¨javaå†™çš„ï¼‰ï¼Œè¿™æ ·æ˜¯æœ€å¥½çš„ã€‚<br><br>3. è¿™ä¸ªé—®é¢˜å¤ªå¤æ‚ï¼Œè¦é€šè¿‡æµ‹è¯•æ¥å†³å®šã€‚ä½†æˆ‘å€¾å‘äºè®©tf servingåªå¤„ç†æ¨¡å‹çš„éƒ¨åˆ†ï¼Œæ‰€æœ‰ç‰¹å¾å·¥ç¨‹æ”¾åˆ°recsys serverå†…éƒ¨æˆ–è€…å…¶ä»–feature apiæ¥åšï¼Œè¿™æ ·å‡è½»tf servingçš„è´Ÿæ‹…ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1619729578,"ip_address":"","comment_id":290203,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1619428270","product_id":100060801,"comment_content":"è€å¸ˆæ‚¨å¥½,è¯¾ç¨‹ä¸­çš„ç‰¹å¾å·¥ç¨‹æ˜¯ç”¨spark-mlçš„apiè¿›è¡Œå¤„ç†çš„,è¿™ä¸ªåœ¨ç¦»çº¿å¤„ç†æ•°æ®å’Œè®­ç»ƒæ¨¡å‹æ˜¯é«˜æ•ˆçš„.æˆ‘çš„ç–‘æƒ‘æ˜¯:<br>1ã€æ€ä¹ˆæŠŠä¸Šè¿°ç¦»çº¿çš„ç‰¹å¾å¤„ç†éƒ¨ç½²åˆ°çº¿ä¸Šå‘¢? è¿˜æ˜¯ç¦»çº¿å†™ä¸€å¥—å¤„ç†é€»è¾‘,ä¸Šçº¿æ—¶åˆé‡æ–°å†™ä¸€å¥—å¤„ç†é€»è¾‘,è¿™æ ·èƒ½ä¿è¯ç¦»çº¿,åœ¨çº¿ç‰¹å¾çš„å¤„ç†æ˜¯ä¸€è‡´çš„å—,ä¼šä¸ä¼šå®¹æ˜“å‡ºé”™?<br>2ã€æˆ‘çœ‹æœ‰çš„å…¬å¸ç”¨c++æˆ–è€…javaå†™ä¸€å¥—å…¬ç”¨çš„ç‰¹å¾å¤„ç†ç®—å­,ç¦»çº¿å’Œåœ¨çº¿çš„ç‰¹å¾å¤„ç†éƒ½è°ƒç”¨è¿™äº›ç®—å­,ä»¥ä¿è¯ç‰¹å¾å¤„ç†çš„ä¸€è‡´æ€§,è¿™å¥—æ–¹æ³•å¯è¡Œå—?<br>3ã€è¯¾ç¨‹ä¸­å…³äºæ¨¡å‹éƒ¨åˆ†,ç›´æ¥ä½¿ç”¨tfçš„feature_columnæ¥å¤„ç†ç‰¹å¾,ä¸šç•Œä¹Ÿæ˜¯è¿™ä¹ˆåšçš„å—,åœ¨æ¨¡å‹éƒ¨ç½²çš„æ—¶å€™,ç›´æ¥æŠŠfeature_columnå’Œæ¨¡å‹ä¸€èµ·éƒ¨ç½²,åœ¨çº¿æœåŠ¡æ—¶,ç›´æ¥ä¼ åŸå§‹ç‰¹å¾ç»™æ¨¡å‹å³å¯è¿›è¡Œå¤„ç†å’Œé¢„æµ‹,è¿™æ ·æ•ˆç‡ä¼šå¾ˆæ…¢å—<br><br>å…³äºåœ¨çº¿ç‰¹å¾å¤„ç†è¿™å—,è€å¸ˆæ‚¨æœ‰ä»€ä¹ˆå»ºè®®å—","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519137,"discussion_content":"1. ä¸€èˆ¬å®æ—¶ç‰¹å¾éœ€è¦çº¿ä¸Šé‡å†™ä¸€å¥—ï¼Œéå®æ—¶ç‰¹å¾å¯ä»¥ç¦»çº¿å¤„ç†å¥½å­˜åˆ°å†…å­˜æ•°æ®åº“ä¸­ï¼Œçº¿ä¸Šç›´æ¥å–å‡ºæ¥ã€‚\n\n2. å¯ä»¥è¿™æ ·ï¼Œå¦‚æœå·¥ç¨‹ä¸Šå¯è¡Œï¼ˆæ¯”å¦‚ç¦»çº¿å’Œåœ¨çº¿éƒ½æ˜¯ç”¨javaå†™çš„ï¼‰ï¼Œè¿™æ ·æ˜¯æœ€å¥½çš„ã€‚\n\n3. è¿™ä¸ªé—®é¢˜å¤ªå¤æ‚ï¼Œè¦é€šè¿‡æµ‹è¯•æ¥å†³å®šã€‚ä½†æˆ‘å€¾å‘äºè®©tf servingåªå¤„ç†æ¨¡å‹çš„éƒ¨åˆ†ï¼Œæ‰€æœ‰ç‰¹å¾å·¥ç¨‹æ”¾åˆ°recsys serverå†…éƒ¨æˆ–è€…å…¶ä»–feature apiæ¥åšï¼Œè¿™æ ·å‡è½»tf servingçš„è´Ÿæ‹…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619729578,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":289165,"user_name":"å¦‚æ­¤è½»æ¾ã€‚","can_delete":false,"product_type":"c1","uid":1500234,"ip_address":"","ucode":"283EE136E09C03","user_header":"https://static001.geekbang.org/account/avatar/00/16/e4/4a/51847213.jpg","comment_is_top":false,"comment_ctime":1618900186,"is_pvip":false,"replies":[{"id":"105065","content":"æ˜¯çš„ï¼Œä½†æ¯«æ— ç–‘é—®è¿™æ˜¯ä¸€ä¸ªç¨€ç–å‘é‡","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1619112465,"ip_address":"","comment_id":289165,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1618900186","product_id":100060801,"comment_content":"å¦‚æœæœ‰åä¸‡éƒ¨ç”µå½±ï¼ŒOne-Hot å°±éœ€è¦ä¸€ä¸ªåä¸‡ç»´çš„å‘é‡ï¼Ÿï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518839,"discussion_content":"æ˜¯çš„ï¼Œä½†æ¯«æ— ç–‘é—®è¿™æ˜¯ä¸€ä¸ªç¨€ç–å‘é‡","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619112465,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":287186,"user_name":"å½’é›¶","can_delete":false,"product_type":"c1","uid":1103208,"ip_address":"","ucode":"C99B8E93009A46","user_header":"https://static001.geekbang.org/account/avatar/00/10/d5/68/2201b6b9.jpg","comment_is_top":false,"comment_ctime":1617808443,"is_pvip":true,"replies":[{"id":"104474","content":"æ˜¯è¿™æ ·ï¼Œè¦ç²¾ç¡®å¯¹ç…§é¡¹ç›®çš„ä¾èµ–ç‰ˆæœ¬","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1618113236,"ip_address":"","comment_id":287186,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1617808443","product_id":100060801,"comment_content":"è¯´ä¸€ä¸ªå’Œscalaç›¸å…³çš„å‘ï¼Œé¡¹ç›®ä¸­å¼•ç”¨çš„scalaç‰ˆæœ¬æ˜¯2.11ï¼Œå®‰è£…çš„sdkç‰ˆæœ¬å¦‚æœä¸ç¬¦åˆçš„è¯ä¼šæœ‰ä¸€äº›å¥‡æ€ªçš„æŠ¥é”™ï¼Œè¿™æ—¶å€™æœ€å¥½æ£€æŸ¥ä¸€ä¸‹è‡ªå·±çš„scalaçš„ç‰ˆæœ¬ã€‚","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":518225,"discussion_content":"æ˜¯è¿™æ ·ï¼Œè¦ç²¾ç¡®å¯¹ç…§é¡¹ç›®çš„ä¾èµ–ç‰ˆæœ¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618113236,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283641,"user_name":"é˜¿ç”˜","can_delete":false,"product_type":"c1","uid":1057843,"ip_address":"","ucode":"BC93175B70E05D","user_header":"https://static001.geekbang.org/account/avatar/00/10/24/33/bcf37f50.jpg","comment_is_top":false,"comment_ctime":1615862666,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1615862666","product_id":100060801,"comment_content":"ç‰¹å¾å¤„ç†ä¼¼ä¹æ˜¯åœ¨æ ·æœ¬ç”Ÿæˆçš„æ—¶å€™åšçš„ï¼Œç‰¹å¾å·¥ç¨‹æŒ–æ˜çš„æ˜¯åŸå§‹ç‰¹å¾å§ï¼Ÿ","like_count":0},{"had_liked":false,"id":283356,"user_name":"æ­¦å¼º","can_delete":false,"product_type":"c1","uid":2243266,"ip_address":"","ucode":"E338F83E4BD240","user_header":"https://static001.geekbang.org/account/avatar/00/22/3a/c2/4011ff84.jpg","comment_is_top":false,"comment_ctime":1615725522,"is_pvip":false,"replies":[{"id":"102836","content":"æ‰€è°“â€œåˆ†æ¡¶ï¼ˆBucketingï¼‰â€ï¼Œå°±æ˜¯å°†æ ·æœ¬æŒ‰ç…§æŸç‰¹å¾çš„å€¼ä»é«˜åˆ°ä½æ’åºï¼Œç„¶åæŒ‰ç…§æ¡¶çš„æ•°é‡æ‰¾åˆ°åˆ†ä½æ•°ï¼Œå°†æ ·æœ¬åˆ†åˆ°å„è‡ªçš„æ¡¶ä¸­ï¼Œå†ç”¨æ¡¶ ID ä½œä¸ºç‰¹å¾å€¼ã€‚<br><br>è¿™å¥è¯åº”è¯¥æè¿°çš„éå¸¸æ¸…æ¥šäº†ã€‚åŸºæœ¬æ˜¯å¾ˆä¸¥è°¨çš„å®šä¹‰ã€‚å¦‚æœæœ‰ä¸æ¸…æ¥šçš„åè¯è‡ªå·±å†æœç´¢å­¦ä¹ ä¸€ä¸‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1615794034,"ip_address":"","comment_id":283356,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1615725522","product_id":100060801,"comment_content":"è€å¸ˆå¥½ï¼åˆ†æ¡¶å¤„ç†ï¼Œæˆ‘è¿˜æ˜¯æ²¡å¤ªæ˜ç™½ï¼Œæ‚¨å¯ä»¥è¯¦ç»†è§£é‡Šä¸€ä¸‹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517006,"discussion_content":"æ‰€è°“â€œåˆ†æ¡¶ï¼ˆBucketingï¼‰â€ï¼Œå°±æ˜¯å°†æ ·æœ¬æŒ‰ç…§æŸç‰¹å¾çš„å€¼ä»é«˜åˆ°ä½æ’åºï¼Œç„¶åæŒ‰ç…§æ¡¶çš„æ•°é‡æ‰¾åˆ°åˆ†ä½æ•°ï¼Œå°†æ ·æœ¬åˆ†åˆ°å„è‡ªçš„æ¡¶ä¸­ï¼Œå†ç”¨æ¡¶ ID ä½œä¸ºç‰¹å¾å€¼ã€‚\n\nè¿™å¥è¯åº”è¯¥æè¿°çš„éå¸¸æ¸…æ¥šäº†ã€‚åŸºæœ¬æ˜¯å¾ˆä¸¥è°¨çš„å®šä¹‰ã€‚å¦‚æœæœ‰ä¸æ¸…æ¥šçš„åè¯è‡ªå·±å†æœç´¢å­¦ä¹ ä¸€ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615794034,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":283125,"user_name":"White dragon","can_delete":false,"product_type":"c1","uid":2335965,"ip_address":"","ucode":"31C280D9705322","user_header":"https://static001.geekbang.org/account/avatar/00/23/a4/dd/e09636ca.jpg","comment_is_top":false,"comment_ctime":1615559579,"is_pvip":false,"replies":[{"id":"102827","content":"æ— ç»å¯¹ï¼Œè¿ç»­å€¼ç‰¹å¾â€œå¯èƒ½â€ä¼šå¸¦æ¥è¿‡æ‹Ÿåˆç°è±¡ã€‚<br>LRæ¨¡å‹æŠŠç‰¹å¾ç¦»æ•£åŒ–çš„ä¸»è¦ç›®çš„ä¸€èˆ¬æ¥è¯´å°±æ˜¯ä¸ºäº†é¿å…å™ªå£°å’Œä¸€äº›è¿‡æ‹Ÿåˆç°è±¡ï¼Œä¸€èˆ¬ä¸ä¼šè¯´æå‡è¡¨è¾¾èƒ½åŠ›ï¼Œæˆ‘ä¹¦ä¸­æœ‰è¿™å¥è¯çš„è¯ï¼Œåº”è¯¥æ˜¯æœ‰ä¸Šä¸‹æ–‡ï¼Œæˆ–è€…è¡¨è¾¾ç¡®å®ä¸å‡†ç¡®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1615793104,"ip_address":"","comment_id":283125,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1615559579","product_id":100060801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œæˆ‘åœ¨çœ‹æ‚¨çš„ä¹¦ç±æ—¶æåˆ°ï¼Œè¿ç»­å€¼ç‰¹å¾ä¼šå¸¦æ¥è¿‡æ‹Ÿåˆç°è±¡ã€‚ä½†æ˜¯LRæ¨¡å‹æŠŠç‰¹å¾ç¦»æ•£åŒ–å¯ä»¥æå‡æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚è¿™ä¸¤ä¸ªæ˜¯å¦çŸ›ç›¾å‘¢","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516939,"discussion_content":"æ— ç»å¯¹ï¼Œè¿ç»­å€¼ç‰¹å¾â€œå¯èƒ½â€ä¼šå¸¦æ¥è¿‡æ‹Ÿåˆç°è±¡ã€‚\nLRæ¨¡å‹æŠŠç‰¹å¾ç¦»æ•£åŒ–çš„ä¸»è¦ç›®çš„ä¸€èˆ¬æ¥è¯´å°±æ˜¯ä¸ºäº†é¿å…å™ªå£°å’Œä¸€äº›è¿‡æ‹Ÿåˆç°è±¡ï¼Œä¸€èˆ¬ä¸ä¼šè¯´æå‡è¡¨è¾¾èƒ½åŠ›ï¼Œæˆ‘ä¹¦ä¸­æœ‰è¿™å¥è¯çš„è¯ï¼Œåº”è¯¥æ˜¯æœ‰ä¸Šä¸‹æ–‡ï¼Œæˆ–è€…è¡¨è¾¾ç¡®å®ä¸å‡†ç¡®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615793104,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2747534,"avatar":"https://static001.geekbang.org/account/avatar/00/29/ec/8e/80ecba15.jpg","nickname":"çŸ¥è¡Œ","note":"","ucode":"480B1F72A6FD76","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391012,"discussion_content":"LRå±äºçº¿æ€§æ¨¡å‹ï¼Œè¡¨è¾¾èƒ½åŠ›æœ‰é™ã€‚ä½¿ç”¨ç¦»æ•£çš„ç‰¹å¾ï¼Œæ¯ä¸ªç‰¹å¾æœ‰äº†å•ç‹¬çš„æƒé‡ï¼Œç›¸å½“äºå¼•å…¥äº†éçº¿æ€§ï¼Œå› æ­¤å¯ä»¥æå‡æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚ ç‹è€å¸ˆä¹¦ä¸­è¡¨è¾¾çš„æ˜¯ä¸æ˜¯è¿™ç§æ„æ€ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1630229979,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280738,"user_name":"å°åš","can_delete":false,"product_type":"c1","uid":1078829,"ip_address":"","ucode":"4DB860A0D35BA0","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er6OV33jHia3U6Y6xwm9BryshBqapb8iaQCf3P4RUxIxiakfEdEzDEPy5QR6sjCjqj7CNgz6Lyj8rPYA/132","comment_is_top":false,"comment_ctime":1614333918,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1614333918","product_id":100060801,"comment_content":"æƒ³é—®ä¸€ä¸‹ï¼Œç›®å‰sparkåŒ…è®­ç»ƒword2vecçš„é”™è¯¯æ˜¯å¦ä¿®å¤äº†å‘¢ï¼Œæ¯æ¬¡ç”¨æ¥è®­ç»ƒéƒ½æœ‰é—®é¢˜ã€‚ã€‚","like_count":0},{"had_liked":false,"id":277282,"user_name":"Sanders","can_delete":false,"product_type":"c1","uid":1697075,"ip_address":"","ucode":"3D460FEEDCDF34","user_header":"","comment_is_top":false,"comment_ctime":1612343581,"is_pvip":false,"replies":[{"id":"100810","content":"ä¸çŸ¥é“ä½ è¿™é‡Œè¯´çš„Feature MapæŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1612595748,"ip_address":"","comment_id":277282,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1612343581","product_id":100060801,"comment_content":"è€å¸ˆï¼Œåœ¨ç‰¹å¾å¤„ç†è¿‡ç¨‹ä¸­ç‰¹å¾çš„ä¸€è‡´æ€§å’Œå¢é‡é—®é¢˜æ˜¯ä¸æ˜¯ç”¨Sparkè¿™ä¹ˆæ¥å¤„ç†çš„ï¼Ÿ<br>1. åœ¨fitæ—¶è¾“å…¥å…¨é‡æ•°æ®ï¼Œè®©æ¯ä¸ªç‰¹å¾çš„ç‰¹å¾å€¼å°½å¯èƒ½å…¨åœ°å‚ä¸ç‰¹å¾å¤„ç†<br>2. ä¿å­˜fitåçš„Sparkæ¨¡å‹ï¼Œä½œä¸ºFeature Map<br>3. å®æ—¶å¤„ç†ä½œä¸šåŠ è½½Feature Mapæ¨¡å‹ï¼Œå¦‚æœå®æ—¶éƒ¨åˆ†æœ‰â€œæœªçŸ¥â€çš„ç‰¹å¾å€¼å‡ºç°ï¼Œé‚£ä¹ˆæ›´æ–°æ¨¡å‹(Feature Map)<br>4. çº¿ä¸Šéƒ¨åˆ†é€šè¿‡è¿™ä¸ªæ¨¡å‹(Feature Map)è¿›è¡Œä¸šåŠ¡æ•°æ®å’Œç‰¹å¾ç¼–ç ä¹‹é—´çš„è½¬æ¢","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514984,"discussion_content":"ä¸çŸ¥é“ä½ è¿™é‡Œè¯´çš„Feature MapæŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612595748,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1697075,"avatar":"","nickname":"Sanders","note":"","ucode":"3D460FEEDCDF34","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348481,"discussion_content":"Feature Mapæ˜¯åŸå§‹ç‰¹å¾å€¼å’Œç‰¹å¾ç¼–ç çš„æ˜ å°„å…³ç³»ï¼Œæ¯”å¦‚åŸå¸‚ï¼šåŒ—äº¬æ˜ å°„ä¸º1ï¼Œä¸Šæµ·æ˜ å°„ä¸º2ï¼Œå‡å¦‚å¢é‡æ•°æ®ä¸­å¤šå‡ºä¸€ä¸ªä¸‰æ²™å¸‚ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸‰æ²™å¸‚ä¹Ÿèƒ½è¢«æ­£ç¡®æ˜ å°„åˆ°åŸæœ‰å…³ç³»ä¸­ï¼Œsparkç‰¹å¾å¤„ç†æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªmodelï¼Œsave modelå°±ä¼šä¿å­˜è¿™ä¸ªå…³ç³»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612596931,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276841,"user_name":"éŸ©æœ¨å­","can_delete":false,"product_type":"c1","uid":2338335,"ip_address":"","ucode":"EB45F45897C520","user_header":"","comment_is_top":false,"comment_ctime":1612150366,"is_pvip":false,"replies":[{"id":"100802","content":"å½“ç„¶å¯ä»¥ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ä¸å°±æ˜¯å—ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1612594801,"ip_address":"","comment_id":276841,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1612150366","product_id":100060801,"comment_content":"è€å¸ˆï¼Œåœ¨ä¸€ä¸ªå¤šç¼–ç¨‹è¯­è¨€çš„é¡¹ç›®é‡Œï¼Œæœ‰pythonï¼Œscalaï¼Œjavaï¼Œä»£ç éƒ½æ˜¯åœ¨IDEAä¸Šç¼–å†™ã€è°ƒè¯•å’Œè¿è¡Œçš„å—","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514834,"discussion_content":"å½“ç„¶å¯ä»¥ï¼Œæˆ‘ä»¬çš„é¡¹ç›®ä¸å°±æ˜¯å—ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612594801,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":274620,"user_name":"å½­å°é‘«","can_delete":false,"product_type":"c1","uid":2407410,"ip_address":"","ucode":"9BEFBE52BC124E","user_header":"http://thirdwx.qlogo.cn/mmopen/VdM9K3h96B7usk6dk8Q2KsAJmLDuFBXKEUtcKxS2yhSt4aKgtO9FgC7ZdVztkPAT71c7vJQgafU70hvUgPXJXerJ7LIZ3Bxn/132","comment_is_top":false,"comment_ctime":1611103969,"is_pvip":false,"replies":[{"id":"99710","content":"å¤šä¸€ä¸ªï¼‰åº”è¯¥ä¼šç¼–è¯‘ä¸é€šè¿‡å§","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1611191457,"ip_address":"","comment_id":274620,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1611103969","product_id":100060801,"comment_content":"å½’ä¸€åŒ–å’Œåˆ†æ¡¶çš„ä»£ç ï¼Œç¬¬10è¡Œasåé¢æ˜¯ä¸æ˜¯å¤šäº†ä¸€ä¸ªâ€˜)â€™ï¼Œè·‘çš„æ—¶å€™æ„Ÿè§‰å¾ˆå¥‡æ€ªï¼Œæ²¡æ‰¾åˆ°å¯¹åº”çš„å·¦æ‹¬å·","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":514071,"discussion_content":"å¤šä¸€ä¸ªï¼‰åº”è¯¥ä¼šç¼–è¯‘ä¸é€šè¿‡å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611191457,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2407410,"avatar":"http://thirdwx.qlogo.cn/mmopen/VdM9K3h96B7usk6dk8Q2KsAJmLDuFBXKEUtcKxS2yhSt4aKgtO9FgC7ZdVztkPAT71c7vJQgafU70hvUgPXJXerJ7LIZ3Bxn/132","nickname":"å½­å°é‘«","note":"","ucode":"9BEFBE52BC124E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":344745,"discussion_content":"å¯¹å•Šï¼Œæˆ‘æŠŠå®ƒåˆ äº†è·‘èµ·æ¥äº†ï¼Œçœ‹åˆ°äº†ç»“æœ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611566753,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":273127,"user_name":"zly","can_delete":false,"product_type":"c1","uid":2354702,"ip_address":"","ucode":"193C22A6F29CF1","user_header":"https://static001.geekbang.org/account/avatar/00/23/ee/0e/833a346f.jpg","comment_is_top":false,"comment_ctime":1610447812,"is_pvip":false,"replies":[{"id":"98995","content":"hadoopæ˜¯ä¸€ä¸ªä½“ç³»ï¼Œæ•°æ®å¤„ç†å¯ä»¥ä¾§é‡sparkå°±å¯ä»¥äº†","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1610503092,"ip_address":"","comment_id":273127,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1610447812","product_id":100060801,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œè¯·é—®ä½œä¸ºåº”å±Šæ¯•ä¸šç”Ÿæ‰¾å·¥ä½œï¼Œéœ€è¦å­¦ä¹ hadoopå—ï¼Œå¦‚æœéœ€è¦çš„è¯åº”è¯¥ä¾§é‡äºæŒæ¡é‚£äº›éƒ¨åˆ†å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":513503,"discussion_content":"hadoopæ˜¯ä¸€ä¸ªä½“ç³»ï¼Œæ•°æ®å¤„ç†å¯ä»¥ä¾§é‡sparkå°±å¯ä»¥äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610503092,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":270381,"user_name":"Geek_988cb0","can_delete":false,"product_type":"c1","uid":2388174,"ip_address":"","ucode":"76666A2B0CE1C9","user_header":"","comment_is_top":false,"comment_ctime":1609107928,"is_pvip":false,"replies":[{"id":"98137","content":"sparrow sparké‡Œçš„multi-hot encodingæ˜¯åŸºäºone hot encodingçš„å¤štagç¼–ç æ–¹æ¡ˆã€‚è·Ÿè¿™ç¯‡æ–‡ç« é‡Œçš„æ¦‚å¿µä¸ä¸€æ ·ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1609199946,"ip_address":"","comment_id":270381,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1609107928","product_id":100060801,"comment_content":"sparké‡Œmulti-hot encodingæ˜¯åŸºäºone hot encoingçš„ï¼Œå’Œå¹³æ—¶è¯´çš„multi hot encodingä¸æ˜¯ä¸€æ ·çš„ï¼Œæ˜¯è¿™æ ·ä¹ˆï¼Ÿæ¯”å¦‚è¿™ç¯‡å›ç­”ï¼š<br>https:&#47;&#47;stats.stackexchange.com&#47;questions&#47;467633&#47;what-exactly-is-multi-hot-encoding-and-how-is-it-different-from-one-hot<br><br>å‡è®¾æœ‰è¿™å‡ ä¸ªç±»åˆ«ï¼š[&#39;cat&#39;, &#39;dog&#39;, &#39;fish&#39;, &#39;bird&#39;, &#39;ant&#39;]<br>multi-hot ç¼–ç ä¹‹åå˜æˆ<br>&#39;cat&#39;  = [0,0,0]  <br>&#39;dog&#39;  = [0,0,1]  <br>&#39;fish&#39; = [0,1,0]  <br>&#39;bird&#39; = [0,1,1]  <br>&#39;ant&#39;  = [1,0,0]   <br>ç»´åº¦æ˜¯âŒˆlog25âŒ‰=3ï¼Œè€Œä¸æ˜¯5","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512601,"discussion_content":"sparrow sparké‡Œçš„multi-hot encodingæ˜¯åŸºäºone hot encodingçš„å¤štagç¼–ç æ–¹æ¡ˆã€‚è·Ÿè¿™ç¯‡æ–‡ç« é‡Œçš„æ¦‚å¿µä¸ä¸€æ ·ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609199946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":262605,"user_name":"Sebastian","can_delete":false,"product_type":"c1","uid":1797634,"ip_address":"","ucode":"62E6FC13DB00E3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/55lYKUdcPFgUHibRYmaRiaBdrsmnLGOHdPp4OicjBh197X0vyGa9qAwruEqicAPuUgibXO4Lz5jLudlcbtsqq2p3CpA/132","comment_is_top":false,"comment_ctime":1605778019,"is_pvip":false,"replies":[{"id":"95328","content":"reduceByKeyåº”è¯¥æ˜¯rddç›¸å…³çš„æ“ä½œï¼Œspark dataframeæ²¡æœ‰reduceByKeyæ“ä½œã€‚å½“ç„¶å¯ä»¥å¸®æˆ‘éªŒè¯ä¸€ä¸‹ã€‚<br><br>sparké€‰å“ªä¸ªå‡½æ•°æ¯”è¾ƒé«˜æ•ˆï¼Œè¿™ä¸ªé—®é¢˜ç¡®å®æ¯”è¾ƒå¤§äº†ï¼Œè¿˜æ˜¯æ¨èä¸Šä¸€é—¨sparkè¯¾ç¨‹å§ï¼Œè¿™è¾¹å°±ä¸å±•å¼€è®²äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1605833260,"ip_address":"","comment_id":262605,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1605778019","product_id":100060801,"comment_content":"è€å¸ˆå¥½ï¼Œä¸Šé¢ä»£ç ä¸­groupByKeyå¦‚æœè€ƒè™‘å‡½æ•°æ€§èƒ½çš„è¯æ˜¯ä¸æ˜¯ä¼šè€ƒè™‘æ¢æˆreduceByKeyå‘¢ï¼Ÿå…³äºscalaè¯­è¨€é‡Œé€‰æ‹©ä»€ä¹ˆå‡½æ•°æ€§èƒ½æ›´å¥½æœ‰æ²¡æœ‰ä»€ä¹ˆå®è·µç»éªŒå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":509892,"discussion_content":"reduceByKeyåº”è¯¥æ˜¯rddç›¸å…³çš„æ“ä½œï¼Œspark dataframeæ²¡æœ‰reduceByKeyæ“ä½œã€‚å½“ç„¶å¯ä»¥å¸®æˆ‘éªŒè¯ä¸€ä¸‹ã€‚\n\nsparké€‰å“ªä¸ªå‡½æ•°æ¯”è¾ƒé«˜æ•ˆï¼Œè¿™ä¸ªé—®é¢˜ç¡®å®æ¯”è¾ƒå¤§äº†ï¼Œè¿˜æ˜¯æ¨èä¸Šä¸€é—¨sparkè¯¾ç¨‹å§ï¼Œè¿™è¾¹å°±ä¸å±•å¼€è®²äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605833260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2747534,"avatar":"https://static001.geekbang.org/account/avatar/00/29/ec/8e/80ecba15.jpg","nickname":"çŸ¥è¡Œ","note":"","ucode":"480B1F72A6FD76","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391013,"discussion_content":"æ€§èƒ½æœ€å¥½çš„åº”è¯¥æ˜¯aggregatByKey","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630230154,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253729,"user_name":"é˜³å…‰","can_delete":false,"product_type":"c1","uid":1262252,"ip_address":"","ucode":"9EA201D866EFCD","user_header":"https://static001.geekbang.org/account/avatar/00/13/42/ac/022af9f4.jpg","comment_is_top":false,"comment_ctime":1602845347,"is_pvip":false,"replies":[{"id":"92703","content":"æŒ‰ç…§ä¹‹å‰ç±»ä¼¼çš„é—®é¢˜ï¼Œåº”è¯¥æ˜¯scalaç‰ˆæœ¬çš„é—®é¢˜ï¼Œè¯·æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯ä½¿ç”¨äº†scala2.11çš„ç‰ˆæœ¬ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602871718,"ip_address":"","comment_id":253729,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1602845347","product_id":100060801,"comment_content":"æˆ‘è¿è¡ŒFeatureEngineering ç±»å‡ºé”™ï¼Œæ˜¾ç¤ºâ€œé”™è¯¯: æ‰¾ä¸åˆ°æˆ–æ— æ³•åŠ è½½ä¸»ç±» com.wzhe.sparrowrecsys.offline.spark.featureeng.FeatureEngineering<br>åŸå› : java.lang.ClassNotFoundException: com.wzhe.sparrowrecsys.offline.spark.featureeng.FeatureEngineeringâ€<br>è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507158,"discussion_content":"æŒ‰ç…§ä¹‹å‰ç±»ä¼¼çš„é—®é¢˜ï¼Œåº”è¯¥æ˜¯scalaç‰ˆæœ¬çš„é—®é¢˜ï¼Œè¯·æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯ä½¿ç”¨äº†scala2.11çš„ç‰ˆæœ¬ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602871718,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2288345,"avatar":"","nickname":"å­Ÿç«¹","note":"","ucode":"E98D7BFD30ABD3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332395,"discussion_content":"æœåˆ°äº†ä¸€ç¯‡ï¼Œhttps://blog.csdn.net/hongzhen91/article/details/81507140","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607178947,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":253613,"user_name":"æµ£ç†Šå½“å®¶","can_delete":false,"product_type":"c1","uid":1952248,"ip_address":"","ucode":"939F06050423E4","user_header":"https://static001.geekbang.org/account/avatar/00/1d/c9/f8/72955ef9.jpg","comment_is_top":false,"comment_ctime":1602812039,"is_pvip":false,"replies":[{"id":"92635","content":"scalaå’Œjavaéƒ½å¯ä»¥ï¼Œpysparkä¹Ÿå¯ä»¥ï¼Œçœ‹è‡ªå·±çš„å–œå¥½ã€‚å› ä¸ºsparkåŸç”Ÿæ”¯æŒscalaï¼Œå±äºæœ€å®˜æ–¹çš„è¯­è¨€ï¼Œæ‰€ä»¥æœ¬é—¨è¯¾ç¨‹ä½¿ç”¨scala","user_name":"ä½œè€…å›å¤","user_name_real":"ç‹å–†","uid":"1662192","ctime":1602826786,"ip_address":"","comment_id":253613,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1602812039","product_id":100060801,"comment_content":"è€å¸ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯ä¸€èˆ¬ç”¨åˆ°sparkç›¸å…³çš„åŒ…ï¼Œå°±ä¼šä¸€å®šè¦ç”¨scalaï¼Ÿå¯ä¸å¯ä»¥ä¹Ÿç”¨javaå‘¢ï¼Ÿæˆ–è€…æ¯”å¦‚çº¿ä¸Šéƒ¨åˆ†çš„ä»£ç ç°åœ¨ç”¨çš„æ˜¯javaï¼Œå¯ä¸å¯ä»¥ç”¨scalaå‘¢ï¼Ÿ æˆ‘ä»¬æœ‰å“ªäº›é€‰æ‹©è¯­è¨€çš„æ ‡å‡†å’Œè§„å¾‹å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1662192,"avatar":"https://static001.geekbang.org/account/avatar/00/19/5c/f0/46214d29.jpg","nickname":"ç‹å–†","note":"","ucode":"2EDC616F905F3F","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":507123,"discussion_content":"scalaå’Œjavaéƒ½å¯ä»¥ï¼Œpysparkä¹Ÿå¯ä»¥ï¼Œçœ‹è‡ªå·±çš„å–œå¥½ã€‚å› ä¸ºsparkåŸç”Ÿæ”¯æŒscalaï¼Œå±äºæœ€å®˜æ–¹çš„è¯­è¨€ï¼Œæ‰€ä»¥æœ¬é—¨è¯¾ç¨‹ä½¿ç”¨scala","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1602826786,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]}]}