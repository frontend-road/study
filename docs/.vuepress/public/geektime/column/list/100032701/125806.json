{"id":125806,"title":"10 | TIME_WAITï¼šéšè—åœ¨ç»†èŠ‚ä¸‹çš„é­”é¬¼","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ç››å»¶æ•ï¼Œè¿™æ˜¯ç½‘ç»œç¼–ç¨‹å®æˆ˜çš„ç¬¬10è®²ï¼Œæ¬¢è¿å›æ¥ã€‚</p><p>åœ¨å‰é¢çš„åŸºç¡€ç¯‡é‡Œï¼Œæˆ‘ä»¬å¯¹ç½‘ç»œç¼–ç¨‹æ¶‰åŠåˆ°çš„åŸºç¡€çŸ¥è¯†è¿›è¡Œäº†æ¢³ç†ï¼Œä¸»è¦å†…å®¹åŒ…æ‹¬C/Sç¼–ç¨‹æ¨¡å‹ã€TCPåè®®ã€UDPåè®®å’Œæœ¬åœ°å¥—æ¥å­—ç­‰å†…å®¹ã€‚åœ¨æé«˜ç¯‡é‡Œï¼Œæˆ‘å°†ç»“åˆæˆ‘çš„ç»éªŒï¼Œå¼•å¯¼ä½ å¯¹TCPå’ŒUDPè¿›è¡Œæ›´æ·±å…¥çš„ç†è§£ã€‚</p><p>å­¦ä¹ å®Œæé«˜ç¯‡ä¹‹åï¼Œæˆ‘å¸Œæœ›ä½ å¯¹å¦‚ä½•æé«˜TCPåŠUDPç¨‹åºçš„å¥å£®æ€§æœ‰ä¸€ä¸ªå…¨é¢æ¸…æ™°çš„è®¤è¯†ï¼Œä»è€Œä¸ºæ·±å…¥ç†è§£æ€§èƒ½ç¯‡æ‰“ä¸‹è‰¯å¥½çš„åŸºç¡€ã€‚</p><p>åœ¨å‰é¢çš„åŸºç¡€ç¯‡é‡Œï¼Œæˆ‘ä»¬äº†è§£äº†TCPå››æ¬¡æŒ¥æ‰‹ï¼Œåœ¨å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹ä¸­ï¼Œå‘èµ·è¿æ¥æ–­å¼€çš„ä¸€æ–¹ä¼šæœ‰ä¸€æ®µæ—¶é—´å¤„äºTIME_WAITçš„çŠ¶æ€ï¼Œä½ çŸ¥é“TIME_WAITæ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ä¹ˆï¼Ÿåœ¨é¢è¯•å’Œå®æˆ˜ä¸­ï¼ŒTIME_WAITç›¸å…³çš„é—®é¢˜å§‹ç»ˆæ˜¯ç»•ä¸è¿‡å»çš„ä¸€é“éš¾é¢˜ã€‚ä¸‹é¢å°±è¯·è·Ÿéšæˆ‘ï¼Œä¸€èµ·æ‰¾å‡ºéšè—åœ¨ç»†èŠ‚ä¸‹çš„é­”é¬¼å§ã€‚</p><h2>TIME_WAITå‘ç”Ÿçš„åœºæ™¯</h2><p>è®©æˆ‘ä»¬å…ˆä»ä¸€ä¾‹çº¿ä¸Šæ•…éšœè¯´èµ·ã€‚åœ¨ä¸€æ¬¡å‡çº§çº¿ä¸Šåº”ç”¨æœåŠ¡ä¹‹åï¼Œæˆ‘ä»¬å‘ç°è¯¥æœåŠ¡çš„å¯ç”¨æ€§å˜å¾—æ—¶å¥½æ—¶åï¼Œä¸€æ®µæ—¶é—´å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸€æ®µæ—¶é—´çªç„¶åˆä¸å¯ä»¥ï¼Œå¤§å®¶éƒ½ç™¾æ€ä¸å¾—å…¶è§£ã€‚è¿ç»´åŒå­¦ç™»å½•åˆ°æœåŠ¡æ‰€åœ¨çš„ä¸»æœºä¸Šï¼Œä½¿ç”¨netstatå‘½ä»¤æŸ¥çœ‹åæ‰å‘ç°ï¼Œä¸»æœºä¸Šæœ‰æˆåƒä¸Šä¸‡å¤„äºTIME_WAITçŠ¶æ€çš„è¿æ¥ã€‚</p><p>ç»è¿‡å±‚å±‚å‰–æåï¼Œæˆ‘ä»¬å‘ç°ç½ªé­ç¥¸é¦–å°±æ˜¯TIME_WAITã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬è¿™ä¸ªåº”ç”¨æœåŠ¡éœ€è¦é€šè¿‡å‘èµ·TCPè¿æ¥å¯¹å¤–æä¾›æœåŠ¡ã€‚æ¯ä¸ªè¿æ¥ä¼šå ç”¨ä¸€ä¸ªæœ¬åœ°ç«¯å£ï¼Œå½“åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼ŒTIME_WAITçŠ¶æ€çš„è¿æ¥è¿‡å¤šï¼Œå¤šåˆ°æŠŠæœ¬æœºå¯ç”¨çš„ç«¯å£è€—å°½ï¼Œåº”ç”¨æœåŠ¡å¯¹å¤–è¡¨ç°çš„ç—‡çŠ¶ï¼Œå°±æ˜¯ä¸èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚å½“è¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå¤„äºTIME_WAITçš„è¿æ¥è¢«ç³»ç»Ÿå›æ”¶å¹¶å…³é—­åï¼Œé‡Šæ”¾å‡ºæœ¬åœ°ç«¯å£å¯ä¾›ä½¿ç”¨ï¼Œåº”ç”¨æœåŠ¡å¯¹å¤–è¡¨ç°ä¸ºï¼Œå¯ä»¥æ­£å¸¸å·¥ä½œã€‚è¿™æ ·å‘¨è€Œå¤å§‹ï¼Œä¾¿ä¼šå‡ºç°äº†ä¸€ä¼šå„¿ä¸å¯ä»¥ï¼Œè¿‡ä¸€ä¸¤åˆ†é’Ÿåˆå¯ä»¥æ­£å¸¸å·¥ä½œçš„ç°è±¡ã€‚</p><!-- [[[read_end]]] --><p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šäº§ç”Ÿè¿™ä¹ˆå¤šçš„TIME_WAITè¿æ¥å‘¢ï¼Ÿ</p><p>è¿™è¦ä»TCPçš„å››æ¬¡æŒ¥æ‰‹è¯´èµ·ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/f3/e1/f34823ce42a49e4eadaf642a75d14de1.png?wh=874*556\" alt=\"\"><br>\nTCPè¿æ¥ç»ˆæ­¢æ—¶ï¼Œä¸»æœº1å…ˆå‘é€FINæŠ¥æ–‡ï¼Œä¸»æœº2è¿›å…¥CLOSE_WAITçŠ¶æ€ï¼Œå¹¶å‘é€ä¸€ä¸ªACKåº”ç­”ï¼ŒåŒæ—¶ï¼Œä¸»æœº2é€šè¿‡readè°ƒç”¨è·å¾—EOFï¼Œå¹¶å°†æ­¤ç»“æœé€šçŸ¥åº”ç”¨ç¨‹åºè¿›è¡Œä¸»åŠ¨å…³é—­æ“ä½œï¼Œå‘é€FINæŠ¥æ–‡ã€‚ä¸»æœº1åœ¨æ¥æ”¶åˆ°FINæŠ¥æ–‡åå‘é€ACKåº”ç­”ï¼Œæ­¤æ—¶ä¸»æœº1è¿›å…¥TIME_WAITçŠ¶æ€ã€‚</p><p>ä¸»æœº1åœ¨TIME_WAITåœç•™æŒç»­æ—¶é—´æ˜¯å›ºå®šçš„ï¼Œæ˜¯æœ€é•¿åˆ†èŠ‚ç”Ÿå‘½æœŸMSLï¼ˆmaximum segment lifetimeï¼‰çš„ä¸¤å€ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸º2MSLã€‚å’Œå¤§å¤šæ•°BSDæ´¾ç”Ÿçš„ç³»ç»Ÿä¸€æ ·ï¼ŒLinuxç³»ç»Ÿé‡Œæœ‰ä¸€ä¸ªç¡¬ç¼–ç çš„å­—æ®µï¼Œåç§°ä¸º<code>TCP_TIMEWAIT_LEN</code>ï¼Œå…¶å€¼ä¸º60ç§’ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>Linuxç³»ç»Ÿåœç•™åœ¨TIME_WAITçš„æ—¶é—´ä¸ºå›ºå®šçš„60ç§’ã€‚</strong></p><pre><code>#define TCP_TIMEWAIT_LEN (60*HZ) /* how long to wait to destroy TIME-        WAIT state, about 60 seconds\t*/\n</code></pre><p>è¿‡äº†è¿™ä¸ªæ—¶é—´ä¹‹åï¼Œä¸»æœº1å°±è¿›å…¥CLOSEDçŠ¶æ€ã€‚ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªæ—¶é—´å‘¢ï¼Ÿä½ å¯ä»¥å…ˆæƒ³ä¸€æƒ³ï¼Œç¨åæˆ‘ä¼šç»™å‡ºè§£ç­”ã€‚</p><p>ä½ ä¸€å®šè¦è®°ä½ä¸€ç‚¹ï¼Œ<strong>åªæœ‰å‘èµ·è¿æ¥ç»ˆæ­¢çš„ä¸€æ–¹ä¼šè¿›å…¥TIME_WAITçŠ¶æ€</strong>ã€‚è¿™ä¸€ç‚¹é¢è¯•çš„æ—¶å€™ç»å¸¸ä¼šè¢«é—®åˆ°ã€‚</p><h2>TIME_WAITçš„ä½œç”¨</h2><p>ä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥è¿›å…¥CLOSEDçŠ¶æ€ï¼Œè€Œè¦åœç•™åœ¨TIME_WAITè¿™ä¸ªçŠ¶æ€ï¼Ÿ</p><p>è¿™è¦ä»ä¸¤ä¸ªæ–¹é¢æ¥è¯´ã€‚</p><p>é¦–å…ˆï¼Œè¿™æ ·åšæ˜¯ä¸ºäº†ç¡®ä¿æœ€åçš„ACKèƒ½è®©è¢«åŠ¨å…³é—­æ–¹æ¥æ”¶ï¼Œä»è€Œå¸®åŠ©å…¶æ­£å¸¸å…³é—­ã€‚</p><p>TCPåœ¨è®¾è®¡çš„æ—¶å€™ï¼Œåšäº†å……åˆ†çš„å®¹é”™æ€§è®¾è®¡ï¼Œæ¯”å¦‚ï¼ŒTCPå‡è®¾æŠ¥æ–‡ä¼šå‡ºé”™ï¼Œéœ€è¦é‡ä¼ ã€‚åœ¨è¿™é‡Œï¼Œå¦‚æœå›¾ä¸­ä¸»æœº1çš„ACKæŠ¥æ–‡æ²¡æœ‰ä¼ è¾“æˆåŠŸï¼Œé‚£ä¹ˆä¸»æœº2å°±ä¼šé‡æ–°å‘é€FINæŠ¥æ–‡ã€‚</p><p>å¦‚æœä¸»æœº1æ²¡æœ‰ç»´æŠ¤TIME_WAITçŠ¶æ€ï¼Œè€Œç›´æ¥è¿›å…¥CLOSEDçŠ¶æ€ï¼Œå®ƒå°±å¤±å»äº†å½“å‰çŠ¶æ€çš„ä¸Šä¸‹æ–‡ï¼Œåªèƒ½å›å¤ä¸€ä¸ªRSTæ“ä½œï¼Œä»è€Œå¯¼è‡´è¢«åŠ¨å…³é—­æ–¹å‡ºç°é”™è¯¯ã€‚</p><p>ç°åœ¨ä¸»æœº1çŸ¥é“è‡ªå·±å¤„äºTIME_WAITçš„çŠ¶æ€ï¼Œå°±å¯ä»¥åœ¨æ¥æ”¶åˆ°FINæŠ¥æ–‡ä¹‹åï¼Œé‡æ–°å‘å‡ºä¸€ä¸ªACKæŠ¥æ–‡ï¼Œä½¿å¾—ä¸»æœº2å¯ä»¥è¿›å…¥æ­£å¸¸çš„CLOSEDçŠ¶æ€ã€‚</p><p>ç¬¬äºŒä¸ªç†ç”±å’Œè¿æ¥â€œåŒ–èº«â€å’ŒæŠ¥æ–‡è¿·èµ°æœ‰å…³ç³»ï¼Œä¸ºäº†è®©æ—§è¿æ¥çš„é‡å¤åˆ†èŠ‚åœ¨ç½‘ç»œä¸­è‡ªç„¶æ¶ˆå¤±ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ç½‘ç»œä¸­ï¼Œç»å¸¸ä¼šå‘ç”ŸæŠ¥æ–‡ç»è¿‡ä¸€æ®µæ—¶é—´æ‰èƒ½åˆ°è¾¾ç›®çš„åœ°çš„æƒ…å†µï¼Œäº§ç”Ÿçš„åŸå› æ˜¯å¤šç§å¤šæ ·çš„ï¼Œå¦‚è·¯ç”±å™¨é‡å¯ï¼Œé“¾è·¯çªç„¶å‡ºç°æ•…éšœç­‰ã€‚å¦‚æœè¿·èµ°æŠ¥æ–‡åˆ°è¾¾æ—¶ï¼Œå‘ç°TCPè¿æ¥å››å…ƒç»„ï¼ˆæºIPï¼Œæºç«¯å£ï¼Œç›®çš„IPï¼Œç›®çš„ç«¯å£ï¼‰æ‰€ä»£è¡¨çš„è¿æ¥ä¸å¤å­˜åœ¨ï¼Œé‚£ä¹ˆå¾ˆç®€å•ï¼Œè¿™ä¸ªæŠ¥æ–‡è‡ªç„¶ä¸¢å¼ƒã€‚</p><p>æˆ‘ä»¬è€ƒè™‘è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼Œåœ¨åŸè¿æ¥ä¸­æ–­åï¼Œåˆé‡æ–°åˆ›å»ºäº†ä¸€ä¸ªåŸè¿æ¥çš„â€œåŒ–èº«â€ï¼Œè¯´æ˜¯åŒ–èº«å…¶å®æ˜¯å› ä¸ºè¿™ä¸ªè¿æ¥å’ŒåŸå…ˆçš„è¿æ¥å››å…ƒç»„å®Œå…¨ç›¸åŒï¼Œå¦‚æœè¿·å¤±æŠ¥æ–‡ç»è¿‡ä¸€æ®µæ—¶é—´ä¹Ÿåˆ°è¾¾ï¼Œé‚£ä¹ˆè¿™ä¸ªæŠ¥æ–‡ä¼šè¢«è¯¯è®¤ä¸ºæ˜¯è¿æ¥â€œåŒ–èº«â€çš„ä¸€ä¸ªTCPåˆ†èŠ‚ï¼Œè¿™æ ·å°±ä¼šå¯¹TCPé€šä¿¡äº§ç”Ÿå½±å“ã€‚</p><p><img src=\"https://static001.geekbang.org/resource/image/94/5f/945c60ae06d282dcc22ad3b868f1175f.png?wh=856*580\" alt=\"\"><br>\næ‰€ä»¥ï¼ŒTCPå°±è®¾è®¡å‡ºäº†è¿™ä¹ˆä¸€ä¸ªæœºåˆ¶ï¼Œç»è¿‡2MSLè¿™ä¸ªæ—¶é—´ï¼Œè¶³ä»¥è®©ä¸¤ä¸ªæ–¹å‘ä¸Šçš„åˆ†ç»„éƒ½è¢«ä¸¢å¼ƒï¼Œä½¿å¾—åŸæ¥è¿æ¥çš„åˆ†ç»„åœ¨ç½‘ç»œä¸­éƒ½è‡ªç„¶æ¶ˆå¤±ï¼Œå†å‡ºç°çš„åˆ†ç»„ä¸€å®šéƒ½æ˜¯æ–°åŒ–èº«æ‰€äº§ç”Ÿçš„ã€‚</p><p>åˆ’é‡ç‚¹ï¼Œ2MSLçš„æ—¶é—´æ˜¯<strong>ä»ä¸»æœº1æ¥æ”¶åˆ°FINåå‘é€ACKå¼€å§‹è®¡æ—¶çš„</strong>ï¼›å¦‚æœåœ¨TIME_WAITæ—¶é—´å†…ï¼Œå› ä¸ºä¸»æœº1çš„ACKæ²¡æœ‰ä¼ è¾“åˆ°ä¸»æœº2ï¼Œä¸»æœº1åˆæ¥æ”¶åˆ°äº†ä¸»æœº2é‡å‘çš„FINæŠ¥æ–‡ï¼Œé‚£ä¹ˆ2MSLæ—¶é—´å°†é‡æ–°è®¡æ—¶ã€‚é“ç†å¾ˆç®€å•ï¼Œå› ä¸º2MSLçš„æ—¶é—´ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©æ—§è¿æ¥çš„æ‰€æœ‰æŠ¥æ–‡éƒ½èƒ½è‡ªç„¶æ¶ˆäº¡ï¼Œç°åœ¨ä¸»æœº1é‡æ–°å‘é€äº†ACKæŠ¥æ–‡ï¼Œè‡ªç„¶éœ€è¦é‡æ–°è®¡æ—¶ï¼Œä»¥ä¾¿é˜²æ­¢è¿™ä¸ªACKæŠ¥æ–‡å¯¹æ–°å¯èƒ½çš„è¿æ¥åŒ–èº«é€ æˆå¹²æ‰°ã€‚</p><h2>TIME_WAITçš„å±å®³</h2><p>è¿‡å¤šçš„TIME_WAITçš„ä¸»è¦å±å®³æœ‰ä¸¤ç§ã€‚</p><p>ç¬¬ä¸€æ˜¯å†…å­˜èµ„æºå ç”¨ï¼Œè¿™ä¸ªç›®å‰çœ‹æ¥ä¸æ˜¯å¤ªä¸¥é‡ï¼ŒåŸºæœ¬å¯ä»¥å¿½ç•¥ã€‚</p><p>ç¬¬äºŒæ˜¯å¯¹ç«¯å£èµ„æºçš„å ç”¨ï¼Œä¸€ä¸ªTCPè¿æ¥è‡³å°‘æ¶ˆè€—ä¸€ä¸ªæœ¬åœ°ç«¯å£ã€‚è¦çŸ¥é“ï¼Œç«¯å£èµ„æºä¹Ÿæ˜¯æœ‰é™çš„ï¼Œä¸€èˆ¬å¯ä»¥å¼€å¯çš„ç«¯å£ä¸º32768ï½61000 ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<code>net.ipv4.ip_local_port_range</code>æŒ‡å®šï¼Œå¦‚æœTIME_WAITçŠ¶æ€è¿‡å¤šï¼Œä¼šå¯¼è‡´æ— æ³•åˆ›å»ºæ–°è¿æ¥ã€‚è¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬åœ¨ä¸€å¼€å§‹è®²åˆ°çš„é‚£ä¸ªä¾‹å­ã€‚</p><h2>å¦‚ä½•ä¼˜åŒ–TIME_WAITï¼Ÿ</h2><p>åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å¯¹TIME_WAITåšä¸€äº›ä¼˜åŒ–ï¼Œæ¥è§£å†³æˆ‘ä»¬ä¸€å¼€å§‹æåˆ°çš„ä¾‹å­ï¼Œè¯¥å¦‚ä½•åŠå‘¢ï¼Ÿ</p><h3>net.ipv4.tcp_max_tw_buckets</h3><p>ä¸€ä¸ªæš´åŠ›çš„æ–¹æ³•æ˜¯é€šè¿‡sysctlå‘½ä»¤ï¼Œå°†ç³»ç»Ÿå€¼è°ƒå°ã€‚è¿™ä¸ªå€¼é»˜è®¤ä¸º18000ï¼Œå½“ç³»ç»Ÿä¸­å¤„äºTIME_WAITçš„è¿æ¥ä¸€æ—¦è¶…è¿‡è¿™ä¸ªå€¼æ—¶ï¼Œç³»ç»Ÿå°±ä¼šå°†æ‰€æœ‰çš„TIME_WAITè¿æ¥çŠ¶æ€é‡ç½®ï¼Œå¹¶ä¸”åªæ‰“å°å‡ºè­¦å‘Šä¿¡æ¯ã€‚è¿™ä¸ªæ–¹æ³•è¿‡äºæš´åŠ›ï¼Œè€Œä¸”æ²»æ ‡ä¸æ²»æœ¬ï¼Œå¸¦æ¥çš„é—®é¢˜è¿œæ¯”è§£å†³çš„é—®é¢˜å¤šï¼Œä¸æ¨èä½¿ç”¨ã€‚</p><h3>è°ƒä½TCP_TIMEWAIT_LENï¼Œé‡æ–°ç¼–è¯‘ç³»ç»Ÿ</h3><p>è¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹æ³•ï¼Œç¼ºç‚¹æ˜¯éœ€è¦â€œä¸€ç‚¹â€å†…æ ¸æ–¹é¢çš„çŸ¥è¯†ï¼Œèƒ½å¤Ÿé‡æ–°ç¼–è¯‘å†…æ ¸ã€‚æˆ‘æƒ³è¿™ä¸ªä¸æ˜¯å¤§å¤šæ•°äººèƒ½æ¥å—çš„æ–¹å¼ã€‚</p><h3>SO_LINGERçš„è®¾ç½®</h3><p>è‹±æ–‡å•è¯â€œlingerâ€çš„æ„æ€ä¸ºåœç•™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®å¥—æ¥å­—é€‰é¡¹ï¼Œæ¥è®¾ç½®è°ƒç”¨closeæˆ–è€…shutdownå…³é—­è¿æ¥æ—¶çš„è¡Œä¸ºã€‚</p><pre><code>int setsockopt(int sockfd, int level, int optname, const void *optval,\nã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€socklen_t optlen);\n</code></pre><pre><code>struct linger {\nã€€intã€€ l_onoff;ã€€ã€€ã€€ã€€/* 0=off, nonzero=on */\nã€€intã€€ l_linger;ã€€ã€€ã€€ã€€/* linger time, POSIX specifies units as seconds */\n}\n</code></pre><p>è®¾ç½®lingerå‚æ•°æœ‰å‡ ç§å¯èƒ½ï¼š</p><ul>\n<li>å¦‚æœ<code>l_onoff</code>ä¸º0ï¼Œé‚£ä¹ˆå…³é—­æœ¬é€‰é¡¹ã€‚<code>l_linger</code>çš„å€¼è¢«å¿½ç•¥ï¼Œè¿™å¯¹åº”äº†é»˜è®¤è¡Œä¸ºï¼Œcloseæˆ–shutdownç«‹å³è¿”å›ã€‚å¦‚æœåœ¨å¥—æ¥å­—å‘é€ç¼“å†²åŒºä¸­æœ‰æ•°æ®æ®‹ç•™ï¼Œç³»ç»Ÿä¼šå°†è¯•ç€æŠŠè¿™äº›æ•°æ®å‘é€å‡ºå»ã€‚</li>\n<li>å¦‚æœ<code>l_onoff</code>ä¸ºé0ï¼Œ ä¸”<code>l_linger</code>å€¼ä¹Ÿä¸º0ï¼Œé‚£ä¹ˆè°ƒç”¨closeåï¼Œä¼šç«‹è¯¥å‘é€ä¸€ä¸ªRSTæ ‡å¿—ç»™å¯¹ç«¯ï¼Œè¯¥TCPè¿æ¥å°†è·³è¿‡å››æ¬¡æŒ¥æ‰‹ï¼Œä¹Ÿå°±è·³è¿‡äº†TIME_WAITçŠ¶æ€ï¼Œç›´æ¥å…³é—­ã€‚è¿™ç§å…³é—­çš„æ–¹å¼ç§°ä¸ºâ€œå¼ºè¡Œå…³é—­â€ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ’é˜Ÿæ•°æ®ä¸ä¼šè¢«å‘é€ï¼Œè¢«åŠ¨å…³é—­æ–¹ä¹Ÿä¸çŸ¥é“å¯¹ç«¯å·²ç»å½»åº•æ–­å¼€ã€‚åªæœ‰å½“è¢«åŠ¨å…³é—­æ–¹æ­£é˜»å¡åœ¨<code>recv()</code>è°ƒç”¨ä¸Šæ—¶ï¼Œæ¥å—åˆ°RSTæ—¶ï¼Œä¼šç«‹åˆ»å¾—åˆ°ä¸€ä¸ªâ€œconnet reset by peerâ€çš„å¼‚å¸¸ã€‚</li>\n</ul><pre><code>struct linger so_linger;\nso_linger.l_onoff = 1;\nso_linger.l_linger = 0;\nsetsockopt(s,SOL_SOCKET,SO_LINGER, &amp;so_linger,sizeof(so_linger));\n</code></pre><ul>\n<li>å¦‚æœ<code>l_onoff</code>ä¸ºé0ï¼Œ ä¸”<code>l_linger</code>çš„å€¼ä¹Ÿé0ï¼Œé‚£ä¹ˆè°ƒç”¨closeåï¼Œè°ƒç”¨closeçš„çº¿ç¨‹å°±å°†é˜»å¡ï¼Œç›´åˆ°æ•°æ®è¢«å‘é€å‡ºå»ï¼Œæˆ–è€…è®¾ç½®çš„<code>l_linger</code>è®¡æ—¶æ—¶é—´åˆ°ã€‚</li>\n</ul><p>ç¬¬äºŒç§å¯èƒ½ä¸ºè·¨è¶ŠTIME_WAITçŠ¶æ€æä¾›äº†ä¸€ä¸ªå¯èƒ½ï¼Œä¸è¿‡æ˜¯ä¸€ä¸ªéå¸¸å±é™©çš„è¡Œä¸ºï¼Œä¸å€¼å¾—æå€¡ã€‚</p><h3>net.ipv4.tcp_tw_reuseï¼šæ›´å®‰å…¨çš„è®¾ç½®</h3><p>é‚£ä¹ˆLinuxæœ‰æ²¡æœ‰æä¾›æ›´å®‰å…¨çš„é€‰æ‹©å‘¢ï¼Ÿ</p><p>å½“ç„¶æœ‰ã€‚è¿™å°±æ˜¯<code>net.ipv4.tcp_tw_reuse</code>é€‰é¡¹ã€‚</p><p>Linuxç³»ç»Ÿå¯¹äº<code>net.ipv4.tcp_tw_reuse</code>çš„è§£é‡Šå¦‚ä¸‹:</p><pre><code>Allow to reuse TIME-WAIT sockets for new connections when it is safe from protocol viewpoint. Default value is 0.It should not be changed without advice/request of technical experts.\n</code></pre><p>è¿™æ®µè¯çš„å¤§æ„æ˜¯ä»åè®®è§’åº¦ç†è§£å¦‚æœæ˜¯å®‰å…¨å¯æ§çš„ï¼Œå¯ä»¥å¤ç”¨å¤„äºTIME_WAITçš„å¥—æ¥å­—ä¸ºæ–°çš„è¿æ¥æ‰€ç”¨ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ˜¯åè®®è§’åº¦ç†è§£çš„å®‰å…¨å¯æ§å‘¢ï¼Ÿä¸»è¦æœ‰ä¸¤ç‚¹ï¼š</p><ol>\n<li>åªé€‚ç”¨äºè¿æ¥å‘èµ·æ–¹ï¼ˆC/Sæ¨¡å‹ä¸­çš„å®¢æˆ·ç«¯ï¼‰ï¼›</li>\n<li>å¯¹åº”çš„TIME_WAITçŠ¶æ€çš„è¿æ¥åˆ›å»ºæ—¶é—´è¶…è¿‡1ç§’æ‰å¯ä»¥è¢«å¤ç”¨ã€‚</li>\n</ol><p>ä½¿ç”¨è¿™ä¸ªé€‰é¡¹ï¼Œè¿˜æœ‰ä¸€ä¸ªå‰æï¼Œéœ€è¦æ‰“å¼€å¯¹TCPæ—¶é—´æˆ³çš„æ”¯æŒï¼Œå³<code>net.ipv4.tcp_timestamps=1</code>ï¼ˆé»˜è®¤å³ä¸º1ï¼‰ã€‚</p><p>è¦çŸ¥é“ï¼ŒTCPåè®®ä¹Ÿåœ¨ä¸æ—¶ä¿±è¿›ï¼ŒRFC 1323ä¸­å®ç°äº†TCPæ‹“å±•è§„èŒƒï¼Œä»¥ä¾¿ä¿è¯TCPçš„é«˜å¯ç”¨ï¼Œå¹¶å¼•å…¥äº†æ–°çš„TCPé€‰é¡¹ï¼Œä¸¤ä¸ª4å­—èŠ‚çš„æ—¶é—´æˆ³å­—æ®µï¼Œç”¨äºè®°å½•TCPå‘é€æ–¹çš„å½“å‰æ—¶é—´æˆ³å’Œä»å¯¹ç«¯æ¥æ”¶åˆ°çš„æœ€æ–°æ—¶é—´æˆ³ã€‚ç”±äºå¼•å…¥äº†æ—¶é—´æˆ³ï¼Œæˆ‘ä»¬åœ¨å‰é¢æåˆ°çš„2MSLé—®é¢˜å°±ä¸å¤å­˜åœ¨äº†ï¼Œå› ä¸ºé‡å¤çš„æ•°æ®åŒ…ä¼šå› ä¸ºæ—¶é—´æˆ³è¿‡æœŸè¢«è‡ªç„¶ä¸¢å¼ƒã€‚</p><h2>æ€»ç»“</h2><p>åœ¨ä»Šå¤©çš„å†…å®¹é‡Œï¼Œæˆ‘è®²äº†TCPçš„å››æ¬¡æŒ¥æ‰‹ï¼Œé‡ç‚¹å¯¹TIME_WAITçš„äº§ç”Ÿã€ä½œç”¨ä»¥åŠä¼˜åŒ–è¿›è¡Œäº†è®²è§£ï¼Œä½ éœ€è¦è®°ä½ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p><ul>\n<li>TIME_WAITçš„å¼•å…¥æ˜¯ä¸ºäº†è®©TCPæŠ¥æ–‡å¾—ä»¥è‡ªç„¶æ¶ˆå¤±ï¼ŒåŒæ—¶ä¸ºäº†è®©è¢«åŠ¨å…³é—­æ–¹èƒ½å¤Ÿæ­£å¸¸å…³é—­ï¼›</li>\n<li>ä¸è¦è¯•å›¾ä½¿ç”¨<code>SO_LINGER</code>è®¾ç½®å¥—æ¥å­—é€‰é¡¹ï¼Œè·³è¿‡TIME_WAITï¼›</li>\n<li>ç°ä»£Linuxç³»ç»Ÿå¼•å…¥äº†æ›´å®‰å…¨å¯æ§çš„æ–¹æ¡ˆï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å°½å¯èƒ½åœ°å¤ç”¨TIME_WAITçŠ¶æ€çš„è¿æ¥ã€‚</li>\n</ul><h2>æ€è€ƒé¢˜</h2><p>æœ€åæŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ç•™ä¸¤é“æ€è€ƒé¢˜ï¼Œä¾›ä½ æ¶ˆåŒ–ä»Šå¤©çš„å†…å®¹ã€‚</p><ol>\n<li>æœ€å¤§åˆ†ç»„MSLæ˜¯TCPåˆ†ç»„åœ¨ç½‘ç»œä¸­å­˜æ´»çš„æœ€é•¿æ—¶é—´ï¼Œä½ çŸ¥é“è¿™ä¸ªæœ€é•¿æ—¶é—´æ˜¯å¦‚ä½•è¾¾æˆçš„ï¼Ÿæ¢å¥è¯è¯´ï¼Œæ˜¯æ€ä¹ˆæ ·çš„æœºåˆ¶ï¼Œå¯ä»¥ä¿è¯åœ¨MSLè¾¾åˆ°ä¹‹åï¼ŒæŠ¥æ–‡å°±è‡ªç„¶æ¶ˆäº¡äº†å‘¢ï¼Ÿ</li>\n<li>RFC 1323å¼•å…¥äº†TCPæ—¶é—´æˆ³ï¼Œé‚£ä¹ˆè¿™éœ€è¦åœ¨å‘é€æ–¹å’Œæ¥æ”¶æ–¹ä¹‹é—´å®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„æ—¶é’Ÿå—ï¼Ÿ</li>\n</ol><p>æ¬¢è¿ä½ åœ¨è¯„è®ºåŒºå†™ä¸‹ä½ çš„æ€è€ƒï¼Œå¦‚æœé€šè¿‡è¿™ç¯‡æ–‡ç« ä½ ç†è§£äº†TIME_WAITï¼Œæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–è€…åŒäº‹ï¼Œä¸€èµ·äº¤æµå­¦ä¹ ä¸€ä¸‹ã€‚</p>","neighbors":{"left":{"article_title":"09ä¸¨ç­”ç–‘ç¯‡ï¼šå­¦ä¹ ç½‘ç»œç¼–ç¨‹å‰ï¼Œéœ€è¦å‡†å¤‡å“ªäº›ä¸œè¥¿ï¼Ÿ","id":120390},"right":{"article_title":"11 | ä¼˜é›…åœ°å…³é—­è¿˜æ˜¯ç²—æš´åœ°å…³é—­ ?","id":126126}},"comments":[{"had_liked":false,"id":127117,"user_name":"LeonğŸ“·","can_delete":false,"product_type":"c1","uid":1219496,"ip_address":"","ucode":"B9BBD1EFAAE5A2","user_header":"https://static001.geekbang.org/account/avatar/00/12/9b/a8/6a391c66.jpg","comment_is_top":true,"comment_ctime":1566559108,"is_pvip":false,"replies":[{"id":"48211","content":"BINGOã€‚å¤ªå¤šäº†ï¼Œå¤§å®¶ä¹Ÿä¸å¥½æ¥å—ï¼Œæˆ‘æƒ³æˆ‘è¿˜æ˜¯ä¸æ±‚é¢é¢ä¿±åˆ°ï¼Œä½†æ±‚æœ‰æ‰€å¯å‘å’Œå¼•é¢†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567132423,"ip_address":"","comment_id":127117,"utype":1}],"discussion_count":2,"race_medal":0,"score":"9.2233721586803999e+18","product_id":100032701,"comment_content":"net.ipv4.tcp_tw_recycleæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½å¯ä»¥å¤ç”¨ï¼Œä½†æ˜¯å®¹æ˜“é€ æˆç«¯å£æ¥æ”¶æ•°æ®æ··ä¹±ï¼Œ4.12å†…æ ¸ç›´æ¥ç æ‰äº†ï¼Œè€å¸ˆæ˜¯å› ä¸ºå†…æ ¸å»æ‰äº†æ‰€ä»¥æ²¡æäº†å˜›","like_count":29,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464326,"discussion_content":"BINGOã€‚å¤ªå¤šäº†ï¼Œå¤§å®¶ä¹Ÿä¸å¥½æ¥å—ï¼Œæˆ‘æƒ³æˆ‘è¿˜æ˜¯ä¸æ±‚é¢é¢ä¿±åˆ°ï¼Œä½†æ±‚æœ‰æ‰€å¯å‘å’Œå¼•é¢†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567132423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1512599,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/88nXicqmkJWm3IXVfPfGQSk8SKIBVKjuC4qhzaCkf5Ud88uvKgS4Vf5AzCJ1uaFO0gpPnxdh4CowfhpxV1kSbXw/132","nickname":"lixin","note":"","ucode":"94D99DAFB6C929","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":584591,"discussion_content":"@è¶…å“¥ï¼Œçœ‹åˆ°ä½ äº†ã€‚è¶…å“¥å‰å®³ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660962005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"å¹¿ä¸œ"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126976,"user_name":"ä½•æŸäºº","can_delete":false,"product_type":"c1","uid":1604368,"ip_address":"","ucode":"8ADED58825D7B4","user_header":"https://static001.geekbang.org/account/avatar/00/18/7b/10/723a149c.jpg","comment_is_top":false,"comment_ctime":1566529686,"is_pvip":true,"replies":[{"id":"48215","content":"è¿™ä¸ªæ˜¯è§£å†³ç«¯å£å¤ç”¨çš„é—®é¢˜ï¼Œå¹¶ä¸æ˜¯è§£å†³TIME_WAITï¼Œè¿™ä¸ªæ˜¯å‘Šè¯‰å†…æ ¸ï¼Œå³ä½¿TIME_WAITçŠ¶æ€çš„å¥—æ¥å­—ï¼Œæˆ‘ä¹Ÿå¯ä»¥ç»§ç»­ä½¿ç”¨å®ƒåšä¸ºæ–°çš„å¥—é›†å­—ä½¿ç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567132777,"ip_address":"","comment_id":126976,"utype":1}],"discussion_count":6,"race_medal":0,"score":"134710515862","product_id":100032701,"comment_content":"è€å¸ˆï¼Œé‚£ä¹ˆé€šè¿‡setsockoptè®¾ç½®SO_REUSEADDRè¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿç½‘ä¸Šèµ„æ–™åŸºæœ¬ä¸Šéƒ½æ˜¯é€šè¿‡è®¾ç½®è¿™ä¸ªæ¥è§£å†³TIME_WAITã€‚è¿™ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆä¼˜åŠ£å—ï¼Ÿ","like_count":32,"discussions":[{"author":{"id":1214303,"avatar":"https://static001.geekbang.org/account/avatar/00/12/87/5f/6bf8b74a.jpg","nickname":"Kepler","note":"","ucode":"0C9CA3DB8B3CF0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8063,"discussion_content":"æ„æ€æ˜¯SO_REUSEADDRæ˜¯ä»¥æœåŠ¡ç«¯çš„è§’åº¦ä¸ºè§£å†³ç«¯å£è¢«å ç”¨çš„é—®é¢˜ï¼›\nè€Œæœ¬æ–‡æ‰€æåˆ°çš„è°ƒå°net.ipv4.tcp_max_tw_bucketsï¼Œ è®¾ç½®SO_LINGERï¼Œ è®¾ç½®net.ipv4.tcp_tw_reuse æ˜¯ä»¥å®¢æˆ·ç«¯çš„è§’åº¦é˜²æ­¢è¿‡å¤štime_waitçŠ¶æ€è€—å°½ç«¯å£å¯¼è‡´ä¸å¯ç”¨ï¼›æ˜¯å—ï¼Ÿ","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1567770897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1145650,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7b/32/60089a62.jpg","nickname":"æ¨é¢†well","note":"","ucode":"3974A03855168C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6163,"discussion_content":"TIME_WAIT çŠ¶æ€æ˜¯ä¸€å®šè¦æœ‰çš„ï¼Œ SO_REUSEADDR ä¹‹å‰åœ¨æœ€å¤§é™åº¦çš„å®ç°åœ°å€çš„é‡ç”¨ã€‚TCP è¿æ¥å¯ä»¥ç”¨å››å…ƒç»„(æœ¬ç«¯IP, æœ¬ç«¯port, å¯¹ç«¯IP, å¯¹ç«¯port)å”¯ä¸€ç¡®å®šã€‚å¦‚æœæ²¡æœ‰è®¾ç½® SO_REUSEADDRï¼Œ æœ¬ç«¯ IP éƒ½ä¸èƒ½é‡ç”¨ã€‚è€Œè®¾ç½®äº†çš„è¯ï¼Œåªè¦å››å…ƒç»„ä¸åŒï¼Œå°±å¯ä»¥é‡ç”¨ã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1566735973,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":3,"child_discussions":[{"author":{"id":1306092,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ61zTDmLk7IhLJn6seBPOwsVaKIWUWaxk5YmsdYBZUOYMQCsyl9iaQVSg9U5qJVLLOCFUoLUuYnRA/132","nickname":"fjpcode","note":"","ucode":"C32C5E3ECB9A90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1145650,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7b/32/60089a62.jpg","nickname":"æ¨é¢†well","note":"","ucode":"3974A03855168C","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":63951,"discussion_content":"ä½ çš„æœ€åä¸€å¥è¯å’Œæˆ‘å®é™…è¯•éªŒçš„ä¸ç›¸ç¬¦ï¼Œæˆ‘å®æµ‹åªè¦è®¾ç½®äº†SO_REUSEADDRå¤„äºTIME_WAITçŠ¶æ€çš„ç«¯å£èµ„æºï¼Œéƒ½å¯ä»¥è¢«é‡ç”¨ï¼Œä¸ç®¡å››å…ƒç»„ç›¸æ˜¯å¦ç›¸åŒã€‚","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1574925005,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":6163,"ip_address":""},"score":63951,"extra":""},{"author":{"id":1145650,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7b/32/60089a62.jpg","nickname":"æ¨é¢†well","note":"","ucode":"3974A03855168C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1306092,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ61zTDmLk7IhLJn6seBPOwsVaKIWUWaxk5YmsdYBZUOYMQCsyl9iaQVSg9U5qJVLLOCFUoLUuYnRA/132","nickname":"fjpcode","note":"","ucode":"C32C5E3ECB9A90","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":82656,"discussion_content":"å‘ƒï¼Œæ—¶é—´å¤ªä¹…äº†æˆ‘å¿˜äº†æŸ¥çš„å“ªçš„èµ„æ–™äº†ã€‚ç­‰æœ‰ç©ºæˆ‘å†æ‰¾æ‰¾ï¼Œç¡®è®¤ä¸€ä¸‹ã€‚æˆ‘çŒœæµ‹å¯èƒ½æ˜¯å®ç°ç‰ˆæœ¬çš„ä¸åŒå¯¼è‡´çš„å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576340358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":63951,"ip_address":""},"score":82656,"extra":""},{"author":{"id":1145650,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7b/32/60089a62.jpg","nickname":"æ¨é¢†well","note":"","ucode":"3974A03855168C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1306092,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ61zTDmLk7IhLJn6seBPOwsVaKIWUWaxk5YmsdYBZUOYMQCsyl9iaQVSg9U5qJVLLOCFUoLUuYnRA/132","nickname":"fjpcode","note":"","ucode":"C32C5E3ECB9A90","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":82657,"discussion_content":"å¦å¤–ä½ æ˜¯æ€ä¹ˆæµ‹çš„ï¼Ÿå¯ä»¥è¯´ä¸‹ä¹ˆï¼Ÿæˆ‘ä¹Ÿå»è¯•è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576340423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":63951,"ip_address":""},"score":82657,"extra":""}]},{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464267,"discussion_content":"è¿™ä¸ªæ˜¯è§£å†³ç«¯å£å¤ç”¨çš„é—®é¢˜ï¼Œå¹¶ä¸æ˜¯è§£å†³TIME_WAITï¼Œè¿™ä¸ªæ˜¯å‘Šè¯‰å†…æ ¸ï¼Œå³ä½¿TIME_WAITçŠ¶æ€çš„å¥—æ¥å­—ï¼Œæˆ‘ä¹Ÿå¯ä»¥ç»§ç»­ä½¿ç”¨å®ƒåšä¸ºæ–°çš„å¥—é›†å­—ä½¿ç”¨ã€‚","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1567132777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163861,"user_name":"é›·ç¥çš„ç››å®´","can_delete":false,"product_type":"c1","uid":1476048,"ip_address":"","ucode":"9D5357F3A79FF1","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/VZ96qlUtD0jEib5gn8mVthSm6sLJ66o1YRn4OgmCseGWBPw055Cw6sYyib5fRFiabnTzl2Nhuomc3qIhgRibkH6iakw/132","comment_is_top":false,"comment_ctime":1576812377,"is_pvip":false,"replies":[{"id":"63902","content":"å­¦åˆ°äº†","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1577604110,"ip_address":"","comment_id":163861,"utype":1}],"discussion_count":6,"race_medal":0,"score":"108950994777","product_id":100032701,"comment_content":"net.ipv4.tcp_tw_reuse è¦æ…ç”¨ï¼Œå½“å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¸»æœºæ—¶é—´ä¸åŒæ­¥æ—¶ï¼Œå®¢æˆ·ç«¯çš„å‘é€çš„æ¶ˆæ¯ä¼šè¢«ç›´æ¥æ‹’ç»æ‰","like_count":26,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":478561,"discussion_content":"å­¦åˆ°äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577604110,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1299095,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/97/5f4cd8da.jpg","nickname":"è™è™ç”Ÿå¨çš„ç¨‹åšå¼º","note":"","ucode":"321C89298D3682","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579186,"discussion_content":"è¿™ä¸ªä¸å¤ªå¯¹ï¼Œå¼€å¯äº†reuseï¼Œå³ä½¿æ—¶é’Ÿä¸åŒæ­¥ï¼Œåªè¦å®¢æˆ·ç«¯æ—¶é—´æˆ³æ˜¯é€’å¢çš„å°±è¡Œï¼ŒæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„åŒ…åä¼šä¿ç•™ä¸Šæ¬¡æ”¶åˆ°çš„æ—¶é—´æˆ³ï¼Œè¿™ä¸ªæ—¶é—´æˆ³æ˜¯å®¢æˆ·ç«¯çš„ï¼Œåªè¦æ˜¯é€’å¢å°±æ²¡é—®é¢˜ï¼Œreuseæœ€å¤§çš„é—®é¢˜æ˜¯å‘rståŒ…æ—¶ä¸ä¼šåŠ æ—¶é—´æˆ³ï¼ˆæœ‰å†…æ ¸æºç ä¸ºè¯ï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿æ¥è¢«å¼‚å¸¸å…³é—­ï¼Œè¿™æ‰æ˜¯ä¸èƒ½ä¹±ç”¨reuseçš„æ ¹æœ¬åŸå› ","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1657245299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1002005,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/4a/15/106eaaa8.jpg","nickname":"stackWarn","note":"","ucode":"89672E452DEBA5","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293057,"discussion_content":"reuseæ²¡é—®é¢˜ï¼Œrecle æœ‰é—®é¢˜ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1595424115,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1013128,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/75/88/fd024a11.jpg","nickname":"æœ±éœ‡éœ‡","note":"","ucode":"6E8AE4506255AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373524,"discussion_content":"æ‚¨è¯´çš„ä¹±è·³æŒ‡çš„æ˜¯ä»€ä¹ˆæƒ…å†µï¼Ÿä¸¤å°æœºå™¨æ—¶é—´ä¸Šæœ‰å·®å¼‚æ˜¯ä¸Šè¿°è¿™ç§æƒ…å†µå—ï¼Ÿè¯¯å·®åˆ°å¤šå°‘ä¼šäº§ç”Ÿè¿™ç§æƒ…å†µ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620777231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1803259,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/83/fb/621adceb.jpg","nickname":"linker","note":"","ucode":"6C5799F2FC2C82","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":203922,"discussion_content":"ä¸€èˆ¬æƒ…å†µæ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´æœ‰natè½¬å‘çš„æƒ…å†µï¼Œæ—¶é—´ä¸åŒæ­¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584102085,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1959482,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/e6/3a/382cf024.jpg","nickname":"rongyefeng","note":"","ucode":"9A15D947E9D645","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1803259,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/83/fb/621adceb.jpg","nickname":"linker","note":"","ucode":"6C5799F2FC2C82","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267344,"discussion_content":"ç¡®åˆ‡åœ°è¯´ï¼Œå¦‚æœå®¢æˆ·ç«¯çš„æ—¶é—´ä¼šä¹±è·³ï¼Œæ²¡æœ‰ä¸æœåŠ¡ç«¯ä¿æŒåŒæ­¥ï¼ˆå¹¶ä¸ä¸€å®šç›¸åŒï¼‰ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ç«¯å¯èƒ½ä¼šå¤§é‡ä¸¢åŒ…ã€‚","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1589635214,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":203922,"ip_address":""},"score":267344,"extra":""}]}]},{"had_liked":false,"id":126983,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1566530523,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"96055811035","product_id":100032701,"comment_content":"1.  MSLçš„æ„æ€æ˜¯æœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½ã€‚IPå¤´éƒ¨ä¸­æœ‰ä¸ªTTLå­—æ®µæ„æ€æ˜¯ç”Ÿå­˜æ—¶é—´ã€‚TTLæ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨å°±å‡1ï¼Œåˆ°0å°±ä¼šè¢«ä¸¢å¼ƒï¼Œè€ŒMSLæ˜¯ç”±RFCé‡Œé¢è§„å®šçš„2åˆ†é’Ÿï¼Œä½†å®é™…åœ¨å·¥ç¨‹ä¸Š2åˆ†é’Ÿå¤ªé•¿ï¼Œå› æ­¤TCPå…è®¸æ ¹æ®å…·ä½“çš„æƒ…å†µé…ç½®å¤§å°ï¼ŒTTLä¸MSLæ˜¯æœ‰å…³ç³»çš„ä½†ä¸æ˜¯ç®€å•çš„ç›¸ç­‰å…³ç³»ï¼ŒMSLè¦å¤§äºTTLã€‚MSLå†…éƒ¨åº”è¯¥å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„å®šæ—¶å™¨å®ç°çš„ã€‚<br>2.ä¸éœ€è¦ç»Ÿä¸€æ—¶é’Ÿï¼Œå¯ä»¥åœ¨ç¬¬ä¸€æ¬¡äº¤æ¢åŒæ–¹çš„æ—¶é’Ÿï¼Œä¹‹åç”¨ç›¸å¯¹æ—¶é—´å°±å¯ä»¥äº†ã€‚","like_count":22,"discussions":[{"author":{"id":1181650,"avatar":"https://static001.geekbang.org/account/avatar/00/12/07/d2/0d7ee298.jpg","nickname":"æƒ˜ é—»","note":"","ucode":"C5909F034BF072","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304539,"discussion_content":"æ–‡ä¸­è¯´2MSLåœ¨linuxé‡Œæ˜¯60ç§’ã€‚æ‰€ä»¥å°±æ˜¯linuxå°†RFCè§„å®šçš„MSLçš„æ—¶é—´æ”¹ä¸ºäº† 30ç§’å—ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599610638,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130900,"user_name":"AnonymousUser","can_delete":false,"product_type":"c1","uid":1243930,"ip_address":"","ucode":"E03CB1EDD9775B","user_header":"https://static001.geekbang.org/account/avatar/00/12/fb/1a/57480c9c.jpg","comment_is_top":false,"comment_ctime":1567568587,"is_pvip":false,"replies":[{"id":"50834","content":"æ€»ç»“å¾ˆåˆ°ä½ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568195810,"ip_address":"","comment_id":130900,"utype":1}],"discussion_count":2,"race_medal":0,"score":"83171947211","product_id":100032701,"comment_content":"TIME_WAITçš„ä½œç”¨ï¼š<br>1ï¼‰ ç¡®ä¿å¯¹æ–¹èƒ½å¤Ÿæ­£ç¡®æ”¶åˆ°æœ€åçš„ACKï¼Œå¸®åŠ©å…¶å…³é—­ï¼›<br>2ï¼‰ é˜²è¿·èµ°æŠ¥æ–‡å¯¹ç¨‹åºå¸¦æ¥çš„å½±å“ã€‚<br>TIME_WAITçš„å±å®³ï¼š<br>1ï¼‰ å ç”¨å†…å­˜ï¼›<br>2ï¼‰ å ç”¨ç«¯å£ã€‚","like_count":20,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466186,"discussion_content":"æ€»ç»“å¾ˆåˆ°ä½ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568195810,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2Az5uTh9ZGVA7yQCj1BXtXuicPRkvJicA97AoN9xX3bnPcUYglTMXJeZeoVbPQeJA7ICvQhR3KQ0w/132","nickname":"æ—¥ä¸è½å¸å›½","note":"","ucode":"6A11ABBD8AC438","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25514,"discussion_content":"å­¦ä¹ å­¦ä¹ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570535271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":200152,"user_name":"å¼ å¤©å±¹","can_delete":false,"product_type":"c1","uid":1477612,"ip_address":"","ucode":"8BD6BD6DCF0F4F","user_header":"https://static001.geekbang.org/account/avatar/00/16/8b/ec/dc03f5ad.jpg","comment_is_top":false,"comment_ctime":1585551070,"is_pvip":false,"replies":[{"id":"75775","content":"å¸®æˆ‘å›ç­”äº†ï¼Œèµ","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1586076140,"ip_address":"","comment_id":200152,"utype":1}],"discussion_count":4,"race_medal":0,"score":"61715093214","product_id":100032701,"comment_content":"æ–‡ä¸­çš„é—®é¢˜æœ‰ä¸ªå‰æï¼Œå¿…é¡»æ˜¯ç›‘å¬çš„ç«¯å£ã€‚æˆ‘çœ‹æœ‰è¯„è®ºæåˆ°80,8080è¿™ç§æœåŠ¡ï¼Œæ˜¯å¦åªèƒ½åŒæ—¶è®¿é—®ä¸€æ¬¡ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚å› ä¸ºç½‘ç»œä¸­çš„æœåŠ¡åˆ†ä¸ºç›‘å¬ç«¯å£å’Œè¿æ¥ç«¯å£ï¼Œå½“å»ºç«‹ä¸€ä¸ªè¿æ¥ä¹‹åï¼Œç›‘å¬ç«¯å£æ˜¯ä¸è¢«å ç”¨çš„ï¼Œæ­¤æ—¶ä¼šç”¨ä¸€ä¸ªæ–°çš„ç«¯å£æ¥å»ºç«‹è¿æ¥ï¼Œè€Œä¸”å°±ç®—æ˜¯æ–°çš„ç«¯å£ï¼Œä¸€ä¸ªTCPè¿æ¥ä¹Ÿæ˜¯ï¼ˆå®¢æˆ·ç«¯ip,å®¢æˆ·ç«¯ç«¯å£ ï¼ŒæœåŠ¡ç«¯ipï¼ŒæœåŠ¡ç«¯ç«¯å£ï¼‰å…±åŒå†³å®šçš„ï¼Œä¸å†²çªã€‚","like_count":14,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489949,"discussion_content":"å¸®æˆ‘å›ç­”äº†ï¼Œèµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586076140,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1140056,"avatar":"https://static001.geekbang.org/account/avatar/00/11/65/58/359fb757.jpg","nickname":"Gothic","note":"","ucode":"1094AE331F91EF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":305296,"discussion_content":"ä½ è¯´çš„æ˜¯ç›‘å¬socketå’Œè¿æ¥socketå§ï¼Œæ²¡å¬è¯´è¿‡è¿æ¥ç«¯å£ï¼ŒæœåŠ¡ç«¯ä¸æ˜¯é€šè¿‡acceptå‡½æ•°è¿”å›ä¸€ä¸ªæ–°çš„tcpè¿æ¥socketå—ï¼Ÿè·Ÿç«¯å£æœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1599853932,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1452675,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJhbjhkN9mVxxA3wfMCmZ5BmoFVHXyaOkqDH5uRXGQNFngDdJDYqkf82ictdicZ9WibLjoiapcom4XbGw/132","nickname":"æœ¨æ˜“","note":"","ucode":"7CCA6255570E6C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296158,"discussion_content":"æœåŠ¡ç«¯å“ªæ¥çš„è¿æ¥ç«¯å£ï¼Œä¸æ˜¯åªæœ‰ä¸€ä¸ªç«¯å£(ç›‘å¬ç«¯å£å—)ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1596462513,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1135701,"avatar":"https://static001.geekbang.org/account/avatar/00/11/54/55/613ddc42.jpg","nickname":"Edison","note":"","ucode":"734A561F363720","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552329,"discussion_content":"å›ç­”ä¸å¯¹ï¼Œè¿™ä¸ªæŠ“ä¸ªåŒ…å°±å¯ä»¥çœ‹å¾—å‡ºæ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645414531,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126956,"user_name":"alan","can_delete":false,"product_type":"c1","uid":1083425,"ip_address":"","ucode":"2CA8D0B6B7D5A9","user_header":"https://static001.geekbang.org/account/avatar/00/10/88/21/50b2418a.jpg","comment_is_top":false,"comment_ctime":1566525621,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"44516198581","product_id":100032701,"comment_content":"TIME_WAITçš„ä½œç”¨ï¼š<br>1. ç¡®ä¿ä¸»åŠ¨æ–­å¼€æ–¹çš„æœ€åä¸€ä¸ªACKæˆåŠŸå‘åˆ°å¯¹æ–¹<br>2. ç¡®ä¿æ®‹ç•™çš„TCPåŒ…è‡ªç„¶æ¶ˆäº¡","like_count":10,"discussions":[{"author":{"id":1154101,"avatar":"https://static001.geekbang.org/account/avatar/00/11/9c/35/9dc79371.jpg","nickname":"ä½ å¥½æ—…è¡Œè€…","note":"","ucode":"5C72A428DC28F3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":19998,"discussion_content":"è€å“¥ä½ è¿™æ‹¾äººç‰™æ…§æ²¡ä»€ä¹ˆæ„æ€çš„å‘€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1569247502,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":175242,"user_name":"ä¸¹æ«æ— è¿¹","can_delete":false,"product_type":"c1","uid":1218765,"ip_address":"","ucode":"61A508C2464AF3","user_header":"https://static001.geekbang.org/account/avatar/00/12/98/cd/d85c6361.jpg","comment_is_top":false,"comment_ctime":1580627274,"is_pvip":false,"replies":[{"id":"71012","content":"è¿™æ˜¯å› ä¸ºæ—¶é—´æˆ³ä¼šå‘Šè¯‰æˆ‘ä»¬æŠ¥æ–‡å‘é€çš„æ—¶é—´ï¼Œè¿™æ ·åœ¨è¿·èµ°æŠ¥æ–‡å’Œæ­£ç¡®æŠ¥æ–‡åŒæ—¶åˆ°è¾¾çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ†è¾¨å‡ºåº”è¯¥ä¸¢å¼ƒæ‰é‚£ä¸ªæŠ¥æ–‡ï¼Œå¹¶ä¸ä¼šå¯¹æœ€åæ”¶åˆ°çš„æŠ¥æ–‡äº§ç”Ÿä»»ä½•ä¸åˆ©çš„å½±å“ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1583050094,"ip_address":"","comment_id":175242,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35940365642","product_id":100032701,"comment_content":"ç”±äºå¼•å…¥äº†æ—¶é—´æˆ³ï¼Œæˆ‘ä»¬åœ¨å‰é¢æåˆ°çš„ 2MSL é—®é¢˜å°±ä¸å¤å­˜åœ¨äº†ï¼Œå› ä¸ºé‡å¤çš„æ•°æ®åŒ…ä¼šå› ä¸ºæ—¶é—´æˆ³è¿‡æœŸè¢«è‡ªç„¶ä¸¢å¼ƒã€‚<br>è¿™ä¸ªæ²¡ç†è§£ï¼Œä¸ºä»€ä¹ˆ 2MSL é—®é¢˜å°±ä¸å­˜åœ¨äº†ï¼Ÿè€å¸ˆèƒ½è§£é‡Šä¸‹å—ï¼Ÿ","like_count":8,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482664,"discussion_content":"è¿™æ˜¯å› ä¸ºæ—¶é—´æˆ³ä¼šå‘Šè¯‰æˆ‘ä»¬æŠ¥æ–‡å‘é€çš„æ—¶é—´ï¼Œè¿™æ ·åœ¨è¿·èµ°æŠ¥æ–‡å’Œæ­£ç¡®æŠ¥æ–‡åŒæ—¶åˆ°è¾¾çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ†è¾¨å‡ºåº”è¯¥ä¸¢å¼ƒæ‰é‚£ä¸ªæŠ¥æ–‡ï¼Œå¹¶ä¸ä¼šå¯¹æœ€åæ”¶åˆ°çš„æŠ¥æ–‡äº§ç”Ÿä»»ä½•ä¸åˆ©çš„å½±å“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583050094,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2221236,"avatar":"https://static001.geekbang.org/account/avatar/00/21/e4/b4/889954ca.jpg","nickname":"Levi","note":"","ucode":"F804879872BB76","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":536987,"discussion_content":"å¯æ˜¯è¿™ä¸ªè¿·èµ°çš„æŠ¥æ–‡å’Œæ–°çš„æŠ¥æ–‡ä¸ä¸€å®šå°±æ˜¯é‡å¤çš„å•Šï¼Œä»–æ€ä¹ˆå°±å…‰ä»æ—¶é—´ä¸Šåˆ¤æ–­å‘¢ï¼Ÿé‚£ä¸‡ä¸€è¿™ä¸¤ä¸ªæŠ¥æ–‡æ²¡æœ‰ä¸€èµ·åˆ°ï¼Œä¸€å‰ä¸€åæ€ä¹ˆåˆ¤æ–­å‘¢ï¼Ÿ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1638928701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":482664,"ip_address":""},"score":536987,"extra":""}]}]},{"had_liked":false,"id":161385,"user_name":"äº‘å¸ˆå…„","can_delete":false,"product_type":"c1","uid":1010459,"ip_address":"","ucode":"4475AF1598FBFD","user_header":"https://static001.geekbang.org/account/avatar/00/0f/6b/1b/4b397b80.jpg","comment_is_top":false,"comment_ctime":1576200555,"is_pvip":false,"replies":[{"id":"63927","content":"è¿™é‡Œé’ˆå¯¹çš„TIME_WAITæ˜¯æŒ‡ä¸»åŠ¨å…³é—­çš„ä¸€æ–¹ï¼Œä¸ä¸€å®šæ˜¯å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨ç«¯ï¼Œå¦‚æœæœåŠ¡å™¨ç«¯ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œä¹Ÿæ˜¯å±äºè¿™æ ·çš„èŒƒç•´çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1577605161,"ip_address":"","comment_id":161385,"utype":1}],"discussion_count":1,"race_medal":0,"score":"35935938923","product_id":100032701,"comment_content":"Reuseåªé€‚ç”¨äºè¿æ¥å‘èµ·æ–¹ï¼ˆC&#47;S æ¨¡å‹ä¸­çš„å®¢æˆ·ç«¯ï¼‰ï¼Œä½†ç›®å‰è¦è§£å†³çš„æ˜¯æœåŠ¡ç«¯è¿æ¥ä¸è¶³é—®é¢˜ï¼Œè¿™ä¸ªæ–¹æ³•è¦å¦‚ä½•å‘æŒ¥ä½œç”¨å‘¢ï¼Ÿ","like_count":9,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":477703,"discussion_content":"è¿™é‡Œé’ˆå¯¹çš„TIME_WAITæ˜¯æŒ‡ä¸»åŠ¨å…³é—­çš„ä¸€æ–¹ï¼Œä¸ä¸€å®šæ˜¯å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨ç«¯ï¼Œå¦‚æœæœåŠ¡å™¨ç«¯ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œä¹Ÿæ˜¯å±äºè¿™æ ·çš„èŒƒç•´çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1577605161,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128076,"user_name":"å´å…‰åº†","can_delete":false,"product_type":"c1","uid":1454851,"ip_address":"","ucode":"E25B166295C3EC","user_header":"https://static001.geekbang.org/account/avatar/00/16/33/03/3f2df287.jpg","comment_is_top":false,"comment_ctime":1566828245,"is_pvip":false,"replies":[{"id":"47930","content":"å› ä¸ºæ˜¯ä¸€æ¥ä¸€è¿”ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567005383,"ip_address":"","comment_id":128076,"utype":1}],"discussion_count":2,"race_medal":0,"score":"35926566613","product_id":100032701,"comment_content":"ä¸ºä»€ä¹ˆæ˜¯2MSLï¼Œä¸æ˜¯3 MSLï¼Œ4 MSLã€‚","like_count":8,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464781,"discussion_content":"å› ä¸ºæ˜¯ä¸€æ¥ä¸€è¿”ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567005383,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1619756,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b7/2c/e1682683.jpg","nickname":"YidWang","note":"","ucode":"C91A9117EC3540","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6359,"discussion_content":"æˆ‘ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566868851,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":132302,"user_name":"JasonZhi","can_delete":false,"product_type":"c1","uid":1282818,"ip_address":"","ucode":"6C23DCD592636D","user_header":"https://static001.geekbang.org/account/avatar/00/13/93/02/fcab58d1.jpg","comment_is_top":false,"comment_ctime":1568080533,"is_pvip":true,"replies":[{"id":"50768","content":"å“ˆå“ˆï¼Œæå‰å‰§é€å•Šã€‚<br><br>è¿™æ˜¯ä¸ºäº†è§£å†³å¦‚ä½•å¿«é€Ÿå¤ç”¨å¤„äºTIME_WAITçš„è¿æ¥ï¼Œå¦‚æœä¸è®¾ç½®è¿™ä¸ªé€‰é¡¹ï¼Œå¤„äºTIME_WAITçš„è¿æ¥æ˜¯ä¸èƒ½è¢«å¿«é€Ÿå¤ç”¨çš„ï¼Œå¿…é¡»ç­‰å¾…ç³»ç»Ÿå›æ”¶è¿æ¥æ‰å¯ä»¥ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™å¼€å¯æœåŠ¡å™¨ç«¯å£ï¼Œä¼šæŠ¥åœ°å€å·²è¢«å ç”¨çš„é”™è¯¯ã€‚<br><br>è¿™å—åœ¨ç¬¬15è®²é‡Œä¼šæœ‰è¯¦ç»†é˜è¿°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568184656,"ip_address":"","comment_id":132302,"utype":1}],"discussion_count":1,"race_medal":0,"score":"31632851605","product_id":100032701,"comment_content":"SO_REUSEADDRå’ŒSO_REUSEPORTå¯ä»¥è¯¦ç»†è¯´ä¸‹ä½œç”¨å—ï¼Ÿæœ‰ç‚¹è¿·ç³Šï¼Œæ–‡ç« éƒ½æ²¡æœ‰è¯´æ˜è¿™ä¸¤ä¸ªå‚æ•°ï¼Œè¯„è®ºåŒºå°±å†’å‡ºä¸€å¤§å †å…³äºè¿™ä¸¤ä¸ªå‚æ•°çš„è¯„è®ºã€‚","like_count":7,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466865,"discussion_content":"å“ˆå“ˆï¼Œæå‰å‰§é€å•Šã€‚\n\nè¿™æ˜¯ä¸ºäº†è§£å†³å¦‚ä½•å¿«é€Ÿå¤ç”¨å¤„äºTIME_WAITçš„è¿æ¥ï¼Œå¦‚æœä¸è®¾ç½®è¿™ä¸ªé€‰é¡¹ï¼Œå¤„äºTIME_WAITçš„è¿æ¥æ˜¯ä¸èƒ½è¢«å¿«é€Ÿå¤ç”¨çš„ï¼Œå¿…é¡»ç­‰å¾…ç³»ç»Ÿå›æ”¶è¿æ¥æ‰å¯ä»¥ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™å¼€å¯æœåŠ¡å™¨ç«¯å£ï¼Œä¼šæŠ¥åœ°å€å·²è¢«å ç”¨çš„é”™è¯¯ã€‚\n\nè¿™å—åœ¨ç¬¬15è®²é‡Œä¼šæœ‰è¯¦ç»†é˜è¿°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568184656,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221131,"user_name":"pc","can_delete":false,"product_type":"c1","uid":1652836,"ip_address":"","ucode":"1AD538B9A900B6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epKJlW7sqts2ZbPuhMbseTAdvHWnrc4ficAeSZyKibkvn6qyxflPrkKKU3mH6XCNmYvDg11tB6y0pxg/132","comment_is_top":false,"comment_ctime":1590413454,"is_pvip":false,"replies":[{"id":"82181","content":"æˆ‘ä¸€ç›´éƒ½åœ¨å›å¤çš„å“¦ï¼Œå’Œå¤§å®¶åœ¨ä¸€èµ·è‡ªå·±ä¹Ÿå­¦åˆ°ä¸å°‘ï¼Œå“ˆå“ˆã€‚<br><br>ä»¥ä¸‹è¯•ç€å›ç­”ä½ çš„é—®é¢˜ï¼š<br><br>1ã€çœ‹åˆ°è¯„è®ºåŒºçš„â€œé€šè¿‡setsockoptè®¾ç½®SO_REUSEADDRè¿™ä¸ªæ–¹æ³•â€ï¼Œæ„Ÿè§‰å’Œnet.ipv4.tcp_tw_reuseé€‰é¡¹çš„ä½œç”¨ä¹Ÿå¾ˆåƒï¼Œéƒ½æ˜¯ç«¯å£å¤ç”¨ï¼Œåªæ˜¯åè€…æ˜¯åœ¨å®‰å…¨å¯æ§çš„åŸºç¡€ä¸Š---è¿™æ ·ç†è§£å¯¹å—ï¼Ÿ<br><br>æˆ‘è®¤ä¸ºä¸å¯¹å“¦ï¼Œå‰è€…æ˜¯é’ˆå¯¹æœåŠ¡ç«¯è¿æ¥åœ°å€è¢«å ç”¨çš„æƒ…å†µï¼Œåè€…æ˜¯é’ˆå¯¹è¿æ¥å‘èµ·æ–¹ï¼›<br><br>2ã€è€å¸ˆåœ¨æ–‡ä¸­è¯´çš„â€œè¿‡äº†2MLSè¿™ä¸ªæ—¶é—´ä¹‹åï¼Œä¸»æœº 1 å°±è¿›å…¥ CLOSED çŠ¶æ€â€ï¼Œæˆ‘è‡ªå·±è¿˜æ˜¯æ²¡æœ‰æ€»ç»“å‡ºç­”æ¡ˆï¼Œæ˜¯è¯„è®ºåŒºæ‰€è¯´çš„â€œå»æ—¶ACKçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰+æ¥æ—¶FIINçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰ = 2MSLâ€è¿™ä¸ªåŸå› å—ï¼Ÿ<br><br>ä½ çš„æ„æ€æ˜¯ä¸ºä»€ä¹ˆè¦åˆ¶å®š2MSLè¿™ä¸ªæ—¶é—´æ®µæ‰CLOSEDæ˜¯ä¹ˆï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œè¯„è®ºå»çš„&quot;å»æ—¶ACKçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰+æ¥æ—¶FIINçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰ = 2MSL&quot;ç®—æ˜¯ä¸€ä¸ªé è°±çš„ç†è§£å§ã€‚<br><br><br>3ã€TIME_WAIT=2MLSå’ŒTCP_TIMEWAIT_LENæœ‰å•¥å…³ç³»ï¼Ÿæ˜¯ï¼šTIME_WAITå®é™…ä¸Šæ˜¯ç”±TCP_TIMEWAIT_LENæ§åˆ¶ï¼Œç„¶ååªä¸è¿‡å…¶å€¼çº¦ç­‰äº2MLSæ¥æ§åˆ¶è¿·èµ°æŠ¥æ–‡çš„æ¶ˆäº¡ è¿™æ ·ä¹ˆï¼Ÿ<br>TIME_WAITæ˜¯ä¸€ä¸ªæŠ½è±¡çš„å®šä¹‰ï¼Œè€ŒTCP_TIMEWAIT_LENæ˜¯Linuxé»˜è®¤çš„å€¼ï¼Œæ˜¯ä¸€ä¸ªå¸¸é‡ã€‚ä½ çš„è®¤è¯†æ˜¯å¯¹çš„<br><br>4ã€æ–‡ä¸­è¯´TCP_TIMEWAIT_LENã€net.ipv4.tcp_tw_reuseéƒ½æ˜¯linuxçš„é€‰é¡¹ï¼Œä½†æ˜¯å®¢æˆ·ç«¯æ¥è¯´çš„è¯ï¼Œæœ‰androidã€iosã€windowså„ç§ç³»ç»Ÿå§ï¼Ÿæ˜¯æ¯ä¸ªç³»ç»Ÿéƒ½æœ‰ç±»ä¼¼çš„æ§åˆ¶é€‰é¡¹ä¹ˆï¼Ÿ<br>Androidæ˜¯è£å‰ªè¿‡çš„Linuxï¼Œåº”è¯¥å¯ä»¥å¤ç”¨ï¼›å…¶ä»–ä¸¤ä¸ªæˆ‘ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œæƒ³å¿…åº”è¯¥æœ‰è‡ªå·±çš„æ§åˆ¶é€‰é¡¹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1590932187,"ip_address":"","comment_id":221131,"utype":1}],"discussion_count":1,"race_medal":0,"score":"23065249934","product_id":100032701,"comment_content":"å…ˆè¯´ç‚¹å…¶ä»–çš„å§ï¼šçœ‹å®Œäº†åŸºç¡€ç¯‡ï¼Œæ”¶è·äº†å¾ˆå¤šï¼Œä¹Ÿæ›´åŠ æœŸå¾…åé¢çš„å†…å®¹ï¼ˆæœ¬æ¥å°±æ˜¯å†²ç€time_waitå’Œepollæ¥åˆ°è¿™ä¸ªè¯¾ç¨‹ï¼‰ã€‚å½“ç„¶å…¶ä¸­ä¹Ÿé‡åˆ°å¾ˆå¤šé—®é¢˜ï¼Œå…¶ä¸­ä¹Ÿåœ¨è¯„è®ºåŒºæäº†ä¸¤ä¸ªã€‚æœ¬æ¥ä»¥ä¸ºè¿™ä¹ˆé•¿æ—¶é—´äº†è€å¸ˆä¹Ÿä¸ä¼šå†å›å¤äº†ï¼Œå‘¨æœ«ä¸€çœ‹ï¼Œç«Ÿç„¶å›å¤äº†æˆ‘çš„é—®é¢˜ï¼å…¶å®ä¸€è¾¹æ˜¯å¼€å¿ƒï¼Œå¦ä¸€è¾¹æ˜¯å¾—åˆ°ç­”æ¡ˆçš„å¼€å¿ƒï¼ˆå…¶å®è‡ªå·±ä¹Ÿæœç´¢è¿‡ï¼Œä½†æ˜¯æ„Ÿè§‰æœåˆ°æ–‡ç« éƒ½ä¸æ˜¯æˆ‘æƒ³é—®çš„å†…å®¹ï¼‰ã€‚<br><br>ã€æé—®å•¦ï½ã€‘<br>1ã€çœ‹åˆ°è¯„è®ºåŒºçš„â€œé€šè¿‡setsockoptè®¾ç½®SO_REUSEADDRè¿™ä¸ªæ–¹æ³•â€ï¼Œæ„Ÿè§‰å’Œnet.ipv4.tcp_tw_reuseé€‰é¡¹çš„ä½œç”¨ä¹Ÿå¾ˆåƒï¼Œéƒ½æ˜¯ç«¯å£å¤ç”¨ï¼Œåªæ˜¯åè€…æ˜¯åœ¨å®‰å…¨å¯æ§çš„åŸºç¡€ä¸Š---è¿™æ ·ç†è§£å¯¹å—ï¼Ÿ<br>2ã€è€å¸ˆåœ¨æ–‡ä¸­è¯´çš„â€œè¿‡äº†2MLSè¿™ä¸ªæ—¶é—´ä¹‹åï¼Œä¸»æœº 1 å°±è¿›å…¥ CLOSED çŠ¶æ€â€ï¼Œæˆ‘è‡ªå·±è¿˜æ˜¯æ²¡æœ‰æ€»ç»“å‡ºç­”æ¡ˆï¼Œæ˜¯è¯„è®ºåŒºæ‰€è¯´çš„â€œå»æ—¶ACKçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰+æ¥æ—¶FIINçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰ = 2MSLâ€è¿™ä¸ªåŸå› å—ï¼Ÿ<br>3ã€TIME_WAIT=2MLSå’ŒTCP_TIMEWAIT_LENæœ‰å•¥å…³ç³»ï¼Ÿæ˜¯ï¼šTIME_WAITå®é™…ä¸Šæ˜¯ç”±TCP_TIMEWAIT_LENæ§åˆ¶ï¼Œç„¶ååªä¸è¿‡å…¶å€¼çº¦ç­‰äº2MLSæ¥æ§åˆ¶è¿·èµ°æŠ¥æ–‡çš„æ¶ˆäº¡ è¿™æ ·ä¹ˆï¼Ÿ<br>4ã€æ–‡ä¸­è¯´TCP_TIMEWAIT_LENã€net.ipv4.tcp_tw_reuseéƒ½æ˜¯linuxçš„é€‰é¡¹ï¼Œä½†æ˜¯å®¢æˆ·ç«¯æ¥è¯´çš„è¯ï¼Œæœ‰androidã€iosã€windowså„ç§ç³»ç»Ÿå§ï¼Ÿæ˜¯æ¯ä¸ªç³»ç»Ÿéƒ½æœ‰ç±»ä¼¼çš„æ§åˆ¶é€‰é¡¹ä¹ˆï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":496346,"discussion_content":"æˆ‘ä¸€ç›´éƒ½åœ¨å›å¤çš„å“¦ï¼Œå’Œå¤§å®¶åœ¨ä¸€èµ·è‡ªå·±ä¹Ÿå­¦åˆ°ä¸å°‘ï¼Œå“ˆå“ˆã€‚\n\nä»¥ä¸‹è¯•ç€å›ç­”ä½ çš„é—®é¢˜ï¼š\n\n1ã€çœ‹åˆ°è¯„è®ºåŒºçš„â€œé€šè¿‡setsockoptè®¾ç½®SO_REUSEADDRè¿™ä¸ªæ–¹æ³•â€ï¼Œæ„Ÿè§‰å’Œnet.ipv4.tcp_tw_reuseé€‰é¡¹çš„ä½œç”¨ä¹Ÿå¾ˆåƒï¼Œéƒ½æ˜¯ç«¯å£å¤ç”¨ï¼Œåªæ˜¯åè€…æ˜¯åœ¨å®‰å…¨å¯æ§çš„åŸºç¡€ä¸Š---è¿™æ ·ç†è§£å¯¹å—ï¼Ÿ\n\næˆ‘è®¤ä¸ºä¸å¯¹å“¦ï¼Œå‰è€…æ˜¯é’ˆå¯¹æœåŠ¡ç«¯è¿æ¥åœ°å€è¢«å ç”¨çš„æƒ…å†µï¼Œåè€…æ˜¯é’ˆå¯¹è¿æ¥å‘èµ·æ–¹ï¼›\n\n2ã€è€å¸ˆåœ¨æ–‡ä¸­è¯´çš„â€œè¿‡äº†2MLSè¿™ä¸ªæ—¶é—´ä¹‹åï¼Œä¸»æœº 1 å°±è¿›å…¥ CLOSED çŠ¶æ€â€ï¼Œæˆ‘è‡ªå·±è¿˜æ˜¯æ²¡æœ‰æ€»ç»“å‡ºç­”æ¡ˆï¼Œæ˜¯è¯„è®ºåŒºæ‰€è¯´çš„â€œå»æ—¶ACKçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰+æ¥æ—¶FIINçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰ = 2MSLâ€è¿™ä¸ªåŸå› å—ï¼Ÿ\n\nä½ çš„æ„æ€æ˜¯ä¸ºä»€ä¹ˆè¦åˆ¶å®š2MSLè¿™ä¸ªæ—¶é—´æ®µæ‰CLOSEDæ˜¯ä¹ˆï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œè¯„è®ºå»çš„&amp;quot;å»æ—¶ACKçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰+æ¥æ—¶FIINçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰ = 2MSL&amp;quot;ç®—æ˜¯ä¸€ä¸ªé è°±çš„ç†è§£å§ã€‚\n\n\n3ã€TIME_WAIT=2MLSå’ŒTCP_TIMEWAIT_LENæœ‰å•¥å…³ç³»ï¼Ÿæ˜¯ï¼šTIME_WAITå®é™…ä¸Šæ˜¯ç”±TCP_TIMEWAIT_LENæ§åˆ¶ï¼Œç„¶ååªä¸è¿‡å…¶å€¼çº¦ç­‰äº2MLSæ¥æ§åˆ¶è¿·èµ°æŠ¥æ–‡çš„æ¶ˆäº¡ è¿™æ ·ä¹ˆï¼Ÿ\nTIME_WAITæ˜¯ä¸€ä¸ªæŠ½è±¡çš„å®šä¹‰ï¼Œè€ŒTCP_TIMEWAIT_LENæ˜¯Linuxé»˜è®¤çš„å€¼ï¼Œæ˜¯ä¸€ä¸ªå¸¸é‡ã€‚ä½ çš„è®¤è¯†æ˜¯å¯¹çš„\n\n4ã€æ–‡ä¸­è¯´TCP_TIMEWAIT_LENã€net.ipv4.tcp_tw_reuseéƒ½æ˜¯linuxçš„é€‰é¡¹ï¼Œä½†æ˜¯å®¢æˆ·ç«¯æ¥è¯´çš„è¯ï¼Œæœ‰androidã€iosã€windowså„ç§ç³»ç»Ÿå§ï¼Ÿæ˜¯æ¯ä¸ªç³»ç»Ÿéƒ½æœ‰ç±»ä¼¼çš„æ§åˆ¶é€‰é¡¹ä¹ˆï¼Ÿ\nAndroidæ˜¯è£å‰ªè¿‡çš„Linuxï¼Œåº”è¯¥å¯ä»¥å¤ç”¨ï¼›å…¶ä»–ä¸¤ä¸ªæˆ‘ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œæƒ³å¿…åº”è¯¥æœ‰è‡ªå·±çš„æ§åˆ¶é€‰é¡¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590932187,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":137709,"user_name":"tongmin_tsai","can_delete":false,"product_type":"c1","uid":1045090,"ip_address":"","ucode":"D9423E770D5846","user_header":"https://static001.geekbang.org/account/avatar/00/0f/f2/62/f873cd8f.jpg","comment_is_top":false,"comment_ctime":1569827691,"is_pvip":false,"replies":[{"id":"53874","content":"åªè¦æ¯æ¬¡ç»è¿‡ä¸€è·³çš„æ—¶é—´è‚¯å®šå¤§äº1ç§’ä»¥ä¸Šå°±å¯ä»¥äº†ï¼Œå®é™…å¤„ç†çš„æ—¶é—´è‚¯å®šå¤§äºè¿™ä¸ªå€¼çš„ã€‚<br><br>2MSLè®¾ç½®çš„ä¸º60ç§’ï¼ŒTTLè®¾ç½®ä¸º60ï¼Œåªæœ‰æ¯æ¬¡ä¸€è·³éƒ½å¤§äº1ç§’ï¼Œé‚£ä¹ˆè‚¯å®šæ—¶é—´æ€»å’Œå¤§äº60ç§’äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1570699798,"ip_address":"","comment_id":137709,"utype":1}],"discussion_count":5,"race_medal":0,"score":"23044664171","product_id":100032701,"comment_content":"è€å¸ˆï¼Œæˆ‘æœ‰ç–‘é—®çš„æ˜¯ï¼ŒIPåŒ…ä¸­TTLæ¯ç»è¿‡ä¸€æ¬¡è·¯ç”±å°±å°‘1ï¼Œé‚£ä¹ˆ2MSLæ€ä¹ˆç¡®ä¿å¯ä»¥ä¸€å®šå¤§äºTTLçš„ï¼Ÿ","like_count":5,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469223,"discussion_content":"åªè¦æ¯æ¬¡ç»è¿‡ä¸€è·³çš„æ—¶é—´è‚¯å®šå¤§äº1ç§’ä»¥ä¸Šå°±å¯ä»¥äº†ï¼Œå®é™…å¤„ç†çš„æ—¶é—´è‚¯å®šå¤§äºè¿™ä¸ªå€¼çš„ã€‚\n\n2MSLè®¾ç½®çš„ä¸º60ç§’ï¼ŒTTLè®¾ç½®ä¸º60ï¼Œåªæœ‰æ¯æ¬¡ä¸€è·³éƒ½å¤§äº1ç§’ï¼Œé‚£ä¹ˆè‚¯å®šæ—¶é—´æ€»å’Œå¤§äº60ç§’äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570699798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1682175,"avatar":"https://static001.geekbang.org/account/avatar/00/19/aa/ff/e2c331e0.jpg","nickname":"bbbi","note":"","ucode":"9A539AEF791428","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":36590,"discussion_content":"å¦‚æœæ¯ä¸€è·³æ—¶é—´å¤§äº1ç§’ï¼Œé‚£å°±æ˜¯ttlå¤§äº2msläº†å§ï¼Ÿ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1571395962,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1245504,"avatar":"https://static001.geekbang.org/account/avatar/00/13/01/40/a203a3b9.jpg","nickname":"çˆ±å­¦ä¹ ä¸å®³æ€•","note":"","ucode":"BE325C02E4C92F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1682175,"avatar":"https://static001.geekbang.org/account/avatar/00/19/aa/ff/e2c331e0.jpg","nickname":"bbbi","note":"","ucode":"9A539AEF791428","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295548,"discussion_content":"ttlæ˜¯ä»å‘é€æ–¹åˆ°æ¥æ”¶æ–¹çš„è·³æ•°å•Šï¼Œ2mslæ˜¯ä¸€æ¥ä¸€å›ï¼Œttlå¤§äº1mlä½†å¯èƒ½å°äº2msl","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596245755,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":36590,"ip_address":""},"score":295548,"extra":""}]},{"author":{"id":1052859,"avatar":"https://static001.geekbang.org/account/avatar/00/10/10/bb/f1061601.jpg","nickname":"Demon.Lee","note":"","ucode":"7F0E5493A8E345","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":580193,"discussion_content":"https://networkengineering.stackexchange.com/questions/68468/is-tcps-msl-value-equivalent-to-ips-ttl-value","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657969011,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1662117,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM7zuDYFIutbSPc4eEtcMhdNBTI1FRR7q0xrGh2X1QdiaNxvAV31HcRUsjPWLaaWftqgwTnVoiaica8Nw/132","nickname":"èƒœè¾‰ï¼ˆå¤§Vï¼‰","note":"","ucode":"3C13BFCD82D4EC","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":407398,"discussion_content":"ä¸€ä¸ªæ˜¯è·³æ•°ï¼Œä¸€ä¸ªæ˜¯ç§’æ•°ï¼Œæœ¬æ¥å°±ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œä¸çŸ¥ä¸ºä½•å¾ˆå¤šäººåœ¨é—®è¿™ä¸ªã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634998885,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129942,"user_name":"magicnum","can_delete":false,"product_type":"c1","uid":1004869,"ip_address":"","ucode":"96B3696961F654","user_header":"https://static001.geekbang.org/account/avatar/00/0f/55/45/e4314bc6.jpg","comment_is_top":false,"comment_ctime":1567331179,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"23042167659","product_id":100032701,"comment_content":"1.è®°å½•ä¸€ä¸ªå€¼ï¼Œæ¯”å¦‚60sï¼Œç»è¿‡ä¸€ä¸ªç½‘å…³å°±å‡å»ä¸€å®šçŸ­å€¼ï¼Œå€¼=0çš„æ—¶å€™ç½‘å…³å†³å®šä¸¢å¼ƒï¼›<br>2.ä¸éœ€è¦ã€‚timestampä¸éœ€è¦äº¤äº’ï¼Œåªæ˜¯å‘é€æ–¹ä½¿ç”¨çš„","like_count":5,"discussions":[{"author":{"id":2005721,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/BmrdLfpssuU8EibmgH6H9eiabYnqicNBsCAr0ADw8ibWAnCickIIwIWDhb9iagibPrGqGWdN9LLYcPZvyCiaztbAE9ZQag/132","nickname":"æ‰“å·¥æ˜¯ä¸å¯èƒ½æ‰“å·¥çš„","note":"","ucode":"1BFBC9A4564825","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":406584,"discussion_content":"å­¦ä¹ äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634799386,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1299095,"avatar":"https://static001.geekbang.org/account/avatar/00/13/d2/97/5f4cd8da.jpg","nickname":"è™è™ç”Ÿå¨çš„ç¨‹åšå¼º","note":"","ucode":"321C89298D3682","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":191800,"discussion_content":"åº”è¯¥æ˜¯ç»è¿‡è·¯ç”±å™¨çš„æ•°ç›®å§ï¼Ÿæˆ–è€…è¯´å«è·³æ•°ï¼ŒTTL","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583035893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2Az5uTh9ZGVA7yQCj1BXtXuicPRkvJicA97AoN9xX3bnPcUYglTMXJeZeoVbPQeJA7ICvQhR3KQ0w/132","nickname":"æ—¥ä¸è½å¸å›½","note":"","ucode":"6A11ABBD8AC438","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25515,"discussion_content":"å­¦ä¹ å­¦ä¹ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570535299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127141,"user_name":"Geek_9a0180","can_delete":false,"product_type":"c1","uid":1104526,"ip_address":"","ucode":"E0975DBE140DF2","user_header":"https://static001.geekbang.org/account/avatar/00/10/da/8e/eecebc1a.jpg","comment_is_top":false,"comment_ctime":1566568459,"is_pvip":false,"replies":[{"id":"48210","content":"é¦–å…ˆï¼Œæˆ‘ä¸æ˜ç™½connect resetå’Œconnect reset by peeræœ‰å•¥åŒºåˆ«å“ï¼Œè¿™ä¸¤ä¸ªä¸æ˜¯ä¸€å›äº‹ä¹ˆï¼Ÿéƒ½æ˜¯RSTä¿¡å·ã€‚<br><br>å…¶æ¬¡ï¼Œæˆ‘ç¡®è®¤è¯»çš„æ—¶å€™ä¼šè¯»åˆ°FINæŠ¥æ–‡ï¼Œè¿ç»­å†™åˆ™ä¼šå¾—åˆ°RSTç»“æœã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567132332,"ip_address":"","comment_id":127141,"utype":1}],"discussion_count":2,"race_medal":0,"score":"18746437643","product_id":100032701,"comment_content":"å°è±¡ä¸­æ˜¯å½“ä¸€ç«¯å…³é—­socketè¿æ¥ï¼Œå¦ä¸€ç«¯å¦‚æœå°è¯•ä»TCPè¿æ¥ä¸­è¯»å–æ•°æ®ï¼Œåˆ™ä¼šæŠ¥connect resetï¼Œå¦‚æœå¿è¯•å‘è¿æ¥ä¸­å†™å…¥æ•°æ®ï¼Œåˆ™ä¼šæŠ¥connect reset by peerï¼Œå¥½åƒå’Œè€å¸ˆè¯´çš„æ­£ç›¸åï¼Œè¿˜è¯·è€å¸ˆå¸®å¿™è§£ç­”ä¸€ä¸‹ï¼Œè°¢è°¢ï¼šï¼‰","like_count":4,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464338,"discussion_content":"é¦–å…ˆï¼Œæˆ‘ä¸æ˜ç™½connect resetå’Œconnect reset by peeræœ‰å•¥åŒºåˆ«å“ï¼Œè¿™ä¸¤ä¸ªä¸æ˜¯ä¸€å›äº‹ä¹ˆï¼Ÿéƒ½æ˜¯RSTä¿¡å·ã€‚\n\nå…¶æ¬¡ï¼Œæˆ‘ç¡®è®¤è¯»çš„æ—¶å€™ä¼šè¯»åˆ°FINæŠ¥æ–‡ï¼Œè¿ç»­å†™åˆ™ä¼šå¾—åˆ°RSTç»“æœã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567132332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1145650,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7b/32/60089a62.jpg","nickname":"æ¨é¢†well","note":"","ucode":"3974A03855168C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6162,"discussion_content":"ä½ è¯´çš„é‚£ç§æƒ…å†µä¸æ˜¯æ–‡ä¸­è¯´çš„ TIME_WAIT çŠ¶æ€ã€‚è€Œä¸”ç”±äºç³»ç»Ÿå´©æºƒæˆ–è€…å…¶ä»–ä»€ä¹ˆåŸå› ï¼ŒA ç«¯çš„è¿æ¥åœ¨ä¸é€šçŸ¥å¯¹ç«¯çš„æƒ…å†µä¸‹å…³é—­äº†ã€‚è¿™æ—¶ï¼Œå¦‚æœå¯¹ç«¯å‘é€æ•°æ®ï¼Œå°±ä¼šæ¥æ”¶åˆ° A ç«¯å‘æ¥çš„ RST ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566735727,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126948,"user_name":"Dovelol","can_delete":false,"product_type":"c1","uid":1253384,"ip_address":"","ucode":"9B5DDF7720F307","user_header":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","comment_is_top":false,"comment_ctime":1566524360,"is_pvip":false,"replies":[{"id":"48217","content":"è¿™ä¸ªæ—¶å€™ä½ çœ‹åˆ°çš„è¿æ¥éƒ½æ˜¯æœåŠ¡å™¨ç«¯è¢«åŠ¨å»ºç«‹çš„è¿æ¥ï¼Œæœ¬åœ°ç«¯å£éƒ½æ˜¯æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£ï¼Œç±»ä¼¼<br>&lt;127.0.0.1, 80, ip1, 51231&gt;<br>&lt;127.0.0.1, 80, ip2, 51331&gt;<br>...<br>æ‰€ä»¥ï¼Œä¸ä¼šå­˜åœ¨æˆ‘è®²åˆ°çš„é‚£ä¸ªé—®é¢˜ï¼Œè¿™äº›ä¸ªè¿æ¥è¿‡äº†ä¸€æ®µæ—¶é—´è‡ªç„¶ä¼šè¢«å›æ”¶ã€‚<br><br>è¿æ¥æ± æ˜¯ä¸ºäº†å¤šä¸ªçº¿ç¨‹å¤ç”¨è¿æ¥ï¼Œå‡å°‘TCPè¿æ¥çš„æ•°é‡ï¼Œæ˜¯ä¸ºäº†æ›´é«˜æ•ˆçš„ä½¿ç”¨TCPï¼Œç¡®å®ä¹Ÿå®¢è§‚å‡å°‘äº†è¿æ¥çš„æ•°é‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567133007,"ip_address":"","comment_id":126948,"utype":1}],"discussion_count":4,"race_medal":0,"score":"18746393544","product_id":100032701,"comment_content":"è€å¸ˆå¥½ï¼Œæƒ³é—®ä¸ªé—®é¢˜ï¼Œä¸€èˆ¬æˆ‘ä»¬æœåŠ¡å™¨ä¸Šè¿è¡Œä¸€ä¸ªæœåŠ¡ï¼Œæ¯”å¦‚tomcatï¼Œzkè¿™ç§ï¼Œç„¶åç›‘å¬8080æˆ–2181ç«¯å£ï¼Œè¿™æ—¶å€™å¤–éƒ¨ç›´è¿ï¼ˆä¸å†ç»è¿‡webæœåŠ¡å™¨è½¬å‘ï¼‰çš„è¯ï¼Œè™½ç„¶æœ‰å¾ˆå¤šè¿æ¥ä½†æœåŠ¡ç«¯åº”è¯¥éƒ½æ˜¯åªå ç”¨ä¸€ä¸ªç«¯å£ï¼Œä¹Ÿå°±æ˜¯è¯´netstat -anpå‘½ä»¤çœ‹åˆ°çš„æœ¬æœºéƒ½æ˜¯ip+å›ºå®šç«¯å£ï¼Œé‚£ä¹ˆæ­¤æ—¶å¦‚æœæœåŠ¡ç«¯ä¸»åŠ¨å…³é—­ä¸€äº›è¿æ¥çš„è¯ï¼Œä¹Ÿä¼šæœ‰å¤§é‡time_waité—®é¢˜å¯¹å§ï¼Œä½†æ­¤æ—¶å¥½åƒå¹¶æ²¡æœ‰æ¶ˆè€—æ›´å¤šç«¯å£ï¼Œé‚£è¿™ä¸ªå½±å“å¯¹äºæœåŠ¡ç«¯æ¥è¯´æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè€å¸ˆè®²çš„å‡ºç°å¤§é‡time_waitåº”è¯¥éƒ½æ˜¯åœ¨å®¢æˆ·ç«¯çš„ä¸€æ–¹å§ï¼Œå› ä¸ºå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ä¼šå ç”¨ä¸€ä¸ªæ–°ç«¯å£ï¼Œä¸»åŠ¨å…³é—­åˆ°time_waité˜¶æ®µå°±ç›¸å½“äºè¿™ä¸ªæ–°çš„ç«¯å£ä¸€ç›´è¢«å ç”¨ã€‚æˆ‘è¿˜æœ‰ä¸ªç–‘é—®æ˜¯ï¼Œè¿™ç§å¤§é‡time_waitåœ¨è¿æ¥æ•°å¤šçš„æƒ…å†µä¸‹æ˜¯è‚¯å®šä¼šå‡ºç°çš„ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥ä»å‡å°‘è¿æ¥çš„æ–¹å‘å»è§£å†³é—®é¢˜å‘¢ï¼Œæ¯”å¦‚ç”¨è¿æ¥æ± è¿™ç§æŠ€æœ¯å¯ä»¥è§£å†³å—ï¼Ÿ","like_count":4,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464258,"discussion_content":"è¿™ä¸ªæ—¶å€™ä½ çœ‹åˆ°çš„è¿æ¥éƒ½æ˜¯æœåŠ¡å™¨ç«¯è¢«åŠ¨å»ºç«‹çš„è¿æ¥ï¼Œæœ¬åœ°ç«¯å£éƒ½æ˜¯æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£ï¼Œç±»ä¼¼\n&amp;lt;127.0.0.1, 80, ip1, 51231&amp;gt;\n&amp;lt;127.0.0.1, 80, ip2, 51331&amp;gt;\n...\næ‰€ä»¥ï¼Œä¸ä¼šå­˜åœ¨æˆ‘è®²åˆ°çš„é‚£ä¸ªé—®é¢˜ï¼Œè¿™äº›ä¸ªè¿æ¥è¿‡äº†ä¸€æ®µæ—¶é—´è‡ªç„¶ä¼šè¢«å›æ”¶ã€‚\n\nè¿æ¥æ± æ˜¯ä¸ºäº†å¤šä¸ªçº¿ç¨‹å¤ç”¨è¿æ¥ï¼Œå‡å°‘TCPè¿æ¥çš„æ•°é‡ï¼Œæ˜¯ä¸ºäº†æ›´é«˜æ•ˆçš„ä½¿ç”¨TCPï¼Œç¡®å®ä¹Ÿå®¢è§‚å‡å°‘äº†è¿æ¥çš„æ•°é‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567133007,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1184919,"avatar":"https://static001.geekbang.org/account/avatar/00/12/14/97/8a3aa317.jpg","nickname":"ç–¾é£çŸ¥åŠ²è‰","note":"","ucode":"B6E73CA240AA29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6032,"discussion_content":"æŠ±æ­‰ï¼Œæˆ‘ä¹‹å‰çš„è¯„è®ºç¡®å®æ˜¯é”™çš„ã€‚\n\næˆ‘åˆçœ‹äº†ä¸‹ï¼ŒæœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°æ–°è¿æ¥åä¼šforkä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿™ä¸ªå­è¿›ç¨‹çš„ç«¯å£å·è·Ÿç›‘å¬ç«¯å£å·ä¸€æ ·ï¼Œä½†æ˜¯ç›¸åº”çš„å®¢æˆ·ç«¯éšæœºç«¯å£æ¯ä¸ªå­è¿›ç¨‹éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚è‡³äºæœåŠ¡ç«¯çš„å­è¿›ç¨‹å¯åŠ¨åå ç”¨çš„åˆ°åº•æ˜¯æœåŠ¡å™¨å“ªä¸ªç«¯å£ï¼Œæˆ‘è¿˜è¦å†çœ‹ä¸‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566625084,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1253384,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","nickname":"Dovelol","note":"","ucode":"9B5DDF7720F307","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5889,"discussion_content":"é‚£å¯åŠ¨çš„è¿™ä¸ªæ–°ç«¯å£çš„è¿æ¥æ€ä¹ˆæŸ¥çœ‹å‘¢ï¼Ÿç”¨netstatå¯ä»¥æŸ¥åˆ°ä¹ˆï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566528133,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1178741,"avatar":"https://static001.geekbang.org/account/avatar/00/11/fc/75/d2f821b8.jpg","nickname":"å‡Œæ™¨","note":"","ucode":"B97A142834F7DE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1253384,"avatar":"https://static001.geekbang.org/account/avatar/00/13/20/08/bc06bc69.jpg","nickname":"Dovelol","note":"","ucode":"9B5DDF7720F307","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6001,"discussion_content":"ä½ è¯´çš„æ˜¯å¯¹çš„ï¼Œ1æ¥¼è¯´çš„ä¸å¯¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566577058,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":5889,"ip_address":""},"score":6001,"extra":""}]}]},{"had_liked":false,"id":233095,"user_name":"åˆ—å¤«æ‰˜å°”æ–¯æ³°å…‹æ´›ä¼Šæ¥æ–‡åˆ—å¤«æ–¯å¾·å¤«","can_delete":false,"product_type":"c1","uid":1744034,"ip_address":"","ucode":"4FBC97385147D9","user_header":"https://static001.geekbang.org/account/avatar/00/1a/9c/a2/06604a01.jpg","comment_is_top":false,"comment_ctime":1594216197,"is_pvip":false,"replies":[{"id":"86805","content":"ä¸æ˜¯ç«¯å£å¤ç”¨ï¼Œæ˜¯å¤ç”¨å¤„äº TIME_WAIT çš„å¥—æ¥å­—ä¸ºæ–°çš„è¿æ¥æ‰€ç”¨ã€‚å‰æåœ¨æ–‡ä¸­ä¹Ÿæåˆ°äº†ï¼Œæ˜¯é€šè¿‡TCPæ—¶é—´æˆ³æ¥è§£å†³2MSLçš„é—®é¢˜ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1594906802,"ip_address":"","comment_id":233095,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14479118085","product_id":100032701,"comment_content":"è¿™ä¸ªå¯æ§ä¼˜åŒ–çš„æ–¹æ³•æ²¡æ˜ç™½ï¼Œæ˜¯å¤ç”¨ç«¯å£çš„æ„æ€å—ï¼Ÿä¸è¿‡å¤ç”¨ç«¯å£æ•°æ®ä¸æ··ä¹±äº†ï¼Ÿ","like_count":3,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":500892,"discussion_content":"ä¸æ˜¯ç«¯å£å¤ç”¨ï¼Œæ˜¯å¤ç”¨å¤„äº TIME_WAIT çš„å¥—æ¥å­—ä¸ºæ–°çš„è¿æ¥æ‰€ç”¨ã€‚å‰æåœ¨æ–‡ä¸­ä¹Ÿæåˆ°äº†ï¼Œæ˜¯é€šè¿‡TCPæ—¶é—´æˆ³æ¥è§£å†³2MSLçš„é—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594906802,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127231,"user_name":"Liam","can_delete":false,"product_type":"c1","uid":1094597,"ip_address":"","ucode":"1D15D3B64F2606","user_header":"https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg","comment_is_top":false,"comment_ctime":1566616154,"is_pvip":false,"replies":[{"id":"48209","content":"1. æˆ‘è¯´çš„æƒ…å†µæ˜¯ä¸»åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼Œæ¯”å¦‚ä¸€ä¸ªå®¢æˆ·ç«¯æ¯æ¬¡å¯¹å¤–å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œè¿™æ˜¯è¦æ¶ˆè€—ä¸€ä¸ªæœ¬åœ°ç«¯å£çš„ï¼Œåªä¸è¿‡è¿™ä¸ªç«¯å£åœ¨æˆ‘ä»¬å»ºç«‹è¿æ¥çš„æ—¶å€™ç”±å†…æ ¸å¸®æˆ‘ä»¬é€‰å¥½äº†ï¼›<br><br>2. æŠ¥æ–‡çš„è‡ªç„¶æ¶ˆäº¡ï¼Œå°±æ˜¯TTLæ—¶é—´ä¸º0äº†ï¼Œä¸ä¼šåœ¨ç½‘ç»œä¸­ç»§ç»­ä¼ æ’­ï¼Œåˆ°äº†æŸä¸ªç½‘ç»œè®¾å¤‡ï¼ŒæŠ¥æ–‡ä¼šè¢«ä¸¢å¼ƒæ‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567132189,"ip_address":"","comment_id":127231,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14451518042","product_id":100032701,"comment_content":"è€å¸ˆå¥½ï¼Œæˆ‘åˆ2ä¸ªé—®é¢˜ä¸æ˜ç™½ï¼š<br>1 ä¸ºä»€ä¹ˆè¯´time_waitä¼šå ç”¨è¿‡å¤šç«¯å£ï¼Œéš¾é“ä¸æ˜¯å ç”¨socketè€Œå·²å—ï¼Ÿæ¯”å¦‚ä¸€ä¸ªserverä¸å¤šä¸ªclientå»ºç«‹å¤šä¸ªè¿æ¥ï¼Œå¯¹äºserverè€Œè¨€åªä¼šå ç”¨ä¸€ä¸ªç«¯å£å§<br><br>2 ä»€ä¹ˆæ˜¯æŠ¥æ–‡çš„è‡ªç„¶æ¶ˆäº¡ï¼ŒæŒ‡çš„æ˜¯æŠ¥æ–‡å‘é€åˆ°å¯¹æ–¹æˆ–æŠ¥æ–‡æ­£å¸¸ä¸¢å¼ƒå—ï¼Ÿç„¶åå¯¹è¿æ¥åŒ–èº«è¿™æ®µçœ‹ä¸æ˜ç™½","like_count":3,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464390,"discussion_content":"1. æˆ‘è¯´çš„æƒ…å†µæ˜¯ä¸»åŠ¨æ–­å¼€è¿æ¥çš„ä¸€æ–¹ï¼Œæ¯”å¦‚ä¸€ä¸ªå®¢æˆ·ç«¯æ¯æ¬¡å¯¹å¤–å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œè¿™æ˜¯è¦æ¶ˆè€—ä¸€ä¸ªæœ¬åœ°ç«¯å£çš„ï¼Œåªä¸è¿‡è¿™ä¸ªç«¯å£åœ¨æˆ‘ä»¬å»ºç«‹è¿æ¥çš„æ—¶å€™ç”±å†…æ ¸å¸®æˆ‘ä»¬é€‰å¥½äº†ï¼›\n\n2. æŠ¥æ–‡çš„è‡ªç„¶æ¶ˆäº¡ï¼Œå°±æ˜¯TTLæ—¶é—´ä¸º0äº†ï¼Œä¸ä¼šåœ¨ç½‘ç»œä¸­ç»§ç»­ä¼ æ’­ï¼Œåˆ°äº†æŸä¸ªç½‘ç»œè®¾å¤‡ï¼ŒæŠ¥æ–‡ä¼šè¢«ä¸¢å¼ƒæ‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567132189,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":308825,"user_name":"Initiative Thinker","can_delete":false,"product_type":"c1","uid":1736297,"ip_address":"","ucode":"A884396A1581EF","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI9zRdkKuXMKh30ibeludlAsztmR4rD9iaiclPicOfIhbC4fWxGPz7iceb3o4hKx7qgX2dKwogYvT6VQ0g/132","comment_is_top":false,"comment_ctime":1629813249,"is_pvip":true,"replies":[{"id":"112105","content":"æ˜¯è¯´&quot;å›å¤&quot;å§ï¼Ÿ<br>å¤„äº TIME_WAIT çš„å¥—æ¥å­—ä¸ºæ–°çš„è¿æ¥æ‰€ç”¨ï¼Œé€šè¿‡æ—¶é—´æˆ³å¯ä»¥çŸ¥é“æ—§è¿æ¥çš„FINæ˜¯ä¸€ä¸ªæ— æ•ˆçš„FINï¼Œä»è€Œç›´æ¥å›å¤RSTï¼Œè®©æ—§è¿æ¥ç›´æ¥å‡ºé”™é€€å‡ºã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1630244083,"ip_address":"","comment_id":308825,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10219747841","product_id":100032701,"comment_content":"å¤ç”¨åçš„å¥—æ¥å­—ï¼Œå¦‚ä½•æ¢å¤æ—§è¿æ¥çš„FINå‘¢ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":525635,"discussion_content":"æ˜¯è¯´&amp;quot;å›å¤&amp;quot;å§ï¼Ÿ\nå¤„äº TIME_WAIT çš„å¥—æ¥å­—ä¸ºæ–°çš„è¿æ¥æ‰€ç”¨ï¼Œé€šè¿‡æ—¶é—´æˆ³å¯ä»¥çŸ¥é“æ—§è¿æ¥çš„FINæ˜¯ä¸€ä¸ªæ— æ•ˆçš„FINï¼Œä»è€Œç›´æ¥å›å¤RSTï¼Œè®©æ—§è¿æ¥ç›´æ¥å‡ºé”™é€€å‡ºã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630244083,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":281303,"user_name":"Geek_9edd4f","can_delete":false,"product_type":"c1","uid":2359446,"ip_address":"","ucode":"795A17393B200B","user_header":"","comment_is_top":false,"comment_ctime":1614682805,"is_pvip":false,"replies":[{"id":"102457","content":"è¿™ä¸ªä¾‹å­æ˜¯å®¢æˆ·ç«¯å‘èµ·è¿æ¥è¿‡å¤šï¼Œæ¯æ¬¡å‘èµ·è¿æ¥éƒ½ä¼šå ç”¨ä¸€ä¸ªç«¯å£ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯ç›¸å¯¹ï¼Œæ¯”å¦‚ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯¹äºå®¢æˆ·çš„è¯·æ±‚æ˜¯æœåŠ¡ç«¯ï¼ŒåŒæ—¶ä¸ºäº†æœåŠ¡è¿™ä¸ªå®¢æˆ·è¯·æ±‚ï¼Œåˆè¦å‘å¦ä¸€ä¸ªæœåŠ¡å‘èµ·è°ƒç”¨è¯·æ±‚(å…¸å‹çš„ä¾‹å­æ˜¯å‘æ•°æ®åº“å‘èµ·è¿æ¥è¯·æ±‚)ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1615125509,"ip_address":"","comment_id":281303,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10204617397","product_id":100032701,"comment_content":"â€œç¬¬äºŒæ˜¯å¯¹ç«¯å£èµ„æºçš„å ç”¨ï¼Œä¸€ä¸ª TCP è¿æ¥è‡³å°‘æ¶ˆè€—ä¸€ä¸ªæœ¬åœ°ç«¯å£ã€‚è¦çŸ¥é“ï¼Œç«¯å£èµ„æºä¹Ÿæ˜¯æœ‰é™çš„ï¼Œä¸€èˆ¬å¯ä»¥å¼€å¯çš„ç«¯å£ä¸º 32768ï½61000 ï¼Œä¹Ÿå¯ä»¥é€šè¿‡net.ipv4.ip_local_port_rangeæŒ‡å®šï¼Œå¦‚æœ TIME_WAIT çŠ¶æ€è¿‡å¤šï¼Œä¼šå¯¼è‡´æ— æ³•åˆ›å»ºæ–°è¿æ¥ã€‚è¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬åœ¨ä¸€å¼€å§‹è®²åˆ°çš„é‚£ä¸ªä¾‹å­ã€‚â€<br>è¿™é‡Œä¸æ˜¯å¾ˆç†è§£ï¼ŒæœåŠ¡ç«¯æä¾›æœåŠ¡åº”è¯¥å°±åªç”¨ä¸€ä¸ªç«¯å£å·å§ï¼Ÿè€Œå®¢æˆ·ç«¯è¯·æ±‚æœåŠ¡åº”è¯¥ä¹Ÿæ˜¯åªä½¿ç”¨ä¸€ä¸ªç«¯å£å·å§ï¼Ÿæ™®é€šä¸ªäººå®¢æˆ·å°±å‘èµ·ä¸€ä¸ªè¯·æ±‚åªç”¨ä¸€ä¸ªç«¯å£å·ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°ç«¯å£å·ä¸å¤Ÿç”¨çš„æƒ…å†µï¼Ÿéš¾é“æŒ‡çš„çš„ä¸ºå®¢æˆ·æœåŠ¡çš„ä»£ç†æœåŠ¡å™¨å¯èƒ½ä¼šç«¯å£å·ä¸å¤Ÿç”¨å—ï¼Ÿå› ä¸ºä»£ç†æœåŠ¡å™¨è¦å¤„ç†æ¥è‡ªæˆåƒä¸Šä¸‡çš„å®¢æˆ·è¯·æ±‚ï¼Œéœ€è¦é€‰æ‹©ä¸åŒçš„ç«¯å£å·ä¸ºå®¢æˆ·æœåŠ¡ï¼Œå°†è¯·æ±‚å‘ç»™æœåŠ¡å™¨å—ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516350,"discussion_content":"è¿™ä¸ªä¾‹å­æ˜¯å®¢æˆ·ç«¯å‘èµ·è¿æ¥è¿‡å¤šï¼Œæ¯æ¬¡å‘èµ·è¿æ¥éƒ½ä¼šå ç”¨ä¸€ä¸ªç«¯å£ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯ç›¸å¯¹ï¼Œæ¯”å¦‚ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯¹äºå®¢æˆ·çš„è¯·æ±‚æ˜¯æœåŠ¡ç«¯ï¼ŒåŒæ—¶ä¸ºäº†æœåŠ¡è¿™ä¸ªå®¢æˆ·è¯·æ±‚ï¼Œåˆè¦å‘å¦ä¸€ä¸ªæœåŠ¡å‘èµ·è°ƒç”¨è¯·æ±‚(å…¸å‹çš„ä¾‹å­æ˜¯å‘æ•°æ®åº“å‘èµ·è¿æ¥è¯·æ±‚)ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615125509,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":242322,"user_name":"Atong","can_delete":false,"product_type":"c1","uid":1061005,"ip_address":"","ucode":"7E9D4B8D108E4E","user_header":"https://static001.geekbang.org/account/avatar/00/10/30/8d/a2a4e97e.jpg","comment_is_top":false,"comment_ctime":1597671409,"is_pvip":true,"replies":[{"id":"90114","content":"æ–‡ç« ä¸­åº”è¯¥è¯´æ˜äº†ï¼Œæ˜¯å› ä¸ºç«¯å£è¢«å ç”¨å®Œæ¯•ï¼Œåœ¨ç³»ç»Ÿæ²¡æœ‰åŠæ—¶æ¸…ç†ä¹‹å‰ï¼Œæ–°è¿æ¥æ— æ³•å»ºç«‹è¿æ¥äº†ã€‚ç›´åˆ°ç³»ç»Ÿæ¸…ç†å®Œæˆï¼Œæ‰å¯ä»¥æœåŠ¡æ–°çš„è¿æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1598794963,"ip_address":"","comment_id":242322,"utype":1}],"discussion_count":3,"race_medal":0,"score":"10187606001","product_id":100032701,"comment_content":"è€å¸ˆæœ‰ä¸€ä¸ªé—®é¢˜è¯·æ•™ï¼š<br>å·²çŸ¥çš„çŸ¥è¯†ç‚¹ï¼š<br>1. TCPçš„å››æ¬¡æŒ¥æ‰‹ï¼Œåªæœ‰ä¸»åŠ¨æ–­å¼€çš„é‚£ç«¯æ‰ä¼šå‡ºç°TIME_WAITçŠ¶æ€ã€‚<br>2. ä¸€ä¸ªsocketè¿æ¥ï¼Œæ˜¯ç”±ä¸€ä¸ªå››å…ƒç¥–æ ‡è¯†ï¼Œclient_ip,client_port,server_ip,server_port<br><br>é’ˆå¯¹è€å¸ˆæåˆ°çš„ä¸€ä¸ªçº¿ä¸ŠæœåŠ¡æ—¶å¥½æ—¶åçš„æè¿°ï¼Œå­˜åœ¨ç–‘é—®çš„ç‚¹ï¼š<br>ã€åŸæ–‡ã€‘<br>è¯¥æœåŠ¡çš„å¯ç”¨æ€§å˜å¾—æ—¶å¥½æ—¶åï¼Œä¸€æ®µæ—¶é—´å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œä¸€æ®µæ—¶é—´çªç„¶åˆä¸å¯ä»¥ï¼Œå¤§å®¶éƒ½ç™¾æ€ä¸å¾—å…¶è§£ã€‚è¿ç»´åŒå­¦ç™»å½•åˆ°æœåŠ¡æ‰€åœ¨çš„ä¸»æœºä¸Šï¼Œä½¿ç”¨ netstat å‘½ä»¤æŸ¥çœ‹åæ‰å‘ç°ï¼Œä¸»æœºä¸Šæœ‰æˆåƒä¸Šä¸‡å¤„äº TIME_WAIT çŠ¶æ€çš„è¿æ¥ã€‚<br><br>ã€ç–‘é—®ã€‘<br>é—®é¢˜1.  çº¿ä¸ŠæœåŠ¡ä½œä¸ºæœåŠ¡ç«¯ï¼Œå¯¹å¤–æä¾›ç»™å®¢æˆ·ç«¯è¿æ¥ã€‚å‡å¦‚éƒ½æ˜¯æœåŠ¡ç«¯ä¸»åŠ¨æ–­å¼€äº†è¿æ¥ï¼Œä¼šå­˜åœ¨è¾ƒå¤šTIME_WAITã€‚ æ­¤æ—¶ä¼šå ç”¨æ‰ä¸€äº›éƒ¨åˆ†æœåŠ¡ç«¯çš„å†…å®¹ã€‚é™¤æ­¤ä¹‹å¤–ä¼šæœ‰ä»€ä¹ˆå…¶ä»–çš„èµ„æºå ç”¨å—ï¼Ÿ <br><br>é—®é¢˜2. æ¥é—®é¢˜1çš„æƒ…å†µï¼Œç†è®ºæœåŠ¡ç«¯çš„ç¨‹åºç›‘å¬ç«¯å£å¯ä»¥å¤ç”¨ï¼Œå°±ç®—æ˜¯å­˜åœ¨è¾ƒå¤šTIME_WAITã€‚Clientç«¯è¿˜æ˜¯èƒ½å¤Ÿè¿æ¥åˆ°æœåŠ¡ç«¯çš„ç›‘å¬ç«¯å£çš„ã€‚ä¸ºä»€ä¹ˆä¼šè¡¨ç°ä¸ºæœ‰æ—¶å¯è¿ï¼Œæœ‰æ—¶ä¸å¯è¿å‘¢ï¼Ÿ<br><br>é—®é¢˜3ï¼šæœ€ç»ˆè¿™ä¸ªçº¿ä¸Šçš„é—®é¢˜ï¼Œæ˜¯é€šè¿‡ä»€ä¹ˆæ–¹æ³•è¿›è¡Œè§£å†³çš„ï¼Ÿ<br><br>ã€æˆ‘çš„çŒœæµ‹ã€‘<br>1. æˆ‘ä¸ªäººçš„æ¨æµ‹ï¼Œæ˜¯ä¸æ˜¯å› ä¸ºserverç«¯å­˜åœ¨è¾ƒå¤štime_waitã€‚å°±è¯´æ˜socketæ˜¯è¿˜æ²¡æœ‰å®Œå…¨å…³é—­çš„ã€‚ä¹Ÿå°±æ˜¯è¯´é™¤äº†å ç”¨å†…å­˜èµ„æºã€‚ä¹Ÿå ç”¨ç€å¥—æ¥å­—èµ„æºï¼Œå¥—æ¥å­—å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ã€‚è¿‡å¤šçš„TIME_WAITï¼Œå†åŠ ä¸Šå·²ç»å»ºç«‹çš„æ­£å¸¸è¿æ¥ï¼Œå°±é€ æˆæœåŠ¡ç«¯æ²¡æœ‰æ›´å¤šçš„æ–‡ä»¶æè¿°ç¬¦æ¥æœåŠ¡æ–°çš„è¿æ¥è¯·æ±‚ã€‚ <br>è€å¸ˆä¸æ‡‚æˆ‘è¿™æ ·æ¨æµ‹æ˜¯ä¸æ˜¯å¯¹çš„ï¼Œæœ›æ‚¨èƒ½å¸®å¿™è§£ç­”ä¸‹ã€‚","like_count":2,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":503977,"discussion_content":"æ–‡ç« ä¸­åº”è¯¥è¯´æ˜äº†ï¼Œæ˜¯å› ä¸ºç«¯å£è¢«å ç”¨å®Œæ¯•ï¼Œåœ¨ç³»ç»Ÿæ²¡æœ‰åŠæ—¶æ¸…ç†ä¹‹å‰ï¼Œæ–°è¿æ¥æ— æ³•å»ºç«‹è¿æ¥äº†ã€‚ç›´åˆ°ç³»ç»Ÿæ¸…ç†å®Œæˆï¼Œæ‰å¯ä»¥æœåŠ¡æ–°çš„è¿æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598794963,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":2902752,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJaaRiaBo5xtYPib3az6lBtSG8ibebDUVGgSMRPD3nGn9hr0Iz8dDZXxMzsUV2M7uiaicBg9HdBxcSFic7g/132","nickname":"Geek_b83fff","note":"","ucode":"AFA20C90BCBF02","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":570520,"discussion_content":"è¿™å›ç­”æ²¡ç†è§£é—®çš„é—®é¢˜å§ï¼Œå›ç­”å¾ˆå®˜æ–¹ï¼Œæƒ³é—®çš„æ˜¯ä¸ºä»€ä¹ˆæœåŠ¡ç«¯ä¼šå‡ºç°è¿™ä¸ªæƒ…å†µï¼ŒæœåŠ¡ç«¯ç«¯å£æ˜¯å¤ç”¨çš„ï¼Œå°±ç®—1äº¿ä¸ªè¿æ¥ å’ŒæœåŠ¡ç«¯ä¹Ÿæ²¡å…³ç³»å§ï¼Œæ€ä¹ˆä¼šå‡ºç°ç«¯å£ä¸å¤Ÿç”¨å•Šï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1651804278,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":503977,"ip_address":""},"score":570520,"extra":""}]},{"author":{"id":2184325,"avatar":"https://static001.geekbang.org/account/avatar/00/21/54/85/ab5148ce.jpg","nickname":"duckman","note":"","ucode":"0184C26C4B6C1B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":332407,"discussion_content":"1ä¸ªsocketè¿æ¥åº”è¯¥æ˜¯ä¸€ä¸ª5å…ƒç»„ è¿˜åŒ…æ‹¬åè®®ç±»å‹(tcp/udp)\n\næœåŠ¡ç«¯å­˜åœ¨è¾ƒå¤šçš„TIME_WAIT è¡¨ç¤ºæœ‰å¤§é‡çš„ç«¯å£æ²¡æœ‰é‡Šæ”¾,  è€Œä¸€èˆ¬æƒ…å†µä¸‹æœåŠ¡ç«¯çš„server(nginxç­‰) è®¾ç½®çš„å¯ç”¨è¿æ¥æ•°é‡æ˜¯æœ‰é™çš„(worker_connections), è¶…è¿‡è¿™ä¸ªé™åº¦, nginxå°±ä¼šç¦æ­¢å®¢æˆ·ç«¯æ–°çš„TCPè¿æ¥.\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1607182306,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":133340,"user_name":"ç°è‰²","can_delete":false,"product_type":"c1","uid":1178135,"ip_address":"","ucode":"869B400BBD520D","user_header":"https://static001.geekbang.org/account/avatar/00/11/fa/17/d0b8135f.jpg","comment_is_top":false,"comment_ctime":1568521344,"is_pvip":false,"replies":[{"id":"51619","content":"å¦‚æœèƒ½è¿ä¸Šï¼Œæˆ‘è§‰å¾—æ˜¯å§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568886985,"ip_address":"","comment_id":133340,"utype":1}],"discussion_count":1,"race_medal":0,"score":"10158455936","product_id":100032701,"comment_content":"å¦‚æœæœåŠ¡ç«¯ä¸»åŠ¨å…³é—­ä¸€äº›è¿æ¥ï¼Œé‚£ä¹ˆåœ¨æœåŠ¡ç«¯ä¼šå‡ºç°ä¸€äº›å¤„äºTIME_WAITçŠ¶æ€çš„è¿æ¥ï¼Œå¦‚æœå®¢æˆ·ç«¯ç»‘å®šç›¸åŒçš„ç«¯å£ï¼Œé‡æ–°è¿æ¥æœåŠ¡ç«¯ï¼Œè¿æ¥è¿˜æ˜¯å¯ä»¥ç«‹å³å»ºç«‹æˆåŠŸï¼Œé‚£æ˜¯ä¸æ˜¯å°±å‡ºç°äº†åŸæ¥è¿æ¥çš„â€œåŒ–èº«â€ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467357,"discussion_content":"å¦‚æœèƒ½è¿ä¸Šï¼Œæˆ‘è§‰å¾—æ˜¯å§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568886985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127098,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1566553254,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10156487846","product_id":100032701,"comment_content":"å…³äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œæ€è€ƒäº†ç¬¬äºŒéï¼Œå› ä¸ºæ˜¯å‘é€æ–¹çš„å½“å‰æ—¶é—´æˆ³å’Œä»å¯¹æ–¹æ¥å—åˆ°çš„æœ€æ–°æ—¶é—´æˆ³ï¼Œå¦‚æœæ¥æ”¶æ–¹æ”¹äº†æ—¶é—´ç„¶åå†ä»ç½‘ç»œé‡Œé¢å–å‡ºæ¥è‡ªå·±ä¸Šä¸€æ¬¡çš„å‘é€çš„æ—¶é—´æˆ³æœ‰å¾ˆå¤§å·®å¼‚å°±ä¼šå‡ºé—®é¢˜äº†ï¼Œæ¯”å¦‚å¾€å‰æ”¹æˆ–è€…å¾€åæ”¹ï¼æœ€å…³é”®æˆ‘è§‰å¾—è¿˜æ˜¯çœ‹æ€ä¹ˆé€šè¿‡æ—¶é—´æˆ³åˆ¤æ–­ç”Ÿå­˜æ—¶é—´ï¼","like_count":2,"discussions":[{"author":{"id":1079816,"avatar":"https://static001.geekbang.org/account/avatar/00/10/7a/08/4d3e47dd.jpg","nickname":"Aaron Cheung","note":"","ucode":"03972759C53667","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304034,"discussion_content":"ä¼˜ç§€çš„æˆå¤§å¤§ï¼Œå“ªé‡Œéƒ½èƒ½çœ‹åˆ°ä½ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599457054,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":335851,"user_name":"ä¸‰å¹´äºŒç­é‚±å°ä¸œ","can_delete":false,"product_type":"c1","uid":2922136,"ip_address":"","ucode":"909B49C63C8EC6","user_header":"https://static001.geekbang.org/account/avatar/00/2c/96/98/89b96cda.jpg","comment_is_top":false,"comment_ctime":1645720099,"is_pvip":true,"replies":[{"id":"122801","content":"å“¦ï¼Œé‚£æ˜¯åœ¨ç­”ç–‘é‡Œè®²åˆ°äº†ã€‚19ç¯‡é‡Œåº”è¯¥æœ‰ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1618647","ctime":1645882136,"ip_address":"","comment_id":335851,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5940687395","product_id":100032701,"comment_content":"åŸºç¡€ç¯‡é‡Œæ²¡è®²å››æ¬¡æŒ¥æ‰‹å•Š","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553414,"discussion_content":"å“¦ï¼Œé‚£æ˜¯åœ¨ç­”ç–‘é‡Œè®²åˆ°äº†ã€‚19ç¯‡é‡Œåº”è¯¥æœ‰ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645882136,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2653715,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKib3vNM6TPT1umvR3TictnLurJPKuQq4iblH5upgBB3kHL9hoN3Pgh3MaR2rjz6fWgMiaDpicd8R5wsAQ/132","nickname":"é™ˆé˜³","note":"","ucode":"C8E676C967D23A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":553387,"discussion_content":"åŠ 1  æˆ‘ä¹Ÿæ²¡çœ‹åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645872585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297067,"user_name":"vv_test","can_delete":false,"product_type":"c1","uid":1685884,"ip_address":"","ucode":"1D164B2F034E2B","user_header":"https://static001.geekbang.org/account/avatar/00/19/b9/7c/afe6f1eb.jpg","comment_is_top":false,"comment_ctime":1623297103,"is_pvip":false,"replies":[{"id":"108672","content":"æ‰€ä»¥æœ‰NTPæœåŠ¡å˜›","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1624805049,"ip_address":"","comment_id":297067,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5918264399","product_id":100032701,"comment_content":"å‡å¦‚å¼€å¯äº†net.ipv4.tcp_tw_reuseï¼Œå¯¹æ–¹ä¸»æœºçš„æ—¶é—´è·Ÿå‘é€æ–¹æ—¶é—´æœ¬æ¥å°±æœ‰å·®ï¼Œè¿™ä¸ªè¦æ€ä¹ˆé¿å…?","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":521708,"discussion_content":"æ‰€ä»¥æœ‰NTPæœåŠ¡å˜›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1624805049,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":285768,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1617006842,"is_pvip":false,"replies":[{"id":"104131","content":"ä¸æ˜¯æ‹‰ï¼Œå‘èµ·è¿æ¥çš„ä¸€æ–¹ä¸€å®šæ˜¯clientï¼Œæ¥æ”¶è¿æ¥çš„ä¸€æ–¹ä¸€å®šæ˜¯serverã€‚åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œé‚£ä¸ªåº”ç”¨ç¨‹åºæ—¢æ˜¯server(æ¥æ”¶å®¢æˆ·è¯·æ±‚)ï¼Œä¹Ÿæ˜¯client(å‘èµ·å¤„ç†è¯·æ±‚åˆ°å¦å¤–ä¸€å°server)ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1617542640,"ip_address":"","comment_id":285768,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5911974138","product_id":100032701,"comment_content":"åŸæ–‡ï¼šåªæœ‰å‘èµ·è¿æ¥ç»ˆæ­¢çš„ä¸€æ–¹ä¼šè¿›å…¥ TIME_WAIT çŠ¶æ€ã€‚<br><br><br>socket æ“ä½œï¼šè§’è‰²<br>connectï¼šclient<br>acceptï¼šserver<br><br>è€å¸ˆï¼ŒåŸæ–‡çš„é‚£å¥è¯æ˜¯è¯´ï¼Œserver ä¹Ÿæ˜¯å¯ä»¥ä¸»åŠ¨å‘èµ·è¿æ¥ç»ˆæ­¢è¿›å…¥ TIME_WAIT çŠ¶æ€æ˜¯ä¹ˆï¼Ÿä¹‹å‰ä¸€ç›´ä»¥ä¸ºåªæœ‰ connect(client) ç«¯æ‰èƒ½å‘èµ·è¿æ¥ç»ˆæ­¢ã€‚<br>è°¢è°¢è€å¸ˆï¼","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517775,"discussion_content":"ä¸æ˜¯æ‹‰ï¼Œå‘èµ·è¿æ¥çš„ä¸€æ–¹ä¸€å®šæ˜¯clientï¼Œæ¥æ”¶è¿æ¥çš„ä¸€æ–¹ä¸€å®šæ˜¯serverã€‚åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œé‚£ä¸ªåº”ç”¨ç¨‹åºæ—¢æ˜¯server(æ¥æ”¶å®¢æˆ·è¯·æ±‚)ï¼Œä¹Ÿæ˜¯client(å‘èµ·å¤„ç†è¯·æ±‚åˆ°å¦å¤–ä¸€å°server)ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1617542640,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":284274,"user_name":"null","can_delete":false,"product_type":"c1","uid":1024294,"ip_address":"","ucode":"F9039EFED6B55D","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132","comment_is_top":false,"comment_ctime":1616146613,"is_pvip":false,"replies":[{"id":"103194","content":"æˆ‘è§‰å¾—å§ï¼Œåº”è¯¥åªæœ‰ä¸€ä¸ªæ–°çš„è¿æ¥äº†ï¼Œæ—§çš„å°±ä¸å­˜åœ¨äº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1616315321,"ip_address":"","comment_id":284274,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5911113909","product_id":100032701,"comment_content":"è€å¸ˆæ‚¨çš„å›å¤ï¼š<br>ä¸æ˜¯ç«¯å£å¤ç”¨ï¼Œæ˜¯å¤ç”¨å¤„äº TIME_WAIT çš„å¥—æ¥å­—ä¸ºæ–°çš„è¿æ¥æ‰€ç”¨ã€‚<br><br>----<br><br>çº¦å®šï¼š<br>æ—§çš„å››å…ƒç»„ï¼š&lt;old_client_ipï¼Œold_client_portï¼Œold_server_ipï¼Œold_server_port&gt;<br>æ–°çš„å››å…ƒç»„ï¼š&lt;new_client_ipï¼Œnew_client_portï¼Œnew_server_ipï¼Œnew_server_port&gt;<br><br>å½“å‰ TIME_WAIT çš„å¥—æ¥å­—ï¼ˆå‡è®¾åå­—ä¸º socket_aï¼‰è¢«æ–°çš„è¿æ¥å¤ç”¨äº†ï¼Œæ–°è¿æ¥ä½¿ç”¨è¯¥å¥—æ¥å­—å®Œæˆä¸‰æ¬¡æ¡æ‰‹ã€å‘æ•°æ®ã€‚<br>1. socket_a ä¸ºä¸¤ä¸ªè¿æ¥æœåŠ¡ä¹ˆï¼Ÿå› æ­¤ socket_a éœ€è¦é€šè¿‡ &lt;old_server_ip&#47;port&gt; å’Œ &lt;new_server_ip&#47;port&gt; æ¥åŒºåˆ†æ¶ˆæ¯æ˜¯è°å‘çš„ï¼Ÿ<br>2. old_client_ip ä¸ new_client_ip ç›¸åŒï¼Œä½†æ˜¯ old_client_port å’Œ new_client_port ä¸åŒï¼Œæ˜¯ä¹ˆï¼Ÿ<br>3. å½“ socket_a è¢«æ–°è¿æ¥å¤ç”¨åï¼Œold_server ç›®å‰åªä¼šå‘é€ FINï¼ˆä¸ä¼šå‘å…¶ä»–æ•°æ®ï¼‰ï¼Œsocket_a æ”¶åˆ°åéœ€è¦å¯¹ old_server å›å¤ ACK ä¹ˆï¼Œè¿˜æ˜¯è¯´ç›´æ¥ä¸ç†ä¼šï¼Ÿ<br><br>è°¢è°¢è€å¸ˆï¼","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":517294,"discussion_content":"æˆ‘è§‰å¾—å§ï¼Œåº”è¯¥åªæœ‰ä¸€ä¸ªæ–°çš„è¿æ¥äº†ï¼Œæ—§çš„å°±ä¸å­˜åœ¨äº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1616315321,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2608728,"avatar":"https://static001.geekbang.org/account/avatar/00/27/ce/58/71ed845f.jpg","nickname":"Dexter","note":"","ucode":"909CABC4AC4AC9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573856,"discussion_content":"æ²¡è¯´æ¸…æ¥šï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653690526,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":236477,"user_name":"stackWarn","can_delete":false,"product_type":"c1","uid":1002005,"ip_address":"","ucode":"89672E452DEBA5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/15/106eaaa8.jpg","comment_is_top":false,"comment_ctime":1595424507,"is_pvip":false,"replies":[{"id":"87600","content":"æ˜¯ä¸€ä¸ªåŠæ³•ï¼Œä¸è¿‡è¦çœ‹å…·ä½“ROIæ˜¯ä¸æ˜¯åˆç†çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1595679915,"ip_address":"","comment_id":236477,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5890391803","product_id":100032701,"comment_content":"æœ€ç®€å•ç›´æ¥çš„æ–¹æ³•æ˜¯ä½¿ç”¨é•¿è¿æ¥","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":502085,"discussion_content":"æ˜¯ä¸€ä¸ªåŠæ³•ï¼Œä¸è¿‡è¦çœ‹å…·ä½“ROIæ˜¯ä¸æ˜¯åˆç†çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595679915,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":182716,"user_name":"Tesla","can_delete":false,"product_type":"c1","uid":1500742,"ip_address":"","ucode":"98629AFD9861EE","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKUcSLVV6ia3dibe7qvTu8Vic1PVs2EibxoUdx930MC7j2Q9A6s4eibMDZlcicMFY0D0icd3RrDorMChu0zw/132","comment_is_top":false,"comment_ctime":1582855060,"is_pvip":false,"replies":[{"id":"71030","content":"å¦‚æœæ˜¯æœåŠ¡ç«¯ï¼Œåªéœ€è¦å¼€å¯ä¸€ä¸ªç«¯å£ï¼Œä¾‹å¦‚80ï¼Œ 8080å°±å¯ä»¥å¯¹å¤–æœåŠ¡ï¼›æ— æ•°ä¸ªå®¢æˆ·å•å¾€è¿™ä¸ªç«¯å£å‘è¯·æ±‚ï¼Œå¯ä»¥æ„æˆäº†&lt;è¯·æ±‚è€…IP,è¯·æ±‚è€…ç«¯å£ï¼ŒæœåŠ¡ç«¯IP, 80&gt;è¿™æ ·çš„å››å…ƒç»„ï¼Œæ¯ä¸ªå››å…ƒç»„è¡¨ç¤ºä¸€ä¸ªè¿æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1583052344,"ip_address":"","comment_id":182716,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5877822356","product_id":100032701,"comment_content":"è€å¸ˆå¥½ï¼Œä¸€ä¸ªtcpå ç”¨ä¸€ä¸ªç«¯å£çš„è¯ï¼Œé‚£ä¸€ä¸ªhttpè¯·æ±‚æ˜¯ä¸æ˜¯ä¹Ÿè¦å ç”¨ä¸€ä¸ªç«¯å£ï¼Ÿé™¤éä½¿ç”¨å¼‚æ­¥ç½‘ç»œç¼–ç¨‹æ¨¡å‹ï¼Œå¦åˆ™ä¸€ä¸ªhttpä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹å¹¶å ç”¨ä¸€ä¸ªç«¯å£å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485425,"discussion_content":"å¦‚æœæ˜¯æœåŠ¡ç«¯ï¼Œåªéœ€è¦å¼€å¯ä¸€ä¸ªç«¯å£ï¼Œä¾‹å¦‚80ï¼Œ 8080å°±å¯ä»¥å¯¹å¤–æœåŠ¡ï¼›æ— æ•°ä¸ªå®¢æˆ·å•å¾€è¿™ä¸ªç«¯å£å‘è¯·æ±‚ï¼Œå¯ä»¥æ„æˆäº†&amp;lt;è¯·æ±‚è€…IP,è¯·æ±‚è€…ç«¯å£ï¼ŒæœåŠ¡ç«¯IP, 80&amp;gt;è¿™æ ·çš„å››å…ƒç»„ï¼Œæ¯ä¸ªå››å…ƒç»„è¡¨ç¤ºä¸€ä¸ªè¿æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583052344,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":163663,"user_name":"xbl","can_delete":false,"product_type":"c1","uid":1366484,"ip_address":"","ucode":"78297667D85C92","user_header":"https://static001.geekbang.org/account/avatar/00/14/d9/d4/5bfe1dd8.jpg","comment_is_top":false,"comment_ctime":1576762980,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5871730276","product_id":100032701,"comment_content":"æœ¬èŠ‚è¯¾è¿˜æ˜¯æœ‰äº›éš¾ç†è§£ éœ€è¦å¤šè¯»å‡ é å¦‚æœè€å¸ˆèƒ½è®²çš„æ›´è¯¦ç»†äº›å°±å¥½äº†","like_count":1},{"had_liked":false,"id":154596,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1574488741,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5869456037","product_id":100032701,"comment_content":"1ï¼šTIME_WAITä»£è¡¨ç€ä»€ä¹ˆï¼Ÿ<br>é¦–å…ˆï¼ŒTIME_WAITæ˜¯TCPè¿æ¥çš„ä¸€ç§çŠ¶æ€ï¼Œä¸”åªæœ‰å‘èµ·ä¸€æ¬¡TCPè¿æ¥ç»ˆæ­¢çš„ä¸€æ–¹æ‰ä¼šè¿›å…¥è¿™ç§çŠ¶æ€ã€‚<br>è¿™ç§çŠ¶æ€è¡¨ç¤ºç­‰å¾…è¢«åŠ¨å…³é—­è¿æ¥çš„ä¸€æ–¹æ­£ç¡®å…³é—­ï¼Œè¿™ä¸ªç­‰å¾…æ—¶é—´æ˜¯2MSL=60ç§’ï¼Œå¦å¤–ï¼Œè¿™ä¸ªçŠ¶æ€è¿˜èµ·åˆ°è®©æ—§è¿æ¥çš„é‡å¤åˆ†èŠ‚åœ¨ç½‘ç»œä¸­è‡ªç„¶æ¶ˆå¤±çš„ä½œç”¨ã€‚<br>MSLæ˜¯æœ€é•¿åˆ†èŠ‚ç”Ÿå‘½å‘¨æœŸæ—¶é—´=30ç§’ï¼Œåˆ†èŠ‚æˆ‘æ²¡ç†è§£æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæ˜¯æŒ‡ä»ä¸€ç«¯å‘é€ä¸€ä¸ªå¯å‘é€çš„æœ€å¤§æ¶ˆæ¯å˜›ï¼Ÿ<br>å¦‚æœè®©æˆ‘æƒ³è±¡çš„è¯ï¼ŒæŠŠä¸€ä¸ªTCPè¿æ¥æ¯”å–»ä¸ºä¸€æ ¹æ°´ç®¡ï¼Œç°åœ¨æƒ³å…³é—­è¿™æ ¹æ°´ç®¡çš„è¿æ¥ï¼Œä¸€ç«¯ä¼šå‘é€ä¸€ä¸ªæ¶ˆæ¯åˆ°å¦ä¸€ç«¯è¯´ä»–æƒ³æ–­å¼€è¿æ¥ï¼Œå¦ä¸€ç«¯æ¥åˆ°æ¶ˆæ¯åä¼šæŠŠæ°´ç®¡ä¸­çš„æ°´å¤„ç†å®Œï¼Œç„¶åå‘é€ä¸€ä¸ªæ¶ˆæ¯è¯´å¥¹çŸ¥é“äº†ï¼Œç”±äºè¿™æ ¹æ°´ç®¡æ˜¯åŒå‘çš„ï¼Œæ‰€ä»¥ï¼Œè¢«åŠ¨å…³é—­çš„ä¸€æ–¹ä¹Ÿä¼šå‘é€ä¸€æ¡æ¶ˆæ¯å‘Šè¯‰å‘èµ·ç«¯ï¼Œä»–çš„æ”¶å°¾å·¥ä½œåšå®Œäº†ï¼Œç°åœ¨å¤„äºå¯å…³é—­çŠ¶æ€ï¼Œå‘èµ·ç«¯æ”¶åˆ°æ¶ˆæ¯åä¼šå‘é€ä¸€ä¸ªç¡®è®¤å…³é—­æ¶ˆæ¯ï¼Œç„¶åç­‰60ç§’ï¼Œè¢«åŠ¨å…³é—­ç«¯æ¥å—åˆ°å“åº”æ¶ˆæ¯åè¿›å…¥çœŸæ­£çš„å…³é—­çŠ¶æ€ã€‚<br>æˆ‘çŒœæƒ³ä¸€ä¸ªTCPè¿æ¥å…³é—­çš„æµç¨‹å¦‚æ­¤å¤æ‚ï¼Œä¸»è¦æ˜¯å› ä¸ºä¸¤ä¸ªåŸå› ï¼Œä¸€æ˜¯TCPè¿æ¥ä¼ è¾“çš„æ˜¯å­—èŠ‚æµï¼Œä¸èƒ½è¯´å…³å°±å…³ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´å­—èŠ‚æµä¿¡æ¯çš„ä¸å®Œæ•´ï¼Œç¬¬äºŒä¸ªåŸå› æ˜¯TCPè¿æ¥æ˜¯åŒå·¥é€šä¿¡ï¼Œä¸¤ç«¯éƒ½å¯è¯»å†™ï¼Œå…³é—­çš„è¿æ¥çš„åŠ¨ä½œéœ€è¦åŒæ–¹é…åˆï¼Œé¦–å…ˆï¼ŒçŸ¥é“è¿™ä¸ªè¿æ¥è¦å…³é—­äº†ï¼Œå°±ä¸å†è¿›è¡Œå†™æ“ä½œäº†ï¼Œå¦å¤–ï¼Œå¤„ç†å®Œæ­¤æ¬¡çš„è¯»æ“ä½œã€‚<br><br>2ï¼šä¸ºå•¥ä¼šå‡ºç°TIME_WAITï¼Ÿ<br>å‚è€ƒ1<br><br>3ï¼šTIME_WAITæ‰€å¸¦æ¥çš„è´Ÿé¢å½±å“ï¼Ÿ<br>åªè¦è¿›è¡ŒTCPçš„è¿æ¥æ–­å¼€æ“ä½œï¼Œå¿…ç„¶ä¼šå‡ºç°TIME_WAITè¿™ä¸ªçŠ¶æ€ï¼Œå¦‚æœé‡å°‘æ— æ‰€è°“ï¼Œåæ­£ä¸€ä¼šå°±ä¼šæ¶ˆå¤±ï¼Œå¦‚æœæŒç»­å‡ºç°ï¼Œä¸”ä¸æ–­å¢é•¿å°±ä¼šå¯¼è‡´å‡ºç°ä¸€äº›é—®é¢˜äº†ï¼Œå› ä¸ºè¿™ä¸ªçŠ¶æ€ä¼šå ç”¨å†…å­˜ç©ºé—´ï¼ŒåŒæ—¶ä¹Ÿä¼šå ç”¨é€šä¿¡ç«¯å£ï¼Œå†…å­˜ç©ºé—´çš„å ç”¨é‡æ¯”è¾ƒå°‘é—®é¢˜ä¸å¤§ï¼Œä¸è¿‡ç«¯å£èµ„æºçš„å ç”¨å¯èƒ½ä¼šå¯¼è‡´æ— æ³•åˆ›å»ºæ–°è¿æ¥ï¼Œè¿™ä¸ªå°±æ¯”è¾ƒä¸¥é‡äº†ï¼Œæ–°è¿æ¥ä¸å¯åˆ›å»ºæ„å‘³ç€å°±ä¸èƒ½è¿›è¡Œè¿æ¥å’Œé€šä¿¡ã€‚æˆ‘ç›®å‰è¿˜æ²¡ç¢°åˆ°è¿‡è¿™ç§æƒ…å†µï¼Œçœ‹è¯„è®ºï¼Œåˆå¾—åˆ°ä¸€ä¸ªæ–°çš„è®¤çŸ¥TCPçš„æœåŠ¡ç«¯ç›‘å¬çš„ç«¯å£æ˜¯å”¯ä¸€çš„ï¼Œä¸è¿‡è¿æ¥çš„ç«¯å£æ˜¯ä¸ç¡®å®šçš„å…·ä½“æœ‰å†…æ ¸å†³å®šç”¨é‚£ä¸ªï¼Œè¿™ä¸ªè¦éªŒè¯ä¸€ä¸‹ã€‚<br><br>4ï¼šè®¾è®¡TIME_WAITè¿™ä¸ªçŠ¶æ€æ˜¯ä¸ºäº†è§£å†³å•¥é—®é¢˜ï¼Ÿ<br>å‚è€ƒ1","like_count":1},{"had_liked":false,"id":133905,"user_name":"è‹¦è¡Œåƒ§","can_delete":false,"product_type":"c1","uid":1055334,"ip_address":"","ucode":"726024A9A9CF44","user_header":"https://static001.geekbang.org/account/avatar/00/10/1a/66/2d9db9ed.jpg","comment_is_top":false,"comment_ctime":1568695130,"is_pvip":false,"replies":[{"id":"51608","content":"ä¸ä¼šä¸æ¶ˆå¤±çš„ï¼Œç³»ç»Ÿè¿‡äº†ä¸€æ®µæ—¶é—´ä¼šè‡ªåŠ¨å›æ”¶TIME_WAITçŠ¶æ€çš„è¿æ¥ã€‚å¦‚æœæ˜¯çªç„¶å‡ºç°å¤§æ‰¹çš„TIME_WAITè¿æ¥ï¼Œéœ€è¦çœ‹ä¸€ä¸‹å¤„ç†æ–­è¿çš„é€»è¾‘ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568885589,"ip_address":"","comment_id":133905,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5863662426","product_id":100032701,"comment_content":"æœåŠ¡å™¨å‡ºç°å¤§é‡time waitå¹¶ä¸”ä¸€ç›´ä¸æ¶ˆå¤± è€å¸ˆè¿™æ˜¯å•¥æƒ…å†µ æ€ä¹ˆè§£å†³ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":467551,"discussion_content":"ä¸ä¼šä¸æ¶ˆå¤±çš„ï¼Œç³»ç»Ÿè¿‡äº†ä¸€æ®µæ—¶é—´ä¼šè‡ªåŠ¨å›æ”¶TIME_WAITçŠ¶æ€çš„è¿æ¥ã€‚å¦‚æœæ˜¯çªç„¶å‡ºç°å¤§æ‰¹çš„TIME_WAITè¿æ¥ï¼Œéœ€è¦çœ‹ä¸€ä¸‹å¤„ç†æ–­è¿çš„é€»è¾‘ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568885589,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130906,"user_name":"ç½‘ç»œäºº","can_delete":false,"product_type":"c1","uid":1651534,"ip_address":"","ucode":"DDFE366083C25E","user_header":"https://static001.geekbang.org/account/avatar/00/19/33/4e/507ad4ea.jpg","comment_is_top":false,"comment_ctime":1567570064,"is_pvip":false,"replies":[{"id":"50833","content":"windowsä¸‹æ²¡æœ‰ç ”ç©¶è¿‡ï¼Œä¸è¿‡åº”è¯¥å¤§å·®ä¸å·®çš„ï¼Œç±»ä¼¼çš„æœºåˆ¶å§ï¼Œä½ å¯ä»¥è¯»è¯»MSDNã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568195791,"ip_address":"","comment_id":130906,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5862537360","product_id":100032701,"comment_content":"è€å¸ˆï¼Œèƒ½è®²ä¸‹windowså¹³å°ä¸‹æœ‰æ²¡æœ‰æä¾›æ›´å®‰å…¨çš„é€‰æ‹©å‘¢ï¼Ÿæœ‰æ²¡æœ‰ç±»ä¼¼çš„æ–¹æ³•ï¼Ÿå¯ä»¥æä¾›ä»£ç å‚è€ƒä¸‹å—ï¼Ÿ<br>","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":466190,"discussion_content":"windowsä¸‹æ²¡æœ‰ç ”ç©¶è¿‡ï¼Œä¸è¿‡åº”è¯¥å¤§å·®ä¸å·®çš„ï¼Œç±»ä¼¼çš„æœºåˆ¶å§ï¼Œä½ å¯ä»¥è¯»è¯»MSDNã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568195791,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129756,"user_name":"æ‰¬ï½","can_delete":false,"product_type":"c1","uid":1208163,"ip_address":"","ucode":"6FA7D8FE188341","user_header":"https://static001.geekbang.org/account/avatar/00/12/6f/63/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1567240950,"is_pvip":false,"replies":[{"id":"50845","content":" netstatçœ‹ä¸€ä¸‹ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆè¿›ç¨‹ï¼Œä»€ä¹ˆç«¯å£ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªç°è±¡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1568196889,"ip_address":"","comment_id":129756,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5862208246","product_id":100032701,"comment_content":"å½“æœºå™¨å‡ºç°å¤§é‡çš„time wait çŠ¶æ€ï¼ŒåŸå› è¯¥å¦‚ä½•æ’æŸ¥å‘€ï¼Œè°¢è°¢è€å¸ˆ","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465631,"discussion_content":" netstatçœ‹ä¸€ä¸‹ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆè¿›ç¨‹ï¼Œä»€ä¹ˆç«¯å£ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¸ªç°è±¡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1568196889,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111870,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK2Az5uTh9ZGVA7yQCj1BXtXuicPRkvJicA97AoN9xX3bnPcUYglTMXJeZeoVbPQeJA7ICvQhR3KQ0w/132","nickname":"æ—¥ä¸è½å¸å›½","note":"","ucode":"6A11ABBD8AC438","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25516,"discussion_content":"å­¦ä¹ ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570535423,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127339,"user_name":"æ²‰æ·€çš„æ¢¦æƒ³","can_delete":false,"product_type":"c1","uid":1177315,"ip_address":"","ucode":"BCB7C26F9D214B","user_header":"https://static001.geekbang.org/account/avatar/00/11/f6/e3/e4bcd69e.jpg","comment_is_top":false,"comment_ctime":1566657731,"is_pvip":false,"replies":[{"id":"48206","content":"å¤§éƒ¨åˆ†ç¨‹åºæ˜¯éœ€è¦è¿™ä¹ˆå¹²çš„ï¼Œä¸æ˜¯ä»€ä¹ˆ&quot;å&quot;ä¹ æƒ¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567131970,"ip_address":"","comment_id":127339,"utype":1}],"discussion_count":2,"race_medal":0,"score":"5861625027","product_id":100032701,"comment_content":"ä½¿ç”¨SO_REUSEADDRå’ŒSO_REUSEPORTè¿™ä¸¤ä¸ªé€‰é¡¹æ˜¯å¥½çš„æ–¹æ³•å—ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464449,"discussion_content":"å¤§éƒ¨åˆ†ç¨‹åºæ˜¯éœ€è¦è¿™ä¹ˆå¹²çš„ï¼Œä¸æ˜¯ä»€ä¹ˆ&amp;quot;å&amp;quot;ä¹ æƒ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567131970,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1145650,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7b/32/60089a62.jpg","nickname":"æ¨é¢†well","note":"","ucode":"3974A03855168C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6165,"discussion_content":"æ˜¯çš„ã€‚å¼•ç”¨æˆ‘åœ¨ä¸Šé¢çš„å›ç­”:\nTIME_WAIT çŠ¶æ€æ˜¯ä¸€å®šè¦æœ‰çš„ï¼Œ SO_REUSEADDR ä¹‹å‰åœ¨æœ€å¤§é™åº¦çš„å®ç°åœ°å€çš„é‡ç”¨ã€‚TCP è¿æ¥å¯ä»¥ç”¨å››å…ƒç»„(æœ¬ç«¯IP, æœ¬ç«¯port, å¯¹ç«¯IP, å¯¹ç«¯port)å”¯ä¸€ç¡®å®šã€‚å¦‚æœæ²¡æœ‰è®¾ç½® SO_REUSEADDRï¼Œ æœ¬ç«¯ IP éƒ½ä¸èƒ½é‡ç”¨ã€‚è€Œè®¾ç½®äº†çš„è¯ï¼Œåªè¦å››å…ƒç»„ä¸åŒï¼Œå°±å¯ä»¥é‡ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566736098,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":350175,"user_name":"å–è—¥éƒ","can_delete":false,"product_type":"c1","uid":1231829,"ip_address":"","ucode":"0539EF1D335918","user_header":"https://static001.geekbang.org/account/avatar/00/12/cb/d5/fab32cf7.jpg","comment_is_top":false,"comment_ctime":1656639342,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1656639342","product_id":100032701,"comment_content":"æ„Ÿè§‰å†™çš„æ¯”è¾ƒä¹± ä¸å¤ªæ¸…æ™°","like_count":0},{"had_liked":false,"id":345786,"user_name":"æˆä¸ºä¼˜ç§€çš„ç¨‹åºå‘˜","can_delete":false,"product_type":"c1","uid":2275516,"ip_address":"","ucode":"6D9080A2B225AE","user_header":"https://static001.geekbang.org/account/avatar/00/22/b8/bc/d2d547c9.jpg","comment_is_top":false,"comment_ctime":1652595937,"is_pvip":true,"replies":[{"id":"126188","content":"æ ¹æ®åºåˆ—å·ï¼Œé‡å¤çš„å¯ä»¥å‘ç°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1618647","ctime":1652614040,"ip_address":"","comment_id":345786,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1652595937","product_id":100032701,"comment_content":"çœ‹å®Œæ–‡ç« ï¼Œçªç„¶æœ‰ä¸ªç–‘é—®ï¼ŒTCPæ˜¯æ€ä¹ˆå¤„ç†é‡å¤æŠ¥æ–‡é—®é¢˜çš„ã€‚","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":572129,"discussion_content":"æ ¹æ®åºåˆ—å·ï¼Œé‡å¤çš„å¯ä»¥å‘ç°ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1652614040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":338322,"user_name":"Info_E","can_delete":false,"product_type":"c1","uid":1755152,"ip_address":"","ucode":"97207B2CC4C776","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/VTPuhJb5xxuRwH1iblqrAe3De4PoETgNWibZRkLlhvszysdtpAvSPZFuYtsJfWJmoXOFFWnpR02W9NGIiammU8UPg/132","comment_is_top":false,"comment_ctime":1647423012,"is_pvip":false,"replies":[{"id":"124146","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1618647","ctime":1648297945,"ip_address":"","comment_id":338322,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1647423012","product_id":100032701,"comment_content":"ä¸ºä»€ä¹ˆæ˜¯2MSLï¼Œä¸æ˜¯1MSL åŸå› æ˜¯ ï¼š<br>æœåŠ¡ç«¯å‘é€FINåå¼€å§‹å€’è®¡æ—¶ï¼Œå‡è®¾0.2MSLåˆ°è¾¾å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”è¶…è¿‡1MSLæ²¡æœ‰æ”¶åˆ°ACKå°±é‡å‘FINï¼›<br>å®¢æˆ·ç«¯æ”¶åˆ°FINåï¼Œå‘é€ACKï¼Œå‡è®¾ç½‘ç»œæ‹¥å µï¼Œè¿™ä¸ªACKåœ¨å®¢æˆ·ç«¯å‘é€0.9MSLæ‰åˆ°è¾¾æœåŠ¡ç«¯ï¼›<br>æœåŠ¡ç«¯å› ä¸ºå‘é€FIN è€—æ—¶ 0.2 + å®¢æˆ·ç«¯å‘é€ACK 0.9 = 1.1 &gt; 1 MSLï¼Œæ‰€ä»¥æœåŠ¡ç«¯é‡å‘äº†FINï¼›<br>å‡è®¾è¿™ä¸ªFINåˆå› ä¸ºæ‹¥å µï¼ŒèŠ±è´¹äº†0.9MSLæ‰åˆ°è¾¾å®¢æˆ·ç«¯ï¼›<br>åœ¨å®¢æˆ·ç«¯çœ‹æ¥ï¼Œä»å‘é€ACKï¼Œåˆ°é‡æ–°æ¥å—FINï¼ŒèŠ±è´¹æ—¶é—´æ˜¯ACK0.9 + FIN0.9 = 1.8MSLã€‚<br>ç»¼ä¸Šï¼šä¸ºäº†ç¡®ä¿å®¢æˆ·ç«¯èƒ½æ¥æ”¶åˆ°æœåŠ¡ç«¯çš„FINï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯æ¥å—åˆ°FINåå¿…é¡»ç­‰å¾…æ—¶é—´ &gt;1.8MSLæ‰è¡Œã€‚ä»¥ä¸Šæ•°æ®åªæ˜¯å‡è®¾ï¼Œå¯ä»¥æŠŠ0.9æ›¿æ¢æˆ0.9999999999999ï¼Œå–ä¸ªæé™ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯TIME_WAIT å°±æ— é™è¶‹è¿‘äº2MSLã€‚ æ‰€ä»¥ TIME_WAITè®¾ç½®ä¸º2MSLæ˜¯å®‰å…¨çš„ã€‚","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":558437,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1648297946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2608728,"avatar":"https://static001.geekbang.org/account/avatar/00/27/ce/58/71ed845f.jpg","nickname":"Dexter","note":"","ucode":"909CABC4AC4AC9","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573857,"discussion_content":"ä½ è¿™é€»è¾‘ä¸å¯¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653690591,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":333734,"user_name":"tianbingJ","can_delete":false,"product_type":"c1","uid":2163653,"ip_address":"","ucode":"666141CAD8260F","user_header":"https://static001.geekbang.org/account/avatar/00/21/03/c5/600fd645.jpg","comment_is_top":false,"comment_ctime":1644490458,"is_pvip":true,"replies":[{"id":"122010","content":"è¿™åº”è¯¥ä¸è¡Œï¼Œè¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„TCPè¿æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ç¼–è¾‘","uid":"1618647","ctime":1644729132,"ip_address":"","comment_id":333734,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1644490458","product_id":100032701,"comment_content":"â€œä¸€ä¸ª TCP è¿æ¥è‡³å°‘æ¶ˆè€—ä¸€ä¸ªæœ¬åœ°ç«¯å£â€æ˜¯ä¸æ˜¯å½±å“å±€é™äºå›ºå®šå¯¹æ–¹çš„æ¡ä»¶ä¸‹ï¼Ÿ<br>æ¯”å¦‚ä¸€ä¸ªclientå’Œä¸€ä¸ªserverå»ºç«‹èµ·äº†è¿æ¥1ï¼Œå ç”¨ä¸€ä¸ªç«¯å£port1ï¼›å®ƒä¾ç„¶å¯ä»¥ç”¨port1å’Œserver 2å»ºç«‹è¿æ¥ï¼›ç«¯å£port1è¢«ä½¿ç”¨äº†ä¸¤æ¬¡ã€‚","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550760,"discussion_content":"è¿™åº”è¯¥ä¸è¡Œï¼Œè¿™æ˜¯ä¸¤ä¸ªä¸åŒçš„TCPè¿æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644729132,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2163653,"avatar":"https://static001.geekbang.org/account/avatar/00/21/03/c5/600fd645.jpg","nickname":"tianbingJ","note":"","ucode":"666141CAD8260F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550512,"discussion_content":"å¥½åƒæ˜¯å®ç°ä¸Šçš„é™åˆ¶å¯¼è‡´clientç«¯ä¸Šçš„portä¸èƒ½é‡ç”¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644572695,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":316171,"user_name":"æ¯å¤©æ™’ç™½ç‰™","can_delete":false,"product_type":"c1","uid":1004698,"ip_address":"","ucode":"A1B102CD933DEA","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/9a/76c0af70.jpg","comment_is_top":false,"comment_ctime":1634189915,"is_pvip":false,"replies":[{"id":"115263","content":"æ€»ç»“çš„æŒºåˆ°ä½ ğŸ‘","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1635128141,"ip_address":"","comment_id":316171,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1634189915","product_id":100032701,"comment_content":"TIME_WAITçš„ä½œç”¨<br>1.ç¡®ä¿TCPå››æ¬¡æŒ¥æ‰‹ä¸­æœ€åçš„ACKè®©è¢«åŠ¨æ–¹æ¥æ”¶åˆ°ï¼Œä½¿å…¶æ­£å¸¸å…³é—­<br>2.é¿å…ç›¸åŒå››å…ƒç»„ï¼ˆæºIPï¼Œæºç«¯å£ï¼Œç›®çš„IPï¼Œç›®çš„ç«¯å£ï¼‰çš„æ—§è¿æ¥å¯¹æ–°è¿æ¥äº§ç”Ÿå½±å“<br><br>TIME_WAITçŠ¶æ€å›ºå®šæ—¶é—´æ˜¯60sï¼Œå¹¶ä¸”åªæœ‰ä¸»åŠ¨å…³é—­ä¸€æ–¹ä¼šè¿›å…¥è¿™ä¸ªçŠ¶æ€<br><br>TIME_WAITçš„å±å®³<br>1.å å†…å­˜ï¼ŒåŸºæœ¬å¯ä»¥å¿½ç•¥<br>2.å ç”¨æœ¬åœ°ç«¯å£èµ„æºï¼Œç«¯å£æ˜¯æœ‰é™çš„ï¼Œå¦‚æœTIME_WAITçŠ¶æ€è¿‡å¤šï¼Œå°±æ— æ³•åˆ›å»ºæ–°è¿æ¥äº†<br>å¤‡æ³¨ï¼šæœåŠ¡ç«¯çš„ç«¯å£æ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚8080ï¼Œéœ€è¦æå‰å¼€å¯ç›‘å¬ï¼Œä½†å®¢æˆ·ç«¯çš„ç«¯å£æ˜¯ç”±æ“ä½œç³»ç»Ÿå†…æ ¸ä¸´æ—¶åˆ†é…çš„ï¼Œæ‰€ä»¥ç«¯å£æ˜¯æœ‰é™åˆ¶çš„<br><br>ä¼˜åŒ– TIME_WAITçš„æ–¹æ³•<br>1.å°†TIME_WAITçŠ¶æ€è¿æ¥çš„é˜ˆå€¼é™ä½ï¼Œä¿®æ”¹net.ipv4_tcp_max_tw_buckets<br>ç³»ç»Ÿä¸­å¤„äºTIME_WAITçš„è¿æ¥è¶…è¿‡é˜ˆå€¼ï¼Œæ¯”è¾ƒæš´åŠ›ï¼Œæ²»æ ‡ä¸æ²»æœ¬<br>2.è°ƒä½TIME_WAITçŠ¶æ€çš„ç­‰å¾…æ—¶é—´ï¼Œä¿®æ”¹TCP_TIMEWAIT_LENï¼Œä½†éœ€è¦é‡æ–°ç¼–è¯‘å†…æ ¸ç³»ç»Ÿ<br>3.è®¾ç½®SO_LINGERï¼Œæ¯”è¾ƒå±é™©ï¼Œå…·ä½“åŸç†æˆ‘ä¹Ÿä¸æ‡‚<br>4.ä½¿ç”¨ net.ipv4.tcp_tw_reuse æ›´å®‰å…¨çš„è®¾ç½®<br>Allow to reuse TIME-WAIT sockets for new connections when it is safe from protocol viewpoint. Default value is 0.It should not be changed without advice&#47;request of technical experts.<br>å¤§æ„æ˜¯ä»åè®®è§’åº¦ç†è§£å¦‚æœæ˜¯å®‰å…¨çš„ï¼Œå¯ä»¥å¤ç”¨å¤„äº TIME_WAITçŠ¶æ€ä¸‹çš„å¥—æ¥å­—ç»™æ–°çš„è¿æ¥ä½¿ç”¨<br>æˆ‘ç†è§£ä¹‹å‰çš„å¥—æ¥å­—è¿˜åœ¨ï¼Œè¢«æ–°çš„è¿æ¥å¤ç”¨äº†<br>å¤ç”¨çš„ä»€ä¹ˆï¼Ÿå¤ç”¨çš„å¥—æ¥å­—å³ æºipï¼Œæºç«¯å£ï¼Œç›®æ ‡ipï¼Œç›®æ ‡ç«¯å£è¿™ä¸ªå››å…ƒç»„<br>","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":528292,"discussion_content":"æ€»ç»“çš„æŒºåˆ°ä½ ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1635128141,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":292250,"user_name":"leesper","can_delete":false,"product_type":"c1","uid":1351104,"ip_address":"","ucode":"CC76320571BECA","user_header":"https://static001.geekbang.org/account/avatar/00/14/9d/c0/cb5341ec.jpg","comment_is_top":false,"comment_ctime":1620739195,"is_pvip":false,"replies":[{"id":"106721","content":"é—®é¢˜æ˜¯ä½ å¾—æ„é€ å‡ºè¿™æ ·çš„åŒ…æ¥","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1621779015,"ip_address":"","comment_id":292250,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1620739195","product_id":100032701,"comment_content":"â€œ2MSL çš„æ—¶é—´æ˜¯ä»ä¸»æœº 1 æ¥æ”¶åˆ° FIN åå‘é€ ACK å¼€å§‹è®¡æ—¶çš„â€ï¼Œå¦‚æœä¸»æœº2æ¶æ„çš„ä¸åœå‘FINåŒ…ç»™ä¸»æœº1ï¼Œè®©å®ƒé•¿æ—¶é—´å¤„äºTIME_WAITçŠ¶æ€ï¼Œè¿™æ˜¯ä¸æ˜¯ä¸€ç§ç½‘ç»œæ”»å‡»å‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":519747,"discussion_content":"é—®é¢˜æ˜¯ä½ å¾—æ„é€ å‡ºè¿™æ ·çš„åŒ…æ¥","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621779015,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":249877,"user_name":"jin","can_delete":false,"product_type":"c1","uid":1202896,"ip_address":"","ucode":"DCA0E9C1F7838F","user_header":"https://static001.geekbang.org/account/avatar/00/12/5a/d0/5be738e0.jpg","comment_is_top":false,"comment_ctime":1600840992,"is_pvip":false,"replies":[{"id":"92051","content":"å“¦ï¼Œç†è®ºä¸Šæ˜¯çš„ï¼Œä¸è¿‡å®é™…ä¸­è¿˜æ˜¯ç«¯å£ä¸ä¼šé‡å¤çš„ï¼Œæ¯•ç«Ÿå®ç°èµ·æ¥æ¯”è¾ƒç®€å•ç›´æ¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1601870726,"ip_address":"","comment_id":249877,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1600840992","product_id":100032701,"comment_content":"è€å¸ˆå¥½ï¼Œæƒ³è¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼š<br>æ‚¨æ–‡ç« é‡Œæåˆ°çš„â€œåº”ç”¨æœåŠ¡éœ€è¦é€šè¿‡å‘èµ· TCP è¿æ¥å¯¹å¤–æä¾›æœåŠ¡â€œï¼Œæˆ‘çš„ç†è§£æ˜¯è¿™é‡Œåº”ç”¨æœåŠ¡æ˜¯ä½œä¸ºå®¢æˆ·ç«¯çš„è§’è‰²ï¼Œç„¶åæ¯å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œå°±ä¼šè®©æ“ä½œç³»ç»Ÿé»˜è®¤æ–°åˆ†é…ä¸€ä¸ªç«¯å£ç”¨äºæ–°çš„å¥—æ¥å­—ã€‚æˆ‘çš„é—®é¢˜æ˜¯ï¼Œè¿™é‡Œçš„ç«¯å£ä¸å¯ä»¥é‡å¤ä½¿ç”¨å—ï¼Ÿå› ä¸ºTCPçš„å¥—æ¥å­—æ ‡è¯†ç¬¦æ˜¯ (c_ip:c_port, s_ip:s_port)ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š<br>1. serverä¸åŒï¼Œé‚£åªæœ‰c_ipå’Œc_porté‡å¤ä¹Ÿæ²¡å…³ç³»å§ï¼Ÿ<br>2. serverç›¸åŒï¼Œé‚£ä¸ºäº†é˜²æ­¢æ··ä¹±ï¼Œåªèƒ½æ¯æ¬¡ä½¿ç”¨ä¸€ä¸ªæ–°ç«¯å£ï¼Œæ‚¨çš„åº”ç”¨æœåŠ¡æ˜¯è¿™ç§æƒ…å†µå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":506043,"discussion_content":"å“¦ï¼Œç†è®ºä¸Šæ˜¯çš„ï¼Œä¸è¿‡å®é™…ä¸­è¿˜æ˜¯ç«¯å£ä¸ä¼šé‡å¤çš„ï¼Œæ¯•ç«Ÿå®ç°èµ·æ¥æ¯”è¾ƒç®€å•ç›´æ¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601870726,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":248220,"user_name":"CCC","can_delete":false,"product_type":"c1","uid":2128686,"ip_address":"","ucode":"B7064B564F8ECB","user_header":"https://static001.geekbang.org/account/avatar/00/20/7b/2e/e3facf52.jpg","comment_is_top":false,"comment_ctime":1600068414,"is_pvip":false,"replies":[{"id":"92049","content":"æˆ‘åœ¨19è®²ä¼šè®²åˆ°ã€‚:)","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1601869953,"ip_address":"","comment_id":248220,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1600068414","product_id":100032701,"comment_content":"â€åœ¨å‰é¢çš„åŸºç¡€ç¯‡é‡Œï¼Œæˆ‘ä»¬äº†è§£äº† TCP å››æ¬¡æŒ¥æ‰‹ï¼Œåœ¨å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹ä¸­ï¼Œå‘èµ·è¿æ¥æ–­å¼€çš„ä¸€æ–¹ä¼šæœ‰ä¸€æ®µæ—¶é—´å¤„äº TIME_WAIT çš„çŠ¶æ€ï¼Œä½ çŸ¥é“ TIME_WAIT æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ä¹ˆï¼Ÿâ€œ  è€å¸ˆä½ è¿™ä¸ªåŸºç¡€ç¯‡æ²¡è®²TCP å››æ¬¡æŒ¥æ‰‹å§ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":505587,"discussion_content":"æˆ‘åœ¨19è®²ä¼šè®²åˆ°ã€‚:)","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601869953,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":243297,"user_name":"æ™šé£Â·å’Œç…¦","can_delete":false,"product_type":"c1","uid":1236047,"ip_address":"","ucode":"0B1DB8F437A4B2","user_header":"","comment_is_top":false,"comment_ctime":1598024134,"is_pvip":false,"replies":[{"id":"90116","content":"å†™ä¸€ä¸ªç¨‹åºéªŒè¯ä¸€ä¸‹ï¼Ÿ","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1598795219,"ip_address":"","comment_id":243297,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1598024134","product_id":100032701,"comment_content":"è€å¸ˆï¼Œå¦‚æœå¥—æ¥å­—çš„æ¥æ”¶ç¼“å†²åŒºçš„æ•°æ®æ²¡æœ‰è¯»å‡ºæ¥ï¼Œç›´æ¥å…³é—­ï¼Œæ˜¯ä¸æ˜¯ä¼šå‘é€RST","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":504249,"discussion_content":"å†™ä¸€ä¸ªç¨‹åºéªŒè¯ä¸€ä¸‹ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598795219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":234935,"user_name":"èŒƒå¹¿å®‡","can_delete":false,"product_type":"c1","uid":1248960,"ip_address":"","ucode":"FC4F73F683937E","user_header":"https://static001.geekbang.org/account/avatar/00/13/0e/c0/ec9dcece.jpg","comment_is_top":false,"comment_ctime":1594830147,"is_pvip":false,"replies":[{"id":"86819","content":"ä¸€èˆ¬æˆ‘ä»¬åœ¨Linuxä¸‹è°ƒç”¨çš„éƒ½æ˜¯glibcåº“å‡½æ•°ï¼Œè€Œglibcæ˜¯å°è£…äº†ç³»ç»Ÿè°ƒç”¨çš„æ ‡å‡†Cè¯­è¨€åº“ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1594908476,"ip_address":"","comment_id":234935,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1594830147","product_id":100032701,"comment_content":"è€å¸ˆï¼Œæˆ‘æƒ³é—®ä¸ªä¸å’Œè¿™èŠ‚è¯¾æ²¾è¾¹çš„é—®é¢˜ã€‚æˆ‘æƒ³é—®ä¸‹ï¼Œå’±ä»¬å†™ç¨‹åºçš„socketç›¸å…³å‡½æ•°ï¼Œæ˜¯å±äºç³»ç»Ÿè°ƒç”¨ï¼Ÿè¿˜æ˜¯å±äºå°è£…äº†ç³»ç»Ÿè°ƒç”¨çš„åº“å‡½æ•°å‘¢ï¼Ÿä»Šå¤©æŸ¥äº†ä¸€äº›èµ„æ–™ä¹Ÿæ²¡æ‰¾åˆ°ä»€ä¹ˆæœ‰è¯´æœåŠ›çš„ç»“æœã€‚","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501553,"discussion_content":"ä¸€èˆ¬æˆ‘ä»¬åœ¨Linuxä¸‹è°ƒç”¨çš„éƒ½æ˜¯glibcåº“å‡½æ•°ï¼Œè€Œglibcæ˜¯å°è£…äº†ç³»ç»Ÿè°ƒç”¨çš„æ ‡å‡†Cè¯­è¨€åº“ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594908476,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":226794,"user_name":"éƒ‘ç¥–ç…Œ","can_delete":false,"product_type":"c1","uid":1469608,"ip_address":"","ucode":"49A0D2E3279826","user_header":"https://static001.geekbang.org/account/avatar/00/16/6c/a8/1922a0f5.jpg","comment_is_top":false,"comment_ctime":1592205617,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592205617","product_id":100032701,"comment_content":"ç”±äºå†…å­˜å ç”¨çš„å½±å“å¿½ç•¥ä¸è®¡ï¼Œæ‰€ä»¥ä¸»è¦è¿˜æ˜¯ç«¯å£å ç”¨å¯¹åº”ç”¨ç¨‹åºçš„å½±å“æ›´å¤§ã€‚ å¦‚ä½•æ­£ç¡®çš„å¤„ç†TIME_WAIT,ä¸»è¦ä¸€ä¸ªæ˜¯SO_LINGER çš„è®¾ç½®truct linger {ã€€intã€€ l_onoff;ã€€intã€€ l_linger; } å¼€å¯çš„æ—¶å€™è®¾ç½®l_onoffè®¾ç½®ä¸º1ï¼ŒåŒæ—¶è®¾ç½®l_lingerè®¾ç½®ä¸€ä¸ªå¯æ§çš„æ—¶é—´ã€‚åˆ‡å¿Œè®¾ç½®ä¸º0ï¼Œ ä¸º0å°†è·³è¿‡å››æ¬¡æŒ¥æ‰‹ç›´æ¥close.å‘é€å¯¹ç«¯RSTã€‚ 2ï¼‰è®¾ç½®net.ipv4.tcp_tw_reuseåŒæ—¶å¾—è®¾ç½®net.ipv4.tcp_timestamps=1ï¼ˆé»˜è®¤å³ä¸º 1ï¼‰æ‰“å¼€ã€‚","like_count":0},{"had_liked":false,"id":226789,"user_name":"éƒ‘ç¥–ç…Œ","can_delete":false,"product_type":"c1","uid":1469608,"ip_address":"","ucode":"49A0D2E3279826","user_header":"https://static001.geekbang.org/account/avatar/00/16/6c/a8/1922a0f5.jpg","comment_is_top":false,"comment_ctime":1592205139,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1592205139","product_id":100032701,"comment_content":"TIME_WAITçš„ä½œç”¨ï¼š<br>1ï¼‰ ç¡®ä¿å¯¹æ–¹èƒ½å¤Ÿæ­£ç¡®æ”¶åˆ°æœ€åçš„ACKï¼Œå¸®åŠ©å…¶å…³é—­ï¼›<br>2ï¼‰ é˜²è¿·èµ°æŠ¥æ–‡å¯¹ç¨‹åºå¸¦æ¥çš„å½±å“ã€‚<br>TIME_WAITçš„å±å®³ï¼š<br>1ï¼‰ å ç”¨å†…å­˜ï¼›<br>2ï¼‰ å ç”¨ç«¯å£","like_count":0},{"had_liked":false,"id":224506,"user_name":"å®‹è","can_delete":false,"product_type":"c1","uid":1880075,"ip_address":"","ucode":"7105B7D5B1E338","user_header":"","comment_is_top":false,"comment_ctime":1591423764,"is_pvip":false,"replies":[{"id":"84262","content":"æˆ‘è§‰å¾—æ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚æŠ¥æ–‡ç¼–å·å’Œæ—¶é—´æˆ³æœ‰å…³ç³»ï¼Œå°±å¯ä»¥ä¿è¯æŠ¥æ–‡ç¼–å·æ˜¯çº¿æ€§ä¸åŒçš„ã€‚ä½†æ˜¯è®¾è®¡TCPæ˜¯é‚£ä¹ˆä¹…è¿œä¹‹å‰çš„äº‹æƒ…ï¼Œæ‰€ä»¥å½“æ—¶æ˜¯æ²¡æœ‰è€ƒè™‘è¿™ä¹ˆå‘¨è¯¦çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1592739824,"ip_address":"","comment_id":224506,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1591423764","product_id":100032701,"comment_content":"è¿·èµ°æŠ¥æ–‡çš„é—®é¢˜ä¸å¥½å¤„ç†ï¼Œtcpé“¾è·¯é‡è¿åï¼ŒæŠ¥æ–‡ç¼–å·åº”è¯¥å’Œä¹‹å‰çš„é“¾è·¯ä¸ä¸€è‡´äº†ï¼Œèƒ½ä¸èƒ½è§£å†³è¿·èµ°æŠ¥æ–‡ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":497500,"discussion_content":"æˆ‘è§‰å¾—æ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚æŠ¥æ–‡ç¼–å·å’Œæ—¶é—´æˆ³æœ‰å…³ç³»ï¼Œå°±å¯ä»¥ä¿è¯æŠ¥æ–‡ç¼–å·æ˜¯çº¿æ€§ä¸åŒçš„ã€‚ä½†æ˜¯è®¾è®¡TCPæ˜¯é‚£ä¹ˆä¹…è¿œä¹‹å‰çš„äº‹æƒ…ï¼Œæ‰€ä»¥å½“æ—¶æ˜¯æ²¡æœ‰è€ƒè™‘è¿™ä¹ˆå‘¨è¯¦çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592739824,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":206165,"user_name":"WhatAKitty","can_delete":false,"product_type":"c1","uid":1135707,"ip_address":"","ucode":"911C089450926B","user_header":"https://static001.geekbang.org/account/avatar/00/11/54/5b/1a14d829.jpg","comment_is_top":false,"comment_ctime":1586800450,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586800450","product_id":100032701,"comment_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š<br>åœ¨ä¸»åŠ¨å…³é—­ä¸€æ–¹å‘é€ç¡®è®¤æŠ¥æ–‡åï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§å¼‚å¸¸æƒ…å†µä¼šå‘ç”Ÿï¼š<br>a. è¢«åŠ¨å…³é—­ä¸€æ–¹æ²¡æœ‰æ”¶åˆ°ACKï¼Œè¶…æ—¶é‡ä¼ FIN<br>b. è¢«åŠ¨ä¸€æ–¹æ”¶åˆ°ACKï¼Œä¸ä¼šå†å‘ä»»ä½•æ¶ˆæ¯ï¼ŒåŒ…æ‹¬ACK<br><br>è¿™ä¸¤ç§æƒ…å†µä¸»åŠ¨å…³é—­ä¸€æ–¹éƒ½éœ€è¦ç­‰å¾…ï¼Œè€Œæœ€åç­‰å¾…æ—¶é•¿ä¸ºï¼š<br>å»æ—¶ACKçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰+æ¥æ—¶FIINçš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆMSLï¼‰ = 2MSL<br><br>æ‰€ä»¥è¿™æ ·èƒ½ç¡®ä¿æ‰€æœ‰çš„æ´»è·ƒæŠ¥æ–‡å…¨éƒ¨æ¶ˆäº¡<br><br>ç¬¬äºŒä¸ªé—®é¢˜ï¼š<br>ä¸éœ€è¦","like_count":0},{"had_liked":false,"id":200076,"user_name":"å¼ å¤©å±¹","can_delete":false,"product_type":"c1","uid":1477612,"ip_address":"","ucode":"8BD6BD6DCF0F4F","user_header":"https://static001.geekbang.org/account/avatar/00/16/8b/ec/dc03f5ad.jpg","comment_is_top":false,"comment_ctime":1585540313,"is_pvip":false,"replies":[{"id":"75793","content":"æ˜¯åŒä¸€ä¸ªç«¯å£ï¼ŒæœåŠ¡ç«¯ä¸ä¼šä¸ºæ–°è¿æ¥å¼€å¯æ–°çš„ç«¯å£çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1586076949,"ip_address":"","comment_id":200076,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585540313","product_id":100032701,"comment_content":"æ¯”å¦‚æœåŠ¡é€šè¿‡å›ºå®šçš„80ç«¯å£æä¾›æœåŠ¡ï¼Œä¸€ä¸‡çš„å¹¶å‘HTTPè¯·æ±‚è¿‡æ¥  éƒ½æ˜¯åŒä¸€ä¸ªç«¯å£å“‡ï¼Œä¸æ˜¯å¾ˆç†è§£æ¯æ¬¡è¯·æ±‚ä¸€ä¸ªæ–°çš„TCPè¿æ¥ä¸€ä¸ªæ–°çš„ç«¯å£çš„åœºæ™¯","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489934,"discussion_content":"æ˜¯åŒä¸€ä¸ªç«¯å£ï¼ŒæœåŠ¡ç«¯ä¸ä¼šä¸ºæ–°è¿æ¥å¼€å¯æ–°çš„ç«¯å£çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586076949,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199644,"user_name":"å¾è¡¡","can_delete":false,"product_type":"c1","uid":1881664,"ip_address":"","ucode":"06EBCB2F507603","user_header":"https://static001.geekbang.org/account/avatar/00/1c/b6/40/6060d233.jpg","comment_is_top":false,"comment_ctime":1585493080,"is_pvip":false,"replies":[{"id":"75789","content":"è¿™ä¸ªåº”è¯¥æ˜¯å®ç°ç»†èŠ‚äº†ï¼Œä¸è¿‡ç¨‹åºå‘˜å°±æ˜¯å–œæ¬¢å…³æ³¨ç»†èŠ‚çš„ã€‚<br><br>æˆ‘æƒ³è¿™ä¸ªç±»ä¼¼å¼‚å¸¸å¤„ç†çš„åœºæ™¯ï¼Œæ˜¯ä¸æ˜¯ç±»ä¼¼æœ‰æ—¶é—´è®¡æ—¶å™¨ä¹‹ç±»çš„ï¼Œåœ¨è¶…è¿‡ä¸€å®šæ—¶é—´ä¹‹åï¼Œè¿™æ ·å¼‚å¸¸çŠ¶æ€çš„è¿æ¥ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨æ¸…ç†æ‰ï¼Œä¹Ÿå°±æ˜¯è¯´ç«¯å£éšä¹‹é‡Šæ”¾æ‰ã€‚ä¸è¿‡è¿™ç§ç½•è§çš„åœºæ™¯å¤§æ¦‚åªèƒ½ä»æºç ä¸­çœ‹åˆ°ç«¯å€ªäº†ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1586076828,"ip_address":"","comment_id":199644,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585493080","product_id":100032701,"comment_content":"å¼•ç”¨è¯„è®ºä¸­çš„é—®é¢˜å†é—®ä¸€ä¸ªé—®é¢˜ï¼Œ<br>åœ¨FIN_WAIT_1æˆ–FIN_WAIT_2åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ä¹‹é—´çš„è½¬æ¢ç¼ºå°‘å¿…è¦çš„æ¡ä»¶ï¼Œä¼šåœç•™åœ¨è¿™ä¸ªçŠ¶æ€ï¼Œæœ‰å°±æ˜¯è¯´ä¸ä¼šå¾€ä¸‹ä¸€ä¸ªçŠ¶æ€è½¬æ¢ï¼Œé‚£ä¹ˆ clientç«¯çš„è¿™ä¸ªè¿æ¥å°±ä¼šä¸€ç›´å ç”¨ç€å—ï¼Ÿ<br><br>èƒ¡æ³¢ allenhu<br>è€å¸ˆï¼Œè¯·é—®å¦‚æœæœ¬æ–¹è°ƒç”¨closeåå‘é€FINï¼Œå¯¹æ–¹æ²¡æœ‰å›ACK,æˆ–è€…å›äº†ACK, ä½†æ˜¯å¯¹æ–¹æ²¡æœ‰å›FIN, è¿™ä¸ªæ—¶å€™æœ¬æ–¹çš„SOCKETä¼šä¸€ç›´æ˜¯FIN_WAIT_1æˆ–FIN_WAIT_2çŠ¶æ€å—ï¼Ÿä¼šä¸ä¼šåˆ°TIME_WAITçŠ¶æ€<br>ä½œè€…å›å¤: å¥½é—®é¢˜ï¼Œæˆ‘ä¸ªäººç†è§£è¿™æ˜¯ä¸€ä¸ªè½¬æ€é©±åŠ¨çš„ï¼Œå¦‚æœä»FIN_WAIT_1æˆ–FIN_WAIT_2åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ä¹‹é—´çš„è½¬æ¢ç¼ºå°‘å¿…è¦çš„æ¡ä»¶ï¼Œä¼šåœç•™åœ¨è¿™ä¸ªçŠ¶æ€ï¼Œæœ‰å°±æ˜¯è¯´ä¸ä¼šå¾€ä¸‹ä¸€ä¸ªçŠ¶æ€è½¬æ¢ã€‚<br><br>","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489859,"discussion_content":"è¿™ä¸ªåº”è¯¥æ˜¯å®ç°ç»†èŠ‚äº†ï¼Œä¸è¿‡ç¨‹åºå‘˜å°±æ˜¯å–œæ¬¢å…³æ³¨ç»†èŠ‚çš„ã€‚\n\næˆ‘æƒ³è¿™ä¸ªç±»ä¼¼å¼‚å¸¸å¤„ç†çš„åœºæ™¯ï¼Œæ˜¯ä¸æ˜¯ç±»ä¼¼æœ‰æ—¶é—´è®¡æ—¶å™¨ä¹‹ç±»çš„ï¼Œåœ¨è¶…è¿‡ä¸€å®šæ—¶é—´ä¹‹åï¼Œè¿™æ ·å¼‚å¸¸çŠ¶æ€çš„è¿æ¥ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨æ¸…ç†æ‰ï¼Œä¹Ÿå°±æ˜¯è¯´ç«¯å£éšä¹‹é‡Šæ”¾æ‰ã€‚ä¸è¿‡è¿™ç§ç½•è§çš„åœºæ™¯å¤§æ¦‚åªèƒ½ä»æºç ä¸­çœ‹åˆ°ç«¯å€ªäº†ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586076828,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":173640,"user_name":"åˆ˜å¿½æ‚ ","can_delete":false,"product_type":"c1","uid":1252173,"ip_address":"","ucode":"095DE3A8D3F450","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/4d/2cc44d9a.jpg","comment_is_top":false,"comment_ctime":1579638151,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1579638151","product_id":100032701,"comment_content":"1. ipåè®®é‡Œé¢æœ‰ä¸€ä¸ªttlå­—æ®µï¼Œè¿™ä¸ªå­—æ®µçš„å€¼æ¯æ¬¡ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨å°±-1ï¼Œå‡åˆ°0å°±ä¸¢å¼ƒï¼Œè¿”å›ä¸€ä¸ªicmpæ¶ˆæ¯ï¼›<br>2 rttæ—¶é—´æ˜¯é€šè¿‡å›æ˜¾çš„æ–¹å¼ï¼Œå‘é€æ–¹æ”¶åˆ°ä»¥åï¼Œæ ¹æ®è‡ªå·±çš„æ—¶é—´è®¡ç®—çš„","like_count":0},{"had_liked":false,"id":173639,"user_name":"åˆ˜å¿½æ‚ ","can_delete":false,"product_type":"c1","uid":1252173,"ip_address":"","ucode":"095DE3A8D3F450","user_header":"https://static001.geekbang.org/account/avatar/00/13/1b/4d/2cc44d9a.jpg","comment_is_top":false,"comment_ctime":1579637681,"is_pvip":true,"replies":[{"id":"68040","content":"æœåŠ¡å™¨åœ¨LAST_ACKçŠ¶æ€ï¼Œå¦‚æœæ”¶åˆ°RSTï¼Œè‡ªç„¶è®¤ä¸ºè‡ªå·±æ˜¯ä¸€ä¸ª&quot;ç»ˆæ­¢&quot;çš„è¿æ¥ï¼Œå°†è‡ªå·±çš„çŠ¶æ€ç½®ä¸ºclosedå³å¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1580624243,"ip_address":"","comment_id":173639,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1579637681","product_id":100032701,"comment_content":"2mslä¸€å®šèƒ½ä¿è¯æœåŠ¡å™¨æ­£å¸¸å…³é—­å—ï¼Ÿ<br>å¦‚æœæœåŠ¡å™¨ä¸€ç›´æ”¶ä¸åˆ°æœ€åçš„ackå‘¢ï¼Ÿå‡å¦‚è¯´å½“æœåŠ¡å™¨å‘é€finä»¥åï¼Œå®¢æˆ·ç«¯ä¹Ÿæ”¶åˆ°äº†ï¼Œä½†æ˜¯å› ä¸ºç½‘ç»œçŠ¶æ€ä¸å¥½ï¼Œackä¼ ä¸è¿‡å»ï¼Œå¯¼è‡´å®¢æˆ·ç«¯2mslè®¡æ—¶å™¨åˆ°æ—¶äº†ï¼Œæ¥ç€å…³é—­äº†ï¼Œé‚£æœåŠ¡å™¨æ˜¯ä¸æ˜¯ä¸€ç›´å¤„åœ¨last_lackçŠ¶æ€ï¼ŒæœåŠ¡å™¨çš„rtoè®¡æ—¶å™¨ä¸åœè¶…æ—¶é‡ä¼ ï¼Œä¸€ç›´åˆ°å®¢æˆ·ç«¯æ”¶åˆ°finä»¥åï¼Œå‘ç°è‡ªå·±å·²ç»å…³é—­äº†ï¼Œå‘é€rstæŠ¥æ–‡ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ”¶åˆ°rstä»¥åå‡ºé”™å‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":482149,"discussion_content":"æœåŠ¡å™¨åœ¨LAST_ACKçŠ¶æ€ï¼Œå¦‚æœæ”¶åˆ°RSTï¼Œè‡ªç„¶è®¤ä¸ºè‡ªå·±æ˜¯ä¸€ä¸ª&amp;quot;ç»ˆæ­¢&amp;quot;çš„è¿æ¥ï¼Œå°†è‡ªå·±çš„çŠ¶æ€ç½®ä¸ºclosedå³å¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580624243,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159074,"user_name":"Geek_68d3d2","can_delete":false,"product_type":"c1","uid":1674369,"ip_address":"","ucode":"EBD6D881AA7A74","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqf54z1ZmqQY1kmJ6t1HAnrqMM3j6WKf0oDeVLhtnA2ZUKY6AX9MK6RjvcO8SiczXy3uU0IzBQ3tpw/132","comment_is_top":false,"comment_ctime":1575533312,"is_pvip":false,"replies":[{"id":"61027","content":"ä¸æ˜¯çš„ï¼Œæ—§è¿æ¥äº§çš„æŠ¥æ–‡æ¶ˆå¤±å’Œ2MSLç´§å¯†æœ‰å…³ï¼Œè¿™æ˜¯éœ€è¦è®©è¿æ¥æ¨è¿Ÿä¸€æ®µæ—¶é—´å…³é—­ï¼›è€ŒACKæ˜¯ä¸ºäº†ç»´æŠ¤è¿æ¥çš„çŠ¶æ€ï¼Œç›¸å½“äºä¿æŒäº†ä¸€ä¸ªè¿æ¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1575799231,"ip_address":"","comment_id":159074,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575533312","product_id":100032701,"comment_content":"æˆ‘æ€ä¹ˆæ„Ÿè§‰TIME_WAITçš„é‚£ä¸¤ä¸ªå¥½å¤„æ˜¯ä¸€æ ·çš„å•Šã€‚Aæ”¶åˆ°äº†FINå‘é€ä¸€ä¸ªACKï¼Œæ­¤æ—¶ç½‘ç»œä¸­ç”±æ—§æœ‰çš„é“¾æ¥äº§ç”Ÿçš„æŠ¥æ–‡å°±åªå‰©ä¸€ä¸ªACKäº†å§ï¼Œä¿è¯æœ€åä¸€ä¸ªACKèƒ½å¤Ÿåˆ°è¾¾å¯¹ç«¯å’Œä¿è¯æ—§æœ‰è¿æ¥äº§ç”Ÿçš„æŠ¥æ–‡å…¨éƒ¨æ¶ˆå¤±æ˜¯ä¸€å›äº‹å§ï¼Ÿï¼Ÿï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476939,"discussion_content":"ä¸æ˜¯çš„ï¼Œæ—§è¿æ¥äº§çš„æŠ¥æ–‡æ¶ˆå¤±å’Œ2MSLç´§å¯†æœ‰å…³ï¼Œè¿™æ˜¯éœ€è¦è®©è¿æ¥æ¨è¿Ÿä¸€æ®µæ—¶é—´å…³é—­ï¼›è€ŒACKæ˜¯ä¸ºäº†ç»´æŠ¤è¿æ¥çš„çŠ¶æ€ï¼Œç›¸å½“äºä¿æŒäº†ä¸€ä¸ªè¿æ¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575799231,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":159072,"user_name":"Geek_68d3d2","can_delete":false,"product_type":"c1","uid":1674369,"ip_address":"","ucode":"EBD6D881AA7A74","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqf54z1ZmqQY1kmJ6t1HAnrqMM3j6WKf0oDeVLhtnA2ZUKY6AX9MK6RjvcO8SiczXy3uU0IzBQ3tpw/132","comment_is_top":false,"comment_ctime":1575532346,"is_pvip":false,"replies":[{"id":"61028","content":"ä½ å¯ä»¥ç®€å•ç†è§£ä¸ºå°±æ˜¯2MSLï¼Œæ—¶é—´çº¦ä¸º60ç§’ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1575799257,"ip_address":"","comment_id":159072,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1575532346","product_id":100032701,"comment_content":"TIME_WAITå’Œ2MSLæ˜¯ä»€ä¹ˆå…³ç³»å•Šã€‚TIME_WAITçš„æ—¶é—´è¦ä¹ˆæ˜¯60ç§’è¦ä¹ˆæ˜¯2MSLå—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":476938,"discussion_content":"ä½ å¯ä»¥ç®€å•ç†è§£ä¸ºå°±æ˜¯2MSLï¼Œæ—¶é—´çº¦ä¸º60ç§’ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1575799257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":152614,"user_name":"wg1993","can_delete":false,"product_type":"c1","uid":1357623,"ip_address":"","ucode":"D5112FEFDB1DF7","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJmBKrLvqOIXDDbj3ocEIJzqsQx2e5VLDBSX6LmofYtprWwKaVAmHUqU2z3mjREHX8n9eLLiavlPg/132","comment_is_top":false,"comment_ctime":1574050554,"is_pvip":false,"replies":[{"id":"59325","content":"æ²¡æœ‰åå•Šï¼Œè¿™é‡Œæ˜¯è¯´ï¼Œå‡è®¾TTLä¸º60ç§’(è¿™ä¸ªæ˜¯ä¸€ä¸ªç†è®ºæœŸæœ›çš„å›ºå®šå€¼)ï¼Œé‚£ä¹ˆç”±äºç»å†äº†60æ¬¡è½¬å‘ï¼Œå¯¼è‡´MSLè‚¯å®šå¤§äº60ç§’ï¼Œæ‰€ä»¥MSL &gt;= TTLå¿…ç„¶æˆç«‹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1574497897,"ip_address":"","comment_id":152614,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1574050554","product_id":100032701,"comment_content":"MSL&gt;=TTLï¼Œå¦‚æœMSL=60sï¼ŒTTL=60ï¼Œè€å¸ˆåœ¨ä¸‹é¢è¯´æ˜¯æ¯æ¬¡è·¯ç”±å™¨è½¬å‘æ—¶é—´éƒ½å¤§äº1sï¼Œä¿è¯æ—¶é—´è‚¯å®šè¶…è¿‡60sã€‚ã€‚ã€‚ä¸ªäººæ„Ÿè§‰è¯´åäº†å§ï¼Œåº”è¯¥æ˜¯æ¯æ¬¡è½¬å‘æ—¶é—´éƒ½å°äº1sï¼Œä¿è¯å³ä¾¿ç»è¿‡60æ¬¡è½¬å‘æ—¶é—´ä¹Ÿè‚¯å®šå°äº60sã€‚ã€‚ã€‚è¿™ä¸ªåœ°æ–¹ä¸å¤ªç†è§£å•Š","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474876,"discussion_content":"æ²¡æœ‰åå•Šï¼Œè¿™é‡Œæ˜¯è¯´ï¼Œå‡è®¾TTLä¸º60ç§’(è¿™ä¸ªæ˜¯ä¸€ä¸ªç†è®ºæœŸæœ›çš„å›ºå®šå€¼)ï¼Œé‚£ä¹ˆç”±äºç»å†äº†60æ¬¡è½¬å‘ï¼Œå¯¼è‡´MSLè‚¯å®šå¤§äº60ç§’ï¼Œæ‰€ä»¥MSL &amp;gt;= TTLå¿…ç„¶æˆç«‹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574497897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148610,"user_name":"ç»¿ç®­ä¾ ","can_delete":false,"product_type":"c1","uid":1528536,"ip_address":"","ucode":"B994F558A98E29","user_header":"https://static001.geekbang.org/account/avatar/00/17/52/d8/123a4981.jpg","comment_is_top":false,"comment_ctime":1573038087,"is_pvip":false,"replies":[{"id":"57489","content":"æ˜¯çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1573283155,"ip_address":"","comment_id":148610,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1573038087","product_id":100032701,"comment_content":"2MSLï¼Œæ€»ç»“çš„è¯´ï¼Œå½“å‡ºç°ç½‘ç»œåŒ…è¿·èµ°ï¼Œåˆšå¥½å½“ackåˆ°è¾¾å¯¹ç«¯ç¬é—´ï¼Œå¯¹ç«¯å‘å‡ºå¦ä¸€ä¸ªfinåŒ…ï¼Œè¿™æ ·ä¸»åŠ¨å…³é—­æ–¹åœ¨ç½‘ç»œåŒ…æœ€å¤§å­˜æ´»æ—¶é—´å†…æ¥æ”¶åˆ°å®ƒå¹¶å‘å‡ºå¦ä¸€ä¸ªackï¼Œå†é‡æ–°è®¡æ—¶ï¼Œç›´åˆ°å¯¹ç«¯æ­£å¸¸å…³é—­ï¼Ÿï¼ï¼","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":473553,"discussion_content":"æ˜¯çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573283155,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":144625,"user_name":"helloworld2018","can_delete":false,"product_type":"c1","uid":1210386,"ip_address":"","ucode":"2AE40C0DF5A9F7","user_header":"https://static001.geekbang.org/account/avatar/00/12/78/12/7df38a54.jpg","comment_is_top":false,"comment_ctime":1571984715,"is_pvip":false,"replies":[{"id":"55809","content":"ä½ çš„é—®é¢˜æ˜¯å¦‚æœå¤ç”¨äº†è¿™ä¸ªç«¯å£ï¼Œä½†æ˜¯ACKæ²¡æœ‰å‘å‡ºå»æ˜¯ä¹ˆï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘è§‰å¾—æ˜¯ç³»ç»Ÿä¼šä¸æ–­çš„é‡è¯•çš„ï¼Œç›´åˆ°è¿™ä¸ªACKå‘å‡ºå»ä¸ºæ­¢ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1572057443,"ip_address":"","comment_id":144625,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571984715","product_id":100032701,"comment_content":"è€å¸ˆä½ å¥½ï¼Œæœ‰ä¸ªé—®é¢˜éœ€è¦æ‚¨å¸®å¿™è§£ç­”ä¸€ä¸‹ï¼Œ<br>è®¾ç½®äº†tcp_tw_reuseä¹‹åï¼Œå¦‚æœè¢«åŠ¨å…³é—­çš„ä¸€æ–¹ç¡®å®æ²¡æœ‰æ”¶åˆ°ackï¼Œè¿™ç§æƒ…å†µä¸‹TIME_WAITçŠ¶æ€çš„ç«¯å£æ˜¯ä¸èƒ½è¢«å¤ç”¨çš„ï¼Œè¿™ç§æƒ…å†µç³»ç»Ÿæ˜¯å¦‚ä½•åˆ¤æ–­çš„ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":472038,"discussion_content":"ä½ çš„é—®é¢˜æ˜¯å¦‚æœå¤ç”¨äº†è¿™ä¸ªç«¯å£ï¼Œä½†æ˜¯ACKæ²¡æœ‰å‘å‡ºå»æ˜¯ä¹ˆï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œæˆ‘è§‰å¾—æ˜¯ç³»ç»Ÿä¼šä¸æ–­çš„é‡è¯•çš„ï¼Œç›´åˆ°è¿™ä¸ªACKå‘å‡ºå»ä¸ºæ­¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1572057443,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":141789,"user_name":"ç»¿ç®­ä¾ ","can_delete":false,"product_type":"c1","uid":1528536,"ip_address":"","ucode":"B994F558A98E29","user_header":"https://static001.geekbang.org/account/avatar/00/17/52/d8/123a4981.jpg","comment_is_top":false,"comment_ctime":1571224939,"is_pvip":false,"replies":[{"id":"55111","content":"æ˜¯è¯´å¼ºè¡Œå…³é—­TIME_WAITçš„è¿æ¥ï¼Œç›´æ¥è·³è¿‡TCPå››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹ï¼Œè¿™ä¼šå¯¼è‡´è¿æ¥å…³é—­çš„æ­£å¸¸æ¸…ç†å·¥ä½œä¸èƒ½æœ‰æ•ˆçš„æ‰§è¡Œï¼ŒåŒæ—¶ä¹Ÿä¸èƒ½ä½¿ç”¨TIME_WAITå¸¦æ¥çš„2MSLæ•°æ®åŒ…è‡ªåŠ¨æ¶ˆäº¡çš„ç‰¹æ€§ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1571455683,"ip_address":"","comment_id":141789,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1571224939","product_id":100032701,"comment_content":"ç¬¬äºŒç§å¯èƒ½ä¸ºè·¨è¶Š TIME_WAIT çŠ¶æ€æä¾›äº†ä¸€ä¸ªå¯èƒ½ï¼Œä¸è¿‡æ˜¯ä¸€ä¸ªéå¸¸å±é™©çš„è¡Œä¸ºï¼Œä¸å€¼å¾—æå€¡ã€‚     è¿™å¥è¯æ²¡ç†è§£ï¼Œå±é™©çš„è¡Œä¸ºæ€ä¹ˆè§£é‡Šï¼Ÿï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470889,"discussion_content":"æ˜¯è¯´å¼ºè¡Œå…³é—­TIME_WAITçš„è¿æ¥ï¼Œç›´æ¥è·³è¿‡TCPå››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹ï¼Œè¿™ä¼šå¯¼è‡´è¿æ¥å…³é—­çš„æ­£å¸¸æ¸…ç†å·¥ä½œä¸èƒ½æœ‰æ•ˆçš„æ‰§è¡Œï¼ŒåŒæ—¶ä¹Ÿä¸èƒ½ä½¿ç”¨TIME_WAITå¸¦æ¥çš„2MSLæ•°æ®åŒ…è‡ªåŠ¨æ¶ˆäº¡çš„ç‰¹æ€§ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571455683,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":140108,"user_name":"é…¸è‘¡è„","can_delete":false,"product_type":"c1","uid":1154146,"ip_address":"","ucode":"9D059C4FB327C0","user_header":"https://static001.geekbang.org/account/avatar/00/11/9c/62/f625b2bb.jpg","comment_is_top":false,"comment_ctime":1570810226,"is_pvip":false,"replies":[{"id":"55073","content":"ä¼šå•Šï¼Œè¿™ä¸ªè¿‡ç¨‹å°±è¿™æ ·ä¸€ç›´è¿›è¡Œä¸‹å»ï¼Œç›´åˆ°ä¸»æœº1æ”¶åˆ°ä¸»æœº2çš„FINåŒ…ã€‚åœ¨å…·ä½“æƒ…å†µä¸‹ï¼Œè¿™ç§æƒ…å†µåº”è¯¥æ˜¯å¾ˆå°‘è§çš„ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1571451340,"ip_address":"","comment_id":140108,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570810226","product_id":100032701,"comment_content":"â€œåˆ’é‡ç‚¹ï¼Œ2MSL çš„æ—¶é—´æ˜¯ä»ä¸»æœº 1 æ¥æ”¶åˆ° FIN åå‘é€ ACK å¼€å§‹è®¡æ—¶çš„ï¼›å¦‚æœåœ¨ TIME_WAIT æ—¶é—´å†…ï¼Œå› ä¸ºä¸»æœº 1 çš„ ACK æ²¡æœ‰ä¼ è¾“åˆ°ä¸»æœº 2ï¼Œä¸»æœº 1 åˆæ¥æ”¶åˆ°äº†ä¸»æœº 2 é‡å‘çš„ FIN æŠ¥æ–‡ï¼Œé‚£ä¹ˆ 2MSL æ—¶é—´å°†é‡<br>æ–°è®¡æ—¶ã€‚é“ç†å¾ˆç®€å•ï¼Œå› ä¸º 2MSL çš„æ—¶é—´ï¼Œç›®çš„æ˜¯ä¸ºäº†è®©æ—§è¿æ¥çš„æ‰€æœ‰æŠ¥æ–‡éƒ½èƒ½è‡ªç„¶æ¶ˆäº¡ï¼Œç°åœ¨ä¸»æœº 1<br>é‡æ–°å‘é€äº† ACK æŠ¥æ–‡ï¼Œâ€ è€å¸ˆæ‚¨å¥½ï¼Œè¯·æ•™ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹ä¸Šé¢çš„è¿™æ®µè¯æœ‰ä¸ªç–‘é—®ï¼Œå¦‚æœä¸»æœº1æœ€åçš„ACKç”±äºæŸç§åŸå› ä¸€ç›´æ²¡æœ‰ä¼ åˆ°ä¸»æœº2ï¼Œä¸»æœº2ä¸å°±ä¼šåå¤å‘ä¸»æœº1å‘FINï¼Œç„¶åä¸»æœº1åå¤å‘ACKï¼Œåå¤é‡æ–°åŠæ—¶2MSLï¼Œä¼šè¿™æ ·å—ï¼Ÿåº”è¯¥æ˜¯ä¸ä¼šçš„å§ï¼Œé‚£è¿™ç§æƒ…å†µæ˜¯æ€ä¹ˆå¤„ç†çš„å‘¢ï¼Œæ˜¯ä¸»æœº2å¤šæ¬¡æ”¶ä¸åˆ°ä¸»æœº1çš„ACKå°±è‡ªåŠ¨ç»“æŸäº†å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":470248,"discussion_content":"ä¼šå•Šï¼Œè¿™ä¸ªè¿‡ç¨‹å°±è¿™æ ·ä¸€ç›´è¿›è¡Œä¸‹å»ï¼Œç›´åˆ°ä¸»æœº1æ”¶åˆ°ä¸»æœº2çš„FINåŒ…ã€‚åœ¨å…·ä½“æƒ…å†µä¸‹ï¼Œè¿™ç§æƒ…å†µåº”è¯¥æ˜¯å¾ˆå°‘è§çš„ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571451340,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138507,"user_name":"é…¸è‘¡è„","can_delete":false,"product_type":"c1","uid":1154146,"ip_address":"","ucode":"9D059C4FB327C0","user_header":"https://static001.geekbang.org/account/avatar/00/11/9c/62/f625b2bb.jpg","comment_is_top":false,"comment_ctime":1570284886,"is_pvip":false,"replies":[{"id":"54308","content":"TIME_WAITæ˜¯ä¸€ä¸ªçŠ¶æ€ï¼Œæ²¡æœ‰æŠ¥æ–‡æ¶ˆæ¯çš„ï¼›<br><br>æ ¹æ®ç¨‹åºä»£ç ï¼Œåªæœ‰æ”¶åˆ°ACKæ—¶æ‰ä¼šcloseï¼Œè¯´æ˜è‚¯å®šæ˜¯æ”¶åˆ°äº†ACKæŠ¥æ–‡çš„ã€‚å¦åˆ™ä¸€ç›´åœ¨ç­‰å¾…å®¢æˆ·ç«¯æŠ¥æ–‡ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1570971654,"ip_address":"","comment_id":138507,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570284886","product_id":100032701,"comment_content":"è°ƒäº†ä¸‹ç¬¬11è®²é‚£ä¸ªdemoï¼Œclientç”¨shutdownä¸»åŠ¨å…³é—­è¿æ¥æ—¶ï¼Œç»“åˆç¬¬10è®²åº”è¯¥è¿›å…¥TIME_WAITçŠ¶æ€ï¼Œç„¶åserveræ”¶åˆ°clientæœ€åå‘å‡ºçš„FIN ACKåè¿›å…¥closedçŠ¶æ€ï¼Œæœ‰ä¸¤ä¸ªé—®é¢˜ä¸æ˜¯å¾ˆæ˜ç™½ï¼š<br>ç¬¬ä¸€ï¼šæˆ‘ç”¨wiresharkæŠ“åŒ…å¥½åƒæ²¡æœ‰æ‰¾åˆ°TIME_WAITç›¸å…³çš„æŠ¥æ–‡ï¼Œè¿™ä¸ªTIME_WAITåœ¨æŠ“åŒ…ä¸­æœ‰ä½“ç°å—ï¼Ÿ<br>è€Œä¸”clientç«‹åˆ»å°±é€€å‡ºäº†ï¼ŒTIME_WAITçŠ¶æ€æ˜¯ä¸€ç›´åœ¨çš„å—ï¼Ÿï¼ˆclientç«‹å³é€€å‡ºåçš„2MSLæ—¶é—´å†…ï¼‰ï¼Œæˆ‘è‡ªå·±çš„ç†è§£æ˜¯clientç«‹å³é€€å‡ºæ˜¯åº”ç”¨å±‚çš„äº‹ï¼ŒTCPå†…éƒ¨çš„åè®®å±‚ï¼Œå®é™…ä¸Šè¿˜å¤„åœ¨TIME_WAITçŠ¶æ€ï¼Œæˆ‘ç†è§£çš„å¯¹å—ï¼Ÿ<br>ç¬¬äºŒï¼šserverç¨‹åºæœ€ç»ˆæˆåŠŸé€€å‡ºäº†ï¼Œé€€å‡ºæˆåŠŸæ˜¯ä¸æ˜¯å°±è¯´æ˜æ”¶åˆ°äº†client(ä¸»åŠ¨å…³é—­çš„ä¸€æ–¹)å‘æ¥çš„ACKï¼Œæ¢å¥è¯è¯´å¦‚æœclientæœ€åå‘å‡ºçš„ ACKæ²¡æœ‰è¢«serveræ”¶åˆ°ï¼Œserveræ˜¯ä¸æ˜¯å°±ä¸ä¼šé€€å‡ºå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469548,"discussion_content":"TIME_WAITæ˜¯ä¸€ä¸ªçŠ¶æ€ï¼Œæ²¡æœ‰æŠ¥æ–‡æ¶ˆæ¯çš„ï¼›\n\næ ¹æ®ç¨‹åºä»£ç ï¼Œåªæœ‰æ”¶åˆ°ACKæ—¶æ‰ä¼šcloseï¼Œè¯´æ˜è‚¯å®šæ˜¯æ”¶åˆ°äº†ACKæŠ¥æ–‡çš„ã€‚å¦åˆ™ä¸€ç›´åœ¨ç­‰å¾…å®¢æˆ·ç«¯æŠ¥æ–‡ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570971654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":138505,"user_name":"é…¸è‘¡è„","can_delete":false,"product_type":"c1","uid":1154146,"ip_address":"","ucode":"9D059C4FB327C0","user_header":"https://static001.geekbang.org/account/avatar/00/11/9c/62/f625b2bb.jpg","comment_is_top":false,"comment_ctime":1570284105,"is_pvip":false,"replies":[{"id":"54307","content":"ä¸€èˆ¬ä¸éœ€è¦ï¼Œå½“ç„¶ä½ æ˜¯å¯ä»¥è¿™ä¹ˆå¹²çš„ï¼Œè°ƒç”¨bindå‡½æ•°å°±å¯ä»¥ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1570971440,"ip_address":"","comment_id":138505,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1570284105","product_id":100032701,"comment_content":"è€å¸ˆé—®ä¸ªé—®é¢˜ï¼Œclient connect serveræ—¶éœ€è¦æŒ‡å®šserver çš„ç«¯å£ï¼Œclientçš„ç«¯å£åº”è¯¥æ˜¯ç³»ç»Ÿéšæœºåˆ†é…çš„ï¼Œclientèƒ½æŒ‡å®šç”¨å“ªä¸ªç«¯å£å—ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":469547,"discussion_content":"ä¸€èˆ¬ä¸éœ€è¦ï¼Œå½“ç„¶ä½ æ˜¯å¯ä»¥è¿™ä¹ˆå¹²çš„ï¼Œè°ƒç”¨bindå‡½æ•°å°±å¯ä»¥ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570971440,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129157,"user_name":"suke","can_delete":false,"product_type":"c1","uid":1007753,"ip_address":"","ucode":"C0287C31A4F45B","user_header":"","comment_is_top":false,"comment_ctime":1567051720,"is_pvip":false,"replies":[{"id":"48199","content":"æ˜¯ä¸æ˜¯ç¬¬äºŒæ¬¡å‘é€çš„æŠ¥æ–‡æ—¢æ˜¯å¯¹ç¬¬ä¸€æ¬¡å¯¹æ–¹FINæŠ¥æ–‡çš„ACKï¼Œä¹Ÿæ˜¯è‡ªå·±å‘é€çš„FINæŠ¥æ–‡ï¼Œè¿™æ ·å°±å‡å°‘äº†ä¸€æ¬¡æ•°æ®ä¼ è¾“ã€‚<br><br>å¯ä»¥è®¤ä¸ºè¿™ä¸ªæ˜¯ä¸€ä¸ªå‡å°‘æ•°æ®å‘é€çš„ä¼˜åŒ–ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567131233,"ip_address":"","comment_id":129157,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1567051720","product_id":100032701,"comment_content":"è€å¸ˆ æˆ‘å®é™…ç”¨wiresharkæŠ“åŒ…çœ‹äº†ä¸€ä¸‹ æŒ¥æ‰‹è¿‡ç¨‹åªæœ‰ä¸‰æ¬¡ï¼Œ[fin,ack],[fin,ack],[ack]å°±è¿™ä¸‰æ¬¡ï¼Œå®éªŒäº†å¥½å¤šæ¬¡ï¼Œè¯·é—®è€å¸ˆè¿™æ˜¯ä¸ºä»€ä¹ˆ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465310,"discussion_content":"æ˜¯ä¸æ˜¯ç¬¬äºŒæ¬¡å‘é€çš„æŠ¥æ–‡æ—¢æ˜¯å¯¹ç¬¬ä¸€æ¬¡å¯¹æ–¹FINæŠ¥æ–‡çš„ACKï¼Œä¹Ÿæ˜¯è‡ªå·±å‘é€çš„FINæŠ¥æ–‡ï¼Œè¿™æ ·å°±å‡å°‘äº†ä¸€æ¬¡æ•°æ®ä¼ è¾“ã€‚\n\nå¯ä»¥è®¤ä¸ºè¿™ä¸ªæ˜¯ä¸€ä¸ªå‡å°‘æ•°æ®å‘é€çš„ä¼˜åŒ–ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567131233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1336951,"avatar":"https://static001.geekbang.org/account/avatar/00/14/66/77/194ba21d.jpg","nickname":"lzh","note":"","ucode":"C3D83DF4230109","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":351700,"discussion_content":"è¢«å…³é—­æ–¹æ²¡æœ‰æ­£åœ¨å›ä¼ çš„æ•°æ®åŒ…ï¼Œæ‰€ä»¥åˆå¹¶äº†fin,ackåˆå¹¶äº†CLOSE_WAIT","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614406779,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1007753,"avatar":"","nickname":"suke","note":"","ucode":"C0287C31A4F45B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6911,"discussion_content":"æ˜¯çš„ ï¼Œæ‰€ä»¥æ˜¯å› ä¸ºæ²¡æœ‰è¦å‘é€çš„æ•°æ® æ‰€ä»¥ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡æŒ¥æ‰‹åˆå¹¶å‘é€ ï¼Œä¼˜åŒ–äº†ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567171332,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129093,"user_name":"èƒ¡æ³¢ allenhu","can_delete":false,"product_type":"c1","uid":1014526,"ip_address":"","ucode":"33C6217E9A385C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/fe/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1567041663,"is_pvip":false,"replies":[{"id":"48200","content":"å¥½é—®é¢˜ï¼Œæˆ‘ä¸ªäººç†è§£è¿™æ˜¯ä¸€ä¸ªè½¬æ€é©±åŠ¨çš„ï¼Œå¦‚æœä»FIN_WAIT_1æˆ–FIN_WAIT_2åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ä¹‹é—´çš„è½¬æ¢ç¼ºå°‘å¿…è¦çš„æ¡ä»¶ï¼Œä¼šåœç•™åœ¨è¿™ä¸ªçŠ¶æ€ï¼Œæœ‰å°±æ˜¯è¯´ä¸ä¼šå¾€ä¸‹ä¸€ä¸ªçŠ¶æ€è½¬æ¢ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567131567,"ip_address":"","comment_id":129093,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567041663","product_id":100032701,"comment_content":"è€å¸ˆï¼Œè¯·é—®å¦‚æœæœ¬æ–¹è°ƒç”¨closeåå‘é€FINï¼Œå¯¹æ–¹æ²¡æœ‰å›ACK,æˆ–è€…å›äº†ACK, ä½†æ˜¯å¯¹æ–¹æ²¡æœ‰å›FIN, è¿™ä¸ªæ—¶å€™æœ¬æ–¹çš„SOCKETä¼šä¸€ç›´æ˜¯FIN_WAIT_1æˆ–FIN_WAIT_2çŠ¶æ€å—ï¼Ÿä¼šä¸ä¼šåˆ°TIME_WAITçŠ¶æ€","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465271,"discussion_content":"å¥½é—®é¢˜ï¼Œæˆ‘ä¸ªäººç†è§£è¿™æ˜¯ä¸€ä¸ªè½¬æ€é©±åŠ¨çš„ï¼Œå¦‚æœä»FIN_WAIT_1æˆ–FIN_WAIT_2åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€ä¹‹é—´çš„è½¬æ¢ç¼ºå°‘å¿…è¦çš„æ¡ä»¶ï¼Œä¼šåœç•™åœ¨è¿™ä¸ªçŠ¶æ€ï¼Œæœ‰å°±æ˜¯è¯´ä¸ä¼šå¾€ä¸‹ä¸€ä¸ªçŠ¶æ€è½¬æ¢ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567131567,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":129087,"user_name":"èƒ¡æ³¢ allenhu","can_delete":false,"product_type":"c1","uid":1014526,"ip_address":"","ucode":"33C6217E9A385C","user_header":"https://static001.geekbang.org/account/avatar/00/0f/7a/fe/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1567040576,"is_pvip":false,"replies":[{"id":"48203","content":"æˆ‘è§‰å¾—æ˜¯ç›´æ¥è¿›å…¥CLOSEDçŠ¶æ€äº†ï¼Œä¸ä¼šå†ç­‰å¾…ï¼Œè¿™ä¸ªå‡½æ•°çš„æ„æ€å°±æ˜¯&quot;å¼ºè¡Œå…³é—­&quot;ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567131760,"ip_address":"","comment_id":129087,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1567040576","product_id":100032701,"comment_content":"è€å¸ˆä½ å¥½ï¼Œ è¯·é—®æ˜¯ä¸æ˜¯è®¾ç½®äº†l_lingeråï¼Œ æœ¬æ–¹è°ƒç”¨close&#47;shutdwon å…³é—­socketã€‚å¦‚æœæœ¬æ–¹æ”¶åˆ°äº†å¯¹æ–¹çš„FIN, è¿˜æ˜¯ä¼šç­‰å¾…2MSLæ‰è¿›å…¥CLOSEDçŠ¶æ€ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465268,"discussion_content":"æˆ‘è§‰å¾—æ˜¯ç›´æ¥è¿›å…¥CLOSEDçŠ¶æ€äº†ï¼Œä¸ä¼šå†ç­‰å¾…ï¼Œè¿™ä¸ªå‡½æ•°çš„æ„æ€å°±æ˜¯&amp;quot;å¼ºè¡Œå…³é—­&amp;quot;ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567131760,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128836,"user_name":"humor","can_delete":false,"product_type":"c1","uid":1181867,"ip_address":"","ucode":"9B48C4C7BEC92C","user_header":"https://static001.geekbang.org/account/avatar/00/12/08/ab/caec7bca.jpg","comment_is_top":false,"comment_ctime":1566971652,"is_pvip":false,"replies":[{"id":"47914","content":"æ…¢æ…¢å†™å†™ä»£ç ï¼Œè°ƒè¯•èµ·æ¥å°±ä¼šæ‡‚çš„","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567004493,"ip_address":"","comment_id":128836,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566971652","product_id":100032701,"comment_content":"æ„Ÿè§‰çœ‹æ–‡ç« å¯ä»¥çœ‹æ‡‚ï¼Œå¯æ˜¯çœŸæ­£ç”¨çš„æ—¶å€™è¿˜æ˜¯ä¸å¤ªä¼šç”¨çš„æ„Ÿè§‰â€¦","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":465127,"discussion_content":"æ…¢æ…¢å†™å†™ä»£ç ï¼Œè°ƒè¯•èµ·æ¥å°±ä¼šæ‡‚çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567004493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":128104,"user_name":"æ²‰æ·€çš„æ¢¦æƒ³","can_delete":false,"product_type":"c1","uid":1177315,"ip_address":"","ucode":"BCB7C26F9D214B","user_header":"https://static001.geekbang.org/account/avatar/00/11/f6/e3/e4bcd69e.jpg","comment_is_top":false,"comment_ctime":1566831410,"is_pvip":false,"replies":[{"id":"47928","content":"è¿™ä¸ªåªèƒ½æŸ¥å¤´æ–‡ä»¶å§","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567005329,"ip_address":"","comment_id":128104,"utype":1}],"discussion_count":3,"race_medal":0,"score":"1566831410","product_id":100032701,"comment_content":"è¯·é—®ä¸€ä¸‹åƒSO_LINGER, SO_REUSEADDRè¿™äº›SOå¼€å¤´çš„TCPé€‰é¡¹çš„æ–‡æ¡£åœ¨linuxçš„å“ªä¸ªman pageä¸­å‘¢ï¼Ÿæˆ‘å°è¯•äº†ä¸‹man tcp  å¥½åƒé‡Œé¢å¹¶æ²¡æœ‰å®Œæ•´çš„SOå¼€å¤´çš„é€‰é¡¹æ–‡æ¡£","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464797,"discussion_content":"è¿™ä¸ªåªèƒ½æŸ¥å¤´æ–‡ä»¶å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567005329,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1032125,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/bf/bd/0c40979f.jpg","nickname":"ä¸€å‘¨æ€è¿›","note":"","ucode":"00BE5402479B16","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7062,"discussion_content":"https://mp.weixin.qq.com/s/bNdfXNQcZ3z_WzDWL5yQfA\nå¯ä»¥çœ‹çœ‹  é‡Œé¢åˆšå¥½æœ‰è¯´åˆ°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567330410,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1177315,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f6/e3/e4bcd69e.jpg","nickname":"æ²‰æ·€çš„æ¢¦æƒ³","note":"","ucode":"BCB7C26F9D214B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7039,"discussion_content":"æˆ‘å°è¯•çœ‹äº†ä¸€ä¸‹é€‰é¡¹æ‰€åœ¨çš„é‚£ä¸ªå¤´æ–‡ä»¶ï¼Œåªæœ‰é€‰é¡¹çš„å®šä¹‰ï¼Œå¥½åƒæ²¡æœ‰æ–‡æ¡£å•Šï¼Œé€‰é¡¹ä¸Šä¹Ÿæ²¡æœ‰å…¶å«ä¹‰æ³¨é‡Š","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567313777,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127362,"user_name":"_ä½ è¯´äº†ä¸ç®—","can_delete":false,"product_type":"c1","uid":1185159,"ip_address":"","ucode":"212F890565FE5C","user_header":"https://static001.geekbang.org/account/avatar/00/12/15/87/d22d8c3e.jpg","comment_is_top":false,"comment_ctime":1566664984,"is_pvip":false,"replies":[{"id":"48205","content":"ä¸€ä¸ªtcpè¿æ¥æ˜¯ä¸€ä¸ªå››å…ƒç»„&lt;clientIP, clientPort, serverIP, serverPort&gt;ã€‚æ­£å¸¸æˆ‘ä»¬å‘èµ·å¯¹æœåŠ¡ç«¯çš„è¿æ¥ï¼Œåªæ˜¯å‘Šè¯‰äº†ç¨‹åºserverIPå’ŒserverPortï¼Œè€ŒcientIPå’Œ clientPortä¼šæ ¹æ®æˆ‘ä»¬åˆ›å»ºsocketæ—¶ï¼Œç³»ç»Ÿå†…æ ¸è‡ªåŠ¨çš„é€‰æ‹©ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567131938,"ip_address":"","comment_id":127362,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1566664984","product_id":100032701,"comment_content":"è€å¸ˆå¯ä»¥è§£é‡Šä¸‹ ä¸€ä¸ªtcpè¿æ¥å¯¹åº”ä¸€ä¸ªç«¯å£çš„è¿™å¥è¯å—ï¼Ÿä¸å¤ªæ‡‚ æ­£å¸¸æˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªwebåº”ç”¨ å¯åŠ¨ç»“æŸç«¯å£å°±å·²ç»å®šå¥½äº†  ä¸åŒå®¢æˆ·ç«¯å‘èµ·è®¿é—®è®¿é—®åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªç«¯å£å·","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464457,"discussion_content":"ä¸€ä¸ªtcpè¿æ¥æ˜¯ä¸€ä¸ªå››å…ƒç»„&amp;lt;clientIP, clientPort, serverIP, serverPort&amp;gt;ã€‚æ­£å¸¸æˆ‘ä»¬å‘èµ·å¯¹æœåŠ¡ç«¯çš„è¿æ¥ï¼Œåªæ˜¯å‘Šè¯‰äº†ç¨‹åºserverIPå’ŒserverPortï¼Œè€ŒcientIPå’Œ clientPortä¼šæ ¹æ®æˆ‘ä»¬åˆ›å»ºsocketæ—¶ï¼Œç³»ç»Ÿå†…æ ¸è‡ªåŠ¨çš„é€‰æ‹©ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567131938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1145650,"avatar":"https://static001.geekbang.org/account/avatar/00/11/7b/32/60089a62.jpg","nickname":"æ¨é¢†well","note":"","ucode":"3974A03855168C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":6164,"discussion_content":"é‚£æ˜¯ç›‘å¬ç«¯å£ï¼Œä¸æ˜¯è¿æ¥ç«¯å£ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1566736021,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":127241,"user_name":"Liam","can_delete":false,"product_type":"c1","uid":1094597,"ip_address":"","ucode":"1D15D3B64F2606","user_header":"https://static001.geekbang.org/account/avatar/00/10/b3/c5/7fc124e2.jpg","comment_is_top":false,"comment_ctime":1566618516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566618516","product_id":100032701,"comment_content":"å¯¹äºé—®é¢˜2ï¼Œæˆ‘è§‰å¾—ä¸éœ€è¦ç»Ÿä¸€æ—¶é’Ÿï¼Œå› ä¸ºtimestampçš„ä½œç”¨æ˜¯ç»™æŸç«¯åŒºåˆ†æ–°æ—§è¿æ¥æ•°æ®ï¼Œç”±ç«¯æŸç”Ÿæˆå¹¶ç”±è¯¥ç«¯è¿›è¡Œåˆ¤æ–­ï¼Œä¸ä¼šæ¶‰åŠåŒæ–¹çš„æ—¶é’Ÿé—®é¢˜ã€‚å¯¹time_wait socketé‡ç”¨åï¼Œç›¸å½“äºåˆ›å»ºäº†ä¸€æ¡æ–°çš„è¿æ¥ï¼Œè¿™æ—¶å€™ä¼šè®¾ç½®ä¸€ä¸ªæ–°çš„timestampï¼Œæ‹¿åˆ°æ•°æ®å®åå¦‚æœæ—¶é—´&lt; æ–°è¿æ¥æ—¶é—´ï¼Œåˆ™è®¤ä¸ºæ˜¯æ—§è¿æ¥ï¼Œä¸å¤„ç†å³å¯ã€‚","like_count":0},{"had_liked":false,"id":127092,"user_name":"ä¼ è¯´ä¸­çš„æˆå¤§å¤§","can_delete":false,"product_type":"c1","uid":1236766,"ip_address":"","ucode":"103543D6E706BF","user_header":"https://static001.geekbang.org/account/avatar/00/12/df/1e/cea897e8.jpg","comment_is_top":false,"comment_ctime":1566552395,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566552395","product_id":100032701,"comment_content":"ç¬¬ä¸€é—® æ˜¯å› ä¸ºç½‘ç»œä¸Šçš„åŒ…åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¿‡äº†æœ€å¤§ç”Ÿå­˜æ—¶é—´åˆ™å°†ä¼šè¢«ä¸¢å¼ƒï¼Œtcp&#47;ipçš„ä¸€ä¸ªå¤„ç†æœºåˆ¶<br>ç¬¬äºŒé—® éœ€è¦å®šä¹‰ä¸€ä¸ªç»Ÿä¸€çš„æ—¶é’Ÿ ä¸ç„¶å¦‚æœå‘é€åŒæ–¹çš„æ—¶é—´ä¸ä¸€æ ·çš„è¯ é€šè¿‡æ—¶é—´æˆ³è¿™ä¸ªå¤„ç†æ–¹å¼å°±ä¼šå‡ºé—®é¢˜","like_count":0},{"had_liked":false,"id":127047,"user_name":"D","can_delete":false,"product_type":"c1","uid":1027596,"ip_address":"","ucode":"5BB4D16FE39BFF","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ae/0c/f39f847a.jpg","comment_is_top":false,"comment_ctime":1566543667,"is_pvip":false,"replies":[{"id":"48212","content":"MSLç¡®å®æ˜¯30ç§’ï¼Œä½ çš„æ¨æ–­å¯¹çš„ï¼›<br><br>åŒ–èº«æ˜¯ä¸€ä¸ªä¸­æ–‡æ¯”å–»ï¼Œæ„æ€å°±æ˜¯è·Ÿå‰é¢çš„å››å…ƒç»„å®Œå…¨ä¸€æ ·ï¼Œå°±åƒå˜äº†ä¸€ä¸ªæ–°çš„äººï¼Œå®Œå…¨é•¿å¾—ä¸€æ¨¡ä¸€æ ·ã€‚åˆ†èŠ‚åº”è¯¥æ˜¯TCP segmantã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567132594,"ip_address":"","comment_id":127047,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566543667","product_id":100032701,"comment_content":"è€å¸ˆï¼Œå¦‚æœtime_wait é»˜è®¤æ˜¯60s çš„è¯ï¼Œ é‚£2msl =time_wait,é‚£mslæ˜¯å¦æ˜¯30s? è¿˜æœ‰åŒ–èº«å’Œåˆ†èŠ‚å¯¹åº”åˆ°è‹±æ–‡ä¸­çš„ä»€ä¹ˆå•è¯ï¼Œåœ¨è¿™é‡Œä¸å¤ªæ¸…æ¥šæ˜¯ä»€ä¹ˆæ„æ€","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464293,"discussion_content":"MSLç¡®å®æ˜¯30ç§’ï¼Œä½ çš„æ¨æ–­å¯¹çš„ï¼›\n\nåŒ–èº«æ˜¯ä¸€ä¸ªä¸­æ–‡æ¯”å–»ï¼Œæ„æ€å°±æ˜¯è·Ÿå‰é¢çš„å››å…ƒç»„å®Œå…¨ä¸€æ ·ï¼Œå°±åƒå˜äº†ä¸€ä¸ªæ–°çš„äººï¼Œå®Œå…¨é•¿å¾—ä¸€æ¨¡ä¸€æ ·ã€‚åˆ†èŠ‚åº”è¯¥æ˜¯TCP segmantã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567132594,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126994,"user_name":"åœ¨è·¯ä¸Š","can_delete":false,"product_type":"c1","uid":1619588,"ip_address":"","ucode":"C11D567FCB8CD6","user_header":"https://static001.geekbang.org/account/avatar/00/18/b6/84/1f60f267.jpg","comment_is_top":false,"comment_ctime":1566531384,"is_pvip":false,"replies":[{"id":"48213","content":"è¿™æ˜¯å¾ˆæš´åŠ›çš„æ–¹æ³•ï¼Œå¦‚æœæœ‰æŠŠæ¡å¯ä»¥ä½¿ç”¨ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567132645,"ip_address":"","comment_id":126994,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1566531384","product_id":100032701,"comment_content":"æˆ‘çœ‹åˆ°çš„ç­”æ¡ˆè®¾ç½®æ–¹æ³•éƒ½æ˜¯setsockopt<br>","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464274,"discussion_content":"è¿™æ˜¯å¾ˆæš´åŠ›çš„æ–¹æ³•ï¼Œå¦‚æœæœ‰æŠŠæ¡å¯ä»¥ä½¿ç”¨ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567132645,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126987,"user_name":"è®¸ç«¥ç«¥","can_delete":false,"product_type":"c1","uid":1003005,"ip_address":"","ucode":"4B799C0C6BC678","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4d/fd/0aa0e39f.jpg","comment_is_top":false,"comment_ctime":1566530640,"is_pvip":false,"replies":[{"id":"48214","content":"è°å…ˆå‘èµ·æ–­è¿çš„æ“ä½œï¼Œè°å°±æ˜¯ä¸»åŠ¨å…³é—­æ–¹ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"froghui","uid":"1618647","ctime":1567132675,"ip_address":"","comment_id":126987,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1566530640","product_id":100032701,"comment_content":"è€å¸ˆä½ å¥½ï¼ŒTIME_WAIT æ˜¯TCPä¸»åŠ¨å…³é—­æ–¹æ‰ä¼šå­˜åœ¨çš„çŠ¶æ€ï¼Œä»€ä¹ˆæœºåˆ¶ç¡®è®¤è°æ˜¯ä¸»åŠ¨å…³é—­æ–¹ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1618647,"avatar":"https://static001.geekbang.org/account/avatar/00/18/b2/d7/df4086cf.jpg","nickname":"froghui","note":"","ucode":"843028B4E07F41","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":464271,"discussion_content":"è°å…ˆå‘èµ·æ–­è¿çš„æ“ä½œï¼Œè°å°±æ˜¯ä¸»åŠ¨å…³é—­æ–¹ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567132675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1184919,"avatar":"https://static001.geekbang.org/account/avatar/00/12/14/97/8a3aa317.jpg","nickname":"ç–¾é£çŸ¥åŠ²è‰","note":"","ucode":"B6E73CA240AA29","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5991,"discussion_content":"ä¸»åŠ¨ä¸”é¦–å…ˆå‘é€finæŠ¥æ–‡çš„å°±æ˜¯ä¸»åŠ¨å…³é—­è¿æ¥çš„ä¸€æ–¹","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566569186,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":126932,"user_name":"æ¨é¢†well","can_delete":false,"product_type":"c1","uid":1145650,"ip_address":"","ucode":"3974A03855168C","user_header":"https://static001.geekbang.org/account/avatar/00/11/7b/32/60089a62.jpg","comment_is_top":false,"comment_ctime":1566522409,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566522409","product_id":100032701,"comment_content":"æˆ‘è§‰å¾— MSL å°±æ˜¯å‘é€æ–¹è‡ªä»¥ä¸ºæ˜¯çš„è®¤ä¸ºï¼Œåœ¨å‘é€è¿‡ç¨‹ä¸­çš„è·¯ç”±å™¨æˆ–ä¸»æœºæ˜¯ä¸çŸ¥é“ MSL æˆ–è€…è¶…æ—¶ä»€ä¹ˆçš„ã€‚è€Œå®ƒä»¬æ˜¯ä»¥ TTL æ¥ä½œæ§åˆ¶çš„ã€‚","like_count":0},{"had_liked":false,"id":126919,"user_name":"è€å§œ","can_delete":false,"product_type":"c1","uid":1557836,"ip_address":"","ucode":"7849B49073FD01","user_header":"https://static001.geekbang.org/account/avatar/00/17/c5/4c/141e03e7.jpg","comment_is_top":false,"comment_ctime":1566521508,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566521508","product_id":100032701,"comment_content":"é—®é¢˜äºŒã€‚æœ¬æ¥è®¡ç®—å¾€è¿”æ—¶é—´ç”¨çš„å°±æ˜¯ä¸Šä¸€æ¬¡è‡ªå·±çš„æ—¶é—´æˆ³ã€‚ã€‚ã€‚","like_count":0},{"had_liked":false,"id":126905,"user_name":"åœ¨è·¯ä¸Š","can_delete":false,"product_type":"c1","uid":1619588,"ip_address":"","ucode":"C11D567FCB8CD6","user_header":"https://static001.geekbang.org/account/avatar/00/18/b6/84/1f60f267.jpg","comment_is_top":false,"comment_ctime":1566520300,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1566520300","product_id":100032701,"comment_content":"é—®é¢˜1ï¼šæœ‰ä¸ªæµ…è–„çš„æƒ³æ³•ï¼Œæœ‰ä¸ªå­—æ®µè®°å½•ï¼Œæ¯”å¦‚æˆ‘å‘é€çš„æ—¶å€™ï¼ŒæŸä¸ªå­—æ®µæ˜¯0ï¼Œæ­£å¸¸æ¥æ”¶åˆ°ä¹‹åä¹Ÿåº”è¯¥ä¸º0ï¼Œè¶…æ—¶è®¾ç½®æˆå…¶ä»–çš„ï¼ˆæ²¡ç™¾åº¦åˆ°å…·ä½“æ€ä¹ˆå®ç°çš„ï¼‰ã€‚<br>é—®é¢˜2ï¼šç»Ÿä¸€çš„æ—¶é—´åº”è¯¥è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œæˆ–è€…ä¿å­˜å¥½æ—¶é—´å·®ä¸è¿‡æ„Ÿè§‰è¿™ä¸ªä¸å¤§å¯è¡Œ","like_count":0}]}