{"id":200162,"title":"52 | MongoDB数据中台案例","content":"<p><strong>课件和Demo地址</strong><br>\n<a href=\"https://gitee.com/geektime-geekbang/geektime-mongodb-course\">https://gitee.com/geektime-geekbang/geektime-mongodb-course</a></p>","comments":[{"had_liked":false,"id":180533,"user_name":"K战神","can_delete":false,"product_type":"c3","uid":1139367,"ip_address":"","ucode":"527E6BB26BB766","user_header":"https://static001.geekbang.org/account/avatar/00/11/62/a7/3e6fee86.jpg","comment_is_top":false,"comment_ctime":1582316418,"is_pvip":false,"replies":[{"id":70064,"content":"技术方面的：\n\n1） 理解客户环境Oracle数据库内的一些存储过程，以及没有文档没有词典的数据库表  -  这些在中台里有对应的元数据管理平台能够很大改善\n\n2）数据一致性校验，虽然使用的工具有一定的校验能力，但是由于中台上部署的直接面向业务的生产系统（而非分析平台），客户DBA对数据准确性要求很高，这方面甲乙方都花了不少超出计划的时间。以后需要在这方面提前计划，以及完善工具的验证场景支持。\n\n非技术方面：\n   数据源配合方面，我们有一个客户是CIO驱动的，就没有阻力，另一个客户是中层部门驱动的，数据源协调就比较困难，花了5-6个月才把10来个数据源接入。\n","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1582340976,"ip_address":"","comment_id":180533,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"老师中台案例有没有遇到最大的困难是什么？","like_count":6,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484698,"discussion_content":"技术方面的：\n\n1） 理解客户环境Oracle数据库内的一些存储过程，以及没有文档没有词典的数据库表  -  这些在中台里有对应的元数据管理平台能够很大改善\n\n2）数据一致性校验，虽然使用的工具有一定的校验能力，但是由于中台上部署的直接面向业务的生产系统（而非分析平台），客户DBA对数据准确性要求很高，这方面甲乙方都花了不少超出计划的时间。以后需要在这方面提前计划，以及完善工具的验证场景支持。\n\n非技术方面：\n   数据源配合方面，我们有一个客户是CIO驱动的，就没有阻力，另一个客户是中层部门驱动的，数据源协调就比较困难，花了5-6个月才把10来个数据源接入。\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582340976,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1139367,"avatar":"https://static001.geekbang.org/account/avatar/00/11/62/a7/3e6fee86.jpg","nickname":"K战神","note":"","ucode":"527E6BB26BB766","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":181177,"discussion_content":"谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1582343044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":183300,"user_name":"李英权","can_delete":false,"product_type":"c3","uid":1076081,"ip_address":"","ucode":"FECAC14A9C414B","user_header":"https://static001.geekbang.org/account/avatar/00/10/6b/71/e833b14a.jpg","comment_is_top":false,"comment_ctime":1582989880,"is_pvip":false,"replies":[{"id":70936,"content":"实时数据平台是必然趋势","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1583027818,"ip_address":"","comment_id":183300,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"数据孤岛如果是mysql的话，cdc应该就是用canal或阿里云的DTS实现binlog数据订阅。 正准备用这个模式大干一场，看到本节课 顿时信心满满摩拳擦掌了。","like_count":4,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":485640,"discussion_content":"实时数据平台是必然趋势","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1583027818,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187276,"user_name":"mtr","can_delete":false,"product_type":"c3","uid":1904061,"ip_address":"","ucode":"19809F616C9BE1","user_header":"https://static001.geekbang.org/account/avatar/00/1d/0d/bd/e0045fa0.jpg","comment_is_top":false,"comment_ctime":1584072923,"is_pvip":false,"replies":[{"id":73189,"content":"9G 限定只针对于数据缓存部分，Mongod还需要一些内存管理IO线程，聚合计算&#47;排序用存储等等所以实际肯定超出9G。 \n\n\n如果降低mongod的数量可能会有些帮助。","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1584625946,"ip_address":"","comment_id":187276,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"唐老师您好：\n\t关于mongodb启动内存限制的一个问题想要咨询下，目前我们使用的3.2.18版本，存储引擎 WiredTiger。每日数据量20亿左右，分布在多台主机上，单台主机内存256，单台主机总共18个mongod，单个mongod启动限制为9，限制为机器总存储的60%左右，但是随着时间的增长，内存远远超过了之前的限定值9G，机器的总内存消耗达到90%左右，每隔几个月就需要通过主备切换进行mongod进程的重启，关于这个问题，您这边是否有什么好的建议，是需要修改对应的参数还是本身数据量太大，内存淘汰过慢造成？","like_count":1,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487052,"discussion_content":"9G 限定只针对于数据缓存部分，Mongod还需要一些内存管理IO线程，聚合计算/排序用存储等等所以实际肯定超出9G。 \n\n\n如果降低mongod的数量可能会有些帮助。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584625946,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":212030,"user_name":"春暖花开","can_delete":false,"product_type":"c3","uid":1215253,"ip_address":"","ucode":"8B7D3BA1C1DD1B","user_header":"https://static001.geekbang.org/account/avatar/00/12/8b/15/5278f52a.jpg","comment_is_top":false,"comment_ctime":1588049355,"is_pvip":false,"replies":[{"id":79242,"content":"可以再仔细看下第二章的内容","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1588595752,"ip_address":"","comment_id":212030,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"老师，如果用mongdb的话，事物性是怎么保证的\n","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493415,"discussion_content":"可以再仔细看下第二章的内容","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588595752,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205191,"user_name":"川杰","can_delete":false,"product_type":"c3","uid":1099750,"ip_address":"","ucode":"815211E1D698E6","user_header":"https://static001.geekbang.org/account/avatar/00/10/c7/e6/11f21cb4.jpg","comment_is_top":false,"comment_ctime":1586568814,"is_pvip":false,"replies":[{"id":77494,"content":"它的数据默认只是写到内存就返回。数据的安全性通过同步到其他节点上和journal日志来保证。没有IO在里面，响应时间自然就快。","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1587097371,"ip_address":"","comment_id":205191,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"老师好，看完了视频课，有个问题想问下。mongodb为什么这么快，适用于秒级别的数据库访问（物联网场景等）？比如说redis虽然是单线程，但是它基于了I&#47;O多路复用的机制。那mongodb呢？因为它天然的支持了分布式么？","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":491416,"discussion_content":"它的数据默认只是写到内存就返回。数据的安全性通过同步到其他节点上和journal日志来保证。没有IO在里面，响应时间自然就快。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1587097371,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":199567,"user_name":"cording","can_delete":false,"product_type":"c3","uid":1786385,"ip_address":"","ucode":"82063AEC231613","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKlllSKrpQkhSXyNj0glDoCiaMKp23ey4Fw0nr54MKKhYAIxxU7toQuukJe2qZjwUC990ojdNmeicVQ/132","comment_is_top":false,"comment_ctime":1585491623,"is_pvip":false,"replies":[{"id":75813,"content":"当然。这个是一级对象，肯定是单独的collection。","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1586082103,"ip_address":"","comment_id":199567,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"老师，在数据中台中的数据看起来是通过业务领域模型建模的，如商品，会员等。那在mongodb里面是将商品，会员建成一个个独立collection去管理的吗？","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489848,"discussion_content":"当然。这个是一级对象，肯定是单独的collection。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586082103,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":193654,"user_name":"bb","can_delete":false,"product_type":"c3","uid":1770466,"ip_address":"","ucode":"9E480BA11D4D89","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM4fPb1ic9W9IHrz4fxE9t2y9BqRxdibllS5pQfnNiabvib7kc6Ql7YJnVh2PPzxrpXqN3eMsCyvoZrxfw/132","comment_is_top":false,"comment_ctime":1584942424,"is_pvip":false,"replies":[{"id":74324,"content":"MongoDB Compass 可以。","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1585221432,"ip_address":"","comment_id":193654,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"怎么查看MongoDB集合的元数据信息，比如集合文档数，集合的结构","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":488608,"discussion_content":"MongoDB Compass 可以。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585221432,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":188249,"user_name":"bb","can_delete":false,"product_type":"c3","uid":1770466,"ip_address":"","ucode":"9E480BA11D4D89","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM4fPb1ic9W9IHrz4fxE9t2y9BqRxdibllS5pQfnNiabvib7kc6Ql7YJnVh2PPzxrpXqN3eMsCyvoZrxfw/132","comment_is_top":false,"comment_ctime":1584331119,"is_pvip":false,"replies":[{"id":73182,"content":"\ndb.adminCommand( { setParameter: 1, &lt;parameter&gt;: &lt;value&gt; } )\n\n\nhttps:&#47;&#47;docs.mongodb.com&#47;manual&#47;reference&#47;command&#47;setParameter&#47;\n","user_name":"作者回复","user_name_real":"远航的TJ 唐建法","uid":1260017,"ctime":1584623715,"ip_address":"","comment_id":188249,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"请问，怎么修改MongoDB的配置参数。在shell中","like_count":0,"discussions":[{"author":{"id":1260017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/39/f1/6d18a4d1.jpg","nickname":"远航的TJ 唐建法","note":"","ucode":"0719807390250A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":487363,"discussion_content":"\ndb.adminCommand( { setParameter: 1, &amp;lt;parameter&amp;gt;: &amp;lt;value&amp;gt; } )\n\n\nhttps://docs.mongodb.com/manual/reference/command/setParameter/\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584623715,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":380758,"user_name":"Geek_9ee1d0","can_delete":false,"product_type":"c3","uid":3711839,"ip_address":"北京","ucode":"9D7A7CB8C76E71","user_header":"","comment_is_top":false,"comment_ctime":1694096913,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"如果能有个结合后台语言的项目案例就更好了","like_count":0},{"had_liked":false,"id":277546,"user_name":"robincoin","can_delete":false,"product_type":"c3","uid":1053243,"ip_address":"","ucode":"BA89BCEA1D6B9D","user_header":"https://static001.geekbang.org/account/avatar/00/10/12/3b/969eedf2.jpg","comment_is_top":false,"comment_ctime":1612450639,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100040001,"comment_content":"mongodb构建宽表，如果维度要更新，是直接update么","like_count":0},{"had_liked":false,"id":190457,"user_name":"刘楠","can_delete":false,"product_type":"c3","uid":1120773,"ip_address":"","ucode":"9F19D44CBEE039","user_header":"https://static001.geekbang.org/account/avatar/00/11/1a/05/f154d134.jpg","comment_is_top":false,"comment_ctime":1584662341,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100040001,"comment_content":"学完了，谢谢老师了，","like_count":0}]}