{"id":219875,"title":"19 | åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¦‚ä½•å¿«é€Ÿå®šä½é—®é¢˜ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯ä½•å°é”‹ã€‚ä¸Šä¸€è®²æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•å»ºç«‹å¯é çš„å®‰å…¨ä½“ç³»ï¼Œå…³é”®ç‚¹å°±æ˜¯â€œé‰´æƒâ€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»Ÿä¸€çš„é‰´æƒæœåŠ¡åŠ¨æ€ç”Ÿæˆç§˜é’¥ï¼Œæé«˜RPCè°ƒç”¨çš„å®‰å…¨æ€§ã€‚</p><p>å›é¡¾å®Œä¸Šä¸€è®²çš„é‡ç‚¹ï¼Œæˆ‘ä»¬å°±åˆ‡å…¥ä»Šå¤©çš„ä¸»é¢˜ï¼Œä¸€èµ·çœ‹çœ‹RPCåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¦‚ä½•å¿«é€Ÿå®šä½é—®é¢˜ã€‚é‡è¦æ€§çœ‹å­—é¢ä¹Ÿæ˜¯ä¸è¨€è€Œå–»äº†ï¼Œåªæœ‰å‡†ç¡®åœ°å®šä½é—®é¢˜ï¼Œæˆ‘ä»¬æ‰èƒ½æ›´å¥½åœ°è§£å†³é—®é¢˜ã€‚</p><h2>åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å®šä½é—®é¢˜æœ‰å“ªäº›å›°éš¾ï¼Ÿ</h2><p>åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè¯·ä½ æƒ³æƒ³ï¼Œåœ¨å¼€å‘ä»¥åŠç”Ÿäº§ç¯å¢ƒè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœé‡è§é—®é¢˜ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•å®šä½çš„ï¼Ÿ</p><p>åœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡è§é—®é¢˜å…¶å®å¾ˆå¥½æ’æŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨IDEåœ¨è‡ªå·±æœ¬åœ°çš„å¼€å‘ç¯å¢ƒä¸­è¿è¡Œä¸€éä»£ç ï¼Œè¿›è¡Œdebugï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ˜¯å¾ˆå®¹æ˜“æ‰¾åˆ°é—®é¢˜çš„ã€‚</p><p>é‚£æ¢åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œä»£ç åœ¨çº¿ä¸Šè¿è¡Œä¸šåŠ¡ï¼Œæˆ‘ä»¬æ˜¯ä¸èƒ½è¿›è¡Œdebugçš„ï¼Œè¿™æ—¶æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ‰“å°æ—¥å¿—æ¥æŸ¥çœ‹å½“å‰çš„å¼‚å¸¸æ—¥å¿—ï¼Œè¿™ä¹Ÿæ˜¯æœ€ç®€å•æœ‰æ•ˆçš„ä¸€ç§æ–¹å¼äº†ã€‚äº‹å®ä¸Šï¼Œå¤§éƒ¨åˆ†é—®é¢˜çš„å®šä½æˆ‘ä»¬ä¹Ÿæ˜¯è¿™æ ·åšçš„ã€‚</p><p>é‚£ä¹ˆå¦‚æœæ˜¯åœ¨åˆ†å¸ƒå¼çš„ç”Ÿäº§ç¯å¢ƒä¸­å‘¢ï¼Ÿæ¯”å¦‚ä¸‹é¢è¿™ä¸ªåœºæ™¯ï¼š</p><p>æˆ‘ä»¬æ­å»ºäº†ä¸€ä¸ªåˆ†å¸ƒå¼çš„åº”ç”¨ç³»ç»Ÿï¼Œåœ¨è¿™ä¸ªåº”ç”¨ç³»ç»Ÿä¸­ï¼Œæˆ‘å¯åŠ¨äº†4ä¸ªå­æœåŠ¡ï¼Œåˆ†åˆ«æ˜¯æœåŠ¡Aã€æœåŠ¡Bã€æœåŠ¡Cä¸æœåŠ¡Dï¼Œè€Œè¿™4ä¸ªæœåŠ¡çš„ä¾èµ–å…³ç³»æ˜¯A-&gt;B-&gt;C-&gt;Dï¼Œè€Œè¿™äº›æœåŠ¡åˆéƒ½éƒ¨ç½²åœ¨ä¸åŒçš„æœºå™¨ä¸Šã€‚åœ¨RPCè°ƒç”¨ä¸­ï¼Œå¦‚æœæœåŠ¡ç«¯çš„ä¸šåŠ¡é€»è¾‘å‡ºç°äº†å¼‚å¸¸ï¼Œå°±ä¼šæŠŠå¼‚å¸¸æŠ›å›ç»™è°ƒç”¨ç«¯ï¼Œé‚£ä¹ˆå¦‚æœç°åœ¨è¿™ä¸ªè°ƒç”¨é“¾ä¸­æœ‰ä¸€ä¸ªæœåŠ¡å‡ºç°äº†å¼‚å¸¸ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å®šä½é—®é¢˜å‘¢ï¼Ÿ</p><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/f7/82/f70e402a1634ae9c384c6cd6c4b89182.jpg?wh=4280*820\" alt=\"\" title=\"æœåŠ¡å¼‚å¸¸\"></p><p>å¯èƒ½ä½ çš„ç¬¬ä¸€ååº”ä»ç„¶æ˜¯æ‰“å°æ—¥å¿—ï¼Œå¥½ï¼Œé‚£å°±æ‰“å°æ—¥å¿—å§ã€‚</p><p>å‡å¦‚è¿™æ—¶æˆ‘ä»¬å‘ç°æœåŠ¡Aå‡ºç°äº†å¼‚å¸¸ï¼Œé‚£è¿™ä¸ªå¼‚å¸¸æœ‰æ²¡æœ‰å¯èƒ½æ˜¯å› ä¸ºBæˆ–Cæˆ–Då‡ºç°äº†å¼‚å¸¸æŠ›å›æ¥çš„å‘¢ï¼Ÿå½“ç„¶å¾ˆæœ‰å¯èƒ½ã€‚é‚£æˆ‘ä»¬æ€ä¹ˆç¡®å®šåœ¨æ•´ä¸ªåº”ç”¨ç³»ç»Ÿä¸­ï¼Œæ˜¯å“ªä¸€ä¸ªè°ƒç”¨æ­¥éª¤å‡ºç°çš„é—®é¢˜ï¼Œä»¥åŠæ˜¯åœ¨è¿™ä¸ªæ­¥éª¤ä¸­çš„å“ªå°æœºå™¨å‡ºç°çš„é—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬è¯¥åœ¨å“ªå°æœºå™¨ä¸Šæ‰“å°æ—¥å¿—ï¼Ÿè€Œä¸”ä¸ºäº†æ’æŸ¥é—®é¢˜ï¼Œå¦‚æœè¦æ‰“å°æ—¥å¿—ï¼Œæˆ‘ä»¬å°±å¿…é¡»è¦ä¿®æ”¹ä»£ç ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±å¾—é‡æ–°å¯¹æœåŠ¡è¿›è¡Œä¸Šçº¿ã€‚å¦‚æœè¿™å‡ ä¸ªæœåŠ¡åˆæ°å¥½æ˜¯è·¨å›¢é˜Ÿè·¨éƒ¨é—¨çš„å‘¢ï¼Ÿæƒ³æƒ³æˆ‘ä»¬è¦é¢ä¸´çš„æ²Ÿé€šæˆæœ¬å§ã€‚</p><p>æ‰€ä»¥ä½ çœ‹ï¼Œåˆ†å¸ƒå¼ç¯å¢ƒä¸‹å®šä½é—®é¢˜çš„éš¾ç‚¹å°±åœ¨äºï¼Œå„å­åº”ç”¨ã€å­æœåŠ¡é—´æœ‰ç€å¤æ‚çš„ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬æœ‰æ—¶å¾ˆéš¾ç¡®å®šæ˜¯å“ªä¸ªæœåŠ¡çš„å“ªä¸ªç¯èŠ‚å‡ºç°çš„é—®é¢˜ã€‚ç®€å•åœ°é€šè¿‡æ—¥å¿—æ’æŸ¥é—®é¢˜ï¼Œå°±è¦å¯¹æ¯ä¸ªå­åº”ç”¨ã€å­æœåŠ¡é€ä¸€è¿›è¡Œæ’æŸ¥ï¼Œå¾ˆéš¾ä¸€æ­¥åˆ°ä½ï¼›è‹¥æ°å¥½å†èµ¶ä¸Šè·¨å›¢é˜Ÿè·¨éƒ¨é—¨ï¼Œé‚£ä¸æ­»ä¹Ÿå¾—å»åŠæ¡å‘½äº†ã€‚</p><h2>å¦‚ä½•åšåˆ°å¿«é€Ÿå®šä½é—®é¢˜ï¼Ÿ</h2><p>æ˜ç™½äº†éš¾ç‚¹ï¼Œæˆ‘ä»¬å…¶å®å°±å¯ä»¥æœ‰é’ˆå¯¹æ€§åœ°å»æ”»å…‹å®ƒäº†ã€‚æœ‰å…³RPCåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¦‚ä½•å¿«é€Ÿå®šä½é—®é¢˜ï¼Œæˆ‘ç»™å‡ºä¸¤ä¸ªæ–¹æ³•ï¼Œå¾ˆå®ç”¨ã€‚</p><h3>æ–¹æ³•1ï¼šå€ŸåŠ©åˆç†å°è£…çš„å¼‚å¸¸ä¿¡æ¯</h3><p>æˆ‘ä»¬å‰é¢è¯´æ˜¯å› ä¸ºå„å­åº”ç”¨ã€å­æœåŠ¡é—´å¤æ‚çš„ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥é€šè¿‡æ—¥å¿—éš¾å®šä½é—®é¢˜ã€‚é‚£æˆ‘ä»¬å°±æƒ³åŠæ³•é€šè¿‡æ—¥å¿—å®šä½åˆ°æ˜¯å“ªä¸ªå­åº”ç”¨çš„å­æœåŠ¡å‡ºç°é—®é¢˜å°±è¡Œäº†ã€‚</p><p>å…¶å®ï¼Œåœ¨RPCæ¡†æ¶æ‰“å°çš„å¼‚å¸¸ä¿¡æ¯ä¸­ï¼Œæ˜¯åŒ…æ‹¬å®šä½å¼‚å¸¸æ‰€éœ€è¦çš„å¼‚å¸¸ä¿¡æ¯çš„ï¼Œæ¯”å¦‚æ˜¯å“ªç±»å¼‚å¸¸å¼•èµ·çš„é—®é¢˜ï¼ˆå¦‚åºåˆ—åŒ–é—®é¢˜æˆ–ç½‘ç»œè¶…æ—¶é—®é¢˜ï¼‰ï¼Œæ˜¯è°ƒç”¨ç«¯è¿˜æ˜¯æœåŠ¡ç«¯å‡ºç°çš„å¼‚å¸¸ï¼Œè°ƒç”¨ç«¯ä¸æœåŠ¡ç«¯çš„IPæ˜¯ä»€ä¹ˆï¼Œä»¥åŠæœåŠ¡æ¥å£ä¸æœåŠ¡åˆ†ç»„éƒ½æ˜¯ä»€ä¹ˆç­‰ç­‰ã€‚å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/b8/1b/b8fee37688d39ae7913429f6cbc06f1b.jpg?wh=4498*1228\" alt=\"\" title=\"é“¾è·¯è°ƒç”¨å¼‚å¸¸\"></p><p>è¿™æ ·çš„è¯ï¼Œåœ¨A-&gt;B-&gt;C-&gt;Dè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆå¿«åœ°å®šä½åˆ°æ˜¯CæœåŠ¡å‡ºç°äº†é—®é¢˜ï¼ŒæœåŠ¡æ¥å£æ˜¯com.demo.CSerivceï¼Œè°ƒç”¨ç«¯IPæ˜¯192.168.1.2ï¼ŒæœåŠ¡ç«¯IPæ˜¯192.168.1.3ï¼Œè€Œå‡ºç°é—®é¢˜çš„åŸå› å°±æ˜¯ä¸šåŠ¡çº¿ç¨‹æ± æ»¡äº†ã€‚</p><p>ç”±æ­¤å¯è§ï¼Œä¸€æ¬¾ä¼˜ç§€çš„RPCæ¡†æ¶è¦å¯¹å¼‚å¸¸è¿›è¡Œè¯¦ç»†åœ°å°è£…ï¼Œè¿˜è¦å¯¹å„ç±»å¼‚å¸¸è¿›è¡Œåˆ†ç±»ï¼Œæ¯ç±»å¼‚å¸¸éƒ½è¦æœ‰æ˜ç¡®çš„å¼‚å¸¸æ ‡è¯†ç ï¼Œå¹¶æ•´ç†æˆä¸€ä»½ç®€æ˜çš„æ–‡æ¡£ã€‚ä½¿ç”¨æ–¹å¯ä»¥å¿«é€Ÿåœ°é€šè¿‡å¼‚å¸¸æ ‡è¯†ç åœ¨æ–‡æ¡£ä¸­æŸ¥é˜…ï¼Œä»è€Œå¿«é€Ÿå®šä½é—®é¢˜ï¼Œæ‰¾åˆ°åŸå› ï¼›å¹¶ä¸”å¼‚å¸¸ä¿¡æ¯ä¸­è¦åŒ…å«æ’æŸ¥é—®é¢˜æ—¶æ‰€éœ€è¦çš„é‡è¦ä¿¡æ¯ï¼Œæ¯”å¦‚æœåŠ¡æ¥å£åã€æœåŠ¡åˆ†ç»„ã€è°ƒç”¨ç«¯ä¸æœåŠ¡ç«¯çš„IPï¼Œä»¥åŠäº§ç”Ÿå¼‚å¸¸çš„åŸå› ã€‚æ€»ä¹‹å°±æ˜¯ï¼Œè¦è®©ä½¿ç”¨æ–¹åœ¨å¤æ‚çš„åˆ†å¸ƒå¼åº”ç”¨ç³»ç»Ÿä¸­ï¼Œæ ¹æ®å¼‚å¸¸ä¿¡æ¯å¿«é€Ÿåœ°å®šä½åˆ°é—®é¢˜ã€‚</p><p>ä»¥ä¸Šæ˜¯å¯¹äºRPCæ¡†æ¶æœ¬èº«çš„å¼‚å¸¸æ¥è¯´çš„ï¼Œæ¯”å¦‚åºåˆ—åŒ–å¼‚å¸¸ã€å“åº”è¶…æ—¶å¼‚å¸¸ã€è¿æ¥å¼‚å¸¸ç­‰ç­‰ã€‚é‚£æœåŠ¡ç«¯ä¸šåŠ¡é€»è¾‘çš„å¼‚å¸¸å‘¢ï¼ŸæœåŠ¡æä¾›æ–¹æä¾›çš„æœåŠ¡çš„ä¸šåŠ¡é€»è¾‘ä¹Ÿè¦å°è£…è‡ªå·±çš„ä¸šåŠ¡å¼‚å¸¸ä¿¡æ¯ï¼Œä»è€Œè®©æœåŠ¡è°ƒç”¨æ–¹ä¹Ÿå¯ä»¥é€šè¿‡å¼‚å¸¸ä¿¡æ¯å¿«é€Ÿåœ°å®šä½åˆ°é—®é¢˜ã€‚</p><h3>æ–¹æ³•2ï¼šå€ŸåŠ©åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ª</h3><p>æ— è®ºæ˜¯RPCæ¡†æ¶æœ¬èº«ï¼Œè¿˜æ˜¯æœåŠ¡æä¾›æ–¹æä¾›çš„æœåŠ¡ï¼Œåªè¦å¯¹å¼‚å¸¸ä¿¡æ¯è¿›è¡Œåˆç†åœ°å°è£…ï¼Œå°±å¯ä»¥è®©æˆ‘ä»¬åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å®šä½é—®é¢˜å˜å¾—æ›´åŠ å®¹æ˜“ã€‚é‚£è¿™æ ·æ˜¯ä¸æ˜¯å°±æ»¡è¶³æˆ‘ä»¬å®šä½é—®é¢˜çš„éœ€æ±‚äº†å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬è¿˜æ˜¯å›åˆ°å‰é¢æè¿‡çš„é‚£ä¸ªåˆ†å¸ƒå¼åœºæ™¯ï¼šæˆ‘ä»¬æ­å»ºäº†ä¸€ä¸ªåˆ†å¸ƒå¼çš„åº”ç”¨ç³»ç»Ÿï¼Œå®ƒç”±4ä¸ªå­æœåŠ¡ç»„æˆï¼Œ4ä¸ªæœåŠ¡çš„ä¾èµ–å…³ç³»ä¸ºA-&gt;B-&gt;C-&gt;Dã€‚</p><p>å‡è®¾è¿™4ä¸ªæœåŠ¡åˆ†åˆ«ç”±æ¥è‡ªä¸åŒéƒ¨é—¨çš„4ä¸ªåŒäº‹ç»´æŠ¤ï¼Œåœ¨Aè°ƒç”¨Bçš„æ—¶å€™ï¼Œç»´æŠ¤æœåŠ¡Açš„åŒäº‹å¯èƒ½æ˜¯ä¸çŸ¥é“å­˜åœ¨æœåŠ¡Cå’ŒæœåŠ¡Dçš„ï¼Œå¯¹äºæœåŠ¡Aæ¥è¯´ï¼Œå®ƒçš„ä¸‹æ¸¸æœåŠ¡åªæœ‰BæœåŠ¡ï¼Œé‚£è¿™æ—¶å¦‚æœæœåŠ¡Cæˆ–æœåŠ¡Då‡ºç°å¼‚å¸¸ï¼Œæœ€ç»ˆåœ¨æ•´ä¸ªé“¾è·¯ä¸­å°†å¼‚å¸¸æŠ›ç»™Aäº†å‘¢ï¼Ÿ</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ç»´æŠ¤æœåŠ¡Açš„åŒäº‹è¯¥å¦‚ä½•å®šä½é—®é¢˜å‘¢ï¼Ÿ</p><p>å› ä¸ºå¯¹äºAæ¥è¯´ï¼Œå®ƒå¯èƒ½æ˜¯ä¸çŸ¥é“ä¸‹æ¸¸å­˜åœ¨æœåŠ¡Cå’ŒæœåŠ¡Dçš„ï¼Œæ‰€ä»¥ç»´æŠ¤æœåŠ¡Açš„åŒäº‹ä¼šç›´æ¥è”ç³»ç»´æŠ¤æœåŠ¡Bçš„åŒäº‹ï¼Œä¹‹åç»´æŠ¤æœåŠ¡Bçš„åŒäº‹ä¼šç»§ç»­è”ç³»ä¸‹æ¸¸æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ï¼Œç›´åˆ°æ‰¾åˆ°é—®é¢˜ã€‚å¯è¿™æ ·åšæˆæœ¬å¾ˆé«˜å•Šï¼</p><p>ç°åœ¨æˆ‘ä»¬æ¢ä¸ªæ€è·¯ï¼Œå…¶å®æˆ‘ä»¬åªè¦çŸ¥é“æ•´ä¸ªè¯·æ±‚çš„è°ƒç”¨é“¾è·¯å°±å¯ä»¥äº†ã€‚æœåŠ¡Aè°ƒç”¨ä¸‹æ¸¸æœåŠ¡Bï¼ŒæœåŠ¡Båˆè°ƒç”¨äº†Bä¾èµ–çš„ä¸‹æ¸¸æœåŠ¡ï¼Œå¦‚æœç»´æŠ¤æœåŠ¡Açš„åŒäº‹èƒ½æ¸…æ¥šåœ°çŸ¥é“æ•´ä¸ªè°ƒç”¨é“¾è·¯ï¼Œå¹¶ä¸”èƒ½å‡†ç¡®åœ°å‘ç°åœ¨æ•´ä¸ªè°ƒç”¨é“¾è·¯ä¸­æ˜¯å“ªä¸ªç¯èŠ‚å‡ºç°äº†é—®é¢˜ï¼Œé‚£å°±å¥½äº†ã€‚</p><p>è¿™å°±å¥½æ¯”æˆ‘ä»¬æ”¶å‘å¿«é€’ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¹³å°ä¸Šçœ‹åˆ°å¿«é€’é…é€çš„è½¨è¿¹ï¼Œå®æ—¶è·çŸ¥å¿«é€’åœ¨ä½•æ—¶åˆ°è¾¾äº†å“ªä¸ªç«™ç‚¹ï¼Œè¿™æ ·å½“æˆ‘ä»¬æ²¡æœ‰å‡†æ—¶åœ°æ”¶åˆ°å¿«é€’æ—¶ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±èƒ½çŸ¥é“å¿«é€’æ˜¯åœ¨å“ªé‡Œå»¶è¯¯äº†ã€‚</p><p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œè¦æƒ³çŸ¥é“æœåŠ¡è°ƒç”¨çš„æ•´ä¸ªé“¾è·¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨â€œåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªâ€ã€‚</p><p>å…ˆä»‹ç»ä¸‹åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªç³»ç»Ÿã€‚ä»å­—é¢ä¸Šç†è§£ï¼Œåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªå°±æ˜¯å°†ä¸€æ¬¡åˆ†å¸ƒå¼è¯·æ±‚è¿˜åŸä¸ºä¸€ä¸ªå®Œæ•´çš„è°ƒç”¨é“¾è·¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ•´ä¸ªè°ƒç”¨é“¾è·¯ä¸­è·Ÿè¸ªåˆ°è¿™ä¸€æ¬¡åˆ†å¸ƒå¼è¯·æ±‚çš„æ¯ä¸€ä¸ªç¯èŠ‚çš„è°ƒç”¨æƒ…å†µï¼Œæ¯”å¦‚è°ƒç”¨æ˜¯å¦æˆåŠŸï¼Œè¿”å›ä»€ä¹ˆå¼‚å¸¸ï¼Œè°ƒç”¨çš„å“ªä¸ªæœåŠ¡èŠ‚ç‚¹ä»¥åŠè¯·æ±‚è€—æ—¶ç­‰ç­‰ã€‚</p><p>è¿™æ ·å¦‚æœæˆ‘ä»¬å‘ç°æœåŠ¡è°ƒç”¨å‡ºç°é—®é¢˜ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å°±èƒ½å¿«é€Ÿå®šä½é—®é¢˜ï¼Œå“ªæ€•æ˜¯å¤šä¸ªéƒ¨é—¨åˆä½œï¼Œä¹Ÿå¯ä»¥ä¸€æ­¥åˆ°ä½ã€‚</p><p><strong>ç´§æ¥ç€ï¼Œæˆ‘ä»¬å†çœ‹çœ‹åœ¨RPCæ¡†æ¶ä¸­æ˜¯å¦‚ä½•æ•´åˆåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªçš„ï¼Ÿ</strong></p><p>åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªæœ‰Traceä¸Spançš„æ¦‚å¿µï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Œæˆ‘é€ä¸€è§£é‡Šã€‚</p><p>Traceå°±æ˜¯ä»£è¡¨æ•´ä¸ªé“¾è·¯ï¼Œæ¯æ¬¡åˆ†å¸ƒå¼éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªTraceï¼Œæ¯ä¸ªTraceéƒ½æœ‰å®ƒçš„å”¯ä¸€æ ‡è¯†å³TraceIdï¼Œåœ¨åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªç³»ç»Ÿä¸­ï¼Œå°±æ˜¯é€šè¿‡TraceIdæ¥åŒºåˆ†æ¯ä¸ªTraceçš„ã€‚</p><p>Spanå°±æ˜¯ä»£è¡¨äº†æ•´ä¸ªé“¾è·¯ä¸­çš„ä¸€æ®µé“¾è·¯ï¼Œä¹Ÿå°±æ˜¯è¯´Traceæ˜¯ç”±å¤šä¸ªSpanç»„æˆçš„ã€‚åœ¨ä¸€ä¸ªTraceä¸‹ï¼Œæ¯ä¸ªSpanä¹Ÿéƒ½æœ‰å®ƒçš„å”¯ä¸€æ ‡è¯†SpanIdï¼Œè€ŒSpanæ˜¯å­˜åœ¨çˆ¶å­å…³ç³»çš„ã€‚è¿˜æ˜¯ä»¥è®²è¿‡çš„ä¾‹å­ä¸ºä¾‹å­ï¼Œåœ¨A-&gt;B-&gt;C-&gt;Dçš„æƒ…å†µä¸‹ï¼Œåœ¨æ•´ä¸ªè°ƒç”¨é“¾ä¸­ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¼šäº§ç”Ÿ3ä¸ªSpanï¼Œåˆ†åˆ«æ˜¯Span1ï¼ˆA-&gt;Bï¼‰ã€Span2ï¼ˆB-&gt;Cï¼‰ã€Span3ï¼ˆC-&gt;Dï¼‰ï¼Œè¿™æ—¶Span3çš„çˆ¶Spanå°±æ˜¯Span2ï¼Œè€ŒSpan2çš„çˆ¶Spanå°±æ˜¯Span1ã€‚</p><p>Traceä¸Spançš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/47/65/47df54d3d38cb30fddf25e8b8b2c4b65.jpg?wh=4468*1336\" alt=\"\" title=\"ç¤ºæ„å›¾\"></p><p>åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªç³»ç»Ÿçš„å®ç°æ–¹å¼æœ‰å¾ˆå¤šï¼Œä½†å®ƒä»¬éƒ½è„±ç¦»ä¸å¼€æˆ‘åˆšæ‰è¯´çš„Traceå’ŒSpanï¼Œè¿™ä¸¤ç‚¹å¯ä»¥è¯´éå¸¸é‡è¦ï¼ŒæŒæ¡äº†è¿™ä¸¤ä¸ªæ¦‚å¿µï¼Œå…¶å®ä½ å°±æŒæ¡äº†å¤§éƒ¨åˆ†å®ç°æ–¹å¼çš„åŸç†ã€‚æ¥ç€æˆ‘ä»¬çœ‹çœ‹åœ¨RPCæ¡†æ¶ä¸­å¦‚ä½•åˆ©ç”¨è¿™ä¸¤ä¸ªæ¦‚å¿µå»æ•´åˆåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªã€‚</p><p>RPCåœ¨æ•´åˆåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªéœ€è¦åšçš„æœ€æ ¸å¿ƒçš„ä¸¤ä»¶äº‹å°±æ˜¯â€œåŸ‹ç‚¹â€å’Œâ€œä¼ é€’â€ã€‚</p><p>æ‰€è°“â€œåŸ‹ç‚¹â€å°±æ˜¯è¯´ï¼Œåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªç³»ç»Ÿè¦æƒ³è·å¾—ä¸€æ¬¡åˆ†å¸ƒå¼è°ƒç”¨çš„å®Œæ•´çš„é“¾è·¯ä¿¡æ¯ï¼Œå°±å¿…é¡»å¯¹è¿™æ¬¡åˆ†å¸ƒå¼è°ƒç”¨è¿›è¡Œæ•°æ®é‡‡é›†ï¼Œè€Œé‡‡é›†è¿™äº›æ•°æ®çš„æ–¹æ³•å°±æ˜¯é€šè¿‡RPCæ¡†æ¶å¯¹åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªè¿›è¡ŒåŸ‹ç‚¹ã€‚</p><p>RPCè°ƒç”¨ç«¯åœ¨è®¿é—®æœåŠ¡ç«¯æ—¶ï¼Œåœ¨å‘é€è¯·æ±‚æ¶ˆæ¯å‰ä¼šè§¦å‘åˆ†å¸ƒå¼è·Ÿè¸ªåŸ‹ç‚¹ï¼Œåœ¨æ¥æ”¶åˆ°æœåŠ¡ç«¯å“åº”æ—¶ï¼Œä¹Ÿä¼šè§¦å‘åˆ†å¸ƒå¼è·Ÿè¸ªåŸ‹ç‚¹ï¼Œå¹¶ä¸”åœ¨æœåŠ¡ç«¯ä¹Ÿä¼šæœ‰ç±»ä¼¼çš„åŸ‹ç‚¹ã€‚è¿™äº›åŸ‹ç‚¹æœ€ç»ˆå¯ä»¥è®°å½•ä¸€ä¸ªå®Œæ•´çš„Spanï¼Œè€Œè¿™ä¸ªé“¾è·¯çš„æºå¤´ä¼šè®°å½•ä¸€ä¸ªå®Œæ•´çš„Traceï¼Œæœ€ç»ˆTraceä¿¡æ¯ä¼šè¢«ä¸ŠæŠ¥ç»™åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªç³»ç»Ÿã€‚</p><p>é‚£æ‰€è°“â€œä¼ é€’â€å°±æ˜¯æŒ‡ï¼Œä¸Šæ¸¸è°ƒç”¨ç«¯å°†Traceä¿¡æ¯ä¸çˆ¶Spanä¿¡æ¯ä¼ é€’ç»™ä¸‹æ¸¸æœåŠ¡çš„æœåŠ¡ç«¯ï¼Œç”±ä¸‹æ¸¸è§¦å‘åŸ‹ç‚¹ï¼Œå¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œå¤„ç†ï¼Œåœ¨åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªå­Spanéƒ½å­˜æœ‰çˆ¶Spançš„ç›¸å…³ä¿¡æ¯ä»¥åŠTraceçš„ç›¸å…³ä¿¡æ¯ã€‚</p><h2>æ€»ç»“</h2><p>ä»Šå¤©æˆ‘ä»¬è®²è§£äº†åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¦‚ä½•å¿«é€Ÿå®šä½é—®é¢˜ã€‚è¿™é‡Œé¢çš„éš¾ç‚¹å°±æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿæœ‰ç€è¾ƒä¸ºå¤æ‚çš„ä¾èµ–å…³ç³»ï¼Œæˆ‘ä»¬å¾ˆéš¾åˆ¤æ–­å‡ºæ˜¯å“ªä¸ªç¯èŠ‚å‡ºç°çš„é—®é¢˜ï¼Œè€Œä¸”åœ¨å¤§å‹çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¾€å¾€ä¼šæœ‰è·¨éƒ¨é—¨ã€è·¨å›¢é˜Ÿåˆä½œçš„æƒ…å†µï¼Œåœ¨æ’æŸ¥é—®é¢˜çš„æ—¶å€™ä¼šé¢ä¸´éå¸¸é«˜çš„æ²Ÿé€šæˆæœ¬ã€‚</p><p>ä¸ºäº†åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹èƒ½å¤Ÿå¿«é€Ÿåœ°å®šä½é—®é¢˜ï¼ŒRPCæ¡†æ¶åº”è¯¥å¯¹æ¡†æ¶è‡ªèº«çš„å¼‚å¸¸è¿›è¡Œè¯¦ç»†åœ°å°è£…ï¼Œæ¯ç±»å¼‚å¸¸éƒ½è¦æœ‰æ˜ç¡®çš„å¼‚å¸¸æ ‡è¯†ç ï¼Œå¹¶å°†å…¶æ•´ç†æˆä¸€ä»½ç®€æ˜çš„æ–‡æ¡£ï¼Œå¼‚å¸¸ä¿¡æ¯ä¸­è¦å°½é‡åŒ…å«æœåŠ¡æ¥å£åã€æœåŠ¡åˆ†ç»„ã€è°ƒç”¨ç«¯ä¸æœåŠ¡ç«¯çš„IPï¼Œä»¥åŠäº§ç”Ÿå¼‚å¸¸çš„åŸå› ç­‰ä¿¡æ¯ï¼Œè¿™æ ·å¯¹äºä½¿ç”¨æ–¹æ¥è¯´å°±éå¸¸ä¾¿æ·äº†ã€‚</p><p>å¦å¤–ï¼ŒæœåŠ¡æä¾›æ–¹åœ¨æä¾›æœåŠ¡æ—¶ä¹Ÿè¦å¯¹å¼‚å¸¸è¿›è¡Œå°è£…ï¼Œä»¥æ–¹ä¾¿ä¸Šæ¸¸æ’æŸ¥é—®é¢˜ã€‚</p><p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªæ¥å¿«é€Ÿå®šä½é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨å¤šä¸ªéƒ¨é—¨çš„åˆä½œä¸­ï¼Œè¿™æ ·åšå¯ä»¥ä¸€æ­¥åˆ°ä½ï¼Œå‡å°‘æ’æŸ¥é—®é¢˜çš„æ—¶é—´ï¼Œé™ä½æ²Ÿé€šæˆæœ¬ï¼Œä»¥æœ€é«˜çš„æ•ˆç‡è§£å†³å®é™…é—®é¢˜ã€‚</p><h2>è¯¾åæ€è€ƒ</h2><p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œä½ è¿˜çŸ¥é“å“ªäº›å¿«é€Ÿå®šä½é—®é¢˜çš„æ–¹æ³•ï¼Ÿ</p><p>æœŸå¾…ä½ èƒ½åœ¨ç•™è¨€åŒºä¸­å’Œæˆ‘åˆ†äº«ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠæ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œé‚€è¯·ä»–åŠ å…¥å­¦ä¹ ï¼Œå…±åŒæ¢è®¨ã€‚æˆ‘ä»¬ä¸‹èŠ‚è¯¾å†è§ï¼</p>","neighbors":{"left":{"article_title":"18 | å®‰å…¨ä½“ç³»ï¼šå¦‚ä½•å»ºç«‹å¯é çš„å®‰å…¨ä½“ç³»ï¼Ÿ","id":218523},"right":{"article_title":"20 | è¯¦è§£æ—¶é’Ÿè½®åœ¨RPCä¸­çš„åº”ç”¨","id":219903}},"comments":[{"had_liked":false,"id":201918,"user_name":"Darren","can_delete":false,"product_type":"c1","uid":1254968,"ip_address":"","ucode":"CCD2B2C492BE9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","comment_is_top":false,"comment_ctime":1585877023,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"139024830495","product_id":100046201,"comment_content":"è€å¸ˆåº”è¯¥ä»‹ç»ä¸‹skywalkingã€Zipkinç­‰å¼€æºåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªçš„ä¼˜ç¼ºç‚¹å’Œä½¿ç”¨é—®é¢˜ç­‰ï¼Œæ¯•ç«Ÿèƒ½è‡ªç ”åˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªçš„å…¬å¸ä¸å¤š","like_count":33},{"had_liked":false,"id":202784,"user_name":"é™ˆå›½æ—","can_delete":false,"product_type":"c1","uid":1438037,"ip_address":"","ucode":"83D12F3E79F197","user_header":"https://static001.geekbang.org/account/avatar/00/15/f1/55/8ac4f169.jpg","comment_is_top":false,"comment_ctime":1586068515,"is_pvip":false,"replies":[{"id":"76828","content":"ä¸€çœ‹å°±å¾ˆæœ‰ç»éªŒ","user_name":"ä½œè€…å›å¤","comment_id":202784,"uid":"1541007","ip_address":"","utype":1,"ctime":1586691832,"user_name_real":"ä½•å°é”‹"}],"discussion_count":1,"race_medal":0,"score":"44535741475","product_id":100046201,"comment_content":"è€å¸ˆå¥½ï¼Œè¯´ä¸‹è‡ªå·±å®šä½é—®é¢˜çš„ä¸€äº›ç»éªŒå’Œæ–¹æ³•<br>1.  ç¡®è®¤æ¸…æ¥šé—®é¢˜çš„ç°è±¡æˆ–æœ¬è´¨<br>2. å¦‚æœæ—¶é—´å…è®¸å¯ä»¥å¤ç°ä¸‹é—®é¢˜ï¼Œå¯¹é—®é¢˜ç†è§£æ›´ç›´è§‚<br>3. æŸ¥çœ‹æ—¥å¿—ï¼Œç¡®è®¤æŠ¥é”™çš„å¼‚å¸¸ä¿¡æ¯ï¼ˆæ—¥å¿—è¿™æ­¥å¾ˆå…³é”®ï¼Œç‰©ç†æœºæ—¶ä»£é€šå¸¸åšæ³•æ˜¯ä¸Šæœºå™¨grepï¼Œå¦‚æœæœ‰å¤šå°æœºå™¨è¿™æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ç‚¹ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šæœ‰æ—¥å¿—ä¸­å¿ƒã€‚å®¹å™¨æ—¶ä»£çš„è¯å±è”½äº†Iaaså±‚ï¼Œæ—¥å¿—éƒ½å­˜åœ¨åœ¨æ—¥å¿—ä¸­å¿ƒï¼Œä¾‹å¦‚ELKï¼Œæ ¹æ®å…³é”®å­—å°±å¯ä»¥æŸ¥äº†ï¼‰<br>4. æŸ¥çœ‹ä»£ç ç¡®è®¤ä¸šåŠ¡é€»è¾‘<br>5. æ ¹æ®æ—¥å¿—å’Œä»£ç ä¸šåŠ¡é€»è¾‘åŸºæœ¬å°±å¯ä»¥ç¡®è®¤æŠ¥é”™çš„ç‚¹äº†<br>","like_count":11,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490684,"discussion_content":"ä¸€çœ‹å°±å¾ˆæœ‰ç»éªŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586691832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":201935,"user_name":"Jxin","can_delete":false,"product_type":"c1","uid":1251111,"ip_address":"","ucode":"4C03928388C413","user_header":"https://static001.geekbang.org/account/avatar/00/13/17/27/ec30d30a.jpg","comment_is_top":false,"comment_ctime":1585879128,"is_pvip":false,"replies":[{"id":"76834","content":"é€šè¿‡ä¸Šä¸‹æ–‡æˆ–è€…agent","user_name":"ä½œè€…å›å¤","comment_id":201935,"uid":"1541007","ip_address":"","utype":1,"ctime":1586692219,"user_name_real":"ä½•å°é”‹"}],"discussion_count":6,"race_medal":0,"score":"27355682904","product_id":100046201,"comment_content":"1.tracidåœ¨ç¢°åˆ°çº¿ç¨‹æ± å¼‚æ­¥æ—¶å¦‚ä½•ä¼ é€’idï¼Ÿ<br>2.mqæ¶ˆæ¯æ˜¯å¦ä¹Ÿè¯¥å¸¦ä¸Štracidï¼Ÿ","like_count":6,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490460,"discussion_content":"é€šè¿‡ä¸Šä¸‹æ–‡æˆ–è€…agent","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586692219,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1438037,"avatar":"https://static001.geekbang.org/account/avatar/00/15/f1/55/8ac4f169.jpg","nickname":"é™ˆå›½æ—","note":"","ucode":"83D12F3E79F197","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221833,"discussion_content":"å¦‚æœä½¿ç”¨Golangçš„è¯ï¼Œä½¿ç”¨contextå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1586068918,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1635388,"avatar":"https://static001.geekbang.org/account/avatar/00/18/f4/3c/60bf7a17.jpg","nickname":"å¿«ä¹çš„å¹³å¤´å“¥","note":"","ucode":"D7D2FA5DA6D8BF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":294280,"discussion_content":"ç¬¬ä¸€ä¸ªé—®é¢˜ ç”¨é˜¿é‡Œçš„ttl ç¬¬äºŒä¸ªé—®é¢˜ mqçš„user-propertyå±æ€§ æ·»åŠ traceid","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1595848580,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1125056,"avatar":"https://static001.geekbang.org/account/avatar/00/11/2a/c0/aa0dfe16.jpg","nickname":"noname","note":"","ucode":"82216A6618A353","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":224576,"discussion_content":"1. æœ€å¥½ä½¿ç”¨ç»Ÿä¸€çš„çº¿ç¨‹æ± ç»„ä»¶ï¼Œç»„ä»¶ç»Ÿä¸€å®ç°åˆ›å»ºå¼‚æ­¥å­çº¿ç¨‹æ—¶é€ä¼ çˆ¶çº¿ç¨‹çš„traceidã€‚ä½†ä¸šåŠ¡æ–¹è‡ªå·±newçº¿ç¨‹å¼‚æ­¥çš„åªèƒ½è‡ªå·±å•ç‹¬å¤„ç†äº†ã€‚å°±åƒHttpé€ä¼ æ—¶ä¸€èˆ¬traceidæ”¾headerï¼Œå¦‚æœä½ ä¸ç”¨å…¬å…±ç»„ä»¶è€Œç”¨è‡ªå·±çš„Httpclientï¼Œåªèƒ½è‡ªå·±è¯·æ±‚æ—¶æŠŠtraceidæ”¾headeré‡Œäº†ã€‚\n2. ä¸€èˆ¬éƒ½æ˜¯æŠŠtraceidæ”¾æ¶ˆæ¯å¤´ä¸Šä¼ é€’ã€‚","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586316459,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1087921,"avatar":"https://static001.geekbang.org/account/avatar/00/10/99/b1/46570b0c.jpg","nickname":"ç”³ç‰å®","note":"","ucode":"61CA71FA6DC475","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":263216,"discussion_content":"å¯ä»¥å‚è€ƒé˜¿é‡Œå¼€æºçš„ https://github.com/alibaba/transmittable-thread-local ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³çº¿ç¨‹æ± é€ä¼ TraceID è€Œç”Ÿçš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589188712,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113937,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/51/9d5cfadd.jpg","nickname":"å¥½è¿æ¥","note":"","ucode":"F469ED6CEFEF30","race_medal":1,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":221221,"discussion_content":"éå¸¸å¥½çš„é—®é¢˜ï¼Œæˆ‘ä¹Ÿæ˜¯é‡åˆ°è¿™æ ·çš„é—®é¢˜ä¸çŸ¥é“æ€ä¹ˆè§£å†³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585991193,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":217874,"user_name":"é’±","can_delete":false,"product_type":"c1","uid":1009652,"ip_address":"","ucode":"2C92A243A463D4","user_header":"https://static001.geekbang.org/account/avatar/00/0f/67/f4/9a1feb59.jpg","comment_is_top":false,"comment_ctime":1589635932,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"23064472412","product_id":100046201,"comment_content":"åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¦‚ä½•å¿«é€Ÿå®šä½é—®é¢˜ï¼š<br>1ï¼šä¾èµ–å…¬å¸è¿ç»´åŸºç¡€è®¾æ–½çš„å»ºè®¾ï¼Œæ¯”å¦‚ï¼šJDå„ç§å·¥å…·æ¯”è¾ƒå¥å…¨ï¼ŒæŸ¥æ—¥å¿—ã€æ–¹æ³•ç›‘æ§ã€å®¹å™¨ç›‘æ§ã€ç½‘ç»œç›‘æ§ç­‰ç­‰ï¼ŒåŸºç¡€ç»„ä»¶çš„é—®é¢˜å„ä¸ªè¿ç»´å›¢é˜Ÿæ”¯æŒä¹Ÿç»™åŠ›ï¼Œç³»ç»Ÿé—®é¢˜æ¯”è¾ƒå¥½æŸ¥ï¼Œè‡ªèº«ä¸šåŠ¡é—®é¢˜ä¾èµ–è‡ªèº«å¯¹è‡ªå·±ä¸šåŠ¡é€»è¾‘çš„ç†è§£ç¨‹åº¦ï¼Œåä¾‹â€”â€”å¦‚æœæŸ¥ä¸ªæ—¥å¿—ï¼Œéœ€è¦ç™»å½•ä¸­æ§æœºï¼Œå†ç™»å½•ç›®æ ‡æœºï¼Œè¿˜éœ€è¾“å…¥éªŒè¯ç ï¼‹å¯†ç ï¼Œç„¶åæ‰¾æ—¥å¿—è·¯å¾„ï¼Œç„¶åä½¿ç”¨å‘½ä»¤æŸ¥ï¼Œè¿™ç§æ–¹å¼åŸå§‹ä½æ•ˆ<br>2ï¼šå…¨é“¾è·¯è¿½è¸ªç³»ç»Ÿï¼Œç›®å‰è¿˜æ²¡çœ‹åˆ°åšçš„æ¯”è¾ƒå¥½çš„ï¼Œç†æƒ³å¾ˆä¸°æ»¡ç°å®å¾ˆéª¨æ„Ÿï¼Œå¦‚æœåšçš„å¥½ï¼Œå¯¹è®¸å¤šé—®é¢˜ç¡®å®èƒ½å¤Ÿåšåˆ°å¿«é€Ÿå®šä½ï¼Œå°¤å…¶æ˜¯æ€§èƒ½é—®é¢˜ï¼Œä¸€ä¸‹å­å°±çŸ¥é“è°æ…¢ã€‚å¦‚æœå„ä¸ªæ–¹æ³•éƒ½èƒ½ç»Ÿè®¡ï¼Œé‚£å°±æ›´æ£’äº†<br>3ï¼šæˆ‘ç›®å‰çš„ç»éªŒï¼Œå¯¹äºæ—¥å¿—å’Œå„ç§ç›‘æ§å·¥å…·ä¾èµ–æ¯”è¾ƒé‡ï¼Œå¦‚æœè¿™äº›OKï¼Œåˆæ˜¯ä¸šåŠ¡é—®é¢˜ï¼Œç†Ÿæ‚‰ä¸šåŠ¡å°±èƒ½å¾ˆå¿«å®šä½ã€‚æœ€ä¸å¥½å®šä½çš„æ˜¯ç³»ç»Ÿå¼‚å¸¸å°¤å…¶æ˜¯å’Œç½‘ç»œé€šä¿¡ç›¸å…³ä¸”ä¸å¥½å¤ç°çš„ï¼Œæœ€å¸¸è§çš„å°±æ˜¯å„ç§è¿æ¥è¶…æ—¶ã€socketè¶…æ—¶ã€è´Ÿè½½å¶å°”æŠ–åŠ¨ï¼Œå¾ˆä»¤äººå¤´ç–¼ã€‚ç½‘ç»œè®¤ä¸ºæ˜¯ç½‘ç»œæŠ–åŠ¨äº†ä¸€ä¸‹ï¼Œå°±ä¸äº†äº†ä¹‹å•¦ï¼å…·ä½“åŸå› åˆ™çŸ³æ²‰å¤§æµ·<br>4ï¼šRPCå°è£…ç›¸ä¿¡çš„æ—¥å¿—ç¡®å®éå¸¸é‡è¦ï¼Œä¸€ä¸‹å­å°±æ¸…æ¥šä¸ºä»€ä¹ˆäº†ï¼Œåä¾‹â€”â€”å¦‚æœè¿™äº›æ²¡æœ‰å°è£…å¥½ï¼Œå°±åªæœ‰ä¸€ä¸ªè¿æ¥è¶…æ—¶ï¼Œä¹Ÿä¸çŸ¥é“è°è°ƒè°ï¼Ÿé‚£ä¸ªæœåŠ¡å’Œæ–¹æ³•ï¼Ÿè¶…æ—¶è®¾ç½®å¤šå°‘å®é™…è€—è´¹å¤šå°‘ï¼Œé‚£è¿™ç§é—®é¢˜å°±ä¸”æŸ¥äº†<br>5ï¼šå…³é”®ä¸šåŠ¡æ—¥å¿—çš„æ‰“å°ä¹Ÿéå¸¸é‡è¦ï¼Œå¤šäº†è€—æ€§èƒ½è´¹ç©ºé—´ï¼Œå°‘äº†æ’æŸ¥é—®é¢˜ä¸åˆ©ï¼Œå¹¸å¥½Jdæ˜¯æœ‰UCCçš„å¯ä»¥æ§åˆ¶æ—¥å¿—æ‰“å°ï¼Œä¸è¿‡å…·ä½“æ‰“å°çš„OKä¸å¦è¿˜è¦çœ‹ä¸ªäººç»éªŒï¼‹ä»£ç è¯„å®¡","like_count":5},{"had_liked":false,"id":202658,"user_name":"é›¨éœ–é“ƒå£°å£°æ…¢","can_delete":false,"product_type":"c1","uid":1052607,"ip_address":"","ucode":"656D98310C6DA3","user_header":"https://static001.geekbang.org/account/avatar/00/10/0f/bf/ee93c4cf.jpg","comment_is_top":false,"comment_ctime":1586047768,"is_pvip":false,"replies":[{"id":"76830","content":"ç›‘æ§ç”¨æ—¶æ–¹æ¨å°‘","user_name":"ä½œè€…å›å¤","comment_id":202658,"uid":"1541007","ip_address":"","utype":1,"ctime":1586692073,"user_name_real":"ä½•å°é”‹"}],"discussion_count":1,"race_medal":0,"score":"14470949656","product_id":100046201,"comment_content":"åˆ†å¸ƒå¼é“¾è·¯ç³»ç»Ÿä¸­ï¼Œæœ€å¸¸ç”¨çš„è°ƒè¯•é—®é¢˜æ–¹æ³•è¿˜æ˜¯æ–‡ä¸­æåˆ°çš„æ–¹æ³•ï¼Œä¸»è¦ä¾èµ–åˆ†å¸ƒå¼è°ƒç”¨ç›‘æ§ç³»ç»Ÿï¼Œæ¯”å¦‚CATï¼Œä»é‡Œé¢å¯ä»¥çœ‹åˆ°æ˜¯å“ªä¸ªé“¾è·¯å‡ºé—®é¢˜äº†ã€‚","like_count":3,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490648,"discussion_content":"ç›‘æ§ç”¨æ—¶æ–¹æ¨å°‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586692073,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":297825,"user_name":"å°å¶","can_delete":false,"product_type":"c1","uid":1851730,"ip_address":"","ucode":"EFD624AD6B2686","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/ooYDTtTQHL9CZQmonDOQSC4Af9S4uqicXzUicOqEJqSOtHyOZ81PTpxcTqK5ibNHsaNWJIuHiaVcxB8gIo9RNXsshA/132","comment_is_top":false,"comment_ctime":1623805516,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5918772812","product_id":100046201,"comment_content":"é€šè¿‡æ—¥å¿—æ’é”™çš„è¯ï¼Œäº§ç”Ÿçš„æ—¥å¿—é‡æ˜¯å¾ˆå¤§çš„ï¼Œæƒ³é—®ä¸‹åœ¨é«˜å¹¶å‘ä¸‹æ—¥å¿—ä¼šä¸ä¼šæœ‰ä¹±åºçš„æƒ…å†µï¼Œrpcæ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜","like_count":1},{"had_liked":false,"id":359586,"user_name":"hillwater","can_delete":false,"product_type":"c1","uid":2826205,"ip_address":"ä¸Šæµ·","ucode":"FB16D5FCE8C7E6","user_header":"","comment_is_top":false,"comment_ctime":1665660820,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1665660820","product_id":100046201,"comment_content":"å…¨é“¾è·¯è¿½è¸ªæ¯”è¾ƒéº»çƒ¦çš„æ˜¯å„ç§ä¸­é—´ä»·çš„æ”¯æŒï¼Œä¾‹å¦‚dbï¼Œç¼“å­˜ï¼Œmq","like_count":0},{"had_liked":false,"id":348826,"user_name":"è¿œå¤©","can_delete":false,"product_type":"c1","uid":1235735,"ip_address":"","ucode":"406E3D19A945C9","user_header":"https://static001.geekbang.org/account/avatar/00/12/db/17/aee5d35a.jpg","comment_is_top":false,"comment_ctime":1655441810,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1655441810","product_id":100046201,"comment_content":"è€å¸ˆå¥½ï¼Œå®é™…ä½¿ç”¨skywalkingé“¾è·¯è¿½è¸ªé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä¸€ä¸ªtraceé‡Œé¢ AæœåŠ¡å¤šæ¬¡è°ƒç”¨Bï¼Œæ¯æ¬¡è°ƒç”¨åœ¨BæœåŠ¡æ‰“å°çš„traceIdéƒ½ä¸åŒï¼Œè¿™ä¸ªæ˜¯ä»€ä¹ˆåŸå› ä½ ä»¬ï¼Ÿ","like_count":0},{"had_liked":false,"id":341320,"user_name":"RPC","can_delete":false,"product_type":"c1","uid":2258068,"ip_address":"","ucode":"FF04573A1EA9DB","user_header":"","comment_is_top":false,"comment_ctime":1649518456,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1649518456","product_id":100046201,"comment_content":"1ã€çœ‹æ˜¯å¦èƒ½å¤ç°ï¼Œå¤ç°çš„ç›®çš„æ˜¯æ‹¿åˆ°TraceId<br>2ã€è§„èŒƒRPCé€šç”¨è¿”å›å€¼ç»“æœï¼ŒåŠ ä¸ŠTraceIdï¼Œå¯ä»¥åœ¨ELKæœç´¢å…³é”®çº¿ä¸ŠæŠ¥é”™ä¿¡æ¯æ‹¿åˆ°TraceId<br>3ã€æ‹¿åˆ°TraceIdåå»è°ƒç”¨é“¾å¹³å°æŸ¥çœ‹è¯¦æƒ…ï¼Œskywalkingæ˜¯çœŸçš„å¥½ç”¨ï¼Œå¯ä»¥çœ‹åˆ°æ–¹æ³•å‡ºå…¥å‚ã€æ¯ä¸ªæœåŠ¡ä¹‹é—´çš„è°ƒç”¨è€—æ—¶ã€SQLã€Redisè€—æ—¶éƒ½èƒ½çœ‹åˆ°ã€‚åè€Œé˜¿é‡Œå†…éƒ¨è¿™éƒ¨åˆ†åšçš„ä¸æ˜¯å¾ˆå¥½ï¼Œä¸è®ºæ˜¯å¯è§†åŒ–UIè¿˜æ˜¯ä½¿ç”¨æ„Ÿå—éƒ½ä¸å¥½ç”¨<br>4ã€CATç›‘æ§æ­é…ç½®å¥½æ—¥å¿—ä¸­çš„exceptionï¼Œå¯ä»¥ä»ä¸šåŠ¡æ–¹æ³•ç»´åº¦ç›´æ¥ç‚¹å‡»é”™è¯¯æ—¥å¿—é“¾æ¥åˆ°åˆ†å¸ƒå¼è°ƒç”¨é“¾åå°","like_count":0},{"had_liked":false,"id":334105,"user_name":"æ ¸æ¡ƒ","can_delete":false,"product_type":"c1","uid":1385204,"ip_address":"","ucode":"7AB05270CBCCCB","user_header":"https://static001.geekbang.org/account/avatar/00/15/22/f4/9fd6f8f0.jpg","comment_is_top":false,"comment_ctime":1644747121,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1644747121","product_id":100046201,"comment_content":"å…³äºæ—¥å¿—è¿™ä¸ªé—®é¢˜ï¼Œæ²¡æœ‰æ—¥å¿—å¾ˆå¯æ€•ï¼Œä½†æ˜¯æ—¥å¿—å¤ªå¤šäº†ä¹Ÿéº»çƒ¦ã€‚ä¾‹å¦‚ç”Ÿäº§ç¯å¢ƒï¼Œå¦‚æœåªæœ‰INFOçº§åˆ«çš„æ—¥å¿—ï¼Œæœ‰äº›æ—¥å¿—çº§åˆ«æ˜¯Debugçš„ï¼Œé‚£æ ·å°±çœ‹ä¸åˆ°äº†ï¼Œæ’æŸ¥é—®é¢˜å°±å¾ˆéš¾äº†ã€‚","like_count":0},{"had_liked":false,"id":290212,"user_name":"dog_brother","can_delete":false,"product_type":"c1","uid":1619597,"ip_address":"","ucode":"9F64D3C6D815FB","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er6OV33jHia3U9LYlZEx2HrpsELeh3KMlqFiaKpSAaaZeBttXRAVvDXUgcufpqJ60bJWGYGNpT7752w/132","comment_is_top":false,"comment_ctime":1619432282,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1619432282","product_id":100046201,"comment_content":"æˆ‘ä»¬æ˜¯C++çš„æœåŠ¡ï¼Œæ²¡æœ‰åˆé€‚çš„æ¡†æ¶ç”¨ï¼Œè€¦åˆåœ¨ä¸šåŠ¡ä¸­äº†ï¼Œå°½å¯èƒ½åœ°å¯¹å…¶è¿›è¡Œå°è£…äº†ã€‚","like_count":0,"discussions":[{"author":{"id":1439523,"avatar":"","nickname":"å¤§å¸…å“¥","note":"","ucode":"E6AE4804D9F337","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374190,"discussion_content":"tars æ¡†æ¶å°±æŒºå¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621057551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":270132,"user_name":"å•¸æ­Œ","can_delete":false,"product_type":"c1","uid":1113874,"ip_address":"","ucode":"D8C8963BB940F6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er2rgam9XfHbuSIZB4S3UG2GLrf9CLkiatDG62eEMicT4yprYdSAZET3kfqQBPxqBHkZw2KRhMdJX4Q/132","comment_is_top":false,"comment_ctime":1608947670,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1608947670","product_id":100046201,"comment_content":"è¿™å„¿æœ‰ä¸ªç–‘é—®å°±æ˜¯ï¼Œå¦‚æœåšåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªè¿›è¡ŒåŸ‹ç‚¹ï¼Œé‚£å°±è¦çº¦å®šå¥½æœåŠ¡ABCDéƒ½è¦è¿›è¡ŒåŸ‹ç‚¹ã€‚ä¸ç„¶å•ä¸€ABåšåŸ‹ç‚¹ä¹Ÿä¸è¡Œã€‚å¦å¤–ï¼ŒåŸ‹ç‚¹åªæ˜¯åšä¸ŠæŠ¥é”™è¯¯ä¿¡æ¯ï¼Œé‚£ä¹ˆ4ä¸ªæœåŠ¡çš„åŸ‹ç‚¹ä¿¡æ¯è¦ä¸ŠæŠ¥åŒä¸€ä¸ªåˆ†å¸ƒå¼é“¾è·¯è·Ÿè¸ªç³»ç»Ÿã€‚ç°å®æƒ…å†µæœ‰å¯èƒ½æ˜¯è¿™å››ä¸ªæœåŠ¡æœ‰å¯èƒ½æ˜¯å…¬å¸çš„å››ä¸ªéƒ¨é—¨ï¼Œè¿˜æœ‰å¯èƒ½æ˜¯æœåŠ¡åŒä¸€ä¸ªç”²æ–¹çš„å‡ ä¸ªä¸åŒçš„ä¹™æ–¹ã€‚æœ‰çš„æœåŠ¡æä¾›æ–¹å¯èƒ½ä¹Ÿä¸æ„¿æ„åœ¨åŸæ¥æˆç†Ÿçš„ç³»ç»Ÿä¸ŠåŠ è·Ÿè¸ªç³»ç»Ÿï¼Œå³ä¾¿éƒ½åŒæ„ï¼Œé‚£ä¹ˆç»Ÿä¸€çš„è·Ÿè¸ªç³»ç»Ÿåˆåœ¨å“ªå„¿åšå‘¢ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":2826205,"avatar":"","nickname":"hillwater","note":"","ucode":"FB16D5FCE8C7E6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":590328,"discussion_content":"åŒä¸€ä¸ªå…¬å¸çš„è¿˜å¥½ï¼Œä¸åŒå…¬å¸åŸºæœ¬å¾ˆéš¾","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1665661036,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"ä¸Šæµ·"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":212971,"user_name":"æ«å¶è“","can_delete":false,"product_type":"c1","uid":1892365,"ip_address":"","ucode":"EDA7E30E2BDB76","user_header":"https://static001.geekbang.org/account/avatar/00/1c/e0/0d/f4b1afa1.jpg","comment_is_top":false,"comment_ctime":1588251273,"is_pvip":false,"replies":[{"id":"79138","content":"ğŸ‘","user_name":"ä½œè€…å›å¤","comment_id":212971,"uid":"1541007","ip_address":"","utype":1,"ctime":1588405451,"user_name_real":"ä½•å°é”‹"}],"discussion_count":2,"race_medal":0,"score":"1588251273","product_id":100046201,"comment_content":"opentracing ï¼Œå°±æ˜¯éœ€è¦æ¥ç®¡ä¸šåŠ¡æµé‡æ‰è¡Œ","like_count":0,"discussions":[{"author":{"id":1541007,"avatar":"https://static001.geekbang.org/account/avatar/00/17/83/8f/8471d633.jpg","nickname":"ä½•å°é”‹","note":"","ucode":"E9B3B4A1B75D8B","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":493659,"discussion_content":"ğŸ‘","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588405451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2019657,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTIp0tia3HwHZDFcS2UkFzVGVbtMRX1XuhD1XdMs4E65w4HbesH99KfjtlKTQibAe6NzFAS88QXgxJHg/132","nickname":"Geek_949dc4","note":"","ucode":"FEFBF59EF09BFD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297677,"discussion_content":"æ¥ç®¡ä¸šåŠ¡æµé‡æ€ä¹ˆç†è§£ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597023328,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]}]}