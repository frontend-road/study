{"id":213604,"title":"08 | åˆ¤ç­‰é—®é¢˜ï¼šç¨‹åºé‡Œå¦‚ä½•ç¡®å®šä½ å°±æ˜¯ä½ ï¼Ÿ","content":"<p>ä½ å¥½ï¼Œæˆ‘æ˜¯æœ±æ™”ã€‚ä»Šå¤©ï¼Œæˆ‘æ¥å’Œä½ èŠèŠç¨‹åºé‡Œçš„åˆ¤ç­‰é—®é¢˜ã€‚</p><p>ä½ å¯èƒ½ä¼šè¯´ï¼Œåˆ¤ç­‰ä¸å°±æ˜¯ä¸€è¡Œä»£ç çš„äº‹æƒ…å—ï¼Œæœ‰ä»€ä¹ˆå¥½è¯´çš„ã€‚ä½†ï¼Œè¿™ä¸€è¡Œä»£ç å¦‚æœå¤„ç†ä¸å½“ï¼Œä¸ä»…ä¼šå‡ºç°Bugï¼Œè¿˜å¯èƒ½ä¼šå¼•èµ·å†…å­˜æ³„éœ²ç­‰é—®é¢˜ã€‚æ¶‰åŠåˆ¤ç­‰çš„Bugï¼Œå³ä½¿æ˜¯ä½¿ç”¨==è¿™ç§é”™è¯¯çš„åˆ¤ç­‰æ–¹å¼ï¼Œä¹Ÿä¸æ˜¯æ‰€æœ‰æ—¶å€™éƒ½ä¼šå‡ºé—®é¢˜ã€‚æ‰€ä»¥ç±»ä¼¼çš„åˆ¤ç­‰é—®é¢˜ä¸å¤ªå®¹æ˜“å‘ç°ï¼Œå¯èƒ½ä¼šè¢«éšè—å¾ˆä¹…ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘å°±equalsã€compareToå’ŒJavaçš„æ•°å€¼ç¼“å­˜ã€å­—ç¬¦ä¸²é©»ç•™ç­‰é—®é¢˜å±•å¼€è®¨è®ºï¼Œå¸Œæœ›ä½ å¯ä»¥ç†è§£å…¶åŸç†ï¼Œå½»åº•æ¶ˆé™¤ä¸šåŠ¡ä»£ç ä¸­çš„ç›¸å…³Bugã€‚</p><h2>æ³¨æ„equalså’Œ==çš„åŒºåˆ«</h2><p>åœ¨ä¸šåŠ¡ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨equalsæˆ–== è¿›è¡Œåˆ¤ç­‰æ“ä½œã€‚equalsæ˜¯æ–¹æ³•è€Œ==æ˜¯æ“ä½œç¬¦ï¼Œå®ƒä»¬çš„ä½¿ç”¨æ˜¯æœ‰åŒºåˆ«çš„ï¼š</p><ul>\n<li>å¯¹åŸºæœ¬ç±»å‹ï¼Œæ¯”å¦‚intã€longï¼Œè¿›è¡Œåˆ¤ç­‰ï¼Œåªèƒ½ä½¿ç”¨==ï¼Œæ¯”è¾ƒçš„æ˜¯ç›´æ¥å€¼ã€‚å› ä¸ºåŸºæœ¬ç±»å‹çš„å€¼å°±æ˜¯å…¶æ•°å€¼ã€‚</li>\n<li>å¯¹å¼•ç”¨ç±»å‹ï¼Œæ¯”å¦‚Integerã€Longå’ŒStringï¼Œè¿›è¡Œåˆ¤ç­‰ï¼Œéœ€è¦ä½¿ç”¨equalsè¿›è¡Œå†…å®¹åˆ¤ç­‰ã€‚å› ä¸ºå¼•ç”¨ç±»å‹çš„ç›´æ¥å€¼æ˜¯æŒ‡é’ˆï¼Œä½¿ç”¨==çš„è¯ï¼Œæ¯”è¾ƒçš„æ˜¯æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå¯¹è±¡åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œå³æ¯”è¾ƒå®ƒä»¬æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯æ¯”è¾ƒå¯¹è±¡çš„å†…å®¹ã€‚</li>\n</ul><p>è¿™å°±å¼•å‡ºäº†æˆ‘ä»¬å¿…é¡»å¿…é¡»è¦çŸ¥é“çš„ç¬¬ä¸€ä¸ªç»“è®ºï¼š<strong>æ¯”è¾ƒå€¼çš„å†…å®¹ï¼Œé™¤äº†åŸºæœ¬ç±»å‹åªèƒ½ä½¿ç”¨==å¤–ï¼Œå…¶ä»–ç±»å‹éƒ½éœ€è¦ä½¿ç”¨equals</strong>ã€‚</p><!-- [[[read_end]]] --><p>åœ¨å¼€ç¯‡æˆ‘æåˆ°äº†ï¼Œå³ä½¿ä½¿ç”¨==å¯¹Integeræˆ–Stringè¿›è¡Œåˆ¤ç­‰ï¼Œæœ‰äº›æ—¶å€™ä¹Ÿèƒ½å¾—åˆ°æ­£ç¡®ç»“æœã€‚è¿™åˆæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ç”¨ä¸‹é¢çš„æµ‹è¯•ç”¨ä¾‹æ·±å…¥ç ”ç©¶ä¸‹ï¼š</p><ul>\n<li>ä½¿ç”¨==å¯¹ä¸¤ä¸ªå€¼ä¸º127çš„ç›´æ¥èµ‹å€¼çš„Integerå¯¹è±¡åˆ¤ç­‰ï¼›</li>\n<li>ä½¿ç”¨==å¯¹ä¸¤ä¸ªå€¼ä¸º128çš„ç›´æ¥èµ‹å€¼çš„Integerå¯¹è±¡åˆ¤ç­‰ï¼›</li>\n<li>ä½¿ç”¨==å¯¹ä¸€ä¸ªå€¼ä¸º127çš„ç›´æ¥èµ‹å€¼çš„Integerå’Œå¦ä¸€ä¸ªé€šè¿‡new Integerå£°æ˜çš„å€¼ä¸º127çš„å¯¹è±¡åˆ¤ç­‰ï¼›</li>\n<li>ä½¿ç”¨==å¯¹ä¸¤ä¸ªé€šè¿‡new Integerå£°æ˜çš„å€¼ä¸º127çš„å¯¹è±¡åˆ¤ç­‰ï¼›</li>\n<li>ä½¿ç”¨==å¯¹ä¸€ä¸ªå€¼ä¸º128çš„ç›´æ¥èµ‹å€¼çš„Integerå¯¹è±¡å’Œå¦ä¸€ä¸ªå€¼ä¸º128çš„intåŸºæœ¬ç±»å‹åˆ¤ç­‰ã€‚</li>\n</ul><pre><code>Integer a = 127; //Integer.valueOf(127)\nInteger b = 127; //Integer.valueOf(127)\nlog.info(&quot;\\nInteger a = 127;\\n&quot; +\n        &quot;Integer b = 127;\\n&quot; +\n        &quot;a == b ? {}&quot;,a == b);    // true\n\nInteger c = 128; //Integer.valueOf(128)\nInteger d = 128; //Integer.valueOf(128)\nlog.info(&quot;\\nInteger c = 128;\\n&quot; +\n        &quot;Integer d = 128;\\n&quot; +\n        &quot;c == d ? {}&quot;, c == d);   //false\n\nInteger e = 127; //Integer.valueOf(127)\nInteger f = new Integer(127); //new instance\nlog.info(&quot;\\nInteger e = 127;\\n&quot; +\n        &quot;Integer f = new Integer(127);\\n&quot; +\n        &quot;e == f ? {}&quot;, e == f);   //false\n\nInteger g = new Integer(127); //new instance\nInteger h = new Integer(127); //new instance\nlog.info(&quot;\\nInteger g = new Integer(127);\\n&quot; +\n        &quot;Integer h = new Integer(127);\\n&quot; +\n        &quot;g == h ? {}&quot;, g == h);  //false\n\nInteger i = 128; //unbox\nint j = 128;\nlog.info(&quot;\\nInteger i = 128;\\n&quot; +\n        &quot;int j = 128;\\n&quot; +\n        &quot;i == j ? {}&quot;, i == j); //true\n</code></pre><p>é€šè¿‡è¿è¡Œç»“æœå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶çœ‹èµ·æ¥æ°¸è¿œæ˜¯åœ¨å¯¹127å’Œ127ã€128å’Œ128åˆ¤ç­‰ï¼Œä½†==å´æ²¡æœ‰æ°¸è¿œç»™æˆ‘ä»¬trueçš„ç­”å¤ã€‚åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>ç¬¬ä¸€ä¸ªæ¡ˆä¾‹ä¸­ï¼Œç¼–è¯‘å™¨ä¼šæŠŠInteger a = 127è½¬æ¢ä¸ºInteger.valueOf(127)ã€‚æŸ¥çœ‹æºç å¯ä»¥å‘ç°ï¼Œè¿™ä¸ª<strong>è½¬æ¢åœ¨å†…éƒ¨å…¶å®åšäº†ç¼“å­˜ï¼Œä½¿å¾—ä¸¤ä¸ªIntegeræŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡</strong>ï¼Œæ‰€ä»¥==è¿”å›trueã€‚</p><pre><code>public static Integer valueOf(int i) {\n    if (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)\n        return IntegerCache.cache[i + (-IntegerCache.low)];\n    return new Integer(i);\n}\n</code></pre><p>ç¬¬äºŒä¸ªæ¡ˆä¾‹ä¸­ï¼Œä¹‹æ‰€ä»¥åŒæ ·çš„ä»£ç 128å°±è¿”å›falseçš„åŸå› æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šç¼“å­˜[-128, 127]çš„æ•°å€¼ï¼Œè€Œ128å¤„äºè¿™ä¸ªåŒºé—´ä¹‹å¤–ã€‚è®¾ç½®JVMå‚æ•°åŠ ä¸Š-XX:AutoBoxCacheMax=1000å†è¯•è¯•ï¼Œæ˜¯ä¸æ˜¯å°±è¿”å›trueäº†å‘¢ï¼Ÿ</p><pre><code>private static class IntegerCache {\n    static final int low = -128;\n    static final int high;\n\n\n    static {\n        // high value may be configured by property\n        int h = 127;\n        String integerCacheHighPropValue =\n            sun.misc.VM.getSavedProperty(&quot;java.lang.Integer.IntegerCache.high&quot;);\n        if (integerCacheHighPropValue != null) {\n            try {\n                int i = parseInt(integerCacheHighPropValue);\n                i = Math.max(i, 127);\n                // Maximum array size is Integer.MAX_VALUE\n                h = Math.min(i, Integer.MAX_VALUE - (-low) -1);\n            } catch( NumberFormatException nfe) {\n                // If the property cannot be parsed into an int, ignore it.\n            }\n        }\n        high = h;\n\n\n        cache = new Integer[(high - low) + 1];\n        int j = low;\n        for(int k = 0; k &lt; cache.length; k++)\n            cache[k] = new Integer(j++);\n\n\n        // range [-128, 127] must be interned (JLS7 5.1.7)\n        assert IntegerCache.high &gt;= 127;\n    }\n}\n</code></pre><p>ç¬¬ä¸‰å’Œç¬¬å››ä¸ªæ¡ˆä¾‹ä¸­ï¼ŒNewå‡ºæ¥çš„Integerå§‹ç»ˆæ˜¯ä¸èµ°ç¼“å­˜çš„æ–°å¯¹è±¡ã€‚æ¯”è¾ƒä¸¤ä¸ªæ–°å¯¹è±¡ï¼Œæˆ–è€…æ¯”è¾ƒä¸€ä¸ªæ–°å¯¹è±¡å’Œä¸€ä¸ªæ¥è‡ªç¼“å­˜çš„å¯¹è±¡ï¼Œç»“æœè‚¯å®šä¸æ˜¯ç›¸åŒçš„å¯¹è±¡ï¼Œå› æ­¤è¿”å›falseã€‚</p><p>ç¬¬äº”ä¸ªæ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬æŠŠè£…ç®±çš„Integerå’ŒåŸºæœ¬ç±»å‹intæ¯”è¾ƒï¼Œå‰è€…ä¼šå…ˆæ‹†ç®±å†æ¯”è¾ƒï¼Œæ¯”è¾ƒçš„è‚¯å®šæ˜¯æ•°å€¼è€Œä¸æ˜¯å¼•ç”¨ï¼Œå› æ­¤è¿”å›trueã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œå¯¹äºIntegerä»€ä¹ˆæ—¶å€™æ˜¯ç›¸åŒå¯¹è±¡ä»€ä¹ˆæ—¶å€™æ˜¯ä¸åŒå¯¹è±¡ï¼Œå°±å¾ˆæ¸…æ¥šäº†å§ã€‚ä½†çŸ¥é“è¿™äº›å…¶å®æ„ä¹‰ä¸å¤§ï¼Œå› ä¸ºåœ¨å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸å…³å¿ƒIntegerå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªï¼Œ<strong>åªéœ€è¦è®°å¾—æ¯”è¾ƒIntegerçš„å€¼è¯·ä½¿ç”¨equalsï¼Œè€Œä¸æ˜¯==</strong>ï¼ˆå¯¹äºåŸºæœ¬ç±»å‹intçš„æ¯”è¾ƒå½“ç„¶åªèƒ½ä½¿ç”¨==ï¼‰ã€‚</p><p>å…¶å®ï¼Œæˆ‘ä»¬åº”è¯¥éƒ½çŸ¥é“è¿™ä¸ªåŸåˆ™ï¼Œåªæ˜¯æœ‰çš„æ—¶å€™ç‰¹åˆ«å®¹æ˜“å¿½ç•¥ã€‚ä»¥æˆ‘ä¹‹å‰é‡åˆ°è¿‡çš„ä¸€ä¸ªç”Ÿäº§äº‹æ•…ä¸ºä¾‹ï¼Œæœ‰è¿™ä¹ˆä¸€ä¸ªæšä¸¾å®šä¹‰äº†è®¢å•çŠ¶æ€å’Œå¯¹äºçŠ¶æ€çš„æè¿°ï¼š</p><pre><code>enum StatusEnum {\n    CREATED(1000, &quot;å·²åˆ›å»º&quot;),\n    PAID(1001, &quot;å·²æ”¯ä»˜&quot;),\n    DELIVERED(1002, &quot;å·²é€åˆ°&quot;),\n    FINISHED(1003, &quot;å·²å®Œæˆ&quot;);\n\n    private final Integer status; //æ³¨æ„è¿™é‡Œçš„Integer\n    private final String desc;\n\n    StatusEnum(Integer status, String desc) {\n        this.status = status;\n        this.desc = desc;\n    }\n}\n</code></pre><p>åœ¨ä¸šåŠ¡ä»£ç ä¸­ï¼Œå¼€å‘åŒå­¦ä½¿ç”¨äº†==å¯¹æšä¸¾å’Œå…¥å‚OrderQueryä¸­çš„statuså±æ€§è¿›è¡Œåˆ¤ç­‰ï¼š</p><pre><code>@Data\npublic class OrderQuery {\n    private Integer status;\n    private String name;\n}\n\n@PostMapping(&quot;enumcompare&quot;)\npublic void enumcompare(@RequestBody OrderQuery orderQuery){\n    StatusEnum statusEnum = StatusEnum.DELIVERED;\n    log.info(&quot;orderQuery:{} statusEnum:{} result:{}&quot;, orderQuery, statusEnum, statusEnum.status == orderQuery.getStatus());\n}\n</code></pre><p><strong>å› ä¸ºæšä¸¾å’Œå…¥å‚OrderQueryä¸­çš„statuséƒ½æ˜¯åŒ…è£…ç±»å‹ï¼Œæ‰€ä»¥é€šè¿‡==åˆ¤ç­‰è‚¯å®šæ˜¯æœ‰é—®é¢˜çš„ã€‚åªæ˜¯è¿™ä¸ªé—®é¢˜æ¯”è¾ƒéšæ™¦</strong>ï¼Œç©¶å…¶åŸå› åœ¨äºï¼š</p><ul>\n<li>åªçœ‹æšä¸¾çš„å®šä¹‰CREATED(1000, â€œå·²åˆ›å»ºâ€)ï¼Œå®¹æ˜“è®©äººè¯¯è§£statuså€¼æ˜¯åŸºæœ¬ç±»å‹ï¼›</li>\n<li>å› ä¸ºæœ‰Integerç¼“å­˜æœºåˆ¶çš„å­˜åœ¨ï¼Œæ‰€ä»¥ä½¿ç”¨==åˆ¤ç­‰å¹¶ä¸æ˜¯æ‰€æœ‰æƒ…å†µä¸‹éƒ½æœ‰é—®é¢˜ã€‚åœ¨è¿™æ¬¡äº‹æ•…ä¸­ï¼Œè®¢å•çŠ¶æ€çš„å€¼ä»100å¼€å§‹å¢é•¿ï¼Œç¨‹åºä¸€å¼€å§‹ä¸å‡ºé—®é¢˜ï¼Œç›´åˆ°è®¢å•çŠ¶æ€è¶…è¿‡127åæ‰å‡ºç°Bugã€‚</li>\n</ul><p>åœ¨äº†è§£æ¸…æ¥šä¸ºä»€ä¹ˆIntegerä½¿ç”¨==åˆ¤ç­‰æœ‰æ—¶å€™ä¹Ÿæœ‰æ•ˆçš„åŸå› ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ä¸ºä»€ä¹ˆStringä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä½¿ç”¨å‡ ä¸ªç”¨ä¾‹æ¥æµ‹è¯•ä¸‹ï¼š</p><ul>\n<li>å¯¹ä¸¤ä¸ªç›´æ¥å£°æ˜çš„å€¼éƒ½ä¸º1çš„Stringä½¿ç”¨==åˆ¤ç­‰ï¼›</li>\n<li>å¯¹ä¸¤ä¸ªnewå‡ºæ¥çš„å€¼éƒ½ä¸º2çš„Stringä½¿ç”¨==åˆ¤ç­‰ï¼›</li>\n<li>å¯¹ä¸¤ä¸ªnewå‡ºæ¥çš„å€¼éƒ½ä¸º3çš„Stringå…ˆè¿›è¡Œinternæ“ä½œï¼Œå†ä½¿ç”¨==åˆ¤ç­‰ï¼›</li>\n<li>å¯¹ä¸¤ä¸ªnewå‡ºæ¥çš„å€¼éƒ½ä¸º4çš„Stringé€šè¿‡equalsåˆ¤ç­‰ã€‚</li>\n</ul><pre><code>String a = &quot;1&quot;;\nString b = &quot;1&quot;;\nlog.info(&quot;\\nString a = \\&quot;1\\&quot;;\\n&quot; +\n        &quot;String b = \\&quot;1\\&quot;;\\n&quot; +\n        &quot;a == b ? {}&quot;, a == b); //true\n\nString c = new String(&quot;2&quot;);\nString d = new String(&quot;2&quot;);\nlog.info(&quot;\\nString c = new String(\\&quot;2\\&quot;);\\n&quot; +\n        &quot;String d = new String(\\&quot;2\\&quot;);&quot; +\n        &quot;c == d ? {}&quot;, c == d); //false\n\nString e = new String(&quot;3&quot;).intern();\nString f = new String(&quot;3&quot;).intern();\nlog.info(&quot;\\nString e = new String(\\&quot;3\\&quot;).intern();\\n&quot; +\n        &quot;String f = new String(\\&quot;3\\&quot;).intern();\\n&quot; +\n        &quot;e == f ? {}&quot;, e == f); //true\n\nString g = new String(&quot;4&quot;);\nString h = new String(&quot;4&quot;);\nlog.info(&quot;\\nString g = new String(\\&quot;4\\&quot;);\\n&quot; +\n        &quot;String h = new String(\\&quot;4\\&quot;);\\n&quot; +\n        &quot;g == h ? {}&quot;, g.equals(h)); //true\n</code></pre><p>åœ¨åˆ†æè¿™ä¸ªç»“æœä¹‹å‰ï¼Œæˆ‘å…ˆå’Œä½ è¯´è¯´Javaçš„å­—ç¬¦ä¸²å¸¸é‡æ± æœºåˆ¶ã€‚é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯å…¶è®¾è®¡åˆè¡·æ˜¯èŠ‚çœå†…å­˜ã€‚å½“ä»£ç ä¸­å‡ºç°åŒå¼•å·å½¢å¼åˆ›å»ºå­—ç¬¦ä¸²å¯¹è±¡æ—¶ï¼ŒJVMä¼šå…ˆå¯¹è¿™ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­˜åœ¨ç›¸åŒå†…å®¹çš„å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ï¼Œåˆ™å°†è¿™ä¸ªå¼•ç”¨è¿”å›ï¼›å¦åˆ™ï¼Œåˆ›å»ºæ–°çš„å­—ç¬¦ä¸²å¯¹è±¡ï¼Œç„¶åå°†è¿™ä¸ªå¼•ç”¨æ”¾å…¥å­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œå¹¶è¿”å›è¯¥å¼•ç”¨ã€‚è¿™ç§æœºåˆ¶ï¼Œå°±æ˜¯å­—ç¬¦ä¸²é©»ç•™æˆ–æ± åŒ–ã€‚</p><p>å†å›åˆ°åˆšæ‰çš„ä¾‹å­ï¼Œå†æ¥åˆ†æä¸€ä¸‹è¿è¡Œç»“æœï¼š</p><ul>\n<li>ç¬¬ä¸€ä¸ªæ¡ˆä¾‹è¿”å›trueï¼Œå› ä¸ºJavaçš„å­—ç¬¦ä¸²é©»ç•™æœºåˆ¶ï¼Œç›´æ¥ä½¿ç”¨åŒå¼•å·å£°æ˜å‡ºæ¥çš„ä¸¤ä¸ªStringå¯¹è±¡æŒ‡å‘å¸¸é‡æ± ä¸­çš„ç›¸åŒå­—ç¬¦ä¸²ã€‚</li>\n<li>ç¬¬äºŒä¸ªæ¡ˆä¾‹ï¼Œnewå‡ºæ¥çš„ä¸¤ä¸ªStringæ˜¯ä¸åŒå¯¹è±¡ï¼Œå¼•ç”¨å½“ç„¶ä¸åŒï¼Œæ‰€ä»¥å¾—åˆ°falseçš„ç»“æœã€‚</li>\n<li>ç¬¬ä¸‰ä¸ªæ¡ˆä¾‹ï¼Œä½¿ç”¨Stringæä¾›çš„internæ–¹æ³•ä¹Ÿä¼šèµ°å¸¸é‡æ± æœºåˆ¶ï¼Œæ‰€ä»¥åŒæ ·èƒ½å¾—åˆ°trueã€‚</li>\n<li>ç¬¬å››ä¸ªæ¡ˆä¾‹ï¼Œé€šè¿‡equalså¯¹å€¼å†…å®¹åˆ¤ç­‰ï¼Œæ˜¯æ­£ç¡®çš„å¤„ç†æ–¹å¼ï¼Œå½“ç„¶ä¼šå¾—åˆ°trueã€‚</li>\n</ul><p><strong>è™½ç„¶ä½¿ç”¨newå£°æ˜çš„å­—ç¬¦ä¸²è°ƒç”¨internæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è®©å­—ç¬¦ä¸²è¿›è¡Œé©»ç•™ï¼Œä½†åœ¨ä¸šåŠ¡ä»£ç ä¸­æ»¥ç”¨internï¼Œå¯èƒ½ä¼šäº§ç”Ÿæ€§èƒ½é—®é¢˜</strong>ã€‚</p><p>å†™ä»£ç æµ‹è¯•ä¸€ä¸‹ï¼Œé€šè¿‡å¾ªç¯æŠŠ1åˆ°1000ä¸‡ä¹‹é—´çš„æ•°å­—ä»¥å­—ç¬¦ä¸²å½¢å¼internåï¼Œå­˜å…¥ä¸€ä¸ªListï¼š</p><pre><code>List&lt;String&gt; list = new ArrayList&lt;&gt;();\n\n@GetMapping(&quot;internperformance&quot;)\npublic int internperformance(@RequestParam(value = &quot;size&quot;, defaultValue = &quot;10000000&quot;)int size) {\n    //-XX:+PrintStringTableStatistics\n    //-XX:StringTableSize=10000000\n    long begin = System.currentTimeMillis();\n    list = IntStream.rangeClosed(1, size)\n            .mapToObj(i-&gt; String.valueOf(i).intern())\n            .collect(Collectors.toList());\n    log.info(&quot;size:{} took:{}&quot;, size, System.currentTimeMillis() - begin);\n    return list.size();\n}\n</code></pre><p>åœ¨å¯åŠ¨ç¨‹åºæ—¶è®¾ç½®JVMå‚æ•°-XX:+PrintStringTableStatisticï¼Œç¨‹åºé€€å‡ºæ—¶å¯ä»¥æ‰“å°å‡ºå­—ç¬¦ä¸²å¸¸é‡è¡¨çš„ç»Ÿè®¡ä¿¡æ¯ã€‚è°ƒç”¨æ¥å£åå…³é—­ç¨‹åºï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><pre><code>[11:01:57.770] [http-nio-45678-exec-2] [INFO ] [.t.c.e.d.IntAndStringEqualController:54  ] - size:10000000 took:44907\nStringTable statistics:\nNumber of buckets       :     60013 =    480104 bytes, avg   8.000\nNumber of entries       :  10030230 = 240725520 bytes, avg  24.000\nNumber of literals      :  10030230 = 563005568 bytes, avg  56.131\nTotal footprint         :           = 804211192 bytes\nAverage bucket size     :   167.134\nVariance of bucket size :    55.808\nStd. dev. of bucket size:     7.471\nMaximum bucket size     :       198\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ1000ä¸‡æ¬¡internæ“ä½œè€—æ—¶å±…ç„¶è¶…è¿‡äº†44ç§’ã€‚</p><p>å…¶å®ï¼ŒåŸå› åœ¨äºå­—ç¬¦ä¸²å¸¸é‡æ± æ˜¯ä¸€ä¸ªå›ºå®šå®¹é‡çš„Mapã€‚å¦‚æœå®¹é‡å¤ªå°ï¼ˆNumber of buckets=60013ï¼‰ã€å­—ç¬¦ä¸²å¤ªå¤šï¼ˆ1000ä¸‡ä¸ªå­—ç¬¦ä¸²ï¼‰ï¼Œé‚£ä¹ˆæ¯ä¸€ä¸ªæ¡¶ä¸­çš„å­—ç¬¦ä¸²æ•°é‡ä¼šéå¸¸å¤šï¼Œæ‰€ä»¥æœç´¢èµ·æ¥å°±å¾ˆæ…¢ã€‚è¾“å‡ºç»“æœä¸­çš„Average bucket size=167ï¼Œä»£è¡¨äº†Mapä¸­æ¡¶çš„å¹³å‡é•¿åº¦æ˜¯167ã€‚</p><p>è§£å†³æ–¹å¼æ˜¯ï¼Œè®¾ç½®JVMå‚æ•°-XX:StringTableSizeï¼ŒæŒ‡å®šæ›´å¤šçš„æ¡¶ã€‚è®¾ç½®-XX:StringTableSize=10000000åï¼Œé‡å¯åº”ç”¨ï¼š</p><pre><code>[11:09:04.475] [http-nio-45678-exec-1] [INFO ] [.t.c.e.d.IntAndStringEqualController:54  ] - size:10000000 took:5557\nStringTable statistics:\nNumber of buckets       :  10000000 =  80000000 bytes, avg   8.000\nNumber of entries       :  10030156 = 240723744 bytes, avg  24.000\nNumber of literals      :  10030156 = 562999472 bytes, avg  56.131\nTotal footprint         :           = 883723216 bytes\nAverage bucket size     :     1.003\nVariance of bucket size :     1.587\nStd. dev. of bucket size:     1.260\nMaximum bucket size     :        10\n</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œ1000ä¸‡æ¬¡è°ƒç”¨è€—æ—¶åªæœ‰5.5ç§’ï¼ŒAverage bucket sizeé™åˆ°äº†1ï¼Œæ•ˆæœæ˜æ˜¾ã€‚</p><p>å¥½äº†ï¼Œæ˜¯æ—¶å€™ç»™å‡ºç¬¬äºŒåŸåˆ™äº†ï¼š<strong>æ²¡äº‹åˆ«è½»æ˜“ç”¨internï¼Œå¦‚æœè¦ç”¨ä¸€å®šè¦æ³¨æ„æ§åˆ¶é©»ç•™çš„å­—ç¬¦ä¸²çš„æ•°é‡ï¼Œå¹¶ç•™æ„å¸¸é‡è¡¨çš„å„é¡¹æŒ‡æ ‡</strong>ã€‚</p><h2>å®ç°ä¸€ä¸ªequalsæ²¡æœ‰è¿™ä¹ˆç®€å•</h2><p>å¦‚æœçœ‹è¿‡Objectç±»æºç ï¼Œä½ å¯èƒ½å°±çŸ¥é“ï¼Œequalsçš„å®ç°å…¶å®æ˜¯æ¯”è¾ƒå¯¹è±¡å¼•ç”¨ï¼š</p><pre><code>public boolean equals(Object obj) {\n    return (this == obj);\n}\n</code></pre><p>ä¹‹æ‰€ä»¥Integeræˆ–Stringèƒ½é€šè¿‡equalså®ç°å†…å®¹åˆ¤ç­‰ï¼Œæ˜¯å› ä¸ºå®ƒä»¬éƒ½é‡å†™äº†è¿™ä¸ªæ–¹æ³•ã€‚æ¯”å¦‚ï¼ŒStringçš„equalsçš„å®ç°ï¼š</p><pre><code>public boolean equals(Object anObject) {\n    if (this == anObject) {\n        return true;\n    }\n    if (anObject instanceof String) {\n        String anotherString = (String)anObject;\n        int n = value.length;\n        if (n == anotherString.value.length) {\n            char v1[] = value;\n            char v2[] = anotherString.value;\n            int i = 0;\n            while (n-- != 0) {\n                if (v1[i] != v2[i])\n                    return false;\n                i++;\n            }\n            return true;\n        }\n    }\n    return false;\n}\n</code></pre><p>å¯¹äºè‡ªå®šä¹‰ç±»å‹ï¼Œå¦‚æœä¸é‡å†™equalsçš„è¯ï¼Œé»˜è®¤å°±æ˜¯ä½¿ç”¨ObjectåŸºç±»çš„æŒ‰å¼•ç”¨çš„æ¯”è¾ƒæ–¹å¼ã€‚æˆ‘ä»¬å†™ä¸€ä¸ªè‡ªå®šä¹‰ç±»æµ‹è¯•ä¸€ä¸‹ã€‚</p><p>å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªæè¿°ç‚¹çš„ç±»Pointï¼Œæœ‰xã€yå’Œæè¿°ä¸‰ä¸ªå±æ€§ï¼š</p><pre><code>class Point {\n    private int x;\n    private int y;\n    private final String desc;\n\n    public Point(int x, int y, String desc) {\n        this.x = x;\n        this.y = y;\n        this.desc = desc;\n    }\n}\n</code></pre><p>å®šä¹‰ä¸‰ä¸ªç‚¹p1ã€p2å’Œp3ï¼Œå…¶ä¸­p1å’Œp2çš„æè¿°å±æ€§ä¸åŒï¼Œp1å’Œp3çš„ä¸‰ä¸ªå±æ€§å®Œå…¨ç›¸åŒï¼Œå¹¶å†™ä¸€æ®µä»£ç æµ‹è¯•ä¸€ä¸‹é»˜è®¤è¡Œä¸ºï¼š</p><pre><code>Point p1 = new Point(1, 2, &quot;a&quot;);\nPoint p2 = new Point(1, 2, &quot;b&quot;);\nPoint p3 = new Point(1, 2, &quot;a&quot;);\nlog.info(&quot;p1.equals(p2) ? {}&quot;, p1.equals(p2));\nlog.info(&quot;p1.equals(p3) ? {}&quot;, p1.equals(p3));\n</code></pre><p>é€šè¿‡equalsæ–¹æ³•æ¯”è¾ƒp1å’Œp2ã€p1å’Œp3å‡å¾—åˆ°falseï¼ŒåŸå› æ­£å¦‚åˆšæ‰æ‰€è¯´ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä¸ºPointç±»å®ç°è‡ªå®šä¹‰çš„equalsæ–¹æ³•ï¼ŒObjectè¶…ç±»ä¸­çš„equalsé»˜è®¤ä½¿ç”¨==åˆ¤ç­‰ï¼Œæ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ã€‚</p><p>æˆ‘ä»¬æœŸæœ›çš„é€»è¾‘æ˜¯ï¼Œåªè¦xå’Œyè¿™2ä¸ªå±æ€§ä¸€è‡´å°±ä»£è¡¨æ˜¯åŒä¸€ä¸ªç‚¹ï¼Œæ‰€ä»¥å†™å‡ºäº†å¦‚ä¸‹çš„æ”¹è¿›ä»£ç ï¼Œé‡å†™equalsæ–¹æ³•ï¼ŒæŠŠå‚æ•°ä¸­çš„Objectè½¬æ¢ä¸ºPointæ¯”è¾ƒå…¶xå’Œyå±æ€§ï¼š</p><pre><code>class PointWrong {\n    private int x;\n    private int y;\n    private final String desc;\n\n    public PointWrong(int x, int y, String desc) {\n        this.x = x;\n        this.y = y;\n        this.desc = desc;\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        PointWrong that = (PointWrong) o;\n        return x == that.x &amp;&amp; y == that.y;\n    }\n}\n</code></pre><p>ä¸ºæµ‹è¯•æ”¹è¿›åçš„Pointæ˜¯å¦å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸‰ä¸ªç”¨ä¾‹ï¼š</p><ul>\n<li>æ¯”è¾ƒä¸€ä¸ªPointå¯¹è±¡å’Œnullï¼›</li>\n<li>æ¯”è¾ƒä¸€ä¸ªObjectå¯¹è±¡å’Œä¸€ä¸ªPointå¯¹è±¡ï¼›</li>\n<li>æ¯”è¾ƒä¸¤ä¸ªxå’Œyå±æ€§å€¼ç›¸åŒçš„Pointå¯¹è±¡ã€‚</li>\n</ul><pre><code>PointWrong p1 = new PointWrong(1, 2, &quot;a&quot;);\ntry {\n    log.info(&quot;p1.equals(null) ? {}&quot;, p1.equals(null));\n} catch (Exception ex) {\n    log.error(ex.getMessage());\n}\n\nObject o = new Object();\ntry {\n    log.info(&quot;p1.equals(expression) ? {}&quot;, p1.equals(o));\n} catch (Exception ex) {\n    log.error(ex.getMessage());\n}\n\nPointWrong p2 = new PointWrong(1, 2, &quot;b&quot;);\nlog.info(&quot;p1.equals(p2) ? {}&quot;, p1.equals(p2));\n</code></pre><p>é€šè¿‡æ—¥å¿—ä¸­çš„ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸€æ¬¡æ¯”è¾ƒå‡ºç°äº†ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œç¬¬äºŒæ¬¡æ¯”è¾ƒå‡ºç°äº†ç±»å‹è½¬æ¢å¼‚å¸¸ï¼Œç¬¬ä¸‰æ¬¡æ¯”è¾ƒç¬¦åˆé¢„æœŸè¾“å‡ºäº†trueã€‚</p><pre><code>[17:54:39.120] [http-nio-45678-exec-1] [ERROR] [t.c.e.demo1.EqualityMethodController:32  ] - java.lang.NullPointerException\n[17:54:39.120] [http-nio-45678-exec-1] [ERROR] [t.c.e.demo1.EqualityMethodController:39  ] - java.lang.ClassCastException: java.lang.Object cannot be cast to org.geekbang.time.commonmistakes.equals.demo1.EqualityMethodController$PointWrong\n[17:54:39.120] [http-nio-45678-exec-1] [INFO ] [t.c.e.demo1.EqualityMethodController:43  ] - p1.equals(p2) ? true\n</code></pre><p><strong>é€šè¿‡è¿™äº›å¤±æ•ˆçš„ç”¨ä¾‹ï¼Œæˆ‘ä»¬å¤§æ¦‚å¯ä»¥æ€»ç»“å‡ºå®ç°ä¸€ä¸ªæ›´å¥½çš„equalsåº”è¯¥æ³¨æ„çš„ç‚¹ï¼š</strong></p><ul>\n<li>è€ƒè™‘åˆ°æ€§èƒ½ï¼Œå¯ä»¥å…ˆè¿›è¡ŒæŒ‡é’ˆåˆ¤ç­‰ï¼Œå¦‚æœå¯¹è±¡æ˜¯åŒä¸€ä¸ªé‚£ä¹ˆç›´æ¥è¿”å›trueï¼›</li>\n<li>éœ€è¦å¯¹å¦ä¸€æ–¹è¿›è¡Œåˆ¤ç©ºï¼Œç©ºå¯¹è±¡å’Œè‡ªèº«è¿›è¡Œæ¯”è¾ƒï¼Œç»“æœä¸€å®šæ˜¯fasleï¼›</li>\n<li>éœ€è¦åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œå¦‚æœç±»å‹éƒ½ä¸åŒï¼Œé‚£ä¹ˆç›´æ¥è¿”å›falseï¼›</li>\n<li>ç¡®ä¿ç±»å‹ç›¸åŒçš„æƒ…å†µä¸‹å†è¿›è¡Œç±»å‹å¼ºåˆ¶è½¬æ¢ï¼Œç„¶åé€ä¸€åˆ¤æ–­æ‰€æœ‰å­—æ®µã€‚</li>\n</ul><p>ä¿®å¤å’Œæ”¹è¿›åçš„equalsæ–¹æ³•å¦‚ä¸‹ï¼š</p><pre><code>@Override\npublic boolean equals(Object o) {\n    if (this == o) return true;\n    if (o == null || getClass() != o.getClass()) return false;\n    PointRight that = (PointRight) o;\n    return x == that.x &amp;&amp; y == that.y;\n}\t\t\n</code></pre><p>æ”¹è¿›åçš„equalsçœ‹èµ·æ¥å®Œç¾äº†ï¼Œä½†è¿˜æ²¡å®Œã€‚æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ã€‚</p><h2>hashCodeå’Œequalsè¦é…å¯¹å®ç°</h2><p>æˆ‘ä»¬æ¥è¯•è¯•ä¸‹é¢è¿™ä¸ªç”¨ä¾‹ï¼Œå®šä¹‰ä¸¤ä¸ªxå’Œyå±æ€§å€¼å®Œå…¨ä¸€è‡´çš„Pointå¯¹è±¡p1å’Œp2ï¼ŒæŠŠp1åŠ å…¥HashSetï¼Œç„¶ååˆ¤æ–­è¿™ä¸ªSetä¸­æ˜¯å¦å­˜åœ¨p2ï¼š</p><pre><code>PointWrong p1 = new PointWrong(1, 2, &quot;a&quot;);\nPointWrong p2 = new PointWrong(1, 2, &quot;b&quot;);\n\nHashSet&lt;PointWrong&gt; points = new HashSet&lt;&gt;();\npoints.add(p1);\nlog.info(&quot;points.contains(p2) ? {}&quot;, points.contains(p2));\n</code></pre><p>æŒ‰ç…§æ”¹è¿›åçš„equalsæ–¹æ³•ï¼Œè¿™2ä¸ªå¯¹è±¡å¯ä»¥è®¤ä¸ºæ˜¯åŒä¸€ä¸ªï¼ŒSetä¸­å·²ç»å­˜åœ¨äº†p1å°±åº”è¯¥åŒ…å«p2ï¼Œä½†ç»“æœå´æ˜¯falseã€‚</p><p>å‡ºç°è¿™ä¸ªBugçš„åŸå› æ˜¯ï¼Œæ•£åˆ—è¡¨éœ€è¦ä½¿ç”¨hashCodeæ¥å®šä½å…ƒç´ æ”¾åˆ°å“ªä¸ªæ¡¶ã€‚å¦‚æœè‡ªå®šä¹‰å¯¹è±¡æ²¡æœ‰å®ç°è‡ªå®šä¹‰çš„hashCodeæ–¹æ³•ï¼Œå°±ä¼šä½¿ç”¨Objectè¶…ç±»çš„é»˜è®¤å®ç°ï¼Œ<strong>å¾—åˆ°çš„ä¸¤ä¸ªhashCodeæ˜¯ä¸åŒçš„ï¼Œå¯¼è‡´æ— æ³•æ»¡è¶³éœ€æ±‚</strong>ã€‚</p><p>è¦è‡ªå®šä¹‰hashCodeï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨Objects.hashæ–¹æ³•æ¥å®ç°ï¼Œæ”¹è¿›åçš„Pointç±»å¦‚ä¸‹ï¼š</p><pre><code>class PointRight {\n    private final int x;\n    private final int y;\n    private final String desc;\n    ...\n    @Override\n    public boolean equals(Object o) {\n        ...\n    }\n\n    @Override\n    public int hashCode() {\n        return Objects.hash(x, y);\n    }\n}\n</code></pre><p>æ”¹è¿›equalså’ŒhashCodeåï¼Œå†æµ‹è¯•ä¸‹ä¹‹å‰çš„å››ä¸ªç”¨ä¾‹ï¼Œç»“æœå…¨éƒ¨ç¬¦åˆé¢„æœŸã€‚</p><pre><code>[18:25:23.091] [http-nio-45678-exec-4] [INFO ] [t.c.e.demo1.EqualityMethodController:54  ] - p1.equals(null) ? false\n[18:25:23.093] [http-nio-45678-exec-4] [INFO ] [t.c.e.demo1.EqualityMethodController:61  ] - p1.equals(expression) ? false\n[18:25:23.094] [http-nio-45678-exec-4] [INFO ] [t.c.e.demo1.EqualityMethodController:67  ] - p1.equals(p2) ? true\n[18:25:23.094] [http-nio-45678-exec-4] [INFO ] [t.c.e.demo1.EqualityMethodController:71  ] - points.contains(p2) ? true\n</code></pre><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ å¯èƒ½ä¼šè§‰å¾—è‡ªå·±å®ç°equalså’ŒhashCodeå¾ˆéº»çƒ¦ï¼Œå®ç°equalsæœ‰å¾ˆå¤šæ³¨æ„ç‚¹è€Œä¸”ä»£ç é‡å¾ˆå¤§ã€‚ä¸è¿‡ï¼Œå®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ä¹Ÿæœ‰ç®€å•çš„æ–¹å¼ï¼Œä¸€æ˜¯åé¢è¦è®²åˆ°çš„Lombokæ–¹æ³•ï¼ŒäºŒæ˜¯ä½¿ç”¨IDEçš„ä»£ç ç”ŸæˆåŠŸèƒ½ã€‚IDEAçš„ç±»ä»£ç å¿«æ·ç”Ÿæˆèœå•æ”¯æŒçš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/94/36/944fe3549e4c24936e9837d0bf1e3936.jpg?wh=2284*2014\" alt=\"\"></p><h2>æ³¨æ„compareToå’Œequalsçš„é€»è¾‘ä¸€è‡´æ€§</h2><p>é™¤äº†è‡ªå®šä¹‰ç±»å‹éœ€è¦ç¡®ä¿equalså’ŒhashCodeè¦é€»è¾‘ä¸€è‡´å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ›´å®¹æ˜“è¢«å¿½ç•¥çš„é—®é¢˜ï¼Œå³compareToåŒæ ·éœ€è¦å’Œequalsç¡®ä¿é€»è¾‘ä¸€è‡´æ€§ã€‚</p><p>æˆ‘ä¹‹å‰é‡åˆ°è¿‡è¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼Œä»£ç é‡Œæœ¬æ¥ä½¿ç”¨äº†ArrayListçš„indexOfæ–¹æ³•è¿›è¡Œå…ƒç´ æœç´¢ï¼Œä½†æ˜¯ä¸€ä½å¥½å¿ƒçš„å¼€å‘åŒå­¦è§‰å¾—é€ä¸€æ¯”è¾ƒçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œæ•ˆç‡å¤ªä½äº†ï¼Œäºæ˜¯æ”¹ä¸ºäº†æ’åºåé€šè¿‡Collections.binarySearchæ–¹æ³•è¿›è¡Œæœç´¢ï¼Œå®ç°äº†O(log n)çš„æ—¶é—´å¤æ‚åº¦ã€‚æ²¡æƒ³åˆ°ï¼Œè¿™ä¹ˆä¸€æ”¹å´å‡ºç°äº†Bugã€‚</p><p>æˆ‘ä»¬æ¥é‡ç°ä¸‹è¿™ä¸ªé—®é¢˜ã€‚é¦–å…ˆï¼Œå®šä¹‰ä¸€ä¸ªStudentç±»ï¼Œæœ‰idå’Œnameä¸¤ä¸ªå±æ€§ï¼Œå¹¶å®ç°äº†ä¸€ä¸ªComparableæ¥å£æ¥è¿”å›ä¸¤ä¸ªidçš„å€¼ï¼š</p><pre><code>@Data\n@AllArgsConstructor\nclass Student implements Comparable&lt;Student&gt;{\n    private int id;\n    private String name;\n\n    @Override\n    public int compareTo(Student other) {\n        int result = Integer.compare(other.id, id);\n        if (result==0)\n            log.info(&quot;this {} == other {}&quot;, this, other);\n        return result;\n    }\n}\n</code></pre><p>ç„¶åï¼Œå†™ä¸€æ®µæµ‹è¯•ä»£ç åˆ†åˆ«é€šè¿‡indexOfæ–¹æ³•å’ŒCollections.binarySearchæ–¹æ³•è¿›è¡Œæœç´¢ã€‚åˆ—è¡¨ä¸­æˆ‘ä»¬å­˜æ”¾äº†ä¸¤ä¸ªå­¦ç”Ÿï¼Œç¬¬ä¸€ä¸ªå­¦ç”Ÿidæ˜¯1å«zhangï¼Œç¬¬äºŒä¸ªå­¦ç”Ÿidæ˜¯2å«wangï¼Œæœç´¢è¿™ä¸ªåˆ—è¡¨æ˜¯å¦å­˜åœ¨ä¸€ä¸ªidæ˜¯2å«liçš„å­¦ç”Ÿï¼š</p><pre><code>@GetMapping(&quot;wrong&quot;)\npublic void wrong(){\n\n    List&lt;Student&gt; list = new ArrayList&lt;&gt;();\n    list.add(new Student(1, &quot;zhang&quot;));\n    list.add(new Student(2, &quot;wang&quot;));\n    Student student = new Student(2, &quot;li&quot;);\n\n    log.info(&quot;ArrayList.indexOf&quot;);\n    int index1 = list.indexOf(student);\n    Collections.sort(list);\n    log.info(&quot;Collections.binarySearch&quot;);\n    int index2 = Collections.binarySearch(list, student);\n\n    log.info(&quot;index1 = &quot; + index1);\n    log.info(&quot;index2 = &quot; + index2);\n}\n</code></pre><p>ä»£ç è¾“å‡ºçš„æ—¥å¿—å¦‚ä¸‹ï¼š</p><pre><code>[18:46:50.226] [http-nio-45678-exec-1] [INFO ] [t.c.equals.demo2.CompareToController:28  ] - ArrayList.indexOf\n[18:46:50.226] [http-nio-45678-exec-1] [INFO ] [t.c.equals.demo2.CompareToController:31  ] - Collections.binarySearch\n[18:46:50.227] [http-nio-45678-exec-1] [INFO ] [t.c.equals.demo2.CompareToController:67  ] - this CompareToController.Student(id=2, name=wang) == other CompareToController.Student(id=2, name=li)\n[18:46:50.227] [http-nio-45678-exec-1] [INFO ] [t.c.equals.demo2.CompareToController:34  ] - index1 = -1\n[18:46:50.227] [http-nio-45678-exec-1] [INFO ] [t.c.equals.demo2.CompareToController:35  ] - index2 = 1\n</code></pre><p>æˆ‘ä»¬æ³¨æ„åˆ°å¦‚ä¸‹å‡ ç‚¹ï¼š</p><ul>\n<li><strong>binarySearchæ–¹æ³•å†…éƒ¨è°ƒç”¨äº†å…ƒç´ çš„compareToæ–¹æ³•è¿›è¡Œæ¯”è¾ƒ</strong>ï¼›</li>\n<li>indexOfçš„ç»“æœæ²¡é—®é¢˜ï¼Œåˆ—è¡¨ä¸­æœç´¢ä¸åˆ°idä¸º2ã€nameæ˜¯liçš„å­¦ç”Ÿï¼›</li>\n<li>binarySearchè¿”å›äº†ç´¢å¼•1ï¼Œä»£è¡¨æœç´¢åˆ°çš„ç»“æœæ˜¯idä¸º2ï¼Œnameæ˜¯wangçš„å­¦ç”Ÿã€‚</li>\n</ul><p>ä¿®å¤æ–¹å¼å¾ˆç®€å•ï¼Œç¡®ä¿compareToçš„æ¯”è¾ƒé€»è¾‘å’Œequalsçš„å®ç°ä¸€è‡´å³å¯ã€‚é‡æ–°å®ç°ä¸€ä¸‹Studentç±»ï¼Œé€šè¿‡Comparator.comparingè¿™ä¸ªä¾¿æ·çš„æ–¹æ³•æ¥å®ç°ä¸¤ä¸ªå­—æ®µçš„æ¯”è¾ƒï¼š</p><pre><code>@Data\n@AllArgsConstructor\nclass StudentRight implements Comparable&lt;StudentRight&gt;{\n    private int id;\n    private String name;\n\n    @Override\n    public int compareTo(StudentRight other) {\n        return Comparator.comparing(StudentRight::getName)\n                .thenComparingInt(StudentRight::getId)\n                .compare(this, other);\n    }\n}\n</code></pre><p>å…¶å®ï¼Œè¿™ä¸ªé—®é¢˜å®¹æ˜“è¢«å¿½ç•¥çš„åŸå› åœ¨äºä¸¤æ–¹é¢ï¼š</p><ul>\n<li>ä¸€æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Lombokçš„@Dataæ ‡è®°äº†Studentï¼Œ@Dataæ³¨è§£ï¼ˆè¯¦è§<a href=\"https://projectlombok.org/features/Data\">è¿™é‡Œ</a>ï¼‰å…¶å®åŒ…å«äº†@EqualsAndHashCodeæ³¨è§£ï¼ˆè¯¦è§<a href=\"https://projectlombok.org/features/EqualsAndHashCode\">è¿™é‡Œ</a>ï¼‰çš„ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨ç±»å‹æ‰€æœ‰çš„å­—æ®µï¼ˆä¸åŒ…æ‹¬staticå’Œtransientå­—æ®µï¼‰å‚ä¸åˆ°equalså’ŒhashCodeæ–¹æ³•çš„å®ç°ä¸­ã€‚å› ä¸ºè¿™ä¸¤ä¸ªæ–¹æ³•çš„å®ç°ä¸æ˜¯æˆ‘ä»¬è‡ªå·±å®ç°çš„ï¼Œæ‰€ä»¥å®¹æ˜“å¿½ç•¥å…¶é€»è¾‘ã€‚</li>\n<li>äºŒæ˜¯ï¼ŒcompareToæ–¹æ³•éœ€è¦è¿”å›æ•°å€¼ï¼Œä½œä¸ºæ’åºçš„ä¾æ®ï¼Œå®¹æ˜“è®©äººä½¿ç”¨æ•°å€¼ç±»å‹çš„å­—æ®µéšæ„å®ç°ã€‚</li>\n</ul><p>æˆ‘å†å¼ºè°ƒä¸‹ï¼Œ<strong>å¯¹äºè‡ªå®šä¹‰çš„ç±»å‹ï¼Œå¦‚æœè¦å®ç°Comparableï¼Œè¯·è®°å¾—equalsã€hashCodeã€compareToä¸‰è€…é€»è¾‘ä¸€è‡´</strong>ã€‚</p><h2>å°å¿ƒLombokç”Ÿæˆä»£ç çš„â€œå‘â€</h2><p>Lombokçš„@Dataæ³¨è§£ä¼šå¸®æˆ‘ä»¬å®ç°equalså’Œhashcodeæ–¹æ³•ï¼Œä½†æ˜¯æœ‰ç»§æ‰¿å…³ç³»æ—¶ï¼ŒLombokè‡ªåŠ¨ç”Ÿæˆçš„æ–¹æ³•å¯èƒ½å°±ä¸æ˜¯æˆ‘ä»¬æœŸæœ›çš„äº†ã€‚</p><p>æˆ‘ä»¬å…ˆæ¥ç ”ç©¶ä¸€ä¸‹å…¶å®ç°ï¼šå®šä¹‰ä¸€ä¸ªPersonç±»å‹ï¼ŒåŒ…å«å§“åå’Œèº«ä»½è¯ä¸¤ä¸ªå­—æ®µï¼š</p><pre><code>@Data\nclass Person {\n    private String name;\n    private String identity;\n\n    public Person(String name, String identity) {\n        this.name = name;\n        this.identity = identity;\n    }\n}\n</code></pre><p>å¯¹äºèº«ä»½è¯ç›¸åŒã€å§“åä¸åŒçš„ä¸¤ä¸ªPersonå¯¹è±¡ï¼š</p><pre><code>Person person1 = new Person(&quot;zhuye&quot;,&quot;001&quot;);\nPerson person2 = new Person(&quot;Joseph&quot;,&quot;001&quot;);\nlog.info(&quot;person1.equals(person2) ? {}&quot;, person1.equals(person2));\n</code></pre><p>ä½¿ç”¨equalsåˆ¤ç­‰ä¼šå¾—åˆ°falseã€‚å¦‚æœä½ å¸Œæœ›åªè¦èº«ä»½è¯ä¸€è‡´å°±è®¤ä¸ºæ˜¯åŒä¸€ä¸ªäººçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨@EqualsAndHashCode.Excludeæ³¨è§£æ¥ä¿®é¥°nameå­—æ®µï¼Œä»equalså’ŒhashCodeçš„å®ç°ä¸­æ’é™¤nameå­—æ®µï¼š</p><pre><code>@EqualsAndHashCode.Exclude\nprivate String name;\n</code></pre><p>ä¿®æ”¹åå¾—åˆ°trueã€‚æ‰“å¼€ç¼–è¯‘åçš„ä»£ç å¯ä»¥çœ‹åˆ°ï¼ŒLombokä¸ºPersonç”Ÿæˆçš„equalsæ–¹æ³•çš„å®ç°ï¼Œç¡®å®åªåŒ…å«äº†identityå±æ€§ï¼š</p><pre><code>public boolean equals(final Object o) {\n    if (o == this) {\n        return true;\n    } else if (!(o instanceof LombokEquealsController.Person)) {\n        return false;\n    } else {\n        LombokEquealsController.Person other = (LombokEquealsController.Person)o;\n        if (!other.canEqual(this)) {\n            return false;\n        } else {\n            Object this$identity = this.getIdentity();\n            Object other$identity = other.getIdentity();\n            if (this$identity == null) {\n                if (other$identity != null) {\n                    return false;\n                }\n            } else if (!this$identity.equals(other$identity)) {\n                return false;\n            }\n\n            return true;\n        }\n    }\n}\n</code></pre><p>ä½†åˆ°è¿™é‡Œè¿˜æ²¡å®Œï¼Œå¦‚æœç±»å‹ä¹‹é—´æœ‰ç»§æ‰¿ï¼ŒLombokä¼šæ€ä¹ˆå¤„ç†å­ç±»çš„equalså’ŒhashCodeå‘¢ï¼Ÿæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œå†™ä¸€ä¸ªEmployeeç±»ç»§æ‰¿Personï¼Œå¹¶æ–°å®šä¹‰ä¸€ä¸ªå…¬å¸å±æ€§ï¼š</p><pre><code>@Data\nclass Employee extends Person {\n\n    private String company;\n    public Employee(String name, String identity, String company) {\n        super(name, identity);\n        this.company = company;\n    }\n}\n</code></pre><p>åœ¨å¦‚ä¸‹çš„æµ‹è¯•ä»£ç ä¸­ï¼Œå£°æ˜ä¸¤ä¸ªEmployeeå®ä¾‹ï¼Œå®ƒä»¬å…·æœ‰ç›¸åŒçš„å…¬å¸åç§°ï¼Œä½†å§“åå’Œèº«ä»½è¯å‡ä¸åŒï¼š</p><pre><code>Employee employee1 = new Employee(&quot;zhuye&quot;,&quot;001&quot;, &quot;bkjk.com&quot;);\nEmployee employee2 = new Employee(&quot;Joseph&quot;,&quot;002&quot;, &quot;bkjk.com&quot;);\nlog.info(&quot;employee1.equals(employee2) ? {}&quot;, employee1.equals(employee2));\t\n</code></pre><p>å¾ˆé—æ†¾ï¼Œç»“æœæ˜¯trueï¼Œæ˜¾ç„¶æ˜¯æ²¡æœ‰è€ƒè™‘çˆ¶ç±»çš„å±æ€§ï¼Œè€Œè®¤ä¸ºè¿™ä¸¤ä¸ªå‘˜å·¥æ˜¯åŒä¸€äººï¼Œ<strong>è¯´æ˜@EqualsAndHashCodeé»˜è®¤å®ç°æ²¡æœ‰ä½¿ç”¨çˆ¶ç±»å±æ€§ã€‚</strong></p><p>ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è®¾ç½®callSuperå¼€å…³ä¸ºtrueï¼Œæ¥è¦†ç›–è¿™ç§é»˜è®¤è¡Œä¸ºï¼š</p><pre><code>@Data\n@EqualsAndHashCode(callSuper = true)\nclass Employee extends Person {\n</code></pre><p>ä¿®æ”¹åçš„ä»£ç ï¼Œå®ç°äº†åŒæ—¶ä»¥å­ç±»çš„å±æ€§companyåŠ ä¸Šçˆ¶ç±»ä¸­çš„å±æ€§identityï¼Œä½œä¸ºequalså’ŒhashCodeæ–¹æ³•çš„å®ç°æ¡ä»¶ï¼ˆå®ç°ä¸Šå…¶å®æ˜¯è°ƒç”¨äº†çˆ¶ç±»çš„equalså’ŒhashCodeï¼‰ã€‚</p><h2>é‡ç‚¹å›é¡¾</h2><p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥å›é¡¾ä¸‹å¯¹è±¡åˆ¤ç­‰å’Œæ¯”è¾ƒçš„é‡ç‚¹å†…å®¹å§ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ³¨æ„equalså’Œ== çš„åŒºåˆ«ã€‚ä¸šåŠ¡ä»£ç ä¸­è¿›è¡Œå†…å®¹çš„æ¯”è¾ƒï¼Œé’ˆå¯¹åŸºæœ¬ç±»å‹åªèƒ½ä½¿ç”¨==ï¼Œé’ˆå¯¹Integerã€Stringåœ¨å†…çš„å¼•ç”¨ç±»å‹ï¼Œéœ€è¦ä½¿ç”¨equalsã€‚Integerå’ŒStringçš„å‘åœ¨äºï¼Œä½¿ç”¨==åˆ¤ç­‰æœ‰æ—¶ä¹Ÿèƒ½è·å¾—æ­£ç¡®ç»“æœã€‚</p><p>å…¶æ¬¡ï¼Œå¯¹äºè‡ªå®šä¹‰ç±»å‹ï¼Œå¦‚æœç±»å‹éœ€è¦å‚ä¸åˆ¤ç­‰ï¼Œé‚£ä¹ˆåŠ¡å¿…åŒæ—¶å®ç°equalså’ŒhashCodeæ–¹æ³•ï¼Œå¹¶ç¡®ä¿é€»è¾‘ä¸€è‡´ã€‚å¦‚æœå¸Œæœ›å¿«é€Ÿå®ç°equalsã€hashCodeæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©IDEçš„ä»£ç ç”ŸæˆåŠŸèƒ½ï¼Œæˆ–ä½¿ç”¨Lombokæ¥ç”Ÿæˆã€‚å¦‚æœç±»å‹ä¹Ÿè¦å‚ä¸æ¯”è¾ƒï¼Œé‚£ä¹ˆcompareToæ–¹æ³•çš„é€»è¾‘åŒæ ·éœ€è¦å’Œequalsã€hashCodeæ–¹æ³•ä¸€è‡´ã€‚</p><p>æœ€åï¼ŒLombokçš„@EqualsAndHashCodeæ³¨è§£å®ç°equalså’ŒhashCodeçš„æ—¶å€™ï¼Œé»˜è®¤ä½¿ç”¨ç±»å‹æ‰€æœ‰éstaticã€étransientçš„å­—æ®µï¼Œä¸”ä¸è€ƒè™‘çˆ¶ç±»ã€‚å¦‚æœå¸Œæœ›æ”¹å˜è¿™ç§é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥ä½¿ç”¨@EqualsAndHashCode.Excludeæ’é™¤ä¸€äº›å­—æ®µï¼Œå¹¶è®¾ç½®callSuper = trueæ¥è®©å­ç±»çš„equalså’ŒhashCodeè°ƒç”¨çˆ¶ç±»çš„ç›¸åº”æ–¹æ³•ã€‚</p><p>åœ¨æ¯”è¾ƒæšä¸¾å€¼å’ŒPOJOå‚æ•°å€¼çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æ³¨æ„åˆ°ï¼Œä½¿ç”¨==æ¥åˆ¤æ–­ä¸¤ä¸ªåŒ…è£…ç±»å‹çš„ä½çº§é”™è¯¯ï¼Œç¡®å®å®¹æ˜“è¢«å¿½ç•¥ã€‚æ‰€ä»¥ï¼Œ<strong>æˆ‘å»ºè®®ä½ åœ¨IDEä¸­å®‰è£…é˜¿é‡Œå·´å·´çš„Javaè§„çº¦æ’ä»¶</strong>ï¼ˆè¯¦è§<a href=\"https://github.com/alibaba/p3c\">è¿™é‡Œ</a>ï¼‰ï¼Œæ¥åŠæ—¶æç¤ºæˆ‘ä»¬è¿™ç±»ä½çº§é”™è¯¯ï¼š</p><p><img src=\"https://static001.geekbang.org/resource/image/fe/c3/fe020d747a35cec23e5d92c1277d02c3.png?wh=2688*406\" alt=\"\"></p><p>ä»Šå¤©ç”¨åˆ°çš„ä»£ç ï¼Œæˆ‘éƒ½æ”¾åœ¨äº†GitHubä¸Šï¼Œä½ å¯ä»¥ç‚¹å‡»<a href=\"https://github.com/JosephZhu1983/java-common-mistakes\">è¿™ä¸ªé“¾æ¥</a>æŸ¥çœ‹ã€‚</p><h2>æ€è€ƒä¸è®¨è®º</h2><ol>\n<li>åœ¨å®ç°equalsæ—¶ï¼Œæˆ‘æ˜¯å…ˆé€šè¿‡getClassæ–¹æ³•åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œä½ å¯èƒ½ä¼šæƒ³åˆ°è¿˜å¯ä»¥ä½¿ç”¨instanceofæ¥åˆ¤æ–­ã€‚ä½ èƒ½è¯´è¯´è¿™ä¸¤ç§å®ç°æ–¹å¼çš„åŒºåˆ«å—ï¼Ÿ</li>\n<li>åœ¨ç¬¬ä¸‰èŠ‚çš„ä¾‹å­ä¸­ï¼Œæˆ‘æ¼”ç¤ºäº†å¯ä»¥é€šè¿‡HashSetçš„containsæ–¹æ³•åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨HashSetä¸­ï¼ŒåŒæ ·æ˜¯Setçš„TreeSetå…¶containsæ–¹æ³•å’ŒHashSetæœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿ</li>\n</ol><p>æœ‰å…³å¯¹è±¡åˆ¤ç­‰ã€æ¯”è¾ƒï¼Œä½ è¿˜é‡åˆ°è¿‡å…¶ä»–å‘å—ï¼Ÿæˆ‘æ˜¯æœ±æ™”ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºä¸æˆ‘ç•™è¨€åˆ†äº«ä½ çš„æƒ³æ³•ï¼Œä¹Ÿæ¬¢è¿ä½ æŠŠè¿™ç¯‡æ–‡ç« åˆ†äº«ç»™ä½ çš„æœ‹å‹æˆ–åŒäº‹ï¼Œä¸€èµ·äº¤æµã€‚</p>","comments":[{"had_liked":false,"id":195297,"user_name":"Darren","can_delete":false,"product_type":"c1","uid":1254968,"ip_address":"","ucode":"CCD2B2C492BE9A","user_header":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","comment_is_top":false,"comment_ctime":1585155437,"is_pvip":true,"replies":[{"id":"74235","content":"ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ» <br>è¿™ä½åŒå­¦ä½œä¸ºæœ¬è¯¾è¯¾ä»£è¡¨ ğŸ˜€","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585182827,"ip_address":"","comment_id":195297,"utype":1}],"discussion_count":27,"race_medal":0,"score":"1131161554285","product_id":100047701,"comment_content":"ç¨å¾®è¡¥å……ä¸€ç‚¹ï¼Œå¯èƒ½å› ä¸ºç¯‡å¹…çš„åŸå› ï¼Œè€å¸ˆæ²¡æåˆ°ï¼Œå…³äºequalså…¶å®è¿˜æœ‰ä¸€ä¸ªå¤§å‘ï¼Œequalsæ¯”è¾ƒçš„å¯¹è±¡é™¤äº†æ‰€è°“çš„ç›¸ç­‰å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„å› ç´ ï¼Œå°±æ˜¯è¯¥å¯¹è±¡çš„ç±»åŠ è½½å™¨ä¹Ÿå¿…é¡»æ˜¯åŒä¸€ä¸ªï¼Œä¸ç„¶equalsè¿”å›çš„è‚¯å®šæ˜¯falseï¼›ä¹‹å‰é‡åˆ°è¿‡ä¸€ä¸ªå‘ï¼šé‡å¯åï¼Œä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œç»“æœæ˜¯trueï¼Œä½†æ˜¯ä¿®æ”¹äº†æŸäº›ä¸œè¥¿åï¼Œçƒ­åŠ è½½ï¼ˆä¸ç”¨é‡å¯å³å¯ç”Ÿæ•ˆï¼‰åï¼Œå†æ¬¡æ‰§è¡Œequalsï¼Œè¿”å›å°±æ˜¯falseï¼Œå› ä¸ºçƒ­åŠ è½½ä½¿ç”¨çš„ç±»åŠ è½½å™¨å’Œç¨‹åºæ­£å¸¸å¯åŠ¨çš„ç±»åŠ è½½å™¨ä¸åŒã€‚å…³äºç±»åŠ è½½å™¨éƒ¨åˆ†ï¼ŒJDK 9 ä¹‹å‰çš„ Java åº”ç”¨éƒ½æ˜¯ç”±ã€Œå¯åŠ¨ç±»åŠ è½½å™¨ã€ã€ã€Œæ‰©å±•ç±»åŠ è½½å™¨ã€ã€ã€Œåº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ã€è¿™ä¸‰ç§ç±»åŠ è½½å™¨äº’ç›¸é…åˆæ¥å®ŒæˆåŠ è½½çš„ï¼Œå¦‚æœæœ‰éœ€è¦è¿˜å¯ä»¥åŠ å…¥è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨æ¥è¿›è¡Œæ‹“å±•ï¼›JDK 9 ä¸ºäº†æ¨¡å—åŒ–çš„æ”¯æŒï¼Œå¯¹åŒäº²å§”æ´¾æ¨¡å¼åšäº†ä¸€äº›æ”¹åŠ¨ï¼šæ‰©å±•ç±»åŠ è½½å™¨è¢«å¹³å°ç±»åŠ è½½å™¨ï¼ˆPlatform ClassLoaderï¼‰å–ä»£ã€‚å¹³å°ç±»åŠ è½½å™¨å’Œåº”ç”¨ç¨‹åºç±»åŠ è½½å™¨éƒ½ä¸å†ç»§æ‰¿è‡ª java.net.URLClassLoaderï¼Œè€Œæ˜¯ç»§æ‰¿äº jdk.internal.loader.BuiltinClassLoaderã€‚å…·ä½“ç»†èŠ‚å¯ä»¥è‡ªè¡Œæœç´¢ã€‚<br><br>ç°åœ¨å›ç­”ä¸‹é—®é¢˜ï¼š<br>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼š<br>instanceofè¿›è¡Œç±»å‹æ£€æŸ¥è§„åˆ™æ˜¯:ä½ æ˜¯è¯¥ç±»æˆ–è€…æ˜¯è¯¥ç±»çš„å­ç±»ï¼›<br>getClassè·å¾—ç±»å‹ä¿¡æ¯é‡‡ç”¨==æ¥è¿›è¡Œæ£€æŸ¥æ˜¯å¦ç›¸ç­‰çš„æ“ä½œæ˜¯ä¸¥æ ¼çš„åˆ¤æ–­ã€‚ä¸ä¼šå­˜åœ¨ç»§æ‰¿æ–¹é¢çš„è€ƒè™‘ï¼›<br><br>ç¬¬äºŒä¸ªé—®é¢˜ï¼š<br>HashSetæœ¬è´¨ä¸Šå°±æ˜¯HashMapçš„keyç»„æˆçš„ä¸é‡å¤çš„å…ƒç´ é›†åˆï¼Œcontainsæ–¹æ³•å…¶å®å°±æ˜¯æ ¹æ®hashcodeå’Œequalså»åˆ¤æ–­ç›¸ç­‰çš„<br>TreeSetæœ¬è´¨TreeMapçš„keyç»„æˆçš„ï¼Œæ•°æ®ç»“æ„æ˜¯çº¢é»‘æ ‘ï¼Œæ˜¯è‡ªå¸¦æ’åºåŠŸèƒ½çš„ï¼Œå¯ä»¥åœ¨æ”¾å…¥å…ƒç´ çš„æ—¶å€™æŒ‡å®šcomparatorï¼ˆæ¯”è¾ƒå™¨ï¼‰ï¼Œæˆ–è€…æ˜¯æ”¾å…¥çš„å…ƒç´ è¦å®ç°Comparableæ¥å£åå…ƒç´ è‡ªå·±å®ç°compareToæ–¹æ³•ï¼Œcontainsæ–¹æ³•æ˜¯æ ¹æ®æ¯”è¾ƒå™¨æˆ–è€…compareToå»åˆ¤æ–­ç›¸ç­‰","like_count":264,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214399,"discussion_content":"ä¸åŒç±»åŠ è½½å™¨åŠ è½½çš„ç›¸åŒç±»å®šä¹‰è¢«è®¤ä¸ºæ˜¯ä¸¤ä¸ªä¸åŒçš„ç±»","likes_number":9,"is_delete":false,"is_hidden":false,"ctime":1585189181,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489019,"discussion_content":"ğŸ‘ğŸ»ğŸ‘ğŸ»ğŸ‘ğŸ» \nè¿™ä½åŒå­¦ä½œä¸ºæœ¬è¯¾è¯¾ä»£è¡¨ ğŸ˜€","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585182827,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1063307,"avatar":"https://static001.geekbang.org/account/avatar/00/10/39/8b/af74591f.jpg","nickname":"chun1123","note":"","ucode":"413C3A8722699F","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219072,"discussion_content":"é»˜é»˜ç‚¹èµï¼Œè®°ç¬”è®°","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585731225,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2709222,"avatar":"https://static001.geekbang.org/account/avatar/00/29/56/e6/c5c80c3e.jpg","nickname":"èŒƒç‰¹è¥¿","note":"","ucode":"4BE8E24F80B736","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530737,"discussion_content":"è¿™ä¸ªå‘è¸©è¿‡ï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637136358,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"user_type\":1}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1656956,"avatar":"https://static001.geekbang.org/account/avatar/00/19/48/7c/2aaf50e5.jpg","nickname":"coder","note":"","ucode":"3A0940EBF94577","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":395969,"discussion_content":"å¤ªç§€äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1632370924,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1306032,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJcxSpNMqwqyicMvdOSr9ic0p1ABiauHnv7g7YQVSJuoHPoQbYDu3YzdpgmSAk2KricUBQ5yibWBWIq75w/132","nickname":"æ¡‚åŸè€æ‰˜å°¼","note":"","ucode":"139E4B8EE88B79","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":367947,"discussion_content":"æ‰‹åŠ¨ç‚¹èµ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1618499872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2103563,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/dgox0m94vr6w2Vxk0N6651pyL5wKWicqgwIxU9iahlIn5LKeFfQJDjzUoQKM8WNibS7Yuxyulmic1Xxfia5ibFc6ia0Hw/132","nickname":"Geek_fe5e8a","note":"","ucode":"B4CC300397BD6A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":299591,"discussion_content":"ä¼˜ç§€","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1597742047,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1657429,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLwTZdUafC5YM7bCASt8icUnoyYfV4hUHulexibDI7B4eaokTxYXHFtoic97DBlCAU9j5Jw4QUuGhyZQ/132","nickname":"Carisy","note":"","ucode":"67E887967347BA","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":274910,"discussion_content":"è¿™ç§æƒ…å†µæ˜¯å› ä¸ºè€å¹´ä»£çš„classæ²¡è¢«å›æ”¶ï¼Œä½†æ˜¯ç”¨é˜¿é‡Œçš„arthaså°±æ²¡è¿™ä¸ªé—®é¢˜ï¼Œä¸çŸ¥é“å’‹æ›¿æ¢çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1590631052,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1902220,"avatar":"","nickname":"Geek_9d0e04","note":"","ucode":"F5560CE5BDB125","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269702,"discussion_content":"å¯¹è±¡çš„ç±»åŠ è½½å™¨ä¹Ÿå¿…é¡»æ˜¯åŒä¸€ä¸ªï¼Œä¸ç„¶equalsè¿”å›çš„è‚¯å®šæ˜¯falseï¼›è¿™ç§æƒ…å†µæ˜¯ä¸æ˜¯ä½¿ç”¨getClassè·å¾—ç±»å‹ä¿¡æ¯ç„¶åé‡‡ç”¨==åˆ¤æ–­æ‰ä¼šå‡ºç°ï¼Ÿï¼Ÿé€šè¿‡instanceofæ˜¯ä¸æ˜¯ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Ÿï¼Ÿæˆ‘çœ‹Stringç”¨çš„å°±æ˜¯instanceof","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589939203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1902220,"avatar":"","nickname":"Geek_9d0e04","note":"","ucode":"F5560CE5BDB125","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":269942,"discussion_content":"Stringæ¯”è¾ƒçš„equalsæ˜¯é‡å†™è¿‡çš„ï¼Œåªåˆ¤æ–­å†…å®¹æ˜¯å¦ç›¸ç­‰","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589967142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":269702,"ip_address":""},"score":269942,"extra":""},{"author":{"id":1103456,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d6/60/f21b2164.jpg","nickname":"jacy","note":"","ucode":"0022A8759DDCE6","race_medal":1,"user_type":1,"is_pvip":false},"reply_author":{"id":1902220,"avatar":"","nickname":"Geek_9d0e04","note":"","ucode":"F5560CE5BDB125","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301338,"discussion_content":"stringæ˜¯ final ï¼Œä¸å…è®¸ç»§æ‰¿ï¼Œç”¨instanceofå’ŒgetClassæ²¡åŒºåˆ«","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1598493528,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":269702,"ip_address":""},"score":301338,"extra":""}]},{"author":{"id":1015483,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7e/bb/947c329a.jpg","nickname":"ç¨‹åºå‘˜å°è·ƒ","note":"","ucode":"25BB96E0791A60","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":226042,"discussion_content":"è€å“¥çœŸçš„å¾ˆç»™åŠ›","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586416985,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1015483,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7e/bb/947c329a.jpg","nickname":"ç¨‹åºå‘˜å°è·ƒ","note":"","ucode":"25BB96E0791A60","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":227354,"discussion_content":"æ²¡æœ‰ï¼Œæ²¡æœ‰ï¼Œå·¥ä½œå¥½å¤šå¹´äº†ï¼Œä»¥å‰ä¸æ‡‚ï¼Œç°åœ¨å¼€å§‹åŠ æ²¹å­¦ä¹ ï¼Œå¸Œæœ›è¿˜ä¸æ™šå§","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1586485255,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":226042,"ip_address":""},"score":227354,"extra":""}]},{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":222359,"discussion_content":"å‰å®³ï¼Œå‰å®³ï¼Œè¯„è®ºç‚¹èµå‡ åä¸ª","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586139314,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":224184,"discussion_content":"å˜¿å˜¿ï¼Œä¸»è¦æ˜¯è€å¸ˆçš„è¯¾å¹²è´§å¤šï¼Œè®¢é˜…äººå¤šäº†ï¼Œç‚¹èµå°±æ…¢æ…¢ä¸Šå»äº†","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586272250,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":222359,"ip_address":""},"score":224184,"extra":""}]},{"author":{"id":1903331,"avatar":"https://static001.geekbang.org/account/avatar/00/1d/0a/e3/fa396e5d.jpg","nickname":"é’é’å¤§ç‹","note":"","ucode":"EC3AB128F1178D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":219629,"discussion_content":"å¤§ä½¬","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585790257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1812970,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/a9/ea/5bfce6c5.jpg","nickname":"mgs2002","note":"","ucode":"F5931108BD509B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217437,"discussion_content":"å­¦ä¹ äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585559510,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311065,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/59/b2267eaa.jpg","nickname":"å¼ å¸ŒéŸ³","note":"","ucode":"224D5FE01E14B4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":217383,"discussion_content":"è€å“¥ï¼Œä½ çš„ç•™è¨€æ˜¯çœŸçš„æ£’ï¼Œç®€ç›´æ˜¯æ•™ç§‘ä¹¦çº§çš„ï¼ŒçœŸèµï¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585551912,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":216000,"discussion_content":"å¤§å¸ˆå¥½","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585402086,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1596049,"avatar":"https://static001.geekbang.org/account/avatar/00/18/5a/91/f26d17d4.jpg","nickname":"âˆ«1/(x^4*âˆš(1+x^2))dx","note":"","ucode":"E300E20E5AF0FD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214555,"discussion_content":"ç‰›é€¼","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585207642,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1102043,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d0/db/651d9bcb.jpg","nickname":"zxd","note":"","ucode":"65BC10809C9B2A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214368,"discussion_content":"å¦‚æœç±»åŠ è½½å™¨ä¸åŒï¼Œé‚£ä¹ˆåŠ è½½çš„classç±»å¯¹è±¡åº”è¯¥ä¹Ÿä¸ç›¸åŒå§ï¼Ÿ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585186040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":4,"child_discussions":[{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1102043,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d0/db/651d9bcb.jpg","nickname":"zxd","note":"","ucode":"65BC10809C9B2A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214376,"discussion_content":"æ˜¯çš„å‘€ã€‚æ˜¯åŒä¸€ä¸ªclasså¯¹è±¡ï¼Œè¢«ä¸åŒçš„ç±»åŠ å™¨åŠ è½½ï¼Œäº§ç”Ÿçš„å¯¹è±¡ï¼Œè¿›è¡Œequalsè‚¯å®šæ˜¯falseï¼Œå³ä½¿é‡å†™äº†hashcodeå’Œequalsï¼Œé€šè¿‡JSON.toString(obj)æ‰“å°å‡ºæ¥çš„å±æ€§å®Œå…¨ç›¸ç­‰ï¼Œä¹Ÿæ˜¯falseï¼Œå¯ä»¥é€šè¿‡å¯¹è±¡çš„getClass()è·å–ç´¯åŠ è½½å™¨","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585186870,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":214368,"ip_address":""},"score":214376,"extra":""},{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1102043,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d0/db/651d9bcb.jpg","nickname":"zxd","note":"","ucode":"65BC10809C9B2A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214426,"discussion_content":"åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒåŒä¸€ä¸ªclassæ˜¯å¯ä»¥è¢«ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½çš„ï¼Œæ¯”å¦‚çƒ­åŠ è½½ï¼Œæ¯”å¦‚æ¨¡å—åŒ–ï¼ˆOSGIï¼‰ç­‰å§","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585192150,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":214368,"ip_address":""},"score":214426,"extra":""},{"author":{"id":1041865,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e5/c9/1061582b.jpg","nickname":"skying","note":"","ucode":"E7CFF50AB64BB1","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":215949,"discussion_content":"åƒå¾ˆå¤šç»Ÿä¸€çš„é…ç½®æ¡†æ¶,å¦‚disconfï¼Œä¼šä¸ä¼šä¹Ÿé‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585399731,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":214376,"ip_address":""},"score":215949,"extra":""}]},{"author":{"id":1068585,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4e/29/1be3dd40.jpg","nickname":"ykkk88","note":"","ucode":"A1BCFC2F0D1022","race_medal":2,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214325,"discussion_content":"è¿™ç•™è¨€å¥½ç²¾å½©","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585182692,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1068585,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4e/29/1be3dd40.jpg","nickname":"ykkk88","note":"","ucode":"A1BCFC2F0D1022","race_medal":2,"user_type":1,"is_pvip":false},"discussion":{"id":214375,"discussion_content":"è°¢è°¢ï¼Œå…±åŒå­¦ä¹ ï¼Œå˜¿å˜¿","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1585186603,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":214325,"ip_address":""},"score":214375,"extra":""}]}]},{"had_liked":false,"id":195817,"user_name":"ğŸ‘½","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1585216743,"is_pvip":false,"replies":[{"id":"74345","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585224287,"ip_address":"","comment_id":195817,"utype":1}],"discussion_count":1,"race_medal":0,"score":"78894628071","product_id":100047701,"comment_content":"2 . HashSet åº•å†Œæ˜¯HashMapã€‚TreeSetåº•å±‚æ˜¯TreeMap<br>HashSetå°±æ˜¯ä½¿ç”¨HashMapè°ƒç”¨equalsï¼Œåˆ¤æ–­ä¸¤å¯¹è±¡çš„HashCodeæ˜¯å¦ç›¸ç­‰ã€‚<br>TreeSetå› ä¸ºæ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œåˆ™éœ€è¦è€ƒè™‘æ•°çš„å·¦å³ã€‚åˆ™éœ€è¦é€šè¿‡compareToè®¡ç®—æ­£è´Ÿå€¼ï¼Œçœ‹æœ€åèƒ½å¦æ‰¾åˆ°compareToä¸º0çš„å€¼ï¼Œæ‰¾åˆ°åˆ™è¿”å›trueã€‚<br><br>ç®€å•æ¥è¯´ï¼ŒTreeSetåº•å±‚ä½¿ç”¨compareToæ–¹æ³•æ¯”è¾ƒï¼ŒHashSetåº•å±‚ä½¿ç”¨hashå€¼æ¯”è¾ƒã€‚","like_count":19,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489162,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585224287,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":196058,"user_name":"Sun","can_delete":false,"product_type":"c1","uid":1903317,"ip_address":"","ucode":"6AC3DF235E39AA","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJF1mt66qEBeuaPekOS0YO5XXe8PKej4d0GLB8mOmptSYh1icX1Cc8MSWn0rZZsEY2CrvhNG6iad6tQ/132","comment_is_top":false,"comment_ctime":1585232896,"is_pvip":false,"replies":[{"id":"74362","content":"è®¾è®¡ç¯‡å’Œå®‰å…¨ç¯‡è¿˜ä¼šæœ‰æ›´ä¸°å¯Œçš„å†…å®¹ï¼Œè·Ÿç´§è„šæ­¥ï¼Œç»†ç»†å“å‘³","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585233070,"ip_address":"","comment_id":196058,"utype":1}],"discussion_count":1,"race_medal":0,"score":"40239938560","product_id":100047701,"comment_content":"è€å¸ˆçš„è¯¾ç¨‹ï¼ŒçœŸçš„æ˜¯å¹²è´§ï¼Œæ¯å¤©å‡Œæ™¨æ›´æ–°å®Œçœ‹ä¸€éï¼Œæ—©ä¸Šä¸Šç­å‰åœ¨çœ‹ä¸€éï¼Œæ„Ÿå—éƒ½ä¸ä¸€æ ·ï¼ŒæœŸå¾…å‡ºæ›´å¤šå¹²è´§ï¼Œå…±åŒè¿›æ­¥","like_count":9,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489220,"discussion_content":"è®¾è®¡ç¯‡å’Œå®‰å…¨ç¯‡è¿˜ä¼šæœ‰æ›´ä¸°å¯Œçš„å†…å®¹ï¼Œè·Ÿç´§è„šæ­¥ï¼Œç»†ç»†å“å‘³","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585233070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195804,"user_name":"ğŸ‘½","can_delete":false,"product_type":"c1","uid":1274117,"ip_address":"","ucode":"D313AF941B412D","user_header":"https://static001.geekbang.org/account/avatar/00/13/71/05/db554eba.jpg","comment_is_top":false,"comment_ctime":1585216110,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"40239921774","product_id":100047701,"comment_content":"é—®é¢˜1ï¼š<br>Father father = new Father();<br>    Son son = new Son();<br>    System.out.println(son.getClass()==father.getClass());<br>    System.out.println(son instanceof Father);<br>æ‰“å°ç»“æœ<br>false<br>true<br><br>åŒºåˆ«åœ¨æ­¤ï¼ŒgetClassæ›´åŠ ä¸¥æ ¼ï¼Œè€Œinstanceof  å­ç±»instanceof  çˆ¶ç±»ï¼Œä¹Ÿæ˜¯true","like_count":9},{"had_liked":false,"id":197038,"user_name":"yihang","can_delete":false,"product_type":"c1","uid":1012361,"ip_address":"","ucode":"A5506F085D1793","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg","comment_is_top":false,"comment_ctime":1585351607,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"31650122679","product_id":100047701,"comment_content":"å¦å¤–å¯¹äº intern ä¹Ÿæœ‰å®ƒçš„ç”¨æ­¦ä¹‹å¤„ï¼Œæ®è¯´ twitter ä½¿ç”¨å®ƒå‡å°‘é‡å¤åœ°å€ï¼ˆå­—ç¬¦ä¸²ï¼‰å¤§é‡èŠ‚çº¦äº†å†…å­˜","like_count":7},{"had_liked":false,"id":195840,"user_name":"é˜¿éƒ‘","can_delete":false,"product_type":"c1","uid":1495155,"ip_address":"","ucode":"BBAC6BFCAFC762","user_header":"https://static001.geekbang.org/account/avatar/00/16/d0/73/06ed7823.jpg","comment_is_top":false,"comment_ctime":1585218821,"is_pvip":false,"replies":[{"id":"74344","content":"è§‰å¾—å¥½å¯ä»¥å¤šè½¬å‘åˆ†äº«","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585224271,"ip_address":"","comment_id":195840,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14470120709","product_id":100047701,"comment_content":"è€å¸ˆçš„æ¯ä¸€ç¯‡æ–‡ç« éƒ½æ˜¯æ»¡æ»¡çš„å¹²è´§å‘€ï¼Œæ‰‹åŠ¨ç‚¹èµğŸ‘ğŸ‘ğŸ‘","like_count":3,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489171,"discussion_content":"è§‰å¾—å¥½å¯ä»¥å¤šè½¬å‘åˆ†äº«","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585224271,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195477,"user_name":"ä¸œæ–¹å¥‡éª¥","can_delete":false,"product_type":"c1","uid":1354850,"ip_address":"","ucode":"DEE7085F7E55A4","user_header":"https://static001.geekbang.org/account/avatar/00/14/ac/62/37912d51.jpg","comment_is_top":false,"comment_ctime":1585190528,"is_pvip":true,"replies":[{"id":"74269","content":"åªè¦ä½ ç†è§£å®ƒå„ç§æ³¨è§£ä¼šç”Ÿæˆæ€æ ·çš„ä»£ç ï¼Œå°±æ²¡é—®é¢˜","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585191832,"ip_address":"","comment_id":195477,"utype":1}],"discussion_count":1,"race_medal":0,"score":"14470092416","product_id":100047701,"comment_content":"çœ‹åˆ°è¿™èŠ‚ï¼Œè¯´èµ·Lombokï¼Œè€å¸ˆè§‰å¾—Lombok é€‚åˆç”¨äºç”Ÿäº§ç¯å¢ƒå—ï¼Ÿä¹‹å‰ä¸€ç›´éƒ½æ˜¯è‡ªå·±ä¸šä½™ç»ƒä¹ ä½¿ç”¨ï¼Œä½†æ˜¯å·¥ä½œä¸­é¡¹ç›®éƒ½è¿˜æ˜¯æ²¡æœ‰ä½¿ç”¨ã€‚","like_count":4,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489083,"discussion_content":"åªè¦ä½ ç†è§£å®ƒå„ç§æ³¨è§£ä¼šç”Ÿæˆæ€æ ·çš„ä»£ç ï¼Œå°±æ²¡é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585191832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":195345,"user_name":"pedro","can_delete":false,"product_type":"c1","uid":1200704,"ip_address":"","ucode":"F40C839DDFD599","user_header":"https://static001.geekbang.org/account/avatar/00/12/52/40/e57a736e.jpg","comment_is_top":false,"comment_ctime":1585182311,"is_pvip":false,"replies":[{"id":"74236","content":"ğŸ‘ğŸ»","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585182897,"ip_address":"","comment_id":195345,"utype":1}],"discussion_count":4,"race_medal":0,"score":"14470084199","product_id":100047701,"comment_content":"1æ¥¼çš„å›ç­”å·²ç»è¶‹äºå®Œç¾ï¼Œæˆ‘ä¹Ÿç¿»äº†ä¸€ä¸‹ JDK æºç ï¼ŒHashSet çš„æœ¬è´¨æ˜¯ HashMapï¼Œä¼šé€šè¿‡ hash å‡½æ•°æ¥æ¯”è¾ƒå€¼ï¼ŒTreeSet çš„æœ¬è´¨æ˜¯ TreeMap ä¼šé€šè¿‡ compareTo æ¯”è¾ƒã€‚<br>è‡³äºç±»åŠ è½½å™¨çš„é—®é¢˜ï¼Œæˆ‘æƒ³è¿™ä¸ªä¸å¥½å¤ç°ï¼Œæœ‰æ²¡æœ‰æ¥¼ä¸‹çš„å°ä¼™ä¼´è¡¥å……ä¸€ä¸‹çš„ã€‚","like_count":4,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489038,"discussion_content":"ğŸ‘ğŸ»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585182897,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1357840,"avatar":"https://static001.geekbang.org/account/avatar/00/14/b8/10/6cbdf1a0.jpg","nickname":"only if","note":"","ucode":"97832713156A2F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":310587,"discussion_content":"å¯ä»¥è‡ªå®šä¹‰classloaderå»å¤ç°","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601918217,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":214380,"discussion_content":"å½“æ—¶æ˜¯Springbooté¡¹ç›®ï¼Œä½¿ç”¨çš„çƒ­åŠ è½½ç»„å»ºæ˜¯DevToolsï¼Œå½“æ—¶çš„å…·ä½“åœºæ™¯æœ‰ç‚¹æƒ³ä¸èµ·æ¥äº†ï¼Œä½†æ˜¯å½“æ—¶çš„å¯¹è±¡é‡å†™äº†hashcodeå’Œequalsï¼Œé€šè¿‡JSON.toString(obj)æ‰“å°å‡ºæ¥çš„å±æ€§å®Œå…¨ç›¸ç­‰ï¼Œä¹Ÿæ˜¯falseï¼Œæœ€åé€šè¿‡å¯¹è±¡çš„getClass()è·å–ç´¯åŠ è½½å™¨ï¼Œæ‰å‘ç°äº†ä¸åŒ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585186975,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1069822,"avatar":"https://static001.geekbang.org/account/avatar/00/10/52/fe/1241bc83.jpg","nickname":"æ°´å¦‚å¤©","note":"","ucode":"50AE29168947CD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1254968,"avatar":"https://static001.geekbang.org/account/avatar/00/13/26/38/ef063dc2.jpg","nickname":"Darren","note":"","ucode":"CCD2B2C492BE9A","race_medal":0,"user_type":1,"is_pvip":true},"discussion":{"id":214680,"discussion_content":"è¿™ä¸ªå‘é‡åˆ°è¿‡ä¸€æ¬¡ï¼Œjava9æŠŠxmlçš„åº“ç§»é™¤äº†ï¼Œåªèƒ½å¼•å…¥maven  jaråŒ…ï¼Œä½†æ˜¯åœ¨java8ä¸­åŠ è½½äº†ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯mavençš„åŠ è½½å™¨åŠ è½½ä¸€æ¬¡æ˜¯åº”ç”¨ç¨‹åºåŠ è½½ï¼Œå±æ€§ä¸€æ ·ï¼Œä½†æ˜¯hashmapå­˜äº†ä¸¤æ¬¡ï¼Œæ’æŸ¥äº†å¥½ä¹…ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585225775,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":214380,"ip_address":""},"score":214680,"extra":""}]}]},{"had_liked":false,"id":197837,"user_name":"å¤±ç«çš„å¤å¤©","can_delete":false,"product_type":"c1","uid":1241770,"ip_address":"","ucode":"10C6E66EB2A65F","user_header":"https://static001.geekbang.org/account/avatar/00/12/f2/aa/32fc0d54.jpg","comment_is_top":false,"comment_ctime":1585400354,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10175334946","product_id":100047701,"comment_content":"hashsetå’ŒtreeSetä»æ ¹æœ¬ä¸Šæ¥è¯´ï¼Œæ²¡ä»€ä¹ˆå…³ç³»ï¼Œåªæ˜¯æœ‰ä¸ªNä»£ä»¥å‰çš„ç¥–å®—äº†ï¼Œå“ˆå“ˆï¼Œä¸€ä¸ªç©hashï¼Œä¸€ä¸ªç©comparatorã€‚ä¸€ä¸ªåº•å±‚æ˜¯æ•£åˆ—è¡¨ï¼Œä¸€ä¸ªåº•å±‚æ˜¯çº¢é»‘æ ‘ã€‚","like_count":2},{"had_liked":false,"id":195463,"user_name":"Huodefa_0426","can_delete":false,"product_type":"c1","uid":1589284,"ip_address":"","ucode":"0980487D49F9D0","user_header":"","comment_is_top":false,"comment_ctime":1585189614,"is_pvip":false,"replies":[{"id":"74268","content":"æ§åˆ¶å°ï¼Œç¡®ä¿å‚æ•°ç”Ÿæ•ˆäº†","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585191678,"ip_address":"","comment_id":195463,"utype":1}],"discussion_count":2,"race_medal":0,"score":"10175124206","product_id":100047701,"comment_content":"è€å¸ˆï¼Œæ–‡ä¸­ä½ è¯´ï¼šåœ¨å¯åŠ¨ç¨‹åºæ—¶è®¾ç½® JVM å‚æ•° -XX:+PrintStringTableStatisticsï¼Œç¨‹åºé€€å‡ºæ—¶å¯ä»¥æ‰“å°å‡ºå­—ç¬¦ä¸²å¸¸é‡è¡¨çš„ç»Ÿè®¡ä¿¡æ¯ã€‚è°ƒç”¨æ¥å£åå…³é—­ç¨‹åºï¼Œè¾“å‡ºå¦‚ä¸‹ã€‚æˆ‘è®¾ç½®äº†å…³é—­ç¨‹åºæ€ä¹ˆæ²¡çœ‹è§è¾“å‡ºçš„ä¿¡æ¯ï¼Œæ˜¯è¾“å‡ºåœ¨æ§åˆ¶å°è¿˜æ˜¯åœ¨æ—¥å¿—æ–‡ä»¶ä¸­ï¼Ÿå¦‚æœæ˜¯æ–‡ä»¶ æ˜¯å“ªä¸ªæ–‡ä»¶ï¼Ÿ","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489077,"discussion_content":"æ§åˆ¶å°ï¼Œç¡®ä¿å‚æ•°ç”Ÿæ•ˆäº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585191678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":1,"child_discussions":[{"author":{"id":1155437,"avatar":"https://static001.geekbang.org/account/avatar/00/11/a1/6d/a4ff33bb.jpg","nickname":"Lee","note":"","ucode":"0FF1C4EAF7F98A","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"discussion":{"id":539746,"discussion_content":"è€å¸ˆå¥½ï¼Œæˆ‘ä¹Ÿåœ¨ideaçš„vmä¸­è®¾ç½®äº†ï¼Œjdkæ—¶17ã€‚ä¹Ÿåœ¨æ§åˆ¶å°æ²¡çœ‹åˆ°è¾“å‡ºï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆåŸå› ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1639826260,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":489077,"ip_address":""},"score":539746,"extra":""}]}]},{"had_liked":false,"id":273751,"user_name":"é²é¸£","can_delete":false,"product_type":"c1","uid":2152306,"ip_address":"","ucode":"974BA3C3E64630","user_header":"https://static001.geekbang.org/account/avatar/00/20/d7/72/cbef720d.jpg","comment_is_top":false,"comment_ctime":1610670374,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5905637670","product_id":100047701,"comment_content":"è€å¸ˆå¥½ï¼Œè®¢å•çŠ¶æ€çš„é‚£ä¸ªæ²¡æœ‰ç‰¹åˆ«ç†è§£ï¼Œæšä¸¾å€¼ä¸æ˜¯1000å¤šå—ï¼Ÿå’Œ127çš„å…³ç³»æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ","like_count":1,"discussions":[{"author":{"id":1123011,"avatar":"https://static001.geekbang.org/account/avatar/00/11/22/c3/5c69ab81.jpg","nickname":"Lucky Dog","note":"","ucode":"C71C5D24200CCF","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":550739,"discussion_content":"ä¾‹å­é‡Œç”¨æšä¸¾çš„statuså±æ€§å€¼ä¸å…¥å‚å¯¹æ¯”ï¼Œä¸¤ä¸ªéƒ½æ˜¯integerç±»å‹ï¼Œåœ¨æ¯”è¾ƒæ—¶ä½¿ç”¨äº†==ï¼Œçœ‹ä¸‹æ–‡ä¸­å¯¹==æ¯”è¾ƒçš„åˆ†æ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644720687,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":239684,"user_name":"å­¦ä¹ ä½¿äººå¿«ä¹","can_delete":false,"product_type":"c1","uid":1478759,"ip_address":"","ucode":"1EC27CE663EE65","user_header":"https://static001.geekbang.org/account/avatar/00/16/90/67/106306e7.jpg","comment_is_top":false,"comment_ctime":1596615331,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5891582627","product_id":100047701,"comment_content":"è€å¸ˆçš„è¯¾ç¨‹ç‰¹åˆ«å¥½","like_count":2},{"had_liked":false,"id":233788,"user_name":"James","can_delete":false,"product_type":"c1","uid":1134861,"ip_address":"","ucode":"48B0F2A334D1C1","user_header":"https://static001.geekbang.org/account/avatar/00/11/51/0d/fc1652fe.jpg","comment_is_top":false,"comment_ctime":1594450837,"is_pvip":false,"replies":[{"id":"86306","content":"ä¾èµ–æ˜¯ä¸€èµ·çš„","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1594467221,"ip_address":"","comment_id":233788,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5889418133","product_id":100047701,"comment_content":"æ¯ä¸€ä¸ªæ¡ˆä¾‹éƒ½æ˜¯ç‹¬ç«‹çš„SpringBootæˆ–Javaå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºï¼Œå¯ä»¥å•ç‹¬å¯åŠ¨ï¼Œé¿å…ç›¸äº’å¹²æ‰°<br>è¯·é—®ä¸‹,ä¸ºå•¥æˆ‘å¯åŠ¨çš„æ˜¯ç‹¬ç«‹mainç±»ä¸ºå•¥è¿˜ä¼šå¯åŠ¨å…¶ä»–æ— å…³è¿™ä¸ªåŒ…çš„ç±».æ¯”å¦‚è¿æ¥redis","like_count":2,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501165,"discussion_content":"ä¾èµ–æ˜¯ä¸€èµ·çš„","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1594467221,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":197030,"user_name":"yihang","can_delete":false,"product_type":"c1","uid":1012361,"ip_address":"","ucode":"A5506F085D1793","user_header":"https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg","comment_is_top":false,"comment_ctime":1585350374,"is_pvip":false,"replies":[{"id":"74524","content":"æ˜¯çš„ï¼Œè¿™ä¸ªä¸‹ç¯‡æåˆ°äº†","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585362929,"ip_address":"","comment_id":197030,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5880317670","product_id":100047701,"comment_content":"è¡¥å……ä¸€ç‚¹ï¼Œæµ®ç‚¹æ•°çš„==æ¯”è¾ƒä¹Ÿæœ‰å‘ï¼Œè·Ÿæµ®ç‚¹æ•°å°æ•°ç²¾åº¦æœ‰å…³","like_count":1,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":489438,"discussion_content":"æ˜¯çš„ï¼Œè¿™ä¸ªä¸‹ç¯‡æåˆ°äº†","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585362929,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":196410,"user_name":"âœ¨","can_delete":false,"product_type":"c1","uid":1257254,"ip_address":"","ucode":"73D4C65CA5008C","user_header":"https://static001.geekbang.org/account/avatar/00/13/2f/26/47745048.jpg","comment_is_top":false,"comment_ctime":1585279283,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880246579","product_id":100047701,"comment_content":"Collections.sort(list);<br>ä¹Ÿè°ƒç”¨äº†compareToå§ï¼Œæ‰€ä»¥è¿”å›ä¸‹æ ‡index2æ˜¯ä¸æ˜¯åº”è¯¥ç­‰äº0ï¼Ÿ","like_count":1},{"had_liked":false,"id":196341,"user_name":"Geek_3b1096","can_delete":false,"product_type":"c1","uid":1549364,"ip_address":"","ucode":"A6BD92B79B3632","user_header":"","comment_is_top":false,"comment_ctime":1585274335,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5880241631","product_id":100047701,"comment_content":"ä¸Šç­å‰çœ‹ä¸€é+1","like_count":2},{"had_liked":false,"id":328164,"user_name":"giteebravo","can_delete":false,"product_type":"c1","uid":1005290,"ip_address":"","ucode":"C087E8D6B5A98B","user_header":"https://static001.geekbang.org/account/avatar/00/0f/56/ea/32608c44.jpg","comment_is_top":false,"comment_ctime":1640582113,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"1640582113","product_id":100047701,"comment_content":"<br>å¦‚ä½•æŸ¥çœ‹ Lombok ç¼–è¯‘åçš„ä»£ç å‘¢ï¼Ÿ<br>","like_count":0},{"had_liked":false,"id":302539,"user_name":"èº«ä½“å¥åº·ä¸‡äº‹å¦‚æ„","can_delete":false,"product_type":"c1","uid":2378101,"ip_address":"","ucode":"37246DBCDEB0C6","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erLlkIiakffb0icyMQqh98qcHPFSFAjI97HiaGk2sozRTXGNVVjcjydenYjib2mgknziaf7zylm3ibr0AmA/132","comment_is_top":false,"comment_ctime":1626253917,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626253917","product_id":100047701,"comment_content":"Interge çš„ç¼“å­˜æœºåˆ¶<br>é»˜è®¤èŒƒå›´[-128,127),å¯ä»¥åœ¨jvmä¿®æ”¹èŒƒå›´<br>Integer num = 100;<br>ç¼–è¯‘å™¨çš„æ‰§è¡Œæ˜¯<br>Integer num = Integer.valueof(100); &#47;&#47;å–ç¼“å­˜<br><br>å­—ç¬¦ä¸²å¸¸é‡æ± <br>å­—ç¬¦ä¸²ä¸ä½¿ç”¨newæ—¶ï¼Œä¼šå‘å­—ç¬¦ä¸²å¸¸é‡æ± æ·»åŠ æ–°çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœå¸¸é‡æ± å·²å­˜åœ¨ï¼Œåˆ™ç›´æ¥å¼•ç”¨å·²æœ‰çš„å¯¹è±¡ã€‚<br>å¦‚æœæ˜¯newçš„Stringå¯¹è±¡ï¼Œå¯ä½¿ç”¨internå¼•ç”¨å¸¸é‡æ± å·²å­˜åœ¨çš„å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰åˆ™æ·»åŠ ã€‚<br><br>1.å¦‚æœé‡å†™equalsæ–¹æ³•ï¼ŒåŠ¡å¿…æ ¹æ®equalsæ–¹æ³•æ¯”è¾ƒå­—æ®µé‡å†™hashcodeæ–¹æ³•(æ ¹æ®hashç»“æ„å­˜å‚¨çš„é›†åˆï¼Œä¼šå­˜å‚¨ç›¸åŒçš„å¯¹è±¡)<br>2.å®ç°comparableæ¥å£ï¼ŒåŠ¡å¿…ä¿æŒcompareï¼Œhashcodeï¼Œequalsæ–¹æ³•æ¯”è¾ƒå­—æ®µä¸€è‡´<br>","like_count":0},{"had_liked":false,"id":273804,"user_name":"flyailove","can_delete":false,"product_type":"c1","uid":1755631,"ip_address":"","ucode":"3FD96988AB626A","user_header":"https://static001.geekbang.org/account/avatar/00/1a/c9/ef/56ccc350.jpg","comment_is_top":false,"comment_ctime":1610682561,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1610682561","product_id":100047701,"comment_content":"åŸºæœ¬ç±»å‹ ==<br>å¯¹è±¡ç±»å‹ equals<br>åŸºæœ¬ç±»å‹ æœ‰ç¼“å­˜æ±  int ä¸º [-128 - 127]<br>å¯ä»¥é€šè¿‡  -XX:AutoBoxCacheMax=1000 è®¾ç½®æ”¯æŒçš„æœ€å¤§å€¼<br>å­—ç¬¦ä¸² å¸¸é‡æ±  å­—ç¬¦ä¸²é©»ç•™æˆ–æ± åŒ–<br>å­—ç¬¦ä¸²å¸¸é‡æ±  æ˜¯MAPæ•°æ®ç»“æ„<br>&#47;&#47;-XX:+PrintStringTableStatistics æ‰“å°æ± çš„ä¿¡æ¯<br>&#47;&#47;-XX:StringTableSize=10000000 è®¾ç½®è¡¨çš„å¤§å°<br>intern å­—æ®µä¸èƒ½å¸¸ç”¨ï¼Œä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚<br><br>","like_count":0},{"had_liked":false,"id":256900,"user_name":"kimoti","can_delete":false,"product_type":"c1","uid":1897671,"ip_address":"","ucode":"0A78077408C2B1","user_header":"https://static001.geekbang.org/account/avatar/00/1c/f4/c7/037235c9.jpg","comment_is_top":false,"comment_ctime":1603779498,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1603779498","product_id":100047701,"comment_content":"çœ‹äº†è¿™ç¯‡æ–‡ç« æ„Ÿè§‰è‡ªå·±æ²¡æœ‰å­¦è¿‡Java,è¯¥å›ç‚‰äº†","like_count":0},{"had_liked":false,"id":241878,"user_name":"ğŸ›ğŸ›","can_delete":false,"product_type":"c1","uid":1367321,"ip_address":"","ucode":"C7C6F93764FD23","user_header":"https://static001.geekbang.org/account/avatar/00/14/dd/19/45afa234.jpg","comment_is_top":false,"comment_ctime":1597484027,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1597484027","product_id":100047701,"comment_content":"è€å¸ˆçœŸæ£’","like_count":0},{"had_liked":false,"id":201688,"user_name":"justin","can_delete":false,"product_type":"c1","uid":1178721,"ip_address":"","ucode":"8EEB37B7914975","user_header":"https://static001.geekbang.org/account/avatar/00/11/fc/61/241b5c75.jpg","comment_is_top":false,"comment_ctime":1585821057,"is_pvip":false,"replies":[{"id":"75396","content":"å› ä¸ºæ²¡æœ‰è¿›å¸¸é‡æ± ","user_name":"ä½œè€…å›å¤","user_name_real":"æœ±æ™”","uid":"1001470","ctime":1585822472,"ip_address":"","comment_id":201688,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1585821057","product_id":100047701,"comment_content":"è€å¸ˆæ‚¨å¥½ï¼Œå°±æ˜¯å…³äºè¿™ä¸ªä¾‹å­ï¼ŒåŠ äº†intern()ä¼šåœ¨å¸¸é‡æ± é©»ç•™ï¼Œå¯¼è‡´æ¯ä¸ªbucket sizeå˜å¾—å¾ˆå¤§ã€‚å¦‚æœæ²¡æœ‰åŠ intern()æ–¹æ³•çš„æ—¶å€™ï¼ŒAverage bucket sizeå°±å˜å¾—å¾ˆä½ï¼Œæµ‹è¯•çš„æ˜¯0.276ï¼Œè¿™ä¸ªå¸®å¿™è§£é‡Šä¸‹<br>@GetMapping(&quot;internperformance&quot;)<br>public int internperformance(@RequestParam(value = &quot;size&quot;, defaultValue = &quot;10000000&quot;)int size) {<br>    &#47;&#47;-XX:+PrintStringTableStatistics<br>    &#47;&#47;-XX:StringTableSize=10000000<br>    long begin = System.currentTimeMillis();<br>    list = IntStream.rangeClosed(1, size)<br>            .mapToObj(i-&gt; String.valueOf(i).intern())<br>            .collect(Collectors.toList());<br>    log.info(&quot;size:{} took:{}&quot;, size, System.currentTimeMillis() - begin);<br>    return list.size();<br>}<br>","like_count":0,"discussions":[{"author":{"id":1001470,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/47/fe/d0e25d57.jpg","nickname":"æœ±æ™”","note":"","ucode":"0B7F0BADE6AAB8","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":490398,"discussion_content":"å› ä¸ºæ²¡æœ‰è¿›å¸¸é‡æ± ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1585822472,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":198729,"user_name":"EchosEcho","can_delete":false,"product_type":"c1","uid":1527473,"ip_address":"","ucode":"993828BAC9B385","user_header":"https://static001.geekbang.org/account/avatar/00/17/4e/b1/4b922c82.jpg","comment_is_top":false,"comment_ctime":1585465703,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1585465703","product_id":100047701,"comment_content":"getclasséœ€è¦å…·ä½“ä¸€ç§ç±»å‹æ‰èƒ½åšæ¯”è¾ƒï¼Œinstanceofå¯ä»¥åœ¨å­ç±»å’Œçˆ¶ç±»é—´å®ç°equalsæ–¹æ³•","like_count":0},{"had_liked":false,"id":198611,"user_name":"åŠªåŠ›å¥‹æ–—çš„Pisces","can_delete":false,"product_type":"c1","uid":1336441,"ip_address":"","ucode":"AD4F8909CF190A","user_header":"https://static001.geekbang.org/account/avatar/00/14/64/79/f1e1ca76.jpg","comment_is_top":false,"comment_ctime":1585459637,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1585459637","product_id":100047701,"comment_content":"1.instanceof æ¶‰åŠåˆ°ç»§æ‰¿çš„å­ç±»æ˜¯éƒ½å±äºçˆ¶ç±»çš„åˆ¤æ–­<br>2.treeSet æ˜¯ treeMapçš„å®ç°ï¼Œä½¿ç”¨äº†compareToæ¥æ¯”åˆ¤æ–­æ˜¯å¦åŒ…å«","like_count":0}]}