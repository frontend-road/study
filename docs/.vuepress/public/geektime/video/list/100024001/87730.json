{"id":87730,"title":"33 | å¯¹è±¡æ± ","content":"<h1>è¯¾ä»¶åŠæºä»£ç åœ°å€</h1><p><a href=\"https://gitee.com/geektime-geekbang/go_learning\">https://gitee.com/geektime-geekbang/go_learning</a></p><h2>ä¹¦ç›®æ¨è</h2><p><a href=\"time://mall?url=https%3A%2F%2Fh5.youzan.com%2Fv2%2Fgoods%2F1ycmk3uob0ryw\">ã€Šè®¡ç®—æœºç¨‹åºçš„æ„é€ å’Œè§£é‡Šã€‹</a></p>","comments":[{"had_liked":false,"id":82992,"user_name":"çº›ä¸‹é¥ç‹—","can_delete":false,"product_type":"c3","uid":1004678,"ip_address":"","ucode":"116CBB7D30427F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/54/86/0591280e.jpg","comment_is_top":false,"comment_ctime":1554367214,"is_pvip":false,"replies":[{"id":29968,"content":"å¾ˆèµï¼åœ¨å¯æ‰§è¡Œçš„ä»£ç ä¸­å­¦ä¹ ï¼\nä»£ç æˆ‘ä¼šå°½å¿«æäº¤ï¼Œå¹¶é€šçŸ¥å¹³å°æ›´æ–°ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1554377756,"ip_address":"","comment_id":82992,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"è”¡è€å¸ˆæ‚¨å¥½\nåœ¨å¯¹è±¡æ± ä¸€è¯¾æˆ‘å‚è€ƒä¹‹å‰çš„è¯¾ç¨‹ä½¿ç”¨unsafe.Pointeråœ¨ä¸æ”¾å›çš„æƒ…å†µä¸‹æ‰“å‡ºäº†æ¯ä¸ªå¯¹è±¡çš„åœ°å€ï¼Œå‘ç°ä»–ä»¬éƒ½æ˜¯ä¸€æ ·çš„, è¿™ä¸ªæ—¶å€™ç»“æ„ä½“é‡Œæ²¡æœ‰å®šä¹‰ä»»ä½•æˆå‘˜ã€‚\næˆ‘æŠŠNewObjPoolçš„åˆå§‹åŒ–å¯¹è±¡æ”¹æˆäº†æ¯ä¸ªéƒ½èµ‹äºˆä¸€ä¸ªid intå­æˆå‘˜çš„æƒ…å†µä¸‹10ä¸ªå¯¹è±¡æ‰“å°å‡ºçš„åœ°å€å°±ä¸åŒäº†ï¼ˆé¢„æœŸï¼‰\nåæ¥åœ¨ç½‘ä¸ŠæŸ¥é˜…å‘ç°è¿™ä¸ªæ˜¯ç©ºç»“æ„ä½“ï¼Œç”¨unsafe.Sizeofå‘ç°å ç”¨çš„å¤§å°ä¸º0ï¼Œæ‰€ä»¥æ¯æ¬¡åˆå§‹åŒ–çš„ä½ç§»å°±æ˜¯0ï¼Œæ‰€ä»¥æ¯ä¸ªå¯¹è±¡çš„åœ°å€éƒ½æ˜¯ç›¸åŒã€‚\nè€Œå¦‚æœå¢åŠ ä¸€ä¸ªintæˆå‘˜çš„è¯ï¼ŒSizeå°±ä¼šå˜æˆ8ï¼Œç„¶ååœ°å€çš„ä½ç§»ä¹Ÿæ˜¯8.\n\nå¦å¤–è€å¸ˆgithubä¸Šçš„ä»£ç æ²¡æœ‰æ›´æ–°äº†æœ€è¿‘ã€‚ã€‚ã€‚","like_count":13,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"è”¡è¶…","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445806,"discussion_content":"å¾ˆèµï¼åœ¨å¯æ‰§è¡Œçš„ä»£ç ä¸­å­¦ä¹ ï¼\nä»£ç æˆ‘ä¼šå°½å¿«æäº¤ï¼Œå¹¶é€šçŸ¥å¹³å°æ›´æ–°ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554377756,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":271153,"user_name":"Geek_d235ed","can_delete":false,"product_type":"c3","uid":2354791,"ip_address":"","ucode":"734D1920B1A27A","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Hk6ZTagyeQjcJiaibe4Pmzy9FmGtD2vvuibzmmhjyAyT9qLplax2LNC1tpVIrOSZ0kMiafpiaB6k7Jn7RSOwcTnzgBw/132","comment_is_top":false,"comment_ctime":1609418921,"is_pvip":false,"replies":[{"id":98364,"content":"æˆ‘çŒœä½ æ˜¯åœ¨å‘½ä»¤è¡Œé‡Œåˆ¶å®šäº†obj_pool_test.go, æ‰€ä»¥obj_pool.goæ²¡æœ‰è¢«ç¼–è¯‘ã€‚\nç›´æ¥åœ¨è·¯å¾„ä¸‹ä½¿ç”¨go test -væ‰§è¡Œçœ‹çœ‹\n","user_name":"ä½œè€…å›å¤","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1609563382,"ip_address":"","comment_id":271153,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"è€å¸ˆå¥½ï¼Œch32 çš„å¯¹è±¡æ± ï¼Œæˆ‘è¿™è¾¹æ‰§è¡Œèµ·æ¥æŠ¥äº†ä¸‹é¢é”™è¯¯ï¼Œèƒ½å¸®å¿™çœ‹ä¸‹å—ï¼Ÿ\n\n# command-line-arguments [command-line-arguments.test]\n.\\obj_pool_test.go:10:10: undefined: NewObjPool\n\nCompilation finished with exit code 2\n","like_count":2,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"è”¡è¶…","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":512850,"discussion_content":"æˆ‘çŒœä½ æ˜¯åœ¨å‘½ä»¤è¡Œé‡Œåˆ¶å®šäº†obj_pool_test.go, æ‰€ä»¥obj_pool.goæ²¡æœ‰è¢«ç¼–è¯‘ã€‚\nç›´æ¥åœ¨è·¯å¾„ä¸‹ä½¿ç”¨go test -væ‰§è¡Œçœ‹çœ‹\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1609563382,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":234909,"user_name":"Aprelude","can_delete":false,"product_type":"c3","uid":1658796,"ip_address":"","ucode":"840D3F7A35AEEF","user_header":"https://static001.geekbang.org/account/avatar/00/19/4f/ac/80439ba7.jpg","comment_is_top":false,"comment_ctime":1594824281,"is_pvip":false,"replies":[{"id":87554,"content":"GOä¸­ä¸ºäº†ä¼˜åŒ–å¦‚æœç»“æ„ä½“é‡Œæ²¡æœ‰å­—æ®µåªæœ‰æ–¹æ³•ï¼Œé‚£ä¹ˆä¸¤ä¸ªç»“æ„ä½“çš„æ‰§è¡Œç»“æœè‚¯å®šç›¸åŒï¼Œæ‰€ä»¥å…±ç”¨ä¸€ä¸ªåœ°å€äº†ã€‚\n\næ‰€ä»¥ä½ æŠŠç»“æ„ä½“ä¿®æ”¹ä¸€ä¸‹ï¼š\ntype ReusableObj struct {\n\tx int\n}\nå†è¯•è¯•ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1595600258,"ip_address":"","comment_id":234909,"utype":1}],"discussion_count":2,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"package ch6\n\nimport (\n\t&quot;errors&quot;\n\t&quot;fmt&quot;\n\t&quot;testing&quot;\n\t&quot;time&quot;\n\t&quot;unsafe&quot;\n)\n\ntype ReusableObj struct {\n}\n\ntype ObjPool struct {\n\tbufChan chan *ReusableObj &#47;&#47;ç”¨äºç¼“å†²å¯é‡ç”¨å¯¹è±¡\n}\n\nfunc NewObjPool(numOfObj int) *ObjPool {\n\tobjPool := ObjPool{}\n\tobjPool.bufChan = make(chan *ReusableObj, numOfObj)\n\tfor i := 0; i &lt; numOfObj; i++ {\n\t\tm := &amp;ReusableObj{}\n\t\tfmt.Println(&quot;un:&quot;, unsafe.Pointer(m))\n\t\tobjPool.bufChan &lt;- m\n\t}\n\treturn &amp;objPool\n}\n\nfunc (p *ObjPool) GetObj(timeout time.Duration) (*ReusableObj, error) {\n\tselect {\n\tcase ret := &lt;-p.bufChan:\n\t\treturn ret, nil\n\tcase &lt;-time.After(timeout):\n\t\treturn nil, errors.New(&quot;time out&quot;)\n\t}\n}\n\nfunc (p *ObjPool) ReleaseObj(obj *ReusableObj) error {\n\tselect {\n\tcase p.bufChan &lt;- obj:\n\t\treturn nil\n\tdefault:\n\t\treturn errors.New(&quot;overflow&quot;)\n\t}\n}\n\nfunc TestObjPool(t *testing.T) {\n\tpool := NewObjPool(10)\n\tfor i := 0; i &lt; 11; i++ {\n\t\tif v, err := pool.GetObj(time.Second * 1); err != nil {\n\t\t\tt.Error(err)\n\t\t} else {\n\t\t\tfmt.Println(unsafe.Pointer(v))\n\t\t\t&#47;&#47;if err := pool.ReleaseObj(v); err != nil {\n\t\t\t&#47;&#47;\tt.Error(err)\n\t\t\t&#47;&#47;}\n\t\t}\n\t}\n\tt.Log(&quot;done&quot;)\n}\nå¿˜è®°äº† è¿™ä¸ªä¸ºä»€ä¹ˆæ¯æ¬¡è¾“å‡ºçš„ç¬¬åœ°å€éƒ½ä¸€æ ·å•Š å¤§ä½¬è§£é‡Šä¸€ä¸‹ ä¸æ˜¯newå¯¹è±¡å—","like_count":2,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"è”¡è¶…","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":501543,"discussion_content":"GOä¸­ä¸ºäº†ä¼˜åŒ–å¦‚æœç»“æ„ä½“é‡Œæ²¡æœ‰å­—æ®µåªæœ‰æ–¹æ³•ï¼Œé‚£ä¹ˆä¸¤ä¸ªç»“æ„ä½“çš„æ‰§è¡Œç»“æœè‚¯å®šç›¸åŒï¼Œæ‰€ä»¥å…±ç”¨ä¸€ä¸ªåœ°å€äº†ã€‚\n\næ‰€ä»¥ä½ æŠŠç»“æ„ä½“ä¿®æ”¹ä¸€ä¸‹ï¼š\ntype ReusableObj struct {\n\tx int\n}\nå†è¯•è¯•ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595600258,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2640817,"avatar":"","nickname":"ç½—ä¿Šèª","note":"","ucode":"1B0E51A8AC8A70","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389624,"discussion_content":"https://dave.cheney.net/2014/03/25/the-empty-struct çœ‹ä¸‹è¿™ç¯‡æ–‡ç« å°±æ˜ç™½äº†\n\nimport (\n\t&#34;fmt&#34;\n\t&#34;testing&#34;\n)\n\ntype S struct{}\n\ntype S1 struct {}\n\nfunc (s *S) addr() {\n\tfmt.Printf(&#34;%p\\n&#34;, s)\n}\nfunc (s1 *S1) addr() {\n\tfmt.Printf(&#34;%p\\n&#34;, s1)\n}\n\nfunc TestEmptyStruct(t *testing.T) {\n\tvar a, b S\n\tvar c S1\n\ta.addr()\n\tb.addr()\n\tc.addr()\n}\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629360886,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":114821,"user_name":"ç”°ä½³ä¼Ÿ","can_delete":false,"product_type":"c3","uid":1034087,"ip_address":"","ucode":"D31C9799F383D2","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c7/67/0077314b.jpg","comment_is_top":false,"comment_ctime":1563412213,"is_pvip":false,"replies":[{"id":42049,"content":"è¾ƒå¸¸è§çš„ï¼Œè¿˜å¯ä»¥é™çº§å¤„ç†ï¼Œè¶…æ—¶åç›´æ¥ä»ç¼“å­˜è¿”å›å†å²æ•°æ®æˆ–è¿”å›é»˜è®¤æ•°æ®ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1563498725,"ip_address":"","comment_id":114821,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"è€å¸ˆï¼Œå‡å¦‚æˆ‘ç”¨å¯¹è±¡æ± å½“åšMySQLè¿æ¥æ± ç”¨çš„è¯ï¼Œæˆ‘åˆ›å»º100ä¸ªè¿æ¥ï¼Œç„¶ååœ¨å¹¶å‘æƒ…å†µä¸‹è¿æ¥æ± ç©ºäº†ï¼Œè¿™ä¸ªæ—¶å€™åç»­çš„queryåªèƒ½ç­‰å¾…æˆ–è€…timeoutå—ï¼Ÿè¿˜æœ‰æ²¡æœ‰åˆ«çš„æ›´å¥½çš„æ–¹æ¡ˆ","like_count":1,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"è”¡è¶…","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":458826,"discussion_content":"è¾ƒå¸¸è§çš„ï¼Œè¿˜å¯ä»¥é™çº§å¤„ç†ï¼Œè¶…æ—¶åç›´æ¥ä»ç¼“å­˜è¿”å›å†å²æ•°æ®æˆ–è¿”å›é»˜è®¤æ•°æ®ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1563498725,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":306909,"user_name":"william","can_delete":false,"product_type":"c3","uid":1161428,"ip_address":"","ucode":"FAD99AA6E375CA","user_header":"https://static001.geekbang.org/account/avatar/00/11/b8/d4/bd22e2c2.jpg","comment_is_top":false,"comment_ctime":1628771967,"is_pvip":false,"replies":[{"id":111652,"content":"è°¢è°¢ğŸ™ç¼–ç¨‹ä¸€å®šè¦äº²è‡ªåŠ¨æ‰‹è°ƒè¯•","user_name":"ä½œè€…å›å¤","user_name_real":"è”¡è¶…","uid":1008262,"ctime":1629540616,"ip_address":"","comment_id":306909,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"ç¬¬ä¸€éç›´æ¥å¬ï¼Œå®Œå…¨å¿˜äº†ï¼Œç¬¬äºŒéè·Ÿç€æ•²ä¸€éï¼Œå—ç›ŠåŒªæµ…ï¼Œæ„Ÿè°¢è€å¸ˆï¼ˆèµèµï¼‰","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"è”¡è¶…","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":524970,"discussion_content":"è°¢è°¢ğŸ™ç¼–ç¨‹ä¸€å®šè¦äº²è‡ªåŠ¨æ‰‹è°ƒè¯•","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629540616,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":280456,"user_name":"é‡‘é™µä¸€åªçŒª","can_delete":false,"product_type":"c3","uid":1903965,"ip_address":"","ucode":"C1C90B557842B6","user_header":"https://static001.geekbang.org/account/avatar/00/1d/0d/5d/e5010de2.jpg","comment_is_top":false,"comment_ctime":1614221795,"is_pvip":false,"replies":[{"id":101930,"content":"ç¡®åˆ‡çš„è¯´æ˜¯æŠŠä½¿ç”¨å®Œçš„å¯¹è±¡å½’è¿˜å›å»ã€‚","user_name":"ä½œè€…å›å¤","user_name_real":"è”¡è¶…","uid":1008262,"ctime":1614389629,"ip_address":"","comment_id":280456,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"è€å¸ˆï¼ŒReleaseObj è§£é‡Šä¸º é‡Šæ”¾å¯¹è±¡ï¼Œä½†ä»ä»£ç ä¸Šçœ‹ï¼Œè¿™ä¸ªæ–¹æ³•å¥½åƒæ˜¯ å‘å¯¹è±¡æ± ä¸­æ”¾å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œæ˜¯ä¸æ˜¯æˆ‘çš„ç†è§£æœ‰é—®é¢˜ï¼Ÿ","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"è”¡è¶…","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":516104,"discussion_content":"ç¡®åˆ‡çš„è¯´æ˜¯æŠŠä½¿ç”¨å®Œçš„å¯¹è±¡å½’è¿˜å›å»ã€‚","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614389629,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":81912,"user_name":"Geek_1264yp","can_delete":false,"product_type":"c3","uid":1207367,"ip_address":"","ucode":"DB792F56C26429","user_header":"https://static001.geekbang.org/account/avatar/00/12/6c/47/8da914be.jpg","comment_is_top":false,"comment_ctime":1554081951,"is_pvip":false,"replies":[{"id":29702,"content":"åé¢çš„é«˜å¯ç”¨æ€§è¯¾ç¨‹ä¼šè®²ã€‚ç»§ç»­çœ‹å“¦","user_name":"ä½œè€…å›å¤","user_name_real":"ChaoCai2010","uid":1008262,"ctime":1554127873,"ip_address":"","comment_id":81912,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"è€å¸ˆä½ å¥½ï¼Œtime outåœ¨é¡¹ç›®ä¸­çš„æ­£ç¡®å¤„ç†æ˜¯ä»€ä¹ˆï¼Ÿåº”è¯¥ä¸æ˜¯åªæŠ¥ä¸ªé”™ï¼Œç„¶åè¾“å‡ºtimeoutå§ã€‚ã€‚","like_count":0,"discussions":[{"author":{"id":1008262,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/62/86/632ad029.jpg","nickname":"è”¡è¶…","note":"","ucode":"4C281BBF511238","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":445389,"discussion_content":"åé¢çš„é«˜å¯ç”¨æ€§è¯¾ç¨‹ä¼šè®²ã€‚ç»§ç»­çœ‹å“¦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1554127873,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":80695,"user_name":"è“å£«é’¦","can_delete":false,"product_type":"c3","uid":1229516,"ip_address":"","ucode":"726EB5C8EF1249","user_header":"https://static001.geekbang.org/account/avatar/00/12/c2/cc/ca22bb7c.jpg","comment_is_top":false,"comment_ctime":1553699137,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"ä¸€æ¥¼[ZY]çš„ç•™è¨€ â€œå½“ä¸€ä¸ªchannelæ»¡äº†ä¹‹å æ— æ³•ç»§ç»­æ’å…¥ ä¼šæŠ¥é”™ï¼Œä½†æ˜¯æ”¾åˆ°åç¨‹é‡Œé¢å´å¯ä»¥åœ¨æ»¡äº†ä¹‹å ç»§ç»­æ’å…¥æ•°æ® ä¸ºä»€ä¹ˆå‘¢ï¼Ÿâ€\næˆ‘çš„ç†è§£æ˜¯è¿™æ ·çš„ï¼š\n1.ä½ çš„ä»£ç é‡Œæœ‰ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼Œä½¿ç”¨forå¾ªç¯å¼€å¯äº†10ä¸ªåç¨‹ï¼Œchannelè¿˜æ²¡æ»¡çš„æ—¶å€™å°±è¢«æ¶ˆè´¹è€…æå‰æ¶ˆè´¹æ‰äº†ï¼Œå…¶å®åªèƒ½æ·»åŠ 10æ•°æ®ï¼Œå¯ä»¥æŠŠæ¶ˆè´¹è€…å»æ‰ï¼Œ å¹¶ä¸”åŠ ä¸Šæ—¥å¿—æ‰“å°ï¼šä»£ç å¦‚ä¸‹ï¼š\n\tvar wg sync.WaitGroup\n\tnum := 10\n\tch := make(chan int, num)\n\tfor i := 0; i &lt; 1000; i++ {\n\t\twg.Add(1)\n\t\tgo func(i int) {\n\t\t\tch &lt;- i\t&#47;&#47; åç¨‹æ»¡åä¼šé˜»å¡ï¼Œå¯¼è‡´æ— æ³•æ‰§è¡Œå¦é—¨çš„wg.Done()å¯¼è‡´æ­»é”æŠ¥å¼‚å¸¸\n\t\t\tfmt.Printf(&quot;æ‰§è¡Œåç¨‹ï¼š%d\\n&quot;,i)\n\t\t\twg.Done()\n\t\t}(i)\n\t\twg.Wait()\n\t}\n\n2.å¯ä»¥åœ¨ä¸€ä¸ªåç¨‹é‡Œå¾ªç¯æ·»åŠ è¶…è¿‡channelå¤§å°çš„æ•°æ®ï¼Œä¾æ—§ä¼šé˜»å¡\nfunc TestChannelPush(t *testing.T) {\n\tch := make(chan int, 10)\n\tvar wg sync.WaitGroup\n\twg.Add(1)\n\tpushChannel(ch,&amp;wg)\n\twg.Wait()\n}\n\nfunc pushChannel(ch chan int, wg *sync.WaitGroup) {\n\tgo func() {\n\t\tfor i := 0; i &lt; 100; i++ {\n\t\t\tch &lt;- i\n\t\t}\n\t\twg.Done()\n\t}()\n}\n\nå› ä¸ºè¿™é‡Œç”¨äº†WaitGroupï¼Œæ‰€ä»¥ä¼šæœ‰æ­»é”ï¼Œå®é™…ä¸Šæ˜¯ä¼šé˜»å¡ã€‚","like_count":5},{"had_liked":false,"id":80702,"user_name":"è“å£«é’¦","can_delete":false,"product_type":"c3","uid":1229516,"ip_address":"","ucode":"726EB5C8EF1249","user_header":"https://static001.geekbang.org/account/avatar/00/12/c2/cc/ca22bb7c.jpg","comment_is_top":false,"comment_ctime":1553700059,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"è¡¥å……ä¸€ä¸‹ZYçš„ç•™è¨€ï¼Œchannelå¤§å°è™½ç„¶åªæœ‰10ï¼Œforå¾ªç¯å¼€å¯11ä¸ªåç¨‹å¾€channelæ·»åŠ æ•°æ®ï¼Œä½†æ˜¯å› ä¸ºåç¨‹å’Œä¸»ç¨‹åºæ˜¯å¼‚æ­¥çš„æ‰€ä»¥çœ‹ä¸å‡ºé˜»å¡ï¼Œå› ä¸ºåé¢çš„æ¶ˆè´¹è€…ç¨‹åºæŠŠchannelçš„æ•°æ®æ¶ˆè´¹äº†ï¼Œæ‰€ä»¥ä¸Šé¢å¯èƒ½å­˜åœ¨çš„é˜»å¡åˆé€šäº†ï¼Œä¸€è¾¹ç”Ÿäº§ä¸€è¾¹æ¶ˆè´¹ï¼ŒMQç»å¸¸å †åŒ…ä¹Ÿæ˜¯ç±»ä¼¼çš„æƒ…å†µï¼Œåœ¨ä¸»æœºå†…å­˜ç©ºé—´æœ‰é™çš„æƒ…å†µä¸‹å¦‚æœæ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯çš„é€Ÿåº¦æ¯”ç”Ÿäº§è€…æ…¢ï¼Œå°±æœ‰å¯èƒ½å †åŒ…ï¼Œä¸¥é‡çš„å°±é˜»å¡ã€‚","like_count":4},{"had_liked":false,"id":80549,"user_name":"ã€ŒZYã€","can_delete":false,"product_type":"c3","uid":1208912,"ip_address":"","ucode":"576332E29CC400","user_header":"https://static001.geekbang.org/account/avatar/00/12/72/50/68304a30.jpg","comment_is_top":false,"comment_ctime":1553679451,"is_pvip":false,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100024001,"comment_content":"è”¡è€å¸ˆæ‚¨å¥½\nè¿™èŠ‚è¯¾æ‚¨é‡Œé¢è®²åˆ° å½“ä¸€ä¸ªchannelæ»¡äº†ä¹‹å æ— æ³•ç»§ç»­æ’å…¥ ä¼šæŠ¥é”™\nä½†æ˜¯æ”¾åˆ°åç¨‹é‡Œé¢å´å¯ä»¥åœ¨æ»¡äº†ä¹‹å ç»§ç»­æ’å…¥æ•°æ® ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\nç”³è¯·çš„æ—¶å€™æ˜¯10ä¸ª  æ’å…¥11ä¸ª\n\nnum := 10\nch := make(chan int, num)\nfor i := 0; i &lt; num+1; i++ {\n\tgo func(i int) {\n\t\tch &lt;- i\n\t}(i)\n}\n\ntotal := 0\nfor i := 0; i &lt; num+1; i++ {\n\ttotal += &lt;-ch\n}\nfmt.Println(&quot;for total-------&quot;, total)","like_count":4,"discussions":[{"author":{"id":1979090,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/x3gOkI2Dl1Gb3WRic44roicJMILgHfdFRic8nfR7oh0asf0KONEj7U2or6YHMmCcyibskvVE5Pjypz2ALGwBXRyMPA/132","nickname":"ä¸­å¹´ç¼–ç¨‹äººå‘˜","note":"","ucode":"8692C6FA9B0ED3","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579289,"discussion_content":"è¿™ä¸æ˜¯åœ¨è¾¹è¿›è¾¹å‡ºå—ï¼Œè‚¯å®šæ²¡é—®é¢˜","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657293000,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":80790,"user_name":"è‚¥low","can_delete":false,"product_type":"c3","uid":1043480,"ip_address":"","ucode":"A158AFAAB8C742","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ec/18/bf7254d3.jpg","comment_is_top":false,"comment_ctime":1553734387,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"æ„Ÿè§‰è¿˜æ˜¯å¸¦ç€å†™ä»£ç æ¯”è¾ƒå®¹æ˜“ç†è§£","like_count":2},{"had_liked":false,"id":284145,"user_name":"Geek_d021a5","can_delete":false,"product_type":"c3","uid":1805985,"ip_address":"","ucode":"E713C9DC72FBF5","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erbR2CkXA6ZiaSZibIW7QsibjYMlLiaCRsvibgeEnzWEwUHHw6zX6h6e9DaqLRCX5jqPT6OVWuibhUVZ7mQ/132","comment_is_top":false,"comment_ctime":1616078339,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"å¯¹è±¡æ± \n\n\tGoLand ä¸èƒ½è¿è¡Œï¼Œåªèƒ½åˆ‡æ¢åˆ°æ–‡ä»¶ç›®å½•ä¸‹è¿è¡Œä¸€ä¸‹å‘½ä»¤\n\tä»€ä¹ˆåŸå› ã€‚ã€‚ã€‚\n\tgo test -v .\\obj_pool_test.go .\\obj_pool.go","like_count":1},{"had_liked":false,"id":353668,"user_name":"æå‡¯","can_delete":false,"product_type":"c3","uid":1197511,"ip_address":"åŒ—äº¬","ucode":"8828DCFC48D05B","user_header":"https://static001.geekbang.org/account/avatar/00/12/45/c7/f1c40c89.jpg","comment_is_top":false,"comment_ctime":1659668938,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"å¯ä»¥ä½¿ç”¨mapåšå¯¹è±¡æ± ä¹ˆï¼Œé‡Œé¢æ”¾ä¸åŒçš„æ•°æ®åº“è¿æ¥ï¼ˆå¤šä¸ªæ•°æ®æºè¿™ç§ip1:3306,ip2:3306ï¼‰ï¼Œä¸åŒçš„æ•°æ®æºåªå®ä¾‹åŒ–ä¸€æ¬¡ï¼Œå¦‚æœå¯ä»¥é‚£ï¼Œè¿™æ ·åšæœ‰ä»€ä¹ˆå¼Šç«¯ä¹ˆ","like_count":0},{"had_liked":false,"id":316214,"user_name":"èŠ’æœå°‘ä¾ ","can_delete":false,"product_type":"c3","uid":1350159,"ip_address":"","ucode":"98D0BBB52BB80F","user_header":"https://static001.geekbang.org/account/avatar/00/14/9a/0f/da7ed75a.jpg","comment_is_top":false,"comment_ctime":1634201691,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"ç¬”è®°ï¼šå®é™…å·¥ä½œä¸­ï¼Œå»ºè®®ç”¨ä¸åŒçš„æ± æ¥ç¼“å­˜ä¸åŒç±»å‹çš„å¯¹è±¡","like_count":0},{"had_liked":false,"id":275074,"user_name":"Geek_d586af","can_delete":false,"product_type":"c3","uid":2161180,"ip_address":"","ucode":"2966DBC6BD9B20","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/jtNYcW0hUoI1RzVic1tpJ7mkh4nccicC3aaC4aicYQCy9R1RZBMSWn8qDxjvVKqca9LnWxCfsicEqeW0bUkX6Bogyg/132","comment_is_top":false,"comment_ctime":1611299570,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"æœ‰ä¸ªé—®é¢˜ï¼šåœ¨mainå‡½æ•°ä¸­åœ¨å¼€å§‹æ‰§è¡Œæ—¶ï¼Œåç¨‹æ•°ä¸º1ï¼Œä½†æ˜¯åœ¨Testç¨‹åºé‡Œï¼Œå¼€å§‹åç¨‹æ•°ä¸º2ï¼Œè¿™å¤šå‡ºæ¥çš„ä¸€ä¸ªåç¨‹æ˜¯å•¥å‘¢ï¼Ÿtestå’Œmainå‡½æ•°çš„åŒºåˆ«","like_count":0},{"had_liked":false,"id":206428,"user_name":"zhimin","can_delete":false,"product_type":"c3","uid":1312130,"ip_address":"","ucode":"DF6DFBEF6FA297","user_header":"https://static001.geekbang.org/account/avatar/00/14/05/82/51cd0a50.jpg","comment_is_top":false,"comment_ctime":1586859421,"is_pvip":false,"replies":null,"discussion_count":2,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"é—®å¤§å®¶ä¸€ä¸ªç¯å¢ƒçš„é—®é¢˜ï¼Œ æˆ‘åœ¨githubä¸Šä¸‹è½½äº†é¡¹ç›®æ–‡ä»¶ï¼Œå‰é¢ç« èŠ‚çš„æµ‹è¯• æ‰§è¡Œ go test -v  æ²¡æœ‰é—®é¢˜ï¼Œ è¿™ä¸€èŠ‚ æ‰§è¡Œçš„æ—¶å€™æŠ¥å‘Šch32&#47;obj_pool&#47;obj_pool_test.go:10:10: undefined: NewObjPool\nå½“å‰çš„GO_PATH æ˜¯åŒ…å« å½“å‰æ ¹ç›®å½•çš„  echo $GOPATH              &#47;Volumes&#47;Untitled&#47;go&#47;src&#47;chao \nå¸®å¿™è§£é‡Šä¸€ä¸‹æ˜¯ä»€ä¹ˆåŸå› å§ï¼Œ è°¢è°¢ã€‚ ","like_count":0,"discussions":[{"author":{"id":1312130,"avatar":"https://static001.geekbang.org/account/avatar/00/14/05/82/51cd0a50.jpg","nickname":"zhimin","note":"","ucode":"DF6DFBEF6FA297","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":235608,"discussion_content":"çŸ¥é“äº†ï¼Œ go test -v Sort.go Sort_test.go å°±å¥½äº† å’Œ go run ä¸€æ · ","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1587045741,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1435172,"avatar":"https://static001.geekbang.org/account/avatar/00/15/e6/24/30806a88.jpg","nickname":"right-chen","note":"","ucode":"E0E940E80E7A2D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583237,"discussion_content":"é¡¶ä½ ä¸Šå»","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1659968770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"åŒ—äº¬","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":80974,"user_name":"Geek_56ba03","can_delete":false,"product_type":"c3","uid":1448310,"ip_address":"","ucode":"A90E27958D1268","user_header":"https://static001.geekbang.org/account/avatar/00/16/19/76/0bdc18ce.jpg","comment_is_top":false,"comment_ctime":1553767324,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"è¿™å°±ç»“æŸå•¦ï¼Œç­‰ç­‰ç­‰æ›´æ–°","like_count":0},{"had_liked":false,"id":80954,"user_name":"ã€ŒZYã€","can_delete":false,"product_type":"c3","uid":1208912,"ip_address":"","ucode":"576332E29CC400","user_header":"https://static001.geekbang.org/account/avatar/00/12/72/50/68304a30.jpg","comment_is_top":false,"comment_ctime":1553763684,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":3,"product_id":100024001,"comment_content":"æ„Ÿè°¢ è“å£«é’¦ çš„å›ç­”\nç¡®å®æ˜¯è¿™æ ·çš„  å¸¦é•¿åº¦çš„channel åœ¨æ»¡äº†ä¹‹å ä¼šé˜»å¡  \næ²¡æ»¡çš„æ—¶å€™ä¸ä¼šé˜»å¡","like_count":0}]}