{"id":627584,"title":"107｜怎样通过 OpenCV 采集视频信号？","content":"<p><strong>课后习题</strong><br>\n请你使用OpenCV截取视频中，相同人物至少10张图片，并将图片放入到一个文件夹中。</p><p><strong>课程代码、课件及其他相关资料地址</strong><br>\n<a href=\"https://gitee.com/wilsonyin/zero-basics-python\">https://gitee.com/wilsonyin/zero-basics-python</a></p>","comments":[{"had_liked":false,"id":376827,"user_name":"笨笨","can_delete":false,"product_type":"c3","uid":1005351,"ip_address":"北京","ucode":"6DA6DCAF6A7DCB","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/27/805786be.jpg","comment_is_top":false,"comment_ctime":1687515398,"is_pvip":true,"replies":null,"discussion_count":1,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"老师我运行face_cap.py这个程序时，它并没有打开摄像头和终端等待的一个状态，而是程序运行后直接自动结束了，这是为什么呢?（我的电脑是Windows10版本的）","like_count":1,"discussions":[{"author":{"id":1482026,"avatar":"https://static001.geekbang.org/account/avatar/00/16/9d/2a/3e57b54a.jpg","nickname":"地平线","note":"","ucode":"F50717D6244867","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":622550,"discussion_content":"我的也是这样，把这段代码改一下，参数传入0\ncap = cv.VideoCapture(0)","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1688394456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"湖北","group_id":0},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":368168,"user_name":"Matthew","can_delete":false,"product_type":"c3","uid":2843865,"ip_address":"江苏","ucode":"96093089773740","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEKSVuNarJuDhBSvHY0giaq6yriceEBKiaKuc04wCYWOuso50noqDexaPJJibJN7PHwvcQppnzsDia1icZkw/132","comment_is_top":false,"comment_ctime":1675950094,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import cv2 as cv\n\nvideo_path = &quot;.&#47;demo.mp4&quot;\ncap = cv.VideoCapture(video_path)\n\nnum = 1\nface_name = &quot;Boss&quot;\nface_id = 1\n\nprint(cap.isOpened())\n\nwhile (cap.isOpened()):\n    #捕获摄像头图像\n    ret_flag,vshow = cap.read()\n    #显示捕获的照片\n    cv.imshow(&quot;capture_test&quot;,vshow)\n    #图像刷新的频率\n    k = cv.waitKey(1)&amp;0xff\n    # 设置按键保存照片\n    if k == ord(&#39;s&#39;):\n        # 保存图片\n        cv.imencode(&quot;.jpg&quot;,vshow)[1].tofile(f&quot;.&#47;imgdata&#47;{str(face_id)}_{face_name}_{str(num)}.jpg&quot;)\n        print(f&quot;成功保存第{str(num)}张照片&quot;)\n        num += 1\n    elif k == ord(&#39; &#39;):\n        break\n# 关闭摄像\ncap.release()\n# 销毁窗口\ncv.destroyAllWindows()","like_count":1},{"had_liked":false,"id":394617,"user_name":"William","can_delete":false,"product_type":"c3","uid":1346215,"ip_address":"吉林","ucode":"55F5D9DEE485B1","user_header":"https://static001.geekbang.org/account/avatar/00/14/8a/a7/674c1864.jpg","comment_is_top":false,"comment_ctime":1727330247,"is_pvip":true,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"遇到无法打开摄像头， 然后发现\ncap = cv.VideoCapture(0) 这个， 没有写参数0 ，加上就可以了。\n\n\nimport cv2 as cv\n# opencv\n# pip3.9 install opencv-python\n# pillow图像处理\n# pip3.9 install pillow\n# contrib 用于训练人脸模型的opencv扩展包\n# pip3.9 install opencv-contrib-python\ncap = cv.VideoCapture(0)\nnum = 1\nface_name = &quot;Boss&quot;\nface_id = 1\n\nif not cap.isOpened():\n    print(&quot;无法打开摄像头&quot;)\n    exit()\n\nwhile (cap.isOpened()):\n    # 捕获摄像头图像\n    ret_flag, vshow = cap.read()\n    # 显示捕获的照片\n    cv.imshow(&quot;capture_test&quot;, vshow)\n    # 图像刷新的频率\n    k = cv.waitKey(1) &amp; 0xff\n    # 设置按键保存照片\n    if k == ord(&#39;s&#39;):\n        # 保存图片\n        cv.imencode(&quot;.jpg&quot;, vshow)[1].tofile(f&quot;.&#47;imgdata&#47;{str(face_id)}_{face_name}_{str(num)}.jpg&quot;)\n        print(f&quot;成功保存第{str(num)}张照片&quot;)\n        num += 1\n    elif k == ord(&#39; &#39;):\n        break\n# 关闭摄像\ncap.release()\n# 销毁窗口\ncv.destroyAllWindows()","like_count":0},{"had_liked":false,"id":384376,"user_name":"Geek_Mike","can_delete":false,"product_type":"c3","uid":3196376,"ip_address":"云南","ucode":"CFA942192C3B74","user_header":"https://static001.geekbang.org/account/avatar/00/30/c5/d8/c5509b9c.jpg","comment_is_top":false,"comment_ctime":1700736377,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import cv2 as cv\nfrom cv2 import VideoCapture, imencode\n\nface_name = &#39;G man&#39;\nface_id = 1\n\npath = &#39;&#47;Users&#47;mike&#47;Desktop&#47;1.mp4&#39;\ncap = VideoCapture(path)\nnum = 1\n\nwhile True:\n    ret, vshow = cap.read()\n    # read()的返回值是一个元组，包含两个元素：布尔值 ret 和图像帧 vshow\n    # ret用来存储布尔值,如果图像帧读取成功，ret 的值为 True，否则为 False\n\n    cv.imshow(&#39;test&#39;, vshow)\n    key = cv.waitKey(1) &amp; 0xff\n    # cv.waitKey(1) 返回的是用户按下任意键的 ASCII 值\n    # &amp;0xff 是一个位运算符，它把该 ASCII 值转换为无符号整数\n    \n    if key == ord(&#39;c&#39;):\n    # ord() 返回参数（一个字符）的 Unicode 码点值\n    # 然后使用变量 key 来匹配这个返回值，如果匹配成功(即用户是按下&#39;c&#39;键)，则执行相应的代码块\n        pic = imencode(&#39;.jpg&#39;, vshow)[1]\n        pic.tofile(f&#39;.&#47;capture_pic&#47;{str(face_id)}_{face_name}_{str(num)}.jpg&#39;)\n        print(f&#39;成功保存第{num}张图片&#39;)\n        num += 1\n\n    elif key == ord(&#39;q&#39;):\n        break\n\ncap.release()\ncv.destroyAllWindows()","like_count":0},{"had_liked":false,"id":368038,"user_name":"Cy23","can_delete":false,"product_type":"c3","uid":1591293,"ip_address":"辽宁","ucode":"8DC561C5151758","user_header":"https://static001.geekbang.org/account/avatar/00/18/47/fd/895f0c27.jpg","comment_is_top":false,"comment_ctime":1675836740,"is_pvip":false,"replies":null,"discussion_count":0,"race_medal":0,"score":2,"product_id":100310001,"comment_content":"import cv2 as cv\n\ncap = cv.VideoCapture(0)\nnum = 1\nface_name = &quot;Boss&quot;\nface_id = 1\n\nwhile(cap.isOpened()):\n    ret_flag,vshow = cap.read()\n    cv.imshow(&quot;capture test&quot;, vshow)\n    k = cv.waitKey(1)&amp;0xff\n    if k == ord(&#39;s&#39;):\n        cv.imencode(&quot;.jpg&quot;,vshow)[1].tofile(f&quot;.&#47;imgdata&#47;{str(face_id)}_{face_name}_{str(num)}.jpg&quot;)\n        print(f&quot;成功宝成第{str(num)}张图片&quot;)\n        num +=1\n    elif k == ord(&#39; &#39;):\n        break\ncap.release()\ncv.destroyAllWindows()","like_count":0}]}