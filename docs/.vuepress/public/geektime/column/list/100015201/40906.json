{"id":40906,"title":"17 | 经典PaaS的记忆：作业副本与水平扩展","content":"<p>你好，我是张磊。今天我和你分享的主题是：经典PaaS的记忆之作业副本与水平扩展。</p><p>在上一篇文章中，我为你详细介绍了Kubernetes项目中第一个重要的设计思想：控制器模式。</p><p>而在今天这篇文章中，我就来为你详细讲解一下，Kubernetes里第一个控制器模式的完整实现：Deployment。</p><p>Deployment看似简单，但实际上，它实现了Kubernetes项目中一个非常重要的功能：<span class=\"orange\">Pod的“水平扩展/收缩”（horizontal scaling out/in）</span>。这个功能，是从PaaS时代开始，一个平台级项目就必须具备的编排能力。</p><p>举个例子，如果你更新了Deployment的Pod模板（比如，修改了容器的镜像），那么Deployment就需要遵循一种叫作“滚动更新”（rolling update）的方式，来升级现有的容器。</p><p>而这个能力的实现，依赖的是Kubernetes项目中的一个非常重要的概念（API对象）：ReplicaSet。</p><p>ReplicaSet的结构非常简单，我们可以通过这个YAML文件查看一下：</p><pre><code>apiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: nginx-set\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.7.9\n</code></pre><p>从这个YAML文件中，我们可以看到，<strong>一个ReplicaSet对象，其实就是由副本数目的定义和一个Pod模板组成的</strong>。不难发现，它的定义其实是Deployment的一个子集。</p><!-- [[[read_end]]] --><p><strong>更重要的是，Deployment控制器实际操纵的，正是这样的ReplicaSet对象，而不是Pod对象。</strong></p><p>还记不记得我在上一篇文章<a href=\"https://time.geekbang.org/column/article/40583\">《编排其实很简单：谈谈“控制器”模型》</a>中曾经提出过这样一个问题：对于一个Deployment所管理的Pod，它的ownerReference是谁？</p><p>所以，这个问题的答案就是：ReplicaSet。</p><p>明白了这个原理，我再来和你一起分析一个如下所示的Deployment：</p><pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.7.9\n        ports:\n        - containerPort: 80\n</code></pre><p>可以看到，这就是一个我们常用的nginx-deployment，它定义的Pod副本个数是3（spec.replicas=3）。</p><p>那么，在具体的实现上，这个Deployment，与ReplicaSet，以及Pod的关系是怎样的呢？</p><p>我们可以用一张图把它描述出来：</p><p><img src=\"https://static001.geekbang.org/resource/image/71/58/711c07208358208e91fa7803ebc73058.jpg?wh=2248*1346\" alt=\"\"></p><p>通过这张图，我们就很清楚地看到，一个定义了replicas=3的Deployment，与它的ReplicaSet，以及Pod的关系，实际上是一种“层层控制”的关系。</p><p>其中，ReplicaSet负责通过“控制器模式”，保证系统中Pod的个数永远等于指定的个数（比如，3个）。这也正是Deployment只允许容器的restartPolicy=Always的主要原因：只有在容器能保证自己始终是Running状态的前提下，ReplicaSet调整Pod的个数才有意义。</p><p>而在此基础上，Deployment同样通过“控制器模式”，来操作ReplicaSet的个数和属性，进而实现“水平扩展/收缩”和“滚动更新”这两个编排动作。</p><p>其中，“水平扩展/收缩”非常容易实现，Deployment Controller只需要修改它所控制的ReplicaSet的Pod副本个数就可以了。</p><p>比如，把这个值从3改成4，那么Deployment所对应的ReplicaSet，就会根据修改后的值自动创建一个新的Pod。这就是“水平扩展”了；“水平收缩”则反之。</p><p>而用户想要执行这个操作的指令也非常简单，就是kubectl scale，比如：</p><pre><code>$ kubectl scale deployment nginx-deployment --replicas=4\ndeployment.apps/nginx-deployment scaled\n</code></pre><p>那么，<span class=\"orange\">“滚动更新”又是什么意思，是如何实现的呢？</span></p><p>接下来，我还以这个Deployment为例，来为你讲解“滚动更新”的过程。</p><p>首先，我们来创建这个nginx-deployment：</p><pre><code>$ kubectl create -f nginx-deployment.yaml --record\n</code></pre><p>注意，在这里，我额外加了一个–record参数。它的作用，是记录下你每次操作所执行的命令，以方便后面查看。</p><p>然后，我们来检查一下nginx-deployment创建后的状态信息：</p><pre><code>$ kubectl get deployments\nNAME               DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE\nnginx-deployment   3         0         0            0           1s\n</code></pre><p>在返回结果中，我们可以看到四个状态字段，它们的含义如下所示。</p><ol>\n<li>\n<p>DESIRED：用户期望的Pod副本个数（spec.replicas的值）；</p>\n</li>\n<li>\n<p>CURRENT：当前处于Running状态的Pod的个数；</p>\n</li>\n<li>\n<p>UP-TO-DATE：当前处于最新版本的Pod的个数，所谓最新版本指的是Pod的Spec部分与Deployment里Pod模板里定义的完全一致；</p>\n</li>\n<li>\n<p>AVAILABLE：当前已经可用的Pod的个数，即：既是Running状态，又是最新版本，并且已经处于Ready（健康检查正确）状态的Pod的个数。</p>\n</li>\n</ol><p>可以看到，只有这个AVAILABLE字段，描述的才是用户所期望的最终状态。</p><p>而Kubernetes项目还为我们提供了一条指令，让我们可以实时查看Deployment对象的状态变化。这个指令就是kubectl rollout status：</p><pre><code>$ kubectl rollout status deployment/nginx-deployment\nWaiting for rollout to finish: 2 out of 3 new replicas have been updated...\ndeployment.apps/nginx-deployment successfully rolled out\n</code></pre><p>在这个返回结果中，“2 out of 3 new replicas have been updated”意味着已经有2个Pod进入了UP-TO-DATE状态。</p><p>继续等待一会儿，我们就能看到这个Deployment的3个Pod，就进入到了AVAILABLE状态：</p><pre><code>NAME               DESIRED   CURRENT   UP-TO-DATE   AVAILABLE   AGE\nnginx-deployment   3         3         3            3           20s\n</code></pre><p>此时，你可以尝试查看一下这个Deployment所控制的ReplicaSet：</p><pre><code>$ kubectl get rs\nNAME                          DESIRED   CURRENT   READY   AGE\nnginx-deployment-3167673210   3         3         3       20s\n</code></pre><p>如上所示，在用户提交了一个Deployment对象后，Deployment Controller就会立即创建一个Pod副本个数为3的ReplicaSet。这个ReplicaSet的名字，则是由Deployment的名字和一个随机字符串共同组成。</p><p>这个随机字符串叫作pod-template-hash，在我们这个例子里就是：3167673210。ReplicaSet会把这个随机字符串加在它所控制的所有Pod的标签里，从而保证这些Pod不会与集群里的其他Pod混淆。</p><p>而ReplicaSet的DESIRED、CURRENT和READY字段的含义，和Deployment中是一致的。所以，<strong>相比之下，Deployment只是在ReplicaSet的基础上，添加了UP-TO-DATE这个跟版本有关的状态字段。</strong></p><p>这个时候，如果我们修改了Deployment的Pod模板，“滚动更新”就会被自动触发。</p><p>修改Deployment有很多方法。比如，我可以直接使用kubectl edit指令编辑Etcd里的API对象。</p><pre><code>$ kubectl edit deployment/nginx-deployment\n... \n    spec:\n      containers:\n      - name: nginx\n        image: nginx:1.9.1 # 1.7.9 -&gt; 1.9.1\n        ports:\n        - containerPort: 80\n...\ndeployment.extensions/nginx-deployment edited\n</code></pre><p>这个kubectl edit指令，会帮你直接打开nginx-deployment的API对象。然后，你就可以修改这里的Pod模板部分了。比如，在这里，我将nginx镜像的版本升级到了1.9.1。</p><blockquote>\n<p>备注：kubectl edit并不神秘，它不过是把API对象的内容下载到了本地文件，让你修改完成后再提交上去。</p>\n</blockquote><p>kubectl edit指令编辑完成后，保存退出，Kubernetes就会立刻触发“滚动更新”的过程。你还可以通过kubectl rollout status指令查看nginx-deployment的状态变化：</p><pre><code>$ kubectl rollout status deployment/nginx-deployment\nWaiting for rollout to finish: 2 out of 3 new replicas have been updated...\ndeployment.extensions/nginx-deployment successfully rolled out\n</code></pre><p>这时，你可以通过查看Deployment的Events，看到这个“滚动更新”的流程：</p><pre><code>$ kubectl describe deployment nginx-deployment\n...\nEvents:\n  Type    Reason             Age   From                   Message\n  ----    ------             ----  ----                   -------\n...\n  Normal  ScalingReplicaSet  24s   deployment-controller  Scaled up replica set nginx-deployment-1764197365 to 1\n  Normal  ScalingReplicaSet  22s   deployment-controller  Scaled down replica set nginx-deployment-3167673210 to 2\n  Normal  ScalingReplicaSet  22s   deployment-controller  Scaled up replica set nginx-deployment-1764197365 to 2\n  Normal  ScalingReplicaSet  19s   deployment-controller  Scaled down replica set nginx-deployment-3167673210 to 1\n  Normal  ScalingReplicaSet  19s   deployment-controller  Scaled up replica set nginx-deployment-1764197365 to 3\n  Normal  ScalingReplicaSet  14s   deployment-controller  Scaled down replica set nginx-deployment-3167673210 to 0\n</code></pre><p>可以看到，首先，当你修改了Deployment里的Pod定义之后，Deployment Controller会使用这个修改后的Pod模板，创建一个新的ReplicaSet（hash=1764197365），这个新的ReplicaSet的初始Pod副本数是：0。</p><p>然后，在Age=24 s的位置，Deployment Controller开始将这个新的ReplicaSet所控制的Pod副本数从0个变成1个，即：“水平扩展”出一个副本。</p><p>紧接着，在Age=22 s的位置，Deployment Controller又将旧的ReplicaSet（hash=3167673210）所控制的旧Pod副本数减少一个，即：“水平收缩”成两个副本。</p><p>如此交替进行，新ReplicaSet管理的Pod副本数，从0个变成1个，再变成2个，最后变成3个。而旧的ReplicaSet管理的Pod副本数则从3个变成2个，再变成1个，最后变成0个。这样，就完成了这一组Pod的版本升级过程。</p><p>像这样，<strong>将一个集群中正在运行的多个Pod版本，交替地逐一升级的过程，就是“滚动更新”。</strong></p><p>在这个“滚动更新”过程完成之后，你可以查看一下新、旧两个ReplicaSet的最终状态：</p><pre><code>$ kubectl get rs\nNAME                          DESIRED   CURRENT   READY   AGE\nnginx-deployment-1764197365   3         3         3       6s\nnginx-deployment-3167673210   0         0         0       30s\n</code></pre><p>其中，旧ReplicaSet（hash=3167673210）已经被“水平收缩”成了0个副本。</p><p><strong>这种“滚动更新”的好处是显而易见的。</strong></p><p>比如，在升级刚开始的时候，集群里只有1个新版本的Pod。如果这时，新版本Pod有问题启动不起来，那么“滚动更新”就会停止，从而允许开发和运维人员介入。而在这个过程中，由于应用本身还有两个旧版本的Pod在线，所以服务并不会受到太大的影响。</p><p>当然，这也就要求你一定要使用Pod的Health Check机制检查应用的运行状态，而不是简单地依赖于容器的Running状态。要不然的话，虽然容器已经变成Running了，但服务很有可能尚未启动，“滚动更新”的效果也就达不到了。</p><p>而为了进一步保证服务的连续性，Deployment Controller还会确保，在任何时间窗口内，只有指定比例的Pod处于离线状态。同时，它也会确保，在任何时间窗口内，只有指定比例的新Pod被创建出来。这两个比例的值都是可以配置的，默认都是DESIRED值的25%。</p><p>所以，在上面这个Deployment的例子中，它有3个Pod副本，那么控制器在“滚动更新”的过程中永远都会确保至少有2个Pod处于可用状态，至多只有4个Pod同时存在于集群中。这个策略，是Deployment对象的一个字段，名叫RollingUpdateStrategy，如下所示：</p><pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n...\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 1\n</code></pre><p>在上面这个RollingUpdateStrategy的配置中，maxSurge指定的是除了DESIRED数量之外，在一次“滚动”中，Deployment控制器还可以创建多少个新Pod；而maxUnavailable指的是，在一次“滚动”中，Deployment控制器可以删除多少个旧Pod。</p><p>同时，这两个配置还可以用前面我们介绍的百分比形式来表示，比如：maxUnavailable=50%，指的是我们最多可以一次删除“50%*DESIRED数量”个Pod。</p><p>结合以上讲述，现在我们可以扩展一下Deployment、ReplicaSet和Pod的关系图了。</p><p><img src=\"https://static001.geekbang.org/resource/image/bb/5d/bbc4560a053dee904e45ad66aac7145d.jpg?wh=2248*1346\" alt=\"\"></p><p>如上所示，Deployment的控制器，实际上控制的是ReplicaSet的数目，以及每个ReplicaSet的属性。</p><p>而一个应用的版本，对应的正是一个ReplicaSet；这个版本应用的Pod数量，则由ReplicaSet通过它自己的控制器（ReplicaSet Controller）来保证。</p><p>通过这样的多个ReplicaSet对象，Kubernetes项目就实现了对多个“应用版本”的描述。</p><p>而明白了“应用版本和ReplicaSet一一对应”的设计思想之后，我就可以为你讲解一下<span class=\"orange\">Deployment对应用进行版本控制的具体原理</span>了。</p><p>这一次，我会使用一个叫<strong>kubectl set image</strong>的指令，直接修改nginx-deployment所使用的镜像。这个命令的好处就是，你可以不用像kubectl edit那样需要打开编辑器。</p><p>不过这一次，我把这个镜像名字修改成为了一个错误的名字，比如：nginx:1.91。这样，这个Deployment就会出现一个升级失败的版本。</p><p>我们一起来实践一下：</p><pre><code>$ kubectl set image deployment/nginx-deployment nginx=nginx:1.91\ndeployment.extensions/nginx-deployment image updated\n</code></pre><p>由于这个nginx:1.91镜像在Docker Hub中并不存在，所以这个Deployment的“滚动更新”被触发后，会立刻报错并停止。</p><p>这时，我们来检查一下ReplicaSet的状态，如下所示：</p><pre><code>$ kubectl get rs\nNAME                          DESIRED   CURRENT   READY   AGE\nnginx-deployment-1764197365   2         2         2       24s\nnginx-deployment-3167673210   0         0         0       35s\nnginx-deployment-2156724341   2         2         0       7s\n</code></pre><p>通过这个返回结果，我们可以看到，新版本的ReplicaSet（hash=2156724341）的“水平扩展”已经停止。而且此时，它已经创建了两个Pod，但是它们都没有进入READY状态。这当然是因为这两个Pod都拉取不到有效的镜像。</p><p>与此同时，旧版本的ReplicaSet（hash=1764197365）的“水平收缩”，也自动停止了。此时，已经有一个旧Pod被删除，还剩下两个旧Pod。</p><p>那么问题来了， 我们如何让这个Deployment的3个Pod，都回滚到以前的旧版本呢？</p><p>我们只需要执行一条kubectl rollout undo命令，就能把整个Deployment回滚到上一个版本：</p><pre><code>$ kubectl rollout undo deployment/nginx-deployment\ndeployment.extensions/nginx-deployment\n</code></pre><p>很容易想到，在具体操作上，Deployment的控制器，其实就是让这个旧ReplicaSet（hash=1764197365）再次“扩展”成3个Pod，而让新的ReplicaSet（hash=2156724341）重新“收缩”到0个Pod。</p><p>更进一步地，如果我想回滚到更早之前的版本，要怎么办呢？</p><p><strong>首先，我需要使用kubectl rollout history命令，查看每次Deployment变更对应的版本</strong>。而由于我们在创建这个Deployment的时候，指定了–record参数，所以我们创建这些版本时执行的kubectl命令，都会被记录下来。这个操作的输出如下所示：</p><pre><code>$ kubectl rollout history deployment/nginx-deployment\ndeployments &quot;nginx-deployment&quot;\nREVISION    CHANGE-CAUSE\n1           kubectl create -f nginx-deployment.yaml --record\n2           kubectl edit deployment/nginx-deployment\n3           kubectl set image deployment/nginx-deployment nginx=nginx:1.91\n</code></pre><p>可以看到，我们前面执行的创建和更新操作，分别对应了版本1和版本2，而那次失败的更新操作，则对应的是版本3。</p><p>当然，你还可以通过这个kubectl rollout history指令，看到每个版本对应的Deployment的API对象的细节，具体命令如下所示：</p><pre><code>$ kubectl rollout history deployment/nginx-deployment --revision=2\n</code></pre><p><strong>然后，我们就可以在kubectl rollout undo命令行最后，加上要回滚到的指定版本的版本号，就可以回滚到指定版本了</strong>。这个指令的用法如下：</p><pre><code>$ kubectl rollout undo deployment/nginx-deployment --to-revision=2\ndeployment.extensions/nginx-deployment\n</code></pre><p>这样，Deployment Controller还会按照“滚动更新”的方式，完成对Deployment的降级操作。</p><p>不过，你可能已经想到了一个问题：我们对Deployment进行的每一次更新操作，都会生成一个新的ReplicaSet对象，是不是有些多余，甚至浪费资源呢？</p><p>没错。</p><p>所以，Kubernetes项目还提供了一个指令，使得我们对Deployment的多次更新操作，最后 只生成一个ReplicaSet。</p><p>具体的做法是，在更新Deployment前，你要先执行一条kubectl rollout pause指令。它的用法如下所示：</p><pre><code>$ kubectl rollout pause deployment/nginx-deployment\ndeployment.extensions/nginx-deployment paused\n</code></pre><p>这个kubectl rollout pause的作用，是让这个Deployment进入了一个“暂停”状态。</p><p>所以接下来，你就可以随意使用kubectl edit或者kubectl set image指令，修改这个Deployment的内容了。</p><p>由于此时Deployment正处于“暂停”状态，所以我们对Deployment的所有修改，都不会触发新的“滚动更新”，也不会创建新的ReplicaSet。</p><p>而等到我们对Deployment修改操作都完成之后，只需要再执行一条kubectl rollout resume指令，就可以把这个Deployment“恢复”回来，如下所示：</p><pre><code>$ kubectl rollout resume deployment/nginx-deployment\ndeployment.extensions/nginx-deployment resumed\n</code></pre><p>而在这个kubectl rollout resume指令执行之前，在kubectl rollout pause指令之后的这段时间里，我们对Deployment进行的所有修改，最后只会触发一次“滚动更新”。</p><p>当然，我们可以通过检查ReplicaSet状态的变化，来验证一下kubectl rollout pause和kubectl rollout resume指令的执行效果，如下所示：</p><pre><code>$ kubectl get rs\nNAME               DESIRED   CURRENT   READY     AGE\nnginx-1764197365   0         0         0         2m\nnginx-3196763511   3         3         3         28s\n</code></pre><p>通过返回结果，我们可以看到，只有一个hash=3196763511的ReplicaSet被创建了出来。</p><p>不过，即使你像上面这样小心翼翼地控制了ReplicaSet的生成数量，随着应用版本的不断增加，Kubernetes中还是会为同一个Deployment保存很多很多不同的ReplicaSet。</p><p>那么，我们又该如何控制这些“历史”ReplicaSet的数量呢？</p><p>很简单，Deployment对象有一个字段，叫作spec.revisionHistoryLimit，就是Kubernetes为Deployment保留的“历史版本”个数。所以，如果把它设置为0，你就再也不能做回滚操作了。</p><h2>总结</h2><p>在今天这篇文章中，我为你详细讲解了Deployment这个Kubernetes项目中最基本的编排控制器的实现原理和使用方法。</p><p>通过这些讲解，你应该了解到：Deployment实际上是一个<strong>两层控制器</strong>。首先，它通过<strong>ReplicaSet的个数</strong>来描述应用的版本；然后，它再通过<strong>ReplicaSet的属性</strong>（比如replicas的值），来保证Pod的副本数量。</p><blockquote>\n<p>备注：Deployment控制ReplicaSet（版本），ReplicaSet控制Pod（副本数）。这个两层控制关系一定要牢记。</p>\n</blockquote><p>不过，相信你也能够感受到，Kubernetes项目对Deployment的设计，实际上是代替我们完成了对“应用”的抽象，使得我们可以使用这个Deployment对象来描述应用，使用kubectl rollout命令控制应用的版本。</p><p>可是，在实际使用场景中，应用发布的流程往往千差万别，也可能有很多的定制化需求。比如，我的应用可能有会话黏连（session sticky），这就意味着“滚动更新”的时候，哪个Pod能下线，是不能随便选择的。</p><p>这种场景，光靠Deployment自己就很难应对了。对于这种需求，我在专栏后续文章中重点介绍的“自定义控制器”，就可以帮我们实现一个功能更加强大的Deployment Controller。</p><p>当然，Kubernetes项目本身，也提供了另外一种抽象方式，帮我们应对其他一些用Deployment无法处理的应用编排场景。这个设计，就是对有状态应用的管理，也是我在下一篇文章中要重点讲解的内容。</p><h2>思考题</h2><p>你听说过金丝雀发布（Canary Deployment）和蓝绿发布（Blue-Green Deployment）吗？你能说出它们是什么意思吗？</p><p>实际上，有了Deployment的能力之后，你可以非常轻松地用它来实现金丝雀发布、蓝绿发布，以及A/B测试等很多应用发布模式。这些问题的答案都在<a href=\"https://github.com/ContainerSolutions/k8s-deployment-strategies/tree/master/canary\">这个GitHub库</a>，建议你在课后实践一下。</p><p>感谢你的收听，欢迎你给我留言，也欢迎分享给更多的朋友一起阅读。</p>","neighbors":{"left":{"article_title":"16 | 编排其实很简单：谈谈“控制器”模型","id":40583},"right":{"article_title":"18 | 深入理解StatefulSet（一）：拓扑状态","id":41017}},"comments":[{"had_liked":false,"id":29404,"user_name":"小龙","can_delete":false,"product_type":"c1","uid":1085610,"ip_address":"","ucode":"67E982CDA1D009","user_header":"https://static001.geekbang.org/account/avatar/00/10/90/aa/83c31ba3.jpg","comment_is_top":false,"comment_ctime":1538363564,"is_pvip":false,"replies":[{"id":"10577","content":"17门，你也厉害！","user_name":"作者回复","comment_id":29404,"uid":"1218095","ip_address":"","utype":1,"ctime":1538391456,"user_name_real":"Geek_6ef93d"}],"discussion_count":21,"race_medal":0,"score":"637193523372","product_id":100015201,"comment_content":"老师真的是厉害，我在极客时间买了17门课了，这个是含金量最高的一门","like_count":149,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425584,"discussion_content":"17门，你也厉害！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538391456,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2099265,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI7hsTibhnpQP4b5vRDibt7X9K5XDshqLWJtksQuaXtibPBLS9vJjaySv1oRjnKMtEMMyN4pJnBicM9LQ/132","nickname":"Geek_762bc5","note":"","ucode":"3547DF1DD5B144","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":335868,"discussion_content":"新人一块钱买的，这是我2020年最牛逼的一次投资","likes_number":14,"is_delete":false,"is_hidden":false,"ctime":1608360072,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1209160,"avatar":"https://static001.geekbang.org/account/avatar/00/12/73/48/ced94e09.jpg","nickname":"小超在努力","note":"","ucode":"5C04AA8A96532F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":5004,"discussion_content":"买的第6门，这个是最好的，七牛云许世伟的也很好","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1565869657,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2853149,"avatar":"https://static001.geekbang.org/account/avatar/00/2b/89/1d/d1d8edcc.jpg","nickname":"梅斌","note":"","ucode":"DDE15A3FD12738","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":1209160,"avatar":"https://static001.geekbang.org/account/avatar/00/12/73/48/ced94e09.jpg","nickname":"小超在努力","note":"","ucode":"5C04AA8A96532F","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":545310,"discussion_content":"许式伟","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1641901153,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":5004,"ip_address":""},"score":545310,"extra":""}]},{"author":{"id":1445744,"avatar":"https://static001.geekbang.org/account/avatar/00/16/0f/70/f59db672.jpg","nickname":"槑·先生","note":"","ucode":"897F0475592E3A","race_medal":2,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378735,"discussion_content":"我直接买了个全年会员，所有专栏都可以看","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1623379334,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1095819,"avatar":"https://static001.geekbang.org/account/avatar/00/10/b8/8b/68555cbf.jpg","nickname":"Geek_122dd9","note":"","ucode":"12BDEF1FC06633","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1445744,"avatar":"https://static001.geekbang.org/account/avatar/00/16/0f/70/f59db672.jpg","nickname":"槑·先生","note":"","ucode":"897F0475592E3A","race_medal":2,"user_type":1,"is_pvip":true},"discussion":{"id":585979,"discussion_content":"今年续费了吗","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1661924437,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":378735,"ip_address":"广东"},"score":585979,"extra":""}]},{"author":{"id":1218501,"avatar":"https://static001.geekbang.org/account/avatar/00/12/97/c5/84491beb.jpg","nickname":"罗峰","note":"","ucode":"5F3D6AF8F28322","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373964,"discussion_content":"我42门","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1620953840,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1325101,"avatar":"https://static001.geekbang.org/account/avatar/00/14/38/2d/9c971119.jpg","nickname":"若丶相依","note":"","ucode":"6482339C859C40","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":366892,"discussion_content":"27门","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1618212960,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1105161,"avatar":"https://static001.geekbang.org/account/avatar/00/10/dd/09/feca820a.jpg","nickname":"helloworld","note":"","ucode":"1EECCA0F43E278","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":350840,"discussion_content":"都让一让, 我已经买了46门了...","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614049166,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1064018,"avatar":"https://static001.geekbang.org/account/avatar/00/10/3c/52/5951ffb4.jpg","nickname":"Sinvi","note":"","ucode":"2A90976980CA3C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":579595,"discussion_content":"78门","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1657547737,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2930234,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/KqZeIjNOVQJnsIFkDBWl5wfaxWDGLpIMUdFbF7SQhXFavmxgpwQPj9FrGAV4xNrqd733qicT4IZVibELyziaLokDQ/132","nickname":"罗艺","note":"","ucode":"9D4E1A377BCF23","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":575215,"discussion_content":"为啥我买的这门花了快100元","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1654668368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1678432,"avatar":"","nickname":"Geek_e34009","note":"","ucode":"1D6FA1FB1411FB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":555607,"discussion_content":"咱能不能一起资源共享？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1646990351,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1315147,"avatar":"https://static001.geekbang.org/account/avatar/00/14/11/4b/fa64f061.jpg","nickname":"xfan","note":"","ucode":"48ED8D498D7F56","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":393046,"discussion_content":"我买了30门","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631236209,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2404887,"avatar":"https://static001.geekbang.org/account/avatar/00/24/b2/17/3161b49c.jpg","nickname":"达叔灬","note":"","ucode":"5CCBAF13548F02","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":391151,"discussion_content":"我以为12门的我一家够多 没想到。。。。  大意了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630316654,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1226862,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b8/6e/0aae08d6.jpg","nickname":"VincentQ","note":"","ucode":"BDA2CE2453881C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373568,"discussion_content":"兄台学完了几门...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1620786938,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1129632,"avatar":"https://static001.geekbang.org/account/avatar/00/11/3c/a0/8b9d5aca.jpg","nickname":"eagle","note":"","ucode":"D7601A2AFC1D17","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":345523,"discussion_content":"我数了一下，竟然是20门！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1611732806,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2370990,"avatar":"https://static001.geekbang.org/account/avatar/00/24/2d/ae/238c75a4.jpg","nickname":"🍭","note":"","ucode":"6AFCEAAD828DBB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":343058,"discussion_content":"这个和mysql，我花钱买的唯二的课程，用两个账号买的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1610935551,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2312457,"avatar":"https://static001.geekbang.org/account/avatar/00/23/49/09/bc54d395.jpg","nickname":"suntj","note":"","ucode":"4A0A9F7619E765","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":328247,"discussion_content":"看来需要找17个新的手机号码","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1606112705,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":2169373,"avatar":"https://static001.geekbang.org/account/avatar/00/21/1a/1d/1295e244.jpg","nickname":"TiAmo","note":"","ucode":"99F7EFB4204EF9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2312457,"avatar":"https://static001.geekbang.org/account/avatar/00/23/49/09/bc54d395.jpg","nickname":"suntj","note":"","ucode":"4A0A9F7619E765","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384367,"discussion_content":"好家伙，我直接好家伙","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626527754,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":328247,"ip_address":""},"score":384367,"extra":""},{"author":{"id":1488020,"avatar":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","nickname":"追风筝的人","note":"","ucode":"2993D60F94C396","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2312457,"avatar":"https://static001.geekbang.org/account/avatar/00/23/49/09/bc54d395.jpg","nickname":"suntj","note":"","ucode":"4A0A9F7619E765","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":530651,"discussion_content":"新手机号买了  再赠课","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1637117675,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":328247,"ip_address":""},"score":530651,"extra":"{\"user_type\":1}"}]},{"author":{"id":1284091,"avatar":"https://static001.geekbang.org/account/avatar/00/13/97/fb/2737a4e4.jpg","nickname":"xuelangos","note":"","ucode":"E05A015BF8957A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304729,"discussion_content":"19门😂","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599648667,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29369,"user_name":"胖宝王","can_delete":false,"product_type":"c1","uid":1005367,"ip_address":"","ucode":"E1B58EF4354CB0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/37/8877f206.jpg","comment_is_top":false,"comment_ctime":1538359180,"is_pvip":false,"replies":[{"id":"10567","content":"说的没错，可以看看文末的例子实践一下","user_name":"作者回复","comment_id":29369,"uid":"1218095","ip_address":"","utype":1,"ctime":1538373719,"user_name_real":"Geek_6ef93d"}],"discussion_count":4,"race_medal":0,"score":"452509925260","product_id":100015201,"comment_content":"金丝雀部署：优先发布一台或少量机器升级，等验证无误后再更新其他机器。优点是用户影响范围小，不足之处是要额外控制如何做自动更新。<br>蓝绿部署：2组机器，蓝代表当前的V1版本，绿代表已经升级完成的V2版本。通过LB将流量全部导入V2完成升级部署。优点是切换快速，缺点是影响全部用户。<br>本文学习的滚动更新，我觉得就是一个自动化更新的金丝雀发布。","like_count":106,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425566,"discussion_content":"说的没错，可以看看文末的例子实践一下","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538373719,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2147220,"avatar":"https://static001.geekbang.org/account/avatar/00/20/c3/94/e89ebc50.jpg","nickname":"神毓逍遥","note":"","ucode":"83351CB18B190E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":388280,"discussion_content":"LB(LoadBalance ) 负载均衡","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1628677890,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1447739,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eou1BMETumU21ZI4yiaLenOMSibzkAgkw944npIpsJRicmdicxlVQcgibyoQ00rdGk9Htp1j0dM5CP2Fibw/132","nickname":"寥若晨星","note":"","ucode":"2E87E43687DE72","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":394278,"discussion_content":"mark","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1631806869,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348890,"discussion_content":"不错","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1612769511,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":52640,"user_name":"黑米","can_delete":false,"product_type":"c1","uid":1018706,"ip_address":"","ucode":"E7DBEA7867862A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8b/52/6659dc1b.jpg","comment_is_top":false,"comment_ctime":1545463660,"is_pvip":false,"replies":[{"id":"19227","content":"不是第一高不开心","user_name":"作者回复","comment_id":52640,"uid":"1218095","ip_address":"","utype":1,"ctime":1545578565,"user_name_real":"Geek_6ef93d"}],"discussion_count":34,"race_medal":0,"score":"164754220908","product_id":100015201,"comment_content":"老师真的是厉害，我在极客时间买了24门课了，这个是含金量第二高的一门","like_count":39,"discussions":[{"author":{"id":1246178,"avatar":"https://static001.geekbang.org/account/avatar/00/13/03/e2/5768d26e.jpg","nickname":"inrtyx","note":"","ucode":"81CD18FF34ABAB","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":273137,"discussion_content":"我觉得第一是丁奇的mysql","likes_number":11,"is_delete":false,"is_hidden":false,"ctime":1590415413,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1807117,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM6GcSnUMzR0H9haiaAxssjibGLQMLAsPKonh50g9W2Iz38LcZNGH39HPaANLtovXTp1YvsINIZoH6F0iaSGuxJMXZS/132","nickname":"Geek_10d981","note":"","ucode":"AF4E774D17F7B9","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":229408,"discussion_content":"负责的说，我在多伦多 ，看过英文版本的原著和YOUTUBE介绍，这个课程比绝大多数英文教材都要仔细和深入，当然，这个是我个人观点","likes_number":7,"is_delete":false,"is_hidden":false,"ctime":1586644655,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1121758,"avatar":"https://static001.geekbang.org/account/avatar/00/11/1d/de/62bfa83f.jpg","nickname":"aoe","note":"","ucode":"1C6201EDB4E954","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1807117,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM6GcSnUMzR0H9haiaAxssjibGLQMLAsPKonh50g9W2Iz38LcZNGH39HPaANLtovXTp1YvsINIZoH6F0iaSGuxJMXZS/132","nickname":"Geek_10d981","note":"","ucode":"AF4E774D17F7B9","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":302868,"discussion_content":"在外国啊","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1599052796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":229408,"ip_address":""},"score":302868,"extra":""}]},{"author":{"id":1675771,"avatar":"https://static001.geekbang.org/account/avatar/00/19/91/fb/b7ec1659.jpg","nickname":"Adam HU","note":"","ucode":"342EC2A0CEAA97","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":182695,"discussion_content":"都是来追杀第一的... 哈哈哈","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1582448527,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433932,"discussion_content":"不是第一高不开心","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1545578565,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1276795,"avatar":"https://static001.geekbang.org/account/avatar/00/13/7b/7b/5b39b47b.jpg","nickname":"TIAN","note":"","ucode":"CCCF80602C1753","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296413,"discussion_content":"我觉得应该是丁奇的mysql,一样特别负责人的老师，掰开了揉碎了的讲解","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1596535030,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1445744,"avatar":"https://static001.geekbang.org/account/avatar/00/16/0f/70/f59db672.jpg","nickname":"槑·先生","note":"","ucode":"897F0475592E3A","race_medal":2,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378734,"discussion_content":"我也投丁奇的MySQL45讲一票","likes_number":4,"is_delete":false,"is_hidden":false,"ctime":1623379264,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2334257,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/4fZ9thib248ZkR1N3Eekeyb8N1V1Ud0uePctlI4VQUibPSmEZvgoP0VYl6IsVHJc7ZMiczQMtU76y6E6ag1zNAK4Q/132","nickname":"Geek_336577","note":"","ucode":"4826355EBA4950","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":347791,"discussion_content":"Mysql第一，不黑不吹。不过这门课质量也挺高，原理讲的特别透彻，点个赞。","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1612321368,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1581862,"avatar":"https://static001.geekbang.org/account/avatar/00/18/23/26/0e0dbf3a.jpg","nickname":"剑下浮云","note":"","ucode":"88C243AD628312","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":2334257,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/4fZ9thib248ZkR1N3Eekeyb8N1V1Ud0uePctlI4VQUibPSmEZvgoP0VYl6IsVHJc7ZMiczQMtU76y6E6ag1zNAK4Q/132","nickname":"Geek_336577","note":"","ucode":"4826355EBA4950","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":357052,"discussion_content":"书名是啥，求普及","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615730185,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":347791,"ip_address":""},"score":357052,"extra":""}]},{"author":{"id":1046714,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg","nickname":"约书亚","note":"","ucode":"81EA27ADD9EC1A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":244765,"discussion_content":"MySQL，可与此课并驾齐驱","likes_number":3,"is_delete":false,"is_hidden":false,"ctime":1587628335,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1007575,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/5f/d7/4e036beb.jpg","nickname":"AE","note":"","ucode":"57E32DCEC92245","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":230521,"discussion_content":"那第一高的是啥...， 信不信打屎你！ ","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1586750203,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1226862,"avatar":"https://static001.geekbang.org/account/avatar/00/12/b8/6e/0aae08d6.jpg","nickname":"VincentQ","note":"","ucode":"BDA2CE2453881C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":373560,"discussion_content":"NGINX一票 hahaha","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1620784978,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1458200,"avatar":"https://static001.geekbang.org/account/avatar/00/16/40/18/cc3804e2.jpg","nickname":"沈洪彬","note":"","ucode":"F9911236D0BA1C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":342495,"discussion_content":"mysql 一票","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1610698716,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1185156,"avatar":"https://static001.geekbang.org/account/avatar/00/12/15/84/fa6937b9.jpg","nickname":"邓俊","note":"","ucode":"FF1D20131DC05F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":329641,"discussion_content":"第一高应该是丁奇的Mysql，所幸，两本我都买了。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1606440773,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2052521,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/51/a9/741b5ad9.jpg","nickname":"FD","note":"","ucode":"ED396BD322489E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":312522,"discussion_content":"第一高是啥？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1602728230,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1266698,"avatar":"https://static001.geekbang.org/account/avatar/00/13/54/0a/9a002ad5.jpg","nickname":"Adam Lau","note":"","ucode":"7E542D6E789500","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295345,"discussion_content":"我也是来问第一高的","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1596171256,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1102557,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d2/dd/9d706f15.jpg","nickname":"赵琦","note":"","ucode":"E58701AFE398C1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":209885,"discussion_content":"同问第一哈哈","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1584685453,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1305633,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ec/21/b0fe1bfd.jpg","nickname":"Adam","note":"","ucode":"338BA720880E4F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":96698,"discussion_content":"我也想知道第一高是谁。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577087327,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1313181,"avatar":"https://static001.geekbang.org/account/avatar/00/14/09/9d/8af6cb1e.jpg","nickname":"臭猫","note":"","ucode":"5C3D1ED80055B7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":86901,"discussion_content":"我也想知道第一高是啥","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1576631669,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1196302,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/YVZRK2qibiblXm45TNejiaCtdJ4qnzC1cRyUB0vmJ5ibqenLicH1v2L0WeFAxDNjpXURKEZDXjsnjKp6SBkeqQAMurw/132","nickname":"kz","note":"","ucode":"ADDE6623EAB882","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":37000,"discussion_content":"第一高是什么\n","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1571478808,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1080395,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epBV3x04t9IOXZLO1PNwkUCYkCOrzHgUfoDvkG2cfrSht5icoPUpXOQTYiaraEnZEpGXyTwO9lWC9JA/132","nickname":"zjycff","note":"","ucode":"1FBEE1AACACCB3","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":8169,"discussion_content":"老师这个应该是第一高，根本没有第二高","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1567816561,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1199348,"avatar":"https://static001.geekbang.org/account/avatar/00/12/4c/f4/8eda0b19.jpg","nickname":"吃鸡吃鸡","note":"","ucode":"7C54E2C1A3E8B2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":588859,"discussion_content":"数据库的难度本身也比容器编排高的多。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1664181782,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"北京"},"score":3,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1033169,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/c3/d1/bdf895bf.jpg","nickname":"penng","note":"","ucode":"6087CFCB0AC434","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":583404,"discussion_content":"王争的算法课也能第一，并驾齐驱","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1660101168,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"重庆"},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1134895,"avatar":"https://static001.geekbang.org/account/avatar/00/11/51/2f/7b04140c.jpg","nickname":"孫やさん","note":"","ucode":"C60877C1C71685","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":573877,"discussion_content":"看来英雄所见略同啊 哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1653706013,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1057843,"avatar":"https://static001.geekbang.org/account/avatar/00/10/24/33/bcf37f50.jpg","nickname":"阿甘","note":"","ucode":"BC93175B70E05D","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":546946,"discussion_content":"MySQL实战45讲 和 趣谈网络协议 都很值","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1642475797,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1250003,"avatar":"https://static001.geekbang.org/account/avatar/00/13/12/d3/6c201082.jpg","nickname":"沙加","note":"","ucode":"265953125C599E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384278,"discussion_content":"都是来看第一是啥？能比这门课含金量还高","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626478135,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1106845,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e3/9d/aa3ec804.jpg","nickname":"Mr.嘿","note":"","ucode":"E551D83B8E4850","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":285301,"discussion_content":"第一高的是作者的另一部作品，我答应作者要保密的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592799883,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1747559,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/aa/67/613a7d2d.jpg","nickname":"fei","note":"","ucode":"0737275720BCD6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1106845,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e3/9d/aa3ec804.jpg","nickname":"Mr.嘿","note":"","ucode":"E551D83B8E4850","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":297579,"discussion_content":"是啥，我要买买买","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596976317,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":285301,"ip_address":""},"score":297579,"extra":""},{"author":{"id":1393961,"avatar":"https://static001.geekbang.org/account/avatar/00/15/45/29/2478f7d0.jpg","nickname":"NierDaye","note":"","ucode":"BC2E5739529CCE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1106845,"avatar":"https://static001.geekbang.org/account/avatar/00/10/e3/9d/aa3ec804.jpg","nickname":"Mr.嘿","note":"","ucode":"E551D83B8E4850","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":323968,"discussion_content":"哪个作者？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605017548,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":285301,"ip_address":""},"score":323968,"extra":""}]},{"author":{"id":1845394,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","nickname":"晞月520","note":"","ucode":"4F05E02A5C1608","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":283165,"discussion_content":"第一高到底是什么啊 好奇","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592200933,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1067943,"avatar":"https://static001.geekbang.org/account/avatar/00/10/4b/a7/abb7bfe3.jpg","nickname":"dhyuan","note":"","ucode":"7086D1871DD9A8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":256575,"discussion_content":"这课在，就没有课能称第一吧...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588497701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1209089,"avatar":"https://static001.geekbang.org/account/avatar/00/12/73/01/0aeba3d6.jpg","nickname":"火の龍果","note":"","ucode":"D59EDD5A4D3072","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":255469,"discussion_content":"那第一高的是啥？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588404100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1221633,"avatar":"https://static001.geekbang.org/account/avatar/00/12/a4/01/22729368.jpg","nickname":"Havid","note":"","ucode":"2933B4F49D7520","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":7619,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1567588493,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1162284,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKerhicfTMvNOuzHYu0iciaA5WGUjNlREuRwric0ib9SGPlR7MV0eibdeW7IsibDcb97zd8ys6pXe3fiaeC7w/132","nickname":"kurisu","note":"","ucode":"494B213C460C60","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":1222,"discussion_content":"那第一高的是啥...","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1562411696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":4,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30508,"user_name":"Pixar","can_delete":false,"product_type":"c1","uid":1197659,"ip_address":"","ucode":"E653387BA8EA16","user_header":"https://static001.geekbang.org/account/avatar/00/12/46/5b/07858c33.jpg","comment_is_top":false,"comment_ctime":1538897706,"is_pvip":false,"replies":[{"id":"11021","content":"都通过","user_name":"作者回复","comment_id":30508,"uid":"1218095","ip_address":"","utype":1,"ctime":1538953507,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"91733210922","product_id":100015201,"comment_content":"关于Pod的状态一直有一些疑问, 学完这节课就更混了, 囧.   还望老师能解答下.<br><br>`kubectl get deployments` 得到的 available 字段表示的是处于Running状态且健康检查通过的Pod, 这里有一个疑问: 健康检查不是针对Pod里面的Container吗? 如果某一个Pod里面包含多个Container, 但是这些Container健康检查有些并没有通过, 那么此时该Pod会出现在 available里面吗? <br><br>Pod通过健康检查是指里面所有的Container都通过吗?","like_count":22,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426028,"discussion_content":"都通过","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1538953507,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":124679,"user_name":"阿文","can_delete":false,"product_type":"c1","uid":1106209,"ip_address":"","ucode":"BB4DB62141971F","user_header":"https://static001.geekbang.org/account/avatar/00/10/e1/21/5f0bf9a0.jpg","comment_is_top":false,"comment_ctime":1565943154,"is_pvip":false,"replies":[{"id":"46507","content":"对","user_name":"作者回复","comment_id":124679,"uid":"1218095","ip_address":"","utype":1,"ctime":1566350981,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"87465289074","product_id":100015201,"comment_content":"注意，在这里，我额外加了一个–record 参数。它的作用，...<br><br>这个应该要解释下--record 是只记录当前命令，老师，你下面的命令没有加。history 里面只看到<br>   kubectl create --filename=nginx-deployment.yaml --record=true","like_count":21,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":463275,"discussion_content":"对","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1566350981,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":179840,"user_name":"bus801","can_delete":false,"product_type":"c1","uid":1777680,"ip_address":"","ucode":"7BBF63E76DC395","user_header":"https://static001.geekbang.org/account/avatar/00/1b/20/10/5786e0d8.jpg","comment_is_top":false,"comment_ctime":1582107901,"is_pvip":false,"replies":[{"id":"72848","content":"因为rs controller 不处理rollout逻辑","user_name":"作者回复","comment_id":179840,"uid":"1218095","ip_address":"","utype":1,"ctime":1584423835,"user_name_real":"Geek_6ef93d"}],"discussion_count":3,"race_medal":0,"score":"83186486525","product_id":100015201,"comment_content":"如果我直接edit rs，将image修改成新的版本，是不是也能实现pod中容器镜像的更新？我试了一下，什么反应也没有。既然rs控制pod，为什么这样改不能生效呢？还请指教一下","like_count":20,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":484424,"discussion_content":"因为rs controller 不处理rollout逻辑","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1584423835,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1522168,"avatar":"https://static001.geekbang.org/account/avatar/00/17/39/f8/b5a1b669.jpg","nickname":"Brilliant","note":"","ucode":"CFF4F5BCAF21EE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":586133,"discussion_content":"直接edit rs里的pod image版本，这边看到会生成新版本的rs","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1662000518,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":"上海"},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413696,"discussion_content":"Mark.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636545391,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50868,"user_name":"王由华","can_delete":false,"product_type":"c1","uid":1080681,"ip_address":"","ucode":"355CC4668A4921","user_header":"https://static001.geekbang.org/account/avatar/00/10/7d/69/21b4b5cb.jpg","comment_is_top":false,"comment_ctime":1545057632,"is_pvip":false,"replies":[{"id":"18750","content":"先term 再kill。需要处理。","user_name":"作者回复","comment_id":50868,"uid":"1218095","ip_address":"","utype":1,"ctime":1545238106,"user_name_real":"Geek_6ef93d"}],"discussion_count":6,"race_medal":0,"score":"78854468960","product_id":100015201,"comment_content":"有个问题，scale down时，k8s是对pod里的容器发送kill 信号吗？所以应用需要处理好这个信号？","like_count":18,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":433151,"discussion_content":"先term 再kill。需要处理。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1545238106,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1486268,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/SKmvhbNe9LMPQ0ib8ZqbJEYQdkHs9B4icOsU9mcbDh0XpeEibC1zXIq0q7ZS12dRzv32hOdzpubUKLFgAeIKQYZgg/132","nickname":"amither","note":"","ucode":"2F13956D35B752","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":22957,"discussion_content":"如果有prestop，先执行prestop。再发term，graceperiod到了后发kill。收到term后应用就要graceful stop了，处理完老的请求，不再接受新的请求。","likes_number":13,"is_delete":false,"is_hidden":false,"ctime":1569730875,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1837179,"avatar":"https://static001.geekbang.org/account/avatar/00/1c/08/7b/7f086546.jpg","nickname":"Alex","note":"","ucode":"70806CEA9AB15E","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1486268,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/SKmvhbNe9LMPQ0ib8ZqbJEYQdkHs9B4icOsU9mcbDh0XpeEibC1zXIq0q7ZS12dRzv32hOdzpubUKLFgAeIKQYZgg/132","nickname":"amither","note":"","ucode":"2F13956D35B752","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":348892,"discussion_content":"nice","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1612769832,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":22957,"ip_address":""},"score":348892,"extra":""}]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413697,"discussion_content":"Mark.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636545451,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2030670,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLrbCic7BckSd3xrawFH5KW0yYtI1uSsIEPFh0FIHxvHv9u6XBKgZCqH13qPbZDHTdqgevXLdGQlEw/132","nickname":"Geek_2a4536","note":"","ucode":"640A0D228B275C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":296355,"discussion_content":"web server应该都有信号处理机制","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1596519019,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1297017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ca/79/139615aa.jpg","nickname":"Magic Star Trace","note":"","ucode":"15360D39BC32D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":226239,"discussion_content":"业务项目上处理还是集群处理？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1586429378,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":36735,"user_name":"我是一根葱","can_delete":false,"product_type":"c1","uid":1028331,"ip_address":"","ucode":"6208D18E65DB2F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b0/eb/112e7d16.jpg","comment_is_top":false,"comment_ctime":1541297531,"is_pvip":false,"replies":[{"id":"13034","content":"业务需要优雅处理sig term","user_name":"作者回复","comment_id":36735,"uid":"1218095","ip_address":"","utype":1,"ctime":1541338596,"user_name_real":"Geek_6ef93d"}],"discussion_count":4,"race_medal":1,"score":"61670839675","product_id":100015201,"comment_content":"请教个问题，如果水平收缩的过程中，某个pod中的容器有正在运行的业务，而业务如果中断的话可能会导致数据库数据出错，该怎么办？如何保证把pod的业务执行完再收缩？","like_count":15,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427989,"discussion_content":"业务需要优雅处理sig term","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1541338596,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1045877,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/f5/75/abb7bfe3.jpg","nickname":"wwb1984","note":"","ucode":"6F398C5541503B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":202629,"discussion_content":"但是可能30分钟没处理完","likes_number":6,"is_delete":false,"is_hidden":false,"ctime":1583937556,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2107375,"avatar":"https://static001.geekbang.org/account/avatar/00/20/27/ef/a7f94eda.jpg","nickname":"Jerry You","note":"","ucode":"679A44B505482F","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":381787,"discussion_content":"因为业务中使用了streaming的grpc服务，导致在滚动更新的时候程序里面虽然做了grpc的graceful shutdown，但是pod收到sig term的信号时还是会直接kill掉，所有配合参数： terminationGracePeriodSeconds设置一个默认值，来让pod维持已经连接到改pod下的connection，这里同时需要将老pod的livenessprobe健康检查关掉，不然这个pod还是会有新的流量进来，用户请求可能在terminationGracePeriodSeconds之后受到影响。 关于terminationGracePeriodSeconds的设置： 定义一个场景下该业务最大可能持续的时间值，是一个预估值，只是为了尽可能减少受请求中断用户的范围。请问：还有比较优雅的做法么？ ","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1625211111,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1297017,"avatar":"https://static001.geekbang.org/account/avatar/00/13/ca/79/139615aa.jpg","nickname":"Magic Star Trace","note":"","ucode":"15360D39BC32D1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":226238,"discussion_content":"平滑下线嘛？","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1586429325,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29346,"user_name":"千寻","can_delete":false,"product_type":"c1","uid":1058635,"ip_address":"","ucode":"44A559E38819C0","user_header":"https://static001.geekbang.org/account/avatar/00/10/27/4b/170654bb.jpg","comment_is_top":false,"comment_ctime":1538356625,"is_pvip":false,"replies":[{"id":"10569","content":"service只会代理readiness检查返回正确的pod","user_name":"作者回复","comment_id":29346,"uid":"1218095","ip_address":"","utype":1,"ctime":1538373807,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"57372931473","product_id":100015201,"comment_content":"在滚动更新的过程中，Service的流量转发会有怎样的变化呢？","like_count":13,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425558,"discussion_content":"service只会代理readiness检查返回正确的pod","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538373807,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29363,"user_name":"胖宝王","can_delete":false,"product_type":"c1","uid":1005367,"ip_address":"","ucode":"E1B58EF4354CB0","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/37/8877f206.jpg","comment_is_top":false,"comment_ctime":1538358497,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"53077966049","product_id":100015201,"comment_content":"金丝雀发布：先发布一台机器或少量机器，做流量验证。如果新版没问题在把剩余机器全部更新。优点是影响范围小，不足的是要自己想办法如何控制自动更新。<br>蓝绿部署：事先准备好一组机器(绿组)全部更新，然后调整LB将流量全部引到绿组。优点是切换快捷回滚方便。不足的是有问题则影响全部用户。<br>对于本文学习的 rolling update，我理解的像是自动化更新的金丝雀发布。","like_count":12},{"had_liked":false,"id":29299,"user_name":"Tigerfive","can_delete":false,"product_type":"c1","uid":1221781,"ip_address":"","ucode":"D29522D4EFABEF","user_header":"https://static001.geekbang.org/account/avatar/00/12/a4/95/474d5eaf.jpg","comment_is_top":false,"comment_ctime":1538332129,"is_pvip":false,"replies":[{"id":"10544","content":"国庆可以充电啦","user_name":"作者回复","comment_id":29299,"uid":"1218095","ip_address":"","utype":1,"ctime":1538356796,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"44488005089","product_id":100015201,"comment_content":"半夜从火车上醒来，就来看看有没有更新，果然没有让我失望！","like_count":10,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425543,"discussion_content":"国庆可以充电啦","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538356796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":50288,"user_name":"原来只是梦","can_delete":false,"product_type":"c1","uid":1111624,"ip_address":"","ucode":"C12C59BA333C5D","user_header":"https://static001.geekbang.org/account/avatar/00/10/f6/48/b7054856.jpg","comment_is_top":false,"comment_ctime":1544944652,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"40199650316","product_id":100015201,"comment_content":"老师你好！之前有同学提到这个rollout像自动化的金丝雀发布，对于这一点我不太理解。发布的时候会是一个轮换的过程，也就是说用不了多少时间，就会都运行在新的rs，或者都回滚到老的rs(出错)。我的理解要金丝雀的话，需要保持同时存在两个rs一定时间，以确保新版本没问题。那么这个在k8s里是怎么实现呢？","like_count":9,"discussions":[{"author":{"id":1086319,"avatar":"https://static001.geekbang.org/account/avatar/00/10/93/6f/5ab3da19.jpg","nickname":"慕容","note":"","ucode":"BEE694935853E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267683,"discussion_content":"老师都额外强调了，确保新版本没问题，需要借助健康检查来实现，否则新版本是running状态，但实际并不干活。实际层面，个人认为更多的还是需要发布前的足够测试来确保新版本是符合预期的","likes_number":8,"is_delete":false,"is_hidden":false,"ctime":1589677585,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1201009,"avatar":"https://static001.geekbang.org/account/avatar/00/12/53/71/a4e9f20e.jpg","nickname":"言午木杉","note":"","ucode":"300BEDC1B07DF1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":392369,"discussion_content":"确保新版本没问题是根据健康检查来实现的，而且在 deployment 滚动更新过程中，确实就是会保存旧版本的 replicateSet，第一是为了回滚旧版本，第二是当升级出错的时候可以回退","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1630983147,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1351066,"avatar":"https://static001.geekbang.org/account/avatar/00/14/9d/9a/7f064a9f.jpg","nickname":"龙行秀","note":"","ucode":"2DA088D199EA9D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":53912,"discussion_content":"这个滚动升级还是需要人为处理的吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574233867,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":121887,"user_name":"哈希碰撞","can_delete":false,"product_type":"c1","uid":1244496,"ip_address":"","ucode":"DF82678E60095D","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q3auHgzwzM49ONuR097wB6LqR8nn5kWiaQiaPic1y8UznibDOScQergTj5qeL6zQ4bIicYEkqlMiash3CUCAYmSt9tQA/132","comment_is_top":false,"comment_ctime":1565244329,"is_pvip":false,"discussion_count":3,"race_medal":0,"score":"35924982697","product_id":100015201,"comment_content":"一个 ReplicaSet 对象,不难发现是 Deployment 的一个子集？<br>请问怎么不难发现？ 我觉得很难发现。。。从示例的YAML文件内容上看，看不出任何关连。","like_count":8,"discussions":[{"author":{"id":1710119,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/18/27/fa608a19.jpg","nickname":"小海子","note":"","ucode":"00C79AC90A165A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":44983,"discussion_content":"可以看replicaSet的ownerReference","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1572998436,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1311001,"avatar":"https://static001.geekbang.org/account/avatar/00/14/01/19/f4da2829.jpg","nickname":"一秒","note":"","ucode":"F149B7F60620BD","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1710119,"avatar":"https://static001.geekbang.org/account/avatar/00/1a/18/27/fa608a19.jpg","nickname":"小海子","note":"","ucode":"00C79AC90A165A","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352066,"discussion_content":"在Deployment的yaml文件中看不出来啊","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1614588701,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":44983,"ip_address":""},"score":352066,"extra":""}]},{"author":{"id":2070152,"avatar":"https://static001.geekbang.org/account/avatar/00/1f/96/88/360b9b7f.jpg","nickname":"Free","note":"","ucode":"ABD6430AEB4183","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":549832,"discussion_content":"控制的是同一个容器 ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644249478,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":53072,"user_name":"黑米","can_delete":false,"product_type":"c1","uid":1018706,"ip_address":"","ucode":"E7DBEA7867862A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/8b/52/6659dc1b.jpg","comment_is_top":false,"comment_ctime":1545579253,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"35905317621","product_id":100015201,"comment_content":"不用不高兴，你第二没人敢认第一👍","like_count":8},{"had_liked":false,"id":31764,"user_name":"Nokiak8","can_delete":false,"product_type":"c1","uid":1230506,"ip_address":"","ucode":"8063D1A3F06842","user_header":"","comment_is_top":false,"comment_ctime":1539299926,"is_pvip":false,"replies":[{"id":"11462","content":"successfulJobsHistoryLimit和failedJobsHistoryLimit","user_name":"作者回复","comment_id":31764,"uid":"1218095","ip_address":"","utype":1,"ctime":1539308896,"user_name_real":"Geek_6ef93d"}],"discussion_count":1,"race_medal":0,"score":"35899038294","product_id":100015201,"comment_content":"Cronjob 类型也有spec.revisionHistoryLimit么？","like_count":8,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426499,"discussion_content":"successfulJobsHistoryLimit和failedJobsHistoryLimit","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1539308896,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29495,"user_name":"小小笑儿","can_delete":false,"product_type":"c1","uid":1040354,"ip_address":"","ucode":"CA63CC50DC2091","user_header":"https://static001.geekbang.org/account/avatar/00/0f/df/e2/823a04b4.jpg","comment_is_top":false,"comment_ctime":1538394897,"is_pvip":false,"replies":[{"id":"10639","content":"回滚又不是创建新版本，版本与rs一一对应，怎么会出现新的rs呢？滚动升级反向操作即可。<br><br>它只关心pod被全删除的情况，因为有一种滚动更新策略是这时候重新创建新的deployment ","user_name":"作者回复","comment_id":29495,"uid":"1218095","ip_address":"","utype":1,"ctime":1538438486,"user_name_real":"Geek_6ef93d"}],"discussion_count":2,"race_medal":0,"score":"35898133265","product_id":100015201,"comment_content":"有几个问题想请问一下:<br>1是在 deployment rollout undo 的时候，是也会创建一个新的rs对象吗？如果是的话那么这个rs的template hash不就重复了？如果不是得话又是如何处理的呢？<br>2是deployment 关注的应该是自身的api对象和rs的api对象，但是我看deployment controller 的源码中也关注了pod的变更，这是为了处理哪种情况？","like_count":8,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425641,"discussion_content":"回滚又不是创建新版本，版本与rs一一对应，怎么会出现新的rs呢？滚动升级反向操作即可。\n\n它只关心pod被全删除的情况，因为有一种滚动更新策略是这时候重新创建新的deployment ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538438486,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1113864,"avatar":"https://static001.geekbang.org/account/avatar/00/10/ff/08/7c18d8a4.jpg","nickname":"团","note":"","ucode":"D56ABBCE4E4D90","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":413700,"discussion_content":"Mark.","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1636545624,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":130909,"user_name":"思维决定未来","can_delete":false,"product_type":"c1","uid":1412891,"ip_address":"","ucode":"88CC245B3C6E2D","user_header":"","comment_is_top":false,"comment_ctime":1567571175,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"27337374951","product_id":100015201,"comment_content":"金丝雀和蓝绿发布实际是在流量入口(Ingress)来控制的，并不是通过其他Controller来控制Deployment，在更新时，直接部署一个新的Deployment，然后通过调整流量比例到不同的Deployment从而实现对应更新，而蓝绿和金丝雀的区别就是新版本的Deployment是否一次性将副本数开到跟原Deployment一样多。","like_count":7,"discussions":[{"author":{"id":1073666,"avatar":"https://static001.geekbang.org/account/avatar/00/10/62/02/2370d8c0.jpg","nickname":"浮白","note":"","ucode":"6FB94B1EB3D4F6","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301484,"discussion_content":"ISTIO里是在service层控制的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598536730,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1412891,"avatar":"","nickname":"思维决定未来","note":"","ucode":"88CC245B3C6E2D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1073666,"avatar":"https://static001.geekbang.org/account/avatar/00/10/62/02/2370d8c0.jpg","nickname":"浮白","note":"","ucode":"6FB94B1EB3D4F6","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301988,"discussion_content":"求指导","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598751138,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":301484,"ip_address":""},"score":301988,"extra":""}]},{"author":{"id":1228340,"avatar":"https://static001.geekbang.org/account/avatar/00/12/be/34/de6d9ce7.jpg","nickname":"李显良","note":"","ucode":"0A79CB419E4F89","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":282944,"discussion_content":"金丝雀的流量不一定流量从ingress控制，也可以是service\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1592124401,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1412891,"avatar":"","nickname":"思维决定未来","note":"","ucode":"88CC245B3C6E2D","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1228340,"avatar":"https://static001.geekbang.org/account/avatar/00/12/be/34/de6d9ce7.jpg","nickname":"李显良","note":"","ucode":"0A79CB419E4F89","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":301989,"discussion_content":"如何做？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1598751178,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":282944,"ip_address":""},"score":301989,"extra":""}]}]},{"had_liked":false,"id":320394,"user_name":"与君共勉","can_delete":false,"product_type":"c1","uid":1763046,"ip_address":"","ucode":"1FB5EBFCF510A1","user_header":"","comment_is_top":false,"comment_ctime":1636291644,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"14521193532","product_id":100015201,"comment_content":"我看完了“kubenetes权威指南”这本书，感觉这本书很像是使用指导，深度不够，还是张老师的课程有些深度。“kubenetes权威指南”是这样讲Deployment和ReplicateSet的区别的：Deployment继承了ReplicateSet的所有功能，让我以为他们是继承关系，认为Deployment是增强版的ReplicateSet。看了老师的文章才知道，Deployment控制的是ReplicateSet，ReplicateSet控制的是pods数量，Deployment是通过ReplicateSet间接控制了pod的数目。","like_count":4},{"had_liked":false,"id":29450,"user_name":"阿鹏","can_delete":false,"product_type":"c1","uid":1207915,"ip_address":"","ucode":"88C847A20EEA9A","user_header":"https://static001.geekbang.org/account/avatar/00/12/6e/6b/9c3f3abb.jpg","comment_is_top":false,"comment_ctime":1538377708,"is_pvip":false,"replies":[{"id":"10575","content":"为什么是 或者？宿主机和容器网络互通是基本假设。","user_name":"作者回复","comment_id":29450,"uid":"1218095","ip_address":"","utype":1,"ctime":1538387819,"user_name_real":"Geek_6ef93d"}],"discussion_count":2,"race_medal":0,"score":"14423279596","product_id":100015201,"comment_content":"老师，我们公司准备试水k8s，我看网上很多文章都在说跨主机容器间通信的解决方案，如果我们的服务分批容器化，需要解决宿主机网络和容器网络的互通，我用flannel或者calico目前都只能做到宿主机能访问容器网络或者容器能访问宿主机网络，不能做到双向通讯，老师能指点一下吗？","like_count":3,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425613,"discussion_content":"为什么是 或者？宿主机和容器网络互通是基本假设。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538387819,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1207457,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6c/a1/80d83f0a.jpg","nickname":"Ellison","note":"","ucode":"A2FB94D4F6A332","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327467,"discussion_content":"如果跟宿主机共享网络， 可以用hostNetwork: true","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1605845617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":244305,"user_name":"ch_ort","can_delete":false,"product_type":"c1","uid":1580926,"ip_address":"","ucode":"B79746E687F29E","user_header":"","comment_is_top":false,"comment_ctime":1598454726,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10188389318","product_id":100015201,"comment_content":"控制器模式： 获取对象的期望状态和当前状态，对比这两个状态，如果不一致就做相应的动作来让当前状态和期望状态一致。<br><br>Deployment通过控制器模式控制ReplicaSet来实现“水平扩展&#47;收缩”、“滚动更新”，“版本控制”。ReplicaSet通过控制器模式来维持Pod的副本数量。<br><br>滚动更新： 你的游戏角色装备了一套一级铭文，现在有一套二级铭文可以替换。一个个替换，一次替换一个铭文，这就是滚动更新。<br>","like_count":2},{"had_liked":false,"id":235210,"user_name":"stackWarn","can_delete":false,"product_type":"c1","uid":1002005,"ip_address":"","ucode":"89672E452DEBA5","user_header":"https://static001.geekbang.org/account/avatar/00/0f/4a/15/106eaaa8.jpg","comment_is_top":false,"comment_ctime":1594944929,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10184879521","product_id":100015201,"comment_content":"更正一个错误 revision读音    [英] [rɪˈvɪʒ(ə)n]，修订的意思。读reversion 误认为是re-版本的意思","like_count":2},{"had_liked":false,"id":219385,"user_name":"along2018","can_delete":false,"product_type":"c1","uid":1109053,"ip_address":"","ucode":"181A4C5266DCFE","user_header":"https://static001.geekbang.org/account/avatar/00/10/ec/3d/a8b38ce3.jpg","comment_is_top":false,"comment_ctime":1590021109,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"10179955701","product_id":100015201,"comment_content":"一个 ReplicaSet 对象，其实就是由副本数目的定义和一个 Pod 模板组成的。不难发现，它的定义其实是 Deployment 的一个子集。<br>怎么看出是一个Deployment的子集？求解释","like_count":2,"discussions":[{"author":{"id":1579113,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLGTgnCUZbXpDCeia2RdXVmP5aQdxTPNR5iaGUhhUfyEMHL9wnOHIsTmt4FJicceB0DBQZlUYTcqkLkw/132","nickname":"jumpingwa","note":"","ucode":"78005B31EFF335","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287919,"discussion_content":"可以看replicaSet的metadata:ownerReference","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593589134,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":276335,"user_name":"杨","can_delete":false,"product_type":"c1","uid":1971269,"ip_address":"","ucode":"7EFEFE285975C6","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/oltLEqTrmHm2aJP99BK6tHu5h7hp4aj08wR5Wt6H31iadFduDAVvjYKmhQ2nvGbLV3lkVdiat2GRasgWXoJeTibUg/132","comment_is_top":false,"comment_ctime":1611887998,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5906855294","product_id":100015201,"comment_content":"金丝雀发布：将一部分机器更新为新版本  然后通过日志等监控手段来查看运行状态，如果正常将剩下的机器更新为新版本，不正常回退。优点影响小，缺点发布麻烦<br>蓝绿发布：发布两套环境，一套蓝组(老的版本)、一套绿组(新的版本) 发布时将蓝组切换为绿组,有问题立即回退蓝组。优点：发布迅速回退迅速 缺点：需要两套设备<br>滚动更新发布:类似k8s也是现在最主流的发布方式，先移除一个老版本，然后新增一个新版本，循环更新，将所有的旧版本变为新版本。当然如果新版本有问题，就可以进行回滚，回滚过程和发布过程一样，只是一个逆向过程","like_count":1},{"had_liked":false,"id":223983,"user_name":"小孩","can_delete":false,"product_type":"c1","uid":1112367,"ip_address":"","ucode":"A7F587FC641E63","user_header":"https://static001.geekbang.org/account/avatar/00/10/f9/2f/01b32495.jpg","comment_is_top":false,"comment_ctime":1591249467,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5886216763","product_id":100015201,"comment_content":"滚动更新会不会存在新旧版本服务返回不一致情况","like_count":1,"discussions":[{"author":{"id":1207457,"avatar":"https://static001.geekbang.org/account/avatar/00/12/6c/a1/80d83f0a.jpg","nickname":"Ellison","note":"","ucode":"A2FB94D4F6A332","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":327466,"discussion_content":"这个就要看你的健康检查机制了， service代理的前提是， readlivess通过检查","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1605845539,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219247,"user_name":"ben","can_delete":false,"product_type":"c1","uid":1107408,"ip_address":"","ucode":"023B9DBDA43554","user_header":"https://static001.geekbang.org/account/avatar/00/10/e5/d0/c93e55aa.jpg","comment_is_top":false,"comment_ctime":1589975217,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"5884942513","product_id":100015201,"comment_content":"问大家个问题哈，假如在做升级的时候，有个pod正在跑一个长的事务，如果这个时候升级把这个pod给杀了，那么这个事务也就断了，有没有什么方法可以控制等pod里面的程序跑完了在滚动更新呢？或者说k8s是怎么处理这种情况呢？谢谢！","like_count":1,"discussions":[{"author":{"id":2238479,"avatar":"https://static001.geekbang.org/account/avatar/00/22/28/0f/e0abc71b.jpg","nickname":"站在树上的松鼠","note":"","ucode":"10D1D71BF988AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339550,"discussion_content":"这个应该是业务程序需要优雅的处理sig term信号呢，杀pod是先发送term信号，间隔一段时间如果没反应，再发送kill信号给pod。","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1609729987,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1174491,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/YlhEhLOxBkVdWfggdGeZmibw3PRXQicuicVsN2nwdrfZhsTLye2MR0nYvmYGO9TjTjEiceIEjIkxZ9bTXdtzNDLa3Q/132","nickname":"stone","note":"","ucode":"336DDEC95DF202","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":279151,"discussion_content":"前面讲了prestop，是同步的啊","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1591285785,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":187686,"user_name":"猪尾巴","can_delete":false,"product_type":"c1","uid":1169487,"ip_address":"","ucode":"4BDA1DB1A8A1B3","user_header":"https://static001.geekbang.org/account/avatar/00/11/d8/4f/4ec15857.jpg","comment_is_top":false,"comment_ctime":1584192872,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5879160168","product_id":100015201,"comment_content":"金丝雀发布的话 应该要和probe 探针做配合 来完成吧。 ","like_count":1},{"had_liked":false,"id":135110,"user_name":"云学","can_delete":false,"product_type":"c1","uid":1027233,"ip_address":"","ucode":"366AE90BA06356","user_header":"https://static001.geekbang.org/account/avatar/00/0f/ac/a1/43d83698.jpg","comment_is_top":false,"comment_ctime":1569030335,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5863997631","product_id":100015201,"comment_content":"deployment与replicaset的关系在暂态(升级&#47;扩容)时是1:2，在稳定态是1:1，从软件设计的角度看，deployment~replicaset~pod 这样划分使得职责非常清晰","like_count":1},{"had_liked":false,"id":124233,"user_name":"DI-陈赜（ze）","can_delete":false,"product_type":"c1","uid":1021421,"ip_address":"","ucode":"2EDABDDB80F2C5","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJUSUdGJFtQolpA8mANMZnjXB18ibmx5JRhI0byF4jb29qNghKoEk9EDJNIIiayJDCnqZLSutX3pXnQ/132","comment_is_top":false,"comment_ctime":1565838753,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5860806049","product_id":100015201,"comment_content":"revisionHistoryLimit默认是10个版本<br>","like_count":1,"discussions":[{"author":{"id":1579113,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLGTgnCUZbXpDCeia2RdXVmP5aQdxTPNR5iaGUhhUfyEMHL9wnOHIsTmt4FJicceB0DBQZlUYTcqkLkw/132","nickname":"jumpingwa","note":"","ucode":"78005B31EFF335","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288382,"discussion_content":"不全对，跟apiVersion有关，有的是2有的是10","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593739550,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":51334,"user_name":"Sir","can_delete":false,"product_type":"c1","uid":1204383,"ip_address":"","ucode":"B79B31FC543700","user_header":"https://static001.geekbang.org/account/avatar/00/12/60/9f/f939681f.jpg","comment_is_top":false,"comment_ctime":1545174669,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5840141965","product_id":100015201,"comment_content":"老师您好，我们有一个集群，滚动升级，遇到新的deploy已经健康了，老的deploy一直还在，持续很久！不知道老师遇到过嘛~","like_count":1},{"had_liked":false,"id":36435,"user_name":"Yao1931","can_delete":false,"product_type":"c1","uid":1219014,"ip_address":"","ucode":"FDF907E94C5574","user_header":"https://static001.geekbang.org/account/avatar/00/12/99/c6/fcb91141.jpg","comment_is_top":false,"comment_ctime":1541118227,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5836085523","product_id":100015201,"comment_content":"知识点好多的一节课！！老师写的都很透彻！","like_count":1},{"had_liked":false,"id":29353,"user_name":"虎虎❤️","can_delete":false,"product_type":"c1","uid":1086535,"ip_address":"","ucode":"157F261E80291A","user_header":"https://static001.geekbang.org/account/avatar/00/10/94/47/75875257.jpg","comment_is_top":false,"comment_ctime":1538357280,"is_pvip":false,"replies":[{"id":"10568","content":"就是desired * 0.25","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538373760,"ip_address":"","comment_id":29353,"utype":1}],"discussion_count":1,"race_medal":0,"score":"5833324576","product_id":100015201,"comment_content":"滚动升级指定比例的pod处于离线或新建，这个desired 值25%怎么算的呢？分子和分母各是什么？<br>国庆有时间充电，多来点内容呀！加油！","like_count":1,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425561,"discussion_content":"就是desired * 0.25","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538373760,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":351472,"user_name":"looper","can_delete":false,"product_type":"c1","uid":1238396,"ip_address":"","ucode":"DA4BCE83836C04","user_header":"https://static001.geekbang.org/account/avatar/00/12/e5/7c/2a5a418b.jpg","comment_is_top":false,"comment_ctime":1657812426,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1657812426","product_id":100015201,"comment_content":"打卡，把本节的指令都敲了一遍","like_count":0},{"had_liked":false,"id":342322,"user_name":"寒俊","can_delete":false,"product_type":"c1","uid":1398674,"ip_address":"","ucode":"5D679B0BC5A60B","user_header":"https://static001.geekbang.org/account/avatar/00/15/57/92/46721c5f.jpg","comment_is_top":false,"comment_ctime":1650189377,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1650189377","product_id":100015201,"comment_content":"deployment.yaml<br>--------<br>apiVersion: apps&#47;v1<br>kind: Deployment<br>metadata:<br>  name: ktest-deployment<br>spec:<br>  selector:<br>    matchLabels:<br>      app: ktest<br>  replicas: 4<br>  template:<br>    metadata:<br>      labels:<br>        app: ktest<br>    spec:<br>      containers:<br>      - name: ktestct<br>        image: yusj&#47;ktest:1.0<br>        ports:<br>        - containerPort: 8080<br><br><br><br>文件里边的 镜像是我自己打包的一个springboot helloworld。kubectl apply -f **.yaml   重新deployment  时。是滚动更新的。但为什么会有 10几秒的 服务不能访问呢？既然滚动更新，应该总会有pod 可用才对？<br><br><br>","like_count":0},{"had_liked":false,"id":335670,"user_name":"无关风月","can_delete":false,"product_type":"c1","uid":1950389,"ip_address":"","ucode":"F5979EB048F7FE","user_header":"","comment_is_top":false,"comment_ctime":1645620926,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1645620926","product_id":100015201,"comment_content":"老师，如果先用kubectl apply -f deployment.yml 后，立即用kubectl rollout pause ，能够暂停deployment的部署吗？","like_count":0},{"had_liked":false,"id":321960,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1637118074,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637118074","product_id":100015201,"comment_content":"备注：Deployment 控制 ReplicaSet（版本），ReplicaSet 控制 Pod（副本数）。这个两层控制关系一定要牢记。","like_count":0},{"had_liked":false,"id":321958,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1637117792,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637117792","product_id":100015201,"comment_content":"Deployment 控制 ReplicaSet（版本），ReplicaSet 控制 Pod（副本数）。这个两层控制关系一定要牢记。","like_count":0},{"had_liked":false,"id":321957,"user_name":"追风筝的人","can_delete":false,"product_type":"c1","uid":1488020,"ip_address":"","ucode":"2993D60F94C396","user_header":"https://static001.geekbang.org/account/avatar/00/16/b4/94/2796de72.jpg","comment_is_top":false,"comment_ctime":1637117749,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1637117749","product_id":100015201,"comment_content":"Deployment 实际上是一个两层控制器。首先，它通过 ReplicaSet 的个数来描述应用的版本；然后，它再通过 ReplicaSet 的属性（比如 replicas 的值），来保证 Pod 的副本数量。备注：Deployment 控制 ReplicaSet（版本），ReplicaSet 控制 Pod（副本数）。这个两层控制关系一定要牢记。","like_count":0},{"had_liked":false,"id":320962,"user_name":"随缘","can_delete":false,"product_type":"c1","uid":1333602,"ip_address":"","ucode":"0A787D3BC7A9A3","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI3C6aiaBgp29xyRr0cqdf6EDDlIukyTT5w9JxJeY4Vgouzr0o47wp4ibTutS0h8R8g4IC25FZ3icicDw/132","comment_is_top":false,"comment_ctime":1636598836,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1636598836","product_id":100015201,"comment_content":"pause 和 resume 实际上是不是就是类比于edit 编辑了一次","like_count":0},{"had_liked":false,"id":314939,"user_name":"陈斯佳","can_delete":false,"product_type":"c1","uid":1259323,"ip_address":"","ucode":"C236F874FC767A","user_header":"https://static001.geekbang.org/account/avatar/00/13/37/3b/495e2ce6.jpg","comment_is_top":false,"comment_ctime":1633599169,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1633599169","product_id":100015201,"comment_content":"第十七课:经典PaaS的记忆:作业副本与水平扩展<br>deployment通过操控replicaset来实现对pod的副本控制、水平扩展以及滚动更新，并且通过创建不同的replicaset来实现不同的发布版本控制","like_count":0},{"had_liked":false,"id":313482,"user_name":"DramaColin","can_delete":false,"product_type":"c1","uid":2747868,"ip_address":"","ucode":"F505F21FD45042","user_header":"","comment_is_top":false,"comment_ctime":1632457241,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632457241","product_id":100015201,"comment_content":"ReplicaSet通过控制器模式来使得Pod数量来达到期望值，那么Deployment通过控制器模式想让ReplicaSet达到什么样的一个期望状态呢？","like_count":0},{"had_liked":false,"id":312986,"user_name":"熊伟楠","can_delete":false,"product_type":"c1","uid":1930602,"ip_address":"","ucode":"3677EE3957CAA2","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/mstClEX5QgywKCOMj0R8DkX3FiayxxQNhyxw1xQia1sSMcbciavpu0fiay4uoAD0RcDyphB1YGgxC4U7tLsD13CbeQ/132","comment_is_top":false,"comment_ctime":1632188946,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1632188946","product_id":100015201,"comment_content":"如果apply的时候没有加--record如何通过rollout history找到之前的version呢？","like_count":0},{"had_liked":false,"id":311309,"user_name":"没伞的孩子得使劲奔跑","can_delete":false,"product_type":"c1","uid":1145779,"ip_address":"","ucode":"D015B4EF12E536","user_header":"https://static001.geekbang.org/account/avatar/00/11/7b/b3/194f7f90.jpg","comment_is_top":false,"comment_ctime":1631167225,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"1631167225","product_id":100015201,"comment_content":"类似腾讯云上面，回滚时，如果选择版本号？ <br>比如：<br>REVISION  CHANGE-CAUSE<br>1         v1.0<br>2         v1.1<br>3         v1.2","like_count":0},{"had_liked":false,"id":307586,"user_name":"胡志聰","can_delete":false,"product_type":"c1","uid":2500335,"ip_address":"","ucode":"7003A094FAB027","user_header":"https://static001.geekbang.org/account/avatar/00/26/26/ef/86944a28.jpg","comment_is_top":false,"comment_ctime":1629166558,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1629166558","product_id":100015201,"comment_content":"这是唯一一门我追着看的课。","like_count":0},{"had_liked":false,"id":300310,"user_name":"金时","can_delete":false,"product_type":"c1","uid":1120428,"ip_address":"","ucode":"3491B2367A7238","user_header":"https://static001.geekbang.org/account/avatar/00/11/18/ac/4d68ba46.jpg","comment_is_top":false,"comment_ctime":1625107370,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1625107370","product_id":100015201,"comment_content":"文章中说滚动更新失败了， 旧版本pod的删除了一个。这里我有个混淆点，滚动更新过程中，是新版本ready了，再删除旧版本的，还是新版本创建和就版本删除同时进行的？","like_count":0},{"had_liked":false,"id":297091,"user_name":"Dream","can_delete":false,"product_type":"c1","uid":2647659,"ip_address":"","ucode":"01B8AAF5D4DDD7","user_header":"","comment_is_top":false,"comment_ctime":1623306566,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1623306566","product_id":100015201,"comment_content":"老师有一个疑问：在使用 ”kubectl set image deploy“更新镜像以后，会同时生成一个rs。但是以前的rs在新的镜像更新完成以后为什么还一直存在没有消失。<br><br>[root@k8s-master1 ~]# kubectl get rs <br>NAME                                           DESIRED   CURRENT   READY   AGE<br>nginx-6799fc88d8                               1         1         1       27h<br>nginx-test-6969c7bb7f                          0         0         0       21h<br>nginx-test-6b949ccd5d                          1         1         1       35s<br>nginx-test-795d659f45                          0         0         0       21h","like_count":0},{"had_liked":false,"id":287414,"user_name":"李显良","can_delete":false,"product_type":"c1","uid":1228340,"ip_address":"","ucode":"0A79CB419E4F89","user_header":"https://static001.geekbang.org/account/avatar/00/12/be/34/de6d9ce7.jpg","comment_is_top":false,"comment_ctime":1617936832,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1617936832","product_id":100015201,"comment_content":"金丝雀部署：少量流量切换到新版本，通过少量流量验证服务正确性；后续渐进替换老版本，可以理解为滚动流量切换<br>蓝绿发布：部署和老版本同等规模的新版本应用，通过LB做流量切换；需要额外多一倍的机器资源","like_count":0},{"had_liked":false,"id":281267,"user_name":"吕超","can_delete":false,"product_type":"c1","uid":1740409,"ip_address":"","ucode":"B36883984BE16B","user_header":"https://static001.geekbang.org/account/avatar/00/1a/8e/79/f9d5dd3a.jpg","comment_is_top":false,"comment_ctime":1614671097,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1614671097","product_id":100015201,"comment_content":"我发向创建deployment的时候不带--record，后面edit之后，也是可以undo的，只不过history里只显示一排&lt;none&gt;，所以--record的目的只是单纯的罗列修改记录，而deployment的版本管理是本身就自带的。","like_count":0,"discussions":[{"author":{"id":1970516,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLK4NPyaFDl4rzrd4A9z42tQDibFLdCicbrAdyUa5P2B5u8UCUBenpHX7VgUCibvHvhpza4icMBKVnhmA/132","nickname":"学无止境","note":"","ucode":"2C28E8E54DAB4E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389430,"discussion_content":"是自带，老师意思加--record，可以详细记录你的操作细节，这样回滚更有目的性","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629275074,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":277936,"user_name":"叶峥瑶","can_delete":false,"product_type":"c1","uid":1797584,"ip_address":"","ucode":"170E0F29BC6D4D","user_header":"","comment_is_top":false,"comment_ctime":1612675834,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1612675834","product_id":100015201,"comment_content":"Deployment的版本管理，rollingupdate还是需要用版本管理工具管理起来的 实际使用时不会这样敲命令来完成 ","like_count":0},{"had_liked":false,"id":238545,"user_name":"陈水金","can_delete":false,"product_type":"c1","uid":1085908,"ip_address":"","ucode":"2CF1FDE6E5EE4D","user_header":"https://static001.geekbang.org/account/avatar/00/10/91/d4/f530914a.jpg","comment_is_top":false,"comment_ctime":1596193836,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1596193836","product_id":100015201,"comment_content":"老师您好，ReplicaSet中的replicas控制pod副本数，那Deployment 的yaml文件中replicas字段的意义是什么呢，期待老师您的指点","like_count":0,"discussions":[{"author":{"id":1637475,"avatar":"https://static001.geekbang.org/account/avatar/00/18/fc/63/bcda2f87.jpg","nickname":"熊","note":"","ucode":"B6423D29701EC5","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":304508,"discussion_content":"rs 是由deployment生成的呀 所以rs中的replicas字段就是由deployment的replicas字段生成的 这是个两层控制器","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1599583623,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":228389,"user_name":"晞月520","can_delete":false,"product_type":"c1","uid":1845394,"ip_address":"","ucode":"4F05E02A5C1608","user_header":"https://static001.geekbang.org/account/avatar/00/1c/28/92/436735f5.jpg","comment_is_top":false,"comment_ctime":1592655946,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1592655946","product_id":100015201,"comment_content":"一般生产环境回滚不会用什么 rollout 吧 ？直接把 yaml 文件的 镜像改回之前的  不就回滚了嘛","like_count":0,"discussions":[{"author":{"id":1579113,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLGTgnCUZbXpDCeia2RdXVmP5aQdxTPNR5iaGUhhUfyEMHL9wnOHIsTmt4FJicceB0DBQZlUYTcqkLkw/132","nickname":"jumpingwa","note":"","ucode":"78005B31EFF335","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":287920,"discussion_content":"改yaml又执行一遍rolling update了","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1593589266,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1103556,"avatar":"https://static001.geekbang.org/account/avatar/00/10/d6/c4/27343f76.jpg","nickname":"SHift","note":"","ucode":"36BD4A38F7FA2C","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":293647,"discussion_content":"因为应用版本不仅仅只有代码或者镜像，还有包括内存和cpu资源等等","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1595604628,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":219321,"user_name":"木推瓜","can_delete":false,"product_type":"c1","uid":1157981,"ip_address":"","ucode":"B8824E09C41611","user_header":"https://static001.geekbang.org/account/avatar/00/11/ab/5d/c15b2e88.jpg","comment_is_top":false,"comment_ctime":1589988197,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1589988197","product_id":100015201,"comment_content":"想确认一下，当 Deployment 在做滚动更新的时候，每次 Reconcile loop 中扩容新的 ReplicaSet 后，是需要等待新 Pod 通过 readinessProbe 后，才会进行旧的 ReplicaSet 的缩容是么？","like_count":0},{"had_liked":false,"id":213301,"user_name":"黄猛","can_delete":false,"product_type":"c1","uid":1986193,"ip_address":"","ucode":"6A8F76316661EE","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/v2NFObAXQDHYSQpBqeab9M1hEGbaz3RAgOst4njjmiaWAzYNRLo2XqIcj1HRbmJKf5Vq1bWoq4vqfITEfWoicAMA/132","comment_is_top":false,"comment_ctime":1588380691,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1588380691","product_id":100015201,"comment_content":"这里有个疑问，滚动更新时控制的是副本集，对于上层的service,什么时候切换到新的pod,期间会涉及到外部请求负载到旧版本的pod吗？","like_count":0,"discussions":[{"author":{"id":1086319,"avatar":"https://static001.geekbang.org/account/avatar/00/10/93/6f/5ab3da19.jpg","nickname":"慕容","note":"","ucode":"BEE694935853E1","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":267698,"discussion_content":"理论上分析肯定有这个情况，不然就不会抛出金丝雀发布和蓝绿发布的概念了。只要pod是就绪状态，不管版本老旧，都会被访问到，老版本在滚动更新过程中被下线，状态变为不可用后，才会从service里面剔除掉","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1589678566,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":190883,"user_name":"Geek_c22199","can_delete":false,"product_type":"c1","uid":1441876,"ip_address":"","ucode":"1CE5B65513E360","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI2vn8hyjICTCletGs0omz28lhriaZKX2XX9icYzAEon2IEoRnlXqyOia2bEPP0j7T6xexTnr77JJic8w/132","comment_is_top":false,"comment_ctime":1584705010,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1584705010","product_id":100015201,"comment_content":"发现一处描述可能不太准确，今天部署的时候发现nginx-deployment 部署后rs 的名称是nginx-deployment-d7b764d88，使用describe命令查看这个rs，Labels字段中pod-template-hash=83632084，名称后的随机字符串与pod-template-hash值并不一样！官网描述中写的是随机字符串是随机生成并以pod-template-hash作为种子","like_count":0},{"had_liked":false,"id":184367,"user_name":"君君","can_delete":false,"product_type":"c1","uid":1046711,"ip_address":"","ucode":"0E8F1058F01C28","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erRDnCKfAWyOSUfU9hI8gYu2qsMOUwnFlCSngM0a9hbdnMmqHmBlziajorVdm9NGjx23SlAJXvicHGQ/132","comment_is_top":false,"comment_ctime":1583299541,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1583299541","product_id":100015201,"comment_content":"老师讲的真好。k8s的组件，概念，配置项实在太多了，要慢慢消化","like_count":0},{"had_liked":false,"id":117272,"user_name":"胡家鹏","can_delete":false,"product_type":"c1","uid":1109940,"ip_address":"","ucode":"1636F84062948B","user_header":"https://static001.geekbang.org/account/avatar/00/10/ef/b4/61fb4dba.jpg","comment_is_top":false,"comment_ctime":1564017693,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"1564017693","product_id":100015201,"comment_content":"更新执行暂停后，会暂停pod对外提供服务吗","like_count":0,"discussions":[{"author":{"id":1014665,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/89/34f2cbcc.jpg","nickname":"杨宇","note":"","ucode":"EB74DF6E269F03","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405862,"discussion_content":"不会，Deployment不插手就代表维持现状。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634654142,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":107466,"user_name":"GLADIATOR","can_delete":false,"product_type":"c1","uid":1448564,"ip_address":"","ucode":"6FE14E0BCD6240","user_header":"https://static001.geekbang.org/account/avatar/00/16/1a/74/8f7f8786.jpg","comment_is_top":false,"comment_ctime":1561540145,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561540145","product_id":100015201,"comment_content":"老师，我想问一下，之前推荐使用用apply，为啥后面又都用了create啊，是不是还要分场景？","like_count":0},{"had_liked":false,"id":105992,"user_name":"Geek_8b2e4b","can_delete":false,"product_type":"c1","uid":1563174,"ip_address":"","ucode":"ED340997291CBE","user_header":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJibVR9eYu1n8ibPrZhZ0vp7x2AIKrPdibOIhnOkIjiaiaHiauy935ROM7NoiaicGxRPpKst5gMbqp9Jaibiarw/132","comment_is_top":false,"comment_ctime":1561122136,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1561122136","product_id":100015201,"comment_content":"imagepullallow这个参数只针对pod开始运行的时候如果pod在运行中怎么强制更新？我是把pod至为0在修改为1有其他更好的方法么","like_count":0},{"had_liked":false,"id":78533,"user_name":"初学者","can_delete":false,"product_type":"c1","uid":1042833,"ip_address":"","ucode":"9471A905D07CE1","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e9/91/4219d305.jpg","comment_is_top":false,"comment_ctime":1553169943,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1553169943","product_id":100015201,"comment_content":"daemonset和statefulset 的history revision 都是由一个个controllerrevison 来记录，那deployment history revision 记录在哪里？","like_count":0},{"had_liked":false,"id":56772,"user_name":"hgf","can_delete":false,"product_type":"c1","uid":1085297,"ip_address":"","ucode":"A9649ECFDBD9E8","user_header":"https://static001.geekbang.org/account/avatar/00/10/8f/71/29fb7bc2.jpg","comment_is_top":false,"comment_ctime":1546560813,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1546560813","product_id":100015201,"comment_content":"每个replicaset对应应用一个版本，deployment通过控制同一应用不用版本的replicaset副本数实现滚动更新的操作，更新成功后不会删除replicaset，仅仅只修改副本数量，所以可以查到历史的版本，进而支持回滚。","like_count":0},{"had_liked":false,"id":45770,"user_name":"tianming","can_delete":false,"product_type":"c1","uid":1009932,"ip_address":"","ucode":"0BAB735AC9017A","user_header":"https://static001.geekbang.org/account/avatar/00/0f/69/0c/abb7bfe3.jpg","comment_is_top":false,"comment_ctime":1543793722,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543793722","product_id":100015201,"comment_content":"请问老师，当我的deployment设置伸缩成比如3个pod，但是他的yml 定义里面设置了2个replica，那这个时候是不是这个yml 定义是不起作用的？因为我看实际会产生三个的","like_count":0},{"had_liked":false,"id":43256,"user_name":"Mr.Yang","can_delete":false,"product_type":"c1","uid":1267639,"ip_address":"","ucode":"C2F6A361F3FFD8","user_header":"https://static001.geekbang.org/account/avatar/00/13/57/b7/a37f1bc5.jpg","comment_is_top":false,"comment_ctime":1543201259,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1543201259","product_id":100015201,"comment_content":"老师你好：请问ReplicationController和Deployment的有哪些区别和联系？","like_count":0},{"had_liked":false,"id":41268,"user_name":"chen","can_delete":false,"product_type":"c1","uid":1219168,"ip_address":"","ucode":"2CEBB256A77A8D","user_header":"https://static001.geekbang.org/account/avatar/00/12/9a/60/006b6fe6.jpg","comment_is_top":false,"comment_ctime":1542763225,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1542763225","product_id":100015201,"comment_content":"老师一定是一个务实的人，讲的透侧，都是干货","like_count":0},{"had_liked":false,"id":37382,"user_name":"小谢同学","can_delete":false,"product_type":"c1","uid":1032544,"ip_address":"","ucode":"E809E6BC470631","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/60/fc3689d0.jpg","comment_is_top":false,"comment_ctime":1541562664,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1541562664","product_id":100015201,"comment_content":"请问哪种情况下有必要在一个pod中包含多个容器？","like_count":0,"discussions":[{"author":{"id":1014665,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/7b/89/34f2cbcc.jpg","nickname":"杨宇","note":"","ucode":"EB74DF6E269F03","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":405865,"discussion_content":"前面讲过，“超亲密关系”， 比如要通过共享内存来通信","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1634654299,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":37133,"user_name":"Kevin Wang","can_delete":false,"product_type":"c1","uid":1042073,"ip_address":"","ucode":"D4BC9EFCB086EE","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e6/99/276eaeaa.jpg","comment_is_top":false,"comment_ctime":1541465740,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"1541465740","product_id":100015201,"comment_content":"请问，对于rolling update而言，如果我想改的不是image，而是挂载的nfs目录（image一成不变，通过挂载目录决定服务内涵），应该如何操作呢？","like_count":0},{"had_liked":false,"id":37103,"user_name":"小谢同学","can_delete":false,"product_type":"c1","uid":1032544,"ip_address":"","ucode":"E809E6BC470631","user_header":"https://static001.geekbang.org/account/avatar/00/0f/c1/60/fc3689d0.jpg","comment_is_top":false,"comment_ctime":1541463628,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1541463628","product_id":100015201,"comment_content":"请问revision history limited 有默认值么？难道是无限？","like_count":0,"discussions":[{"author":{"id":1970516,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLK4NPyaFDl4rzrd4A9z42tQDibFLdCicbrAdyUa5P2B5u8UCUBenpHX7VgUCibvHvhpza4icMBKVnhmA/132","nickname":"学无止境","note":"","ucode":"2C28E8E54DAB4E","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":389431,"discussion_content":"默认是10个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1629275257,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311254,"avatar":"https://static001.geekbang.org/account/avatar/00/14/02/16/6fe3fe44.jpg","nickname":"tangzc1","note":"","ucode":"78CB596D2F33DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3581,"discussion_content":"大概是10","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564617871,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":34918,"user_name":"Tylar","can_delete":false,"product_type":"c1","uid":1219676,"ip_address":"","ucode":"682412C5E7540D","user_header":"https://static001.geekbang.org/account/avatar/00/12/9c/5c/69ca7575.jpg","comment_is_top":false,"comment_ctime":1540353510,"is_pvip":false,"replies":[{"id":"12539","content":"dns插件有问题","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1540440040,"ip_address":"","comment_id":34918,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1540353510","product_id":100015201,"comment_content":"老师您好，我想问一下运行一段时间以后，在容器中无法通过其他容器的pod名解析出对应的容器ip是什么情况呢","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":427388,"discussion_content":"dns插件有问题","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1540440040,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1111120,"avatar":"https://static001.geekbang.org/account/avatar/00/10/f4/50/3b604b3b.jpg","nickname":"chenjt","note":"","ucode":"341AF6A98B32DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":25026,"discussion_content":"请问  怎么通过pod名称获取对应的ip?","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1570371839,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":32313,"user_name":"xjjksj","can_delete":false,"product_type":"c1","uid":1029446,"ip_address":"","ucode":"2322DB549D387F","user_header":"https://static001.geekbang.org/account/avatar/00/0f/b5/46/fb410a77.jpg","comment_is_top":false,"comment_ctime":1539524953,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"1539524953","product_id":100015201,"comment_content":"张老师，我运行rollout history一直都是kubectl create —filename=nginx-deployment.yanl —record，没有edit、set image，hao qi g w","like_count":0,"discussions":[{"author":{"id":1026608,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/aa/30/acc91f01.jpg","nickname":"honnkyou","note":"","ucode":"FD5EC4120EE803","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":295086,"discussion_content":"edit 也是有--record 参数的应该也需要加上\n$ kubectl edit deployments nginx-deployment --record","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1596085409,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1311254,"avatar":"https://static001.geekbang.org/account/avatar/00/14/02/16/6fe3fe44.jpg","nickname":"tangzc1","note":"","ucode":"78CB596D2F33DC","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":3582,"discussion_content":"同问！","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1564617907,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":30476,"user_name":"付盼星","can_delete":false,"product_type":"c1","uid":1055542,"ip_address":"","ucode":"E0E4B74E8B361F","user_header":"https://static001.geekbang.org/account/avatar/00/10/1b/36/abe6d066.jpg","comment_is_top":false,"comment_ctime":1538881150,"is_pvip":false,"replies":[{"id":"11024","content":"imagepullpolicy=always ","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538953710,"ip_address":"","comment_id":30476,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1538881150","product_id":100015201,"comment_content":"老师好，如果不修改镜像名称和tag，如何做到强制拉取镜像，触发更新？","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":426017,"discussion_content":"imagepullpolicy=always ","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538953710,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29468,"user_name":"uncleli","can_delete":false,"product_type":"c1","uid":1088359,"ip_address":"","ucode":"0215D0D7735592","user_header":"","comment_is_top":false,"comment_ctime":1538383215,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1538383215","product_id":100015201,"comment_content":"k8s设计的真好，老师讲的也真是好！","like_count":0},{"had_liked":false,"id":29372,"user_name":"混沌渺无极","can_delete":false,"product_type":"c1","uid":1221896,"ip_address":"","ucode":"A8517768BF1E77","user_header":"https://static001.geekbang.org/account/avatar/00/12/a5/08/10b18682.jpg","comment_is_top":false,"comment_ctime":1538360048,"is_pvip":false,"replies":[{"id":"10566","content":"有问题的时候再看不迟","user_name":"作者回复","user_name_real":"Geek_6ef93d","uid":"1218095","ctime":1538373617,"ip_address":"","comment_id":29372,"utype":1}],"discussion_count":1,"race_medal":0,"score":"1538360048","product_id":100015201,"comment_content":"国庆第一天 看到干货！<br>玩k8s多久后 可以尝试看源码呢？源码入门，大佬会出文章吗？","like_count":0,"discussions":[{"author":{"id":1218095,"avatar":"https://static001.geekbang.org/account/avatar/00/12/96/2f/876085fa.jpg","nickname":"张磊 Kubernetes","note":"","ucode":"16E29BDAB1F5BC","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":425567,"discussion_content":"有问题的时候再看不迟","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1538373617,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":29364,"user_name":"青峰","can_delete":false,"product_type":"c1","uid":1215903,"ip_address":"","ucode":"6FB19A41AC7232","user_header":"https://static001.geekbang.org/account/avatar/00/12/8d/9f/776d9b2e.jpg","comment_is_top":false,"comment_ctime":1538358567,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1538358567","product_id":100015201,"comment_content":"很棒！哈哈😄。国庆礼物果然没让我失望！","like_count":0}]}