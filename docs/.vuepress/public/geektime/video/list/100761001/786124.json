{"id":786124,"title":"30｜泛型声明（一）：一般类型的泛型声明","content":"","comments":[{"had_liked":false,"id":393246,"user_name":"Geek_aeb936","can_delete":false,"product_type":"c3","uid":3887128,"ip_address":"日本","ucode":"863338D4895F25","user_header":"","comment_is_top":false,"comment_ctime":1723274970,"is_pvip":false,"replies":[{"id":142842,"content":"满分答卷。非常赞！👍👍👍","user_name":"作者回复","user_name_real":"编辑","uid":1521669,"ctime":1723538678,"ip_address":"江苏","comment_id":393246,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"import { T1, T2, T3, Transportations } from &#39;.&#47;t2-1&#39;;\ninterface T&lt;T extends Transportations&gt; {\n    type: T;\n    run(): void;\n}\n\ninterface Motorcycle extends T&lt;Transportations.motorcycle&gt; {\n    make: number;\n}\n\ninterface Car extends T&lt;Transportations.car&gt; {\n    transmission: string;\n    pow: number;\n    id: &#39;T2&#39;;\n}\n\ninterface TruckType extends T&lt;Transportations.truck&gt; { \n    capacity: number;\n}\n\ntype Transporter = Motorcycle | Car | TruckType;\n\nlet x1 = new T1(2021); \nlet x2 = new T2(&#39;Automatic&#39;, 150, &#39;T2&#39;);\nlet x3 = new T3(1000);\n\nlet transporters: Transporter[] = [x1, x2, x3];\n\nfunction start() {\n    transporters.forEach(x =&gt; {\n        x.run(); \n    });\n}\n\nstart();","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649526,"discussion_content":"满分答卷。非常赞！👍👍👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723538678,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":393245,"user_name":"Geek_aeb936","can_delete":false,"product_type":"c3","uid":3887128,"ip_address":"日本","ucode":"863338D4895F25","user_header":"","comment_is_top":false,"comment_ctime":1723274966,"is_pvip":false,"replies":[{"id":142843,"content":"这个也加一票~ ：）👍","user_name":"作者回复","user_name_real":"编辑","uid":1521669,"ctime":1723538696,"ip_address":"江苏","comment_id":393245,"utype":1}],"discussion_count":1,"race_medal":0,"score":2,"product_id":100761001,"comment_content":"&#47;&#47; t2-1.ts\n\nenum Transportations { motorcycle, car, truck }\n\nabstract class T {\n    abstract type: Transportations;\n    abstract run(): void;\n}\n\nclass T1 extends T {\n    type = Transportations.motorcycle as const;\n    constructor(public make: number) {\n        super();\n    }\n    run() {\n        console.log(`Running motorcycle with make ${this.make}`);\n    }\n}\n\nclass T2 extends T {\n    type = Transportations.car as const;\n    constructor(\n        public transmission: string,\n        public pow: number,\n        public id = &#39;T2&#39; as const\n    ) {\n        super();\n    }\n    run() {\n        console.log(`Running car with transmission ${this.transmission} and power ${this.pow}`);\n    }\n}\n\nclass T3 extends T {\n    type = Transportations.truck as const;\n    constructor(public capacity: number) {\n        super();\n    }\n    run() {\n        console.log(`Running truck with capacity ${this.capacity}`);\n    }\n}\n\ntype Transporter = T;\n\nclass MyController {\n    run(x: Transporter) {\n        x.run();\n    }\n}\n\n&#47;&#47; CASE1：使用一个平台（单例）来为所有的transporter提供服务\nclass Platform {\n    static transporters = new Array&lt;Transporter&gt;();\n    static controller = new MyController();\n    static runAll() {\n        this.transporters.forEach((transporter) =&gt; {\n            this.controller.run(transporter);\n        });\n    }\n}\n\n&#47;&#47; CASE2：平台将为每一个transporter配备一个独立的控制器\nclass Platform2 extends Array&lt;[MyController, Transporter]&gt; {\n    runAll() {\n        this.forEach(([controller, transporter]) =&gt; {\n            controller.run(transporter);\n        });\n    }\n}\n\n&#47;&#47; let x1 = new T1(2021);\n&#47;&#47; let x2 = new T2(&#39;Automatic&#39;, 150, &#39;T2&#39;);\n&#47;&#47; let x3 = new T3(1000);\n\n&#47;&#47; Platform.transporters.push(x1, x2, x3); \n&#47;&#47; Platform.runAll();  \n\nexport { T1, T2, T3, Transportations };","like_count":0,"discussions":[{"author":{"id":1521669,"avatar":"https://static001.geekbang.org/account/avatar/00/17/38/05/7beecd5d.jpg","nickname":"Aiming","note":"","ucode":"66292B32F9960A","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":649527,"discussion_content":"这个也加一票~ ：）👍","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1723538696,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":"江苏","group_id":0},"score":2,"extra":"{\"reply\":true,\"user_type\":2,\"source\":0}","child_discussion_number":0,"child_discussions":[]}]}]}