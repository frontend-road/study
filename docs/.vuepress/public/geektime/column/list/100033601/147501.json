{"id":147501,"title":"29 | HTTP/1：HTTP性能优化","content":"<p>谈及浏览器中的网络，就避不开HTTP。我们知道HTTP是浏览器中<strong>最重要</strong>且<strong>使用最多</strong>的协议，是<strong>浏览器和服务器之间的通信语言</strong>，也是互联网的基石。而随着浏览器的发展，HTTP为了能适应新的形式也在持续进化，我认为学习HTTP的最佳途径就是了解其发展史，所以在接下来的三篇文章中，我会从浏览器发展的视角来和你聊聊HTTP演进。这三篇分别是<strong>即将完成使命的HTTP/1、正在向我们走来的HTTP/2，以及未来的HTTP/3</strong>。</p><p>本文主要介绍的是HTTP/1.1，我们先讲解HTTP/1.1的进化史，然后再介绍在进化过程中所遇到的各种瓶颈，以及对应的解决方法。</p><h2>超文本传输协议HTTP/0.9</h2><p>首先我们来看看诞生最早的HTTP/0.9。HTTP/0.9是于1991年提出的，主要用于学术交流，需求很简单——用来在网络之间传递HTML超文本的内容，所以被称为<strong>超文本传输协议</strong>。整体来看，它的实现也很简单，采用了基于请求响应的模式，从客户端发出请求，服务器返回数据。</p><p>下面我们就来看看HTTP/0.9的一个完整的请求流程（可参考下图）。</p><ul>\n<li>因为HTTP都是基于TCP协议的，所以客户端先要根据IP地址、端口和服务器建立TCP连接，而建立连接的过程就是TCP协议三次握手的过程。</li>\n<li>建立好连接之后，会发送一个GET请求行的信息，如<code>GET /index.html</code>用来获取index.html。</li>\n<li>服务器接收请求信息之后，读取对应的HTML文件，并将数据以ASCII字符流返回给客户端。</li>\n<li>HTML文档传输完成后，断开连接。</li>\n</ul><!-- [[[read_end]]] --><p><img src=\"https://static001.geekbang.org/resource/image/db/34/db1166c68c22a45c9858e88a234f1a34.png?wh=1142*309\" alt=\"\"></p><center><span class=\"reference\">HTTP/0.9请求流程</span></center><p>总的来说，当时的需求很简单，就是用来传输体积很小的HTML文件，所以HTTP/0.9的实现有以下三个特点。</p><ul>\n<li>第一个是只有一个请求行，并没有<strong>HTTP请求头和请求体</strong>，因为只需要一个请求行就可以完整表达客户端的需求了。</li>\n<li>第二个是服务器也没有返回头信息，这是因为服务器端并不需要告诉客户端太多信息，只需要返回数据就可以了。</li>\n<li>第三个是返回的文件内容是以ASCII字符流来传输的，因为都是HTML格式的文件，所以使用ASCII字节码来传输是最合适的。</li>\n</ul><h2>被浏览器推动的HTTP/1.0</h2><p>HTTP/0.9虽然简单，但是已经可以满足当时的需求了。不过变化是这个世界永恒不变的主旋律，1994年底出现了拨号上网服务，同年网景又推出一款浏览器，从此万维网就不局限于学术交流了，而是进入了高速的发展阶段。随之而来的是万维网联盟（W3C）和HTTP工作组（HTTP-WG）的创建，它们致力于HTML的发展和HTTP的改进。</p><p>万维网的高速发展带来了很多新的需求，而HTTP/0.9已经不能适用新兴网络的发展，所以这时就需要一个新的协议来支撑新兴网络，这就是HTTP/1.0诞生的原因。不过在详细分析HTTP/1.0之前，我们先来分析下新兴网络都带来了哪些新需求。</p><p>首先在浏览器中展示的不单是HTML文件了，还包括了JavaScript、CSS、图片、音频、视频等不同类型的文件。因此<strong>支持多种类型的文件下载是HTTP/1.0的一个核心诉求</strong>，而且文件格式不仅仅局限于ASCII编码，还有很多其他类型编码的文件。</p><p><strong>那么该如何实现多种类型文件的下载呢？</strong></p><p>文章开头我们说过，HTTP是浏览器和服务器之间的通信语言，不过HTTP/0.9在建立好连接之后，只会发送类似<code>GET /index.html</code>的简单请求命令，并没有其他途径告诉服务器更多的信息，如文件编码、文件类型等。同样，服务器是直接返回数据给浏览器的，也没有其他途径告诉浏览器更多的关于服务器返回的文件信息。</p><p>这种简单的交流型形式无疑不能满足传输多种类型文件的需求，那为了让客户端和服务器能更深入地交流，HTTP/1.0引入了请求头和响应头，它们都是以为Key-Value形式保存的，在HTTP发送请求时，会带上请求头信息，服务器返回数据时，会先返回响应头信息。至于HTTP/1.0具体的请求流程，你可以参考下图。</p><p><img src=\"https://static001.geekbang.org/resource/image/b5/7d/b52b0d1a26ff2b8607c08e5c50ae687d.png?wh=1142*309\" alt=\"\"></p><center><span class=\"reference\">HTTP/1.0的请求流程</span></center><p>有了请求头和响应头，浏览器和服务器就能进行更加深入的交流了。</p><p><strong>那HTTP/1.0是怎么通过请求头和响应头来支持多种不同类型的数据呢？</strong></p><p>要支持多种类型的文件，我们就需要解决以下几个问题。</p><ul>\n<li>首先，浏览器需要知道服务器返回的数据是什么类型的，然后浏览器才能根据不同的数据类型做针对性的处理。</li>\n<li>其次，由于万维网所支持的应用变得越来越广，所以单个文件的数据量也变得越来越大。为了减轻传输性能，服务器会对数据进行压缩后再传输，所以浏览器需要知道服务器压缩的方法。</li>\n<li>再次，由于万维网是支持全球范围的，所以需要提供国际化的支持，服务器需要对不同的地区提供不同的语言版本，这就需要浏览器告诉服务器它想要什么语言版本的页面。</li>\n<li>最后，由于增加了各种不同类型的文件，而每种文件的编码形式又可能不一样，为了能够准确地读取文件，浏览器需要知道文件的编码类型。</li>\n</ul><p>基于以上问题，HTTP/1.0的方案是通过请求头和响应头来进行协商，在发起请求时候会通过HTTP请求头告诉服务器它期待服务器返回什么类型的文件、采取什么形式的压缩、提供什么语言的文件以及文件的具体编码。最终发送出来的请求头内容如下：</p><pre><code>accept: text/html\naccept-encoding: gzip, deflate, br\naccept-Charset: ISO-8859-1,utf-8\naccept-language: zh-CN,zh\n</code></pre><p>其中第一行表示期望服务器返回html类型的文件，第二行表示期望服务器可以采用gzip、deflate或者br其中的一种压缩方式，第三行表示期望返回的文件编码是UTF-8或者ISO-8859-1，第四行是表示期望页面的优先语言是中文。</p><p>服务器接收到浏览器发送过来的请求头信息之后，会根据请求头的信息来准备响应数据。不过有时候会有一些意外情况发生，比如浏览器请求的压缩类型是gzip，但是服务器不支持gzip，只支持br压缩，那么它会通过响应头中的content-encoding字段告诉浏览器最终的压缩类型，也就是说最终浏览器需要根据响应头的信息来处理数据。下面是一段响应头的数据信息：</p><pre><code>content-encoding: br\ncontent-type: text/html; charset=UTF-8\n</code></pre><p>其中第一行表示服务器采用了br的压缩方法，第二行表示服务器返回的是html文件，并且该文件的编码类型是UTF-8。</p><p>有了响应头的信息，浏览器就会使用br方法来解压文件，再按照UTF-8的编码格式来处理原始文件，最后按照HTML的方式来解析该文件。这就是HTTP/1.0支持多文件的一个基本的处理流程。</p><p>HTTP/1.0除了对多文件提供良好的支持外，还依据当时实际的需求引入了很多其他的特性，这些特性都是通过请求头和响应头来实现的。下面我们来看看新增的几个典型的特性：</p><ul>\n<li>有的请求服务器可能无法处理，或者处理出错，这时候就需要告诉浏览器服务器最终处理该请求的情况，这就引入了<strong>状态码</strong>。状态码是通过响应行的方式来通知浏览器的。</li>\n<li>为了减轻服务器的压力，在HTTP/1.0中提供了<strong>Cache机制</strong>，用来缓存已经下载过的数据。</li>\n<li>服务器需要统计客户端的基础信息，比如Windows和macOS的用户数量分别是多少，所以HTTP/1.0的请求头中还加入了<strong>用户代理</strong>的字段。</li>\n</ul><h2>缝缝补补的HTTP/1.1</h2><p>不过随着技术的继续发展，需求也在不断迭代更新，很快HTTP/1.0也不能满足需求了，所以HTTP/1.1又在HTTP/1.0的基础之上做了大量的更新。接下来我们来看看HTTP/1.0遇到了哪些主要的问题，以及HTTP/1.1又是如何改进的。</p><h3>1. 改进持久连接</h3><p>HTTP/1.0每进行一次HTTP通信，都需要经历建立TCP连接、传输HTTP数据和断开TCP连接三个阶段（如下图）。</p><p><img src=\"https://static001.geekbang.org/resource/image/cc/7d/cccc9faf6d0addea8e1bf307cd7d8d7d.png?wh=1142*1088\" alt=\"\"></p><center><span class=\"reference\">HTTP/1.0的短连接</span></center><p>在当时，由于通信的文件比较小，而且每个页面的引用也不多，所以这种传输形式没什么大问题。但是随着浏览器普及，单个页面中的图片文件越来越多，有时候一个页面可能包含了几百个外部引用的资源文件，如果在下载每个文件的时候，都需要经历建立TCP连接、传输数据和断开连接这样的步骤，无疑会增加大量无谓的开销。</p><p>为了解决这个问题，<strong>HTTP/1.1中增加了持久连接的方法，它的特点是在一个TCP连接上可以传输多个HTTP请求，只要浏览器或者服务器没有明确断开连接，那么该TCP连接会一直保持</strong>。</p><p><img src=\"https://static001.geekbang.org/resource/image/80/1a/80b57830e15faa17631bea74054a0e1a.png?wh=1140*804\" alt=\"\"></p><center><span class=\"reference\">HTTP/1.0的持久连接</span></center><p>从上图可以看出，HTTP的持久连接可以有效减少TCP建立连接和断开连接的次数，这样的好处是减少了服务器额外的负担，并提升整体HTTP的请求时长。</p><p>持久连接在HTTP/1.1中是默认开启的，所以你不需要专门为了持久连接去HTTP请求头设置信息，如果你不想要采用持久连接，可以在HTTP请求头中加上<code>Connection: close</code>。目前浏览器中对于同一个域名，默认允许同时建立6个TCP持久连接。</p><h3>2. 不成熟的HTTP管线化</h3><p>持久连接虽然能减少TCP的建立和断开次数，但是它需要等待前面的请求返回之后，才能进行下一次请求。如果TCP通道中的某个请求因为某些原因没有及时返回，那么就会阻塞后面的所有请求，这就是著名的<strong>队头阻塞</strong>的问题。</p><p>HTTP/1.1中试图通过管线化的技术来解决<strong>队头阻塞</strong>的问题。HTTP/1.1中的管线化是指将多个HTTP请求整批提交给服务器的技术，虽然可以整批发送请求，不过服务器依然需要根据请求顺序来回复浏览器的请求。</p><p>FireFox、Chrome都做过管线化的试验，但是由于各种原因，它们最终都放弃了管线化技术。</p><h3>3. 提供虚拟主机的支持</h3><p>在HTTP/1.0中，每个域名绑定了一个唯一的IP地址，因此一个服务器只能支持一个域名。但是随着虚拟主机技术的发展，需要实现在一台物理主机上绑定多个虚拟主机，每个虚拟主机都有自己的单独的域名，这些单独的域名都公用同一个IP地址。</p><p>因此，HTTP/1.1的请求头中增加了<strong>Host字段</strong>，用来表示当前的域名地址，这样服务器就可以根据不同的Host值做不同的处理。</p><h3>4. 对动态生成的内容提供了完美支持</h3><p>在设计HTTP/1.0时，需要在响应头中设置完整的数据大小，如<code>Content-Length: 901</code>，这样浏览器就可以根据设置的数据大小来接收数据。不过随着服务器端的技术发展，很多页面的内容都是动态生成的，因此在传输数据之前并不知道最终的数据大小，这就导致了浏览器不知道何时会接收完所有的文件数据。</p><p>HTTP/1.1通过引入<strong>Chunk transfer机制</strong>来解决这个问题，服务器会将数据分割成若干个任意大小的数据块，每个数据块发送时会附上上个数据块的长度，最后使用一个零长度的块作为发送数据完成的标志。这样就提供了对动态内容的支持。</p><h3>5. 客户端Cookie、安全机制</h3><p>除此之外，HTTP/1.1还引入了客户端Cookie机制和安全机制。其中，Cookie机制我们在<a href=\"https://time.geekbang.org/column/article/116588\">《03 | HTTP请求流程：为什么很多站点第二次打开速度会很快？》</a>这篇文章中介绍过了，而安全机制我们会在后面的安全模块中再做介绍，这里就不赘述了。</p><h2>总结</h2><p>好了，今天就介绍到这里，下面我来总结下本文的主要内容。</p><p>本文我们重点强调了HTTP是浏览器和服务器的通信语言，然后我们从需求演变的角度追溯了HTTP的发展史，在诞生之初的HTTP/0.9因为需求简单，所以和服务器之间的通信过程也相对简单。</p><p>由于万维网的快速崛起，带来了大量新的需求，其中最核心的一个就是需要支持多种类型的文件下载， 为此HTTP/1.0中引入了请求头和响应头。在支持多种类型文件下载的基础之上，HTTP/1.0还提供了Cache机制、用户代理、状态码等一些基础信息。</p><p>但随着技术和需求的发展，人们对文件传输的速度要求越来越高，故又基于HTTP/1.0推出了HTTP/1.1，增加了持久连接方法来提升连接效率，同时还尝试使用管线化技术提升效率（不过由于各种原因，管线化技术最终被各大厂商放弃了）。除此之外，HTTP/1.1还引入了Cookie、虚拟主机的支持、对动态内容的支持等特性。</p><p>虽然HTTP/1.1在HTTP/1.0的基础之上做了大量的优化，但是由于一些效率问题始终很难解决，所以最终还是被HTTP/2所取代，这就是我们下一篇文章要介绍的内容了。</p><h2>思考时间</h2><p>今天留给你的思考题：你认为HTTP/1.1还有哪些不足？</p><p>欢迎在留言区与我分享你的想法，也欢迎你在留言区记录你的思考过程。感谢阅读，如果你觉得这篇文章对你有帮助的话，也欢迎把它分享给更多的朋友。</p><p></p>","neighbors":{"left":{"article_title":"28 | WebComponent：像搭积木一样构建Web应用","id":145546},"right":{"article_title":"30｜HTTP/2：如何提升网络速度？","id":148546}},"comments":[{"had_liked":false,"id":139703,"user_name":"Geek_07b5b0","can_delete":false,"product_type":"c1","uid":1623062,"ip_address":"","ucode":"EB52458A5986AA","user_header":"","comment_is_top":false,"comment_ctime":1570708917,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"302218419637","product_id":100033601,"comment_content":"感谢李兵老师，我今天实习面试用到了很多从这个课程中学到的东西，人生第一次面试，给了我很大鼓励！<br>","like_count":71,"discussions":[{"author":{"id":1015930,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/80/7a/02fdf1a2.jpg","nickname":"FreezeSoul","note":"","ucode":"0B67142C4EA3D4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":210926,"discussion_content":"说不定面试官也在听这课","likes_number":21,"is_delete":false,"is_hidden":false,"ctime":1584791605,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1661407,"avatar":"https://static001.geekbang.org/account/avatar/00/19/59/df/2e50f06c.jpg","nickname":"simple","note":"","ucode":"A43F540AE58A9B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1015930,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/80/7a/02fdf1a2.jpg","nickname":"FreezeSoul","note":"","ucode":"0B67142C4EA3D4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":540772,"discussion_content":"说不定","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1640159971,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":210926,"ip_address":""},"score":540772,"extra":""},{"author":{"id":1098566,"avatar":"https://static001.geekbang.org/account/avatar/00/10/c3/46/308c3958.jpg","nickname":"不蒸馒头","note":"","ucode":"EB26EC2B9CFC6B","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1015930,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/80/7a/02fdf1a2.jpg","nickname":"FreezeSoul","note":"","ucode":"0B67142C4EA3D4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":548277,"discussion_content":"哈哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1643109844,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":210926,"ip_address":""},"score":548277,"extra":""}]},{"author":{"id":2172330,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKw8ictgYcqf6upCGib0uBXa6oeWfVJARSLL1SFXtrz3TkJiavPicesLEoBg9RL7ibRYKTtZDexsrJPjJA/132","nickname":"victorykong","note":"","ucode":"76C1BE240D53F8","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":352100,"discussion_content":"哈哈哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1614601512,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1956684,"avatar":"","nickname":"Geek_4d85bf","note":"","ucode":"477B405EDE8286","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":258135,"discussion_content":"哈哈哈","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1588651798,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139806,"user_name":"mfist","can_delete":false,"product_type":"c1","uid":1373624,"ip_address":"","ucode":"4F99F422C23FB4","user_header":"https://static001.geekbang.org/account/avatar/00/14/f5/b8/9f165f4b.jpg","comment_is_top":false,"comment_ctime":1570748455,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"177664407591","product_id":100033601,"comment_content":"1对头阻塞问题，没有解决<br>2文本传输效率问题，而且不安全<br>3header中每次都传输类似头，增加了传输成本","like_count":40,"discussions":[{"author":{"id":1344732,"avatar":"https://static001.geekbang.org/account/avatar/00/14/84/dc/a8befa2a.jpg","nickname":"L","note":"","ucode":"A68BDBA28BAAD4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":384043,"discussion_content":"你可以加入团队，解决这些问题。嘿嘿","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1626343419,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":143378,"user_name":"一步","can_delete":false,"product_type":"c1","uid":1005391,"ip_address":"","ucode":"73CEA468CE70C3","user_header":"https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg","comment_is_top":false,"comment_ctime":1571701873,"is_pvip":true,"discussion_count":0,"race_medal":1,"score":"134715688049","product_id":100033601,"comment_content":"对于 队头阻塞问题，只要传输层是TCP，就不会得到根本上的解决， http&#47;2 利用流的的机制很大程度的缓解了这个问题，http&#47;3 传输层换成了 UDP 才彻底解决这个问题","like_count":32},{"had_liked":false,"id":188369,"user_name":"大蓝","can_delete":false,"product_type":"c1","uid":1355288,"ip_address":"","ucode":"855648168C77ED","user_header":"https://static001.geekbang.org/account/avatar/00/14/ae/18/ee4ded86.jpg","comment_is_top":false,"comment_ctime":1584345536,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"61713887680","product_id":100033601,"comment_content":"学的时候不曾感觉，学完一个月，会发现这个课程带给我一个知识树这样子的知识结构，感谢！<br>我现在又回来继续看看知识哪里遗漏的","like_count":15},{"had_liked":false,"id":261063,"user_name":"君自兰芳","can_delete":false,"product_type":"c1","uid":2029706,"ip_address":"","ucode":"780F3AFEEB9B73","user_header":"https://static001.geekbang.org/account/avatar/00/1e/f8/8a/f7e7fd54.jpg","comment_is_top":false,"comment_ctime":1605187186,"is_pvip":false,"discussion_count":5,"race_medal":0,"score":"23080023666","product_id":100033601,"comment_content":"“目前浏览器中对于同一个域名，默认允许同时建立 6 个 TCP 持久连接”<br><br>我又有个疑问了⊙∀⊙！，每个TCP发送请求的数量有上限吗？上限是多少？<br><br>什么时候需要开启一个新的TCP连接？什么情况下可以关闭一个TCP连接？","like_count":4,"discussions":[{"author":{"id":1809669,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/nicib8gqImzrCGJYyJW3QEmmr1yz2fWnLIOmstENIvLpiajbJVDWDQMF0PZAZ3BictqbwBMILFPA6jckJkTunXliaRQ/132","nickname":"走进科学","note":"","ucode":"33644F69A54598","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":386640,"discussion_content":"每个TCP发送请求的上限没有限制，只要TCP链接不关闭，你就可以一直发送数据。TCP关闭不关闭取决于你想用TCP干什么，TCP就是用来保证可靠传输的；同域名6个链接的限制是浏览器的，不是TCP的","likes_number":5,"is_delete":false,"is_hidden":false,"ctime":1627704761,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1040310,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJsAzWfG8S3R53U8b2MJtLm5RxVnOjaUoLplicXp2KK7OicOf0GMV8MqPW7AfcqWzicZgficZ14Elcumw/132","nickname":"fakefish","note":"","ucode":"C82B549F1837DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385530,"discussion_content":"chrome默认是6个，以前的ie8啥的记得是1个","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627114349,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1406834,"avatar":"https://static001.geekbang.org/account/avatar/00/15/77/72/ad7056f9.jpg","nickname":"hb","note":"","ucode":"DCFA6CECF64E37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378101,"discussion_content":"粗心的呀，都说了同时建立6个赤练。请求发送的上限应该受限于设备","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623054872,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":2029706,"avatar":"https://static001.geekbang.org/account/avatar/00/1e/f8/8a/f7e7fd54.jpg","nickname":"君自兰芳","note":"","ucode":"780F3AFEEB9B73","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1406834,"avatar":"https://static001.geekbang.org/account/avatar/00/15/77/72/ad7056f9.jpg","nickname":"hb","note":"","ucode":"DCFA6CECF64E37","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":551249,"discussion_content":"呃，我问的不是tcp上限","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1644939794,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":378101,"ip_address":""},"score":551249,"extra":""}]},{"author":{"id":2116054,"avatar":"https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKtAEU9ApszgQTTpFvVdlTNxYDRHD9NJc5ke3eQU34jEqlfiaXAGSshw9wFophpEDqrPQel1sicVzIA/132","nickname":"Geek_13c289","note":"","ucode":"5975070FE9DEE2","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":374808,"discussion_content":"同问","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621354813,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":153752,"user_name":"lee","can_delete":false,"product_type":"c1","uid":1134107,"ip_address":"","ucode":"F931BF01A04F1E","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJrZb9pm07aickG3dVFBd2yhk5J2clztUniaMNFsjpHu7uacfpGhleKYbgicEnwF5MusKNFKLTUUAYKg/132","comment_is_top":false,"comment_ctime":1574302350,"is_pvip":false,"replies":[{"id":"59079","content":"是的","user_name":"作者回复","user_name_real":"李兵","uid":"1141464","ctime":1574304689,"ip_address":"","comment_id":153752,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14459204238","product_id":100033601,"comment_content":"”目前浏览器中对于同一个域名，默认允许同时建立 6 个 TCP 持久连接“，那就是如果浏览器同时请求n个不同域名的后台服务器，那就是允许同时建立n * 6 个TCP持久连接吗？","like_count":4,"discussions":[{"author":{"id":1141464,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6a/d8/228449c9.jpg","nickname":"李兵","note":"","ucode":"3F3D3F6E20209E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":475259,"discussion_content":"是的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574304689,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1040310,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJsAzWfG8S3R53U8b2MJtLm5RxVnOjaUoLplicXp2KK7OicOf0GMV8MqPW7AfcqWzicZgficZ14Elcumw/132","nickname":"fakefish","note":"","ucode":"C82B549F1837DB","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":385531,"discussion_content":"所以有cdn域名切片的方案","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1627114375,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":2353213,"avatar":"https://static001.geekbang.org/account/avatar/00/23/e8/3d/c7f7eaf5.jpg","nickname":"王阳","note":"","ucode":"56E6C786998AB7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":375334,"discussion_content":"这个提问也是我想问的，🙏","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1621582201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":150405,"user_name":"月翎魂雨","can_delete":false,"product_type":"c1","uid":1651523,"ip_address":"","ucode":"FD967611913B17","user_header":"https://static001.geekbang.org/account/avatar/00/19/33/43/08d746c6.jpg","comment_is_top":false,"comment_ctime":1573529109,"is_pvip":false,"replies":[{"id":"57849","content":"http&#47;1.1中的一个tcp链接同时只能发起一个http请求！<br><br>浏览器会让每个域名同时最多建立6个tcp链接，也就是说同一个域名同时能支持6个http请求！<br><br>","user_name":"作者回复","user_name_real":"李兵","uid":"1141464","ctime":1573545582,"ip_address":"","comment_id":150405,"utype":1}],"discussion_count":3,"race_medal":0,"score":"14458430997","product_id":100033601,"comment_content":"文中“目前浏览器中对于同一个域名，默认允许同时建立 6 个 TCP 持久连接”，看老师画的图是一个tcp持久链接有6个请求的意思吧。而且前面第03章文中“同一个域名同时最多只能建立 6 个 TCP 连接，如果在同一个域名下同时有 10 个请求发生，那么其中 4 个请求会进入排队等待状态”。所以我就很迷糊了，这个请求数和tcp链接关系到底是啥？","like_count":4,"discussions":[{"author":{"id":1141464,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6a/d8/228449c9.jpg","nickname":"李兵","note":"","ucode":"3F3D3F6E20209E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":474149,"discussion_content":"http/1.1中的一个tcp链接同时只能发起一个http请求！\n\n浏览器会让每个域名同时最多建立6个tcp链接，也就是说同一个域名同时能支持6个http请求！\n\n","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1573545582,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1296602,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c8/da/f4704fb9.jpg","nickname":"甜甜","note":"","ucode":"D6E8B7D9E35C55","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288173,"discussion_content":"10个请求发生，建立了6个tcp链接，剩下的4个请求，是怎样排队的呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593669747,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1374181,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f7/e5/ec543f3b.jpg","nickname":"张宗伟","note":"","ucode":"1447A20C7A8982","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1296602,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c8/da/f4704fb9.jpg","nickname":"甜甜","note":"","ucode":"D6E8B7D9E35C55","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377789,"discussion_content":"估计是当6个tcp连接中有http请求完成后，会补上去。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622859893,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":288173,"ip_address":""},"score":377789,"extra":""}]}]},{"had_liked":false,"id":139905,"user_name":"JAY","can_delete":false,"product_type":"c1","uid":1042288,"ip_address":"","ucode":"4F6C14E7EA7C06","user_header":"https://static001.geekbang.org/account/avatar/00/0f/e7/70/e6b1368f.jpg","comment_is_top":false,"comment_ctime":1570764099,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"14455665987","product_id":100033601,"comment_content":"上传文件给服务器的HTTP请求和其它请求有什么不一样？如何获取当前上传文件的文件名？谢谢！","like_count":3,"discussions":[{"author":{"id":1010463,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/6b/1f/f7be5246.jpg","nickname":"大前端洞见","note":"","ucode":"1FA227A25F6056","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":200460,"discussion_content":"上传文件时，文件对象和Blob可以获取到文件名；\n下载文件时，可以通过相应头的 Content-Description 获取到文件名","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1583680892,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1042288,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e7/70/e6b1368f.jpg","nickname":"JAY","note":"","ucode":"4F6C14E7EA7C06","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":35562,"discussion_content":"感觉老师不怎么回答提出的问题","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1571289123,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1272789,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6b/d5/0e4b70a2.jpg","nickname":"Sean","note":"","ucode":"BC0715BF423613","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":54443,"discussion_content":"上传类的请求跟其他正常的数据拉取，直接在请求方法上就体现了吧","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1574299397,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":1,"child_discussions":[{"author":{"id":1042288,"avatar":"https://static001.geekbang.org/account/avatar/00/0f/e7/70/e6b1368f.jpg","nickname":"JAY","note":"","ucode":"4F6C14E7EA7C06","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1272789,"avatar":"https://static001.geekbang.org/account/avatar/00/13/6b/d5/0e4b70a2.jpg","nickname":"Sean","note":"","ucode":"BC0715BF423613","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":91476,"discussion_content":"能否更细节一些？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1576835770,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":54443,"ip_address":""},"score":91476,"extra":""}]}]},{"had_liked":false,"id":243872,"user_name":"太白北路","can_delete":false,"product_type":"c1","uid":1516144,"ip_address":"","ucode":"3C7E54D38408A3","user_header":"https://static001.geekbang.org/account/avatar/00/17/22/70/ab911260.jpg","comment_is_top":false,"comment_ctime":1598317674,"is_pvip":true,"discussion_count":0,"race_medal":0,"score":"10188252266","product_id":100033601,"comment_content":"安全问题，传输内容是不加密的","like_count":2},{"had_liked":false,"id":175878,"user_name":"4!!","can_delete":false,"product_type":"c1","uid":1487663,"ip_address":"","ucode":"188445590D97DF","user_header":"https://static001.geekbang.org/account/avatar/00/16/b3/2f/867b94d8.jpg","comment_is_top":false,"comment_ctime":1580876603,"is_pvip":false,"discussion_count":2,"race_medal":0,"score":"10170811195","product_id":100033601,"comment_content":"使用哪个版本的http协议是由谁决定的？浏览器和服务器自动设置的？还是由服务器设置的？","like_count":2,"discussions":[{"author":{"id":1296602,"avatar":"https://static001.geekbang.org/account/avatar/00/13/c8/da/f4704fb9.jpg","nickname":"甜甜","note":"","ucode":"D6E8B7D9E35C55","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":288140,"discussion_content":"需要浏览器和服务器协商，最终由服务器来决定（猜测）","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1593659100,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1147347,"avatar":"https://static001.geekbang.org/account/avatar/00/11/81/d3/f0a88806.jpg","nickname":"🍐 🍾 🔆","note":"","ucode":"1B7C90800AD4D0","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280338,"discussion_content":"浏览器","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591529092,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":139521,"user_name":"tokey","can_delete":false,"product_type":"c1","uid":1337746,"ip_address":"","ucode":"5278487F37D4EC","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJS0jwYKhjm1hq96go05J4R7XDd5FFXXaoyIfX9TgoI3mLURAu2ET72SvYGM2iaET7IV3WDvMibAVfw/132","comment_is_top":false,"comment_ctime":1570671520,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"10160606112","product_id":100033601,"comment_content":"1、对头阻塞<br>2、容易遭受dos攻击<br>3、对小文件传输效率低","like_count":1},{"had_liked":false,"id":290442,"user_name":"大可","can_delete":false,"product_type":"c1","uid":1020927,"ip_address":"","ucode":"D0D7F9D670FF07","user_header":"https://static001.geekbang.org/account/avatar/00/0f/93/ff/42432276.jpg","comment_is_top":false,"comment_ctime":1619568756,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"5914536052","product_id":100033601,"comment_content":"作为一名后端 觉得老师把浏览器讲的很明白","like_count":2},{"had_liked":false,"id":255851,"user_name":"小炭","can_delete":false,"product_type":"c1","uid":1109544,"ip_address":"","ucode":"E20E3958CAF06C","user_header":"https://static001.geekbang.org/account/avatar/00/10/ee/28/c04a0c83.jpg","comment_is_top":false,"comment_ctime":1603443906,"is_pvip":true,"discussion_count":2,"race_medal":0,"score":"5898411202","product_id":100033601,"comment_content":"为什么HTML 格式的文件，使用 ASCII 字节码来传输是最合适的？","like_count":2,"discussions":[{"author":{"id":1406834,"avatar":"https://static001.geekbang.org/account/avatar/00/15/77/72/ad7056f9.jpg","nickname":"hb","note":"","ucode":"DCFA6CECF64E37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378095,"discussion_content":"因为当时在美国，都是用的英文。老师这个话也不大对，如果是中文就不合适","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1623054448,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1406834,"avatar":"https://static001.geekbang.org/account/avatar/00/15/77/72/ad7056f9.jpg","nickname":"hb","note":"","ucode":"DCFA6CECF64E37","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":378096,"discussion_content":"整体的话还是因为当时的需求简单","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1623054482,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":221901,"user_name":"Lorin","can_delete":false,"product_type":"c1","uid":1379988,"ip_address":"","ucode":"7D546F70082DF0","user_header":"https://static001.geekbang.org/account/avatar/00/15/0e/94/4a2bb019.jpg","comment_is_top":false,"comment_ctime":1590630294,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"5885597590","product_id":100033601,"comment_content":"同一个TCP连接中最多支持多少个HTTP请求呢？","like_count":1,"discussions":[{"author":{"id":2090750,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/rvNsZL0TpjXUSv4Me1h2pfZzBiaj9HrkU3kYHXwOibPs3GksSvg3TptiaibkLhWFFwmmMicJZYGicVI9uDT6kqxb6a4w/132","nickname":"--","note":"","ucode":"8FFA06CD98F50A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":357330,"discussion_content":"多个，不限","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1615787244,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":185079,"user_name":"blueBean","can_delete":false,"product_type":"c1","uid":1816697,"ip_address":"","ucode":"6A68D2414BD904","user_header":"https://static001.geekbang.org/account/avatar/00/1b/b8/79/a4dbe9ee.jpg","comment_is_top":false,"comment_ctime":1583479266,"is_pvip":false,"discussion_count":4,"race_medal":0,"score":"5878446562","product_id":100033601,"comment_content":"Chunk transfer 机制，应该是每个数据块发送时会附上下个数据块的长度吧？","like_count":1,"discussions":[{"author":{"id":2299922,"avatar":"https://static001.geekbang.org/account/avatar/00/23/18/12/b419c29c.jpg","nickname":"Trapped","note":"","ucode":"CA3745D6D9FBF0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":339341,"discussion_content":"维基百科上写的是每个chunk内容之前有一个标明本chunk byte数量的数字。","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1609642070,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1177430,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f7/56/b82eeac7.jpg","nickname":"champ可口可乐了","note":"","ucode":"EA75C67E9124C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":278822,"discussion_content":"难道不是本次传输的这个数据块的长度吗？为什么要传上一个或下一个的长度？","likes_number":2,"is_delete":false,"is_hidden":false,"ctime":1591238521,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":2,"child_discussions":[{"author":{"id":1698735,"avatar":"https://static001.geekbang.org/account/avatar/00/19/eb/af/e49af9a8.jpg","nickname":"JC.彦","note":"","ucode":"E87C1420B140F4","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1177430,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f7/56/b82eeac7.jpg","nickname":"champ可口可乐了","note":"","ucode":"EA75C67E9124C7","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":309852,"discussion_content":"如果是本次传输的数据的长度，那怎么判断数据有没有传输完","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1601463879,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":278822,"ip_address":""},"score":309852,"extra":""},{"author":{"id":1177430,"avatar":"https://static001.geekbang.org/account/avatar/00/11/f7/56/b82eeac7.jpg","nickname":"champ可口可乐了","note":"","ucode":"EA75C67E9124C7","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":1698735,"avatar":"https://static001.geekbang.org/account/avatar/00/19/eb/af/e49af9a8.jpg","nickname":"JC.彦","note":"","ucode":"E87C1420B140F4","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":319039,"discussion_content":"最后一个块传一个0不就行了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1603931060,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":309852,"ip_address":""},"score":319039,"extra":""}]}]},{"had_liked":false,"id":162137,"user_name":"-_-|||","can_delete":false,"product_type":"c1","uid":1328142,"ip_address":"","ucode":"94B21594658BF9","user_header":"https://static001.geekbang.org/account/avatar/00/14/44/0e/ce14b7d3.jpg","comment_is_top":false,"comment_ctime":1576465904,"is_pvip":false,"discussion_count":0,"race_medal":1,"score":"5871433200","product_id":100033601,"comment_content":"同一个域名默认最多6个tcp链接，每个链接每次只能维护一个http链接，这样数据的交换就又局限；明文传输容易被攻击。不能像app那样接收推送信息。","like_count":1},{"had_liked":false,"id":140405,"user_name":"Ming","can_delete":false,"product_type":"c1","uid":1358174,"ip_address":"","ucode":"A94E8D8433E54F","user_header":"https://static001.geekbang.org/account/avatar/00/14/b9/5e/a8f6f7db.jpg","comment_is_top":false,"comment_ctime":1570931580,"is_pvip":true,"discussion_count":1,"race_medal":0,"score":"5865898876","product_id":100033601,"comment_content":"http1.1 虚拟主机支持那部分，host 可以继续展开来啊。“虚拟主机使得多个域名可以映射到同一IP”，跟“针对不同域名IP做不同处理”，感觉没get到内涵啊","like_count":1,"discussions":[{"author":{"id":1347300,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8e/e4/f126ef1b.jpg","nickname":"芬兰湖边小画匠","note":"","ucode":"31289C9C4F4085","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":143602,"discussion_content":"可以配合nginx虚拟主机的配置来理解","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1579516233,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":302463,"user_name":"dxp","can_delete":false,"product_type":"c1","uid":1984990,"ip_address":"","ucode":"5C1AD2CDB06521","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLZlG6Z7ibxbJwTIr40GuFkK0jtiaicyqHXcZ11rmMJVfyChCKMZ34tXx0VficVREblOuI7u2SMvticypA/132","comment_is_top":false,"comment_ctime":1626231688,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1626231688","product_id":100033601,"comment_content":"只能是客户端发起，一来一往。","like_count":0},{"had_liked":false,"id":283432,"user_name":"SXL","can_delete":false,"product_type":"c1","uid":1391963,"ip_address":"","ucode":"6AF042AD0FE601","user_header":"https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKUw7N2IzBsOmfGtA2J4mOoxdthicpmJWutxFfficVlERkSqURowMojdbTQ4jNMqbadPlxkkQjdXd3g/132","comment_is_top":false,"comment_ctime":1615780625,"is_pvip":false,"discussion_count":1,"race_medal":0,"score":"1615780625","product_id":100033601,"comment_content":"1如果当前页面手动刷新，TCP持久连接会不会断开？<br>","like_count":0,"discussions":[{"author":{"id":1374181,"avatar":"https://static001.geekbang.org/account/avatar/00/14/f7/e5/ec543f3b.jpg","nickname":"张宗伟","note":"","ucode":"1447A20C7A8982","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":377790,"discussion_content":"会吧，刷新就把页面卸载了。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1622859958,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":269151,"user_name":"啊哈哈","can_delete":false,"product_type":"c1","uid":1243584,"ip_address":"","ucode":"A8542946C03707","user_header":"https://static001.geekbang.org/account/avatar/00/12/f9/c0/20b4a205.jpg","comment_is_top":false,"comment_ctime":1608539202,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1608539202","product_id":100033601,"comment_content":"1. TCP 数量限制<br>2. 队头阻塞","like_count":0},{"had_liked":false,"id":225731,"user_name":"james","can_delete":false,"product_type":"c1","uid":1232771,"ip_address":"","ucode":"AC42035106E5B9","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/yyibGRYCArsUNBfCAEAibua09Yb9D5AdO8TkCmXymhAepibqmlz0hzg06ggBLxyvXicnjqFVGr7zYF0rQoZ0aXCBAg/132","comment_is_top":false,"comment_ctime":1591842800,"is_pvip":false,"discussion_count":1,"race_medal":1,"score":"1591842800","product_id":100033601,"comment_content":"对头阻塞问题没有从根本上解决<br>","like_count":0,"discussions":[{"author":{"id":1623282,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erMrXia5kb1AXUJoiccmIQxSQ7ib5SkibsQqd9FZInQcwYeNbZXp7CCtMibtg0RLHoza1NVo8A5M3uIluA/132","nickname":"Geek_8476da","note":"","ucode":"9AE358E5F160AE","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":369926,"discussion_content":"多个http请求批量请求，是否还会因为队头阻塞影响数据传输呢？","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1619200126,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":205524,"user_name":"HoSalt","can_delete":false,"product_type":"c1","uid":1156074,"ip_address":"","ucode":"610B03E2A002D1","user_header":"https://static001.geekbang.org/account/avatar/00/11/a3/ea/53333dd5.jpg","comment_is_top":false,"comment_ctime":1586663610,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1586663610","product_id":100033601,"comment_content":"编码格式与文件传输的字节流之间有什么关系吗？","like_count":0},{"had_liked":false,"id":171753,"user_name":"潇潇雨歇","can_delete":false,"product_type":"c1","uid":1251429,"ip_address":"","ucode":"4BD52BF0F0A084","user_header":"https://static001.geekbang.org/account/avatar/00/13/18/65/35361f02.jpg","comment_is_top":false,"comment_ctime":1579007027,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1579007027","product_id":100033601,"comment_content":"不安全","like_count":0},{"had_liked":false,"id":166138,"user_name":"非洲大地我最凶","can_delete":false,"product_type":"c1","uid":1485254,"ip_address":"","ucode":"30CDE0B486AE26","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoaxy8ibvXITdMcXFfd5O5E7Epq8MG5z1OBhO7MQXTfbcpA0fpcsIxkCHyUZ5ZSrj3spZpAQxEC9GA/132","comment_is_top":false,"comment_ctime":1577408632,"is_pvip":false,"discussion_count":6,"race_medal":0,"score":"1577408632","product_id":100033601,"comment_content":"Chunk transfer 机制来解决这个问题，服务器会将数据分割成若干个任意大小的数据块，每个数据块发送时会附上上个数据块的长度，附加上上个数据块长度的意义在哪呢，为啥不是附加上下个数据块的长度","like_count":0,"discussions":[{"author":{"id":2653213,"avatar":"https://static001.geekbang.org/account/avatar/00/28/7c/1d/81902e6a.jpg","nickname":"..................东","note":"","ucode":"03E333B1FF226A","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":383410,"discussion_content":"因为内容是动态生成的，所以只能知道上个块的大小呗","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1626082319,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1781880,"avatar":"https://static001.geekbang.org/account/avatar/00/1b/30/78/bf216994.jpg","nickname":"爱胖胖的懒蛋蛋","note":"","ucode":"1AA7A7A6086698","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":110894,"discussion_content":"我的猜想：计算数据块大小是需要时间的，有可能发送当前数据块的时候下一个数据块的长度还没有计算出来，这样数据块就必须要等下个数据块计算之后才能开始发送，这样做会浪费一些不必要的时间","likes_number":1,"is_delete":false,"is_hidden":false,"ctime":1577762995,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1441516,"avatar":"https://static001.geekbang.org/account/avatar/00/15/fe/ec/d4a5db88.jpg","nickname":"StanJ","note":"","ucode":"1D9A5D0A3F5483","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":552989,"discussion_content":"应该是用来拼装数据的","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1645679403,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1604330,"avatar":"http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL6vCJbd9waPcVY3s46PUC9Qeic2ed4vqviaYfYhjOZEHXY7PO1o6FyeibwkcT07zHRT5vgiaibw8Pwichg/132","nickname":"trackfact","note":"","ucode":"79AAFBAFEA74CE","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":280545,"discussion_content":"搞错了，是附上本次数据块，body的大小","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1591548988,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1355288,"avatar":"https://static001.geekbang.org/account/avatar/00/14/ae/18/ee4ded86.jpg","nickname":"大蓝","note":"","ucode":"855648168C77ED","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":161627,"discussion_content":"估计是写错了","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1580912450,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1347300,"avatar":"https://static001.geekbang.org/account/avatar/00/14/8e/e4/f126ef1b.jpg","nickname":"芬兰湖边小画匠","note":"","ucode":"31289C9C4F4085","race_medal":0,"user_type":1,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":143598,"discussion_content":"不应该是校验数据的完备吗。计算数据块毫秒级的计算，不差那点时间。","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1579516044,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":148163,"user_name":"I\\O","can_delete":false,"product_type":"c1","uid":1091469,"ip_address":"","ucode":"C9D2577ABC7C29","user_header":"https://static001.geekbang.org/account/avatar/00/10/a7/8d/50c0ab72.jpg","comment_is_top":false,"comment_ctime":1572953429,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1572953429","product_id":100033601,"comment_content":"1.不能主动推送数据到客户端<br>2.同一域名连接数有限制","like_count":0},{"had_liked":false,"id":143349,"user_name":"童欧巴","can_delete":false,"product_type":"c1","uid":1569063,"ip_address":"","ucode":"FCCE531C9CE8A0","user_header":"https://static001.geekbang.org/account/avatar/00/17/f1/27/0472f5ff.jpg","comment_is_top":false,"comment_ctime":1571672395,"is_pvip":true,"replies":[{"id":"55372","content":"mac自带的keynote","user_name":"作者回复","user_name_real":"李兵","uid":"1141464","ctime":1571705796,"ip_address":"","comment_id":143349,"utype":1}],"discussion_count":2,"race_medal":0,"score":"1571672395","product_id":100033601,"comment_content":"李兵老师，想问您画图用的什么软件呢？","like_count":1,"discussions":[{"author":{"id":1141464,"avatar":"https://static001.geekbang.org/account/avatar/00/11/6a/d8/228449c9.jpg","nickname":"李兵","note":"","ucode":"3F3D3F6E20209E","race_medal":0,"user_type":2,"is_pvip":false},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":471499,"discussion_content":"mac自带的keynote","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571705796,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":true,"parent_id":0,"ip_address":""},"score":2,"extra":"{\"reply\":true,\"user_type\":2}","child_discussion_number":0,"child_discussions":[]},{"author":{"id":1569063,"avatar":"https://static001.geekbang.org/account/avatar/00/17/f1/27/0472f5ff.jpg","nickname":"童欧巴","note":"","ucode":"FCCE531C9CE8A0","race_medal":0,"user_type":1,"is_pvip":true},"reply_author":{"id":0,"avatar":"","nickname":"","note":"","ucode":"","race_medal":0,"user_type":1,"is_pvip":false},"discussion":{"id":38789,"discussion_content":"好的 谢谢老师","likes_number":0,"is_delete":false,"is_hidden":false,"ctime":1571835201,"is_liked":false,"can_delete":false,"is_complain":false,"is_top":false,"parent_id":0,"ip_address":""},"score":2,"extra":"","child_discussion_number":0,"child_discussions":[]}]},{"had_liked":false,"id":142783,"user_name":"Hurry","can_delete":false,"product_type":"c1","uid":1138560,"ip_address":"","ucode":"12FEE2A50CC667","user_header":"https://static001.geekbang.org/account/avatar/00/11/5f/80/51269d88.jpg","comment_is_top":false,"comment_ctime":1571527701,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1571527701","product_id":100033601,"comment_content":"1.HTTP队头阻塞 2.明文传输 3.HTTP header，特别是 cookie 过大。4.与浏览器并发tcp连接被限制在 6","like_count":0},{"had_liked":false,"id":140010,"user_name":"Chao","can_delete":false,"product_type":"c1","uid":1108745,"ip_address":"","ucode":"DD7742F5537521","user_header":"https://static001.geekbang.org/account/avatar/00/10/eb/09/ba5f0135.jpg","comment_is_top":false,"comment_ctime":1570785333,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570785333","product_id":100033601,"comment_content":"HTTP&#47;1.0就有持久化连接了。 只是要显式声明","like_count":0},{"had_liked":false,"id":139837,"user_name":"Shine","can_delete":false,"product_type":"c1","uid":1022568,"ip_address":"","ucode":"C8C617B87C63C7","user_header":"https://static001.geekbang.org/account/avatar/00/0f/9a/68/92caeed6.jpg","comment_is_top":false,"comment_ctime":1570754593,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570754593","product_id":100033601,"comment_content":"传输短文本，传输视频等等需要分别对待","like_count":0},{"had_liked":false,"id":139466,"user_name":"木瓜777","can_delete":false,"product_type":"c1","uid":1512537,"ip_address":"","ucode":"FC52A499AF6374","user_header":"http://thirdwx.qlogo.cn/mmopen/vi_32/aFAYPyw7ywC1xE9h1qibnTBwtWn2ClJqlicy5cMomhZVaruMyqSq76wMkS279mUaGhrLGwWo9ZnW0WCWfmMovlXw/132","comment_is_top":false,"comment_ctime":1570664459,"is_pvip":false,"discussion_count":0,"race_medal":0,"score":"1570664459","product_id":100033601,"comment_content":"对头阻塞问题；同一个域名6个连接；请求头文本传输等","like_count":0}]}